[
  {
    "title": "Our Team & Collaborators - Dr. Vatsal Sanjay",
    "content": "Assistant Professor, Durham University [ ](https://github.com/VatsalSy) [ ](https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en) [ ](https://bsky.app/profile/comphy-lab.org) - Department of Physics, Durham Univ. / since 2025 - [Postdoc, Phys. Fluids - Univ. Twente / 2022&#8209;25](https://pof.tnw.utwente.nl/people/profile/1330) - **Ph.D.**, Phys. Fluids - Univ. Twente / 2018&#8209;22, Viscous Free-Surface Flows - **B.Tech. + M.Tech.**, Two-Phase Flow & Instability Lab, IIT-R / 2013&#8209;18, Understanding of mutual interactions between liquid jets: Entrainment and sheet formation - [Personal Website](https://vatsalsanjay.com), Photo: Florian Braakman. **Research Interest:** See [research page](/research) [Download CV](https://raw.githubusercontent.com/VatsalSy/Vatsal_CV/master/Vatsal_CV.pdf){: .cv-button}",
    "url": "https://comphy-lab.org/team/#dr-vatsal-sanjay",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Ayush Dixit M.Sc.",
    "content": "Ph.D. Student, University of Twente Co-advised with [Detlef Lohse](https://en.wikipedia.org/wiki/Detlef_Lohse) [ ](https://github.com/ayushkumardixit) [ ](https://scholar.google.com/citations?hl=en&user=ws43SmkAAAAJ) - [Phys. Fluids - Univ. Twente / 2023&#8209;now](https://pof.tnw.utwente.nl/people/profile/2068) - **B.Tech + M.Tech**, Two-Phase Flow & Instability Lab, IIT-R / 2018&#8209;23, Understanding interfacial interaction in macro and nano scales **Research Interest:** Viscoelastic Flows, Bursting Bubbles, Respiratory Drops.",
    "url": "https://comphy-lab.org/team/#ayush-dixit-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Aman Bhargava M.Sc.",
    "content": "Ph.D. Student, University of Twente Co-advised with [Detlef Lohse](https://en.wikipedia.org/wiki/Detlef_Lohse) [ ](https://github.com/amanb1901) [ ](https://scholar.google.com/citations?hl=en&user=AmGOP8gAAAAJ) - [Phys. Fluids - Univ. Twente / 2024-now](https://pof.tnw.utwente.nl/people/profile/2120) - **M.Sc.** Chem. Eng., Purdue University / 2022&#8209;23 - **B.Tech. (Hons.)** Chem. Eng., IIT-B / 2018&#8209;22 **Research Interest:** Inertial Contact Line, Drop Retraction.",
    "url": "https://comphy-lab.org/team/#aman-bhargava-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Jnandeep Talukdar M.Sc.",
    "content": "Ph.D. Student, University of Twente Co-advised with [Detlef Lohse](https://en.wikipedia.org/wiki/Detlef_Lohse) [ ](https://github.com/spilltheT) [ ](https://scholar.google.com/citations?hl=en&user=Coxj4VQAAAAJ) [ ](https://bsky.app/profile/jnandeep.bsky.social) - [Phys. Fluids - Univ. Twente / 2025&#8209;now](https://pof.tnw.utwente.nl/people/profile/1938) - **M.Sc.**, Phys. Fluids - Univ. Twente / 2023&#8209;25, Singularities with Surfactants - **B.Tech.** Mech. Eng., IIT-P / 2019&#8209;23 **Research Interest:** Surfactant Dynamics, Dissipative Anomaly, Soft Wetting.",
    "url": "https://comphy-lab.org/team/#jnandeep-talukdar-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Saumili Jana M.Sc.",
    "content": "Ph.D. Student, University of Twente Co-advised with [Detlef Lohse](https://en.wikipedia.org/wiki/Detlef_Lohse) [ ](https://github.com/SaumiliJana) - [Phys. Fluids - Univ. Twente / 2025-now](https://pof.tnw.utwente.nl/people/profile/2152) - **B.Tech.+M.Tech.**, Mech. Eng., IIT-KGP / 2020&#8209;25, Retract or Collapse? The Role of Viscosity and Viscoelasticity on Bubble Dynamics **Research Interest:** Soft Impact.",
    "url": "https://comphy-lab.org/team/#saumili-jana-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Floris Hoek B.Sc.",
    "content": "M.Sc. Student, University of Twente Co-advised with [Martin van der Hoef](https://pof.tnw.utwente.nl/people/profile/244) & [Alvaro Marin](https://pof.tnw.utwente.nl/people/profile/243) [ ](https://github.com/Floris-Hoek) - [Phys. Fluids - Univ. Twente / 2024](https://pof.tnw.utwente.nl/people/profile/1937) **Research Interest:** Molecular Dynamics Simulations of Evaporation-Driven Colloidal Self-Assembly.",
    "url": "https://comphy-lab.org/team/#floris-hoek-bsc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Peter Croxford",
    "content": "Student, Durham University [ ](https://github.com/PCrox) - Department of Physics, Durham Univ. / 2025&#8209;now **Research Interest:** Bretherton drops and bubbles.",
    "url": "https://comphy-lab.org/team/#peter-croxford",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Mark Boulogne B.Sc.",
    "content": "M.Sc. Student, University of Twente Co-advised with [Detlef Lohse](https://en.wikipedia.org/wiki/Detlef_Lohse) & [Aman Bhargava](https://pof.tnw.utwente.nl/people/profile/2120) [ ](https://github.com/mcboulogne) - [Phys. Fluids - Univ. Twente / 2024&#8209;now](https://pof.tnw.utwente.nl/people/profile/2359) **Research Interest:** Drops and bubbles spreading on LIS.",
    "url": "https://comphy-lab.org/team/#mark-boulogne-bsc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - We need you!",
    "content": "See: [Join Us](https://github.com/VatsalSy/Project-ideas-for-prospective-students) for ongoing projects.",
    "url": "https://comphy-lab.org/team/#we-need-you",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Detlef Lohse F.R.S.",
    "content": "[ ](https://scholar.google.com/citations?user=WvP_pIUAAAAJ) [ ](https://x.com/detlef_lohse) - [Professor, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/3) **Collaboration on:** Drop Impact, Viscoelastic Flows, Dissipative Anomaly, Surfactant Dynamics, Electrolysis, Bubbles, and Everything in Between.",
    "url": "https://comphy-lab.org/team/#prof-detlef-lohse-frs",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Jacco Snoeijer",
    "content": "[ ](https://scholar.google.com/citations?user=7qdux_4AAAAJ&hl=nl) - [Professor, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/21) **Collaboration on:** Elastic Sheets, Viscoelasticity vs. Elasticity, Surfactant Dynamics, Spinning Pizza.",
    "url": "https://comphy-lab.org/team/#prof-jacco-snoeijer",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Dominik Krug",
    "content": "[ ](https://scholar.google.com/citations?user=qGEpq7IAAAAJ&hl=en&inst=5726176096060060532&oi=ao) - [Professor, RWTH Aachen University](https://www.aia.rwth-aachen.de/) - [Adjunct Professor, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1199) **Collaboration on:** Electrolysis, Bubble Coalescence, Swimming Bubbles.",
    "url": "https://comphy-lab.org/team/#prof-dominik-krug",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Maziyar (Mazi) Jalaal",
    "content": "[ ](https://scholar.google.com/citations?user=FE8TQeUAAAAJ) [ ](https://x.com/maziyarj) [ ](https://bsky.app/profile/mazi1.bsky.social) - [Associate Professor, Fluid Lab, Univ. Amsterdam](https://www.fluidlab.nl/) **Collaboration on:** Plastocapillarity, Viscoplastic Flows.",
    "url": "https://comphy-lab.org/team/#dr-maziyar-mazi-jalaal",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Uddalok (Udo) Sen",
    "content": "[ ](https://scholar.google.com/citations?user=a6h2uMQAAAAJ) - [Assistant Professor, PhySM, Wageningen University and Research](https://www.physm-lab.org/) **Collaboration on:** Drop Impact, Sheet Retraction.",
    "url": "https://comphy-lab.org/team/#dr-uddalok-udo-sen",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Adj. Prof. Alvaro Marin",
    "content": "[ ](https://scholar.google.com/citations?user=0_jOqqkAAAAJ) [ ](https://github.com/alvarogum) [ ](https://x.com/AlvaroGMarin) [ ](https://bsky.app/profile/alvaromarin.bsky.social) - [Adjunct Professor, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/243) **Collaboration on:** Colloidal Systems, Evaporation, Shell Formation.",
    "url": "https://comphy-lab.org/team/#adj-prof-alvaro-marin",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Christian Diddens",
    "content": "[ ](https://scholar.google.com/citations?user=3QSyucwAAAAJ&hl=en&inst=5726176096060060532&oi=ao) [ ](https://github.com/cdiddens) - [Group Leader, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1143) - [Developer of pyoomph](https://pyoomph.github.io/) **Collaboration on:** Surfactant Dynamics in Free Surface Flows, Dissipative Anomaly, Sliding Drops.",
    "url": "https://comphy-lab.org/team/#dr-christian-diddens",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Gareth McKinley",
    "content": "[ ](https://scholar.google.com/citations?user=uLxFfGkAAAAJ) [ ](https://en.wikipedia.org/wiki/Gareth_H._McKinley) [ ](https://x.com/garethmckinley) - [Professor, MIT](https://nnf.mit.edu/) **Collaboration on:** Die-Swelling, Viscoelastic Flows.",
    "url": "https://comphy-lab.org/team/#prof-gareth-mckinley",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. John Kolinski",
    "content": "[ ](https://scholar.google.com/citations?user=BDzF8kMAAAAJ) [ ](https://en.wikipedia.org/wiki/John_Martin_Kolinski) - [Assistant Professor, EPFL (\u00c9cole Polytechnique F\u00e9d\u00e9rale de Lausanne)](https://people.epfl.ch/john.kolinski) **Collaboration on:** Soft Impact",
    "url": "https://comphy-lab.org/team/#dr-john-kolinski",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. C. Ricardo Constante-Amores",
    "content": "[ ](https://scholar.google.com/citations?user=ncqnphMAAAAJ) [ ](https://github.com/rcrc15) - [Assistant Professor, Univ. Illinois Urbana-Champaign](https://publish.illinois.edu/constanteamores/home/) **Collaboration on:** Non-Newtonian Flows, Bubble Bursting, Herschel--Bulkley Fluids, Elastic Coating.",
    "url": "https://comphy-lab.org/team/#dr-c-ricardo-constante-amores",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Radu Cimpeanu",
    "content": "[ ](https://scholar.google.com/citations?user=6grZnhQAAAAJ&hl=en&inst=5726176096060060532&oi=ao) [ ](https://x.com/rcimpeanu) [ ](https://github.com/RaduCimpeanu) - [Associate Professor, Univ. Warwick](https://www.raducimpeanu.com/) **Collaboration on:** Open-Source Code Development, Non-Coalescence Impacts.",
    "url": "https://comphy-lab.org/team/#dr-radu-cimpeanu",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Jie Feng",
    "content": "[ ](https://scholar.google.com/citations?user=226dDBAAAAAJ) [ ](https://x.com/FengFluidsLab) - [Assistant Professor, Univ. Illinois Urbana-Champaign](https://fengfluidslab.web.illinois.edu/wp/) **Collaboration on:** Elastic Coating, Bursting Bubbles.",
    "url": "https://comphy-lab.org/team/#dr-jie-feng",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Omar Matar",
    "content": "[ ](https://scholar.google.com/citations?user=mLXz_NAAAAAJ&hl=en) [ ](https://x.com/okmatar?lang=en) - [Professor, Imperial College London](https://profiles.imperial.ac.uk/o.matar) **Collaboration on:** Surfactant Dynamics, Viscoelastic Drop Impact.",
    "url": "https://comphy-lab.org/team/#prof-omar-matar",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Ratul Dasgupta",
    "content": "[ ](https://scholar.google.com/citations?user=I1jFG_oAAAAJ) [ ](https://x.com/RatulDG) - [Associate Professor, IIT Bombay](https://sites.google.com/view/ratuldasgupta/home) **Collaboration on:** Waves, Dissipative Anomaly.",
    "url": "https://comphy-lab.org/team/#dr-ratul-dasgupta",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. Eric Lauga",
    "content": "[ ](https://scholar.google.com/citations?hl=en&user=5ObY7hsAAAAJ) - [Professor, Univ. Cambridge](https://www.damtp.cam.ac.uk/user/lauga/) **Collaboration on:** Mycofluidic Transport.",
    "url": "https://comphy-lab.org/team/#prof-eric-lauga",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Saikat Datta",
    "content": "[ ](https://scholar.google.com/citations?user=o4mXtIgAAAAJ) - Senior Lecturer, Swansea University **Collaboration on:** Multiscale Simulation, Ice Nucleation and Removal, Hydrogen Storage.",
    "url": "https://comphy-lab.org/team/#dr-saikat-datta",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Doris Vollmer",
    "content": "[ ](https://orcid.org/0000-0001-9599-5589) - [Apl. Professor, Max Planck Institute for Polymer Research, Mainz, Germany.](https://www.mpip-mainz.mpg.de/en/butt/groups/vollmer) **Collaboration on:** Contact Line, Drop Impact, Superhydrophobic Surfaces.",
    "url": "https://comphy-lab.org/team/#dr-doris-vollmer",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Prof. St\u00e9phane Zaleski",
    "content": "[ ](https://scholar.google.com/citations?hl=en&user=no1GX_QAAAAJ) [ ](https://x.com/zaleski) - [Professor, Sorbonne Universite](http://www.ida.upmc.fr/~zaleski/zaleski.html) **Collaboration on:** Holey Sheets.",
    "url": "https://comphy-lab.org/team/#prof-st\u00e9phane-zaleski",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Pierre Chantelot",
    "content": "[ ](https://scholar.google.nl/citations?user=BQWXUKYAAAAJ) - [Postdoc, Institut Langevin, ESPCI Paris](https://sites.google.com/view/pierre-chantelot/) **Collaboration on:** Drop Impact",
    "url": "https://comphy-lab.org/team/#dr-pierre-chantelot",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Aleksandr Bashkatov",
    "content": "[ ](https://scholar.google.com/citations?user=9_vPSFsAAAAJ&hl=en&inst=5726176096060060532&oi=ao) - [Postdoc, RWTH Aachen University](https://scholar.google.com/citations?user=9_vPSFsAAAAJ&hl=en&inst=5726176096060060532&oi=ao) **Collaboration on:** Electrolysis, Bubble Coalescence, Swimming Bubbles.",
    "url": "https://comphy-lab.org/team/#dr-aleksandr-bashkatov",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Vincent Bertin",
    "content": "[ ](https://scholar.google.com/citations?user=jO_RTLR2xBYC&hl=en&inst=5726176096060060532&oi=ao) - [Postdoc, University Aix-Marseille](https://vincent-bertin.github.io/) **Collaboration on:** Elastic Sheets, Spinning Pizza.",
    "url": "https://comphy-lab.org/team/#dr-vincent-bertin",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Alexandros Oratis",
    "content": "[ ](https://scholar.google.com/citations?user=2lOr8WQAAAAJ&hl=en&inst=5726176096060060532&oi=ao) - [Postdoc, TU Delft](https://garbinlab.org/people/) **Collaboration on:** Electrolysis, Bubble Coalescence, Swimming Bubbles.",
    "url": "https://comphy-lab.org/team/#dr-alexandros-oratis",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Arivazhagan (Ari) Balasubramanian M.Sc.",
    "content": "[ ](https://scholar.google.com/citations?user=xyheRZ8AAAAJ) [ ](https://github.com/GbArivazhagan) [ ](https://bsky.app/profile/gbarivaz.bsky.social) - [Ph.D. Student, KTH Sweden](https://www.kth.se/profile/argb?l=en) **Collaboration on:** Elastoviscoplastic Flows, Bursting Bubbles",
    "url": "https://comphy-lab.org/team/#arivazhagan-ari-balasubramanian-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Konstantinos (Costis) Zinelis",
    "content": "[ ](https://scholar.google.com/citations?user=dZrR_z8AAAAJ&hl=en&inst=5726176096060060532&oi=ao) [ ](https://x.com/KZinelis) - [Postdoc, MIT](https://qigroup.mit.edu/team/) **Collaboration on:** Viscoelastic Flows, Drop Impact.",
    "url": "https://comphy-lab.org/team/#dr-konstantinos-costis-zinelis",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Milan Sent B.Sc.",
    "content": "[ ](https://github.com/mdjsent) - **2025:** Graduated with B.Sc., Univ. Twente - Spinning Pizza",
    "url": "https://comphy-lab.org/team/#milan-sent-bsc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Valentin Rosario M.Sc.",
    "content": "[ ](https://www.linkedin.com/in/valentin-rosario-6377602b2/?originalSubdomain=nl) [ ](https://github.com/ValeRos9) - **Now:** Ph.D. Student, Leiden University - **2024:** Graduated with M.Sc., Univ. Amsterdam - Modelling the Ward--Hunt ice-shelf as viscoelastic solid",
    "url": "https://comphy-lab.org/team/#valentin-rosario-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Swen van den Heuvel M.Sc.",
    "content": "[ ](https://www.linkedin.com/in/swen-van-den-heuvel-33a1901aa/) - **Now:** [Ph.D. Student, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/2119) - **2023:** [Graduated with M.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/2119) - Hydrodynamic forces acting on vertically rising bubbles",
    "url": "https://comphy-lab.org/team/#swen-van-den-heuvel-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Niels Kuipers B.Sc.",
    "content": "[ ](https://www.linkedin.com/in/nielskuipers1/) - **Now:** M.Sc. Student, Adv. Technology - Univ. Twente - **2023:** [Graduated with B.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/2064) - Partial coalescence of drops on viscous films",
    "url": "https://comphy-lab.org/team/#niels-kuipers-bsc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - C. H. (Luuk) Maurits M.Sc.",
    "content": "- **2023:** [Graduated with M.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1741) - When Laplace meets Marangoni",
    "url": "https://comphy-lab.org/team/#c-h-luuk-maurits-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Tom Appleford M.Sc.",
    "content": "- **Now:** [Ph.D. Student, Fluid Lab - Univ. Amsterdam](https://www.fluidlab.nl/team) - **2022:** [Graduated with M.Sc., Univ. Amsterdam](https://pof.tnw.utwente.nl/people/profile/1741) - The deformation of a droplet in a viscoplastic simple shear flow",
    "url": "https://comphy-lab.org/team/#tom-appleford-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Twan Heijink B.Sc.",
    "content": "[ ](https://www.linkedin.com/in/twanheijink/) - **Now:** Software IVQA Engineer at Thales - **2021:** [Graduated with B.Sc., Saxion Univ.](https://pof.tnw.utwente.nl/people/profile/1822) - Standing waves at a fluid-fluid interface with plastocapillarity",
    "url": "https://comphy-lab.org/team/#twan-heijink-bsc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Steven Meuleman M.Sc.",
    "content": "[ ](https://www.linkedin.com/in/steven-meuleman/) - **Now:** Mechanical Engineer at VIRO - **2020:** Graduated with B.Sc., Univ. Twente - Simulations of foam generation for a custom axisymmetric core-shell nozzle",
    "url": "https://comphy-lab.org/team/#steven-meuleman-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Thijmen Kroeze M.Sc.",
    "content": "[ ](https://www.linkedin.com/in/thijmen-kroeze-535aa3207/) - **Now:** CFD Engineer, Brink Climate Systems - **2020:** [Graduated with B.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1630) - Singular jet dynamics of drop impacts at high Bond numbers",
    "url": "https://comphy-lab.org/team/#thijmen-kroeze-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Coen Verschuur M.Sc.",
    "content": "- **Now:** [Ph.D. Student, Phys. Fluids - Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1709) - **2020:** [Graduated with B.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1709) - Early time dynamics in immiscible drop impacts",
    "url": "https://comphy-lab.org/team/#coen-verschuur-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Dr. Pim J. Dekker",
    "content": "[ ](https://www.linkedin.com/in/pim-dekker/) - **Now:** [Researcher at Education Applied Physics Univ. Twente-TNW](https://pof.tnw.utwente.nl/people/profile/1431) - **2019:** [Graduated with B.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1431) - Spreading of a drop on a water-air interface",
    "url": "https://comphy-lab.org/team/#dr-pim-j-dekker",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "Our Team & Collaborators - Laurence Bruggink M.Sc.",
    "content": "[ ](https://www.linkedin.com/in/laurence-bruggink-b733b222a/) - **Now:** Research Engineer at Alfen - **2019:** [Graduated with B.Sc., Univ. Twente](https://pof.tnw.utwente.nl/people/profile/1518) - Bursting bubble in a Herschel--Bulkley fluid",
    "url": "https://comphy-lab.org/team/#laurence-bruggink-msc",
    "type": "website_section",
    "priority": 1
  },
  {
    "title": "[21] D\u00edaz, D.,Bhargava, A. S., Walz, F., Sharifi, A., Summaly, S., Berger, R., Kappl, M., Butt, H.-J., Lohse, D., Willers, T.,Sanjay, V., & Vollmer, D. Stood-up Drop to Determine Receding Contact Angles. Soft Matter, 22, 657-667 (2026).",
    "content": "[21] D\u00edaz, D.,Bhargava, A. S., Walz, F., Sharifi, A., Summaly, S., Berger, R., Kappl, M., Butt, H.-J., Lohse, D., Willers, T.,Sanjay, V., & Vollmer, D. Stood-up Drop to Determine Receding Contact Angles. Soft Matter, 22, 657-667 (2026).",
    "url": "https://comphy-lab.org/research/#21",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[20] Demirk\u0131r, \u00c7., Yang, R., Bashkatov, A.,Sanjay, V., Lohse, D., & Krug, D. To jump or not to jump: Adhesion and viscous dissipation dictate the detachment of coalescing wall-attached bubbles. Phys. Rev. Fluids, 10, 123602 (2025).",
    "content": "[20] Demirk\u0131r, \u00c7., Yang, R., Bashkatov, A.,Sanjay, V., Lohse, D., & Krug, D. To jump or not to jump: Adhesion and viscous dissipation dictate the detachment of coalescing wall-attached bubbles. Phys. Rev. Fluids, 10, 123602 (2025).",
    "url": "https://comphy-lab.org/research/#20",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[19] Mclauchlan, J., Walker, J. S.,Sanjay, V., Jalaal, M., Reid, J. P., Squires, A. M., & Souslov, A. Bouncing microdroplets on hydrophobic surfaces. Proc. Natl. Acad. Sci., 122, e2507309122 (2025).",
    "content": "[19] Mclauchlan, J., Walker, J. S.,Sanjay, V., Jalaal, M., Reid, J. P., Squires, A. M., & Souslov, A. Bouncing microdroplets on hydrophobic surfaces. Proc. Natl. Acad. Sci., 122, e2507309122 (2025).",
    "url": "https://comphy-lab.org/research/#19",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[18] Saini, M.,Sanjay, V., Saade, Y., Lohse, D., & Popinet, S. Implementation of integral surface tension formulations in a volume of fluid framework and their applications to Marangoni flows. J. Comput. Phys., 542, 114348 (2025).",
    "content": "[18] Saini, M.,Sanjay, V., Saade, Y., Lohse, D., & Popinet, S. Implementation of integral surface tension formulations in a volume of fluid framework and their applications to Marangoni flows. J. Comput. Phys., 542, 114348 (2025).",
    "url": "https://comphy-lab.org/research/#18",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[17] Bashkatov, A., B\u00fcrkle, F., Demirk\u0131r, \u00c7., Ding, W.,Sanjay, V., Babich, A., Yang, X., Mutschke, G., Czarske, J., Lohse, D., Krug, D., Lars, B., & Eckert, E. Electrolyte droplet spraying in H2 bubbles during water electrolysis under normal and microgravity conditions. Nat. Commun., 16, 4580 (2025).",
    "content": "[17] Bashkatov, A., B\u00fcrkle, F., Demirk\u0131r, \u00c7., Ding, W.,Sanjay, V., Babich, A., Yang, X., Mutschke, G., Czarske, J., Lohse, D., Krug, D., Lars, B., & Eckert, E. Electrolyte droplet spraying in H2 bubbles during water electrolysis under normal and microgravity conditions. Nat. Commun., 16, 4580 (2025).",
    "url": "https://comphy-lab.org/research/#17",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[16]Dixit, A., Oratis, A., Zinelis, K., Lohse, D., &Sanjay, V.Viscoelastic Worthington Jets and Droplets Produced by Bursting Bubbles. J. Fluid Mech., 1010, A2 (2025).",
    "content": "[16]Dixit, A., Oratis, A., Zinelis, K., Lohse, D., &Sanjay, V.Viscoelastic Worthington Jets and Droplets Produced by Bursting Bubbles. J. Fluid Mech., 1010, A2 (2025).",
    "url": "https://comphy-lab.org/research/#16",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[15]Sanjay, V., & Lohse, D. Unifying theory of scaling in drop impact: Forces & maximum spreading diameter. Phys. Rev. Lett., 134, 104003 (2025).",
    "content": "[15]Sanjay, V., & Lohse, D. Unifying theory of scaling in drop impact: Forces & maximum spreading diameter. Phys. Rev. Lett., 134, 104003 (2025).",
    "url": "https://comphy-lab.org/research/#15",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[14]Sanjay, V., Zhang, B., Lv, C., & Lohse, D. The role of viscosity on drop impact forces on non-wetting surfaces. J. Fluid Mech., 1004, A6 (2025).",
    "content": "[14]Sanjay, V., Zhang, B., Lv, C., & Lohse, D. The role of viscosity on drop impact forces on non-wetting surfaces. J. Fluid Mech., 1004, A6 (2025).",
    "url": "https://comphy-lab.org/research/#14",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[13] Kayal, L.,Sanjay, V., Yewale, N., Kumar, A., & Dasgupta, R. Focusing of concentric free-surface waves. J. Fluid Mech., 1003, A14 (2025).",
    "content": "[13] Kayal, L.,Sanjay, V., Yewale, N., Kumar, A., & Dasgupta, R. Focusing of concentric free-surface waves. J. Fluid Mech., 1003, A14 (2025).",
    "url": "https://comphy-lab.org/research/#13",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[12] Balasubramanian, A. G.,Sanjay, V., Jalaal, M., Vinuesa, R., & Tammisola, O. Bursting bubble in an elastoviscoplastic medium. J. Fluid Mech., 1001, A9 (2024).",
    "content": "[12] Balasubramanian, A. G.,Sanjay, V., Jalaal, M., Vinuesa, R., & Tammisola, O. Bursting bubble in an elastoviscoplastic medium. J. Fluid Mech., 1001, A9 (2024).",
    "url": "https://comphy-lab.org/research/#12",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[11]Sanjay, V., Chantelot, P., & Lohse, D. When does an impacting drop stop bouncing? J. Fluid Mech., 958, A26 (2023).",
    "content": "[11]Sanjay, V., Chantelot, P., & Lohse, D. When does an impacting drop stop bouncing? J. Fluid Mech., 958, A26 (2023).",
    "url": "https://comphy-lab.org/research/#11",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[10]Sanjay, V., Lakshman, S., Chantelot, P., Snoeijer, J. H., & Lohse, D. Drop impact on viscous liquid films. J. Fluid Mech., 958, A25 (2023).",
    "content": "[10]Sanjay, V., Lakshman, S., Chantelot, P., Snoeijer, J. H., & Lohse, D. Drop impact on viscous liquid films. J. Fluid Mech., 958, A25 (2023).",
    "url": "https://comphy-lab.org/research/#10",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "\u27a1\ufe0fSanjay, V.Viscous free-surface flows. Ph.D. Thesis, Physics of Fluids, University of Twente (2022).",
    "content": "\u27a1\ufe0fSanjay, V.Viscous free-surface flows. Ph.D. Thesis, Physics of Fluids, University of Twente (2022).",
    "url": "https://comphy-lab.org/research/#thesis",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[9]Sanjay, V., Sen, U., Kant, P., and Lohse, D. Taylor\u2013Culick retractions and the influence of the surroundings. J. Fluid Mech., 948, A14 (2022).",
    "content": "[9]Sanjay, V., Sen, U., Kant, P., and Lohse, D. Taylor\u2013Culick retractions and the influence of the surroundings. J. Fluid Mech., 948, A14 (2022).",
    "url": "https://comphy-lab.org/research/#9",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[8] Zhang, B.,Sanjay, V., Shi, S., and Zhao, Y., and Lv, C., and Feng, X.-Q., & Lohse, D. Impact forces of water drops falling on superhydrophobic surfaces. Phys. Rev. Lett., 129(10), 104501 (2022).",
    "content": "[8] Zhang, B.,Sanjay, V., Shi, S., and Zhao, Y., and Lv, C., and Feng, X.-Q., & Lohse, D. Impact forces of water drops falling on superhydrophobic surfaces. Phys. Rev. Lett., 129(10), 104501 (2022).",
    "url": "https://comphy-lab.org/research/#8",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[7]Sanjay, V., Lohse, D., & Jalaal, M. Bursting bubble in a viscoplastic medium. J. Fluid Mech., 922, A2 (2021).",
    "content": "[7]Sanjay, V., Lohse, D., & Jalaal, M. Bursting bubble in a viscoplastic medium. J. Fluid Mech., 922, A2 (2021).",
    "url": "https://comphy-lab.org/research/#7",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[6] Ram\u00edrez-Soto, O.,Sanjay, V., Lohse, D., Pham, J. T., & Vollmer, D. Lifting a sessile oil drop from a superamphiphobic surface with an impacting one. Sci. Adv., 6(34), eaba4330 (2020).",
    "content": "[6] Ram\u00edrez-Soto, O.,Sanjay, V., Lohse, D., Pham, J. T., & Vollmer, D. Lifting a sessile oil drop from a superamphiphobic surface with an impacting one. Sci. Adv., 6(34), eaba4330 (2020).",
    "url": "https://comphy-lab.org/research/#6",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[5] Jain, A.,Sanjay, V., & Das, A. K. Consequences of inclined and dual jet impingement in stagnant liquid and stratified layers. AIChE J., 65(1), 372-384 (2019).",
    "content": "[5] Jain, A.,Sanjay, V., & Das, A. K. Consequences of inclined and dual jet impingement in stagnant liquid and stratified layers. AIChE J., 65(1), 372-384 (2019).",
    "url": "https://comphy-lab.org/research/#5",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[4] Soni, A.,Sanjay, V., & Das, A. K. Formation of fluid structures due to jet-jet and jet-sheet interactions. Chem. Eng. Sci., 191, 67-77 (2018).",
    "content": "[4] Soni, A.,Sanjay, V., & Das, A. K. Formation of fluid structures due to jet-jet and jet-sheet interactions. Chem. Eng. Sci., 191, 67-77 (2018).",
    "url": "https://comphy-lab.org/research/#4",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[3]Sanjay, V., Das, A.K. Numerical assessment of hazard in compartmental fire having steady heat release rate from the source. Build. Simul. 11, 613\u2013624 (2018).",
    "content": "[3]Sanjay, V., Das, A.K. Numerical assessment of hazard in compartmental fire having steady heat release rate from the source. Build. Simul. 11, 613\u2013624 (2018).",
    "url": "https://comphy-lab.org/research/#3",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[2]Sanjay, V., & Das, A. K. Formation of liquid chain by collision of two laminar jets. Phys. Fluids, 29(11), 112101 (2017).",
    "content": "[2]Sanjay, V., & Das, A. K. Formation of liquid chain by collision of two laminar jets. Phys. Fluids, 29(11), 112101 (2017).",
    "url": "https://comphy-lab.org/research/#2",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "[1]Sanjay, V., & Das, A. K. On air entrainment in a water pool by impingement of a jet. AIChE J., 63(11), 5169-5181 (2017).",
    "content": "[1]Sanjay, V., & Das, A. K. On air entrainment in a water pool by impingement of a jet. AIChE J., 63(11), 5169-5181 (2017).",
    "url": "https://comphy-lab.org/research/#1",
    "type": "paper",
    "tags": [],
    "priority": 2
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\"",
    "content": "// Function to update image visibility based on theme function updateBannerImages() { const theme = document.documentElement.getAttribute('data-theme') || 'light'; const lightImages = document.querySelectorAll('.light-mode-img'); const darkImages = document.querySelectorAll('.dark-mode-img'); if (theme === 'dark') { lightImages.forEach(img => img.style.display = 'none'); darkImages.forEach(img => img.style.display = 'block'); } else { lightImages.forEach(img => img.style.display = 'block'); darkImages.forEach(img => img.style.display = 'none'); } } // Run on page load document.addEventListener('DOMContentLoaded', updateBannerImages); // Watch for theme changes const observer = new MutationObserver(function(mutations) { mutations.forEach(function(mutation) { if (mutation.attributeName === 'data-theme') { updateBannerImages(); } }); }); observer.observe(document.documentElement, { attributes: true });",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid",
    "type": "website_content",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - High-Fidelity Simulations Using Basilisk C",
    "content": "Dates March 10-13, 2025 Location Universidad Carlos III de Madrid, Spain Duration 4 days, full-time",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#high-fidelity-simulations-using-basilisk-c",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - What will you learn?",
    "content": "- **Think before you compute!** Understanding the physics before implementation - **Writing the first code in Basilisk C** Getting comfortable with the framework - **Solving conservation equations** Numerical approaches to fluid dynamics - **Interface tracking methods** Capturing multiphase phenomena accurately - **Non-Newtonian flows** Modeling complex rheological behaviors",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#what-will-you-learn",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Course Description",
    "content": "This intensive 4-day course provides a comprehensive introduction to high-fidelity simulations using Basilisk C, a powerful computational framework for fluid dynamics. Participants will learn to implement and solve complex fluid mechanics problems with an emphasis on multiphase flows, interface dynamics, and non-Newtonian rheology. The course combines theoretical lectures with extensive hands-on sessions, allowing participants to immediately apply concepts through guided coding exercises. By the end of the course, you'll be able to develop your own simulations for a variety of fluid dynamics applications.",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#course-description",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Think before you compute",
    "content": "- **10:00-11:30** &nbsp;|&nbsp; **Lecture (1a)** - Conservation laws and the numerical solution of the Navier\u2013Stokes equations - **11:45-13:00** &nbsp;|&nbsp; **Lecture (1b)** - Transport equations - *Brief intro to Basilisk coding framework*",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#think-before-you-compute",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - First coding steps",
    "content": "- **15:00-18:00** &nbsp;|&nbsp; **Hybrid Session** - Implementing basic transport equations in Basilisk C. - Using headers in Basilisk, modular code structure, problem setup, and compilation - *Whiteboard + coding* - [1st Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#first-coding-steps",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Coding like a pro",
    "content": "- **10:00-11:15** &nbsp;|&nbsp; **Hackathon (1c)** - Solving Navier\u2013Stokes equations in Basilisk C. - [2nd Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment) - **11:30-13:00** &nbsp;|&nbsp; **Hackathon Continued** - Expanding on the morning tasks and code debugging",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#coding-like-a-pro",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Interface tracking methods",
    "content": "- **10:00-11:30** &nbsp;|&nbsp; **Lecture (2a)** - Interface tracking methods (VoF, level set, phase-field approaches) and numerical strategies - **11:45-13:00** &nbsp;|&nbsp; **Hackathon (2b)** - Hands-on tutorial with interface-tracking to a simple two-phase problem - [3rd Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#interface-tracking-methods",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Seminar",
    "content": "- **13:30-14:00** &nbsp;|&nbsp; **Department seminar (2c)** - A note on the thrust of airfoils by [Jos\u00e9 Manuel Gordillo](https://scholar.google.com/citations?user=14wOsewAAAAJ&hl=en&inst=5726176096060060532&oi=ao)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#seminar",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Non-Newtonian flows",
    "content": "- **15:00-16:00** &nbsp;|&nbsp; **Lecture (3a)** - Non-Newtonian flows: viscoelasticity. - **16:15-18:00** &nbsp;|&nbsp; **Hackathon (3b)** - Coding exercises for viscoelastic fluids. - [4th Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#non-newtonian-flows",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Special topics",
    "content": "- **10:00-11:30** &nbsp;|&nbsp; **Lecture (4a)** - Review and catching up on [4th Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment). - Special Topics: Three-phase flows, - **11:45-13:00** &nbsp;|&nbsp; **Hackathon (4b)** - Special Topics: Holey Sheets, Contact line dynamics. - **15:00-16:30** &nbsp;|&nbsp; **Lecture (4c)** - Open discussion, deeper dives into advanced features, final code reviews, and next steps. ---",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#special-topics",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Prerequisites",
    "content": "- Basic knowledge of fluid mechanics - Experience with programming (any language, C preferred) - Understanding of partial differential equations - Laptop with ability to compile C code",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#prerequisites",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"High-Fidelity Simulations Using Basilisk C\" - Registration",
    "content": "For registration details, please contact bubbles@ing.uc3m.es vatsal.sanjay@comphy-lab.org vatsal.sanjay@durham.ac.uk function copyEmail(button) { const textToCopy = button.getAttribute('data-text'); // Create a temporary textarea element to copy from const textarea = document.createElement('textarea'); textarea.value = textToCopy; textarea.setAttribute('readonly', ''); textarea.style.position = 'absolute'; textarea.style.left = '-9999px'; document.body.appendChild(textarea); // Select and copy the text textarea.select(); document.execCommand('copy'); // Remove the temporary element document.body.removeChild(textarea); // Show feedback const originalIcon = button.innerHTML; button.innerHTML = ' '; button.classList.add('copied'); // Restore original state after a delay setTimeout(() => { button.innerHTML = originalIcon; button.classList.remove('copied'); }, 2000); } Course GitHub Repository",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101-Madrid#registration",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\"",
    "content": "// Function to update image visibility based on theme function updateBannerImages() { const theme = document.documentElement.getAttribute('data-theme') || 'light'; const lightImages = document.querySelectorAll('.light-mode-img'); const darkImages = document.querySelectorAll('.dark-mode-img'); if (theme === 'dark') { lightImages.forEach(img => img.style.display = 'none'); darkImages.forEach(img => img.style.display = 'block'); } else { lightImages.forEach(img => img.style.display = 'block'); darkImages.forEach(img => img.style.display = 'none'); } } // Run on page load document.addEventListener('DOMContentLoaded', updateBannerImages); // Watch for theme changes const observer = new MutationObserver(function(mutations) { mutations.forEach(function(mutation) { if (mutation.attributeName === 'data-theme') { updateBannerImages(); } }); }); observer.observe(document.documentElement, { attributes: true });",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS",
    "type": "website_content",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Basilisk for Multiphase Flow Simulations",
    "content": "Date September 15, 2025 Location European Coating Symposium 2025 Duration 3 hours (9:30 AM - 12:30 PM)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#basilisk-for-multiphase-flow-simulations",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - What will you learn?",
    "content": "- **Think before you compute!** Physics-first approach to multiphase flow simulation - **Run Basilisk simulations** Compile and execute your first high-fidelity simulations - **Interface tracking methods** Volume-of-Fluid (VOF) approach for two-phase flows - **Coating applications** Landau-Levich dip coating and droplet dynamics - **Real-world connections** From simulation results to physical understanding",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#what-will-you-learn",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Course Description",
    "content": "This intensive 3-hour pre-conference training provides a focused introduction to high-fidelity multiphase flow simulation using Basilisk C, a powerful open-source framework. Designed for ECS 2025 participants with intermediate CFD background, the course emphasizes practical applications to coating processes while building foundational skills in adaptive mesh refinement and interface dynamics. The hands-on format combines theoretical insights with live coding demonstrations, enabling participants to immediately apply concepts. Through three carefully selected examples\u2014basic heat conduction, drop impact dynamics, and Landau-Levich dip coating\u2014attendees will gain practical experience with Basilisk's approach to conservation equations, interface tracking, and complex physics modeling relevant to coating applications.",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#course-description",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Think before you compute",
    "content": "- **9:30-9:45** &nbsp;|&nbsp; **Opening & Philosophy** - Conservation laws and the \"physics-first\" approach to simulation - Why adaptive mesh refinement matters for coating flows - **9:45-10:00** &nbsp;|&nbsp; **Example 0: Basic Conduction** - Setting up a simple heat diffusion problem - Understanding Basilisk's syntax and structure. Basilisk C [website](http://basilisk.fr) is your best friend. - **10:00-10:30** &nbsp;|&nbsp; **First Basilisk Code** - Implementing transport equations in practice - Compilation workflow and debugging basics - _Hands-on exercise: modify and run your first simulation_ - Conduction: [Live demo](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment) & [Takeaways](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#think-before-you-compute",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Multiphase flow fundamentals",
    "content": "- **10:30-10:50** &nbsp;|&nbsp; **Volume-of-Fluid Method** - Interface tracking for two-phase flows - Surface tension implementation in Basilisk - Adaptive refinement at fluid interfaces - **10:50-11:10** &nbsp;|&nbsp; **Example 1: Drop Impact** - Wetting condition? - _Live demonstration with parameter variations_ - [Drop impact assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment) - **11:10-11:30** &nbsp;|&nbsp; **Interactive Workshop** - Modify bulk properties and see immediate results. - Explore impact velocity effects on maximum force and spreading. - _Group exercise: predict and test outcomes_",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#multiphase-flow-fundamentals",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Contact line dynamics",
    "content": "- **11:30-12:15** &nbsp;|&nbsp; **Example 2: Landau-Levich Dip Coating** - Contact line dynamics in coating processes. - Multiscale nature of the contact line problem. - Need for subgrid models. - Landau-Levich dip coating assignment. - **12:15-12:30** &nbsp;|&nbsp; **Q&A and Next Steps** - Discussion of participant-specific applications. - Resources for continued learning. - Community support and collaboration opportunities. ---",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#contact-line-dynamics",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Prerequisites",
    "content": "- Intermediate knowledge of fluid mechanics and CFD concepts - Basic programming experience (C preferred, but any language acceptable) - Understanding of partial differential equations - Laptop with Unix-like environment (Linux/Mac/WSL for Windows)",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#prerequisites",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Pre-Course Setup",
    "content": "**Required Software Installation:** This installation is tested on Ubuntu 22.04 and macOS 15.XX. ```bash",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#pre-course-setup",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Basilisk framework",
    "content": "git clone https://github.com/comphy-lab/Basilisk-101nano.git cd Basilisk-101nano chmod +x ./reset_install_requirements.sh ./reset_install_requirements.sh --hard ``` For some known issues, please refer to: [Basilisk-C issues](https://github.com/comphy-lab/basilisk-C/issues) and [Issue #3](https://github.com/comphy-lab/basilisk-C/issues/3). Darcs is not supported in the latest version of Ubuntu using apt-get. Please see: [Darcs website](https://darcs.net/) for more information on how to install Darcs. You can also install Basilisk without Darcs. Please follow the instructions here: [Basilisk INSTALL](http://basilisk.fr/src/INSTALL).",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#basilisk-framework",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Registration & Resources",
    "content": "Registration for this pre-conference session is handled through [ECS 2025](https://ecs2025.org/program/#program). **Technical Support:** vatsal.sanjay@comphy-lab.org Course Examples & Resources",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#registration-resources",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "\"Basilisk for Multiphase Flow Simulations\" - Expected Outcomes",
    "content": "By the end of this intensive 3-hour session, participants will: - **Execute Basilisk simulations** confidently on their own systems - **Modify key parameters** to explore different physical scenarios - **Understand VOF methodology** for interface tracking in multiphase flows - **Apply to coating processes** through the Landau-Levich example - **Connect theory to practice** by relating simulation results to physical phenomena This training provides the foundation for applying high-fidelity simulation techniques to coating research, with immediate practical skills and clear pathways for advanced applications.",
    "url": "https://comphy-lab.org/teaching/2025-Basilisk101nano-ECS#expected-outcomes",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "Teaching - Teaching: Methods",
    "content": "Welcome to the CoMPhy Lab's educational resources. Apart from the university courses, we aim to develop and offer a range of workshops and tutorials on modern computational methods for multiphase flows and high-fidelity simulations. High-Fidelity Simulations Using Basilisk C Universidad Carlos III de Madrid March 10-13, 2025 A comprehensive course on using Basilisk C for simulating multiphase flows, interface tracking, and solving conservation equations. Learn to tackle complex fluid dynamics problems with high-fidelity numerical methods. View Course Basilisk for Multiphase Flow Simulations European Coating Symposium 2025 September 15, 2025 Intensive 3-hour pre-conference training focused on coating applications. Learn Basilisk fundamentals through hands-on examples: heat conduction, drop impact dynamics, and Landau-Levich dip coating.",
    "url": "https://comphy-lab.org/teaching/#teaching",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "Teaching - Teaching: Introduction",
    "content": "View Course Introduction to Soft Matter Durham University Fall 2025 Comprehensive lecture notes covering fundamental concepts in soft matter physics and their applications. View Lecture Notes",
    "url": "https://comphy-lab.org/teaching/#teaching",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "Teaching - About Our Teaching Philosophy",
    "content": "At CoMPhy Lab, we believe in hands-on learning and deep understanding of computational methods. Our courses combine theoretical foundations with practical implementation, allowing students to develop both conceptual understanding and technical skills. Our teaching approach emphasizes: - **Think before you compute**: Understanding the underlying physics before implementation - **Modular code structure**: Building maintainable and extensible computational tools - **Advanced numerical methods**: Mastering state-of-the-art techniques for complex problems - **Open science**: Sharing knowledge and tools with the scientific community. Checkout If you're interested in hosting a course or workshop with CoMPhy Lab, please [contact us](/join) for collaboration opportunities.",
    "url": "https://comphy-lab.org/teaching/#about-our-teaching-philosophy",
    "type": "website_section",
    "priority": 3
  },
  {
    "title": "0_readme - Computational Multiphase Physics <br> (CoMPhy)",
    "content": "Welcome to the CoMPhy Lab's documentation hub! We are based at the Physics of Fluids Department at the University of Twente, where we explore non-Newtonian free-surface flows and soft matter singularities.",
    "url": "https://blogs.comphy-lab.org/0_README/#computational-multiphase-physics-br-comphy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Double Network Hydroget:",
    "content": "2025-10-31 [[2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter]]: Why double-network hydrogels combine stiffness and toughness without shattering - elastic screening mechanisms that prevent crack cascades by damping stress propagation between sacrificial bonds.",
    "url": "https://blogs.comphy-lab.org/0_README/#double-network-hydroget",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Scientist profiles & history:",
    "content": "2025-10-24 [[2025-Emmy-Noether-Symmetry-Conservation]]: Emmy Noether's revolutionary contributions to mathematics and physics - from overcoming gender barriers in academia to discovering the profound connection between symmetry and conservation laws that now underpins all of modern physics.",
    "url": "https://blogs.comphy-lab.org/0_README/#scientist-profiles-history",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Laser-droplet interactions:",
    "content": "2025-10-06 [[2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets]]: Understanding how laser-induced pressure impulses control droplet sheet curvature in EUV lithography - from raised-cosine impulses to forward-bending sheets in tin microdroplets.",
    "url": "https://blogs.comphy-lab.org/0_README/#laser-droplet-interactions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Computational tools & visualization:",
    "content": "2025-10-01 [[2025-visual-pdes]]: Interactive browser-based PDE simulator - exploring pattern formation, reaction-diffusion systems, and mathematical visualization through GPU-accelerated simulations. A \"Desmos for PDEs\" that runs in your browser.",
    "url": "https://blogs.comphy-lab.org/0_README/#computational-tools-visualization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Elastoinertial turbulence:",
    "content": "2025-02-24 [[2025-Arrowheads-in-elastoinertial-turbulence]]: Critical review of arrowhead structures in elastoinertial turbulence, examining their existence in 3D flows and experimental observations.",
    "url": "https://blogs.comphy-lab.org/0_README/#elastoinertial-turbulence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Drop impact dynamics:",
    "content": "2025-02-22 [[2025-JFM-viscous-drop-impact]]: Comprehensive study of viscosity's role in drop impact forces, from raindrops to inkjet printing applications.",
    "url": "https://blogs.comphy-lab.org/0_README/#drop-impact-dynamics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Capillary waves:",
    "content": "2025-01-11 [[2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence]]: Analysis of capillary wave dynamics during bubble coalescence, focusing on energy transfer and wave propagation mechanisms.",
    "url": "https://blogs.comphy-lab.org/0_README/#capillary-waves",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - H-B formulation:",
    "content": "2024-12-31 [[2025-Herschel\u2013Bulkley-formulation]]: Mathematical formulation of the Herschel-Bulkley model for non-Newtonian flows, with emphasis on yield stress fluids.",
    "url": "https://blogs.comphy-lab.org/0_README/#h-b-formulation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Basilisk101",
    "content": "[Basilisk101](Lecture-Notes/Basilisk101/0-README.md): Comprehensive course on computational fluid dynamics using the Basilisk C framework. Topics include: - Conservation laws and numerical solutions of Navier-Stokes equations - Transport equations and interface tracking methods - Non-Newtonian flows and viscoelasticity - Multi-phase flows and contact line dynamics - Hands-on coding assignments with practical implementations",
    "url": "https://blogs.comphy-lab.org/0_README/#basilisk101",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Introduction to Soft Matter",
    "content": "[Intro-Soft-Matter](Lecture-Notes/Intro-Soft-Matter/0-README.md): Graduate-level course exploring soft condensed matter physics. Course structure includes: - Fundamental concepts: What makes materials \"soft\"? - Viscosity and momentum diffusion from kinetic theory - Soft matter instabilities and singularities - Rheology and viscoelastic behavior - Weekly lectures with self-assessed homework and student presentations",
    "url": "https://blogs.comphy-lab.org/0_README/#introduction-to-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Individual Lecture Notes:",
    "content": "2025-01-21 [[Gauss-law-of-Electrostatics]]: Analysis of electric field flux through different surfaces using Gauss's law, with visual demonstrations.",
    "url": "https://blogs.comphy-lab.org/0_README/#individual-lecture-notes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Conference Presentations:",
    "content": "2025-06-30 [[2025-06-30_Conference-VPflow-abstract]]: VPflow conference abstract on taming singularities through yield-stress regularization in bubble-bursting, exploring how viscoplasticity suppresses Worthington jetting.",
    "url": "https://blogs.comphy-lab.org/0_README/#conference-presentations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Seminar Presentations:",
    "content": "2025-02-21 [[Seminar-Drosophila-continuum-mechanics]]: Durham University seminar exploring polymeric flows as a tunable testbed for unsteady, nonlinear continuum mechanics. 2025-01-19 [[Seminar-UIUC-abstract]]: UIUC fluid seminar investigating how polymers modify classical hydrodynamic singularities in free-surface flows.",
    "url": "https://blogs.comphy-lab.org/0_README/#seminar-presentations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Connect With Us",
    "content": "- \ud83c\udf10 Website: [comphy-lab.org](http://www.comphy-lab.org) - \ud83d\udce7 Email: [vatsalsy@comphy-lab.org](mailto:vatsalsy@comphy-lab.org) - \ud83d\udc26 Twitter: [@VatsalSanjay](https://twitter.com/VatsalSanjay) - \ud83d\udcbb GitHub: [github.com/VatsalSy](https://github.com/VatsalSy)",
    "url": "https://blogs.comphy-lab.org/0_README/#connect-with-us",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Contributing: We welcome contributions...",
    "content": "We welcome contributions from researchers, students, and collaborators. Here's how you can contribute: 1. **Issues**: Found a problem or have a suggestion?",
    "url": "https://blogs.comphy-lab.org/0_README/#contributing",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_readme - Contributing: Choose an option...",
    "content": "Choose an option below: - [\ud83d\udde3\ufe0f Request a new blog topic](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/issues/new?template=blog_topic_request.md&labels=blog-request,enhancement) - [\ud83d\udcda Request documentation](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/issues/new?template=documentation_request.md&labels=documentation) - [\ud83d\udd0d Report content correction](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/issues/new?template=content_correction.md&labels=correction) 2. **Pull Requests**: Want to contribute directly? - Fork the repository - Make your changes (it can simply be correcting grammar or making a new post - simply write in plain text or markdown format and add it to the root folder). - Submit a pull request with a clear description of your changes Visit our [GitHub repository](https://github.com/comphy-lab/CoMPhy-Lab-Blogs) to get started. --- *Note: This documentation is maintained by the CoMPhy Lab team and is regularly updated with our latest research findings and computational methods.* > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/0_README/#contributing",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public",
    "content": "![CoMPhy-Lab](_Media/CoMPhy-Lab-no-name.png) Here is a list of things on our to-publish list: - [ ] Stokes waves and related topics \ud83d\udcc5 2025-12-01 ^E1A6F85F-5E63-405E-9EF7-E8CC8662D3CC - [x] Showcase bubbles, waves: \ud83d\udcc5 2025-01-12 ^0B681993-8C8A-49A5-93B6-83368684058E",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "0_todo blog public - To-Do: Blog Posts on Research Papers and Thesis",
    "content": "Below is a list of all the papers and the thesis requiring a dedicated blog post. Each post should highlight the motivation, key findings, and broader implications of the work, along with engaging visuals or videos (where applicable). ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#to-do-blog-posts-on-research-papers-and-thesis",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - Work in Progress",
    "content": "- [ ] **To jump or not to jump: Adhesion and viscous dissipation dictate the detachment of coalescing wall-attached bubbles** Link: [arXiv:2501.05532](https://arxiv.org/abs/2501.05532) - [ ] **Viscoelastic Worthington jets & droplets produced by bursting bubbles** Link: [arXiv:2408.05089](https://arxiv.org/abs/2408.05089) - [ ] **Unifying theory of scaling in drop impact: Forces & maximum spreading diameter** Link: [arXiv:2408.12714](https://arxiv.org/abs/2408.12714) - [ ] **Electrolyte spraying within H\u2082 bubbles during water electrolysis** Link: [arXiv:2409.00515](https://arxiv.org/abs/2409.00515) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#work-in-progress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2025",
    "content": "- [ ] **The role of viscosity on drop impact forces on non-wetting surfaces** Link: [arXiv:2311.03012](https://arxiv.org/abs/2311.03012) - [ ] **Focusing of concentric free-surface waves** Link: [arXiv:2406.05416](https://arxiv.org/abs/2406.05416) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2025",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2024",
    "content": "- [ ] **Bursting bubble in an elastoviscoplastic medium** Highlight: Cover of _J. Fluid Mech._ Link: [DOI](https://doi.org/10.1017/jfm.2024.109) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2024",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2023",
    "content": "- [ ] **Drop impact on viscous liquid films** Link: [DOI](https://doi.org/10.1017/jfm.2023.895) - [ ] **When does an impacting drop stop bouncing?** Link: [DOI](https://doi.org/10.1017/jfm.2023.896) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2023",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2022",
    "content": "- [ ] **Ph.D. Thesis: Viscous free-surface flows** Links: [Thesis Info](https://www.vatsalsanjay.com/phd-thesis), [DOI](https://doi.org/10.3990/1.9789036554077), move here from old website - [ ] **Impact forces of water drops falling on superhydrophobic surfaces** Highlights: Editor's Suggestion, Research Highlight in _Nature_ Link: [DOI](https://doi.org/10.1103/PhysRevLett.129.104501) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2022",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2021",
    "content": "- [ ] **Bursting bubble in a viscoplastic medium** Link: [DOI](https://doi.org/10.1017/jfm.2021.489) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2021",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2020",
    "content": "- [ ] **Lifting a sessile oil drop from a superamphiphobic surface with an impacting one** Link: [DOI](https://doi.org/10.1126/sciadv.aba4330) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2020",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2019",
    "content": "- [ ] **Consequences of inclined and dual jet impingement in stagnant liquid and stratified layers** Link: [DOI](https://doi.org/10.1002/aic.16373) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2019",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2018",
    "content": "- [ ] **Formation of fluid structures due to jet-jet and jet-sheet interactions** Link: [DOI](https://doi.org/10.1016/j.ces.2018.06.055) - [ ] **Numerical assessment of hazard in compartmental fire having steady heat release rate from the source** Link: [DOI](https://doi.org/10.1007/s12273-017-0411-y) ---",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2018",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0_todo blog public - 2017",
    "content": "- [ ] **Formation of liquid chain by collision of two laminar jets** Link: [DOI](https://doi.org/10.1063/1.4998288) - [ ] **On air entrainment in a water pool by impingement of a jet** Link: [DOI](https://doi.org/10.1002/aic.15828) --- > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/0_ToDo-Blog-public/#2017",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - CLAUDE.md",
    "content": "This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#claudemd",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Repository Overview",
    "content": "This is a research blog repository for the Computational Multiphase Physics (CoMPhy) Lab, containing academic content in Markdown format. The site is published at [blogs-comphy-lab.org](https://blogs-comphy-lab.org/).",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#repository-overview",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Content Structure",
    "content": "- `Blog/` - Research blog posts and updates - `Code-Documentations/` - Technical documentation - `Lecture-Notes/` - Teaching materials and course content - `Talks/` - Presentation materials and abstracts - `_AtomicNotes/` - Atomic knowledge pieces (linked notes) - `_Media/` - Images and media files - `_scripts/` - Jupyter notebooks for generating figures",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#content-structure",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Markdown Files",
    "content": "All content uses Markdown with YAML frontmatter: ```yaml --- created: YYYY-MM-DDThh:mm:ss+01:00 modified: YYYY-MM-DDThh:mm:ss+01:00 status: [Published/Working/Draft/done \u2705] website: https://blogs-comphy-lab.org/your-post-url --- ```",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#markdown-files",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Obsidian Features",
    "content": "- Wiki-style links: `[[post-name]]` and `[[post-name|alias]]` - Image embedding: `![[_Media/filename.png]]` - Callouts: `> [!note]`, `> [!tldr]`, `> [!important]`",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#obsidian-features",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - PDF Export",
    "content": "Convert Markdown to PDF using the export script: ```bash ./.obsidian/scripts/export-pdf.sh \"filename.md\" ``` The script handles: - Obsidian syntax conversion to standard Markdown - Image path processing - Bibliography integration via Pandoc - LaTeX/XeLaTeX PDF generation",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#pdf-export",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Content Validation",
    "content": "- Ensure all images exist in `_Media/` directory - Verify wiki links point to existing content - Check YAML frontmatter format",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#content-validation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - File Organization",
    "content": "- Place new blog posts in `Blog/` - Store images in `_Media/` with descriptive names - Use atomic notes in `_AtomicNotes/` for reusable concepts",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#file-organization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Mathematical Content",
    "content": "- Use LaTeX syntax for equations: `$$equation$$` or `$inline$` - Include Jupyter notebooks in `_scripts/` for computational examples - Save generated plots to `_Media/`",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#mathematical-content",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Academic Standards",
    "content": "- Include proper citations and references - Use descriptive filenames without spaces - Maintain consistent notation across related posts",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#academic-standards",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Claude - Publishing Workflow",
    "content": "Content is managed through: 1. Obsidian vault for local editing 2. Git version control for collaboration 3. Website deployment at blogs-comphy-lab.org The repository supports both individual researchers and collaborative editing through GitHub's issue templates and pull request workflow.",
    "url": "https://blogs.comphy-lab.org/CLAUDE/#publishing-workflow",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Private todo blog public - Elasticity and viscoelasticity",
    "content": "- [ ] Jacco paper Elasticity and viscoelasticity \ud83d\udcc5 2025-11-09 ^9A6D89F2-1B19-460B-9DAD-DAB0109C0BC3 - [ ] all about the elastic mapping \ud83d\udcc5 2025-11-11 ^499BBFE0-EB2C-48CD-B8F4-7DFA004C79A7",
    "url": "https://blogs.comphy-lab.org/Private-ToDo-Blog-public/#elasticity-and-viscoelasticity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Coarse-Grained Continuum Mechanics \u2013 Conservation Laws",
    "content": "> Here, we only consider the continuum picture. > See [[2.5-Conservation-Laws]] for first principle derivations",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#coarse-grained-continuum-mechanics-conservation-laws",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Bridging Microscopic to Continuum Description",
    "content": "Introduction to Coarse-Graining: - How we average over many atoms/molecules to treat a material as continuous fields - Density, velocity, etc. on scales large compared to molecular size - Motivation for continuum view in soft matter - Example: A polymer solution or foam modeled as a continuous medium despite discrete entities",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#bridging-microscopic-to-continuum-description",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Fundamental Conservation Laws",
    "content": "Derived via coarse-graining: 1. Conservation of Mass (continuity equation) 2. Conservation of Momentum (Newton's second law in continuum form \u2192 Euler or Navier-Stokes equations) 3. Conservation of Energy (first law of thermodynamics in continuum form)",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#fundamental-conservation-laws",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Physical Meaning of Conservation Laws",
    "content": "Integral Form: - What goes in minus what goes out = accumulation Differential Form: - Local divergence form - Changes at a point due to flows or sources at that point",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#physical-meaning-of-conservation-laws",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - The Continuum Hypothesis",
    "content": "Assumptions: - Material properties vary smoothly - Can be defined at a \"point\" much larger than molecular scale - Point must be small compared to system size - Scales much larger than the mean free path of the molecules $\\lambda$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#the-continuum-hypothesis",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Field Variables",
    "content": "Result of coarse-graining: - Velocity field: $\\boldsymbol{v}(\\boldsymbol{r}, t)$ - Pressure: $p(\\boldsymbol{r}, t)$ - Density: $\\rho(\\boldsymbol{r}, t)$ - etc.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#field-variables",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Learning Outcomes",
    "content": "1. State the three main conservation laws - Mass, momentum, energy in words - Recognize their mathematical forms 1. Derive a basic continuity equation - Starting from a small fixed volume - Show that mass change = (mass in) \u2013 (mass out) - Translate to: $\\frac{\\partial \\rho}{\\partial t} + \\nabla\\cdot(\\rho \\boldsymbol{v}) = 0$ 1. Identify terms in momentum equation - Understand: $\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot \\boldsymbol{\\sigma} + \\boldsymbol{f}_{\\text{ext}}$ - In words: mass\u00d7acceleration = forces from stress gradient + external forces - Grasp where inertia, pressure, and viscosity enter 1. Connect to physical reasoning - Apply conservation laws to simple scenarios - Example: Squeezing toothpaste tube (mass conservation + incompressibility) - Example: Fluid speeding up in narrow pipe (continuity with constant flow rate) - Articulate local vs global conservation (nothing \"teleports\")",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#learning-outcomes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - 1. Conservation of Mass",
    "content": "Physical Statement: Mass cannot be created or destroyed (for systems without nuclear reactions or relativistic effects). Integral Form: $$\\frac{d}{dt}\\int_V \\rho \\, dV = -\\int_S \\rho \\boldsymbol{v} \\cdot \\boldsymbol{n} \\, dS$$ Differential Form (Continuity Equation): $$\\frac{\\partial \\rho}{\\partial t} + \\nabla\\cdot(\\rho \\boldsymbol{v}) = 0$$ For incompressible fluids (constant density): $$\\nabla\\cdot\\boldsymbol{v} = 0$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#1-conservation-of-mass",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - 2. Conservation of Momentum",
    "content": "Physical Statement: Newton's second law applied to a fluid element: Rate of change of momentum equals sum of forces. Differential Form: $$\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot \\boldsymbol{\\sigma} + \\boldsymbol{f}_{\\text{ext}}$$ Where: - $\\frac{D}{Dt}$ = material derivative (following fluid parcel) - $\\boldsymbol{\\sigma}$ = stress tensor - $\\boldsymbol{f}_{\\text{ext}}$ = external body forces (e.g., gravity) For Newtonian fluids (Navier-Stokes): $$\\rho \\left(\\frac{\\partial \\boldsymbol{v}}{\\partial t} + \\boldsymbol{v}\\cdot\\nabla\\boldsymbol{v}\\right) = -\\nabla p + \\eta \\nabla^2 \\boldsymbol{v} + \\boldsymbol{f}_{\\text{ext}}$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#2-conservation-of-momentum",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - 3. Conservation of Energy",
    "content": "Physical Statement: First law of thermodynamics: Change in energy equals heat added plus work done. Differential Form: $$\\rho \\frac{De}{Dt} = -\\nabla\\cdot\\boldsymbol{q} + \\boldsymbol{\\sigma}:\\nabla\\boldsymbol{v}$$ Where: - $e$ = specific internal energy - $\\boldsymbol{q}$ = heat flux - $\\boldsymbol{\\sigma}:\\nabla\\boldsymbol{v}$ = viscous dissipation term",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#3-conservation-of-energy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Mass Conservation Example",
    "content": "Pipe Flow: - Water flowing through a pipe that splits into two branches - If 2 L/min enters, sum out of branches must be 2 L/min (steady state, incompressible) - Illustrates: $\\dot{m}_{\\text{in}} = \\dot{m}_{\\text{out}}$ Variable Cross-Section: - If one branch is partially closed, water velocity increases there - Smaller area \u2192 higher speed to satisfy continuity - Analogous to blood flow speeding up in a narrowed artery",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#mass-conservation-example",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Momentum Conservation Example",
    "content": "Soft Gel in Slingshot: - When stretched and released, momentum is transferred to the gel - Causes it to fly - Continuum terms: Internal elastic forces (stress) accelerated the gel's mass Stone in Pond: - Dropping a stone in a pond - Momentum from gravity and impact is redistributed via: - Pressure waves (sound) - Fluid motion - Violating momentum conservation locally leads to observable flows",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#momentum-conservation-example",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Energy Conservation Example",
    "content": "Silly Putty Ball: - Dropped from height, deforms and warms slightly on impact - Potential energy \u2192 deformation work + heat - Illustrates energy bookkeeping Mixing Fluids: - Slow mixing of glycerol and water - Mechanical work (stirring) dissipated as heat via viscous stress - Internal energy increase consistent with energy conservation",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#energy-conservation-example",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Key Equations Summary",
    "content": "| Conservation Law | Differential Form | Key Insight | |-----------------|-------------------|-------------| | Mass | $\\frac{\\partial \\rho}{\\partial t} + \\nabla\\cdot(\\rho \\boldsymbol{v}) = 0$ | Local density change = net flux | | Momentum | $\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot \\boldsymbol{\\sigma} + \\boldsymbol{f}_{\\text{ext}}$ | Acceleration from stress + body forces | | Energy | $\\rho \\frac{De}{Dt} = -\\nabla\\cdot\\boldsymbol{q} + \\boldsymbol{\\sigma}:\\nabla\\boldsymbol{v}$ | Energy change = heat flux + work |",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#key-equations-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - Key Concepts to Remember",
    "content": "- Coarse-graining: Averaging microscopic behavior to obtain continuum fields - Field variables: Density, velocity, pressure as functions of position and time - Local conservation: Changes at a point due to local fluxes/sources only - Continuum hypothesis: Valid when system >> molecular scale - Incompressibility: Common assumption for liquids ($\\nabla\\cdot\\boldsymbol{v} = 0$)",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#key-concepts-to-remember",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Continuum mechanics integral formulation - References",
    "content": "1. Continuity equation - Wikipedia: https://en.wikipedia.org/wiki/Continuity_equation 2. Batchelor, G.K. \"An Introduction to Fluid Dynamics\" (1967) 3. Landau & Lifshitz \"Fluid Mechanics\" (1987) ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Continuum-Mechanics-Integral-Formulation/#references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - The Key Formula",
    "content": "$$\\boxed{\\partial_t \\delta_i(\\boldsymbol{r}, t) = -\\dot{\\boldsymbol{r}}_i(t) \\cdot \\nabla_{\\boldsymbol{r}} \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t)) = -\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta_i}$$ > [!tldr] Advection of spikes > The time rate of change of a delta spike (at a fixed observation point $\\boldsymbol{r}$) equals minus the spatial gradient of the spike, weighted by the spike's velocity. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#the-key-formula",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Why This Matters",
    "content": "This identity is the entire bridge from particle dynamics to continuum field equations. When you have microscopic density $\\rho = \\sum_i m_i \\delta_i$ and momentum $\\boldsymbol{g} = \\sum_i m_i \\boldsymbol{v}_i \\delta_i$, the moving delta identity lets you convert time derivatives into spatial divergences\u2014exactly what you need for PDEs. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#why-this-matters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (1) Chain Rule Picture \u2014 The Physicist's Proof: Setup: Let $\\boldsymbol{s}(\\boldsymbol{r},...",
    "content": "Setup: Let $\\boldsymbol{s}(\\boldsymbol{r}, t) = \\boldsymbol{r} - \\boldsymbol{r}_i(t)$ be the vector from the particle to the observation point.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#1-chain-rule-picture-the-physicists-proof",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (1) Chain Rule Picture \u2014 The Physicist's Proof: Function Definition",
    "content": "Key observation: The delta is a function of $\\boldsymbol{s}$, not explicitly of $\\boldsymbol{r}$ or $t$ separately: $$\\delta_i(\\boldsymbol{r}, t) = \\delta(\\boldsymbol{s}(\\boldsymbol{r}, t)) = \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t))$$ Apply chain rule: $$\\partial_t \\delta_i = \\nabla_{\\boldsymbol{s}} \\delta(\\boldsymbol{s}) \\cdot \\partial_t \\boldsymbol{s}$$ Compute the time derivative of $\\boldsymbol{s}$: $$\\partial_t \\boldsymbol{s} = \\partial_t(\\boldsymbol{r} - \\boldsymbol{r}_i(t)) = 0 - \\dot{\\boldsymbol{r}}_i(t) = -\\boldsymbol{v}_i(t)$$ (The gradient $\\nabla_{\\boldsymbol{r}}$ has no time dependence; only the position $\\boldsymbol{r}_i(t)$ changes.) Substitute: $$\\partial_t \\delta_i = \\nabla_{\\boldsymbol{s}} \\delta(\\boldsymbol{s}) \\cdot (-\\boldsymbol{v}_i) = -\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i)$$ The intuition: It's just the chain rule.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#1-chain-rule-picture-the-physicists-proof",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (1) Chain Rule Picture \u2014 The Physicist's Proof: The only time-dependence...",
    "content": "The only time-dependence in the delta is through the particle position $\\boldsymbol{r}_i(t)$, so $\\partial_t \\delta$ picks up the rate at which that argument is changing. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#1-chain-rule-picture-the-physicists-proof",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (2) Distribution / Test-Function Proof \u2014 The Rigorous Way: For a Dirac...",
    "content": "For a Dirac delta to be well-defined, we test it against smooth functions.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#2-distribution-test-function-proof-the-rigorous-way",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (2) Distribution / Test-Function Proof \u2014 The Rigorous Way: Definitions - Function Definition",
    "content": "For any smooth function $\\varphi(\\boldsymbol{r})$: $$\\int_{\\text{all space}} \\varphi(\\boldsymbol{r}) \\, \\partial_t \\delta_i(\\boldsymbol{r}, t) \\, d^3\\boldsymbol{r} = ?$$ Apply the definition of $\\partial_t \\delta_i$: $$= \\frac{d}{dt} \\int \\varphi(\\boldsymbol{r}) \\, \\delta_i(\\boldsymbol{r}, t) \\, d^3\\boldsymbol{r} = \\frac{d}{dt} \\varphi(\\boldsymbol{r}_i(t))$$ Use the chain rule on the RHS: $$\\frac{d}{dt} \\varphi(\\boldsymbol{r}_i(t)) = \\nabla \\varphi(\\boldsymbol{r}_i) \\cdot \\dot{\\boldsymbol{r}}_i = \\boldsymbol{v}_i \\cdot \\nabla \\varphi(\\boldsymbol{r}_i)$$ Use integration by parts on $\\int \\varphi \\, (-\\boldsymbol{v}_i \\cdot \\nabla \\delta_i)$ (assuming no boundary terms): $$\\int \\varphi \\, (-\\boldsymbol{v}_i \\cdot \\nabla \\delta_i) \\, d^3\\boldsymbol{r} = -\\int (\\boldsymbol{v}_i \\cdot \\nabla \\varphi) \\, \\delta_i \\, d^3\\boldsymbol{r} = -\\boldsymbol{v}_i \\cdot \\nabla \\varphi(\\boldsymbol{r}_i)$$ Compare: Both sides give the same result for any test function $\\varphi$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#2-distribution-test-function-proof-the-rigorous-way",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (2) Distribution / Test-Function Proof \u2014 The Rigorous Way: Therefore, as distributions:...",
    "content": "Therefore, as distributions: $$\\partial_t \\delta_i = -\\boldsymbol{v}_i \\cdot \\nabla \\delta_i$$ The key insight: A delta's 'value' is defined by how it acts on test functions. When you test both sides against $\\varphi$, you get the same answer\u2014so the distributions are equal. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#2-distribution-test-function-proof-the-rigorous-way",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - (3) One-Dimensional Sanity Check",
    "content": "Consider a 1D moving spike: $\\rho(x, t) = \\delta(x - x_i(t))$ with $x_i(t) = vt$ (constant velocity). Sketch it: ``` t = 0: t = \u0394t: t = 2\u0394t: \u2193 \u2193 \u2193 | | | x = 0 x = v\u0394t x = 2v\u0394t ``` What you observe at a fixed point $x$: - If the spike hasn't arrived yet ($x 0$. And you're about to see the spike, so $\\partial_t \\rho > 0$. [OK] - Just *after* the spike passes: the slope is *positive* (rising to the right, but the spike has moved past), so $-v \\partial_x \\delta < 0$. And the spike is gone, so $\\partial_t \\rho < 0$. [OK] The sign checks out: $\\partial_t \\delta = -v \\partial_x \\delta$. The physical picture: At a fixed $x$, the spike moves past you. The time change you see is opposite to the spatial slope it leaves behind. A negative slope means the spike is moving away (future: negative change). A positive slope means it's approaching (future: positive change). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#3-one-dimensional-sanity-check",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Pitfall 1: \"Why the minus sign?\"",
    "content": "The question: Why isn't it just $\\partial_t \\delta_i = \\boldsymbol{v}_i \\cdot \\nabla \\delta_i$? The answer: Because $\\partial_t(\\boldsymbol{r} - \\boldsymbol{r}_i) = -\\dot{\\boldsymbol{r}}_i$. The argument of the delta is *position relative to the particle*, so when the particle moves forward, the argument moves backward. The minus sign accounts for this reversal. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#pitfall-1-why-the-minus-sign",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Pitfall 2: \"Shouldn't $\\nabla$ act on $\\boldsymbol{v}_i$ too?\"",
    "content": "The question: When you write $\\partial_t \\delta_i = -\\boldsymbol{v}_i \\cdot \\nabla \\delta_i$, why doesn't the gradient hit the velocity? The answer: $\\nabla$ is the Eulerian gradient\u2014it differentiates w.r.t. the field coordinate $\\boldsymbol{r}$, not w.r.t. the particle position $\\boldsymbol{r}_i$. The velocity $\\boldsymbol{v}_i = \\dot{\\boldsymbol{r}}_i(t)$ is a *Lagrangian* quantity (it depends on $t$ and the particle index $i$, not on the field point $\\boldsymbol{r}$). So $\\nabla_{\\boldsymbol{r}} \\boldsymbol{v}_i = 0$. See [[Lecture2-DyadicConversion|the dyadic note]] for more on this distinction. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#pitfall-2-shouldnt-nabla-act-on-boldsymbolvi-too",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Pitfall 3: \"This is just kinematics, right?\"",
    "content": "Yes! This identity has nothing to do with physics\u2014it's pure mathematics. It holds for *any* moving spike, whether the particle is a gas molecule, a dust grain, or a labeled point in a flow. The physics comes in when you specify what equation the particle obeys (Newton's law, Langevin equation, etc.). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#pitfall-3-this-is-just-kinematics-right",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Using the Identity: Example \u2014 Mass Continuity",
    "content": "Given: $$\\rho(\\boldsymbol{r}, t) = \\sum_i m_i \\, \\delta_i(\\boldsymbol{r}, t), \\quad \\boldsymbol{g}(\\boldsymbol{r}, t) = \\sum_i m_i \\, \\boldsymbol{v}_i(t) \\, \\delta_i(\\boldsymbol{r}, t)$$ Compute $\\partial_t \\rho$: $$\\partial_t \\rho = \\sum_i m_i \\, \\partial_t \\delta_i = -\\sum_i m_i \\, \\boldsymbol{v}_i \\cdot \\nabla \\delta_i$$ Factor out the gradient (it's linear and acts only on $\\boldsymbol{r}$): $$\\partial_t \\rho = -\\nabla \\cdot \\sum_i m_i \\, \\boldsymbol{v}_i \\, \\delta_i = -\\nabla \\cdot \\boldsymbol{g}$$ Result: $$\\boxed{\\partial_t \\rho + \\nabla \\cdot \\boldsymbol{g} = 0}$$ This is the microscopic continuity equation. No approximation\u2014it's exact for point particles. The moving delta identity is the entire algebra. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#using-the-identity-example-mass-continuity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Moving delta identity - Summary: Comparison of the Three Approaches",
    "content": "| Approach | Benefits | Trade-offs | |---|---|---| | Chain rule (physicists) | Intuitive, fast, gets the sign right | Glosses over distribution theory | | Test function (rigorous) | Mathematically airtight, generalizes to broader contexts | More abstract, harder to visualize | | 1D sketch (pedagogical) | Great for intuition, builds confidence | Only works in 1D; requires careful visualization | For deep understanding: Work through all three approaches. The chain rule provides speed and intuition, the test function approach ensures mathematical rigor, and the 1D sketch offers a concrete gut check. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Moving-Delta-identity/#summary-comparison-of-the-three-approaches",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Permittivity of free space",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:05 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/permittivity-of-free-space/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "Permittivity of free space - Permittivity of free space",
    "content": "In Gauss\u2019s law, $\\varepsilon$ the permittivity of free space. It quantifies how an electric field propagates through a vacuum. In the standard form of Gauss\u2019s law, $\\oint \\boldsymbol{E}\\cdot d\\boldsymbol{A} \\;=\\; \\frac{Q_{\\text{enc}}}{\\varepsilon_0},$ appears as the proportionality constant relating the net electric flux through a closed surface to the total charge enclosed. Numerically, $\\varepsilon_0 \\approx 8.854 \\times 10^{-12}\\,\\mathrm{F/m}$. It also factors into the relationship between the speed of light $c$, the vacuum permeability $\\mu_0$, and itself, via $c = \\frac{1}{\\sqrt{\\varepsilon_0\\,\\mu_0}}$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/permittivity-of-free-space/#permittivity-of-free-space",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Relationship between rate of change of a physical quantity and its divergence - Relationship between rate of change of a physical quantity and its divergence",
    "content": "For a conserved quantity (like mass, momentum, or energy), the local rate of change within a volume is directly linked to the divergence of its flux. In particular, conservation laws often take the form: $$\\frac{\\partial \\phi}{\\partial t} + \\nabla \\cdot \\boldsymbol{J} = 0$$ where $\\phi$ is the density of the conserved quantity and $\\boldsymbol{J}$ is its flux. Integrating over a volume and applying the divergence theorem: $$\\int_V \\frac{\\partial \\phi}{\\partial t} \\, dV + \\oint_{\\partial V} \\boldsymbol{J}\\cdot d\\boldsymbol{A} = 0$$ shows that the rate of change of $\\phi$ in that volume (the first term) is exactly balanced by the net flux across the boundary (the second term). Thus, $\\nabla \\cdot \\boldsymbol{J}$ encapsulates the `source` or `sink` behavior within the volume and is intimately connected to how $\\phi$ changes over time.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Relationship-between-rate-of-change-of-a-physical-quantity-and-its-divergence/#relationship-between-rate-of-change-of-a-physical-quantity-and-its-divergence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Geometric description of electric field",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:03 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Geometric-description-of-electric-field/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "Geometric description of electric field - Geometric description of electric field",
    "content": "* Field Lines: Draw lines so that at each point, their tangent matches the direction of $\\vec{E}$ * Density: The number of lines per unit area (normal to the lines) is proportional to $\\|\\vec{E}\\|$. * Direction: Arrows on the lines indicate the direction of $\\vec{E}$. * Interpretation: This visual map shows both the direction and magnitude of $\\vec{E}$ across space.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Geometric-description-of-electric-field/#geometric-description-of-electric-field",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "History of gauss",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:04 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/History-of-Gauss/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "History of gauss - History of Gauss (and one recent event):: Carl Friedrich Gauss...",
    "content": "Carl Friedrich Gauss (1777\u20131855) was a brilliant mathematician who made breakthroughs in just about every area of math and physics you can think of\u2013he crunched numbers like a prodigy even as a kid, later proved key theorems in algebra and laid the groundwork for number theory, geometry, and analysis. Beyond math, he helped calculate the orbit of the dwarf planet Ceres, co-invented an early telegraph, and teamed up with physicist Wilhelm Weber to measure and model the Earth\u2019s magnetic field. His name is attached to many concepts, including \"Gauss\u2019s law\" (topic of this blog) in electromagnetism, which is a cornerstone in understanding electric fields. Gauss\u2019s relentless curiosity earned him the nickname \"the Prince of Mathematicians,\u201d and his work remains at the heart of modern science and engineering.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/History-of-Gauss/#history-of-gauss-and-one-recent-event",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "History of gauss - History of Gauss (and one recent event):: Even today\u2014nearly two...",
    "content": "Even today\u2014nearly two centuries after his death\u2014people still visit his grave in G\u00f6ttingen to pay homage (see figure below, \ud83d\ude09). ![|250](_Media/20250120200507219_Gauss%20law%20of%20Electrostatics.png) Fig. Potrait made availale by Johann Christian August Schwartz - Carl Friedrich Gauss 1777-1855. Ausstellung zum 200. Geburtstag. St\u00e4dtisches Museum G\u00f6ttingen. 16. Januar bis 13. M\u00e4rz 1977. G\u00f6ttingen, 1977, Frontispiz., Public Domain, Link ![|250](_Media/20250120200806664_Gauss%20law%20of%20Electrostatics.png) Fig. Even after (almost) 200 years of his death, people still visit the grave of Carl Friedrich Gauss in G\u00f6ettingen to pay homage to the master.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/History-of-Gauss/#history-of-gauss-and-one-recent-event",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - The Problem",
    "content": "When we compute $\\partial_t \\boldsymbol{g}$ (the time derivative of momentum density), we get: $$\\partial_t \\boldsymbol{g} = \\sum_i m_i \\, \\dot{\\boldsymbol{v}}_i \\, \\delta_i + \\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i$$ The first term is easy (acceleration). The second term involves $\\boldsymbol{v}_i \\, \\partial_t \\delta_i$, which looks messy. This note shows how to turn it into a clean divergence of a dyadic tensor. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#the-problem",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - The Goal",
    "content": "Show that: $$\\boxed{\\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i = -\\nabla \\cdot \\sum_i m_i \\, \\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i}$$ where $\\boldsymbol{v}_i \\boldsymbol{v}_i$ is the outer product (dyad): in components, $(\\boldsymbol{v}_i \\boldsymbol{v}_i)_{\\alpha\\beta} = v_{i\\alpha} v_{i\\beta}$. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#the-goal",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Step 1: Use the moving delta identity",
    "content": "From [[Moving-Delta-identity|The moving delta identity]], we have: $$\\partial_t \\delta_i = -\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta_i$$ Substitute: $$\\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i = -\\sum_i m_i \\, \\boldsymbol{v}_i \\, (\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta_i)$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#step-1-use-the-moving-delta-identity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Step 2: The Key Insight \u2014 $\\nabla_{\\boldsymbol{r}}$ Does Not Act on $\\boldsymbol{v}_i$",
    "content": "This is crucial: When we write $\\nabla_{\\boldsymbol{r}}$, we mean the gradient with respect to the *field coordinate* $\\boldsymbol{r}$ (the spatial point where we observe the field). - $\\boldsymbol{v}_i(t) = \\dot{\\boldsymbol{r}}_i(t)$ is the Lagrangian velocity of particle $i$. It depends on the particle index $i$ and time $t$, but *not* on the field coordinate $\\boldsymbol{r}$. - When we take $\\nabla_{\\boldsymbol{r}}$ of something, we differentiate only w.r.t. $\\boldsymbol{r}$. - Therefore: $\\nabla_{\\boldsymbol{r}} \\boldsymbol{v}_i = 0$. > [!tldr] TL;DR > Treat $\\boldsymbol{v}_i(t)$ as a *constant vector* when we're doing spatial derivatives. The only spatial dependence is in the delta spikes. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#step-2-the-key-insight-nablaboldsymbolr-does-not-act-on-boldsymbolvi",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Step 3: Convert to Divergence of Dyad: Use the vector...",
    "content": "Use the vector identity: For any constant vector $\\boldsymbol{c}$ and any scalar field $f(\\boldsymbol{r})$: $$\\boldsymbol{c} (\\boldsymbol{c} \\cdot \\nabla f) = \\nabla \\cdot (\\boldsymbol{c} \\boldsymbol{c} \\, f)$$ Why?",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#step-3-convert-to-divergence-of-dyad",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Step 3: Convert to Divergence of Dyad: Use the product...",
    "content": "Use the product rule on the RHS: $$\\nabla \\cdot (\\boldsymbol{c} \\boldsymbol{c} \\, f) = (\\nabla \\cdot \\boldsymbol{c} \\boldsymbol{c}) f + \\boldsymbol{c} \\boldsymbol{c} : \\nabla f$$ The first term vanishes (the divergence of a constant dyad is zero), so: $$\\nabla \\cdot (\\boldsymbol{c} \\boldsymbol{c} \\, f) = \\boldsymbol{c} \\boldsymbol{c} : \\nabla f = \\boldsymbol{c}(\\boldsymbol{c} \\cdot \\nabla f)$$ (Here $:$ denotes the double-dot product: $\\boldsymbol{A} : \\nabla f = A_{\\alpha\\beta} \\partial_\\beta f$ summed over $\\alpha, \\beta$.) Apply with $\\boldsymbol{c} = \\boldsymbol{v}_i$ and $f = \\delta_i$: $$\\boldsymbol{v}_i (\\boldsymbol{v}_i \\cdot \\nabla \\delta_i) = \\nabla \\cdot (\\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i)$$ Substitute back: $$\\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i = -\\sum_i m_i \\, \\nabla \\cdot (\\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i) = -\\nabla \\cdot \\sum_i m_i \\, \\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#step-3-convert-to-divergence-of-dyad",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Component View (for those who prefer indices)",
    "content": "In index notation: Let $\\delta_i = \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i)$. Then: $$\\partial_t g_\\alpha = \\sum_i m_i \\, \\dot{v}_{i\\alpha} \\delta_i + \\sum_i m_i \\, v_{i\\alpha} \\, \\partial_t \\delta_i$$ Use $\\partial_t \\delta_i = -v_{i\\beta} \\partial_\\beta \\delta_i$: $$\\sum_i m_i \\, v_{i\\alpha} \\, \\partial_t \\delta_i = -\\sum_i m_i \\, v_{i\\alpha} v_{i\\beta} \\, \\partial_\\beta \\delta_i = -\\partial_\\beta \\left( \\sum_i m_i \\, v_{i\\alpha} v_{i\\beta} \\, \\delta_i \\right)$$ Define the kinetic momentum-flux tensor (as a matrix): $$K_{\\alpha\\beta}(\\boldsymbol{r}, t) = \\sum_i m_i \\, v_{i\\alpha} v_{i\\beta} \\, \\delta_i$$ Then: $$\\partial_t g_\\alpha + \\partial_\\beta K_{\\alpha\\beta} = \\sum_i m_i \\, \\dot{v}_{i\\alpha} \\, \\delta_i$$ Or in vector form: $$\\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{K} = \\sum_i m_i \\, \\dot{\\boldsymbol{v}}_i \\, \\delta_i$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#component-view-for-those-who-prefer-indices",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Interpretation: What is the Kinetic Momentum Flux?",
    "content": "$$\\boldsymbol{K}_{\\alpha\\beta} = \\sum_i m_i \\, v_{i\\alpha} v_{i\\beta} \\, \\delta_i$$ Physical meaning: This tensor describes the *transport of momentum* due to particle motion. - Diagonal component $K_{xx}$ = flux of $x$-momentum in the $x$-direction (normal stress) - Off-diagonal component $K_{xy}$ = flux of $x$-momentum in the $y$-direction (shear) When particles move with velocity $\\boldsymbol{v}$, they carry momentum $m\\boldsymbol{v}$ with them. If the velocity varies from point to point (e.g., shear flow), then momentum fluxes arise\u2014and those are captured by $\\boldsymbol{K}$. Example (1D, shear flow): If $v_x(y) = \\dot{\\gamma} y$ (linear shear), then: - Particles at height $y$ move faster than particles at height $y - \\lambda$. - Fast particles carry momentum downward and slow particles carry momentum upward. - The net *transport* of $x$-momentum in the $y$-direction is $\\boldsymbol{K}_{xy}$. - This is exactly where viscosity comes from! (See [[2-What-is-Viscosity]].) ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#interpretation-what-is-the-kinetic-momentum-flux",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Common Confusion: Why Is This a Dyad, Not a Vector?",
    "content": "Question: $\\boldsymbol{v}_i$ is a vector. Why does $\\boldsymbol{v}_i \\boldsymbol{v}_i$ (the outer product) give a tensor? Answer: When we write $\\boldsymbol{v}_i \\boldsymbol{v}_i$ in bold, it's shorthand for the outer product. The component form makes it clear: $$(\\boldsymbol{v}_i \\boldsymbol{v}_i)_{\\alpha\\beta} = v_{i\\alpha} \\, v_{i\\beta}$$ This is a 3\u00d73 matrix (or 2\u00d72 in 2D). When we take the divergence $\\nabla \\cdot \\boldsymbol{K}$, we get: $$(\\nabla \\cdot \\boldsymbol{K})_\\alpha = \\partial_\\beta K_{\\alpha\\beta} = \\partial_\\beta \\left( \\sum_i m_i v_{i\\alpha} v_{i\\beta} \\delta_i \\right)$$ which is a vector (summing over the second index). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#common-confusion-why-is-this-a-dyad-not-a-vector",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - Summary",
    "content": "| Term | Type | Meaning | |---|---|---| | $\\boldsymbol{v}_i(t)$ | Vector | Particle velocity (doesn't depend on field point $\\boldsymbol{r}$) | | $\\nabla_{\\boldsymbol{r}}$ | Operator | Gradient w.r.t. field coordinate $\\boldsymbol{r}$ | | $\\boldsymbol{v}_i \\boldsymbol{v}_i$ | Dyad (tensor) | Outer product; components $(v_{i\\alpha} v_{i\\beta})$ | | $\\boldsymbol{K} = \\sum_i m_i \\boldsymbol{v}_i \\boldsymbol{v}_i \\delta_i$ | Tensor field | Kinetic momentum-flux density | | $\\nabla \\cdot \\boldsymbol{K}$ | Vector field | Momentum transport due to bulk and thermal motion | ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Dyadic conversion - The Takeaway",
    "content": "> [!tldr] Summary > The key algebraic move is recognizing that $\\boldsymbol{v}_i (\\boldsymbol{v}_i \\cdot \\nabla \\delta_i)$ can be rewritten as $\\nabla \\cdot (\\boldsymbol{v}_i \\boldsymbol{v}_i \\delta_i)$ because $\\boldsymbol{v}_i$ is constant w.r.t. the field gradient $\\nabla_{\\boldsymbol{r}}$. > > This gives the microscopic momentum-flux tensor $\\boldsymbol{K}$, which\u2014when averaged\u2014contains both thermal and bulk contributions to stress. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Dyadic-conversion/#the-takeaway",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Executive summary (one-page take-home): * Microscopic fields...",
    "content": "* Microscopic fields are \"spiky.\" Mass and momentum live on particles.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#executive-summary-one-page-take-home",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Executive summary (one-page take-home): We introduce a...",
    "content": "We introduce a coarse-graining (ensemble or local spatial average) to obtain differentiable fields. * Microscopic momentum flux: Write $\\boldsymbol{\\Pi} = \\boldsymbol{K} + \\boldsymbol{C}$, with kinetic/convective $$K_{ij}(\\boldsymbol{r},t) = \\sum_n m_n v_{n,i}v_{n,j}\\,\\delta(\\boldsymbol{r}-\\boldsymbol{r}_n)$$ and configurational/force-transport $$C_{ij}(\\boldsymbol{r},t) = \\tfrac{1}{2}\\sum_{n\\neq m} r_{nm,j}F_{nm,i}\\int_0^1\\delta[\\boldsymbol{r}-(\\boldsymbol{r}_n+s\\boldsymbol{r}_{nm})]\\,ds$$ components. * Averaging and decomposition: After smoothing, $$\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} - \\boldsymbol{\\sigma},\\qquad \\boldsymbol{\\sigma} = \\underbrace{-\\rho\\,\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle}_{\\text{kinetic (fluctuation)}} + \\underbrace{\\boldsymbol{\\sigma}_{\\text{config}}}_{\\text{from interparticle forces}},$$ where $\\boldsymbol{v}$ is the mean velocity and $\\boldsymbol{c}$ the peculiar fluctuation. * Meaning of $\\langle\\boldsymbol{K}\\rangle = \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#executive-summary-one-page-take-home",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Executive summary (one-page take-home): Definitions",
    "content": "This is not just a definition; it encodes a closure: macroscopic transport $= \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$; microscopic agitation $\\to$ stress. The fluctuation term $\\rho\\langle\\boldsymbol{c}\\boldsymbol{c}\\rangle$ is absorbed into $\\boldsymbol{\\sigma}$. * Meaning of $\\boldsymbol{C}$: The line-integral representation is the minimal local encoding of Newton's third law, ensuring local momentum conservation, symmetry of stress, and correct torques. Upon averaging, $\\langle\\boldsymbol{C}\\rangle = -\\boldsymbol{\\sigma}_{\\text{config}}$. * Cauchy momentum equation. With continuity, $$\\partial_t(\\rho\\boldsymbol{v}) + \\nabla\\cdot(\\rho\\,\\boldsymbol{v}\\boldsymbol{v}-\\boldsymbol{\\sigma}) = \\rho\\,\\boldsymbol{b} \\quad\\Longrightarrow\\quad \\rho\\,\\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot\\boldsymbol{\\sigma} + \\rho\\,\\boldsymbol{b}.$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#executive-summary-one-page-take-home",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 1. Why coarse-grain? From spiky to smooth fields: Context",
    "content": "Microscopic fields. For point particles $\\{m_n,\\boldsymbol{r}_n(t),\\boldsymbol{v}_n(t)\\}$, $$\\rho_{\\text{mic}}(\\boldsymbol{r},t) = \\sum_n m_n\\,\\delta(\\boldsymbol{r}-\\boldsymbol{r}_n),\\qquad (\\rho\\boldsymbol{v})_{\\text{mic}} = \\sum_n m_n\\boldsymbol{v}_n\\,\\delta(\\boldsymbol{r}-\\boldsymbol{r}_n).$$ These are distributions\u2014ill-suited to differentiation on continuum scales. Coarse-graining.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#1-why-coarse-grain-from-spiky-to-smooth-fields",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 1. Why coarse-grain? From spiky to smooth fields: Introduce either (i)...",
    "content": "Introduce either (i) ensemble averaging $\\langle\\cdot\\rangle$ or (ii) spatial filtering with a smooth kernel $W_\\ell(\\boldsymbol{r})$ of width $\\ell$ (the averaging cell): $$\\overline{A}(\\boldsymbol{r},t) = \\int W_\\ell(\\boldsymbol{r}-\\boldsymbol{r}')\\,A_{\\text{mic}}(\\boldsymbol{r}',t)\\,d\\boldsymbol{r}'\\quad\\text{or}\\quad \\langle A\\rangle.$$ Assume the scale separation $a \\ll \\ell \\ll L$ (particle size $a$, continuum scale $L$), so that gradients of the coarse-grained fields are defined and microscale noise is washed out. > [!note] > Any physical probe averages in space/time; coarse-graining mirrors measurement and yields differentiable fields for continuum mechanics. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#1-why-coarse-grain-from-spiky-to-smooth-fields",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 2. Microscopic momentum balance and the momentum flux tensor",
    "content": "For particles obeying Newton's laws with pair forces $\\boldsymbol{f}_{nm} = -\\boldsymbol{f}_{mn}$ and body force per mass $\\boldsymbol{b}$, we can show (Irving\u2013Kirkwood construction) that the microscopic local momentum balance reads $$\\frac{\\partial}{\\partial t}(\\rho\\boldsymbol{v})_{\\text{mic}} + \\nabla\\cdot\\boldsymbol{\\Pi}_{\\text{mic}} = \\rho_{\\text{mic}}\\boldsymbol{b},$$ where the momentum flux tensor is $$\\boldsymbol{\\Pi}_{\\text{mic}} = \\underbrace{\\boldsymbol{K}_{\\text{mic}}}_{\\text{kinetic}} + \\underbrace{\\boldsymbol{C}_{\\text{mic}}}_{\\text{configurational}}.$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#2-microscopic-momentum-balance-and-the-momentum-flux-tensor",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 2.1 Kinetic contribution $\\boldsymbol{K}$",
    "content": "$$K_{ij}(\\boldsymbol{r},t) = \\sum_n m_n v_{n,i}v_{n,j}\\,\\delta(\\boldsymbol{r}-\\boldsymbol{r}_n).$$ This is the flux of $i$-momentum across a surface with normal $\\boldsymbol{e}_j$ due to particles flying through.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#21-kinetic-contribution-boldsymbolk",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 2.2 Configurational contribution $\\boldsymbol{C}$",
    "content": "$$C_{ij}(\\boldsymbol{r},t) = \\frac{1}{2}\\sum_{n\\ne m} r_{nm,j}F_{nm,i}\\int_{0}^{1} \\delta\\left[\\boldsymbol{r}-(\\boldsymbol{r}_n+s\\,\\boldsymbol{r}_{nm})\\right]ds,\\qquad \\boldsymbol{r}_{nm} = \\boldsymbol{r}_m - \\boldsymbol{r}_n.$$ This bond term attributes momentum transport to interparticle forces acting across an imaginary cut. The line integral distributes the pair's contribution locally along the segment joining the particles. Why this form? * Enforces Newton's third law locally: momentum leaving one side enters the other. * Guarantees $\\boldsymbol{\\Pi}$ is in divergence form so that its divergence equals local force density. * Yields a symmetric stress (angular momentum is conserved; no spurious torques). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#22-configurational-contribution-boldsymbolc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 3. Averaging and the continuum balance",
    "content": "Apply the coarse-graining to obtain smooth fields: $$\\overline{\\rho},\\quad \\overline{\\rho\\boldsymbol{v}},\\quad \\overline{\\boldsymbol{\\Pi}} = \\langle\\boldsymbol{\\Pi}_{\\text{mic}}\\rangle.$$ We get the continuum-level local balance: $$\\frac{\\partial}{\\partial t}(\\rho\\boldsymbol{v}) + \\nabla\\cdot\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{b}.$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#3-averaging-and-the-continuum-balance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 3.1 Decomposing $\\overline{\\boldsymbol{\\Pi}}$: convective vs non-convective: Write each particle...",
    "content": "Write each particle velocity as mean + fluctuation at its location, $$\\boldsymbol{v}_n = \\boldsymbol{v}(\\boldsymbol{r}_n,t) + \\boldsymbol{c}_n,\\qquad \\langle \\boldsymbol{c}_n\\rangle = \\boldsymbol{0}.$$ Then $$\\langle K_{ij}\\rangle = \\rho\\,v_i v_j + \\rho\\,\\langle c_i c_j\\rangle.$$ Interpretation. * $\\rho\\,\\boldsymbol{v}\\boldsymbol{v}$: organized (bulk) transport of momentum. * $\\rho\\langle\\boldsymbol{c}\\boldsymbol{c}\\rangle$: flux from microscopic agitation. At continuum level, we assign the fluctuation flux together with the configurational flux to the stress.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#31-decomposing-overlineboldsymbolpi-convective-vs-non-convective",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 3.1 Decomposing $\\overline{\\boldsymbol{\\Pi}}$: convective vs non-convective: That is, we...",
    "content": "That is, we define $$\\boxed{\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} - \\boldsymbol{\\sigma}}$$ with the Cauchy stress tensor $$\\boxed{\\boldsymbol{\\sigma} = \\underbrace{-\\rho\\,\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle}_{\\boldsymbol{\\sigma}_{\\text{kin}}} + \\underbrace{\\boldsymbol{\\sigma}_{\\text{config}}}_{\\text{from forces, see below}}}.$$ This is a philosophical split: macroscopic convective transport vs microscopic agitation + interparticle interactions. > Key point: Saying $\\langle\\boldsymbol{K}\\rangle = \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ is not a mere definition; it encodes a closure: we place $\\rho\\langle\\boldsymbol{c}\\boldsymbol{c}\\rangle$ into $\\boldsymbol{\\sigma}$, i.e. we declare it part of the non-convective transport.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#31-decomposing-overlineboldsymbolpi-convective-vs-non-convective",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 3.2 Configurational part and stress",
    "content": "Averaging $\\boldsymbol{C}$ yields the configurational stress: $$\\langle \\boldsymbol{C}\\rangle = -\\boldsymbol{\\sigma}_{\\text{config}},$$ so that the total stress is $$\\boldsymbol{\\sigma} = \\boldsymbol{\\sigma}_{\\text{config}} - \\rho\\,\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle.$$ The symmetry of $\\boldsymbol{\\sigma}$ follows from the pair symmetry in $\\boldsymbol{C}$ and guarantees angular-momentum conservation. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#32-configurational-part-and-stress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 4. From momentum flux to the Cauchy equation",
    "content": "Insert $\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} - \\boldsymbol{\\sigma}$ into the averaged conservation law: $$\\partial_t(\\rho\\boldsymbol{v}) + \\nabla\\cdot(\\rho\\,\\boldsymbol{v}\\boldsymbol{v}-\\boldsymbol{\\sigma}) = \\rho\\,\\boldsymbol{b}.$$ Use the identity $$\\partial_t(\\rho\\boldsymbol{v}) + \\nabla\\cdot(\\rho\\boldsymbol{v}\\boldsymbol{v}) = \\rho\\,\\frac{D\\boldsymbol{v}}{Dt} + \\boldsymbol{v}\\,[\\partial_t\\rho + \\nabla\\cdot(\\rho\\boldsymbol{v})]$$ and the continuity equation $\\partial_t\\rho + \\nabla\\cdot(\\rho\\boldsymbol{v}) = 0$. We obtain the Cauchy momentum equation $$\\boxed{\\rho\\,\\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot\\boldsymbol{\\sigma} + \\rho\\,\\boldsymbol{b}.}$$ Sign convention. Here $\\nabla\\cdot\\boldsymbol{\\sigma}$ is the internal force density on the material (e.g. for a Newtonian fluid, $\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2\\mu\\boldsymbol{D}$ so $\\nabla\\cdot\\boldsymbol{\\sigma} = -\\nabla p + \\nabla\\cdot(2\\mu\\boldsymbol{D})$). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#4-from-momentum-flux-to-the-cauchy-equation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 5.1 Kinetic vs configurational dominance",
    "content": "* Dilute gases. Intermolecular forces act mainly as brief collisions; kinetic part dominates: $\\boldsymbol{\\sigma} \\approx -\\rho\\,\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle = -p\\boldsymbol{I} + \\text{small shear}$, with $p = (1/3)\\rho\\langle c^2\\rangle$. * Dense liquids/solids. Persistent interactions; configurational part dominates the shear and often much of the pressure\u2014this is the virial viewpoint. | Quantity | Mathematical role | Physical content | | ----------------------------------------------------------------------------------------- | -------------------- | -------------------------------------------- | | $\\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ | mean/convective flux | organized motion | | $-\\boldsymbol{\\sigma} = \\overline{\\boldsymbol{\\Pi}} - \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ | non-convective flux | microscopic agitation + interparticle forces |",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#51-kinetic-vs-configurational-dominance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 5.2 Constitutive closure (beyond kinematics)",
    "content": "The derivation above defines $\\boldsymbol{\\sigma}$ kinematically. To close the equations we need a constitutive relation: * Newtonian fluid: $\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2\\mu\\boldsymbol{D} + \\lambda_b(\\nabla\\cdot\\boldsymbol{v})\\boldsymbol{I}$, where $\\boldsymbol{D} = \\tfrac{1}{2}(\\nabla\\boldsymbol{v} + \\nabla\\boldsymbol{v}^\\top)$. * Non-Newtonian (example). Oldroyd-B/polymeric fluids emerge when the configurational stress is tied to a conformation tensor $\\boldsymbol{A}$: $\\boldsymbol{\\sigma}_{\\text{poly}} = G(\\boldsymbol{A} - \\boldsymbol{I})$ with an upper-convected Maxwell evolution $\\overset{\\triangledown}{\\boldsymbol{A}} = -(1/\\lambda)(\\boldsymbol{A} - \\boldsymbol{I})$. This is precisely a continuum encoding of microscopic elastic memory contained in $\\boldsymbol{C}$. * Solids: In elastic solids $\\boldsymbol{\\sigma}$ derives from a strain energy; in the atomistic limit the configurational part reproduces Cauchy stress from interatomic potentials. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#52-constitutive-closure-beyond-kinematics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 6. Why $\\langle\\boldsymbol{K}\\rangle = \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ is a closure, not a tautology",
    "content": "$$\\langle K_{ij}\\rangle = \\rho\\,v_i v_j + \\rho\\,\\langle c_i c_j\\rangle.$$ The second term is non-zero in general. The coarse-graining philosophy is to assign all non-convective momentum transport\u2014random agitation and interparticle push/pull\u2014to the stress: $$\\underbrace{\\rho\\,v_i v_j}_{\\text{coherent bulk}} \\quad\\Big|\\quad \\underbrace{\\rho\\,\\langle c_i c_j\\rangle + \\text{(configurational)}}_{\\text{non-convective, define as } -\\sigma_{ij}}.$$ Thus we decide the book keeping that renders the continuum equation local, symmetric, and physically interpretable. This is exactly the Reynolds decomposition idea: for turbulence, $\\overline{\\rho\\,\\boldsymbol{v}\\boldsymbol{v}} = \\rho\\,\\tilde{\\boldsymbol{v}}\\tilde{\\boldsymbol{v}} + \\boldsymbol{\\tau}^{\\text{(Re)}}$ with the Reynolds stress $\\boldsymbol{\\tau}^{\\text{(Re)}} \\equiv \\rho\\,\\widetilde{\\boldsymbol{v}'\\boldsymbol{v}'}$ absorbed into an effective $\\boldsymbol{\\sigma}$. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#6-why-langleboldsymbolkrangle-rhoboldsymbolvboldsymbolv-is-a-closure-not-a-tautology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 7. Anatomy of $\\boldsymbol{C}$: localizing Newton's third law",
    "content": "Although internal forces cancel globally, they do not vanish locally when evaluating the flux across a cut. The Irving\u2013Kirkwood line integral: * Counts each pair once (the $1/2$ factor). * Places the contribution along the bond, ensuring that the two sides of any cut receive equal and opposite momentum transfer. * Produces a symmetric stress and a clean divergence (so $\\nabla\\cdot\\boldsymbol{\\sigma}$ is a genuine local force density). For many-body potentials or constraints, generalized bond distributions exist that maintain these properties; hard-sphere collisions add impulsive, but still localizable, contributions. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#7-anatomy-of-boldsymbolc-localizing-newtons-third-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 9. Boundaries, tractions, and jump conditions",
    "content": "With the sign convention above, the traction exerted on a surface with unit normal $\\boldsymbol{n}$ is $\\boldsymbol{t} = \\boldsymbol{\\sigma}\\cdot\\boldsymbol{n}$. Across an interface with surface tension $\\gamma$, the jump satisfies $$[\\![\\boldsymbol{\\sigma}]\\!]\\cdot\\boldsymbol{n} = \\gamma\\,\\kappa\\,\\boldsymbol{n} + \\nabla_s\\gamma,$$ consistent with the configurational origin of capillary stresses in a molecular picture (Korteweg/phase-field frameworks render this via a non-local $\\boldsymbol{C}$ analogue). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#9-boundaries-tractions-and-jump-conditions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 10. Common pitfalls and sign conventions (quick checklist)",
    "content": "* Where does the minus sign come from? We choose $\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} - \\boldsymbol{\\sigma}$ so that internal stresses enter as $+\\nabla\\cdot\\boldsymbol{\\sigma}$ in the equation of motion. * Is $\\langle\\boldsymbol{K}\\rangle = \\rho\\boldsymbol{v}\\boldsymbol{v}$ exact? No. It is a modeling split: we define the convective part as $\\rho\\boldsymbol{v}\\boldsymbol{v}$ and absorb the fluctuations into $\\boldsymbol{\\sigma}$. * Symmetry of stress. Guaranteed by construction of $\\boldsymbol{C}$ (plus micro-torque balance). If couple-stresses or micro-rotations are relevant, one must generalize to Cosserat/micropolar continua. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#10-common-pitfalls-and-sign-conventions-quick-checklist",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Example A (ideal gas at equilibrium).",
    "content": "$$\\langle\\boldsymbol{c}\\boldsymbol{c}\\rangle = \\frac{\\langle c^2\\rangle}{3}\\,\\boldsymbol{I},\\quad p = \\tfrac{1}{3}\\rho\\langle c^2\\rangle,\\quad \\boldsymbol{\\sigma} = -p\\boldsymbol{I}.$$ Configurational part is negligible (no persistent forces).",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#example-a-ideal-gas-at-equilibrium",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Example B (dense liquid).",
    "content": "Configurational stresses dominate shear. The virial expression relates pressure and shear to ensemble averages of $\\boldsymbol{r}_{nm}\\otimes\\boldsymbol{f}_{nm}$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#example-b-dense-liquid",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Example C (polymeric liquid\u2014Oldroyd-B).",
    "content": "Configurational part linked to the conformation tensor gives $\\boldsymbol{\\sigma}_{\\text{poly}} = G(\\boldsymbol{A} - \\boldsymbol{I})$ with $\\overset{\\triangledown}{\\boldsymbol{A}} = -(1/\\lambda)(\\boldsymbol{A} - \\boldsymbol{I})$. Insert in Cauchy to obtain the viscoelastic momentum equation. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#example-c-polymeric-liquidoldroyd-b",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 13. Summary box (to remember)",
    "content": "$$\\boxed{ \\begin{aligned} &\\text{Microscopic: } \\boldsymbol{\\Pi} = \\boldsymbol{K} + \\boldsymbol{C},\\quad K_{ij} = \\sum m v_i v_j \\delta,\\quad C_{ij} = \\tfrac{1}{2}\\sum r_j F_i \\int_0^1 \\delta(\\cdots)\\, ds.\\\\[3pt] &\\text{Coarse-grained: }\\overline{\\boldsymbol{\\Pi}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} - \\boldsymbol{\\sigma}, \\quad \\boldsymbol{\\sigma} = -\\rho\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle + \\boldsymbol{\\sigma}_{\\text{config}}.\\\\[3pt] &\\text{Momentum eq.: }\\partial_t(\\rho\\boldsymbol{v}) + \\nabla\\cdot(\\rho\\,\\boldsymbol{v}\\boldsymbol{v}-\\boldsymbol{\\sigma}) = \\rho\\,\\boldsymbol{b} \\ \\Rightarrow\\ \\rho\\,\\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot\\boldsymbol{\\sigma} + \\rho\\,\\boldsymbol{b}.\\\\[3pt] &\\text{Philosophy: }\\ \\rho\\,\\boldsymbol{v}\\boldsymbol{v} \\ \\text{(bulk transport)};\\ -\\boldsymbol{\\sigma} \\ \\text{(microscopic agitation + forces).} \\end{aligned}}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#13-summary-box-to-remember",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 14. Exercises (with brief guidance): Context",
    "content": "1. Irving\u2013Kirkwood to pressure (ideal gas). Starting from $\\boldsymbol{\\sigma} = -\\rho\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle$, show $p = \\tfrac{1}{3}\\rho\\langle c^2\\rangle$ and derive the ideal-gas law using kinetic theory. 2. Symmetry of $\\boldsymbol{\\sigma}$. Use the antisymmetry $\\boldsymbol{F}_{nm} = -\\boldsymbol{F}_{mn}$ to prove that the configurational stress tensor is symmetric for central forces. 3. From Cauchy to Navier\u2013Stokes. Insert $\\boldsymbol{\\sigma} = -p\\boldsymbol{I} + 2\\mu\\boldsymbol{D}$ into Cauchy and use continuity to obtain the incompressible Navier\u2013Stokes equations. 4. Reynolds stress as \"kinetic stress.\" Show that filtering the convective flux produces $\\overline{\\rho\\,\\boldsymbol{v}\\boldsymbol{v}} = \\rho\\,\\boldsymbol{v}\\boldsymbol{v} + \\boldsymbol{\\tau}^{\\text{(Re)}}$. Interpret $\\boldsymbol{\\tau}^{\\text{(Re)}}$ alongside $-\\rho\\langle\\boldsymbol{c}\\,\\boldsymbol{c}\\rangle$ in the stress budget. 5. Virial expression (simple liquid).",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#14-exercises-with-brief-guidance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 14. Exercises (with brief guidance): For a pairwise...",
    "content": "For a pairwise potential $U(r)$, derive the virial formula $pV = Nk_BT - \\tfrac{1}{6}\\sum\\langle \\boldsymbol{r}_{nm}\\cdot\\boldsymbol{F}_{nm}\\rangle$ from $\\boldsymbol{\\sigma}_{\\text{config}}$. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#14-exercises-with-brief-guidance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - 15. Frequently asked questions",
    "content": "* Is the stress uniquely defined? Up to divergence-free \"gauge\" additions that do not affect $\\nabla\\cdot\\boldsymbol{\\sigma}$. The Irving\u2013Kirkwood form is the canonical local choice. * What if there are long-range forces (e.g. electrostatics)? One can include Maxwell stresses in $\\boldsymbol{\\sigma}$; the configurational part then includes field contributions. * What sets the averaging scale $\\ell$? Choose $a \\ll \\ell \\ll L$. Predictions become $\\ell$-independent in the true continuum regime; at finite $\\ell$ one obtains LES-like subgrid stresses. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#15-frequently-asked-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Coarse graining momentum to cauchy - Final perspective",
    "content": "1. $\\langle\\boldsymbol{K}\\rangle = \\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ expresses a scale separation: we keep coherent transport as convective and lump fluctuations into stress\u2014a closure, not a tautology. 2. $\\boldsymbol{C}$ localizes Newton's third law so that internal forces become a divergence of a symmetric tensor, producing the right local force and torque balances. Averaging gives $\\langle\\boldsymbol{C}\\rangle = -\\boldsymbol{\\sigma}_{\\text{config}}$. 3. The Cauchy equation then drops out cleanly: $$\\boxed{\\rho\\,\\frac{D\\boldsymbol{v}}{Dt} = \\nabla\\cdot\\boldsymbol{\\sigma} + \\rho\\,\\boldsymbol{b},}$$ with $\\boldsymbol{\\sigma}$ capturing everything that is not bulk advection\u2014pressure, viscous stresses, polymeric elasticity, capillarity, and turbulent transport\u2014while $\\rho\\,\\boldsymbol{v}\\boldsymbol{v}$ accounts only for organized motion of mass.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Coarse-graining-momentum-to-Cauchy/#final-perspective",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "What is electric field flux?",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:06 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/What-is-electric-field-flux?/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "What is electric field flux? - What is electric field flux?",
    "content": "![|750](20250121024948930_What%20is%20electric%20field%20flux_.png) $$ \\Phi = A\\vec{E}\\cdot\\hat{n} = AE\\cos\\alpha $$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/What-is-electric-field-flux?/#what-is-electric-field-flux",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - The Goal",
    "content": "Show that the internal forces (pairwise interactions) can be written as a divergence of a tensor: $$\\boxed{\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i = -\\nabla \\cdot \\boldsymbol{C}}$$ where $\\boldsymbol{C}$ is the configurational (virial) momentum-flux tensor: $$\\boldsymbol{C}(\\boldsymbol{r}, t) = \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{r}_{ij} \\, \\boldsymbol{f}_{ij} \\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds$$ This is the non-obvious bridge from particles to continuum stress. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#the-goal",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Why This Matters",
    "content": "In Newton's second law for particle $i$: $$m_i \\dot{\\boldsymbol{v}}_i = \\boldsymbol{f}_i^{\\rm ext} + \\sum_{j \\ne i} \\boldsymbol{f}_{ij}$$ When we sum over all particles and convert to fields, the external forces become $\\rho \\boldsymbol{b}$ (body force per volume). But what about the internal forces? If we naively write $\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\delta_i$, it's a sum of point forces at each particle location\u2014not a divergence of anything. The miracle: Newton's third law ($\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$) and clever algebra turn this into $-\\nabla \\cdot \\boldsymbol{C}$. This is how internal forces become stress tensors in the continuum description. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#why-this-matters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Step 1: Symmetrize the Pair Sum Using Action\u2013Reaction",
    "content": "Start with: $$\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i$$ Rewrite as a sum over *unordered pairs* $(i, j)$ with $i \\ne j$: $$\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i = \\frac{1}{2} \\sum_{i \\ne j} \\left( \\boldsymbol{f}_{ij} \\delta_i + \\boldsymbol{f}_{ji} \\delta_j \\right)$$ (We're summing each pair twice, so we divide by 2.) Use $\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$ (Newton's third law): $$= \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{f}_{ij} (\\delta_i - \\delta_j)$$ > [!tldr] TL;DR > Each pair force appears twice in the full double sum. We can collect them into a symmetric form: one force acting at particle $i$'s location and its reaction at particle $j$. This is where Newton's third law becomes crucial. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#step-1-symmetrize-the-pair-sum-using-actionreaction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Step 2: The Key Identity \u2014 Difference of Deltas as a Divergence",
    "content": "Here's the non-obvious step. For any pair $(i, j)$ with $\\boldsymbol{r}_{ij} = \\boldsymbol{r}_i - \\boldsymbol{r}_j$: $$\\boxed{\\delta_i - \\delta_j = -\\nabla_{\\boldsymbol{r}} \\cdot \\int_0^1 \\boldsymbol{r}_{ij} \\, \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds}$$ This is the core identity of this note. Let's prove it. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#step-2-the-key-identity-difference-of-deltas-as-a-divergence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Proof of the Key Identity: Define a \"path\"...",
    "content": "Define a \"path\" from particle $j$ to particle $i$: $$\\boldsymbol{R}(s) = \\boldsymbol{r}_j + s \\boldsymbol{r}_{ij} = \\boldsymbol{r}_j + s(\\boldsymbol{r}_i - \\boldsymbol{r}_j)$$ At $s = 0$: $\\boldsymbol{R}(0) = \\boldsymbol{r}_j$ (particle $j$). At $s = 1$: $\\boldsymbol{R}(1) = \\boldsymbol{r}_i$ (particle $i$).",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#proof-of-the-key-identity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Proof of the Key Identity: Define: $$F(s) =...",
    "content": "Define: $$F(s) = \\delta(\\boldsymbol{r} - \\boldsymbol{R}(s)) = \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij})$$ Take the derivative w.r.t. $s$: $$\\frac{dF}{ds} = -\\boldsymbol{r}_{ij} \\cdot \\nabla_{\\boldsymbol{r}} \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij})$$ (Using the chain rule: the only $s$-dependence is in the argument of the delta.) Integrate from $s = 0$ to $s = 1$: $$\\int_0^1 \\frac{dF}{ds} \\, ds = F(1) - F(0) = \\delta_i - \\delta_j$$ Substitute the expression for $dF/ds$: $$\\delta_i - \\delta_j = -\\int_0^1 \\boldsymbol{r}_{ij} \\cdot \\nabla_{\\boldsymbol{r}} \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds$$ Convert to a divergence.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#proof-of-the-key-identity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Proof of the Key Identity: Using the vector...",
    "content": "Using the vector identity $\\boldsymbol{a} \\cdot (\\nabla f) = \\nabla \\cdot (\\boldsymbol{a} f)$ (when $\\boldsymbol{a}$ is constant): $$\\boldsymbol{r}_{ij} \\cdot \\nabla \\delta(\\cdots) = \\nabla \\cdot (\\boldsymbol{r}_{ij} \\, \\delta(\\cdots))$$ Therefore: $$\\delta_i - \\delta_j = -\\nabla \\cdot \\int_0^1 \\boldsymbol{r}_{ij} \\, \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds$$ > [!tldr] TL;DR > This is the fundamental theorem of calculus applied to deltas along a line segment. We integrate $\\frac{dF}{ds}$ from one particle to the other and use the divergence identity to convert the integrand. Out pops a divergence\u2014which is exactly what we need. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#proof-of-the-key-identity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Step 3: Apply to Pair Forces: Substitute the identity...",
    "content": "Substitute the identity into the symmetrized sum: $$\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i = \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{f}_{ij} (\\delta_i - \\delta_j)$$ $$= -\\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{f}_{ij} \\, \\nabla \\cdot \\int_0^1 \\boldsymbol{r}_{ij} \\, \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds$$ Factor out the divergence: $$= -\\nabla \\cdot \\left[ \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{r}_{ij} \\, \\boldsymbol{f}_{ij} \\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds \\right]$$ Define the virial tensor: $$\\boxed{\\boldsymbol{C}(\\boldsymbol{r}, t) = \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{r}_{ij} \\, \\boldsymbol{f}_{ij} \\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds}$$ Result: $$\\boxed{\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i = -\\nabla \\cdot \\boldsymbol{C}}$$ --- > [!summary] Take-home message > Newton's third law says $\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#step-3-apply-to-pair-forces",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Step 3: Apply to Pair Forces: So we can...",
    "content": "So we can pair up forces: $\\boldsymbol{f}_{ij}(\\delta_i - \\delta_j)$ is a force at $i$ minus its reaction at $j$. Now, the difference of two deltas can be written as a divergence along the bond connecting them\u2014that's the calculus step. When we take a divergence, we 'smear' the pair force uniformly along the bond, and the divergence recovers the point forces at the ends. This is how pair forces become components of a stress tensor. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#step-3-apply-to-pair-forces",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Physical Interpretation: Bonds Carry Stress",
    "content": "Imagine a microscopic 'bond' connecting particles $i$ and $j$: $$\\text{Force on bond} = \\boldsymbol{f}_{ij}$$ $$\\text{Distance along bond} = \\boldsymbol{r}_{ij}$$ The virial tensor $\\boldsymbol{C}$ represents this: - Each bond contributes a dyadic product $\\boldsymbol{r}_{ij} \\boldsymbol{f}_{ij}$ (position times force). - The integral $\\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s\\boldsymbol{r}_{ij}) ds$ \"smears\" this contribution uniformly along the bond. - When we take a divergence, we recover the traction (force per unit area) on surfaces within the fluid. Example: Central forces. If $\\boldsymbol{f}_{ij} \\parallel \\boldsymbol{r}_{ij}$ (force along the line connecting the particles), then $\\boldsymbol{r}_{ij} \\boldsymbol{f}_{ij}$ is a symmetric dyad, and the virial tensor contributes to an *isotropic* stress (like pressure). Non-central forces (with components perpendicular to the bond) contribute to *anisotropic* stresses, including shear. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#physical-interpretation-bonds-carry-stress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Component Form",
    "content": "In index notation, the pair force contribution to the momentum balance is: $$f_\\alpha^{(\\text{int})} = -\\partial_\\beta C_{\\alpha\\beta}$$ where $$C_{\\alpha\\beta} = \\frac{1}{2} \\sum_{i \\ne j} r_{ij,\\alpha} \\, f_{ij,\\beta} \\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s\\boldsymbol{r}_{ij}) \\, ds$$ This is the configurational part of the stress tensor. Together with the kinetic part ($\\boldsymbol{K}$ from [[Dyadic-conversion]]), it forms the total microscopic stress $\\boldsymbol{\\Pi} = \\boldsymbol{K} + \\boldsymbol{C}$. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#component-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Symmetry of the Stress Tensor",
    "content": "Theorem: If all forces are central (i.e., $\\boldsymbol{f}_{ij} \\parallel \\boldsymbol{r}_{ij}$), then the Cauchy stress tensor $\\boldsymbol{\\sigma}$ is symmetric: $\\sigma_{\\alpha\\beta} = \\sigma_{\\beta\\alpha}$. Proof sketch: For central forces, $\\boldsymbol{r}_{ij} \\boldsymbol{f}_{ij}$ is symmetric (the outer product of two parallel vectors). The kinetic part $\\boldsymbol{K}$ is automatically symmetric (it's $m v_\\alpha v_\\beta$). So $\\boldsymbol{\\Pi} = \\boldsymbol{K} + \\boldsymbol{C}$ is symmetric, and hence $\\boldsymbol{\\sigma}$ is symmetric. Why it matters: Symmetric stress is a consequence of angular momentum conservation. If the stress weren't symmetric, rotational torques wouldn't be balanced. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#symmetry-of-the-stress-tensor",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Summary: The Bridge from Particles to Continuum",
    "content": "| Level | Quantity | Equation | |---|---|---| | Particles | Force on particle $i$ | $m_i \\dot{\\boldsymbol{v}}_i = \\boldsymbol{f}_i^{\\rm ext} + \\sum_{j \\ne i} \\boldsymbol{f}_{ij}$ | | Fields (microscopic) | Momentum density | $\\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{\\Pi} = \\rho \\boldsymbol{b}$ | | | | where $\\boldsymbol{\\Pi} = \\boldsymbol{K} + \\boldsymbol{C}$ | | Fields (coarse-grained) | Momentum per volume | $\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}$ | | | | where $\\boldsymbol{\\sigma} = -(\\overline{\\boldsymbol{K}} - \\rho \\boldsymbol{v}\\boldsymbol{v}) - \\overline{\\boldsymbol{C}}$ | The virial identity is the mathematical machinery that takes us from discrete pair forces to a continuous stress field. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#summary-the-bridge-from-particles-to-continuum",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Virial identity - Derivation Summary",
    "content": "1. Symmetrize the pair force sum using $\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$. 2. Use the key identity: $\\delta_i - \\delta_j = -\\nabla \\cdot \\int \\boldsymbol{r}_{ij} \\delta(\\cdots) ds$ (follows from FTC). 3. Recognize as a divergence: $\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\delta_i = -\\nabla \\cdot \\boldsymbol{C}$. Each step is mathematically rigorous and physically motivated. No approximations until we ensemble-average. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Virial-identity/#derivation-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Principle of superposition of electric fields",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:05 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Principle-of-superposition-of-electric-fields/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "Principle of superposition of electric fields - Principle of Superposition of Electric Fields",
    "content": "The electric field from multiple sources is the vector sum of the individual fields at each point. If charges create electric fields $\\vec{E}_1$, $\\vec{E}_2$, $\\dots$, then the total field is given by: $$ \\vec{E}_{\\text{total}} = \\vec{E}_1 + \\vec{E}_2 + \\cdots $$ This linear superposition implies that each charge\u2019s field contribution adds without altering the others\u2019 fields, enabling straightforward calculation of net electric fields from complex charge distributions.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Principle-of-superposition-of-electric-fields/#principle-of-superposition-of-electric-fields",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gaussian surface is very similar to the control volume in fluid mechanics",
    "content": "> [!significance] Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 21, 2025 at 11:03 CET",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Gaussian-surface-is-very-similar-to-the-control-volume-in-fluid-mechanics/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "Gaussian surface is very similar to the control volume in fluid mechanics - Gaussian surface is very similar to the control volume in fluid mechanics",
    "content": "They are closely related in a mathematical sense. In [[Gauss-law-of-Electrostatics|Gauss\u2019s law for electrostatics]], one picks a closed surface\u2014the Gaussian surface\u2014to evaluate the net electric flux and relate it to enclosed charge via the divergence theorem. In fluid mechanics, one defines a control volume (with a control surface) to analyze fluxes of mass, momentum, or energy. Both rely on the same underlying integral theorem (the divergence theorem) to connect fluxes through the surface to sources or sinks within the volume. The physical interpretations differ\u2014charge density for electromagnetism versus mass or momentum for fluid flow\u2014but the conceptual framework is very similar.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Gaussian-surface-is-very-similar-to-the-control-volume-in-fluid-mechanics/#gaussian-surface-is-very-similar-to-the-control-volume-in-fluid-mechanics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - Executive Summary",
    "content": "The entropic elasticity relation $G = n k_B T \\sim k_B T / \\xi^3$ applies specifically to **semi-dilute polymer solutions** forming blob networks, not to all polymer systems. Understanding when this scaling holds requires distinguishing between concentration regimes and recognizing the physical nature of $\\xi$ as a correlation length (blob size), not the Kuhn length of individual chains. Key points: - **Dilute regime** ($c c^{**}$): Dense melt-like behavior, different scaling - The mesh size $\\xi$ represents the **blob correlation length** (spacing between entanglements), not the Kuhn segment length - Individual Kuhn chains do not form networks and do not obey this scaling ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#executive-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 1.1 The Overlap Concentration $c^*$",
    "content": "A fundamental transition in polymer solution physics occurs at the **overlap concentration** $c^*$, defined as the concentration at which polymer coils begin to interpenetrate. For a polymer chain with $N$ monomers of size $b$: - Radius of gyration: $R_g \\sim b N^{\\nu}$, where $\\nu \\approx 0.588$ (good solvent) or $\\nu = 0.5$ (theta solvent) - Volume occupied by one coil: $V_{\\text{coil}} \\sim R_g^3$ - Overlap concentration: $c^* \\sim \\frac{N m_{\\text{mon}}}{R_g^3} \\sim \\frac{N}{b^3 N^{3\\nu}} \\sim N^{1-3\\nu}$ In good solvents ($\\nu = 3/5$): $$c^* \\sim N^{-4/5}$$ Physical interpretation: At $c c^*$, chains overlap and begin to interact.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#11-the-overlap-concentration-c",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 1.2 Three Concentration Regimes",
    "content": "| Regime | Concentration Range | Chain Behavior | Network Formation | $G$ Scaling | |--------|-------------------|----------------|-------------------|-------------| | **Dilute** | $c \\ll c^*$ | Isolated coils | No network | Not applicable | | **Semi-dilute** | $c^* < c < c^{**}$ | Overlapping, forming blobs | Temporary entanglement network | $G \\sim k_B T / \\xi^3$ | | **Concentrated** | $c \\gg c^{**}$ | Melt-like, dense packing | Dense entangled network | Different scaling | where $c^{**}$ marks the transition to concentrated/melt behavior (typically when chains are tightly packed). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#12-three-concentration-regimes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 2.1 What is a Blob?",
    "content": "In the semi-dilute regime, overlapping polymer chains create a network with a characteristic **correlation length** $\\xi$ called the **blob size**. Physical picture: - Inside a blob (length scale $ \\xi$): chains are screened by neighboring chains, forming a network structure - The blob size $\\xi$ decreases with increasing concentration",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#21-what-is-a-blob",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 2.2 Blob Size Scaling",
    "content": "From scaling arguments (Flory, de Gennes), the correlation length in good solvents scales as: $$\\xi \\sim b \\left(\\frac{c^*}{c}\\right)^{\\nu/(3\\nu-1)}$$ For $\\nu = 3/5$ (good solvent): $$\\xi \\sim b \\left(\\frac{c^*}{c}\\right)^{3/4} \\sim c^{-3/4}$$ Key insight: As concentration increases above $c^*$, the mesh size $\\xi$ decreases, making the network denser and stiffer.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#22-blob-size-scaling",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 2.3 Number of Blobs per Chain",
    "content": "A chain with total size $R_g$ in the semi-dilute regime can be viewed as a string of $g$ blobs: $$g \\sim \\left(\\frac{R_g}{\\xi}\\right)^{1/\\nu}$$ Each blob contains roughly $g_{\\text{blob}} \\sim (c/c^*)^{-1/(3\\nu-1)}$ monomers. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#23-number-of-blobs-per-chain",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 3.1 Why $G = k_B T / \\xi^3$ for Semi-Dilute Polymer Networks",
    "content": "The elastic modulus of a semi-dilute polymer solution arises from the entropic elasticity of the blob network: $$G = n_{\\text{strand}} k_B T \\sim \\frac{k_B T}{\\xi^3}$$ where: - $n_{\\text{strand}}$ = number of elastic strands per unit volume - $\\xi$ = blob correlation length (mesh size) Physical justification: 1. Each blob acts as an entropic spring with characteristic energy $k_B T$ 2. The density of these elastic units is $n_{\\text{strand}} \\sim 1/\\xi^3$ (one strand per blob volume) 3. Therefore: $G \\sim k_B T / \\xi^3$ With the scaling $\\xi \\sim c^{-3/4}$ (good solvent): $$G \\sim k_B T \\cdot c^{9/4}$$ This is the classic de Gennes scaling for semi-dilute polymer solutions.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#31-why-g-kb-t-xi3-for-semi-dilute-polymer-networks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 3.2 Concentration Dependence",
    "content": "Combining the blob scaling with the modulus relation: $$G \\sim \\frac{k_B T}{\\xi^3} \\sim k_B T \\cdot c^{3/(3\\nu-1)}$$ For good solvents ($\\nu = 3/5$): $$\\boxed{G \\sim c^{9/4}}$$ For theta solvents ($\\nu = 1/2$): $$\\boxed{G \\sim c^{3}}$$ These predictions have been extensively validated experimentally (rheology, light scattering). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#32-concentration-dependence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 4.1 Dilute Solutions ($c < c^*$)",
    "content": "In dilute solutions: - Chains do not overlap - No network structure forms - No collective elastic response - Individual chains can be characterized by their own $R_g$, but there is no shear modulus in the traditional sense Result: The relation $G \\sim k_B T / \\xi^3$ is **not applicable**.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#41-dilute-solutions-c-c",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 4.2 Individual Kuhn Chains",
    "content": "A **Kuhn segment** is the fundamental statistical unit of a polymer chain (contour length $l_K$, Kuhn length). Why $G = k_B T / \\xi^3$ doesn't work: - A single Kuhn chain does not form a network - The Kuhn length $l_K$ is a molecular parameter, not a mesh size - Without crosslinks or entanglements, there is no collective elastic modulus - Individual chains provide no shear resistance (they flow) The confusion arises because both $\\xi$ (mesh/blob size) and $l_K$ (Kuhn length) are length scales in polymer physics, but they describe completely different physics: - $l_K$: molecular property of a single chain - $\\xi$: emergent collective length scale in a network",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#42-individual-kuhn-chains",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 4.3 Concentrated/Melt Regime ($c > c^{**}$)",
    "content": "In concentrated polymer melts: - Chains are densely packed - Entanglement physics dominates (reptation) - Different scaling laws apply (plateau modulus $G_N^0 \\sim k_B T / N_e l_K^3$, where $N_e$ is entanglement length) The semi-dilute blob picture breaks down in this regime. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#43-concentratedmelt-regime-c-c",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 5. Physical Distinction: $\\xi$ vs $l_K$",
    "content": "| Quantity | Definition | Physical Meaning | Concentration Dependence | |----------|------------|------------------|-------------------------| | **Kuhn length** $l_K$ | Molecular parameter | Persistence length of polymer backbone | Independent of $c$ (intrinsic property) | | **Blob size** $\\xi$ | Correlation length | Mesh size of network, screening length | $\\xi \\sim c^{-3/4}$ (semi-dilute, good solvent) | | **Radius of gyration** $R_g$ | End-to-end distance | Size of isolated coil | $R_g \\sim N^{\\nu} l_K$ (dilute) | Critical point: In a semi-dilute blob network, $\\xi \\ll R_g$ because chains overlap, but $\\xi$ is still much larger than $l_K$ (typically $\\xi \\sim 10$\u2013$100$ nm, while $l_K \\sim 1$ nm for flexible polymers). ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#5-physical-distinction-xi-vs-lk",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 6.1 Rheological Measurements",
    "content": "Semi-dilute polymer solutions exhibit: - Small-strain shear modulus: $G \\sim c^{9/4}$ (good solvent) - Concentration-dependent relaxation time: $\\tau \\sim c^{1/2}$ (Zimm dynamics) - Zero-shear viscosity: $\\eta_0 \\sim c^{3/2}$ These scalings directly confirm the blob network picture.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#61-rheological-measurements",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 6.2 Light Scattering",
    "content": "Static light scattering can directly measure the correlation length $\\xi$: - Scattering intensity: $I(q) \\sim 1/(1 + q^2 \\xi^2)$ (Ornstein-Zernike form) - Extract $\\xi$ from the $q$-dependence - Verify $\\xi \\sim c^{-3/4}$ scaling ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#62-light-scattering",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 7.1 Permanent Crosslinks (Chemical Gels)",
    "content": "For chemically crosslinked networks (rubbers): - Crosslinks are permanent (covalent bonds) - Network structure is frozen - Still entropic elasticity: $G = n_{\\text{crosslink}} k_B T$ - $\\xi$ now represents average distance between crosslinks - $G \\sim k_B T / \\xi^3$ applies to both dilute and concentrated crosslinked networks",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#71-permanent-crosslinks-chemical-gels",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 7.2 Temporary Entanglements (Physical Gels)",
    "content": "For semi-dilute solutions (physical gels): - Entanglements are temporary (topological constraints) - Network structure is dynamic (chains can reptate) - Entropic elasticity on timescales shorter than reptation time - $\\xi$ represents blob/entanglement spacing - $G \\sim k_B T / \\xi^3$ applies only in the semi-dilute regime Key difference: Permanent vs temporary network structure affects long-time behavior (elastic solid vs viscoelastic fluid), but short-time elasticity follows the same entropic scaling. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#72-temporary-entanglements-physical-gels",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 8. Summary: When to Use $G = k_B T / \\xi^3$",
    "content": "Use this relation when: 1. Polymer concentration is in the **semi-dilute regime** ($c^* < c < c^{**}$) 2. Chains form a **blob network** with correlation length $\\xi$ 3. The system exhibits **entropic elasticity** (rubber-like behavior) 4. Temperature is sufficiently high ($k_B T$ dominates) Do NOT use this relation for: 1. **Dilute solutions** ($c < c^*$): no network structure 2. **Individual Kuhn chains**: no collective elasticity 3. **Concentrated melts** without considering entanglement modifications 4. Systems where $\\xi$ is not the blob correlation length (e.g., using Kuhn length incorrectly) ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#8-summary-when-to-use-g-kb-t-xi3",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 9. Worked Example: Polyacrylamide (PAA) in Water",
    "content": "Consider a polyacrylamide solution: - Molecular weight: $M = 10^6$ g/mol - Kuhn length: $l_K \\approx 2$ nm - Good solvent (water) Calculate overlap concentration: $$c^* \\sim \\frac{M}{N_A R_g^3} \\sim \\frac{M}{N_A (l_K N^{0.6})^3}$$ For $N \\sim M/M_{\\text{mon}} \\sim 10^4$ (monomer MW $\\sim 100$ g/mol): $$R_g \\sim 2\\,\\text{nm} \\cdot (10^4)^{0.6} \\sim 160\\,\\text{nm}$$ $$c^* \\sim \\frac{10^6\\,\\text{g/mol}}{6 \\times 10^{23} \\cdot (160\\,\\text{nm})^3} \\sim 0.4\\,\\text{g/L}$$ At $c = 10\\,c^* = 4$ g/L (semi-dilute): $$\\xi \\sim l_K \\left(\\frac{c^*}{c}\\right)^{3/4} \\sim 2\\,\\text{nm} \\cdot (0.1)^{0.75} \\sim 0.36\\,\\text{nm} \\times 5.6 \\sim 11\\,\\text{nm}$$ Note: $\\xi = 11$ nm $\\gg l_K = 2$ nm (blob size much larger than Kuhn segment). Elastic modulus: $$G \\sim \\frac{k_B T}{\\xi^3} \\sim \\frac{4.1 \\times 10^{-21}\\,\\text{J}}{(11 \\times 10^{-9}\\,\\text{m})^3} \\sim 3\\,\\text{Pa}$$ This is consistent with typical semi-dilute polymer solution rheology. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#9-worked-example-polyacrylamide-paa-in-water",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 10. Connection to Rubber Elasticity Theory",
    "content": "The relation $G = k_B T / \\xi^3$ is the soft-matter analogue of classical rubber elasticity: Classical rubber theory (Flory): $$G = \\frac{\\rho R T}{M_c}$$ where $M_c$ is the molecular weight between crosslinks. Converting to mesh size: $$M_c \\sim \\rho_{\\text{polymer}} \\xi^3 \\quad \\Rightarrow \\quad G \\sim \\frac{k_B T}{\\xi^3}$$ Both frameworks describe entropic networks, but: - Rubber theory: permanent covalent crosslinks - Blob network: temporary entanglements in semi-dilute regime ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#10-connection-to-rubber-elasticity-theory",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 11. Further Reading",
    "content": "Key references: 1. **de Gennes, P. G.** (1979). *Scaling Concepts in Polymer Physics*. Cornell University Press. (The definitive blob physics treatment) 2. **Rubinstein, M. & Colby, R. H.** (2003). *Polymer Physics*. Oxford University Press. (Comprehensive modern textbook) 3. **Doi, M. & Edwards, S. F.** (1986). *The Theory of Polymer Dynamics*. Oxford University Press. (For concentrated/melt regime and reptation) Landmark experimental papers: - Ferry, J. D. (1980). *Viscoelastic Properties of Polymers*. Wiley. (Classic rheology reference) - Daoud, M. & Jannink, G. (1976). \"Temperature-concentration diagram of polymer solutions.\" *J. Phys.* (Scaling theory validation) ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#11-further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Polymer concentration regimes and blob networks - 12. Key Takeaways",
    "content": "1. $G = k_B T / \\xi^3$ is a **semi-dilute polymer network** relation, not universal 2. Requires **blob network formation** at $c > c^*$ 3. $\\xi$ is the **correlation/blob length**, NOT the Kuhn length $l_K$ 4. Does NOT apply to: - Dilute solutions - Individual chains (Kuhn or otherwise) - Concentrated melts (without modification) 5. Experimentally verified by rheology ($G \\sim c^{9/4}$) and scattering ($\\xi \\sim c^{-3/4}$) When teaching or using this relation, always specify the regime and clarify what $\\xi$ represents physically.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Polymer-Concentration-Regimes-and-Blob-Networks/#12-key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Stokes' first problem",
    "content": "> [!link] Related lecture material > This derivation is part of [[2-What-is-Viscosity|Lecture 2: Viscosity and Momentum Diffusion]] ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#stokes-first-problem",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Physical Setup",
    "content": "![](../_Media/Impulsively-started-plate-1761774189020.png) A semi-infinite fluid initially at rest. At $t=0$, a plate at $y=0$ suddenly moves with velocity $u_0$. Initial and Boundary Conditions: $$\\begin{align} \\vec{u}(x,y,t=0) &= 0 \\\\ \\text{At } t = 0^{+}, \\quad u(y=0) &= u_0 \\end{align}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#physical-setup",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Simplifying Assumptions",
    "content": "We assume spatial uniformity in the $x$-direction: $$\\boxed{\\frac{\\partial()}{\\partial x} = 0}$$ Ignoring any initial transients, this leads to: From continuity equation: $$\\frac{\\partial v}{\\partial y} = 0$$ Combined with no-slip at the plate: $$v(y=0) = 0 \\quad \\Rightarrow \\quad v = 0 \\quad \\text{for all } y$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#simplifying-assumptions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Governing Equations",
    "content": "$x$-momentum equation: $$\\rho \\frac{\\partial u}{\\partial t} = - \\frac{\\partial p}{\\partial x} + \\mu \\frac{\\partial^2 u}{\\partial y^2}$$ $y$-momentum equation: $$\\frac{\\partial p}{\\partial y} = 0$$ Pressure gradient: For an open container with $(p,u,v) = 0$ far from the plate: $$\\frac{\\partial p}{\\partial x} = 0$$ Simplified momentum equation: $$\\boxed{\\rho \\frac{\\partial u}{\\partial t} = \\mu \\frac{\\partial^2 u}{\\partial y^2}}$$ or equivalently: $$\\boxed{\\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial y^2}}$$ where $\\nu = \\mu/\\rho$ is the kinematic viscosity. > [!note] Key Insight > We cannot directly integrate this PDE as $u = f(y,t)$. We need a more sophisticated approach. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#governing-equations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Boundary Conditions",
    "content": "$$\\begin{align} u(y,0) &= 0 \\quad \\text{(initially at rest)} \\\\ u(0,t) &= u_0 \\quad \\text{(plate velocity)} \\\\ u(\\infty,t) &= 0 \\quad \\text{(far-field BC)} \\end{align}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#boundary-conditions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Similarity Solution Approach",
    "content": "Using dimensional analysis, we seek a solution of the form: $$u = \\phi\\left(u_0, y, t, \\frac{\\mu}{\\rho} = \\nu\\right)$$ By dimensional reasoning, the velocity profile should depend on the similarity variable: $$\\frac{u}{u_0} = \\phi\\left(\\frac{y}{\\sqrt{\\nu t}}\\right)$$ > [!important] Similarity Variable > The characteristic length scale grows as $\\sqrt{\\nu t}$, reflecting the diffusive nature of momentum transport. Define the similarity variable: $$\\boxed{\\eta = \\frac{y}{2\\sqrt{\\nu t}}}$$ and the dimensionless velocity: $$\\boxed{\\frac{u}{u_0} = F(\\eta)}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#similarity-solution-approach",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Transformation to ODE",
    "content": "We now transform the PDE by computing the necessary derivatives.",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#transformation-to-ode",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Time derivative:",
    "content": "$$\\frac{\\partial u}{\\partial t} = u_0 \\frac{dF}{d\\eta} \\frac{\\partial \\eta}{\\partial t}$$ where: $$\\frac{\\partial \\eta}{\\partial t} = -\\frac{1}{4} \\frac{y}{\\sqrt{\\nu} t^{3/2}} = -\\frac{\\eta}{2t}$$ Therefore: $$\\frac{\\partial u}{\\partial t} = u_0 F' \\cdot \\left(-\\frac{\\eta}{2t}\\right) = \\frac{-u_0 F' \\eta}{2t}$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#time-derivative",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Spatial derivatives:",
    "content": "$$\\frac{\\partial u}{\\partial y} = u_0 \\frac{dF}{d\\eta} \\frac{\\partial \\eta}{\\partial y} = u_0 F' \\frac{1}{2\\sqrt{\\nu t}}$$ $$\\frac{\\partial^2 u}{\\partial y^2} = u_0 F'' \\frac{1}{2\\sqrt{\\nu t}} \\frac{\\partial \\eta}{\\partial y} = \\frac{u_0 F''}{4\\nu t}$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#spatial-derivatives",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Substituting into the PDE:",
    "content": "$$\\frac{-u_0 F' \\eta}{2t} = \\nu \\cdot \\frac{u_0 F''}{4\\nu t}$$ Simplifying: $$\\boxed{F'' + 2\\eta F' = 0}$$ This is an ordinary differential equation for $F(\\eta)$. ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#substituting-into-the-pde",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Transformed Boundary Conditions",
    "content": "![](../_Media/Impulsively-started-plate-1761774200063.png) The original boundary conditions become: $$\\begin{align} \\eta = \\frac{y}{2\\sqrt{\\nu t}} &\\quad \\Rightarrow \\quad \\begin{cases} t = 0: & \\eta \\to \\infty \\\\ y \\to \\infty: & \\eta \\to \\infty \\\\ y = 0: & \\eta = 0 \\end{cases} \\end{align}$$ Therefore: $$\\begin{align} F(\\eta \\to \\infty) &= 0 \\\\ F(\\eta = 0) &= 1 \\end{align}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#transformed-boundary-conditions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Solving the ODE",
    "content": "Starting with: $$F'' + 2\\eta F' = 0$$ Rearrange: $$\\frac{dF'}{d\\eta} = -2\\eta F'$$ Separate variables: $$\\frac{dF'}{F'} = -2\\eta \\, d\\eta$$ Integrate: $$\\ln(F') = -\\eta^2 + C$$ Exponentiate: $$F' = A e^{-\\eta^2}$$ Integrate again: $$\\boxed{F = A \\int_0^{\\eta} e^{-s^2} \\, ds + B}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#solving-the-ode",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Applying Boundary Conditions",
    "content": "At $\\eta = 0$: $F(0) = 1$ $$B = 1$$ As $\\eta \\to \\infty$: $F(\\infty) = 0$ $$0 = A \\int_0^{\\infty} e^{-s^2} \\, ds + 1$$ Using the Gaussian integral: $$\\int_0^{\\infty} e^{-s^2} \\, ds = \\frac{\\sqrt{\\pi}}{2}$$ We get: $$0 = A \\frac{\\sqrt{\\pi}}{2} + 1 \\quad \\Rightarrow \\quad A = -\\frac{2}{\\sqrt{\\pi}}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#applying-boundary-conditions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Final Solution",
    "content": "Substituting the constants: $$\\boxed{F(\\eta) = 1 - \\frac{2}{\\sqrt{\\pi}} \\int_0^{\\eta} e^{-s^2} \\, ds}$$",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#final-solution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Error Function Representation",
    "content": "The error function is defined as: $$\\erf(\\eta) = \\frac{2}{\\sqrt{\\pi}} \\int_0^{\\eta} e^{-s^2} \\, ds$$ Therefore: $$\\boxed{F(\\eta) = 1 - \\erf(\\eta)}$$ or equivalently, using the complementary error function $\\erfc(\\eta) = 1 - \\erf(\\eta)$: $$\\boxed{\\frac{u}{u_0} = \\erfc\\left(\\frac{y}{2\\sqrt{\\nu t}}\\right) = 1 - \\erf\\left(\\frac{y}{2\\sqrt{\\nu t}}\\right)}$$ ---",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#error-function-representation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Impulsively started plate - Physical Interpretation",
    "content": "> [!summary] Key Results > > 1. Diffusive spreading: The velocity profile spreads into the fluid with a characteristic length scale $\\delta(t) \\sim \\sqrt{\\nu t}$ > > 2. Self-similar evolution: At different times, the velocity profiles collapse onto a single curve when plotted against $\\eta = y/(2\\sqrt{\\nu t})$ > > 3. Momentum diffusion: The kinematic viscosity $\\nu$ acts as a diffusivity for momentum, exactly analogous to thermal or mass diffusion > > 4. Penetration depth: At any given time, most of the velocity change occurs within $y \\lesssim \\sqrt{\\nu t}$ The solution demonstrates that viscosity is fundamentally a diffusive process for momentum transport, validating the kinetic theory picture developed in [[2-What-is-Viscosity|Lecture 2]]. ![[StokesFirstProblem.pdf]]",
    "url": "https://blogs.comphy-lab.org/_AtomicNotes/Impulsively-started-plate/#physical-interpretation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar drosophila continuum mechanics - Can polymeric flows be the Drosophila of continuum mechanics?: > [!significance] Speaker...",
    "content": "> [!significance] Speaker > [Vatsal Sanjay](https://vatsalsanjay.com) ([CoMPhy Lab](https://comphy-lab.org)) Polymeric liquids provide a tunable testbed to explore unsteady, nonlinear continuum mechanics by systematically varying the amount and type of polymers. We explore how such systems can probe a continuum of behaviors from Newtonian flows to elastically dominated regimes, making polymeric flows effectively the \"Drosophila\" of unsteady continuum mechanics. This talk will demonstrate how adding polymers modifies instabilities in three canonical free-surface flows: sheets punctured by holes (Taylor\u2013Culick retraction), bursting bubbles that emit droplets, and Worthington jets formed by impact. Elastic stresses either create new singularities or suppress known ones, leading to distinct regimes in parameter space.",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Drosophila-continuum-mechanics/#can-polymeric-flows-be-the-drosophila-of-continuum-mechanics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar drosophila continuum mechanics - Can polymeric flows be the Drosophila of continuum mechanics?: JavaScript",
    "content": "Numerical simulations and complementary experiments reveal how polymer relaxation time and modulus determine free-surface morphologies, droplet sizes, and jet velocities, with implications for aerosol generation and fluid processing. By unifying concepts from fluid and solid mechanics, these results provide broad insight into controlling interfacial flows in manufacturing, pathogen transport, and beyond. ![[_Media/20250119213726033_Seminar-UIUC-abstract.png|How do polymeric flows influence classical hydrodynamic singularities?]] [[Seminar-Drosophila-continuum-mechanics.pdf|this page in .pdf]]",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Drosophila-continuum-mechanics/#can-polymeric-flows-be-the-drosophila-of-continuum-mechanics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar singularities - Singularities in soft matter systems: > [!significance] Speaker...",
    "content": "> [!significance] Speaker > [Vatsal Sanjay](https://vatsalsanjay.com) ([CoMPhy Lab](https://comphy-lab.org)) Soft matter flows frequently exhibit hydrodynamic singularities arising from the interplay of capillarity, inertia, viscosity, and elasticity. This talk explores such singularities across drops, bubbles, and thin films, combining experiments, direct numerical simulations, and theory. First, we investigate Worthington jets produced by drop impacts on superhydrophobic substrates, where discrete peaks in normal force mark singular events [1]. Next, we examine bursting bubbles in Newtonian and viscoelastic media, connecting elastic and viscous stresses to jet formation and droplet ejection [2]. Finally, for retracting liquid films, we demonstrate that classical Taylor\u2013Culick dynamics harbours singular limits: a viscous anomaly in the Newtonian case and elastic stress blow-up in the viscoelastic regime [3].",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Singularities/#singularities-in-soft-matter-systems",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar singularities - Singularities in soft matter systems: JavaScript",
    "content": "By exploring this multidimensional phase space, we uncover new physical insights into these systems. The findings carry direct implications for manufacturing processes, droplet transport, and pathogen dispersal mitigation. ![[_Media/Seminar-Singularities-1767636732618.png]]",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Singularities/#singularities-in-soft-matter-systems",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar singularities - References",
    "content": "[1] V. Sanjay, B. Zhang, C. Lv, and D. Lohse, \"The role of viscosity on drop impact forces on non-wetting surfaces,\" _J. Fluid Mech._, vol. 998, p. A40, 2024, doi: [10.1017/jfm.2024.982](https://doi.org/10.1017/jfm.2024.982). [2] A. K. Dixit, A. Oratis, K. Zinelis, D. Lohse, and V. Sanjay, \"Viscoelastic Worthington jets and droplets produced by bursting bubbles,\" _J. Fluid Mech._, vol. 1010, p. A2, 2025, doi: [10.1017/jfm.2025.237](https://doi.org/10.1017/jfm.2025.237). [3] V. Sanjay, U. Sen, P. Kant, and D. Lohse, \"Taylor\u2013Culick retractions and the influence of the surroundings,\" _J. Fluid Mech._, vol. 948, p. A14, 2022, doi: [10.1017/jfm.2022.671](https://doi.org/10.1017/jfm.2022.671). [[Seminar-Singularities.pdf|this page in .pdf]]",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Singularities/#references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 06 30_conference vpflow abstract - Taming singularities: yield-stress regularization in bubble-bursting: > [!significance] Speaker...",
    "content": "> [!significance] Speaker > [Vatsal Sanjay](https://vatsalsanjay.com) ([CoMPhy Lab](https://comphy-lab.org)) Capillary collapse of a bursting bubble is a canonical inertio-capillary singularity: the retracting rim launches a wave packet that focuses at the cavity base, driving a high-speed Worthington jet and, classically, droplets. Non-Newtonian physics rewrites this script. For example, yield stress and elasticity tame these waves and the jet and often suppress them [1]. Using high-fidelity simulations carried out with _MultiRheoFlow_ (https://comphy-lab.org/MultiRheoFlow/) $-$ a new open-source Basilisk C framework for interfacial flows with arbitrary rheology $-$ we explore how viscoplasticity and its elastoviscoplastic extension regularizes the singular flow. Yield stress intercepts the collapsing wavepacket, arrests curvature blow-up, and suppresses Worthington jetting [2]. In contrast, elasticity relaxation can reopen a singular path, reinstating a solitary jet or droplet [3].",
    "url": "https://blogs.comphy-lab.org/Talks/2025-06-30_Conference-VPflow-abstract/#taming-singularities-yield-stress-regularization-in-bubble-bursting",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 06 30_conference vpflow abstract - Taming singularities: yield-stress regularization in bubble-bursting: By tracking curvature...",
    "content": "By tracking curvature histories, kinetic\u2013plastic energy exchange, and stoppage times, we build a compact regime map that exposes the mechanical routes by which non-linear rheology regularizes free-surface singularities. The findings extend beyond bubbles, offering a template for predicting and controlling singular events in yield-stress and other complex fluids. ![[../_Media/2025-06-30_Conference-VPflow-abstract-1749493868724.png]] Fig. Worthington jet vs. elastoviscoplastic medium, adapted from [1]. > [!info]- Metadata > Posted by:: Vatsal > Date published:: 2025-06-09 > Date modified:: Jun 9, 2025 at 20:28 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) ---",
    "url": "https://blogs.comphy-lab.org/Talks/2025-06-30_Conference-VPflow-abstract/#taming-singularities-yield-stress-regularization-in-bubble-bursting",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 06 30_conference vpflow abstract - References",
    "content": "[1] A. G. Balasubramanian, V. Sanjay, M. Jalaal, R. Vinuesa, and O. Tammisola, \u201cBursting bubble in an elasto-viscoplastic medium,\u201d _J. Fluid Mech._, vol. 1001, p. A9, Dec. 2024, doi: [10.1017/jfm.2024.1073](https://doi.org/10.1017/jfm.2024.1073) [2] V. Sanjay, D. Lohse, and M. Jalaal, \u201cBursting bubble in a viscoplastic medium,\u201d _J. Fluid Mech._, vol. 922, p. A2, 2021, doi: [10.1017/jfm.2021.489](https://doi.org/10.1017/jfm.2021.489) [3] A. K. Dixit, A. Oratis, K. Zinelis, D. Lohse, and V. Sanjay, \u201cViscoelastic Worthington jets and droplets produced by bursting bubbles,\u201d _J. Fluid Mech._, vol. 1010, p. A2, May 2025, doi: [10.1017/jfm.2025.237](https://doi.org/10.1017/jfm.2025.237). [[2025-06-30_Conference-VPflow-abstract.pdf|this page in .pdf]]",
    "url": "https://blogs.comphy-lab.org/Talks/2025-06-30_Conference-VPflow-abstract/#references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar coalescence with surfactants - To merge or not to merge?: > [!significance] Authors...",
    "content": "> [!significance] Authors > Jnandeep Talukdar, Duarte Rocha, Christian Diddens, Jacco Snoeijer, Detlef Lohse, and [Vatsal Sanjay*](https://comphy-lab.org) ![[Seminar-Coalescence-with-Surfactants-1767795012556.png|To merge or not to merge]] Coalescence of two sessile drops is initiated by a topological transition at first contact: a microscopic liquid bridge nucleates and grows from a vanishing initial length scale, launching the canonical coalescence singularity. For clean interfaces this bridge expansion is symmetric, but the outcome can flip when one drop carries surfactant and the other is clean: rather than merging, one drop can push the other aside. This matters because coalescence outcomes directly control pattern fidelity in inkjet printing, mixing efficiency in microfluidic handling, and emulsion stability, yet the earliest surfactant-mediated dynamics at first contact remain poorly characterised.",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Coalescence-with-Surfactants/#to-merge-or-not-to-merge",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar coalescence with surfactants - To merge or not to merge?: This talk shows...",
    "content": "This talk shows how insoluble surfactants modify this earliest stage in an asymmetric configuration where one sessile drop is initially coated (concentration $\\Gamma_0$) and the other is clean. Using a long-wave lubrication model coupled to surfactant transport, together with asymptotic analysis and high-resolution simulations, we map regimes in surfactant strength $\\beta$, surface Peclet number $Pe$ (interfacial advection relative to surface diffusion), and contact angle $\\theta$. In the rapid-diffusion limit ($Pe \\to 0$), surfactant quickly homogenises near the neck, so the bridge height follows the clean-drop similarity with renormalised capillary driving, $h_0 \\simeq 0.272(1-\\beta\\Gamma_0/2)\\theta^4 t$, while transient Marangoni stresses break symmetry and drive a drift $x_0 \\propto t^{3/2}$ with a diffusion-controlled maximum excursion $x_f \\sim \\beta Pe$.",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Coalescence-with-Surfactants/#to-merge-or-not-to-merge",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Seminar coalescence with surfactants - To merge or not to merge?: In the slow-diffusion...",
    "content": "In the slow-diffusion limit ($Pe \\to \\infty$), surfactant remains sharply segregated and sharp fronts develop; the dynamics are organised by a critical strength $\\beta_c \\approx 0.15$: above $\\beta_c$, Marangoni stresses suppress vertical bridge growth and sustain a translating, weakly coalescent state, whereas below $\\beta_c$ drift arrests via vorticity generation. In the purely advective limit, the surfactant field develops Burgers-type kinematic shocks. Overall, these results provide a regime map for surfactant-mediated sessile-drop coalescence at first contact. [[Seminar-Coalescence-with-Surfactants.pdf|this page in .pdf]]",
    "url": "https://blogs.comphy-lab.org/Talks/Seminar-Coalescence-with-Surfactants/#to-merge-or-not-to-merge",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Gauss law of electrostatics: > [!important]- Pre-requisites...",
    "content": "> [!important]- Pre-requisites > I assume a working knowledge of > * Electric field $\\vec{E}$. > * [[Geometric-description-of-electric-field]] > * [[What-is-electric-field-flux?]] > * What is the electric field created by a point change $q$? > $E = q/(4\\pi\\varepsilon_0r^2)$ > * [[Principle-of-superposition-of-electric-fields]] > [!tldr] TL;DR > Gauss\u2019 law states that the net electric flux through any closed surface is proportional to the total charge enclosed inside it. Its integral form, $\\oint \\vec{E} \\cdot d\\vec{A} = q_{\\text{in}}/\\varepsilon_0$, is most practically used with high\u2010symmetry geometries (spherical, cylindrical, planar). Even though it might seem universal, using it directly for complex geometries often requires additional methods. The differential form, $\\vec{\\nabla} \\cdot \\vec{E} = \\rho/\\varepsilon_0$, underpins charge\u2010field relationships in Maxwell\u2019s equations.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#gauss-law-of-electrostatics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Gauss law of electrostatics: Key insights include:...",
    "content": "Key insights include: _flux remains invariant if charges stay within the boundary_, and _external charges yield zero net flux through a given surface_. Applications to spherical shells, infinite planes, and wires highlight its computational utility. However, without symmetry, one typically reverts to direct integration or other approaches. Often, one of the first wonders students encounter in electrostatics is the deceptively simple yet powerful Gauss' law. I still recall my own initial surprise when I realized flux through any closed surface enclosing a single charge remained the same, no matter how oddly shaped that surface was. In this post, I hope to convey that same amazement while walking you through the essential details and derivations.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#gauss-law-of-electrostatics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Question we ask: which of the following three surfaces will see the maximum flux of $\\vec{E}$ pass through itself?",
    "content": "![fig1](20250121002320090_Gauss%20law%20of%20Electrostatics.png) Fig. A cone, a sphere, and a batman symbol (enclose it in the front and the back) encircle a lonely charge of magnitude $q$. Which of the three will experience maximum eleectric field flux passing through them? This is perhaps the most counterintuitive result of the Gauss law. > [!question] Try it yourself > Instead of taking my (well, Gauss') word for it, try finding the flux through the cone and the circle by integrating the dot product of the local electric field and the area (note that for cone, we must account for both the lateral and the base area). Once you find the solution, make a PR at the GitHub repository please show all intermediate steps.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#question-we-ask-which-of-the-following-three-surfaces-will-see-the-maximum-flux-of-vece-pass-through-itself",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - General form of Gauss' law",
    "content": "> [!tldr] Main statement of Gauss' law > The flux of electric field $\\vec{E}$ though a closed surface (known as the Gaussian surface) is equal to the amount of change enclosed by that surface. $\\int_A\\vec{E}\\cdot\\vec{n}dA = q_{\\text{in}}/\\varepsilon_0$, $\\vec{E}$ is the electric field, $n$ is the normal vector to the area element $dA$, $q_{\\text{in}}$ is the change enclosed inside the Gaussian surface and $\\varepsilon_0$ is the [[permittivity-of-free-space]]. > * In the differential form, it is identical to: > $\\vec{\\nabla}\\cdot\\vec{E} = \\rho/\\varepsilon_0$, where $\\rho$ is the local electric changed density. Let us define the flux as: $$ \\Phi = \\int_A\\vec{E}\\cdot d\\vec{A} = \\int_A\\vec{E}\\cdot \\hat{n}dA $$ Then, $$ \\int_A\\vec{E}\\cdot \\hat{n}dA = \\frac{q_{\\text{in}}}{\\varepsilon_0} $$ Of course, $q_\\text{in}$ is $$ q_\\text{in} = \\int_A\\sigma dA = \\int_V\\rho dV, $$ where $\\sigma$ and $\\rho$ are the surface and volumetric change densities, respectively.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#general-form-of-gauss-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Proof:",
    "content": "> [!caution] > I leave it upto you to decide if the following derivations are the proofs or merely consistency checks for the Gauss' law.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#proof",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Special case of spherical Gaussian surface enclosing a single charge:",
    "content": "![|500](20250121013316786_Gauss%20law%20of%20Electrostatics.png) Electric field by a point change: $$ \\vec{E} = \\frac{q}{4\\pi\\varepsilon_0r^2}\\hat{r} $$ Flux through a sphere of radius $r$, $$ \\Phi = E\\hat{r}\\cdot\\hat{r}A = EA = \\frac{q}{4\\pi\\varepsilon_0r^2}4\\pi r^2 = \\frac{q}{\\varepsilon_0} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#special-case-of-spherical-gaussian-surface-enclosing-a-single-charge",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Arbitary Gaussian surface enclosing a single charge:",
    "content": "![|750](20250121013334249_Gauss%20law%20of%20Electrostatics.png) Electric field by a point change: $$ \\vec{E} = \\frac{q}{4\\pi\\varepsilon_0r^2}\\hat{r} $$ Local flux at the indicated location: $$ d\\Phi = E\\hat{r}\\cdot\\hat{n}dA = \\frac{q}{4\\pi\\varepsilon_0r^2}\\cos\\alpha\\,dA = \\frac{q}{4\\pi\\varepsilon_0}\\frac{\\cos\\alpha\\,dA}{r^2} $$ Here, $\\cos\\alpha\\,dA/r^2 = d\\Omega$ is in fact the solid angle subtended by the local area element. $$ \\Phi = \\int d\\Phi = \\int_\\Omega\\frac{q}{4\\pi\\varepsilon_0}d\\Omega $$ The solid angle $\\Omega$ integrates to give $4\\pi$ resulting in $$ \\Phi = \\frac{q}{\\varepsilon_0} $$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#arbitary-gaussian-surface-enclosing-a-single-charge",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Consequences of Gauss' law: > [!danger] Displace...",
    "content": "> [!danger] Displace the charge all you want, it won\u2019t change the flux > The flux of $\\vec{E}$ only depends on the amount of charge contained inside a Gaussian surface and not on whether or not the charge is moving inside the space enclosed by this Gaussian surface. Remarkable property: If charges are moved around but do not cross the boundary of $A$, the flux of $E$ through $A$ remains unchanged. Despite this unchanging flux, the field $E$ itself can undergo substantial modifications everywhere else.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#consequences-of-gauss-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Consequences of Gauss' law: Conversely, if charges...",
    "content": "Conversely, if charges do cross the boundary of $A$, the flux through $A$ will generally change. > [!danger] A charge outside the Gaussian surface imparts net zero flux in that control surface > It is easier to see by construction that electric field lines coming out of a charge outside a Gaussian surface will pass straight through without creating any global flux. ![|750](20250121023006325_Gauss%20law%20of%20Electrostatics.png) > [!danger] On the impossibility of equilibrium in electrostatics In any electrostatic field, a charge cannot be in [stable equilibrium](https://en.wikipedia.org/wiki/Mechanical_equilibrium). A single point charge $q$ cannot remain in stable equilibrium under the electrostatic influence of other, fixed charges in vacuum. Can you think of a scenario? Say, we do. And now, let us enclose this $q$ within a small closed surface $A$. For $q$ to be in stable equilibrium, the net electric field from all other charges must point inward everywhere on $A$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#consequences-of-gauss-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Consequences of Gauss' law: Such an inward...",
    "content": "Such an inward field is critical to create a restoring force for any small displacement of $q$. However, Gauss\u2019s theorem tells us that the total electric flux through $A$ must be zero if no net charge (creating this electrostatic field) is contained inside $A$. This zero flux requirement forces the field to have both inward and outward components on the surface, contradicting the need for a purely inward field. Hence, no purely electrostatic arrangement of external charges can hold a point charge in stable equilibrium in a vacuum. ![|250](20250121015925070_Gauss%20law%20of%20Electrostatics.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#consequences-of-gauss-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Symmetries to the rescue",
    "content": "Now, one of the best ways to make Gauss\u2019 law practical is by using symmetry arguments. Below are three major symmetry cases that come in handy.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#symmetries-to-the-rescue",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Plannar symmetry",
    "content": "![|750](20250121033252912_Gauss%20law%20of%20Electrostatics.png) Consider an infinite sheet with uniform surface\u2010charge density $\\sigma$. By symmetry, the electric field must point perpendicular to the sheet and have the same magnitude on either side (left-right symmetry). Select a \"pillbox\" (a short cylinder) that straddles the sheet as your Gaussian surface. The flux then emerges through the two circular faces only; there is no flux through the curved surface because $\\vec{E}$ is parallel there. The integral form of Gauss\u2019s law yields $$ 2\\,E\\,A \\;=\\; \\frac{\\sigma\\,A}{\\varepsilon_0} $$ $$ \\quad\\Longrightarrow\\quad E \\;=\\; \\frac{\\sigma}{2\\,\\varepsilon_0}. $$ Hence, an infinite charged plane produces a constant electric field whose magnitude depends solely on $\\sigma$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#plannar-symmetry",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Special case:",
    "content": "![[plates.png]] When two parallel sheets carry equal and opposite surface\u2010charge densities $+\\sigma$ and $-\\sigma$, superposition implies that the fields from each sheet add in the region between them and cancel outside. Specifically, in the space between the plates, each sheet contributes $\\sigma/(2\\,\\varepsilon_0)$ in the same direction, giving a total $$ E_{\\text{between}} \\;=\\; \\frac{\\sigma}{\\varepsilon_0}. $$ Outside the plates, the fields from the two sheets have opposite directions and thus cancel to zero, assuming the plates are large compared to their separation. This configuration approximates the uniform field of a parallel\u2010plate capacitor.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#special-case",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Cyliindrical symmetry",
    "content": "![|750](20250121033734979_Gauss%20law%20of%20Electrostatics.png) Consider an infinitely long wire with a uniform linear charge density $\\lambda$. By symmetry, the electric field $\\vec{E}$ at distance $r$ from the wire must point radially outward and have constant magnitude on a coaxial cylindrical surface of radius $r$. Let us choose this coaxial cylinder as our Gaussian surface (length L). The flux is through the curved surface only; both end caps see $\\vec{E}$ parallel to their planes and hence yield no net contribution. Applying Gauss\u2019s law, $$ E \\,(2\\pi r L) \\;=\\; \\frac{\\lambda\\,L}{\\varepsilon_0} $$ $$\\quad\\Longrightarrow\\quad E \\;=\\; \\frac{\\lambda}{2\\pi \\varepsilon_0\\,r}. $$ The field diminishes as $1/r$ from the wire.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#cyliindrical-symmetry",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Spherical symmetry",
    "content": "Here, let us consider two cases: 1. uniformly charged sphere with charge density $\\rho$ and 2. a thin spherical shell with change $q$. Both have a radius of $a$. Also, assume $\\frac{4\\pi a^3}{3}\\rho = q$. ![|750](20250121035211075_Gauss%20law%20of%20Electrostatics.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#spherical-symmetry",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - For $r > a$:",
    "content": "Here, the Gaussian surface contains the entire spherical object inside it. So, in both cases, the Gaussian surface sees a total charge of $q$. Consequently, $$ E = \\frac{q}{4\\pi\\varepsilon_0r^2} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#for-r-a",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - For $r < a$:",
    "content": "* *Shell:* Charge enclosed inside the shell for $r [!note] Note > To play with the above plots, see: [[Gauss-law-of-electrostatics.ipynb]]",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#for-r-a",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - A critique of the Gauss' law in the non-local form",
    "content": "One might wonder: is Gauss' law too good to be true for complicated geometries? Below, I share a brief critique.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#a-critique-of-the-gauss-law-in-the-non-local-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Illusion of Generality",
    "content": "The integral form, $$ \\int_A \\vec{E} \\cdot d\\vec{A} = \\frac{q_\\text{in}}{\\varepsilon_0}, $$ can give a misleading impression that it solves _any_ electrostatic field problem elegantly. While it is indeed general as a statement of charge\u2013field relationships, _practical_ usage relies heavily on symmetry arguments to simplify the surface integral.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#illusion-of-generality",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Dependence on Symmetry",
    "content": "Gauss\u2019s integral theorem is most effective when the field and geometry exhibit high symmetry (e.g., spherical, cylindrical, or planar). In such cases, one can choose a closed surface $A$ where the electric field $\\vec{E}$ is either constant in magnitude or zero over different parts of the surface. This makes the flux integral collapse to a simple multiplication, thus giving a direct link between enclosed charge and field magnitude.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#dependence-on-symmetry",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Limitations in Complex Geometries",
    "content": "For configurations lacking these symmetries\u2014such as a uniformly charged disk or other irregular charge distributions\u2014no straightforward closed surface simplifies the flux integral. In these scenarios, one must resort to more laborious methods, like direct integration of Coulomb\u2019s law or employing the local (differential) form combined with suitable boundary conditions. > [!faq] Note: > Of course, let us be very clear that the above critique is only about the non-local form (or integral formulation) of Gauss' law. If we use the more general differential form (or together with the Maxwell's laws of electromagnetism, the above limitations do not apply).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#limitations-in-complex-geometries",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Some food for throught: Gauss' law is...",
    "content": "Gauss' law is agnostic to the number of dimensions in the problem. In this note, we mainly looked at cases in 3D. Now, think about living in a 2D space. Answer the following: 1. How does the Coulomb's law change in 2D? 2. Adapt Gauss\u2019s law to a 2D problem, where flux becomes a line integral around a closed loop. Consider a point charge qqq in a 2D plane. Choose a circle of radius $r$ around the charge as the \"Gaussian\" boundary. Compute the total radial component of $\\vec{E}$ along this circle and show that it is proportional to $q/\\varepsilon_0$ (with an appropriate constant reflecting 2D geometry). 3. For a hypothetical \"4D\" space, the electric field of a point charge might scale differently with distance. Use dimensional analysis to argue how Gauss\u2019s law might look there, and what the \"closed surface\u201d would mean in 4D.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#some-food-for-throught",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Some food for throught: Definitions",
    "content": "Hint: Highlight the dimension-agnostic idea that flux = enclosed charge/$\\varepsilon_0$\u200b remains structurally the same, although radius-dependencies of $\\vec{E}$ and definitions of \"surface\" change with dimension. Note: To submit answers to the questions above or in case you find a mistake in this note, please feel free to open a pull request at the repository: [link to repository](https://github.com/comphy-lab/CoMPhy-Lab-Blogs).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#some-food-for-throught",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Integral form:",
    "content": "In this post, we encountered Gauss law in integral form as, $$ \\oint_A \\vec{E} \\cdot d\\vec{A} \\;=\\; \\frac{q_{\\text{in}}}{\\epsilon_0}, $$ where $\\vec{E}$ is the electric field, $q_{\\text{in}}$ is the total charge enclosed by $A$, and $\\epsilon_0$ is the permittivity of free space.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#integral-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Relate enclosed charge to charge density.",
    "content": "The enclosed charge can be expressed in terms of the volume charge density $\\rho$ using a volume integral: $$ q_{\\text{in}} \\;=\\; \\int_{V} \\rho \\, dV. $$ Here, $V$ is the volume bounded by the surface \\(S\\).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#relate-enclosed-charge-to-charge-density",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Apply the divergence theorem: Rewrite the left...",
    "content": "Rewrite the left side of Gauss\u2019s law using the divergence theorem (also known as Gauss\u2019s divergence theorem): $$ \\oint_A \\vec{E} \\cdot d\\vec{A} \\;=\\; \\int_{V} \\vec{\\nabla} \\cdot \\vec{E} \\; dV. $$ > [!signifigance] Gauss' divergence therorem > This is yet another significant contribution from Gauss. It relates volume integrals to fluxes at the boundaries. This theorem is more generally used throughout the Physics literature. For example, simplifying integrals in Rayleigh$-$B\u00e9nard convection or in Taylor$-$Culick retractions. > $$ \\oint_A\\boldsymbol{F\\cdot}d\\boldsymbol{A} = \\int_{V}\\boldsymbol{\\nabla\\cdot F}\\;dV $$ > Rate of change of a physical quantity (see [[Relationship-between-rate-of-change-of-a-physical-quantity-and-its-divergence]]) in a volume is tied directly to its net flux across the boundary of that volume. More generally, in fluid mechanics, this principle underpins conservation laws such as mass, momentum, or energy.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#apply-the-divergence-theorem",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Apply the divergence theorem: Thus, $$ \\int_{V}...",
    "content": "Thus, $$ \\int_{V} \\vec{\\nabla} \\cdot \\vec{E} \\; dV \\;=\\; \\frac{1}{\\epsilon_0} \\int_{V} \\rho \\; dV. $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#apply-the-divergence-theorem",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Conclude the differential form",
    "content": "Because this equation must hold for any volume $V$, the integrands themselves must be equal at every point in space: $$ \\vec{\\nabla} \\cdot \\vec{E} \\;=\\; \\frac{\\rho}{\\epsilon_0}. $$ This is Gauss\u2019s law in differential form. It states that the divergence of the electric field at a point is proportional to the local charge density at that point.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#conclude-the-differential-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Significance to Maxwell's laws of electromagnetism",
    "content": "The Gauss' law of electrostatics is one of the special cases of Maxwell's laws of electromagnetism.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#significance-to-maxwells-laws-of-electromagnetism",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Gauss's Law (Electric):",
    "content": "$$ \\vec{\\nabla} \\cdot \\vec{E} = \\frac{\\rho}{\\varepsilon_0} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#gausss-law-electric",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Faraday's Law of Induction:",
    "content": "$$ \\vec{\\nabla} \\times \\vec{E} = -\\frac{\\partial \\vec{B}}{\\partial t} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#faradays-law-of-induction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Amp\u00e8re\u2013Maxwell Law:",
    "content": "$$ \\vec{\\nabla} \\times \\vec{B} = \\mu_0 \\vec{J} + \\mu_0 \\varepsilon_0 \\frac{\\partial \\vec{E}}{\\partial t} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#amp\u00e8remaxwell-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Gauss's Law (Electric):",
    "content": "$$ \\oint \\vec{E} \\cdot d\\vec{A} = \\frac{q_\\text{in}}{\\varepsilon_0} $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#gausss-law-electric",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Faraday's Law of Induction:",
    "content": "$$ \\oint \\vec{E} \\cdot d\\vec{\\ell} = -\\frac{d}{dt}\\left(\\int \\vec{B} \\cdot d\\vec{A}\\right) $$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#faradays-law-of-induction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Amp\u00e8re\u2013Maxwell Law:: Conclusion",
    "content": "$$ \\oint \\vec{B} \\cdot d\\vec{\\ell} = \\mu_0 I_\\text{in} + \\mu_0 \\varepsilon_0 \\frac{d}{dt}\\left(\\int \\vec{E} \\cdot d\\vec{A}\\right) $$ > [!summary] Conclusion > That brings us to the end of this reflective overview of Gauss' law and its place within Maxwell's equations. Even though the symmetrical geometries often steal the spotlight, the underlying message is that Gauss' law is deeply fundamental\u2014tied intimately to how charges shape and define the electric field around them. I hope these notes, with their many examples, help you see both its elegance and its limitations. > [!info] Info > Thanks for reading, and feel free to dive deeper (or suggest improvements) via the [GitHub repository](https://github.com/comphy-lab/CoMPhy-Lab-Blogs)! --- > [!testy] Some side notes: > * To explore some history, see: [[History-of-Gauss]] > * Here, we discuss a lot about Gaussian surfaces.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#amp\u00e8remaxwell-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Gauss law of electrostatics - Amp\u00e8re\u2013Maxwell Law:: The fluid dynamicist...",
    "content": "The fluid dynamicist in me cannot help but point out that a [[Gaussian-surface-is-very-similar-to-the-control-volume-in-fluid-mechanics]]. \ud83d\udca1 --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 25, 2025 at 14:22 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Gauss-law-of-Electrostatics/#amp\u00e8remaxwell-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Surface Element Parameterization",
    "content": "> [!tldr] TL;DR > Surface parameterization is a powerful mathematical technique for describing fluid interfaces using coordinates $(u,v)$ that map a 2D parameter space onto 3D surfaces. The tangent vectors $\\mathbf{x}_u = \\partial\\mathbf{x}/\\partial u$ and $\\mathbf{x}_v = \\partial\\mathbf{x}/\\partial v$ define the local surface geometry and are tangent to curves of constant $v$ and $u$, respectively. The normal vector to the surface is calculated as $\\mathbf{n} = (\\mathbf{x}_u \\times \\mathbf{x}_v)/|\\mathbf{x}_u \\times \\mathbf{x}_v|$. This framework enables mathematical analysis of surface metrics like curvature and area, which are essential for understanding interfacial phenomena in multiphase flows, bubble dynamics, and capillary effects.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#surface-element-parameterization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Introduction to Surface Parameterization",
    "content": "Interfaces between fluids represent some of the most fascinating and complex phenomena in fluid dynamics. From the gentle ripples on a pond to the intricate dynamics of bubble coalescence, these interfaces require precise mathematical descriptions to understand their behavior. At the heart of this description lies surface parameterization, a technique that allows us to map coordinates from a two-dimensional parameter space onto a three-dimensional surface. ![](Surface-parameterization-1741712767672.png) Figure 1. A parameterized surface element showing coordinate lines and the tangent plane. In fluid dynamics, we frequently encounter \"sharp\" interfaces\u2014surfaces that separate distinct fluid phases, across which physical properties may change discontinuously. This post explores the mathematical framework for describing such interfaces and how we characterize their geometric properties.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#introduction-to-surface-parameterization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Parameterization Basics",
    "content": "A three-dimensional fluid interface can be mathematically represented by a vector function: $$\\mathbf{x}(u,v) = (x(u,v), y(u,v), z(u,v))$$ Here, $u$ and $v$ are parameters that serve as coordinates on the surface, much like latitude and longitude on Earth's surface. Each point on the interface corresponds to a unique pair of values $(u,v)$ within the parameter domain. > [!note] Parametric vs. Explicit Representation > While some simple surfaces can be described explicitly (e.g., $z = f(x,y)$), parametric representation offers greater flexibility for describing complex shapes, especially those with overhangs or multiple-valued functions.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#parameterization-basics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Iso-Parameter Curves",
    "content": "When we hold one parameter constant while varying the other, we trace curves on the surface known as iso-parameter curves: - Iso-$u$ curves: Created by keeping $u$ constant and varying $v$ - Iso-$v$ curves: Created by keeping $v$ constant and varying $u$ These curves form a coordinate grid on the surface, as illustrated in Figure 2.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#iso-parameter-curves",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Defining Tangent Vectors: When we differentiate...",
    "content": "When we differentiate the position vector $\\mathbf{x}(u,v)$ with respect to the surface coordinates, we obtain two fundamental tangent vectors: $$\\mathbf{x}_u = \\frac{\\partial\\mathbf{x}}{\\partial u} \\quad \\text{and} \\quad \\mathbf{x}_v = \\frac{\\partial\\mathbf{x}}{\\partial v}$$ These vectors have precise geometric interpretations: - $\\mathbf{x}_u$ is tangent to iso-$v$ curves (curves where $v$ is constant) - $\\mathbf{x}_v$ is tangent to iso-$u$ curves (curves where $u$ is constant) This is visualized below: ![Figure 2](Surface-parameterization-1741713152627.png) Figure 2, taken from [G. Tryggvason, R. Scardovelli & S.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#defining-tangent-vectors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Defining Tangent Vectors: Zaleski, Direct numerical...",
    "content": "Zaleski, Direct numerical simulations of gas-liquid multiphase flows, Cambridge University Press (2011)](https://books.google.es/books?hl=en&lr=&id=nY5bjSYq-AEC&oi=fnd&pg=PR9&dq=%5BBook-Zaleski%5D_Direct+Numerical+Simulations+of+Gas+Liquid+Multiphase+Flows.pdf&ots=TpFXIKxNaj&sig=g-xqzt5uACGx-SYIMhvOwAVtz6U&redir_esc=y#v=onepage&q&f=false) > [!important] Key Insight > The tangent vector $\\mathbf{x}_u$ points in the direction of increasing $u$ along curves of constant $v$, not perpendicular to iso-$u$ curves. Similarly, $\\mathbf{x}_v$ points in the direction of increasing $v$ along curves of constant $u$. This can be a source of confusion: $\\mathbf{x}_u$ is tangent to curves where $v$ is constant, not to curves where $u$ is constant. This is because when you move along a curve where $v$ is fixed, you're varying the $u$ parameter.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#defining-tangent-vectors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - The Surface Normal Vector",
    "content": "With two tangent vectors defined at each point, we can determine the normal vector to the surface through their cross product: $$\\mathbf{n} = \\frac{\\mathbf{x}_u \\times \\mathbf{x}_v}{|\\mathbf{x}_u \\times \\mathbf{x}_v|}$$ This unit normal vector is perpendicular to both tangent vectors and thus perpendicular to the surface itself. The normal vector is crucial for calculating quantities like surface curvature and for determining the direction of surface tension forces.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#the-surface-normal-vector",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Differential Area Element",
    "content": "The differential area element $dA$ on the surface is related to the parameters $du$ and $dv$ through: $$dA = |\\mathbf{x}_u \\times \\mathbf{x}_v| \\, du \\, dv$$ The term $|\\mathbf{x}_u \\times \\mathbf{x}_v|$ represents the local scaling factor between the parameter space and the physical surface.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#differential-area-element",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - First Fundamental Form",
    "content": "The first fundamental form characterizes distances and areas on the surface: $$ds^2 = E \\, du^2 + 2F \\, du \\, dv + G \\, dv^2$$ where: - $E = \\mathbf{x}_u \\cdot \\mathbf{x}_u$ - $F = \\mathbf{x}_u \\cdot \\mathbf{x}_v$ - $G = \\mathbf{x}_v \\cdot \\mathbf{x}_v$ These coefficients completely determine the metric properties of the surface. > [!note] Orthogonal Parameterization > When $F = \\mathbf{x}_u \\cdot \\mathbf{x}_v = 0$, we have an orthogonal parameterization, meaning that the iso-parameter curves intersect at right angles. This often simplifies calculations.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#first-fundamental-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Mean and Gaussian Curvature",
    "content": "The mean curvature $H$ and Gaussian curvature $K$ are invariant properties of the surface that characterize its local shape: $$H = \\frac{1}{2}(\\kappa_1 + \\kappa_2) \\quad \\text{and} \\quad K = \\kappa_1 \\kappa_2$$ where $\\kappa_1$ and $\\kappa_2$ are the principal curvatures. The mean curvature is particularly important in fluid interfaces due to the Young-Laplace equation: $$\\Delta p = 2\\gamma H$$ which relates the pressure difference $\\Delta p$ across an interface to the surface tension $\\gamma$ and mean curvature $H$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#mean-and-gaussian-curvature",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Shape Characterization",
    "content": "The local shape of a surface element can be categorized based on its curvature: - Elliptic points: $K > 0$ (bowl-shaped) - Hyperbolic points: $K < 0$ (saddle-shaped) - Parabolic points: $K = 0$, $H \\neq 0$ (cylindrical) - Flat points: $K = 0$, $H = 0$ (planar) These classifications help us understand the geometric behavior of interfaces in various fluid dynamics scenarios.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#shape-characterization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Numerical Implementation Considerations: Methods",
    "content": "When implementing surface parameterization in computational fluid dynamics, several approaches are commonly used: 1. Finite Element Method: Elements are defined on the parameter space and mapped to the physical surface 2. Level Set Method: Implicit representation of the interface as a level set of a function 3. Front Tracking Method: Explicit tracking of interface points with dynamic remeshing > [!important] Numerical Stability > The choice of parameterization can significantly impact numerical stability. Orthogonal parameterizations often provide better conditioning for numerical solvers.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#numerical-implementation-considerations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Numerical Implementation Considerations: Code snippets utilize...",
    "content": "Code snippets utilize these concepts for calculating surface properties: ```c / * @brief Calculates surface curvature from parametric representation * @param xu First tangent vector * @param xv Second tangent vector * @param xuu Second derivative with respect to u * @param xuv Mixed second derivative * @param xvv Second derivative with respect to v * @return Mean curvature value */ double mean_curvature(Vector xu, Vector xv, Vector xuu, Vector xuv, Vector xvv) { Vector n = normalize(cross_product(xu, xv)); double E = dot_product(xu, xu); double F = dot_product(xu, xv); double G = dot_product(xv, xv); double L = dot_product(xuu, n); double M = dot_product(xuv, n); double N = dot_product(xvv, n); return (E*N - 2*F*M + G*L)/(2*(E*G - F*F)); } ```",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#numerical-implementation-considerations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Conclusion and Future Directions: Surface parameterization provides...",
    "content": "Surface parameterization provides a powerful mathematical framework for analyzing fluid interfaces. By defining a mapping between a 2D parameter space and a 3D surface, we gain access to precise geometric tools for calculating properties like curvature, area, and normal vectors. In research, these concepts have proven invaluable for understanding phenomena ranging from capillary waves in bubble coalescence to complex rheological behaviors in non-Newtonian fluids. Future work will continue to leverage these mathematical tools to explore increasingly complex interfacial dynamics across various fluid systems. For researchers working in this field, mastering surface parameterization is essential for both theoretical understanding and computational implementation.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#conclusion-and-future-directions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Conclusion and Future Directions: The framework outlined...",
    "content": "The framework outlined in this post serves as a foundation for more advanced topics in multiphase fluid dynamics. > [!question] Food for Thought > Consider how different choices of surface parameterization might impact numerical stability and accuracy in simulating multiphase flows. What advantages might orthogonal parameterizations offer in specific fluid dynamics problems?",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#conclusion-and-future-directions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - More resources",
    "content": "| [GitHub](https://github.com/comphy-lab/fluid-interfaces-notes) | [Demo](https://youtu.be/NmvCVsiEZIA) | [License](https://github.com/comphy-lab/fluid-interfaces-notes/blob/main/LICENSE) | | :---------------------------------------------------------------------: | :----------------------------------: | :----------------------------------------------------------------------------------------: |",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#more-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Surface parameterization - Further reading",
    "content": "[1] > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Mar 11, 2025 > Date modified:: Mar 11, 2025 at 14:26 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Surface-parameterization/#further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Non-Newtonian flows with Basilisk",
    "content": "> [!tldr] TL;DR > This assignment explores computational approaches to viscoelastic fluid dynamics using Basilisk. We investigate four advanced multiphase flow phenomena involving complex rheology: bursting bubbles in polymer solutions, viscoplastic drop impact, soft material impacts, and Taylor-Culick retraction of viscoelastic filaments. Each simulation incorporates non-Newtonian behavior characterized by dimensionless parameters including Weissenberg, Deborah, Ohnesorge, and elasto-capillary numbers. Through these simulations, we develop practical skills in implementing log-conformation formulations for numerical stability, handling complex interfaces with adaptive mesh refinement, and visualizing rheologically complex flows. This assignment represents the culmination of our computational fluid dynamics progression, building on earlier work with heat conduction, single-phase flows, and simple multiphase systems.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#non-newtonian-flows-with-basilisk",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Introduction: In this final...",
    "content": "In this final assignment, we explore the fascinating world of viscoelastic fluid dynamics using computational simulations. Viscoelastic materials\u2014from polymer solutions to biological fluids, food products, and advanced materials\u2014exhibit both viscous (fluid-like) and elastic (solid-like) properties, leading to complex and often counterintuitive behaviors. Understanding these behaviors is crucial for applications ranging from inkjet printing and food processing to biological systems and advanced manufacturing. Building on our previous work with heat conduction ([[1st-workingAssignment]]), single-phase flows ([[2nd-workingAssignment]]), and simple multiphase flows ([[3rd-workingAssignment]]), we now tackle the additional complexity introduced by non-Newtonian rheology, viscoelasticity, and viscoplasticity.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Introduction: These phenomena represent...",
    "content": "These phenomena represent some of the most challenging aspects of computational fluid dynamics, requiring specialized numerical techniques for stable and accurate simulations. > [!info] Learning Objectives > > - Understand key mathematical models for viscoelastic and viscoplastic fluid behavior > - Implement log-conformation formulations for numerical stability in viscoelastic simulations > - Analyze how elasticity affects interfacial dynamics in multiphase flows > - Apply adaptive mesh refinement strategies to resolve complex interface evolution > - Develop skills in visualizing and interpreting non-Newtonian flow phenomena > - Relate dimensionless parameters to physical behaviors in complex fluids Throughout this assignment, we'll explore four complex multiphase flow simulations: 1. Bursting bubbles in viscoelastic media 2. Viscoplastic drop impact on a solid surface 3. Soft impact dynamics with viscoelastic fluids 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Introduction: Taylor-Culick retraction of...",
    "content": "Taylor-Culick retraction of viscoelastic filaments Each case presents unique physical phenomena and numerical challenges, providing a comprehensive overview of computational approaches to viscoelastic fluid dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 1: Viscoelastic Fluid Fundamentals",
    "content": "Before diving into specific simulations, let's establish the mathematical framework for understanding viscoelastic fluid behavior.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-1-viscoelastic-fluid-fundamentals",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 1.1 Constitutive Equations for Complex Fluids: Traditional Newtonian fluids...",
    "content": "Traditional Newtonian fluids are characterized by a linear relationship between stress and strain rate, governed by a constant viscosity: $$\\boldsymbol{\\tau} = \\mu \\dot{\\boldsymbol{\\gamma}}$$ where $\\boldsymbol{\\tau}$ is the stress tensor, $\\mu$ is the viscosity, and $\\dot{\\boldsymbol{\\gamma}}$ is the strain rate tensor. For non-Newtonian fluids, this relationship becomes more complex: 1. Viscoplastic fluids (e.g., Bingham plastics, Herschel-Bulkley fluids) exhibit a yield stress $\\tau_y$ that must be exceeded before flow occurs: $$\\boldsymbol{\\tau} = \\begin{cases} \\tau_{y}\\frac{\\dot{\\boldsymbol{\\gamma}}}{|\\dot{\\boldsymbol{\\gamma}}|} + K|\\dot{\\boldsymbol{\\gamma}}|^{n-1}\\dot{\\boldsymbol{\\gamma}}, & \\text{if } |\\boldsymbol{\\tau}| > \\tau_y \\ \\dot{\\boldsymbol{\\gamma}} = 0, & \\text{if } |\\boldsymbol{\\tau}| \\leq \\tau_y \\end{cases} $$ 2. Viscoelastic fluids exhibit memory effects, with stress depending on the deformation history.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#11-constitutive-equations-for-complex-fluids",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 1.1 Constitutive Equations for Complex Fluids: A common model...",
    "content": "A common model is the Oldroyd-B model: $$\\boldsymbol{\\tau} + \\lambda \\overset{\\nabla}{\\boldsymbol{\\tau}} = \\mu \\left( \\dot{\\boldsymbol{\\gamma}} + \\lambda_r \\overset{\\nabla}{\\dot{\\boldsymbol{\\gamma}}} \\right)$$ where $\\lambda$ is the relaxation time, $\\lambda_r$ is the retardation time, and $\\overset{\\nabla}{\\boldsymbol{\\tau}}$ denotes the upper-convected derivative of the stress tensor.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#11-constitutive-equations-for-complex-fluids",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 1.2 Key Dimensionless Parameters: Several dimensionless parameters...",
    "content": "Several dimensionless parameters characterize the behavior of complex fluids: 1. Weissenberg number (Wi): Ratio of elastic to viscous forces $$\\text{Wi} = \\lambda \\dot{\\gamma}$$ where $\\lambda$ is the relaxation time and $\\dot{\\gamma}$ is a characteristic strain rate 2. Deborah number (De): Ratio of material relaxation time to observation time $$\\text{De} = \\frac{\\lambda}{t_{\\text{obs}}}$$ 3. Elasticity number (El): Ratio of elastic to inertial effects $$\\text{El} = \\frac{\\text{Wi}}{\\text{Re}} = \\frac{\\lambda \\mu}{\\rho L^2}$$ 4. Ohnesorge number (Oh): Ratio of viscous forces to inertial and surface tension forces $$\\text{Oh} = \\frac{\\mu}{\\sqrt{\\rho \\sigma L}}$$ 5. Plasto-capillary number (J): Ratio of yield stress to capillary pressure $$\\mathcal{J} = \\frac{\\tau_y R_0}{\\sigma}$$ > [!note] Numerical Challenge Simulating viscoelastic flows presents significant numerical challenges, particularly at high Weissenberg numbers (known as the \"high Weissenberg number problem\").",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#12-key-dimensionless-parameters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 1.2 Key Dimensionless Parameters: Methods",
    "content": "Traditional numerical methods often fail due to the loss of positive-definiteness of the conformation tensor. The log-conformation approach we'll use in these simulations addresses this issue by working with the logarithm of the conformation tensor, ensuring numerical stability.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#12-key-dimensionless-parameters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 1.3 The Log-Conformation Approach",
    "content": "In our simulations, we employ the log-conformation approach, which transforms the conformation tensor $\\mathbf{A}$ logarithmically: $$\\mathbf{\\Psi} = \\log(\\mathbf{A})$$ The evolution equation is then solved for $\\mathbf{\\Psi}$ rather than directly for $\\mathbf{A}$, which ensures that the reconstructed conformation tensor remains positive-definite. This approach significantly improves numerical stability, especially for high Weissenberg number flows. The total stress in the fluid is the sum of the Newtonian solvent contribution and the polymer stress: $$\\boldsymbol{\\tau} = \\mu_s (\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^T) + \\mathbf{G}(\\mathbf{A} - \\mathbf{I})$$ where $\\mu_s$ is the solvent viscosity, $\\mathbf{G}$ is the elastic modulus, and $\\mathbf{I}$ is the identity tensor.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#13-the-log-conformation-approach",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 2: Bursting Bubbles in Viscoelastic Media",
    "content": "Our first simulation explores the dynamics of bubble bursting in viscoelastic fluids, a phenomenon that differs significantly from the Newtonian case due to elastic memory effects.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-2-bursting-bubbles-in-viscoelastic-media",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 2.1 Physical Description: When a bubble...",
    "content": "When a bubble reaches a free surface, the thin film separating it from the surrounding atmosphere eventually ruptures. This triggers a series of events: 1. Capillary waves travel along the interface 2. The bubble cavity collapses 3. A central jet may form and rise upward (Worthington jet) 4. Depending on conditions, the jet may break into droplets In viscoelastic fluids, elastic stresses dramatically alter these dynamics, often leading to enhanced jet formation and reduced droplet breakup due to elastic resistance to extensional deformation. > [!tldr] Problem Statement Simulate the bursting of a bubble at the interface between a viscoelastic fluid and air, examining how elasticity affects the jet dynamics and potential droplet formation.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#21-physical-description",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 2.1 Physical Description: Key dimensionless parameters...",
    "content": "Key dimensionless parameters include: > > - Deborah number (De): Ratio of relaxation time to flow time scale > - Elasto-capillary number (Ec): Ratio of elastic forces to surface tension > - Ohnesorge number (Oh): Ratio of viscous forces to inertial and capillary forces > - Bond number (Bond): Ratio of gravitational forces to surface tension",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#21-physical-description",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 2.2 Implementation Details: C/C++ Code",
    "content": "The simulation uses Basilisk's axisymmetric framework with a log-conformation approach for viscoelasticity: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // Main Navier-Stokes solver // Viscoelastic model implementation #if !_SCALAR #include \"log-conform-viscoelastic.h\" // Tensor implementation #else #include \"log-conform-viscoelastic-scalar-2D.h\" // Scalar implementation #endif #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" // Two-phase flow with viscoelasticity #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension forces ``` The bubble is initialized using a pre-calculated equilibrium shape that balances surface tension and gravitational forces: ```c event init (t = 0) { if (!restore (file = dumpFile)){ // Read initial shape from data file char filename[60]; sprintf(filename,\"Bo%5.4f.dat\",Bond); FILE * fp = fopen(filename,\"rb\"); // Generate distance field from shape coordinates coord* InitialShape; InitialShape = input_xy(fp); fclose (fp); // Compute signed distance function scalar d[]; distance (d, InitialShape); // Refine mesh based on distance function while (adapt_wavelet ((scalar *){f, d}, (double[]){1e-8, 1e-8}, MAXlevel).nf); // Convert distance function to volume fraction vertex scalar phi[]; foreach_vertex(){ phi[] = -(d[] + d[-1] + d[0,-1] + d[-1,-1])/4.; } fractions (phi, f); } } ``` Physical properties are specified based on the dimensionless parameters: ```c // Density ratio (liquid : gas = 1000:1) rho1 = 1., rho2 = 1e-3; // Gas phase Ohnesorge number Oha = 2e-2 * Oh; // Viscosity from Ohnesorge numbers mu1 = Oh, mu2 = Oha; // Polymer relaxation time (liquid has elasticity, gas does not) lambda1 = De; lambda2 = 0.; // Elastic modulus (liquid is viscoelastic, gas is not) G1 = Ec; G2 = 0.; // Surface tension coefficient f.sigma = 1.0; ``` > [!important] Adaptive Mesh Refinement The simulation uses multiple criteria for mesh refinement to accurately resolve the interface dynamics: > > ```c > event adapt(i++){ > // Calculate interface curvature for refinement criterion > scalar KAPPA[]; > curvature(f, KAPPA); > > // Adapt mesh based on multiple criteria > adapt_wavelet ((scalar *){f, u.x, u.y, conform_p.x.x, conform_p.y.y, > conform_p.y.x, conform_qq, KAPPA}, > (double[]){fErr, VelErr, VelErr, AErr, AErr, AErr, AErr, KErr}, > MAXlevel, MAXlevel-6); > } > ``` > > This adaptive approach concentrates computational resources where they're needed most: at the interface, in regions of high curvature, areas with significant velocity gradients, and regions with rapidly varying conformation tensor components.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#22-implementation-details",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 2.3 Expected Results: Results",
    "content": "For Newtonian fluids (De = 0), bubble bursting typically results in: 1. Rapid retraction of the film 2. Formation of capillary waves 3. Collapse of the cavity 4. Potential formation of a Worthington jet 5. Possible droplet pinch-off from the jet For viscoelastic fluids (De > 0), we expect to observe: 1. Enhanced jet formation due to elastic stresses 2. Delayed or suppressed droplet pinch-off 3. Longer and thinner jets at high Deborah numbers 4. Beads-on-a-string morphology for moderate elasticity > [!task] Exercise: Investigating Deborah Number Effects > > Modify the bubble bursting simulation to explore different Deborah numbers: > > 1. Run simulations with De = 0 (Newtonian), De = 1 (moderate elasticity), and De = 10 (high elasticity), keeping other parameters constant > 2. Track and compare: > - Maximum jet height > - Time to first droplet pinch-off (if it occurs) > - Jet morphology (thickness, length, shape) > 3.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#23-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 2.3 Expected Results: Explain the physical...",
    "content": "Explain the physical mechanisms behind the observed differences > > This exercise will help you understand how elastic memory affects interfacial dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#23-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 3: Viscoplastic Drop Impact",
    "content": "Our second simulation investigates the dynamics of a viscoplastic (yield-stress fluid) drop impacting a solid surface.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-3-viscoplastic-drop-impact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 3.1 Physical Background",
    "content": "When a viscoplastic drop impacts a surface, its behavior differs significantly from Newtonian drops due to the yield stress, which creates unyielded (solid-like) regions within the fluid. Key features include: 1. Initial deformation driven by inertia 2. Formation of unyielded regions where stress falls below the yield stress 3. Limited spreading compared to Newtonian drops 4. Potential formation of a solid-like cap at the drop apex 5. Asymmetric retractions and frozen interfaces after impact > [!tldr] Problem Statement Simulate the axisymmetric impact of a viscoplastic drop onto a solid surface. Key dimensionless parameters include: > > - Weber number (We): $\\text{We} = \\frac{\\rho U^2 D}{\\sigma}$ Ratio of inertial to surface tension forces > - Ohnesorge number (Oh): $\\text{Oh} = \\frac{\\mu}{\\sqrt{\\rho \\sigma D}}$ Ratio of viscous to inertial and surface tension forces > - Plasto-capillary number (J): $\\mathcal{J} = \\frac{\\tau_yR_0}{\\sigma}$ Ratio of yield stress to capillary pressure",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#31-physical-background",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 3.2 Mathematical Formulation",
    "content": "For the viscoplastic fluid, we employ the Herschel-Bulkley model with regularization: $$ \\boldsymbol{\\tau} = 2\\biggl[\\frac{\\mathcal{J}}{2|\\boldsymbol{\\mathcal{D}}|+\\epsilon} + \\mathcal{O}h (2|\\boldsymbol{\\mathcal{D}}|+\\epsilon)^{n-1}\\biggr]\\boldsymbol{\\mathcal{D}} $$ where: - $\\boldsymbol{\\mathcal{D}}$ is the deformation rate tensor - $|\\boldsymbol{\\mathcal{D}}|$ is its second invariant - $\\epsilon$ is a regularization parameter - $n$ is the power law index (n = 1 for Bingham model) - $\\mathcal{J}$ is the dimensionless yield stress - $\\mathcal{O}h$ is the Ohnesorge number The regularization ensures numerical stability by avoiding the mathematical singularity at zero deformation rate.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#32-mathematical-formulation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 3.3 Implementation Details: C/C++ Code",
    "content": "The simulation leverages a modified two-phase flow solver for viscoplastic fluids: ```c #include \"axi.h\" #include \"navier-stokes/centered.h\" #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVP-HB.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"reduced.h\" ``` Boundary conditions specify a solid wall at the left boundary: ```c // Left boundary: solid wall (no-slip and no flux) u.t[left] = dirichlet(0.0); // Tangential velocity = 0 (no-slip) f[left] = dirichlet(0.0); // Volume fraction = 0 (solid wall) ``` The drop is initialized with a downward velocity and positioned slightly above the wall: ```c event init (t = 0) { if (!restore (file = dumpFile)){ refine((R2Drop(x, y) [!important] Adaptive Refinement Strategy The simulation employs a sophisticated adaptive refinement strategy that changes based on the simulation stage: > > ```c > event adapt(i++){ > if (t // Early impact phase: focus on interface and velocity fields > adapt_wavelet ((scalar *){f, u.x, u.y}, > (double[]){fErr, VelErr, VelErr}, > MAXlevel); > } else { > // Later stages: add refinement based on curvature and deformation > scalar KAPPA[], D2c[]; > curvature(f, KAPPA); > foreach() { > // Calculate deformation tensor components > double D11 = (u.y[0,1] - u.y[0,-1])/(2*Delta); > double D22 = (u.y[]/y); > double D33 = (u.x[1,0] - u.x[-1,0])/(2*Delta); > double D13 = 0.5*((u.y[1,0] - u.y[-1,0] + u.x[0,1] - u.x[0,-1])/(2*Delta)); > double D2 = (sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13)); > D2c[] = f[]*(D2); // Deformation rate in the drop phase > } > adapt_wavelet ((scalar *){f, u.x, u.y, KAPPA, D2c}, > (double[]){fErr, VelErr, VelErr, KAPPAErr, D2Err}, > MAXlevel); > } > } > ``` > > This strategy ensures fine resolution near the interface and in regions of high deformation, which is critical for accurately capturing the yield surfaces where the stress transitions across the yield threshold.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#33-implementation-details",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 3.4 Expected Results",
    "content": "For viscoplastic drops, the impact dynamics depend strongly on the plasto-capillary number J: 1. Low J (J 1): Minimal deformation, approaching solid-like behavior A key feature to observe is the formation of unyielded regions where the stress falls below the yield stress. These regions behave as solid-like domains embedded within the flowing fluid. > [!task] Exercise: Non-Newtonian Impact Dynamics > > Compare viscoplastic drop impact with Newtonian drop impact: > > 1. Run simulations with J = 0 (Newtonian), J = 0.1 (moderate yield stress), and J = 0.5 (high yield stress) > 2. Compare: > - Maximum spread factor (ratio of maximum diameter to initial diameter) > - Final equilibrium shape > - Locations of unyielded regions (where applicable) > 3. Plot the spread factor vs. time for each case on a single graph > 4. Explain how yield stress affects the impact dynamics > > This exercise will help you understand how yield stress modifies impact behavior compared to Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#34-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 4: Soft Impact Dynamics with Viscoelastic Fluids",
    "content": "Our third simulation explores the dynamics of viscoelastic drop impact, focusing on the effects of elasticity on the impact behavior.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-4-soft-impact-dynamics-with-viscoelastic-fluids",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 4.1 Physical Background",
    "content": "When a viscoelastic drop impacts a surface, elastic stresses can lead to behaviors not seen in Newtonian impacts: 1. Enhanced rebound due to elastic energy storage and recovery 2. Suppression of satellite droplet formation 3. Extended filament formation during rebound 4. Complex fingering patterns during spreading 5. Beads-on-a-string morphology in retracting filaments > [!tldr] Problem Statement Simulate the impact of a viscoelastic drop on a solid surface, examining how elasticity affects the impact dynamics. Key dimensionless parameters include: > > - Weber number (We): Ratio of inertial to surface tension forces > - Ohnesorge number (Oh): Ratio of viscous to inertial and surface tension forces > - Weissenberg number (Wi): Ratio of elastic to viscous forces > - Elasticity number (El): Ratio of elastic to inertial effects > - Bond number (Bo): Ratio of gravitational to surface tension forces",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#41-physical-background",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 4.2 Implementation Details: C/C++ Code",
    "content": "The simulation uses a similar framework to the bubble bursting case, with axisymmetric formulation and log-conformation approach: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // Main Navier-Stokes solver // Viscoelastic model implementation #if !_SCALAR #include \"log-conform-viscoelastic.h\" // Tensor implementation #else #include \"log-conform-viscoelastic-scalar-2D.h\" // Scalar implementation #endif #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" // Two-phase flow with viscoelasticity #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension implementation ``` The drop is initialized as a sphere approaching the axis of symmetry (which represents the impact surface in the axisymmetric formulation): ```c event init (t = 0) { if (!restore (file = dumpFile)){ // Refine mesh around interface refine((R2Drop(x, y) [!note] Scalar vs.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#42-implementation-details",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 4.2 Implementation Details: Tensor Implementation The...",
    "content": "Tensor Implementation The code provides two options for implementing viscoelasticity: > > 1. Tensor Implementation: Full anisotropic stresses, physically accurate but computationally intensive > 2. Scalar Implementation: Simplified model, faster but less accurate for complex flows > > The tensor implementation tracks the full conformation tensor, while the scalar implementation uses a simplified approach that captures the main features while being computationally more efficient.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#42-implementation-details",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 4.3 Expected Results: Viscoelastic drop impact...",
    "content": "Viscoelastic drop impact exhibits several distinctive behaviors compared to Newtonian impact: 1. Weissenberg = 0 (Newtonian): Standard impact dynamics with spreading, potential rebound depending on Oh and We 2. Low Weissenberg: Enhanced rebound due to elastic recovery 3. Moderate Weissenberg: Formation of extended filaments during rebound 4. High Weissenberg: Dramatic enhancement of rebound with possible beads-on-a-string formation in filaments > [!task] Exercise: Elasticity Effects on Impact > > Investigate how elasticity affects drop impact behavior: > > 1. Run simulations with Wi = 0 (Newtonian), Wi = 1 (moderate elasticity), and Wi = 10 (high elasticity) > 2. For each case, track: > - Maximum spread factor > - Rebound height (if applicable) > - Time evolution of kinetic and elastic energy > 3. Visualize the stress distribution during impact for different Wi values > 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#43-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 4.3 Expected Results: Explain the physical...",
    "content": "Explain the physical mechanisms behind the observed differences > > This exercise will help you understand how elasticity modifies impact dynamics through storage and recovery of elastic energy.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#43-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 5: Taylor-Culick Viscoelastic Retraction",
    "content": "Our final simulation explores the capillary-driven retraction of a viscoelastic fluid filament, known as Taylor-Culick flow.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-5-taylor-culick-viscoelastic-retraction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 5.1 Physical Background: When a cylindrical...",
    "content": "When a cylindrical fluid filament with a free surface is suddenly released, surface tension causes it to retract. For Newtonian fluids, the retraction velocity reaches a constant value known as the Taylor-Culick velocity: $$v_{TC} = \\sqrt{\\frac{2\\sigma}{\\rho h}}$$ where $\\sigma$ is the surface tension, $\\rho$ is the density, and $h$ is the filament thickness. For viscoelastic fluids, the retraction dynamics are more complex due to elastic effects: 1. Initial acceleration phase similar to Newtonian fluids 2. Development of a bulbous end that grows as it collects fluid 3. Formation of a neck behind the bulbous end 4. Potential development of beads-on-a-string morphology 5. Modified retraction velocity due to elastic stresses > [!tldr] Problem Statement Simulate the retraction of a viscoelastic fluid filament under capillary action, examining how elasticity affects the retraction dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#51-physical-background",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 5.1 Physical Background: Key dimensionless parameters...",
    "content": "Key dimensionless parameters include: > > - Deborah number (De): Ratio of relaxation time to capillary time > - Ohnesorge number (Oh): Ratio of viscous to inertial and capillary forces > - Elasticity number (El): Ratio of elastic to inertial effects",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#51-physical-background",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 5.2 Implementation Details: C/C++ Code",
    "content": "The simulation uses the axisymmetric framework with log-conformation approach for viscoelasticity: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // Main Navier-Stokes solver // Viscoelastic model implementation #if !_SCALAR #include \"log-conform-viscoelastic.h\" // Tensor implementation #else #include \"log-conform-viscoelastic-scalar-2D.h\" // Scalar implementation #endif #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" // Two-phase flow with viscoelasticity #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension implementation ``` The initial configuration consists of a cylindrical filament with a hemispherical cap: ```c event init(t = 0){ if(!restore (file = dumpFile)){ // Refine grid near the interface refine(x [!important] Length Scales In this simulation, there are two important length scales: > > 1. `h0`: The filament thickness, set to 1.0 (the characteristic length) > 2. `hole0`: The initial distance of the hemispherical cap from the origin, also set to 1.0 > > These dimensions determine the initial geometry of the filament, which affects the subsequent retraction dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#52-implementation-details",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 5.3 Expected Results: The retraction dynamics...",
    "content": "The retraction dynamics of viscoelastic filaments show distinctive behaviors: 1. Newtonian (De = 0): Formation of a bulbous end with diameter approximately twice the filament thickness, constant retraction velocity 2. Low Deborah Number: Similar to Newtonian but with slightly modified bulbous end shape and retraction velocity 3. Moderate Deborah Number: Formation of a neck behind the bulbous end, potential development of beads-on-a-string morphology 4. High Deborah Number: Dramatic modification of retraction dynamics, with strong elastic resistance to extensional deformation in the neck region > [!task] Exercise: Viscoelastic Filament Retraction > > Investigate how viscoelasticity affects filament retraction: > > 1. Run simulations with De = 0 (Newtonian), De = 1 (moderate elasticity), and De = 10 (high elasticity) > 2. For each case, track: > - Retraction velocity over time > - Bulbous end diameter > - Neck formation and evolution (where applicable) > 3.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#53-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 5.3 Expected Results: Compare the observed...",
    "content": "Compare the observed retraction velocity with the theoretical Taylor-Culick velocity > 4. Explain how elasticity modifies the retraction dynamics through extensional rheology > > This exercise will help you understand how elasticity affects capillary-driven flows, particularly through resistance to extensional deformation.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#53-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Part 6: Numerical Considerations for Viscoelastic Simulations",
    "content": "Simulating viscoelastic flows presents unique numerical challenges that require special attention:",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#part-6-numerical-considerations-for-viscoelastic-simulations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 6.1 The High Weissenberg Number Problem",
    "content": "As mentioned earlier, traditional numerical methods often fail at high Weissenberg numbers due to the loss of positive-definiteness of the conformation tensor. This manifests as: 1. Unbounded growth of stress values 2. Numerical instabilities 3. Simulation divergence The log-conformation approach addresses this by: 1. Working with the logarithm of the conformation tensor 2. Ensuring the reconstructed tensor remains positive-definite 3. Allowing stable simulations at much higher Weissenberg numbers",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#61-the-high-weissenberg-number-problem",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 6.2 Adaptive Mesh Refinement Strategies",
    "content": "Effective adaptive mesh refinement is critical for viscoelastic simulations. Key refinement criteria include: 1. Interface location: Captured by volume fraction gradients 2. Velocity gradients: Important for capturing flow features 3. Interface curvature: Critical for surface tension effects 4. Conformation tensor gradients: Essential for capturing elastic stress variations Balancing these criteria is important for efficiency and accuracy.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#62-adaptive-mesh-refinement-strategies",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 6.3 Multiphase Interface Treatment",
    "content": "For multiphase viscoelastic simulations, proper treatment of interfaces is crucial: 1. Filtered approach: Smooths property jumps across interfaces for numerical stability 2. Conservative formulation: Ensures momentum conservation during rapid interface deformation 3. Tension model: Accurately captures surface tension forces",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#63-multiphase-interface-treatment",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - 6.4 Stability Tips",
    "content": "Based on experience with these simulations, here are some tips for ensuring stability: 1. Use a sufficiently small CFL number (typically 0.1 or less) 2. Start with a moderate Weissenberg/Deborah number and gradually increase 3. Ensure sufficient mesh resolution near interfaces and regions of high stress gradients 4. Monitor energy conservation and stress growth for early signs of instability 5. Use the tensor implementation for complex flows, switching to scalar only when necessary for performance > [!tip] Debugging Strategy If your viscoelastic simulation becomes unstable: > > 1. Check the kinetic energy for exponential growth > 2. Examine the conformation tensor components for unbounded growth > 3. Reduce the time step (lower CFL number) > 4. Increase mesh resolution near problematic regions > 5. Consider reducing the Weissenberg/Deborah number temporarily > 6. Ensure boundary conditions are properly implemented",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#64-stability-tips",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Conclusion: In this assignment,...",
    "content": "In this assignment, we've explored the fascinating world of computational viscoelastic fluid dynamics through four complex multiphase flow simulations. These simulations demonstrate the rich and often counterintuitive behaviors that emerge when elastic and viscoplastic effects are introduced into fluid flows. Key insights from our exploration include: 1. The critical importance of specialized numerical techniques (like the log-conformation approach) for stable viscoelastic simulations 2. The profound impact of elasticity on interfacial dynamics, from enhanced jet formation in bubble bursting to modified retraction behavior in filaments 3. The formation of unyielded regions in viscoplastic flows, creating complex solid-fluid transitions 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Conclusion: The challenges and...",
    "content": "The challenges and strategies for adaptive mesh refinement in flows with multiple time and length scales These complex fluid simulations represent the culmination of our progression through computational fluid dynamics, building on earlier foundations in heat conduction, single-phase flows, and simple multiphase systems. The techniques and insights gained are applicable to a wide range of real-world phenomena, from polymer processing and food science to biological flows and advanced manufacturing. > [!question] Further Exploration > > Consider these questions for deeper investigation: > > 1. How would viscoelasticity and viscoplasticity interact in a combined model (e.g., an elasto-viscoplastic fluid)? > 2. What role does fluid microstructure play in determining macroscopic rheological behavior? > 3. How could these models be extended to incorporate temperature-dependent properties? > 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4th workingassignment - Conclusion: What experimental techniques...",
    "content": "What experimental techniques could validate the computational predictions made by these simulations? > 5. How might machine learning approaches be used to develop more accurate constitutive models for complex fluids? > [!significance]- Metadata Author:: [Vatsal Sanjay](https://vatsalsanjay.com/) Date published:: March 12, 2025 Date modified:: March 12, 2025 at 10:15 CET > [!meta] Back to main website [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - GitHub repository",
    "content": "[Click here](https://github.com/comphy-lab/Basilisk-101) > [!tldr] TL;DR: > Heat Conduction Simulation Tutorial This tutorial walks through implementing heat conduction simulations, starting with basic vanilla C implementations and progressing to more powerful Basilisk C versions. We build from 1D steady-state problems to 2D, annular, and axisymmetric geometries, demonstrating how Basilisk's domain-specific language dramatically simplifies code while adding powerful features like adaptive mesh refinement and embedded boundaries. The tutorial includes eight progressive simulation cases, showing how the same physics can be implemented with increasingly sophisticated numerical methods, and concludes with custom post-processing tools for data extraction and visualization. Basilisk ultimately reduces hundreds of lines of vanilla C code to concise, readable implementations that handle complex geometries with minimal effort.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#github-repository",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Introduction: This guide walks...",
    "content": "This guide walks you through implementing heat conduction simulations using both vanilla C and the Basilisk framework. We'll progress from simple steady-state problems to more complex transient simulations in multiple dimensions, highlighting the advantages of Basilisk for computational fluid dynamics (CFD) and heat transfer applications. > [!info] Learning Objectives > > - Implement basic heat conduction solvers in vanilla C > - Transition to equivalent implementations in Basilisk C > - Understand the advantages of Basilisk's domain-specific language > - Develop simulations with increasing complexity (1D \u2192 2D \u2192 axisymmetric) > - Appreciate how Basilisk simplifies numerical methods implementation > - Learn to analyze and visualize simulation results with post-processing tools Throughout this tutorial, we'll follow a logical progression across eight core simulation cases: 1. Steady-state heat conduction in vanilla C (`1-conduction-simple.c`) 2.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Introduction: Transient heat conduction...",
    "content": "Transient heat conduction in vanilla C (`1-conduction-transient.c`) 3. Steady-state heat conduction in Basilisk (`1-conduction-simple-basilisk.c`) 4. Transient heat conduction in Basilisk (fill-in exercise) (`1-conduction-transient-basilisk.c`) 5. Enhanced transient solution with diffusion module (`1-conduction-transient-basilisk-withHeaders.c`) 6. 2D heat conduction (`1-conduction-2D.c`) 7. Heat conduction in an annulus (`1-conduction-2D-annulus.c`) 8. Axisymmetric heat conduction (`1-conduction-Axi.c`) After completing the simulations, we'll also cover how to post-process and visualize the results using custom tools.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 1.1 Steady-State Heat Conduction (1-conduction-simple.c): JavaScript",
    "content": "We'll begin with a fundamental 1D steady-state heat conduction problem in vanilla C. > [!tldr] Problem Statement Solve the steady-state heat equation: $$\\frac{d^2 T}{dx^2} = 0$$ Subject to Dirichlet boundary conditions: > > - $T(0) = 0$ > - $T(1) = 1$ > > The analytical solution is the linear profile $T(x) = x$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#11-steady-state-heat-conduction-1-conduction-simplec",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 1.1 Steady-State Heat Conduction (1-conduction-simple.c): Let's examine the...",
    "content": "Let's examine the key elements of this implementation: ```c // Domain discretization #define N 11 // Number of grid points #define MAX_ITER 10000 // Maximum number of iterations #define TOL 1e-10 // Convergence tolerance // Core iterative solver using Gauss-Seidel method double update_interior_points(double t_current[N], double t_new[N]) { int i; double error = 0.0; double diff; for (i = 1; i error) { error = diff; } } return error; } ``` This implementation uses the Gauss-Seidel iterative method with a central difference approximation for the second derivative: $$T_{i} \\approx \\frac{T_{i-1} + T_{i+1}}{2}$$ > [!note] Key Implementation Details > > - Arrays for storing current and new temperature values > - Explicit boundary condition application > - Manual iteration until convergence > - Manual memory management > - Explicit file I/O for results",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#11-steady-state-heat-conduction-1-conduction-simplec",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 1.2 Transient Heat Conduction (1-conduction-transient.c): Next, we'll look...",
    "content": "Next, we'll look at a 1D transient heat conduction problem in vanilla C. > [!tldr] Problem Statement Solve the transient heat equation: $$\\frac{\\partial T}{\\partial t} = \\frac{\\partial^2 T}{\\partial x^2}$$ With no-flux boundary conditions and an initial condition approximating a Dirac delta function. > > The analytical solution is a Gaussian profile that spreads over time: $$T(x,t) = \\frac{1}{2\\sqrt{\\pi t}}e^{-x^2/4t}$$ Key aspects of this implementation: ```c // Compute heat fluxes at cell interfaces void compute_fluxes(double *temperature, double *flux, double dx) { flux[0] = 0.0; // Left boundary (no flux) flux[N] = 0.0; // Right boundary (no flux) for (int i = 0; i [!note] Key Implementation Details > > - Explicit time-stepping scheme (forward Euler) > - Manual computation of fluxes at cell interfaces > - Explicit handling of boundary conditions > - Stability condition for time step ($dt \\leq dx^2/2$) > - Manual memory management and array allocation > - Explicit file I/O for snapshots and results",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#12-transient-heat-conduction-1-conduction-transientc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Exercise 1: Modify the Vanilla C Code",
    "content": "> [!task] Suggested Tasks > > 1. Modify `1-conduction-simple.c` to solve a 2D steady-state problem > - Add a second spatial dimension to the grid > - Update the Gauss-Seidel iteration for 2D > - Modify the boundary conditions for all four edges > 2. Modify `1-conduction-transient.c` to use a different initial condition > - Replace the Dirac delta with a Gaussian profile: $T(x,0) = e^{-x^2/\\sigma^2}$ > - Compare the numerical and analytical solutions at different times",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#exercise-1-modify-the-vanilla-c-code",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 2.1 Steady-State Heat Conduction in Basilisk (1-conduction-simple-basilisk.c): C/C++ Code",
    "content": "Now let's examine the equivalent steady-state problem implemented in Basilisk C. ```c #include \"grid/cartesian1D.h\" #include \"run.h\" // Declare scalar field for temperature scalar T[]; T[left] = dirichlet(0.0); T[right] = dirichlet(1.0); int main() { // Domain setup L0 = 1.0; // Domain length X0 = 0.0; // Left boundary N = 200; // Number of cells // Set the timestep based on stability criterion DT = (L0/N)*(L0/N)/2; // Create output directory char comm[80]; sprintf (comm, \"mkdir -p intermediate\"); system(comm); // Run simulation run(); } // Time integration using explicit finite volume method event marching (i++) { foreach() { // Proper heat equation time stepping T[] += DT*(T[1] - 2*T[] + T[-1])/(Delta*Delta); } } ``` > [!important] Basilisk Advantages > > - Simplified domain and grid setup > - Declarative boundary conditions > - Event-based programming model > - Intuitive stencil operations with `T[1]` and `T[-1]` > - Automatic handling of grid traversal with `foreach()` > - Significantly reduced code length with the same functionality",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#21-steady-state-heat-conduction-in-basilisk-1-conduction-simple-basiliskc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 2.2 Understanding Basilisk's Event System",
    "content": "Basilisk uses an event-based programming model that separates concerns: - `event init (t = 0)`: Initialization at t=0 - `event marching/integration (i++)`: Time integration at each step - `event end (t = end)`: Final operations at the end of the simulation Events can also be scheduled at specific times or intervals: ```c // Execute every 0.1 time units event writingFiles (t = 0.0; t += 0.1; t [!note] Event Scheduling Syntax The event scheduling syntax in Basilisk follows this pattern: > > ```c > event name (condition) { ... } > ``` > > Where condition can be: > > - `t = 0` - Single execution at t=0 > - `i++` - Every iteration > - `t += tsnap` - At regular time intervals > - `t = end` - At the end of simulation > - Combinations like `t = 0; t += 0.1; t < 1.0` for repeated execution",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#22-understanding-basilisks-event-system",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Exercise 2: Understand Basilisk Code Structure",
    "content": "> [!task] Tasks > > 1. Compare the structure and length of `1-conduction-simple.c` and `1-conduction-simple-basilisk.c` > - How many lines of code are in each? > - Which sections of code are simplified or eliminated in the Basilisk version? > 2. Identify the advantages of the Basilisk implementation > - List at least three specific advantages > - For each advantage, explain how it simplifies code development or maintenance > 3. Modify `1-conduction-simple-basilisk.c` to output the relative error > - Add code to calculate and print the error relative to the analytical solution > - Use the formula: $error = |T_{numerical} - T_{analytical}|/|T_{analytical}|$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#exercise-2-understand-basilisk-code-structure",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 3.1 Fill-in-the-Blanks Exercise (1-conduction-transient-basilisk.c): Let's implement the...",
    "content": "Let's implement the transient heat equation in Basilisk.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#31-fill-in-the-blanks-exercise-1-conduction-transient-basiliskc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 3.1 Fill-in-the-Blanks Exercise (1-conduction-transient-basilisk.c): C/C++ Code",
    "content": "Here's a template with some parts for you to fill in: ```c #include \"grid/cartesian1D.h\" #include \"run.h\" // Declare scalar field for temperature scalar T[]; // Simulation parameters #define EPS 0.1 // Width of initial temperature peak #define tmax 1.0 #define tsnap 0.1 int main() { // Domain setup L0 = 10.0; // Domain length X0 = -L0/2; // Left boundary N = 200; // Number of cells // Set the timestep based on stability criterion (CFL condition) // dt = dx^2/2 for explicit scheme DT = (L0/N)*(L0/N)/2; // Create output directory char comm[80]; sprintf (comm, \"mkdir -p intermediate\"); system(comm); // Run simulation run(); } / * Initialize temperature field * * Sets up a \"Dirac delta\" approximated by a thin rectangle * centered at x=0 with total integral = 1. */ event init (t = 0) { foreach() T[] = (fabs(x) [!hint] Stability Condition (K value) The stability condition for the 1D heat equation with explicit Euler time-stepping requires: $$dt \\leq \\frac{dx^2}{2}$$ So K = 2 is the appropriate value to ensure numerical stability. > [!hint] Understanding The Heat Equation Discretization The heat equation $\\frac{\\partial T}{\\partial t} = \\frac{\\partial^2 T}{\\partial x^2}$ can be discretized in two steps: > > 1.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#31-fill-in-the-blanks-exercise-1-conduction-transient-basiliskc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 3.1 Fill-in-the-Blanks Exercise (1-conduction-transient-basilisk.c): Compute heat fluxes...",
    "content": "Compute heat fluxes at cell interfaces: $q_{i+1/2} = -\\frac{T_{i+1}-T_i}{\\Delta x}$ > 2. Update temperature based on flux divergence: $\\frac{dT_i}{dt} = -\\frac{q_{i+1/2}-q_{i-1/2}}{\\Delta x}$ > > In Basilisk's staggered grid, `q[]` is at cell faces while `T[]` is at cell centers.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#31-fill-in-the-blanks-exercise-1-conduction-transient-basiliskc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Part 4: Enhanced Transient Solution with Diffusion Module: C/C++ Code",
    "content": "Now let's look at an enhanced implementation using Basilisk's built-in diffusion module. ```c #include \"grid/multigrid1D.h\" /* Multigrid solver is required by diffusion.h */ #include \"run.h\" #include \"diffusion.h\" // Declare scalar field for temperature scalar T[]; // Boundary conditions // The diffusion solver will use homogeneous Neumann conditions by default T[left] = neumann(0.); T[right] = neumann(0.); // Simulation parameters #define EPS 0.1 // Width of initial temperature peak #define tmax 1.0 #define tsnap 0.1 int main() { // Domain setup L0 = 10.0; // Domain length X0 = -L0/2; // Left boundary N = 10000; // Number of cells // We can use a larger timestep with the implicit solver // compared to the explicit version which requires dt = dx^2/2 DT = 0.01; // Create output directory char comm[80]; sprintf (comm, \"mkdir -p intermediate\"); system(comm); // Run simulation run(); } / * Initialize temperature field */ event init (t = 0) { foreach() T[] = (fabs(x) [!important] Advantages of Using diffusion.h > > - Implicit time stepping allows for much larger timesteps > - Unconditional stability removes the CFL restriction > - Higher accuracy due to careful implementation of boundary conditions > - Multigrid acceleration for faster convergence > - Adaptive mesh refinement compatible > - Handles complex geometries through embedded boundaries",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#part-4-enhanced-transient-solution-with-diffusion-module",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 5.1 2D Heat Conduction (1-conduction-2D.c)",
    "content": "Now, let's extend our simulations to two dimensions. > [!tldr] Problem Statement Solve the 2D transient heat equation: $$\\frac{\\partial T}{\\partial t} = \\nabla^2 T$$ With Dirichlet boundary conditions: > > - $T = 1$ on the top boundary > - $T = 0$ on all other boundaries Key aspects of the 2D implementation: ```c #include \"run.h\" #include \"diffusion.h\" // Declare scalar field for temperature scalar T[]; // Boundary conditions T[top] = dirichlet(1.); T[bottom] = dirichlet(0.); T[left] = dirichlet(0.); T[right] = dirichlet(0.); int main() { // Domain setup L0 = 10.0; // Domain length X0 = -L0/2; // Left boundary Y0 = -L0/2; // Bottom boundary init_grid (1 [!note] 2D Implementation Notes > > - Similar structure to 1D, but now using a 2D grid > - Uses `init_grid(1 - Boundary conditions for all four sides > - Implicit diffusion solver works in any dimension > - Added adaptive mesh refinement with `adapt_wavelet()`",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#51-2d-heat-conduction-1-conduction-2dc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 5.2 Heat Conduction in an Annulus (1-conduction-2D-annulus.c): Let's look at...",
    "content": "Let's look at a more complex geometry: heat conduction in an annular domain. > [!tldr] Annulus Problem Solve the transient heat equation in an annular domain: $$\\frac{\\partial T}{\\partial t} = \\nabla^2 T$$ With Dirichlet boundary conditions: > > - $T = 1$ on inner boundary (r = 1) > - $T = 0$ on outer boundary (r = 4) ```c #include \"run.h\" #include \"embed.h\" #include \"diffusion.h\" scalar T[]; // Define inner and outer radii #define INNER_RADIUS 1.0 #define OUTER_RADIUS 4.0 event init (t = 0) { // Define annular geometry using embedded boundaries solid (cs, fs, difference (sq(OUTER_RADIUS) - sq(x) - sq(y), sq(INNER_RADIUS) - sq(x) - sq(y))); // Set boundary conditions T[embed] = dirichlet (sq(x) + sq(y) 0. ? 1.0 : 0.0; // Diffusion only in fluid cells // Solve the diffusion equation while respecting embedded boundaries mgd = diffusion (T, dt, D); } ``` > [!important] Embedded Boundaries > > - `embed.h` provides tools for defining complex geometries > - `solid()` creates the embedded boundary using a level-set function > - `difference()` creates the annular region by subtracting two circles > - Boundary conditions are applied using `T[embed]` > - `fs.x[]` restricts diffusion to the fluid domain",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#52-heat-conduction-in-an-annulus-1-conduction-2d-annulusc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 5.3 Axisymmetric Heat Conduction (1-conduction-Axi.c)",
    "content": "Finally, let's look at an axisymmetric problem. > [!tldr] Axisymmetric Problem Solve the heat equation in cylindrical coordinates with axisymmetry: $$\\frac{\\partial T}{\\partial t} = \\frac{1}{r}\\frac{\\partial}{\\partial r}(r\\frac{\\partial T}{\\partial r}) + \\frac{\\partial^2 T}{\\partial z^2}$$ With boundary conditions: > > - Gaussian heat flux at r=0 (left boundary) > - $T = 0$ on top and right boundaries ```c #include \"axi.h\" #include \"run.h\" #include \"diffusion.h\" scalar T[]; int main() { // Domain setup L0 = 10.0; // Domain length X0 = -L0/2; // Left boundary init_grid (1 [!note] Axisymmetric Features > > - `axi.h` handles the axisymmetric formulation automatically > - In axisymmetric coordinates, `y` represents the radial direction (r) > - `fm.x[]` includes the metric terms for the axisymmetric Laplacian > - Neumann boundary with Gaussian profile at r=0 (left boundary) > - All the complexity of cylindrical coordinates is handled by Basilisk",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#53-axisymmetric-heat-conduction-1-conduction-axic",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Exercise 4: Advanced Heat Conduction Problems",
    "content": "> [!task] Tasks > > 1. Modify the 2D heat conduction problem > - Change boundary conditions to have a sinusoidal temperature on top: `T[top] = dirichlet(sin(\u03c0*x/L0))` > - Compare the steady-state solution with the new boundary condition > 2. Experiment with the annulus problem > - Try different inner and outer radius values > - Implement a time-dependent boundary condition on the inner boundary > 3. Extend the axisymmetric problem > - Add a heat source term using `source(T, dt)` > - Visualize the results with different flux profiles",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#exercise-4-advanced-heat-conduction-problems",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Part 6: Post-Processing and Visualization",
    "content": "After running simulations, we need tools to extract and visualize the results. We'll use two key tools: 1. `getData-generic-heatEq.c` - A Basilisk program to extract data from simulation snapshots 2. `Video-generic-heatEq.py` - A Python script to create visualizations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#part-6-post-processing-and-visualization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 6.1 Extracting Data with getData-generic-heatEq.c: C/C++ Code",
    "content": "This Basilisk utility reads simulation snapshots and extracts field data for visualization: ```c // getData-generic-heatEq.c #include \"utils.h\" #include \"output.h\" scalar T[]; scalar cs[] = {1}; char filename[80]; int nx, ny, len; double xmin, ymin, xmax, ymax, Deltax, Deltay; scalar * list = NULL; int main(int a, char const *arguments[]) { // Parse command line arguments sprintf (filename, \"%s\", arguments[1]); // Snapshot file xmin = atof(arguments[2]); ymin = atof(arguments[3]); // Domain min xmax = atof(arguments[4]); ymax = atof(arguments[5]); // Domain max ny = atoi(arguments[6]); // Number of points in y // Add fields to extract list = list_add (list, T); list = list_add (list, cs); // Restore the snapshot restore (file = filename); // Calculate grid parameters FILE * fp = ferr; Deltay = (double)((ymax-ymin)/(ny)); nx = (int)((xmax - xmin)/Deltay); Deltax = (double)((xmax-xmin)/(nx)); len = list_len(list); // Allocate memory for field data double field = (double ) matrix_new (nx, ny+1, len*sizeof(double)); // Extract data through interpolation for (int i = 0; i [!note] How getData-generic-heatEq.c Works > > 1.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#61-extracting-data-with-getdata-generic-heateqc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 6.1 Extracting Data with getData-generic-heatEq.c: Reads a simulation...",
    "content": "Reads a simulation snapshot file > 2. Takes domain extents and resolution as input > 3. Restores the simulation state > 4. Interpolates field values onto a regular grid > 5. Outputs coordinates and field values to stderr > > This approach allows flexible post-processing of any Basilisk simulation.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#61-extracting-data-with-getdata-generic-heateqc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 6.2 Visualization with Video-generic-heatEq.py",
    "content": "The Python script processes the extracted data and creates visualizations: ```python",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#62-visualization-with-video-generic-heateqpy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Example of key components from Video-generic-heatEq.py: Python Function",
    "content": "def gettingfield(filename, zmin, zmax, rmin, rmax, nr): # Run the getData utility and capture its output exe = [\"./getData-generic-heatEq\", filename, str(zmin), str(rmin), str(zmax), str(rmax), str(nr)] p = sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode(\"utf-8\") temp2 = temp1.split(\"\\n\") # Parse the output into arrays Rtemp, Ztemp, Ttemp, cstemp = [], [], [], [] for n1 in range(len(temp2)): temp3 = temp2[n1].split(\" \") if temp3 == ['']: pass else: Ztemp.append(float(temp3[0])) Rtemp.append(float(temp3[1])) Ttemp.append(float(temp3[2])) cstemp.append(float(temp3[3])) # Convert to numpy arrays and reshape R = np.asarray(Rtemp) Z = np.asarray(Ztemp) T = np.asarray(Ttemp) cs = np.asarray(cstemp) nz = int(len(Z)/nr) R.resize((nz, nr)) Z.resize((nz, nr)) T.resize((nz, nr)) cs.resize((nz, nr)) return R, Z, T, cs, nz def process_timestep(ti, caseToProcess, folder, tsnap, GridsPerR, rmin, rmax, zmin, zmax, lw): # Calculate time and filenames t = tsnap * ti place = f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\" name = f\"{folder}/{int(t*1000):08d}.png\" # Extract data nr = int(GridsPerR * rmax) R, Z, T, cs, nz = gettingfield(place, zmin, zmax, rmin, rmax, nr) # Create visualization fig, ax = plt.subplots() fig.set_size_inches(19.20, 10.80) # Mask regions outside the fluid domain T = np.ma.masked_where(cs != 1.0, T) # Plot temperature field cntrl1 = ax.imshow(T, cmap=\"coolwarm\", interpolation='Bilinear', origin='lower', extent=[-rminp, -rmaxp, zminp, zmaxp], vmax=1.0, vmin=0.0) # Add colorbar and save cb1 = fig.add_axes([l-0.04, b, 0.03, h]) c1 = plt.colorbar(cntrl1, cax=cb1, orientation='vertical') c1.set_label(r'$T$', fontsize=TickLabel, labelpad=5) plt.savefig(name, bbox_inches=\"tight\") plt.close() ``` > [!important] Visualization Process > > 1.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#example-of-key-components-from-video-generic-heateqpy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Example of key components from Video-generic-heatEq.py: For each timestep:...",
    "content": "For each timestep: > - Call `getData-generic-heatEq` to extract data > - Parse the output into NumPy arrays > - Create a plot using matplotlib > - Add appropriate colorbars and labels > - Save as an image file > 2. Parallelization: > - Uses Python's multiprocessing to handle multiple timesteps simultaneously > - Significantly speeds up the visualization process for large simulations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#example-of-key-components-from-video-generic-heateqpy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - 6.3 Running the Post-Processing Pipeline",
    "content": "To visualize your simulation results, follow these steps: 1. Compile the data extraction utility: ```bash basilisk1d getData-generic-heatEq.c -o getData-generic-heatEq ``` 2. Run the visualization script with appropriate parameters: ```bash python Video-generic-heatEq.py --CPUs=4 --nGFS=100 --GridsPerR=128 \\ --ZMAX=4.0 --RMAX=4.0 --ZMIN=-4.0 --RMIN=-4.0 --tsnap=1.0 \\ --caseToProcess=1-conduction-2D-annulus --folderToSave=Video ``` 3. Create a video from the generated images (optional): ```bash ffmpeg -framerate 10 -pattern_type glob -i 'Video/*.png' -c:v libx264 -pix_fmt yuv420p video.mp4 ``` > [!tip] Customizing Visualizations You can adjust the visualization parameters to highlight different aspects of your results: > > - Change the colormap using the `cmap` parameter in `ax.imshow()` > - Adjust the value range with `vmin` and `vmax` > - Modify the plot layout or add additional subplots > - Include contour lines with `ax.contour()`",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#63-running-the-post-processing-pipeline",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Conclusion: Throughout this tutorial,...",
    "content": "Throughout this tutorial, we've progressed from simple 1D steady-state heat conduction problems in vanilla C to complex geometries and dimensions using Basilisk C. The key takeaways include: 1. Basilisk significantly reduces the complexity and verbosity of numerical simulation code 2. The event-based programming model provides a clean separation of concerns 3. Basilisk's domain-specific language makes numerical methods more intuitive 4. Built-in modules like `diffusion.h` and `embed.h` provide powerful, optimized solvers 5. Extending to higher dimensions and complex geometries is straightforward 6.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - Conclusion: Results",
    "content": "Post-processing tools are essential for analyzing and interpreting simulation results > [!tip] Next Steps > > - Explore other physical phenomena like advection-diffusion > - Implement variable diffusion coefficients (e.g., temperature-dependent) > - Combine with Navier-Stokes solvers for natural convection problems > - Add source terms for heat generation > - Experiment with more complex geometries using the embedded boundary method > - Create interactive visualizations using tools like Plotly or ParaView",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - References and Resources: Context",
    "content": "- [Basilisk Documentation](http://basilisk.fr/Front%20Page) - [Embedded Boundaries in Basilisk](http://basilisk.fr/src/embed.h) - [Diffusion Module Documentation](http://basilisk.fr/src/diffusion.h) - [Axisymmetric Coordinates](http://basilisk.fr/src/axi.h) - [Adaptive Mesh Refinement](http://basilisk.fr/src/adapt.h) - [Basilisk View for Visualization](http://basilisk.fr/src/view.h) > [!question] Need Help?",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#references-and-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1st workingassignment - References and Resources: If you encounter...",
    "content": "If you encounter issues with any of the exercises, please check: > > - Code syntax and structure > - Boundary condition implementation > - Event scheduling and dependencies > - Numerical stability considerations > > Feel free to open an issue on the GitHub repository if you need further assistance. > [!info] Info > Thanks for reading, and feel free to dive deeper (or suggest improvements) via the [GitHub repository](https://github.com/comphy-lab/CoMPhy-Lab-Blogs)! --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 21, 2025 > Date modified:: Jan 25, 2025 at 14:22 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1st-workingAssignment/#references-and-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - Computational Fluid Dynamics with Basilisk: From Poiseuille Flow to Rayleigh-B\u00e9nard Convection",
    "content": "> [!tldr] TL;DR > This assignment explores fundamental fluid dynamics problems using Basilisk, progressing from simple Poiseuille flow to complex Rayleigh-B\u00e9nard convection. We study both Newtonian and non-Newtonian (Bingham) fluids, examine lid-driven cavity flow with flow visualization, and conclude with thermal convection simulation. The hands-on exercises with incrementally complex implementations help develop practical CFD skills while exploring rich physical phenomena, all through Basilisk's efficient simulation framework.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#computational-fluid-dynamics-with-basilisk-from-poiseuille-flow-to-rayleigh-b\u00e9nard-convection",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - Introduction: In this working...",
    "content": "In this working class, we'll explore advanced fluid dynamics simulations using the Basilisk framework. Building on our previous work with heat conduction ([[1st-workingAssignment]]), we'll now tackle more complex fluid flow problems that incorporate viscosity, non-Newtonian behavior, and thermal effects. > [!info] Learning Objectives > > - Implement and analyze Poiseuille flow simulations for Newtonian and non-Newtonian fluids > - Understand the lid-driven cavity benchmark problem and its implementation > - Extend simulations with flow visualization techniques > - Explore thermal convection through the Rayleigh-B\u00e9nard configuration > - Develop skills in modifying Basilisk code for different physical scenarios Throughout this tutorial, we'll follow a logical progression from simple to complex simulations: 1. Poiseuille flow with Newtonian fluids 2. Poiseuille flow with Bingham/non-Newtonian fluids 3. Lid-driven cavity with Newtonian fluids 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - Introduction: Lid-driven cavity with...",
    "content": "Lid-driven cavity with Bingham fluids (exercise) 5. Flow visualization in lid-driven cavity 6. Rayleigh-B\u00e9nard convection (exercise)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 1.1 Newtonian Poiseuille Flow (2-Poiseuille-flow-Newtonian.c): Let's begin with...",
    "content": "Let's begin with a fundamental fluid mechanics problem: Poiseuille flow with a Newtonian fluid. > [!tldr] Problem Statement > Solve for the steady-state velocity profile in a planar Poiseuille flow with a constant pressure gradient $-\\frac{dp}{dx} = 1$ and constant viscosity $\\mu_0$. For a Newtonian fluid, the analytical solution is a parabolic profile: $u(y) = \\frac{1}{2\\mu_0}y(h-y)$, where $h=1.0$ is the channel height.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#11-newtonian-poiseuille-flow-2-poiseuille-flow-newtonianc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 1.1 Newtonian Poiseuille Flow (2-Poiseuille-flow-Newtonian.c): C/C++ Code",
    "content": "The code uses Basilisk's Navier-Stokes solver to find the steady-state solution: ```c #include \"navier-stokes/centered.h\" // Global parameters char file_name[80]; double mu_0 = 1.0; // Constant viscosity (Newtonian) int max_iter = 1e4; // Maximum iterations #define DT_MAX (1e-3) // Maximum timestep // Initialization event event init(t = 0) { // Set constant Newtonian viscosity const scalar mu_const[] = mu_0; mu = mu_const; // Pressure gradient (-dp/dx = 1) const face vector mdpdx[] = {1.0, 0.0}; a = mdpdx; // Initialize velocity field at rest foreach() { u.x[] = 0; u.y[] = 0; un[] = 0; } } ``` > [!note] Key Implementation Details > > - The domain is a unit square with periodic left/right boundaries > - No-slip boundary at the bottom ($u=0$) > - Slip boundary at the top (zero-gradient) > - Constant horizontal pressure gradient of 1.0 > - Viscosity is set to a constant value (Newtonian fluid) > - Convergence is monitored by tracking changes in the velocity field At steady state, the simulation produces a parabolic velocity profile that can be compared with the analytical solution: ```c event end(t = end) { FILE *fp = fopen(\"profile.dat\", \"w\"); // Sample the velocity profile along the x-midpoint foreach_col(0) { // Calculate exact solution: u(y) = (1/2\u03bc) * y * (h-y) double y = y; double u_exact = (1.0/(2.0*mu_0)) * y * (L0-y); double error = fabs((u.x[] - u_exact)/u_exact); fprintf(fp, \"%g %g %g %g\\n\", y, u.x[], u_exact, error); } } ```",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#11-newtonian-poiseuille-flow-2-poiseuille-flow-newtonianc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 1.2 Non-Newtonian Poiseuille Flow (2-Poiseuille-flow-Bingham.c): Next, we'll extend...",
    "content": "Next, we'll extend our simulation to handle generalized Newtonian fluids, including Bingham plastics and power-law fluids. > [!tldr] Problem Statement > Solve for the steady-state velocity profile in a planar Poiseuille flow with a constant pressure gradient for a generalized Newtonian fluid that follows the Herschel-Bulkley model: $\\tau = \\tau_y + K(\\dot{\\gamma})^n$, where: > > - $\\tau_y$ is the yield stress > - $K$ is the consistency index > - $n$ is the power-law exponent > - $\\dot{\\gamma}$ is the strain rate The generalized Newtonian model can represent: - Newtonian fluid: $\\tau_y = 0$, $n = 1$ - Power-law fluid: $\\tau_y = 0$, $n \\neq 1$ - Bingham plastic: $\\tau_y > 0$, $n = 1$ - Herschel-Bulkley: $\\tau_y > 0$, $n \\neq 1$ The most important addition in this code is the calculation of the viscosity at each face based on the strain rate tensor: ```c event properties(i++) { foreach_face() { // Calculate deformation tensor components at face centers double D11 = (u.x[] - u.x[-1,0]); double D22 = ((u.y[0,1] - u.y[0,-1]) + (u.y[-1,1] - u.y[-1,-1])) / 4.0; double D12 = 0.5 * (((u.x[0,1] - u.x[0,-1]) + (u.x[-1,1] - u.x[-1,-1])) / 4.0 + (u.y[] - u.y[-1,0])); // Calculate second invariant double D2 = sqrt(sq(D11) + sq(D22) + 2.0 * sq(D12)) / Delta; // Calculate effective viscosity double mu_temp; if (D2 > 0.0) { double temp = tau_y / (sqrt(2.0) * D2) + mu_0 * exp((n - 1.0) * log(D2 / sqrt(2.0))); mu_temp = min(temp, mu_max); } else { if (tau_y > 0.0 || n [!important] Mathematical Background For generalized Newtonian fluids, the stress tensor is related to the deformation tensor by: > > $$\\boldsymbol{\\tau} = 2 \\mu_{eq} \\boldsymbol{\\mathcal{D}}$$ > > where the equivalent viscosity $\\mu_{eq}$ for a Herschel-Bulkley fluid is: > > $$\\mu_{eq} = \\frac{\\tau_y}{2|\\boldsymbol{\\mathcal{D}}|} + K|\\boldsymbol{\\mathcal{D}}|^{n-1}$$ > > To prevent numerical instability when $|\\boldsymbol{\\mathcal{D}}| \\approx 0$, we use regularization: > > 1.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#12-non-newtonian-poiseuille-flow-2-poiseuille-flow-binghamc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 1.2 Non-Newtonian Poiseuille Flow (2-Poiseuille-flow-Bingham.c): Compute viscosity as...",
    "content": "Compute viscosity as normal where strain rate is non-zero > 2. Cap the viscosity at $\\mu_{max}$ where needed > 3. Handle special cases for different values of $\\tau_y$ and $n$ This code allows us to study how different fluid models affect the velocity profile, from the parabolic profile of Newtonian fluids to the plug flow region characteristic of Bingham plastics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#12-non-newtonian-poiseuille-flow-2-poiseuille-flow-binghamc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 2.1 Newtonian Lid-Driven Cavity (2-LidDrivenCavity-Newtonian.c): The lid-driven cavity...",
    "content": "The lid-driven cavity is a classic benchmark problem in computational fluid dynamics. > [!tldr] Problem Statement > Solve for the steady-state flow in a square cavity with a moving top lid. The fluid is Newtonian with a constant viscosity, and all walls have no-slip boundary conditions except for the top wall, which moves at a constant velocity $u = 1$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#21-newtonian-lid-driven-cavity-2-liddrivencavity-newtonianc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 2.1 Newtonian Lid-Driven Cavity (2-LidDrivenCavity-Newtonian.c): C/C++ Code",
    "content": "The simulation setup is straightforward: ```c #include \"navier-stokes/centered.h\" // Constants #define LEVEL 8 // Grid refinement level #define MAXDT (1e-4) // Maximum timestep #define ERROR (1e-6) // Convergence error threshold // Boundary conditions // Top moving wall (lid) u.t[top] = dirichlet(1); // Other no-slip boundaries u.t[bottom] = dirichlet(0); u.t[left] = dirichlet(0); u.t[right] = dirichlet(0); ``` > [!note] Lid-Driven Cavity Characteristics The lid-driven cavity flow exhibits several key features: > > - Primary vortex in the center of the cavity > - Secondary corner vortices at low Reynolds numbers > - Benchmark for testing numerical schemes > - Reynolds number defined as Re = \u03c1UL/\u03bc = 1/\u03bc (with \u03c1=1, U=1, L=1) > > At low Reynolds numbers (high viscosity), the flow reaches a steady state with well-defined vortex structures. As Re increases, the flow becomes increasingly complex.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#21-newtonian-lid-driven-cavity-2-liddrivencavity-newtonianc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 2.2 Lid-Driven Cavity with Flow Visualization (2-LidDrivenCavity-Newtonian-dieInjection.c): C/C++ Code",
    "content": "To better visualize the flow patterns, we can add a passive tracer (dye) to the simulation: ```c #include \"navier-stokes/centered.h\" #include \"die-injection.h\" // Die injection parameters event init (t = 0) { // Set constant viscosity for Newtonian fluid mu = muv; // Initialize velocity field foreach() { u.x[] = 0; u.y[] = 0; un[] = 0; } } int main() { // Initialize grid and parameters init_grid(1<<LEVEL); L0 = 1.0; origin(-0.5, -0.5); DT = MAXDT; TOLERANCE = 1e-5; CFL = 0.25; // Die injection parameters tInjection = 0.05; // Inject the die after flow is established xInjection = 0.00; // X position (center of cavity) yInjection = 0.40; // Y position (center of cavity) // Run simulation run(); } ``` The `die-injection.h` header defines a scalar field that is transported with the flow: ```c // Define the scalar field for the die scalar T[]; scalar * tracers = {T}; // Initialize the die tracer to zero everywhere event init (t = 0) { foreach() T[] = 0.0; } // Inject the die at the specified time event inject_die (t = tInjection) { foreach() { double dist = sqrt(sq(x - xInjection) + sq(y - yInjection)); if (dist <= dieRadius) T[] = 1.0; } } ``` This tracer provides a clear visualization of the flow structures and their evolution over time, revealing the complex patterns that develop in the lid-driven cavity.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#22-lid-driven-cavity-with-flow-visualization-2-liddrivencavity-newtonian-dieinjectionc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 3.1 Modifying 2-LidDrivenCavity-Bingham.c for exercise: For the first...",
    "content": "For the first exercise, I recommend modifying the lid-driven cavity simulation for Bingham fluids. Here are some suggestions for redacting parts of the code: > [!task] Exercise: Implement Bingham Plastic Model in Lid-Driven Cavity > > In this exercise, you'll modify the lid-driven cavity code to simulate a Bingham plastic fluid. Complete the missing parts of the code to: > > 1. Calculate the deformation tensor components at face centers > 2. Compute the second invariant of the deformation tensor > 3. Implement the regularized Bingham viscosity model > 4. Apply the viscosity at cell faces > > You should run simulations with different yield stress values to observe how the flow structure changes.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#31-modifying-2-liddrivencavity-binghamc-for-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 3.1 Modifying 2-LidDrivenCavity-Bingham.c for exercise: Context",
    "content": "Code: [2-LidDrivenCavity-Bingham_QUES.c](https://github.com/comphy-lab/Basilisk-101/blob/main/testCases/2-LidDrivenCavity-Bingham_QUES.c) ```c event properties(i++) { foreach_face() { // TODO: Calculate deformation tensor components double D11 = /* Your code here */; double D22 = /* Your code here */; double D12 = /* Your code here */; // TODO: Calculate second invariant (D2) double D2 = /* Your code here */; double mu_local; if (D2 > 0.) { // TODO: Implement regularized Bingham model double temp = /* Your code here */; mu_local = /* Your code here */; } else { // Handle zero strain rate case mu_local = (tauy > 0.0) ? mumax : MU_0; } // Apply viscosity muv.x[] = fm.x[] * (mu_local); } } ``` 1. Observe and explain the formation of unyielded regions (plug flow) 2. Compare streamline patterns for different yield stress values 3. Investigate convergence behavior as yield stress increases 4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#31-modifying-2-liddrivencavity-binghamc-for-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 3.1 Modifying 2-LidDrivenCavity-Bingham.c for exercise: Plot velocity profiles...",
    "content": "Plot velocity profiles across horizontal or vertical sections > [!hint] Solution Hints: > > - Deformation tensor components must be calculated from velocity gradients > - Second invariant: $D_2 = \\sqrt{D_{ij}D_{ij}}$ > - Bingham model: $\\mu = \\tau_y/(2D_2) + \\mu_0$, with regularization to prevent division by zero > - Remember to use the appropriate spatial averaging for face-centered calculations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#31-modifying-2-liddrivencavity-binghamc-for-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 3.2 Modifying 2-Rayleigh-Benard.c for Exercise: > [!task] Exercise:...",
    "content": "> [!task] Exercise: Implement Rayleigh-B\u00e9nard Convection > > In this exercise, you'll implement a simulation of Rayleigh-B\u00e9nard convection using the Boussinesq approximation. Complete the missing parts of the code to: > > 1. Set up the domain and boundary conditions > 2. Initialize the temperature field with a small perturbation > 3. Implement the buoyancy force in the acceleration event > 4. Set up temperature diffusion > 5. Calculate and monitor the Nusselt number > > You'll explore how the Rayleigh number affects convection patterns. - [2-Rayleigh-Benard.c](https://github.com/comphy-lab/Basilisk-101/blob/main/testCases/2-Rayleigh-Benard.c) - [convection-Boussinesq_QUES.h](https://github.com/comphy-lab/Basilisk-101/blob/main/src-local/convection-Boussinesq_QUES.h) Additional challenges: 1. Calculating and plotting the Rayleigh number vs. number of convection cells 2. Investigating the effect of aspect ratio on convection patterns 3.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#32-modifying-2-rayleigh-benardc-for-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 3.2 Modifying 2-Rayleigh-Benard.c for Exercise: Measuring the critical...",
    "content": "Measuring the critical Rayleigh number where convection begins 4. Implementing different thermal boundary conditions > [!hint] Solution Hints: > > - The Boussinesq approximation adds a buoyancy term to the y-momentum equation > - Temperature should be initialized with a linear profile plus a small random perturbation > - The acceleration term should be: $a_y = g\\beta(T-T_0)$ > - Use the diffusion() function from diffusion.h for temperature evolution > - The Nusselt number can be calculated from the vertical heat flux at the boundaries",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#32-modifying-2-rayleigh-benardc-for-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 4.1 Common Basilisk Patterns",
    "content": "Throughout these simulations, you'll notice some common patterns in Basilisk code: > [!note] Common Basilisk Patterns > > 1. Grid initialization: > > ```c > init_grid(1 ``` > > 2. Boundary conditions: > > ```c > u.t[top] = dirichlet(1); // Tangential velocity > u.n[bottom] = dirichlet(0); // Normal velocity > ``` > > 1. Events for different stages: > > ```c > event init(t = 0) { ... } // Initialization > event properties(i++) { ... } // Property updates > event integration/marching(i++) { ... } // Time stepping > event logfile(i += 100) { ... } // Logging > ``` > > 2. Grid traversal with foreach(): > > ```c > foreach() { > // Operation on each cell > } > foreach_face() { > // Operation on each face > } > ``` > > 3. Convergence monitoring: > > ```c > double du = change(u.x, un); > if (du ``` >",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#41-common-basilisk-patterns",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - 4.2 Tips for Successful Simulations",
    "content": "Here are some tips to help you succeed with these simulations: > [!tip] Simulation Tips > > - Timestep selection: For explicit schemes, ensure the timestep satisfies the relevant stability criterion (e.g., CFL condition) > > - Convergence monitoring: Always check convergence by tracking changes in key variables > > - Grid resolution: Start with a coarse grid for quick tests, then refine for accuracy > > - Boundary conditions: Double-check that boundary conditions are correctly implemented > > - Regularization parameters: For non-Newtonian fluids, choose appropriate regularization parameters to balance accuracy and stability > > - Initial conditions: Use appropriate initial conditions to avoid unnecessary transients > > - Output frequency: Balance output frequency with computational resources and storage needs >",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#42-tips-for-successful-simulations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2nd workingassignment - Conclusion",
    "content": "> [!question] Further Exploration > > Once you've completed the basic exercises, consider these extensions: > > 1. How does the convergence behavior change with increasing yield stress in Bingham fluids? > > 2. Can you identify the critical Rayleigh number where convection cells first appear? > > 3. How would you modify the lid-driven cavity to include temperature effects (thermally-driven cavity)? > > 4. What happens if you implement an oscillating lid velocity instead of constant velocity? > > 5. Can you extend the Poiseuille flow simulation to include time-dependent pressure gradients? > > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com/) > Date published:: March 11, 2025 > Date modified:: March 11, 2025 at 08:48 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/2nd-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Computational Multiphase Flows with Basilisk: From Champagne Bubbles to Drop Impact",
    "content": "> [!tldr] TL;DR > This tutorial explores computational approaches to multiphase flow phenomena using Basilisk's axisymmetric framework. We examine five progressively complex simulations: bubble bursting, drop impact on pools, drop impact on solid surfaces, liquid lens equilibrium, and heated drop impact. Each simulation incorporates different physical aspects \u2013 surface tension, inertia, viscosity, thermal effects \u2013 characterized by dimensionless parameters including Ohnesorge, Bond, Weber, and Froude numbers. Through these simulations, we develop practical skills in handling complex interfaces, implementing boundary conditions, and visualizing flow features using adaptive mesh refinement techniques specifically designed for multiphase problems.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#computational-multiphase-flows-with-basilisk-from-champagne-bubbles-to-drop-impact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Introduction: In this tutorial,...",
    "content": "In this tutorial, we explore multiphase flow phenomena through computational simulations using the Basilisk framework. Multiphase flows \u2013 involving interactions between different fluids or phases \u2013 represent some of the most complex and visually striking phenomena in fluid dynamics. From bursting bubbles in champagne to raindrops impacting puddles, these phenomena are ubiquitous in both natural processes and industrial applications.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Introduction: Building on our...",
    "content": "Building on our previous work with heat conduction ([[1st-workingAssignment]]) and single-phase flows ([[2nd-workingAssignment]]), we now tackle the additional complexity introduced by fluid interfaces, surface tension, and multiple interacting phases. > [!info] Learning Objectives > - Implement and analyze axisymmetric multiphase flow simulations > - Understand key dimensionless parameters governing multiphase dynamics > - Develop skills in handling complex interfaces and boundary conditions > - Visualize and interpret dynamic interface evolution > - Apply adaptive mesh refinement strategies for multiphase problems > - Extend simulations to incorporate thermal effects Throughout this tutorial, we'll progress through five core simulation cases: 1. Bubble bursting at a free surface 2. Drop impact on a liquid pool 3. Drop impact on a solid surface 4. Equilibrium of liquid lenses 5.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Introduction: Heated drop impact...",
    "content": "Heated drop impact on a solid surface Each case introduces new physical aspects and numerical challenges, providing a comprehensive overview of computational multiphase fluid dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.1 Drop Impact on a Liquid Pool (3-DropImpactOnPool.c): When a liquid...",
    "content": "When a liquid drop impacts a pool of the same liquid, complex dynamics unfold including crater formation, capillary wave propagation, crown formation, and potential splashing or bubble entrapment. > [!tldr] Problem Statement > Simulate the axisymmetric impact of a liquid drop onto a pool of the same liquid. Key dimensionless parameters include: > > - Froude number (Fr): $\\text{Fr} = \\frac{U^2}{gD}$ Ratio of inertial to gravitational forces > > - Galilei number (Ga): $\\text{Ga} = \\frac{\\rho g D^3}{\\mu^2}$ Ratio of gravitational to viscous forces > > - Bond number (Bo): $\\text{Bo} = \\frac{\\rho g D^2}{\\sigma}$ Ratio of gravitational to surface tension forces > > > Where $U$ is impact velocity, $D$ is drop diameter, $g$ is gravity, $\\mu$ is viscosity, $\\rho$ is density, and $\\sigma$ is surface tension.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#11-drop-impact-on-a-liquid-pool-3-dropimpactonpoolc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.1 Drop Impact on a Liquid Pool (3-DropImpactOnPool.c): C/C++ Code",
    "content": "The implementation includes several advanced techniques: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // NS solver with centered discretization #define FILTERED 1 // Enable filtered VOF for stability #include \"two-phase.h\" // Two-phase flow solver #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension forces #include \"reduced.h\" // Reduced gravity formulation ``` A key feature of this simulation is the use of a tracer field to track the drop liquid even after it merges with the pool: ```c scalar tagDrop[]; // Tracer to identify the drop liquid event init(t = 0) { if (!restore(file = \"dump\")){ // Initialize the fluid configuration: // - Combined shape of drop and pool using union of: // - Drop: circle centered at (Hint,0) with radius 1 // - Pool: half-plane where x [!note] Reduced Gravity Formulation > The simulation uses the \"reduced.h\" module, which implements a more efficient approach to handling pressure in the presence of gravity.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#11-drop-impact-on-a-liquid-pool-3-dropimpactonpoolc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.1 Drop Impact on a Liquid Pool (3-DropImpactOnPool.c): Instead of solving...",
    "content": "Instead of solving for the total pressure, it solves for the reduced pressure: $p' = p - \\rho g z$. This approach provides better numerical stability for low-Froude-number flows.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#11-drop-impact-on-a-liquid-pool-3-dropimpactonpoolc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.2 Drop Impact on Solid Surfaces (3-DropImpactOnSolids.c): Drop impact on...",
    "content": "Drop impact on solid surfaces exhibits different dynamics compared to pool impact, with spreading, possible rebound, and various splashing behaviors depending on the parameters. > [!tldr] Problem Statement > Simulate the axisymmetric impact of a liquid drop on a solid surface.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#12-drop-impact-on-solid-surfaces-3-dropimpactonsolidsc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.2 Drop Impact on Solid Surfaces (3-DropImpactOnSolids.c): Key dimensionless parameters...",
    "content": "Key dimensionless parameters include: > > - Weber number (We): $\\text{We} = \\frac{\\rho U^2 D}{\\sigma}$ Ratio of inertial to surface tension forces > > - Ohnesorge number (Oh): $\\text{Oh} = \\frac{\\mu}{\\sqrt{\\rho \\sigma D}}$ Ratio of viscous forces to inertial and surface tension forces > > - Bond number (Bo): $\\text{Bo} = \\frac{\\rho g D^2}{\\sigma}$ Ratio of gravitational to surface tension forces > The boundary conditions for the solid wall are implemented as: ```c // Left boundary: solid wall (no-slip and no flux) u.t[left] = dirichlet(0.0); // Tangential velocity = 0 (no-slip) f[left] = dirichlet(0.0); // Volume fraction = 0 (solid wall) // Right boundary: outflow condition u.n[right] = neumann(0.); // Zero gradient for normal velocity p[right] = dirichlet(0.0); // Reference pressure = 0 ``` The drop is initialized with a downward velocity and positioned slightly above the wall: ```c event init(t = 0){ if(!restore(file = \"dump\")){ // Refine mesh near the drop interface refine((R2Drop(x,y) [!important] Dissipation-Based Refinement > This simulation includes an advanced refinement criterion based on the local dissipation rate: > > ```c > foreach(){ > // Calculate velocity gradient components in cylindrical coordinates > double D11 = (u.y[0,1] - u.y[0,-1])/(2*Delta); > double D22 = (u.y[]/max(y,1e-20)); > double D33 = (u.x[1,0] - u.x[-1,0])/(2*Delta); > double D13 = 0.5*((u.y[1,0] - u.y[-1,0] + u.x[0,1] - u.x[0,-1])/(2*Delta)); > > // Calculate dissipation rate (sum of squares of strain rates) > double D2 = (sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13)); > D2c[] = f[]*D2; // Dissipation rate in the drop phase > } > ``` > > This ensures that regions with high energy dissipation (typically near the spreading front and stagnation point) are well-resolved.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#12-drop-impact-on-solid-surfaces-3-dropimpactonsolidsc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.3 Heated Drop Impact (3-HeatedDropImpact.c): This advanced simulation...",
    "content": "This advanced simulation extends the drop impact problem to include thermal effects, modeling the heat transfer that occurs when a cold drop impacts a heated surface. > [!tldr] Problem Statement > Simulate the thermal-fluid dynamics of a cold liquid drop impacting a heated solid surface.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#13-heated-drop-impact-3-heateddropimpactc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 1.3 Heated Drop Impact (3-HeatedDropImpact.c): In addition to...",
    "content": "In addition to the mechanical parameters (We, Oh, Bo), the simulation includes thermal parameters: > > - Prandtl number (Pr = \u03bd/\u03b1): Ratio of momentum diffusivity to thermal diffusivity > - Thermal diffusivity ratio (D1/D2): Ratio of thermal diffusivities between the phases The simulation solves both the Navier-Stokes equations and the heat transfer equation: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // NS solver with centered discretization #define FILTERED // Use filtered VOF advection #include \"two-phase-thermal.h\" // Two-phase flow with heat transfer #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension model #include \"reduced.h\" // Reduced gravity approach ``` The thermal boundary conditions specify a constant heat flux from the hot substrate to the cold drop: ```c // Thermal boundary condition: constant heat flux from the hot substrate T[left] = neumann(10.0); // Fixed positive temperature gradient (heating the cold drop) ``` Physical properties include thermal diffusivity for both phases: ```c // Drop phase (1) properties rho1 = 1.0; // Density of drop (reference value) mu1 = Ohd/sqrt(We); // Viscosity derived from Ohnesorge number D1 = 1.0; // Thermal diffusivity of drop (reference value) // Surrounding phase (2) properties rho2 = Rho21; // Density ratio (air/water) mu2 = Ohs/sqrt(We); // Viscosity derived from Ohnesorge number D2 = 1e-3; // Thermal diffusivity ratio (air/water ~ 10^-3) ``` > [!note] Thermal Gradients and Adaptive Refinement The adaptive mesh refinement criteria now include temperature gradients alongside interface position, curvature, and velocity gradients: > > ```c > adapt_wavelet((scalar *){f, KAPPA, u.x, u.y, D2c, T}, > (double[]){fErr, KErr, VelErr, VelErr, DissErr, TErr}, > MAXlevel, MINlevel); > ``` > > This ensures that thermal boundary layers and temperature gradients are properly resolved.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#13-heated-drop-impact-3-heateddropimpactc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 2.2 Physical Background",
    "content": "When a bubble reaches a free surface, a thin film separates it from the surrounding atmosphere. This film eventually ruptures, leading to capillary waves traveling along the interface, followed by the collapse of the cavity and potentially the ejection of droplets. This phenomenon is relevant to numerous natural and industrial processes: - Aerosol production from ocean waves - Champagne bubbles and carbonated beverages - Volcanic eruptions - Industrial foaming processes > [!note] Key Physical Parameters Two dimensionless numbers primarily govern bubble bursting dynamics: > > - Ohnesorge number (Oh): $\\text{Oh} = \\frac{\\mu}{\\sqrt{\\rho \\sigma R}}$ Relates viscous forces to inertial and surface tension forces > > - Bond number (Bo): $\\text{Bo} = \\frac{\\rho g R^2}{\\sigma}$ Relates gravitational forces to surface tension forces > > > Where $\\mu$ is viscosity, $\\rho$ is density, $\\sigma$ is surface tension, $R$ is bubble radius, and $g$ is gravitational acceleration.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#22-physical-background",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 2.2 Implementing Bubble Bursting (3-BurstingBubbles.c): C/C++ Code",
    "content": "The simulation uses Basilisk's axisymmetric framework to model the bursting process: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // NS solver with centered discretization #define FILTERED // Smear density and viscosity jumps for stability #include \"two-phase.h\" // Two-phase flow solver #include \"navier-stokes/conserving.h\" // Conservative momentum advection #include \"tension.h\" // Surface tension forces ``` The bubble is initially defined using a pre-calculated equilibrium shape (based on the Bond number) that balances surface tension and gravitational forces: ```c event init (t = 0) { if (!restore (file = dumpFile)){ // Read initial shape from data file char filename[60]; sprintf(filename,\"Bo%5.4f.dat\",Bond); FILE * fp = fopen(filename,\"rb\"); // Generate distance field from shape coordinates coord* InitialShape; InitialShape = input_xy(fp); fclose (fp); scalar d[]; distance (d, InitialShape); // Refine mesh around interface while (adapt_wavelet ((scalar *){f, d}, (double[]){1e-8, 1e-8}, MAXlevel).nf); // Convert distance field to volume fraction vertex scalar phi[]; foreach_vertex(){ phi[] = -(d[] + d[-1] + d[0,-1] + d[-1,-1])/4.; } fractions (phi, f); } } ``` > [!important] Adaptive Mesh Refinement The simulation uses multiple criteria for mesh refinement to accurately resolve the interface dynamics: > > ```c > event adapt(i++){ > // Calculate interface curvature for refinement criterion > scalar KAPPA[]; > curvature(f, KAPPA); > > // Refine mesh based on multiple criteria > adapt_wavelet ((scalar *){f, u.x, u.y, KAPPA}, > (double[]){fErr, VelErr, VelErr, KErr}, > MAXlevel, MAXlevel-6); > } > ``` > > This adaptive approach concentrates computational resources where they're needed most: at the interface, in regions of high curvature, and in areas with significant velocity gradients.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#22-implementing-bubble-bursting-3-burstingbubblesc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 2.2 Implementing Bubble Bursting (3-BurstingBubbles.c): The simulation tracks...",
    "content": "The simulation tracks the kinetic energy to monitor the dynamics and determine when the system has reached a quasi-steady state: ```c event logWriting (i++) { // Calculate total kinetic energy (with axisymmetric integration) double ke = 0.; foreach (reduction(+:ke)){ ke += (2*pi*y)*(0.5*rho(f[])*(sq(u.x[]) + sq(u.y[])))*sq(Delta); } // Output to log and check for convergence/divergence fprintf (ferr, \"%d %g %g %g\\n\", i, dt, t, ke); // Check for energy explosion (instability) if (ke > 1e2 && i > 1e1){ fprintf(ferr, \"The kinetic energy blew up. Stopping simulation\\n\"); return 1; } // Check for near-static conditions (completion) if (ke 1e1){ fprintf(ferr, \"kinetic energy too small now! Stopping!\\n\"); return 1; } } ```",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#22-implementing-bubble-bursting-3-burstingbubblesc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 2.3 Expected Results",
    "content": "For low Ohnesorge numbers (low viscosity), we expect to see: 1. Rapid retraction of the film after rupture 2. Capillary waves traveling along the interface 3. Formation of a central jet (Worthington jet) 4. Possible pinch-off of droplets from the jet For higher Ohnesorge numbers (higher viscosity), viscous damping suppresses these features, resulting in a more gradual collapse of the cavity.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#23-expected-results",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 3.1 Three-Phase Systems (3-EquilibriumOfLiquidLenses.c): A liquid lens...",
    "content": "A liquid lens forms when a drop of one liquid sits at the interface between another liquid and a gas. The equilibrium shape is determined by the balance of surface tension forces at the three-phase contact line. > [!tldr] Problem Statement S > imulate the equilibrium shape of a liquid lens at the interface between two immiscible fluids. The system consists of three phases: > > 1. Dispersed phase (labeled as phase 1) > 2. Water drop (labeled as phase 2) > 3. Air (labeled as phase 3) > > Surface tension coefficients between the three pairs of phases determine the equilibrium contact angles according to the Neumann triangle condition.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#31-three-phase-systems-3-equilibriumofliquidlensesc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 3.1 Three-Phase Systems (3-EquilibriumOfLiquidLenses.c): C/C++ Code",
    "content": "This simulation uses Basilisk's three-phase flow solver: ```c #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // Centered finite-volume Navier-Stokes solver #define FILTERED // Enable property filtering for stability #include \"three-phase.h\" // Three-phase interface tracking #include \"tension.h\" // Surface tension model ``` Surface tension coefficients are defined between each pair of phases: ```c // Set surface tension coefficients between phase pairs f1.sigma = 1.0; // Surface tension: dispersed phase-air (\u03c3\u2081\u2083, reference value) f2.sigma = 52/16; // Surface tension: dispersed phase-water drop (\u03c3\u2081\u2082 \u2248 3.25) // Note: The effective surface tension between water and air (\u03c3\u2082\u2083) will be: // \u03c3\u2082\u2083 = \u03c3\u2081\u2083 + \u03c3\u2081\u2082 = 1.0 + 52/16 = 4.25 // This satisfies the ideal precursor film assumption (Neumann triangle) ``` The initial configuration puts a water drop slightly below the interface between the dispersed phase and air: ```c event init(t = 0){ if(!restore (file = \"dump\")){ // Refine mesh around the water drop for better resolution refine(sq(x+1.025) + sq(y) 0 is air fraction(f1, -x); // Update the boundary conditions boundary ((scalar *){f1, f2}); } } ``` > [!important] Neumann Triangle and Contact Angles The equilibrium contact angles at the three-phase junction are determined by the balance of surface tension forces, known as the Neumann triangle condition: > > $$\\frac{\\sigma_{12}}{\\sin\\theta_3} = \\frac{\\sigma_{23}}{\\sin\\theta_1} = \\frac{\\sigma_{13}}{\\sin\\theta_2}$$ > > Where $\\sigma_{ij}$ is the surface tension between phases $i$ and $j$, and $\\theta_k$ is the angle in phase $k$. > > In this simulation, we've set $\\sigma_{13} = 1.0$ and $\\sigma_{12} = 3.25$, resulting in specific equilibrium contact angles at the three-phase junction.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#31-three-phase-systems-3-equilibriumofliquidlensesc",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Part 4: Exercises and Extensions",
    "content": "Now that we've explored the fundamentals of these multiphase flow simulations, let's develop your skills further with some practical exercises.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#part-4-exercises-and-extensions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 4.1 Bubble Bursting Exercise",
    "content": "> [!task] Exercise: Investigating Ohnesorge Number Effects > > Modify the bubble bursting simulation to explore different Ohnesorge numbers: > > 1. Run simulations with Oh = 1e-3, 1e-2, and 1e-1, keeping Bo constant > 2. Track and compare the following: > - Maximum jet height > - Time to first droplet pinch-off (if it occurs) > - Maximum kinetic energy during the process > 3. Create plots showing these metrics as functions of Oh > 4. Explain the physical mechanisms behind the observed trends > > This exercise will help you understand how viscosity affects capillary-inertial dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#41-bubble-bursting-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 4.2 Drop Impact Exercise",
    "content": "> [!task] Exercise: Comparing Pool and Solid Surface Impact > > Conduct a comparative study between drop impact on a pool and on a solid surface: > > 1. Set up equivalent simulations for both scenarios: > - Use the same Weber number and Ohnesorge number > - Match other parameters (domain size, resolution, etc.) > 2. Track and compare the following: > - Maximum spread diameter > - Crater depth (for pool impact) > - Energy dissipation rate > 3. Visualize the differences in flow patterns using streamlines or velocity magnitude contours > 4. Explain why the outcomes differ based on the underlying physics > > Hint: Pay special attention to the boundary conditions and how they affect momentum transfer.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#42-drop-impact-exercise",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - 4.3 Advanced Exercise: Thermal Effects",
    "content": "> [!task] Exercise: Temperature-Dependent Surface Tension > > Modify the heated drop impact simulation to include temperature-dependent surface tension: > > 1. Implement the linear relationship: $\\sigma(T) = \\sigma_0(1 - \\gamma(T - T_0))$ > - $\\sigma_0$ is the reference surface tension at temperature $T_0$ > - $\\gamma$ is the temperature coefficient (typically positive) > 2. Run simulations with $\\gamma = 0$ (constant surface tension) and $\\gamma = 0.01$ (temperature-dependent) > 3. Analyze how Marangoni effects (surface tension gradients) affect the spreading dynamics > 4. Visualize temperature and velocity fields to identify regions where thermal effects are most significant > > This extension introduces thermocapillary phenomena, which are important in many industrial processes.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#43-advanced-exercise-thermal-effects",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Part 5: Implementation Tips and Best Practices: Based on our...",
    "content": "Based on our exploration of these multiphase simulations, here are some key insights and best practices: > [!tip] Multiphase Simulation Tips > > 1. Interface resolution: Always ensure sufficient resolution near interfaces, especially in regions of high curvature. The `adapt_wavelet()` function with appropriate error thresholds is crucial. > > 2. Numerical stability: For high-density and viscosity ratios (typical in air-water systems), use: > > - The `FILTERED` option to smooth property jumps > - The `navier-stokes/conserving.h` module for better momentum conservation > - Appropriate timestep limitations (CFL 3. Boundary conditions: Pay careful attention to boundary conditions, especially for solid surfaces. Use `dirichlet()` and `neumann()` appropriately. > > 4. Initial conditions: Start with a well-resolved and physically reasonable initial condition. For drop impact, position the drop slightly above the surface. > > 5.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#part-5-implementation-tips-and-best-practices",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Part 5: Implementation Tips and Best Practices: Convergence monitoring: Track...",
    "content": "Convergence monitoring: Track relevant physical quantities (kinetic energy, interface position) to determine when the simulation has reached a quasi-steady state. > > 6. Parameter sensitivity: Multiphase flows can be sensitive to small parameter changes. Conduct parameter sweeps to understand the system behavior. > > [!important] Dimensionless Parameters > > Understanding the key dimensionless parameters is essential for characterizing multiphase flows: > > - Weber number (We): Inertia vs. surface tension > - Ohnesorge number (Oh): Viscosity vs. inertia and surface tension > - Bond number (Bo): Gravity vs. surface tension > - Froude number (Fr): Inertia vs. gravity > - Capillary number (Ca): Viscosity vs. surface tension > > These parameters form a framework for classifying and predicting multiphase flow behavior across different scales and fluid properties.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#part-5-implementation-tips-and-best-practices",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Conclusion: In this tutorial,...",
    "content": "In this tutorial, we've explored a range of fascinating multiphase flow phenomena through computational simulations using Basilisk. From bubble bursting to heated drop impact, these simulations capture complex interfacial dynamics that would be challenging to study experimentally. Key insights from our exploration include: 1. The importance of surface tension in driving capillary-inertial phenomena 2. The role of viscosity in damping interfacial oscillations and jet formation 3. The complex interplay between solid boundaries and fluid interfaces 4. The additional complexity introduced by thermal effects 5.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Conclusion: Methods",
    "content": "The power of adaptive mesh refinement in efficiently resolving multiscale features These multiphase flow simulations demonstrate the capability of modern computational methods to capture complex physics with remarkable detail, providing insights into phenomena that occur too quickly or at scales too small for easy experimental observation. > [!question] Further Exploration > > Consider these questions for deeper investigation: > > 1. How would adding surfactants affect bubble bursting or drop impact dynamics? > 2. What happens when the drop and pool liquids have different properties (e.g., immiscible liquids)? > 3. How do contact angle effects influence drop impact on solid surfaces? > 4. What role does the ambient gas play in drop impact phenomena? > 5.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3rd workingassignment - Conclusion: How would phase...",
    "content": "How would phase change (evaporation or solidification) alter these dynamics? > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com/) > Date published:: March 12, 2025 > Date modified:: March 12, 2025 at 09:30 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Think before you compute",
    "content": "- Conservation laws and the numerical solution of the Navier\u2013Stokes equations - Transport equations - *Brief intro to Basilisk coding framework*",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#think-before-you-compute",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - First coding steps",
    "content": "- Implementing basic transport equations in Basilisk C. - Using headers in Basilisk, modular code structure, problem setup, and compilation - [1st Working Assignment](1st-workingAssignment)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#first-coding-steps",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Next coding steps",
    "content": "- Solving Navier\u2013Stokes equations in Basilisk C: [2nd Working Assignment](2nd-workingAssignment.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#next-coding-steps",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Interface Dynamics",
    "content": "- Interface tracking methods (VoF, level set, phase-field approaches) and numerical strategies - Hands-on tutorial with interface-tracking to a simple two-phase problem: [3rd Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/3rd-workingAssignment)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#interface-dynamics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Non-Newtonian flows",
    "content": "- Non-Newtonian flows: viscoelasticity. - Coding exercises for viscoelastic fluids: [4th Working Assignment](https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/4th-workingAssignment)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#non-newtonian-flows",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Special topics",
    "content": "- Three-phase flows. - Holey Sheets. - Contact line dynamics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/0-README/#special-topics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - Advantages of Basilisk Over Vanilla C for Computational Fluid Dynamics",
    "content": "After examining the implementation of heat conduction problems in both vanilla C and Basilisk, several significant advantages of using Basilisk become apparent. This document outlines these benefits to help new users understand why Basilisk is a powerful tool for computational fluid dynamics (CFD) simulations.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#advantages-of-basilisk-over-vanilla-c-for-computational-fluid-dynamics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 1. Simplified Domain and Grid Management",
    "content": "Vanilla C: - Requires manual definition of grid points, cell spacings, and domain extents - Needs explicit calculation of physical coordinates for each point - Requires manual array allocation and deallocation Basilisk: - Simple declaration of domain parameters (`L0`, `X0`, `N`) - Automatic grid generation and management - No need for explicit memory allocation/deallocation for grid points",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#1-simplified-domain-and-grid-management",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 2. Declarative Boundary Conditions",
    "content": "Vanilla C: - Requires explicit functions to apply boundary conditions - Boundary conditions must be repeatedly applied during solution - Error-prone due to manual indexing Basilisk: - Declarative boundary conditions using a simple, intuitive syntax: ```c T[left] = dirichlet(0.0); T[right] = dirichlet(1.0); ``` - Applied automatically during computation",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#2-declarative-boundary-conditions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 3. Event-Based Programming Model",
    "content": "Vanilla C: - Procedural, sequential code execution - Complex control flow for time-stepping, initialization, and output - Difficult to separate logical components Basilisk: - Event-based programming model that separates concerns: - `event init` for initialization - `event integration/marching` for time stepping - `event end` for final output - Events can be scheduled to occur at specific times or intervals - Cleaner, more modular code structure",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#3-event-based-programming-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 4. Automatic Time Step Management",
    "content": "Vanilla C: - Manual implementation of time step calculations - Explicit checks to ensure numerical stability (CFL condition) - Manual logic to hit specific output times exactly Basilisk: - Automatic time step management with `dtnext(DT)` - Built-in tools for maintaining numerical stability - Events can be scheduled at specific times with `t += tsnap`",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#4-automatic-time-step-management",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 5. Stencil Operations and Spatial Discretization",
    "content": "Vanilla C: - Explicit array indexing for neighbor access - Manual implementation of finite difference/volume stencils - Error-prone due to index arithmetic Basilisk: - Intuitive stencil notation: `T[1]`, `T[-1]` for neighbors - `foreach()` iterator for grid traversal without manual indexing - Automatic handling of boundary conditions during stencil operations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#5-stencil-operations-and-spatial-discretization",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 6. Reduced Boilerplate Code",
    "content": "Vanilla C: - Lengthy implementations even for simple problems - Requires explicit implementations of utility functions - Verbose memory management Basilisk: - Significantly shorter code for equivalent functionality - Built-in functions for common operations - Less cognitive load due to reduced complexity",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#6-reduced-boilerplate-code",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 7. Scalar Field Declaration and Management",
    "content": "Vanilla C: - Manual array allocation for each field - Explicit memory management to prevent leaks - No standard methods for field operations Basilisk: - Simple scalar field declaration: `scalar T[]` - Automatic memory management - Built-in methods for field operations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#7-scalar-field-declaration-and-management",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 8. Flux Computation and Conservative Formulation",
    "content": "Vanilla C: - Manual flux computation at interfaces - Error-prone implementation of conservation laws - Complex indexing for interface values Basilisk: - Simplified flux computation with stencil notation - Natural expression of conservation laws - Automatic handling of flux boundary conditions",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#8-flux-computation-and-conservative-formulation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - 9. Extensibility and Library Integration",
    "content": "Vanilla C: - Limited reusability of code components - Need to reimplement common algorithms - Difficult to extend to more complex problems Basilisk: - Modular design allows easy extension - Rich library of pre-implemented physics modules - Natural pathway to more complex simulations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#9-extensibility-and-library-integration",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 conduction takeaways - Conclusion",
    "content": "The Basilisk computational environment provides significant advantages over vanilla C for fluid dynamics simulations. By abstracting away the implementation details of grid management, boundary conditions, and numerical methods, Basilisk allows researchers and engineers to focus on the physics of their problems rather than the computational details. This leads to more readable, maintainable, and correct code with significantly less development effort. The comparison of the heat conduction examples shows that equivalent problems can be solved with much less code in Basilisk, while simultaneously providing a more intuitive and robust framework for extending to more complex physical phenomena.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Basilisk101/1-conduction-takeaways/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./1.75-Complementary-Questions-Answers.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Lecture 1: Complementary Questions - Answers",
    "content": "Course: Introduction to Soft Condensed Matter Assignment Type: Self-assessed questions ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#lecture-1-complementary-questions---answers",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 1: Why Soft Materials Have Small Moduli: Question: Explain in...",
    "content": "Question: Explain in your own words why many soft materials (rubbers, gels, emulsions) have moduli that are orders of magnitude smaller than crystalline solids. Answer: In crystalline solids, stiffness arises from steep interatomic potentials acting at atomic spacing (~0.1 nm). The elastic energy density scales like $U/a^3$, which is why bulk and shear moduli reach GPa\u2013TPa scales for materials like diamond and steel. By contrast, in rubbers, gels, and many soft networks, the load-bearing modulus is largely entropic. Thermal fluctuations of network strands resist deformation, giving: $$G \\approx n k_B T \\sim \\frac{k_B T}{\\xi^3}$$ (This relation applies specifically to semi-dilute polymer networks forming blob structures\u2014see [[Polymer-Concentration-Regimes-and-Blob-Networks]] for details.) where $\\xi$ is a mesoscopic mesh size.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-1-why-soft-materials-have-small-moduli",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 1: Why Soft Materials Have Small Moduli: Because $\\xi$ is...",
    "content": "Because $\\xi$ is nm\u2013\u03bcm (not atomic scale), the energy per unit volume is tiny, so $G$ lands in the kPa\u2013MPa range: - $\\xi \\approx 10$ nm $\\Rightarrow G \\approx 4$ kPa - $\\xi \\approx 1$ nm $\\Rightarrow G \\approx 4$ MPa Key insight: Strong, short-range bond energetics at atomic scales versus thermal, entropic elasticity at mesoscopic scales explains the orders-of-magnitude gap in moduli. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-1-why-soft-materials-have-small-moduli",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 2: Everyday Product Classification",
    "content": "Question: Pick any everyday product and identify which class of soft matter it belongs to and which microstructural ingredient gives it function (1-2 sentences). Answer: Shaving cream is a foam (gas dispersed in liquid). Its function\u2014staying puffy yet shapeable\u2014comes from a network of thin, surfactant-stabilized gas\u2013liquid films and curved interfaces that store surface energy and give yield-like behavior. Alternative examples: - Yogurt: Gelled colloid with protein network trapping water - Mayonnaise: Emulsion with oil droplets stabilized by egg proteins - Rubber band: Cross-linked polymer network with entropic elasticity ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-2-everyday-product-classification",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 3: Entropic Restoring Force",
    "content": "Question: A polymer coil in a good solvent is gently stretched and released. Why is the restoring force called entropic? Answer: A flexible polymer in a good solvent has an enormous number of random-coil configurations. When stretched, the number of accessible conformations decreases (entropy \u2193), raising the free energy. When released, the chain retracts to maximize entropy, so the macroscopic restoring force is entropic in origin\u2014it arises from the system's tendency to explore more configurations, not from bond stretching or potential energy changes. Mathematical expression: For a Gaussian chain, the restoring force is: $$F = -T \\frac{\\partial S}{\\partial x}$$ This is fundamentally different from a metal spring, where the force comes from atomic bond deformation (enthalpic). The polymer spring is driven by statistics and thermal fluctuations. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-3-entropic-restoring-force",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 4: Rayleigh\u2013Plateau Instability: Question: You slowly...",
    "content": "Question: You slowly pour a thin stream of water; after a short distance the stream breaks into drops. Name the instability and the thermodynamic driver, and give one way engineers harness or avoid it. Answer: Instability name: Rayleigh\u2013Plateau instability of a liquid cylinder Thermodynamic driver: Surface tension\u2014the stream lowers its surface free energy by transforming a high-area cylinder into nearly spherical drops. Long-wavelength perturbations grow fastest because drops have less surface area than a cylinder of the same volume.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-4-rayleighplateau-instability",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.75 complementary questions answers - Question 4: Rayleigh\u2013Plateau Instability: Engineering applications: -...",
    "content": "Engineering applications: - Harness: Inkjet printers use controlled Rayleigh\u2013Plateau breakup to make monodisperse droplets with precise size control - Avoid/suppress: Increase viscosity or introduce polymer elasticity to slow the growth rate (viscous/elastic resistance increases the characteristic timescale for breakup), which helps keep threads intact in coating and microfluidic jets Additional context: The fastest-growing wavelength is $\\lambda \\approx 9R$ (where $R$ is jet radius), which determines the characteristic drop size. --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 14, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.75-Complementary-Questions-Answers/#question-4-rayleighplateau-instability",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./2-What-is-Viscosity.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Lecture 2: Viscosity and Momentum Diffusion",
    "content": "Understanding viscosity as an emergent property arising from molecular collisions and free flights\u2014the diffusion of tangential momentum through a fluid. This lecture bridges [[1.5-Taylor-Culick-Paradox|Lecture 1.5]]'s resolution of the Taylor\u2013Culick paradox with the continuum mechanics framework needed to model soft matter flows. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#lecture-2-viscosity-and-momentum-diffusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Learning Objectives",
    "content": "By the end of this lecture, you should understand these five core concepts: 1. What viscosity is: a coefficient quantifying the *diffusion of tangential momentum* 2. Where it comes from (kinetics): molecular collisions + free flights over the mean free path $\\lambda$ 3. Why no-slip is natural: collisions at a wall randomize tangential momentum \u2192 momentum sink \u2192 velocity gradient forms 4. Two key scalings: - $\\eta \\sim \\frac{1}{3}\\rho \\bar{c} \\lambda$ (viscosity; depends on density, speed, path length) - $\\nu = \\eta/\\rho \\sim \\frac{\\bar{c}\\lambda}{3}$ (kinematic viscosity = momentum diffusivity) 1. Later connections: Newtonian stress law in continuum mechanics; relaxation-function picture in rheology ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#learning-objectives",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Part A: Empirical Starting Point \u2014 Newton's Law",
    "content": "We begin with Newton's law of viscosity, the foundational definition of a Newtonian fluid: $$\\boxed{\\tau_{xy} = \\eta \\dot{\\gamma} = \\eta \\frac{\\partial u_x}{\\partial y}}$$ This equation states that shear stress is proportional to shear rate, with a constant of proportionality\u2014the viscosity $\\eta$\u2014that depends on the material and temperature, but *not* on how fast we shear it. This is the foundational definition of a Newtonian fluid. ![](../../_Media/2-What-is-Viscosity-1761738216814.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#part-a-empirical-starting-point-newtons-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Key Definitions: - Shear stress...",
    "content": "- Shear stress $\\tau_{xy}$ (Pa = N/m$^2$): force per unit area acting tangentially on a fluid layer - Strain rate $\\dot{\\gamma} = \\partial u_x / \\partial y$ (s$^{-1}$): the spatial gradient of velocity; how quickly the velocity changes across the fluid - Viscosity $\\eta$ (Pa$\\cdot$s): the coupling coefficient; higher $\\eta$ means stickier fluid - Kinematic viscosity $\\nu = \\eta/\\rho$ (m$^2$/s): the \"speed\" at which momentum diffuses through the fluid ![](../../_Media/2-What-is-Viscosity-1761738244038.png) > [!important] Distinguishing Newtonian vs. Non-Newtonian Fluids > > A Newtonian fluid has constant $\\eta$ at fixed temperature\u2014it doesn't matter if you shear slowly or fast. Many familiar fluids like water, air, and simple oils are Newtonian. However, ketchup, blood, and polymer solutions are *non-Newtonian* ($\\eta$ changes with $\\dot{\\gamma}$); we'll encounter these behaviors in Lectures 5 and 6.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#key-definitions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Key Definitions: Physical Interpretation: Viscosity...",
    "content": "Physical Interpretation: Viscosity represents internal friction\u2014the resistance of the fluid to shearing motion. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#key-definitions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - The Fundamental Concept",
    "content": "Viscosity emerges because molecules carry momentum across planes during free flights between collisions. When the flow has a shear (velocity gradient), molecules from fast and slow regions mix, and this diffuses momentum down the gradient. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#the-fundamental-concept",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Setup: Simple Couette Flow",
    "content": "![](../../_Media/2-What-is-Viscosity-1761738283101.png) Consider a steady shear flow where: 1. Velocity varies linearly: $u_x(y) = \\dot{\\gamma} \\cdot y$ 2. Mean free path: $\\lambda$ 3. Mean molecular speed: $\\bar{c} = \\sqrt{8 k_B T / (\\pi m)}$ (monatomic gas) 4. Number density: $n$ In this geometry, molecules at height $y$ have average $x$-velocity $u_x(y)$. But they only came to height $y$ after traveling a distance $\\sim \\lambda$ through the fluid. The $x$-momentum they carry reflects the conditions they saw $\\sim \\lambda$ away\u2014this is where the velocity gradient matters. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#setup-simple-couette-flow",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Step 1: Molecular Flux Across a Plane",
    "content": "For an isotropic gas, the number of molecules crossing a plane (per unit area per unit time) is: $$\\boxed{J = \\frac{1}{4} n \\bar{c}}$$ This factor of 1/4 arises from two geometric considerations: 1. Half the molecules move upward and half downward (factor of 1/2) 2. Of those moving upward, the average normal component of velocity is $\\bar{c}/2$ because the mean direction makes approximately a 60\u00b0 angle to the normal Therefore: $\\langle v_y^+ \\rangle = (1/2) \\times (1/2) \\bar{c} = \\bar{c}/4$, giving $J = n \\bar{c}/4$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#step-1-molecular-flux-across-a-plane",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Alternative Derivation",
    "content": "For a more rigorous approach, we integrate over the hemisphere of upward directions: $$\\langle v_y^+ \\rangle_{\\text{dir}} = \\frac{1}{4\\pi} \\int_{\\text{hemisphere}} c \\cos\\theta \\, d\\Omega = \\frac{1}{4\\pi} \\int_0^{2\\pi} d\\phi \\int_0^{\\pi/2} c\\cos\\theta \\sin\\theta \\, d\\theta = \\frac{c}{4}$$ Averaging over the Maxwellian speed distribution yields $J = n \\bar{c}/4$. ![](../../_Media/2-What-is-Viscosity-1761738310141.png) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#alternative-derivation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Step 2: Momentum Transport",
    "content": "A molecule crossing the plane upward was last collided at approximately $y-\\lambda$, so it carries the mean $x$-momentum from that height. Similarly, a molecule crossing downward carries momentum from around $y+\\lambda$. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#step-2-momentum-transport",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Step 3: Net Momentum Flux",
    "content": "The momentum fluxes are: Downward momentum flux (from above): $$\\Phi_{x}^{\\text{down}} \\approx \\frac{n\\bar{c}}{4} \\cdot m \\cdot u_x(y+\\lambda)$$ Upward momentum flux (from below): $$\\Phi_{x}^{\\text{up}} \\approx \\frac{n\\bar{c}}{4} \\cdot m \\cdot u_x(y-\\lambda)$$ Net downward flux (down minus up): $$\\Phi_{x}^{\\text{net}} = \\frac{nm\\bar{c}}{4}\\left[ u_x(y+\\lambda) - u_x(y-\\lambda) \\right]$$ For small $\\lambda$, we can linearize the velocity: $$u_x(y\\pm\\lambda) \\approx u_x(y) \\pm \\lambda \\frac{\\partial u_x}{\\partial y}$$ Therefore: $$u_x(y+\\lambda) - u_x(y-\\lambda) \\approx 2\\lambda \\frac{\\partial u_x}{\\partial y}$$ Substituting: $$\\boxed{\\Phi_{x}^{\\text{net}} \\approx \\frac{nm\\bar{c}}{4} \\cdot 2\\lambda \\frac{\\partial u_x}{\\partial y} = \\frac{1}{2} \\rho \\bar{c} \\lambda \\frac{\\partial u_x}{\\partial y}}$$ where $\\rho = nm$ is the mass density. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#step-3-net-momentum-flux",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Step 4: Identifying Shear Stress and Viscosity",
    "content": "Critical Relationship: The *shear stress* in the continuum description is minus the downward flux of $x$-momentum. The minus sign accounts for direction convention: if molecules flow momentum downward (from fast to slow regions), this represents a stress acting downward. $$\\tau_{xy} = -\\Phi_{x}^{\\text{net}} = -\\frac{1}{2} \\rho \\bar{c} \\lambda \\frac{\\partial u_x}{\\partial y}$$ Comparing with Newton's law: $$\\tau_{xy} = -\\eta \\frac{\\partial u_x}{\\partial y}$$ We obtain: $$\\boxed{\\eta \\sim C \\, \\rho \\, \\bar{c} \\, \\lambda, \\quad\\text{where } C = \\mathcal{O}(1)}$$ The more sophisticated Chapman-Enskog theory gives $C \\approx 1/3$ for a monatomic gas, but the scaling relationship is the key physical insight. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#step-4-identifying-shear-stress-and-viscosity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Step 5: Kinematic Viscosity as Momentum Diffusivity",
    "content": "The kinematic viscosity is: $$\\boxed{\\nu = \\frac{\\eta}{\\rho} \\sim C \\, \\bar{c} \\, \\lambda}$$ Physical Interpretation: The kinematic viscosity $\\nu$ is the diffusivity for momentum. Just as thermal diffusivity ($\\alpha$) measures how fast heat spreads, $\\nu$ measures how fast shear (tangential momentum) propagates through a fluid. Dimensional Analysis: $[\\bar{c}][\\lambda] = \\text{(m/s)} \\times \\text{(m)} = \\text{m}^2/\\text{s}$ \u2713 ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#step-5-kinematic-viscosity-as-momentum-diffusivity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - The Wall Picture",
    "content": "![](../../_Media/2-What-is-Viscosity-1761767758968.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#the-wall-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Physical Mechanism",
    "content": "> [!summary] Momentum Accommodation at Walls > When a gas molecule collides with a stationary wall, the wall randomizes (thermalizes) its tangential velocity component. The molecule re-emits with zero mean tangential velocity in the wall frame. This process is called diffuse reflection with full tangential momentum accommodation. The wall acts as a sink of $x$-momentum. Every molecule that hits the wall loses its tangential velocity. Just outside the wall, there's a deficit in mean $u_x$ compared to the interior. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#physical-mechanism",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Interior Response: Momentum Balance",
    "content": "In steady state, the viscous flux from the interior must feed the momentum sink at the wall. Rate of momentum removal at wall (per unit area): $$\\text{Removal rate} \\sim \\underbrace{\\left(\\frac{1}{4}n\\bar{c}\\right)}_{\\text{collision rate}} \\times \\underbrace{m u_x(0^+)}_{\\text{momentum per molecule}}$$ where $u_x(0^+)$ is the fluid velocity just outside the wall. Rate of momentum supply via viscous diffusion: $$\\text{Supply rate} = -\\tau_{xy}\\big|_{\\text{wall}} = \\eta \\frac{\\partial u_x}{\\partial y}\\bigg|_{\\text{wall}}$$ Steady-state balance: $$\\eta \\frac{\\partial u_x}{\\partial y}\\bigg|_{\\text{wall}} \\sim \\frac{1}{4}n\\bar{c} \\, m \\, u_x(0^+)$$ For small $u_x(0^+)$ or perfect accommodation, this forces $u_x(0^+) \\to u_{\\text{wall}} = 0$. Result: $$\\boxed{u_{\\text{fluid}}(\\text{wall}) = u_{\\text{wall}} \\quad\\text{(no-slip condition)}}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#interior-response-momentum-balance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - When Does Slip Appear?",
    "content": "No-slip is the continuum limit, valid when the mean free path $\\lambda$ is much smaller than any relevant geometric length (Knudsen number $\\text{Kn} = \\lambda/L \\ll 1$). For rarefied gases or special surfaces (non-accommodating walls): The wall doesn't fully thermalize the tangential momentum, resulting in partial slip: $$u_{\\text{slip}} = u_{\\text{fluid}}(0) - u_{\\text{wall}} = b \\frac{\\partial u_x}{\\partial y}\\bigg|_{\\text{wall}}$$ where the slip length is $b \\sim \\mathcal{O}(\\lambda)$, modulated by an accommodation coefficient. Maxwell slip law: $$\\boxed{b \\approx C_{\\text{acc}} \\lambda, \\quad C_{\\text{acc}} \\approx 1-2}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#when-does-slip-appear",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Connecting Bulk Viscosity to Wall Shear",
    "content": "Key Insight: $$\\boxed{\\text{The same } \\eta \\text{ that represents bulk momentum diffusion also sets the wall shear rate:}}$$ $$\\boxed{\\tau_{\\text{wall}} = \\eta \\frac{\\partial u_x}{\\partial y}\\bigg|_{\\text{wall}} = \\text{rate at which wall removes x-momentum}}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#connecting-bulk-viscosity-to-wall-shear",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Stokes' First Problem (Impulsive Start)",
    "content": "Physical Setup: A semi-infinite fluid initially at rest; at $t=0$, a plate at $y=0$ suddenly moves with velocity $U$. Initial and Boundary Conditions: - $u_x(y, 0) = 0$ for all $y > 0$ - $u_x(0, t) = U$ for $t > 0$ Governing Equation (momentum diffusion): $$\\boxed{\\frac{\\partial u_x}{\\partial t} = \\nu \\frac{\\partial^2 u_x}{\\partial y^2}}$$ where $\\nu = \\eta/\\rho$ is the kinematic viscosity (momentum diffusivity).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#stokes-first-problem-impulsive-start",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Scaling Analysis",
    "content": "The momentum penetrates into the fluid over a diffusion layer of thickness: $$\\boxed{\\delta(t) \\sim \\sqrt{\\nu t}}$$ Physical Insight: This equation is *exactly* analogous to heat diffusion or dye diffusion. Viscosity $\\nu$ plays the role of thermal or mass diffusivity. This confirms our kinetic picture: viscosity is the diffusivity for momentum. > [!link] Full derivation > Head to [[Impulsively-started-plate]] for the derivation. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#scaling-analysis",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Visual Representation",
    "content": "---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#visual-representation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Non-Newtonian Fluids",
    "content": "The Newtonian law $\\tau = \\eta \\dot{\\gamma}$ works when: 1. The fluid has no internal structure that deforms under shear 2. Or the structure adapts quickly compared to the flow timescale For polymer solutions, suspensions, or emulsions: 1. Microstructure (chains, particles) realigns under shear 2. Viscosity becomes a function of shear rate: $\\eta(\\dot{\\gamma})$ 3. This leads to phenomena like shear-thinning or shear-thickening Today we derived why Newtonian behavior is natural for a dilute gas. Real soft-matter systems are more interesting because their microstructure evolves\u2014that's where non-Newtonian rheology comes in. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#non-newtonian-fluids",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Reynolds Number: Viscous vs. Inertial Effects",
    "content": "$$\\boxed{\\text{Re} = \\frac{U L}{\\nu}}$$ 1. $U L$: characteristic scale of *advection* (inertial effects) 2. $\\nu$: characteristic scale of *momentum diffusion* (viscous effects) Physical Interpretation: 1. High Re: Inertia dominates \u2192 turbulence, jets 2. Low Re: Viscosity dominates \u2192 creeping flow, microfluidics 3. The transition region is where rich physics emerges ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#reynolds-number-viscous-vs-inertial-effects",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Summary",
    "content": "$$\\boxed{\\text{Newton's Law:} \\quad \\tau_{xy} = \\eta \\dot{\\gamma}}$$ $$\\boxed{\\text{Kinetic Picture:} \\quad \\eta \\sim \\frac{1}{3} \\rho \\bar{c} \\lambda, \\quad \\nu = \\frac{\\eta}{\\rho} \\sim \\frac{\\bar{c} \\lambda}{3}}$$ $$\\boxed{\\text{Wall Physics (No-Slip):} \\quad u_{\\text{fluid}}(\\text{wall}) = u_{\\text{wall}}}$$ (emerges when wall thermalizes momentum; fails at high Kn) $$\\boxed{\\text{Continuum Picture:} \\quad \\frac{\\partial u}{\\partial t} = \\nu \\frac{\\partial^2 u}{\\partial y^2} \\quad \\Rightarrow \\quad \\delta(t) \\sim \\sqrt{\\nu t}}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Conceptual Takeaway",
    "content": "> Viscosity is to momentum what diffusivity is to dye: it smooths out gradients in tangential velocity by spreading momentum from fast to slow regions. At the wall, the same microscopic physics\u2014collisional randomization of tangential momentum\u2014produces the no-slip condition in the continuum limit, and predicts slip when the mean free path is not negligible. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#conceptual-takeaway",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Temperature Scaling",
    "content": "An important distinction emerges between gases and liquids: Gases: Viscosity increases with temperature because faster molecules (larger $\\bar{c}$) transport momentum more efficiently over larger mean free paths. Liquids: Viscosity typically decreases with temperature due to cage-breaking dynamics and activation processes\u2014fundamentally different from the gas-phase mechanism. This inversion is crucial for developing physical intuition across different material systems. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#temperature-scaling",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Primary Literature",
    "content": "- Chapman & Cowling (1970): *The Mathematical Theory of Non-Uniform Gases.* (Classic kinetic theory; Sections 2\u20134 for viscosity.) - Reif (1965): *Fundamentals of Statistical and Thermal Physics.* (Kinetic-theory.) - Bird, Stewart & Lightfoot (2007): *Transport Phenomena.* (Chapter 1: connection between kinetic theory and continuum viscosity.)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#primary-literature",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Supplementary Materials",
    "content": "- [What is Viscosity (PDF)](whatIsViscosity.pdf) \u2014 Comprehensive reference document on kinetic theory foundations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#supplementary-materials",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Foundational Texts",
    "content": "- de Gennes, P.-G. (1979). *Scaling Concepts in Polymer Physics*. Cornell University Press. \u2014 Soft matter perspective on viscosity - Landau & Lifshitz (1987). *Fluid Mechanics* (2nd ed.). Pergamon. \u2014 Classical continuum mechanics with kinetic theory foundations",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#foundational-texts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Advanced Topics",
    "content": "- Evans & Searles (2002). \"The fluctuation theorem.\" *Advances in Physics*, 51(7), 1529\u20131585. \u2014 Non-equilibrium statistical mechanics - Kremer & Grest (1990). \"Dynamics of entangled linear polymer melts.\" *The Journal of Chemical Physics*, 92(8), 5057\u20135086. \u2014 Polymer rheology from kinetic theory",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#advanced-topics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Application Areas",
    "content": "- Doi, M. & Edwards, S. F. (1986). *The Theory of Polymer Dynamics*. Oxford University Press. \u2014 Viscoelasticity and non-Newtonian viscosity ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#application-areas",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Connection to Lecture 3",
    "content": "The viscosity framework we've developed\u2014understanding it as momentum diffusion\u2014directly connects to the instabilities and singularities that emerge in soft matter flows. In Lecture 3, we will see how surface tension and viscosity compete to either suppress or amplify perturbations at interfaces, leading to phenomena like the Rayleigh\u2013Plateau instability and capillary breakup. Understanding why momentum diffusion acts as a dissipative force (damping) is central to analyzing these instabilities. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#connection-to-lecture-3",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Key Takeaways: Context",
    "content": "1. Viscosity is momentum diffusion. The same framework that describes heat spreading describes how shear spreads through a fluid. 2. Kinetics connects to continuum. A simple kinetic-theory argument ($\\eta \\sim \\rho \\bar{c} \\lambda$) bridges molecular collisions and macroscopic stress. 3. No-slip emerges from momentum accommodation. The wall isn't a boundary condition imposed from above\u2014it's a consequence of efficient tangential momentum randomization at collisions. 4. Temperature effects differ. Gases become more viscous when heated (faster molecules); liquids usually become less viscous (cage-breaking). Recognizing this inversion is important for intuition. 5. Reynolds number quantifies the balance. Re = (inertial effects) / (viscous effects). High Re: inertia dominates. Low Re: viscosity dominates. The transition is where interesting physics happens. 6. Continuum equation mirrors diffusion.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2 what is viscosity - Key Takeaways: The PDE $\\partial...",
    "content": "The PDE $\\partial u/\\partial t = \\nu \\partial^2 u/\\partial y^2$ is the Navier\u2013Stokes momentum equation in its simplest form. Recognizing $\\nu$ as a diffusivity (not just a material property) unifies understanding. --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 29, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2-What-is-Viscosity/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./2.75-Complementary-Questions-Answers.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 1: Coarse-Graining in Practice: Question: Explain what...",
    "content": "Question: Explain what \"coarse-graining\" means and why it lets us treat soft matter as a continuum. Pick one system (foam, polymer solution, emulsion) and say when this breaks down (give a specific length scale or condition). Answer: Coarse-graining means averaging over many microscopic constituents (molecules, droplets, bubbles, chains) to define smooth, space- and time-dependent fields like density, velocity, and stress. When the averaging volume is large compared to the microstructure, local fluctuations cancel and the material can be modeled as a continuous medium obeying conservation laws. **Example (emulsion):** If droplets have diameter $d \\sim 10\\,\\mu\\text{m}$, a pipe flow with gradients varying over millimeters contains thousands of droplets per \"fluid element,\" so a single-phase continuum with effective properties is accurate. The approximation **breaks down** when: 1.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-1-coarse-graining-in-practice",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 1: Coarse-Graining in Practice: JavaScript",
    "content": "The observation/gradient length $\\ell$ becomes $O(d)$ or smaller (e.g., microfluidic channels, thin gaps, near interfaces) 2. Time scales approach droplet rearrangement or coalescence times 3. In these regimes, discrete structure, interfacial forces, and nonlocal effects dominate and cannot be neglected Key insight: Continuum descriptions require separation of scales\u2014the microstructural length must be much smaller than the macroscopic gradients of interest. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-1-coarse-graining-in-practice",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 2: Continuity in a Nozzle: JavaScript",
    "content": "Question: You squeeze shampoo through a pump and narrow outlet at steady rate. Using only words, explain why the fluid speeds up in the narrow section and name the conservation law you're invoking. Give one case where this reasoning would fail. Answer: In steady flow, what enters must leave: the same **mass per unit time** passes every cross-section. If the passage narrows, the fluid must move faster there so that the same mass gets through the smaller area in the same time\u2014this is **conservation of mass** (the continuity principle) in words. Mathematical statement: For incompressible flow, $\\rho A v = \\text{constant}$, so if area $A$ decreases, velocity $v$ must increase proportionally.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-2-continuity-in-a-nozzle",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 2: Continuity in a Nozzle: This reasoning **fails**...",
    "content": "This reasoning **fails** when: 1. **Density changes significantly**: A compressible or bubbly shampoo (entrained air) undergoing strong pressure drop, where the mass rate stays fixed but the *volume* rate and speeds no longer scale simply with area 2. **Unsteady flow**: \"Squeeze-and-release\" strokes where fluid is temporarily stored in a compliant pump chamber violate the steady-state assumption Additional failure mode: Very high shear rates can cause shear-induced migration in suspensions, changing local density and invalidating simple area-velocity scaling. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-2-continuity-in-a-nozzle",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 3: Momentum Balance Around a Bend",
    "content": "Question: Water flows steadily through a pipe that turns 90\u00b0. Describe which forces turn the flow (pressure differences versus wall shear) and how the picture changes for very slow flows (creeping) versus very fast flows (inertial). Answer: Along a curved streamline, a cross-stream **pressure difference** provides the centripetal \"push\" that redirects the fluid; **wall shear** transmits and resists motion, setting the velocity profile and causing energy loss.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-3-momentum-balance-around-a-bend",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Very slow (creeping, low Reynolds number):",
    "content": "$$\\text{Re} = \\frac{\\rho v D}{\\eta} \\ll 1$$ 1. Inertia is negligible, so the momentum equation reduces to a balance between pressure gradients and viscous stresses: $\\nabla p \\approx \\eta \\nabla^2 \\boldsymbol{v}$ 2. The flow hugs the bend smoothly with no separation 3. Shear stresses dominate the force budget 4. Velocity profile is nearly parabolic (Poiseuille-like) throughout",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#very-slow-creeping-low-reynolds-number",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Very fast (inertial, high Reynolds number):",
    "content": "$$\\text{Re} = \\frac{\\rho v D}{\\eta} \\gg 1$$ 1. Fluid parcels \"want\" to go straight due to inertia 2. A larger pressure difference is required on the *outer* wall to provide centripetal acceleration 3. Viscous effects are confined to thin boundary layers 4. Secondary motions (Dean-type vortices) and even flow separation can appear 5. Pressure forces do most of the turning; viscous shear mainly dissipates energy in boundary layers Physical insight: In both regimes, this description comes from momentum conservation in continuum form ($\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}$), but the dominant balance shifts from viscous-dominated to inertia-dominated. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#very-fast-inertial-high-reynolds-number",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Question 4: Where Does the Work Go?",
    "content": "Question: You slide two plates with glycerol between them at constant speed. Explain where the mechanical power you input ends up inside the fluid, name the phenomenon responsible (in words), and give a one-sentence microscopic picture for it. Answer: The mechanical power you supply is converted into **heat inside the liquid** via **viscous dissipation** (internal friction): shear stresses acting across velocity gradients irreversibly transform organized motion into thermal energy.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#question-4-where-does-the-work-go",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Energy transformation:",
    "content": "Power input: $$P_{\\text{in}} = F \\cdot v = \\tau A \\cdot v$$ where $\\tau$ is the shear stress, $A$ is the plate area, and $v$ is the sliding velocity. For Newtonian fluid with viscosity $\\eta$ and gap $h$: $$\\tau = \\eta \\frac{v}{h}$$ So: $$P_{\\text{in}} = \\eta \\frac{v^2}{h} A$$ This power is entirely dissipated as heat (assuming isothermal boundaries that remove heat).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#energy-transformation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Microscopic picture:: Molecules in faster...",
    "content": "Molecules in faster layers transfer momentum to slower layers through incessant collisions and interactions, randomizing directed motion into molecular agitation\u2014manifested macroscopically as a temperature rise if heat is not removed. Alternative description: The velocity gradient creates a non-equilibrium state where molecular collisions preferentially transfer momentum down-gradient, doing work against the imposed flow and converting mechanical energy into thermal fluctuations.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#microscopic-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.75 complementary questions answers - Microscopic picture:: Connection to lecture:...",
    "content": "Connection to lecture: This is the continuum manifestation of momentum diffusion we derived from kinetic theory\u2014the stress tensor component $\\tau = \\eta \\frac{\\partial v}{\\partial y}$ represents the momentum flux that ultimately dissipates energy. --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 30, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.75-Complementary-Questions-Answers/#microscopic-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./4-Soft-Matter-Singularities.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Soft Matter Singularities",
    "content": "> [!tldr] TL;DR > A singularity is when a smooth physical process \u201cblows up\u201d $\u2014$ something finite becomes infinite in a finite time or at a finite place. ![](../../_Media/4-Soft-Matter-Singularities-1762960099435.png) *A water droplet detaching from a faucet forms a thinning neck that will pinch off. Just before separation, the neck radius shrinks rapidly and the curvature (and capillary pressure) blows up. The pinch-off singularity produces one main drop and often a tiny satellite drop left behind.[^dripping-image]*",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#soft-matter-singularities",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 0) What is a singularity in soft matter?: A singularity is...",
    "content": "A singularity is when a smooth physical process `blows up` $-$ some quantity that is normally finite becomes effectively infinite in a finite time or at a finite location. In soft matter flows, singularities often signal dramatic events: a droplet pinches off, a bubble collapses, or a moving contact line generates enormous stresses. These singular moments are fascinating because they mark the breakdown of our usual approximations (continuum equations, smooth interfaces), yet they often exhibit universal behavior (independent of initial details). Understanding singularities helps us see where and why our fluid or material model needs new physics (like microscopic cutoffs), and how nature resolves the apparent paradox of infinities in a real system.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#0-what-is-a-singularity-in-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 0) What is a singularity in soft matter?: This lecture builds...",
    "content": "This lecture builds on earlier ones: the film rupture energy paradox in [[1.5-Taylor-Culick-Paradox|Bridge 1.5]] hinted that proper momentum accounting resolves infinities; the no-slip condition from [[2-What-is-Viscosity|Lecture 2]] will be central to our discussion of moving contact lines; and the instabilities in [[3-Soft-Matter-Instabilities|Lecture 3]] often end in singular pinch-off events. Now we zoom in on those finite-time, `life or death` moments of soft matter systems.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#0-what-is-a-singularity-in-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: JavaScript",
    "content": "**Mechanism.** Imagine water dripping from a faucet. Surface tension pulls the droplet neck thinner and thinner until it ruptures, separating the drop (gravity-driven) from the remaining fluid. Just before breakup, the radius of the neck approaches zero, causing the curvature (and thus capillary pressure) to skyrocket. In an `ideal mathematical description`, certain quantities (pressure, fluid velocity near the neck) tend toward infinity at the pinch point. This is a finite-time singularity $\u2013$ the equations (like Navier\u2013Stokes) themselves remain intact, but their solution develops a blow-up (the interface develops a sharp cusp and then detaches).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: Importantly, very close...",
    "content": "Importantly, very close to breakup, the shape of the neck often becomes self-similar $\u2013$ the fluid profile \"zooms in\" on a universal form regardless of the starting drop size.[^eggers1997] This means the pinch-off process has a kind of memory loss: everything but the local physics (inertia, viscosity, surface tension) washes out. ![](../../_Media/4-Soft-Matter-Singularities-1762960009091.png) ![](../../_Media/4-Soft-Matter-Singularities-1762960022513.png) **Inertial vs viscous pinch-off.** The balance of forces during pinch-off dictates the nature of the singularity.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: JavaScript",
    "content": "If inertia dominates (e.g. a water droplet in air), the neck shape follows an inertial self-similar regime: throat radius $$r \\sim (t_c - t)^{2/3}$$ Viscous-dominated threads (like honey) thin more slowly with a cylindrical filament connecting droplets until it finally ruptures. $$r \\sim t$$ In either case, as the thread radius becomes extremely small, eventually some microscopic cutoff intervenes: for a Newtonian fluid this might simply be that the continuum assumption breaks at nano-scales, or impurities trigger the final break. The \"singularity\" is thus avoided in reality, but just barely, and the laws of motion pass through that event by producing new droplets[^eggers1997] (the Navier\u2013Stokes solution can sometimes be continued through the singular moment in an ideal scenario). **Satellites and universality.** Often, pinch-off leaves behind a tiny satellite drop in addition to the main drop.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: This satellite formation...",
    "content": "This satellite formation is part of a secondary break-up that can itself display self-similar behavior $\u2013$ a cascade of singular events. Indeed, high-speed imaging and theory show that pinch-off can produce nested sequences of singularities where each subsequent thread break is a smaller copy of the last (a form of discrete scale invariance).[^eggers1997] Near the singularity, the governing equations simplify (certain terms dominate), and we can often find scaling laws and similarity solutions that describe the dynamics universally. ![](../../_Media/4-Soft-Matter-Singularities-1763535973289.png) *Time evolution of a highly extended fluid suspended in another fluid. The viscosity ratio is 0.067, and the dimensionless wave number is 0.5. The times the snapshots were taken are shown in the middle.[^1]* > [!note] Finite-time singularities are \"predictable\" in form > A beautiful aspect of pinch-off events is that they forget the messy world around them.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: No matter if...",
    "content": "No matter if your drop comes from a pipette, faucet, or leaking roof, the final shape of the neck and the speed of breakup will tend to follow the same scaling laws (set by fluid properties like viscosity, density, surface tension). This universality means we can compare experiments, simulations, and theory on equal footing[^eggers1997] $\u2013$ a triumph of the singularity analysis. ![](../../_Media/4-Soft-Matter-Singularities-1762960047460.png) ![](../../_Media/4-Soft-Matter-Singularities-1762960060765.png) **Bubble pinch-off and Worthington jet.** A closely related singular event occurs when a bubble of air pinches off underwater (for example, an underwater air bubble rising and detaching, or the cavity behind an object closing up). The physics is analogous to drop pinch-off $\u2013$ the neck of the air cavity pinches to zero radius.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 1) Pinch-off singularities: when a fluid thread breaks: In the case...",
    "content": "In the case of a bubble pinch-off, however, the collapse can be so violent that the surrounding liquid rushes in along the symmetry axis and shoots upward as a fast Worthington jet. If you've seen a drop of water fall into a pool and a thin jet spike up $\u2013$ that's the result of a singular cavity collapse focusing energy into a jet. Here the singularity manifests as a burst of kinetic energy: extremely high speeds and even shock-like features in the liquid. In fact, the pressures in such collapse events can be enormous (cavitation collapse near a solid can even pit metal). The formation of the Worthington jet is a reminder that singularities often transmit energy across scales $\u2013$ focusing a large-scale motion into a very fine jet. (Interestingly, the jet itself can break into drops $\u2013$ another pinch-off $\u2013$ showing how one singularity can lead to another!)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#1-pinch-off-singularities-when-a-fluid-thread-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Examples",
    "content": "![](../../_Media/4-Soft-Matter-Singularities-1763537416977.png) **The contact line singularity.** Consider a liquid spreading on a solid surface \u2013 for example, a drop of water advancing across glass plate. The contact line is the edge where solid, liquid, and gas meet. In equilibrium, this line sits still with a well-defined contact angle ([Young\u2013Dupr\u00e9 angle](https://en.wikipedia.org/wiki/Wetting), set by surface tensions and surface chemistry). But what about a moving contact line, when the drop spreads? Classical fluid dynamics has a nasty prediction: if you assume a no-slip boundary condition (fluid at the solid sticks to it, as we learned in [[2-What-is-Viscosity|Lecture 2]]), a moving contact line would demand the fluid velocity go to zero right at the solid, but far away it's moving $\u2013$ this creates a shearing in fluid all the way down to the molecular scale.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Results",
    "content": "The result is an integrable divergence in stress and an infinite energy dissipation rate in the vicinity of the contact line. > [!note] Note > A fluid with no-slip would need infinite force to move a contact line $\u2013$ a nonsensical prediction known as the moving contact line paradox (first pointed out by Huh & Scriven in 1971[^2]). **What does this singularity look like?** Mathematically, if we integrate the energy dissipation per volume, $$\\varepsilon \\sim \\eta \\, \\frac{U^2}{r}$$ for a flow speed $U$ at distance $r$ from the contact line, $$\\int \\eta U^2 \\frac{dr}{r}$$ diverges as $r \\to 0$ (and also as $r \\to \\infty$ if the disturbance extends far).[^degennes1985] Physically, the no-slip condition anchors the fluid at the wall, so any motion of the interface requires ever thinner layers of fluid shearing near the contact line $\u2013$ leading to a blow-up in viscous stresses. The paradox is stark: with no-slip, a contact line cannot move (or requires infinite force to do so).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Yet in reality,...",
    "content": "Yet in reality, drops do slide and spread $\u2013$ so what gives? ![](../../_Media/4-Soft-Matter-Singularities-1763537342994.png) **Regularization by microscopic physics.** The resolution is that no real system has an ideal no-slip all the way down to molecular scales. Something must give at small scales to cut off the singularity. There are two classic ways to regularize (allow finite energy dissipation): 1. **Navier slip**: The fluid is allowed to slip past the solid within a tiny length $\\lambda_s$ of the contact line. Essentially, replace no-slip with a boundary condition $u_{\\text{fluid}} - u_{\\text{solid}} = \\beta \\tau$ relating slip velocity to shear stress (Navier condition), or think of a molecular \"slide\" at the wall.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: This slip length...",
    "content": "This slip length $\\lambda_s$ might be on the order of nanometers to microns, but it relieves the infinite shear at $r=0$ by not pinning the fluid completely.[^lecture4pdf] Viscous dissipation no longer diverges because very close to the contact line the fluid can move. ![](../../_Media/4-Soft-Matter-Singularities-1763537371241.png) 2. **Precursor film (or disjoining pressure)**: Ahead of the apparent contact line, imagine a thin film of liquid (maybe a few molecules thick) that \"pre-wets\" the solid. Then there is really no contact line at molecular scales $\u2013$ the apparent contact line is just where the film thickness goes from nanometers to macroscopically zero.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: A disjoining pressure...",
    "content": "A disjoining pressure (from van der Waals forces, etc.) in that thin film can allow the contact angle to adjust without a singular wedge of fluid forming.[^precursor-diagram] Essentially, the moving interface rides on a lubricating wetting film, avoiding a sharp three-phase junction. > [!tip] Other cutoffs > In some cases, other physics can play a role. For instance, if the liquid is a polymer melt or has some shear-thinning behavior, the effective viscosity near the contact line might drop (reducing dissipation). Or if the liquid evaporates at the contact line, a microvapor layer could ease motion. Bottom line: something must break the continuum + no-slip + sharp interface assumptions at small scale.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Examples",
    "content": "Soft matter often involves multiple scales, and the contact line singularity is a prime example where molecular-scale details (surface chemistry, slip, etc.) impact a macroscale behavior (spreading). **Cox\u2013Voinov relation (apparent angle variation).** When the singularity is regularized, we can actually predict how a moving contact line behaves. One famous result is the Cox\u2013Voinov relation: the dynamic contact angle $\\theta$ (at a scale visible to the eye) is related to the contact line speed $U$ by $$\\theta^3 = \\theta_{\\rm eq}^3 + 9 \\, (\\eta U/\\gamma)\\ln(L/\\ell_{\\text{micro}})$$ for a viscous wetting situation (here $\\theta_{\\rm eq}$ is the equilibrium angle, $\\gamma$ is the surface tension coefficient and $\\eta$ is the viscosity).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Don't worry about...",
    "content": "Don't worry about the formula details, but note the $\\theta^3$ dependence and the logarithm: the contact angle shifts with speed, and it does so slowly (logarithmically with the ratio of a macroscopic length $L$ to the microscopic cutoff $\\ell_{\\text{micro}}$). This law (derived by combining lubrication theory with either slip or precursor film models) was confirmed by experiments and simulations. It tells us that even though the true angle right at the contact line might always be $0^\\circ$ for a perfectly wetting liquid (if we zoom to molecular scale, the interface is almost flat), the apparent macroscopic angle increases with speed $\u2013$ a dynamic effect. In our lectures, this connects back to [[2-What-is-Viscosity|Lecture 2]]: the no-slip condition, a cornerstone of continuum viscous flow, fails dramatically at a moving contact line.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Soft matter systems...",
    "content": "Soft matter systems often live at the intersection of continuum and molecular physics; here we must invoke molecular length scales to repair continuum theory. As de Gennes famously discussed,[^degennes1985] each decade of length scale contributes equally to the dissipation $\u2013$ so cutting off the last few decades ($\\text{nm}$ to $\\mu\\text{m}$) spares us an infinite sum (but, is it physical?). Snoeijer & Andreotti (2013)[^snoeijer2013] provide a modern review of how different regimes of wetting (viscous, capillary, etc.) navigate this multiscale problem. ![](../../_Media/4-Soft-Matter-Singularities-1763559996509.png) *A \"beads-on-a-string\" structure forming in a thinning saliva bridge, which is a viscoelastic fluid. Here, polymers in saliva (mucins) resist the capillary-driven singular pinch-off, causing a long thread to persist with droplets (beads) along it.[^saliva-image] In a Newtonian fluid like water, the thinning thread would break more quickly and cleanly.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Viscoelasticity thus delays...",
    "content": "Viscoelasticity thus delays the singularity, spreading it out in time.* Bavand Keshavarz , CC BY 4.0 , via Wikimedia Commons **Multiscale challenge and research frontiers.** The moving contact line remains an area of active research. In partial wetting cases (nonzero equilibrium angle), one avoids true divergences in pressure (the contact line can equilibrate by forming a small precursor foot of wetting). However, when driven far from equilibrium (very fast wetting or dewetting), one can observe phenomena like contact line hysteresis (the line sticks until a threshold force is exceeded) and complex interface shapes.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - 2) Moving contact line: the no-slip paradox and its resolution: Modern studies, such...",
    "content": "Modern studies, such as viscoelastic wetting,[^kansal2024] ask how polymer stresses or other rheology modify the Cox\u2013Voinov relation $\u2013$ for instance, normal stresses in a non-Newtonian fluid can effectively change the microscopic contact angle and hence the spreading speed.[^kansal2024] The take-home message is that by introducing a microscopic length or physics, we remove the singularity and get finite, measurable behaviors $\u2013$ but we also open up a richer parameter space to explore (e.g. slip length values, disjoining pressure isotherms, polymer relaxation times, etc.). Soft matter scientists turn this \"bug\" into a feature: by measuring how a contact line's dynamics deviate, we infer what's happening at the nano-scale. In Week 5's lab, for example, you will examine how adding a bit of polymer to a liquid (increasing its extensional viscosity) changes the shape of a spreading drop's rim $\u2013$ a direct visual of singularity regularization in action.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#2-moving-contact-line-the-no-slip-paradox-and-its-resolution",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Summary of Lecture 4: JavaScript",
    "content": "1. **Singularities define extreme events**: Soft matter systems can develop finite-time singularities where a normally smooth evolution leads to blow-up (e.g. droplet pinch-off, cavity collapse, moving contact line paradox). These events often dominate the material's behavior (creating new surfaces, concentrating energy) and require special consideration beyond the standard theory. 2. **Drop pinch-off is a universal breakup process**: A thinning fluid neck will often follow self-similar dynamics, with the shape and scaling of the neck independent of initial conditions.[^eggers1997] Depending on whether inertia or viscosity dominates, the thinning follows different power laws, but either way surface tension drives the process toward a singular breakup (radius $\\to$ 0 in finite time).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#summary-of-lecture-4",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Summary of Lecture 4: Pinch-off produces high...",
    "content": "Pinch-off produces high curvature (hence high pressure), emits satellite droplets, and in some cases generates rapid jets. 3. **Bubble pinch-off and jets**: When air cavities pinch off in liquids, the collapse can focus energy into a fast Worthington jet. This illustrates how singularities can transfer energy across scales (from a large collapsing bubble to a tiny high-speed jet). Such jets and the pressures involved are important in phenomena like cavitation damage. 4. **Moving contact line paradox**: A fluid with a no-slip boundary cannot advance a contact line without infinite force $\u2013$ a classic singularity in hydrodynamics.[^degennes1985] This paradox highlights the breakdown of continuum assumptions at small scales.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#summary-of-lecture-4",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Summary of Lecture 4: In reality, physics...",
    "content": "In reality, physics like slip at the wall or a precursor wetting film regularize the singularity, allowing finite energy dissipation and contact line motion. 5. **Role of microscopic length scales**: The cure to a singularity often lies in acknowledging a small length scale. For moving contact lines, a slip length or molecular film provides a cutoff, yielding laws like the Cox\u2013Voinov relation for dynamic contact angles. The lesson generalizes: whenever you see a mathematical singularity, look for a missing small-scale physics (be it molecular slip, a finite polymer chain length, atomic grain size in a solid, etc.). 6. **Universal insights and design**: Studying singularities gives us universal scaling laws \u2013 e.g. how a neck radius shrinks or how a contact angle depends on speed. Engineers and scientists use these laws to predict outcomes (the size of satellite drops, the maximum recoil velocity of a jet, the critical speed before a drop starts entraining air, etc.).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#summary-of-lecture-4",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Summary of Lecture 4: By harnessing singular...",
    "content": "By harnessing singular behavior (or sometimes avoiding it), we can design better inkjet printers (controlled pinch-off), improve emulsification processes, or mitigate harmful cavitation in pumps.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#summary-of-lecture-4",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Key References for Further Reading: Context",
    "content": "1. **J. Eggers**, Nonlinear dynamics and breakup of free-surface flows, Rev. Mod. Phys., 69, 865 (1997). \u2013 Comprehensive review of fluid pinch-off and singular jet dynamics. A bit advanced, but the go-to reference on drop breakup universality. [10.1103/RevModPhys.69.865](https://doi.org/10.1103/RevModPhys.69.865). 2. **J. Eggers & E. Villermaux**, Physics of liquid jets, Rep. Prog. Phys., 71, 036601 (2008). \u2013 Modern overview of liquid jet formation and breakup (how instabilities grow and lead to pinch-off, satellite drops, etc.). [DOI: 10.1088/0034-4885/71/3/036601](http://dx.doi.org/10.1088/0034-4885/71/3/036601). 3. **P. G. de Gennes**, Wetting: statics and dynamics, Rev. Mod. Phys., 57, 827-863 (1985). \u2013 A classic paper discussing the wetting process and the moving contact line dissipation paradox. Introduces the idea of a dissipation integral that diverges and the need for cutoffs. DOI: [10.1103/RevModPhys.57.827](https://doi.org/10.1103/RevModPhys.57.827). 4. **J. H. Snoeijer & B.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#key-references-for-further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Key References for Further Reading: Andreotti**, Moving Contact...",
    "content": "Andreotti**, Moving Contact Lines: Scales, Regimes, and Dynamical Transitions, Annu. Rev. Fluid Mech., 45, 269-292 (2013). \u2013 An accessible review focused entirely on the moving contact line problem. Discusses slip vs precursor film models, the Cox\u2013Voinov law, and various wetting regimes. DOI: [10.1146/annurev-fluid-011212-140734](https://doi.org/10.1146/annurev-fluid-011212-140734). 5. **M. Kansal, C. Datt, V. Bertin & J. H. Snoeijer**, Viscoelastic wetting: Cox\u2013Voinov theory with normal stress effects, J. Fluid Mech., 985, A17 (2024). \u2013 A recent research paper extending contact line theory to polymeric (viscoelastic) liquids. Shows how adding elasticity modifies the classic wetting laws (for those curious about current research frontiers). DOI: [10.1017/jfm.2024.296](https://doi.org/10.1017/jfm.2024.296).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#key-references-for-further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: > [!question] Coding...",
    "content": "> [!question] Coding Challenge \u2013 Contact Line Singularity ODE > As a practical exercise, you will investigate a simplified model of the contact line singularity by solving a high-order ODE that captures the essential physics. In this assignment (detailed on the course GitHub), we consider the third-order ordinary differential equation: > > $$\\frac{d^3h}{dx^3} \\;=\\; -0.01\\,\\Big(\\frac{1}{h^2 + h}\\Big),$$ > > subject to boundary conditions: > 1. $h(0) = 0$ (the fluid thickness goes to zero at the contact line position $x=0$), > 2. $h'(0) = 1$ (a preset slope at the contact line, relating to the contact angle), > 3. $h''(\\infty) = 0$ (far from the contact line, the curvature vanishes). > > Here $h(x)$ might be thought of as the shape of a spreading thin film (with $x$ the distance from the contact line).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: The task is...",
    "content": "The task is to numerically solve this ODE and visualize the solution: plot $h'(x)$ vs $x$ (which effectively shows how the contact angle $\\theta = h'$ varies with distance) and $h''(x)$ vs $x$ (how the curvature varies). The equation is stiff \u2013 reflecting the multiscale nature of the contact line. > > **Objectives**: This assignment isn't just about solving the equation, but also about experiencing AI-assisted coding and iterative refinement: you'll prompt an LLM to generate an initial code, test and debug it, and improve the solution until it meets the specs.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: Along the way,...",
    "content": "Along the way, think about how the boundary condition at infinity can be handled in a finite numerical domain (hint: you'll likely impose $h''$ approaches 0 at a large but finite $x$). > > **Instructions**: Use the class GitHub repository **Intro-Soft-Matter-2025** \u2013 fork it, add your code (we suggest Python or MATLAB for ODE solving), and submit a pull request as described in the README.[^github-readme] The README's \"Contact Line Singularity\" section provides the exact steps and an example prompt to get you started. This will be a graded exercise focusing not only on the correct physics solution but also on your use of computational tools and interpretation of the results. Good luck, and have fun seeing how a singular problem can be tamed numerically! [^eggers1997]: J. Eggers, Nonlinear dynamics and breakup of free-surface flows, Rev. Mod. Phys., 69, 865 (1997).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: Context",
    "content": "DOI: [10.1103/RevModPhys.69.865](https://doi.org/10.1103/RevModPhys.69.865). [^dripping-image]: Image source: [Wikimedia Commons - Dripping faucet](https://commons.wikimedia.org/wiki/File:Dripping_faucet_1.jpg). [^degennes1985]: P. G. de Gennes, Wetting: statics and dynamics, Rev. Mod. Phys., 57, 827-863 (1985). DOI: [10.1103/RevModPhys.57.827](https://doi.org/10.1103/RevModPhys.57.827). [^precursor-diagram]: Schematic diagram from [ResearchGate](https://www.researchgate.net/figure/Schematics-of-the-contact-line-moving-models-considering-a-nonslip-condition-b-slip_fig3_385188951). [^snoeijer2013]: J. H. Snoeijer & B. Andreotti, Moving Contact Lines: Scales, Regimes, and Dynamical Transitions, Annu. Rev. Fluid Mech., 45, 269-292 (2013). DOI: [10.1146/annurev-fluid-011212-140734](https://doi.org/10.1146/annurev-fluid-011212-140734). [^saliva-image]: Image source: [Wikimedia Commons - Saliva Thread](https://commons.wikimedia.org/wiki/File:Saliva_Thread.jpg). [^kansal2024]: M. Kansal, C. Datt, V.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: Context",
    "content": "Bertin & J. H. Snoeijer, Viscoelastic wetting: Cox\u2013Voinov theory with normal stress effects, J. Fluid Mech., 985, A17 (2024). DOI: [10.1017/jfm.2024.296](https://doi.org/10.1017/jfm.2024.296). [^github-readme]: Course GitHub repository: [Intro-Soft-Matter-2025](https://github.com/comphy-lab/Intro-Soft-Matter-2025/blob/fb7fdb9beb90b278b360830478d8be97cbe17113/README.md). [^1]: M. Tjahjadi, H. A. Stone & J. M. Ottino, Satellite and subsatellite formation in capillary breakup, J. Fluid Mech., 243, 297-317 (1992). DOI: [10.1017/S0022112092002738](https://doi.org/10.1017/S0022112092002738). [^2]: C. Huh & L. E. Scriven, Hydrodynamic model of steady movement of a solid/liquid/fluid contact line, J. Colloid Interface Sci., 35:1, 85-101 (1971).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "4 soft matter singularities - Take-Home Coding Assignment: Contact Line Singularity: Context",
    "content": "DOI: [10.1016/0021-9797(71)90188-3](https://doi.org/10.1016/0021-9797(71)90188-3). > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Nov 12, 2025 > Date modified:: Nov 19, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/4-Soft-Matter-Singularities/#take-home-coding-assignment-contact-line-singularity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./2.5-Conservation-Laws.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Learning Goals: By the end...",
    "content": "By the end of this lecture, you should understand: > 1. Newton's second law for one particle: $\\boldsymbol{F} = m\\boldsymbol{a}$, and how it extends to many particles > 2. Microscopic fields from particles: how to convert a sum of point particles into continuous density fields using Dirac deltas > 3. The moving delta identity: $\\partial_t \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t)) = -\\boldsymbol{v}_i \\cdot \\nabla \\delta_i$ (see [[Moving-Delta-identity|detailed note]]) > 4. Microscopic continuity equation: how mass conservation emerges at the particle level > 5. Pairwise forces \u2192 divergence of stress: how pair forces become a flux tensor (see [[Virial-identity|detailed note]]) > 6. Microscopic momentum balance: $\\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{\\Pi} = \\rho \\boldsymbol{b}$ > 7. Coarse-graining \u2192 Cauchy stress: how ensemble averaging yields the Cauchy momentum equation $\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}$ > 8.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#learning-goals",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Learning Goals: Physical intuition: internal...",
    "content": "Physical intuition: internal forces appear as *stresses* (forces per unit area) in the continuum description ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#learning-goals",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Single particle (warm-up)",
    "content": "Write on board: $$\\boxed{m \\dot{\\boldsymbol{v}} = \\boldsymbol{F}^{\\text{ext}}}$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#single-particle-warm-up",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Many particles (N particles, pairwise forces)",
    "content": "Write: $$\\boxed{m_i \\dot{\\boldsymbol{v}}_i = \\boldsymbol{f}_i^{\\rm ext} + \\sum_{j \\ne i} \\boldsymbol{f}_{ij}, \\qquad \\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}}$$ > [!important] Important > We start here: every particle obeys Newton's second law with external forces and pair interactions. The key assumption \u2014 which is exact in classical mechanics \u2014 is that the force one particle exerts on another is *equal and opposite* ($\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$, Newton's third law). This symmetry is crucial: it will let us turn distributed forces into a stress tensor. 1. $m_i$: mass of particle $i$ 2. $\\boldsymbol{v}_i = \\dot{\\boldsymbol{r}}_i(t)$: velocity of particle $i$ 3. $\\boldsymbol{f}_i^{\\rm ext}$: external force (gravity, walls, etc.) 4. $\\boldsymbol{f}_{ij}$: force exerted by particle $j$ on particle $i$ 5. $\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$: action\u2013reaction; internal forces *cancel* when you sum over all particles ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#many-particles-n-particles-pairwise-forces",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Big idea",
    "content": "> [!info] > We want to describe the fluid at *every point in space*, not just at discrete particle locations. To do that, we represent each particle as a moving point mass \u2014 a Dirac delta spike at $\\boldsymbol{r}_i(t)$. Then we can define continuous fields: density, momentum, stress, etc. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#big-idea",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Setup: Microscopic fields",
    "content": "![](../../_Media/2-Conservation-Laws-1761807318276.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#setup-microscopic-fields",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Density:",
    "content": "$$\\boxed{\\rho(\\boldsymbol{r}, t) = \\sum_{i=1}^N m_i \\, \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t))}$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#density",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Momentum:",
    "content": "$$\\boxed{\\boldsymbol{g}(\\boldsymbol{r}, t) = \\sum_{i=1}^N m_i \\, \\boldsymbol{v}_i(t) \\, \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t))}$$ where $\\delta_i(\\boldsymbol{r}, t) := \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t))$ is a spike centered on particle $i$. > [!tldr] TL;DR > Each particle contributes a delta spike to the density field. At the location $\\boldsymbol{r}_i$, the spike has 'height' (or weight) equal to the particle's mass. The momentum density $\\boldsymbol{g}$ does the same but weights by $m_i \\boldsymbol{v}_i$. These fields are exact \u2014 there's no averaging yet. But they're spiky and discontinuous; what we want eventually is a smooth continuum limit. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#momentum",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - The key identity: moving delta",
    "content": "> [!important] > To convert particle equations into field equations, we need one crucial identity: how does a Dirac delta change when the particle moves? This is the moving delta identity (see [[Moving-Delta-identity|detailed derivation]]). $$\\boxed{\\partial_t \\delta_i(\\boldsymbol{r}, t) = -\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta_i(\\boldsymbol{r}, t) = -\\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta(\\boldsymbol{r} - \\boldsymbol{r}_i(t))}$$ > This is the advection equation for a spike. The time rate of change at a fixed point $\\boldsymbol{r}$ is minus the spatial change (gradient) in the direction the spike moves. See [[Moving-Delta-identity|detailed derivation]] for three ways to justify this. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#the-key-identity-moving-delta",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Derive mass continuity: Definitions",
    "content": "Start with the definition of $\\rho$: $$\\partial_t \\rho = \\sum_i m_i \\, \\partial_t \\delta_i$$ Use the moving delta identity: $$\\partial_t \\rho = -\\sum_i m_i \\, \\boldsymbol{v}_i \\cdot \\nabla_{\\boldsymbol{r}} \\delta_i$$ Factor out the gradient (it acts only on $\\boldsymbol{r}$, not on $\\boldsymbol{v}_i(t)$): $$\\partial_t \\rho = -\\nabla_{\\boldsymbol{r}} \\cdot \\sum_i m_i \\, \\boldsymbol{v}_i \\, \\delta_i$$ Recognize the sum as the momentum density $\\boldsymbol{g}$: $$\\partial_t \\rho = -\\nabla \\cdot \\boldsymbol{g}$$ $$\\boxed{\\partial_t \\rho + \\nabla \\cdot \\boldsymbol{g} = 0} \\quad \\text{(Microscopic continuity equation)}$$ > [!tip] > That one identity\u2014the moving delta\u2014is the *entire algebra.* It converts a sum of moving spikes into a divergence of momentum density. This is mass conservation at the microscopic level: if mass flows out of a region at rate $\\nabla \\cdot \\boldsymbol{g}$, the local density must decrease at rate $\\partial_t \\rho$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#derive-mass-continuity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Derive mass continuity: No approximation yet\u2014this...",
    "content": "No approximation yet\u2014this is exact for point particles. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#derive-mass-continuity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Part D: Microscopic Momentum Balance \u2014 Where Stress Is Born",
    "content": "> [!question] Idea > Now we take the time derivative of the momentum density. Newton's second law says particles accelerate due to the net external forces. When we convert that into a field equation, the internal (pair) forces turn into a divergence of a tensor\u2014and that tensor is the stress. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#part-d-microscopic-momentum-balance-where-stress-is-born",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Step 1: Time derivative of momentum density",
    "content": "$$\\partial_t \\boldsymbol{g} = \\sum_i m_i \\, \\partial_t(\\boldsymbol{v}_i \\delta_i)$$ Use the product rule: $$\\partial_t \\boldsymbol{g} = \\sum_i m_i \\, \\dot{\\boldsymbol{v}}_i \\, \\delta_i + \\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i$$ The first term is the acceleration field; the second is what needs conversion. See [[Dyadic-conversion|detailed note]] for the algebra, but the result is: $$\\boxed{\\sum_i m_i \\, \\boldsymbol{v}_i \\, \\partial_t \\delta_i = -\\nabla \\cdot \\sum_i m_i \\, \\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i}$$ where $\\boldsymbol{v}_i \\boldsymbol{v}_i$ is the outer product (dyad): $(\\boldsymbol{v}_i \\boldsymbol{v}_i)_{\\alpha\\beta} = v_{i\\alpha} v_{i\\beta}$. Define the kinetic momentum-flux tensor: $$\\boxed{\\boldsymbol{K}(\\boldsymbol{r}, t) = \\sum_i m_i \\, \\boldsymbol{v}_i \\boldsymbol{v}_i \\, \\delta_i}$$ So: $$\\partial_t \\boldsymbol{g} = \\sum_i m_i \\, \\dot{\\boldsymbol{v}}_i \\, \\delta_i - \\nabla \\cdot \\boldsymbol{K}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#step-1-time-derivative-of-momentum-density",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Step 2: Insert Newton's second law",
    "content": "From Newton's 2nd law: $$m_i \\dot{\\boldsymbol{v}}_i = \\boldsymbol{f}_i^{\\rm ext} + \\sum_{j \\ne i} \\boldsymbol{f}_{ij}$$ So: $$\\sum_i m_i \\, \\dot{\\boldsymbol{v}}_i \\, \\delta_i = \\underbrace{\\sum_i \\boldsymbol{f}_i^{\\rm ext} \\, \\delta_i}_{\\rho \\boldsymbol{b}} + \\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i$$ where $\\boldsymbol{b}$ is the external body force per unit mass (e.g., gravity), and $\\rho \\boldsymbol{b}$ is the external force per unit volume. $$\\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{K} = \\rho \\boldsymbol{b} + \\underbrace{\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i}_{\\text{internal forces}}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#step-2-insert-newtons-second-law",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Step 3: Turn pairwise forces into a divergence of the virial tensor: Results",
    "content": "This is the non-obvious step. See [[Virial-identity|detailed derivation]] for the full proof, but the key result is: $$\\boxed{\\sum_i \\sum_{j \\ne i} \\boldsymbol{f}_{ij} \\, \\delta_i = -\\nabla \\cdot \\boldsymbol{C}}$$ where $\\boldsymbol{C}$ is the configurational (virial) momentum-flux tensor: $$\\boldsymbol{C}(\\boldsymbol{r}, t) = \\frac{1}{2} \\sum_{i \\ne j} \\boldsymbol{r}_{ij} \\, \\boldsymbol{f}_{ij} \\int_0^1 \\delta(\\boldsymbol{r} - \\boldsymbol{r}_j - s \\boldsymbol{r}_{ij}) \\, ds$$ > [!tldr] Note: > Each pair force is 'smeared' uniformly along the bond connecting the two particles. When you take the divergence, you recover the two point forces at the ends\u2014equal and opposite, as required. The integral parameterizes the bond; it's just a mathematical trick to convert point forces into a flux. > [!important] Important > Internal forces don't vanish when summed over all particles, but they appear locally as a divergence of a stress-like tensor.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#step-3-turn-pairwise-forces-into-a-divergence-of-the-virial-tensor",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Step 3: Turn pairwise forces into a divergence of the virial tensor: This is the...",
    "content": "This is the transition from particles to continuum: pair forces become components of the stress tensor. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#step-3-turn-pairwise-forces-into-a-divergence-of-the-virial-tensor",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Step 4: Complete microscopic momentum balance",
    "content": "Gather all terms: $$\\boxed{\\partial_t \\boldsymbol{g} + \\nabla \\cdot (\\boldsymbol{K} + \\boldsymbol{C}) = \\rho \\boldsymbol{b}}$$ Define the total microscopic momentum-flux tensor: $$\\boxed{\\boldsymbol{\\Pi} := \\boldsymbol{K} + \\boldsymbol{C}}$$ So: $$\\boxed{\\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{\\Pi} = \\rho \\boldsymbol{b}} \\quad \\text{(Microscopic momentum balance)}$$ > [!important] > This is exact: no averaging, no approximation. Every term comes from Newton's second law and the geometry of deltas. The tensor $\\boldsymbol{\\Pi}$ contains two pieces: kinetic ($\\boldsymbol{K}$, from bulk motion and random thermal motion) and configurational ($\\boldsymbol{C}$, from pair forces). Together, they form the microscopic stress. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#step-4-complete-microscopic-momentum-balance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Part E: Coarse-Grain to Get Cauchy's Momentum Equation",
    "content": "> [!question] Idea > The microscopic equation is spiky and exact, but a real fluid isn't made of point particles\u2014we have $\\sim 10^{23}$ particles per cm$^3$. So we ensemble-average (or volume-average) over a mesoscopic region that contains many particles but is still small enough to resolve macroscopic gradients. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#part-e-coarse-grain-to-get-cauchys-momentum-equation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Define macroscopic fields via averaging",
    "content": "See [[Coarse-graining-momentum-to-Cauchy|detailed derivation]] for the complete mathematical treatment. $$\\langle \\rho \\rangle = \\rho, \\quad \\langle \\boldsymbol{g} \\rangle = \\rho \\boldsymbol{v}, \\quad \\langle \\boldsymbol{\\Pi} \\rangle \\equiv \\overline{\\boldsymbol{\\Pi}}$$ where the angle brackets denote ensemble (or volume) averaging. Key observation: The momentum density $\\boldsymbol{g}$ has two components: 1. Bulk momentum: $\\rho \\boldsymbol{v}$ (all particles drifting in the same direction) 2. Random (thermal) momentum: from velocity fluctuations around the mean ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#define-macroscopic-fields-via-averaging",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Split the flux: convection + stress",
    "content": "Write the crucial definition: $$\\boxed{\\overline{\\boldsymbol{\\Pi}} = \\rho \\boldsymbol{v} \\boldsymbol{v} - \\boldsymbol{\\sigma}}$$ where $\\boldsymbol{\\sigma}$ is the Cauchy stress tensor: Breaking it down: - $\\overline{\\boldsymbol{K}} = \\rho \\boldsymbol{v} \\boldsymbol{v}$: bulk contribution to stress - $\\overline{\\boldsymbol{C}} = -\\boldsymbol{\\sigma}$: configurational (virial) contribution to stress (from pair forces) > [!important] > The stress tensor is defined as the part of the momentum flux that isn't accounted for by the bulk drift. It captures how internal forces and thermal motion resist (or facilitate) deformation. For a gas at rest, it's just pressure. For a flowing fluid under shear, it includes viscous stresses. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#split-the-flux-convection-stress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Derive Cauchy's momentum equation: Average the microscopic...",
    "content": "Average the microscopic balance: $$\\partial_t \\langle \\boldsymbol{g} \\rangle + \\nabla \\cdot \\overline{\\boldsymbol{\\Pi}} = \\rho \\boldsymbol{b}$$ Substitute $\\langle \\boldsymbol{g} \\rangle = \\rho \\boldsymbol{v}$ and $\\overline{\\boldsymbol{\\Pi}} = \\rho \\boldsymbol{v} \\boldsymbol{v} - \\boldsymbol{\\sigma}$: $$\\partial_t(\\rho \\boldsymbol{v}) + \\nabla \\cdot(\\rho \\boldsymbol{v} \\boldsymbol{v}) - \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\boldsymbol{b}$$ Use the continuity equation $\\partial_t \\rho + \\nabla \\cdot (\\rho \\boldsymbol{v}) = 0$ to simplify: $$\\rho \\frac{\\partial \\boldsymbol{v}}{\\partial t} + \\rho (\\boldsymbol{v} \\cdot \\nabla) \\boldsymbol{v} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}$$ $$\\boxed{\\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}} \\quad \\text{(Cauchy momentum equation)}$$ where $\\frac{D}{Dt} = \\frac{\\partial}{\\partial t} + \\boldsymbol{v} \\cdot \\nabla$ is the material (convective) derivative. > [!tldr] TL;DR > This is the continuum momentum balance.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#derive-cauchys-momentum-equation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Derive Cauchy's momentum equation: It says: the...",
    "content": "It says: the rate of change of momentum in a moving fluid element equals the net stress applied to it plus external forces. It's valid for *any* fluid, whether Newtonian (constant viscosity) or non-Newtonian. The specific form of $\\boldsymbol{\\sigma}$ is the constitutive relation, which depends on the fluid's internal structure. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#derive-cauchys-momentum-equation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - The stress tensor is the flux of momentum",
    "content": "Draw on the board: ``` \u2192 \u2192 \u2192 (fast fluid) __________ | | interface (unit area, normal n) |__________| \u2192 \u2192 (slow fluid) ``` > Imagine a small surface across the interface. Momentum flows across it in two ways: (1) bulk convection ($\\rho \\boldsymbol{v} \\boldsymbol{v}$ term), and (2) microscopic collisions creating a stress ($-\\boldsymbol{\\sigma}$ term). The total flux is the product force per unit area, i.e., traction = $\\boldsymbol{\\sigma} \\cdot \\boldsymbol{n}$. If the fast fluid pushes on the slow fluid, the traction is positive; the stress tensor quantifies this. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#the-stress-tensor-is-the-flux-of-momentum",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Example: pressure (isotropic stress)",
    "content": "For a fluid at rest or in hydrostatic equilibrium: $$\\boldsymbol{\\sigma} = -p \\boldsymbol{I}$$ where $p$ is pressure and $\\boldsymbol{I}$ is the identity. Then: $$\\nabla \\cdot \\boldsymbol{\\sigma} = -\\nabla p, \\quad \\text{and} \\quad \\rho \\frac{D\\boldsymbol{v}}{Dt} = -\\nabla p + \\rho \\boldsymbol{b}$$ > Pressure is the simplest stress: it acts equally in all directions. The gradient $-\\nabla p$ pushes fluid from high to low pressure. No viscosity, no shear\u2014just pressure. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#example-pressure-isotropic-stress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Example: viscous stress (Newtonian fluid)",
    "content": "For a Newtonian fluid with viscosity $\\eta$: $$\\boldsymbol{\\sigma} = -p \\boldsymbol{I} + \\boldsymbol{\\tau}$$ where $\\boldsymbol{\\tau}$ is the viscous stress (from internal friction and momentum diffusion): $$\\tau_{\\alpha\\beta} = \\eta \\left( \\frac{\\partial v_\\alpha}{\\partial x_\\beta} + \\frac{\\partial v_\\beta}{\\partial x_\\alpha} \\right) + \\zeta \\delta_{\\alpha\\beta} (\\nabla \\cdot \\boldsymbol{v})$$ (The second term involves bulk viscosity $\\zeta$; for many fluids it's negligible.) > The viscous stress is proportional to the strain rate $\\nabla \\boldsymbol{v} + (\\nabla \\boldsymbol{v})^T$. Faster shear means stronger viscous stress. This is the microscopic momentum diffusion we derived in [[2-What-is-Viscosity|Lecture 2: Viscosity]]\u2014the kinetic theory. But here we've derived it from first principles: a consequence of particle interactions and collisions. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#example-viscous-stress-newtonian-fluid",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Summary",
    "content": "$$\\boxed{\\text{Newton (1 particle):}\\quad m \\dot{\\boldsymbol{v}} = \\boldsymbol{F}^{\\text{ext}}}$$ $$\\boxed{\\text{Newton (N particles):}\\quad m_i \\dot{\\boldsymbol{v}}_i = \\boldsymbol{f}_i^{\\rm ext} + \\sum_{j \\ne i} \\boldsymbol{f}_{ij}}$$ $$\\downarrow \\text{(convert to fields using deltas)}$$ $$\\boxed{\\text{Microscopic continuity:}\\quad \\partial_t \\rho + \\nabla \\cdot \\boldsymbol{g} = 0}$$ $$\\boxed{\\text{Microscopic momentum balance:}\\quad \\partial_t \\boldsymbol{g} + \\nabla \\cdot \\boldsymbol{\\Pi} = \\rho \\boldsymbol{b}}$$ $$\\downarrow \\text{(ensemble average; define stress)}$$ $$\\boxed{\\text{Cauchy momentum equation:}\\quad \\rho \\frac{D\\boldsymbol{v}}{Dt} = \\nabla \\cdot \\boldsymbol{\\sigma} + \\rho \\boldsymbol{b}}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Common Misconceptions: | Misconception |...",
    "content": "| Misconception | Correction | | ---------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------- | | Dirac deltas are just very tall, thin spikes. | They're *distributions*: singular objects defined by their action on test functions. But physically, you can think of them as limits of smooth bumps. | | The moving delta identity is obvious. | It's not! It requires careful treatment of the chain rule (or test functions). See [[Moving-Delta-identity\\|the detailed note]]. | | Internal forces cancel, so they don't matter. | They cancel *globally*, but they create *local* stresses and are essential for momentum balance in the fluid. | | Stress is the same as pressure. | Pressure is an isotropic stress (equal in all directions).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#common-misconceptions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Common Misconceptions: Stress is more...",
    "content": "Stress is more general: it can be anisotropic (different in different directions) and depends on the flow. | | Coarse-graining is an approximation. | It's not an approximation\u2014it's a change of perspective. The microscopic equation is exact but spiky. Averaging converts it into a smooth, usable form. | | The Cauchy equation only works for Newtonian fluids. | No. It's exact for *any* fluid. The assumption of Newtonian behavior (constant viscosity) comes *later*, when you specify the constitutive relation. | ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#common-misconceptions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - 1. Why $\\boldsymbol{f}_{ij} = -\\boldsymbol{f}_{ji}$ matters",
    "content": "Ask: \"What if I summed all the internal forces on all particles and got a non-zero result? What would happen?\" > Answer: The center of mass would accelerate without an external force\u2014violating Newton's first law. So action\u2013reaction must hold. And when it does, internal forces create *local* stresses but don't change the total momentum.\" ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#1-why-boldsymbolfij--boldsymbolfji-matters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - 2. Pressure vs. viscous stress",
    "content": "1. Pressure: acts equally in all directions; no preferred axis. 2. Viscous stress: depends on velocity gradients; has a preferred direction (the direction of shear). Imagine honey being poured. Gravity provides a pressure gradient (accelerating the fluid downward), and viscosity creates shear stress (resisting the motion between fast-flowing and slow-flowing regions). ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#2-pressure-vs-viscous-stress",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Homework / Conceptual Questions: Context",
    "content": "1. Coarse-graining in practice: explain what \u201ccoarse-graining\u201d means and why it lets us treat soft matter as a continuum. Pick one system (foam, polymer solution, emulsion) and say when this breaks down (give a specific length scale or condition). 2. Continuity in a nozzle: You squeeze shampoo through a pump and narrow outlet at steady rate. Using only words, explain why the fluid speeds up in the narrow section and name the conservation law you\u2019re invoking. Give one case where this reasoning would fail. 3. Momentum balance around a bend: Water flows steadily through a pipe that turns 90 degrees. Describe which forces turn the flow (pressure differences versus wall shear) and how the picture changes for very slow flows (creeping) versus very fast flows (inertial). 4. Where does the work go? You slide two plates with glycerol between them at constant speed.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#homework-conceptual-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Homework / Conceptual Questions: Explain where the...",
    "content": "Explain where the mechanical power you input ends up inside the fluid, name the phenomenon responsible (in words), and give a one-sentence microscopic picture for it. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#homework-conceptual-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - References & Further Reading",
    "content": "1. Chapman & Cowling (1970): *The Mathematical Theory of Non-Uniform Gases.* Section 2: kinetic theory and microscopic description. 2. Bird, Stewart & Lightfoot (2007): *Transport Phenomena.* Chapter 1: detailed derivation of continuum equations from molecular dynamics. 3. Irving & Kirkwood (1950): \"The Statistical Mechanical Theory of Transport Processes.\" Journal of Chemical Physics. (Original microscopic momentum-flux definition; slightly technical but canonical.) 4. Doi & Edwards (1986): *The Theory of Polymer Dynamics.* Chapter 2: stress tensor and its microscopic origin. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#references-further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Quick Assessment (Check your Understanding): After this lecture,...",
    "content": "After this lecture, students should be able to: 1. Newton's second law for a single particle and for N particles. 2. Microscopic fields ($\\rho$, $\\boldsymbol{g}$) using Dirac deltas and explain why deltas are the right tool. 3. Explain the moving delta identity and use it to derive the microscopic continuity equation. 4. Explain how pair forces (Newton's third law) turn into a divergence of the virial tensor. 5. Derive the microscopic momentum balance and identify the kinetic and configurational components of stress. 6. Describe ensemble averaging and explain why it's necessary to transition from spiky microscopic fields to smooth macroscopic fields. 7. Derive the Cauchy momentum equation from the microscopic balance and identify the role of the Cauchy stress tensor. 8. Explain the physical meaning of the stress tensor and give examples (pressure, viscous stress). 9. Understand that the Cauchy equation is exact for any fluid; the Newtonian assumption comes later (constitutive relation). ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#quick-assessment-check-your-understanding",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Connection to Soft Matter",
    "content": "1. These laws apply to flows of complex fluids (polymer solutions obey continuity and momentum conservation, with extra stresses) 2. Apply to deformable solids (elastic energy is stored energy in the energy equation) 3. Foundation for understanding: 1. Fluid instabilities (next lecture) 2. Rheology (later lectures) 3. All continuum modeling of soft matter ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#connection-to-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2.5 conservation laws - Supporting Detailed Notes: These notes contain...",
    "content": "These notes contain the mathematical details and alternative proofs that are too long for the main lecture but essential for deep understanding: 1. [[Moving-Delta-identity]]: Three detailed proofs of $\\partial_t \\delta_i = -\\boldsymbol{v}_i \\cdot \\nabla \\delta_i$ (chain rule, distributions, 1D sanity check) 2. [[Dyadic-conversion]]: The algebraic steps to show $\\sum_i m_i \\boldsymbol{v}_i \\partial_t \\delta_i = -\\nabla \\cdot \\sum_i m_i \\boldsymbol{v}_i \\boldsymbol{v}_i \\delta_i$ 3. [[Virial-identity]]: Full derivation of $\\delta_i - \\delta_j = -\\nabla \\cdot \\int_0^1 \\boldsymbol{r}_{ij} \\delta(\\ldots) ds$ and its application to pair forces --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 29, 2025 > Date modified:: Nov 19, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/2.5-Conservation-Laws/#supporting-detailed-notes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./1-Intro-Soft-Matter.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Lecture 1: Different Faces of Soft Condensed Matter",
    "content": "An introduction to soft materials, why they're soft, and how we measure softness. See [[0-README|course overview and structure]] for context. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#lecture-1-different-faces-of-soft-condensed-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Prologue: Opening Poll",
    "content": "> [!question] \"Name one soft material you've touched today.\" Soft matter is everywhere in daily life\u2014from the water in your shower and shampoo to the bread on your table, tissues, foams, and gels. This simple question anchors a deeper truth: the materials we interact with most are soft. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#prologue-opening-poll",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - What is Soft Matter?",
    "content": "> [!tldr] Definition > Materials easily deformed by modest stresses, thermal fluctuations, or interfacial forces; typically organized by mesoscopic building blocks (droplets, bubbles, grains, polymer coils) held together by relatively weak interactions.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#what-is-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Water + Gelatin \u2192 Gel",
    "content": "Observe the transformation of gelatin and water: - Liquid state: Individual molecules move freely - Cooling: Gelatin chains form a crosslinked network - Solid state: Wobbly, flexible gel structure - Mechanism: Structure held by *weak* (often reversible) interactions, not rigid covalent bonds The gel feels solid (can hold shape), yet wobbles easily when pushed\u2014a hallmark of soft matter. ![](../../_Media/1-Intro-Soft-Matter-1761103784897.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#water-gelatin-gel",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Beer Foam (Foam \ud83c\udf7a)",
    "content": "![](../../_Media/1-Intro-Soft-Matter-1761103818495.png) Good foam (left): Stable bubble structure with clear thin walls Bad foam (right): Bubbles coalesce and collapse Foams are gas bubbles trapped in liquid with surfactants stabilizing the interfaces. They exemplify soft matter because: - Structure held by surface tension (weak force) - Easy to deform under modest stresses - Flow and rearrange under sustained forces - Evolve over time via coalescence and coarsening ![](../../_Media/1-Intro-Soft-Matter-1761103864489.png) *Reference:* P. S. Stewart & S. Hilgenfeldt, *Annu. Rev. Fluid Mech.*, 55:1, 323\u2013350 (2023)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#beer-foam-foam-",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Shaving Cream",
    "content": "![](../../_Media/1-Intro-Soft-Matter-1761103886417.png) A dense foam of gas + liquid\u2014microstructure determines function: - Spreads easily (flows under shear) - Holds shape temporarily (stores energy) - Responds to manual deformation (viscoelastic behavior) > [!note] Key Insight > In many soft materials, surface tension, entropy, and geometry govern structure and mechanics far more than stiff, covalent bond stretching does. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#shaving-cream",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Atomic Scaling Argument",
    "content": "![](../../_Media/1-Intro-Soft-Matter-1761103927376.png) When you compress a solid, you push overlapping electron clouds closer together. The bulk modulus scales roughly as: $$K \\sim \\frac{U}{a^3}$$ where: - $U$ = interaction energy per atom (~tens of eV, from Coulombic/quantum mechanics) - $a$ = atomic length scale (~1 \u00c5ngstr\u00f6m) This is the correct scaling: interaction energies packed into atomic volumes yield enormous bulk moduli.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#atomic-scaling-argument",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Numerical Estimate",
    "content": "Coulombic energy at 1 \u00c5ngstr\u00f6m: Two unit charges separated by $r = 1\\,\\text{\u00c5}$ give: $$U = \\frac{1}{4\\pi\\varepsilon_0}\\frac{e^2}{1\\,\\text{\u00c5}} \\approx 14.4\\,\\text{eV}$$ Converting to modulus: Using the conversion $1\\,\\text{eV/\u00c5}^3 = 160.22\\,\\text{GPa}$: $$K \\sim \\frac{14.4\\,\\text{eV}}{(1\\,\\text{\u00c5})^3} \\approx 2.3 \\times 10^6\\,\\text{MPa}$$ *(Higher estimates using Bohr radius $a_0 \\approx 0.529\\,\\text{\u00c5}$ and $U \\approx 27.2\\,\\text{eV}$ reach $\\sim 2.9 \\times 10^7\\,\\text{MPa}$\u2014the key point is the scaling, not the exact prefactor.)*",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#numerical-estimate",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Reality Check: Bulk Moduli of Real Materials",
    "content": "| Material | $K$ (MPa) | $K$ (GPa) | Note | |----------|-----------|-----------|------| | Diamond | $4.4 \\times 10^5$ | 440 | Hard to compress and hard to shear | | Steel | $(1.6\\text{\u2013}1.7) \\times 10^5$ | 160\u2013170 | Hard to compress and hard to shear | | Water | $2.2 \\times 10^3$ | 2.2 | Hard to compress, liquid (no static shear) | | Rubber | $(1\\text{\u2013}2) \\times 10^3$ | 1\u20132 | Hard to compress, soft in shear | > [!important] > Most condensed matter is hard to compress (large $K$). What makes something feel \"hard\" in everyday life is actually the shear modulus $G$, not the bulk modulus. Everyday \"hardness\" \u2248 resistance to shape change, not resistance to compression. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#reality-check-bulk-moduli-of-real-materials",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Why is Soft Matter *Soft*? \u2014 The Entropic Shear Modulus",
    "content": "For soft solids (rubbers, gels, polymer networks), the small-strain shear modulus arises fundamentally from entropy, not stiff bond stretching: $$\\boxed{G = n k_B T \\quad \\text{or} \\quad G \\sim \\frac{k_B T}{\\xi^3}}$$ where: - $n$ = strand/crosslink density (number per unit volume) - $\\xi$ = mesh size of the network (typical strand spacing, 10\u2013100 nm) - $k_B T$ = thermal energy (~$4.1 \\times 10^{-21}\\,\\text{J}$ at room temperature) > [!note] > This relation applies specifically to semi-dilute polymer networks forming blob structures\u2014see [[Polymer-Concentration-Regimes-and-Blob-Networks]] for details.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#why-is-soft-matter-soft-the-entropic-shear-modulus",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Microscopic Origin: Stretching Reduces Configurations",
    "content": "At the chain level: - Stretching a polymer coil reduces the number of configurations it can adopt - Entropy decreases when stretched - System resists entropy loss with restoring force: $F = -T\\frac{\\partial S}{\\partial x}$ - Unlike a metal spring (stiff atomic bonds resist), this force is statistical From one chain to a network: Crosslink $n$ strands per unit volume $\\Rightarrow$ the free-energy density is: $$F/V \\sim n k_B T \\quad \\Rightarrow \\quad G = n k_B T$$ For nearly incompressible materials (Poisson's ratio $\\nu \\to 0.5$): $$E \\approx 3G$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#microscopic-origin-stretching-reduces-configurations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Practical Examples",
    "content": "With $k_B T \\approx 4.1 \\times 10^{-21}\\,\\text{J}$ at room temperature: $$G \\sim \\frac{k_B T}{\\xi^3} \\quad \\Rightarrow \\quad \\begin{cases} \\xi = 10\\,\\text{nm} & \\Rightarrow G \\approx 4\\,\\text{kPa} \\\\ \\xi = 1\\,\\text{nm} & \\Rightarrow G \\approx 4\\,\\text{MPa} \\end{cases}$$ Interpretation: Small changes in mesh size (network crosslink density) move the shear modulus from the kPa range (very soft, like a loose gel) to the MPa range (stiffer, more rubber-like), while the bulk modulus stays large (still hard to compress). > [!tip] The Soft Matter Paradox Resolved > Soft in shear, hard in bulk. Stretching a polymer network just rearranges coil conformations (easy, entropy-driven). Compressing it still pushes on dense electron clouds and liquid trapped in pores (hard, bonding physics). This is why rubbers and gels are \"soft\" yet \"incompressible\". ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#practical-examples",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Far from Equilibrium: Dynamics Dominate",
    "content": "Soft matter reveals its richness when driven away from equilibrium. Time and forcing history often matter more than equilibrium structure alone.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#far-from-equilibrium-dynamics-dominate",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Drop Impact in Microgravity (ISS \"Liquid Ping-Pong\")",
    "content": "Without gravity, a water droplet maintains a sphere. When two droplets collide: - Surface tension dominates (gravity suppressed) - Complex coalescence dynamics unfold - Demonstrates soft matter far from equilibrium",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#drop-impact-in-microgravity-iss-liquid-ping-pong",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Mud Volcano at Yellowstone",
    "content": "Mud is a elastoviscoplastic soft material: - Behaves as solid over short times (can support surface bumps and cones) - Flows like liquid over long times (material spreads slowly) - Time-dependent response is essential to understanding behavior",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#mud-volcano-at-yellowstone",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Champagne Bubbles: A Glass of Soft Matter: Bubbles rising through...",
    "content": "Bubbles rising through champagne display remarkable dynamics driven by: - Liquid-gas interfaces (surface tension $\\gamma$) - Dissolved CO\u2082 (pressure inside bubbles) - Surfactants from wine components - Viscoelasticity of the liquid (if polymers are present) Key observation: Adding trace amounts of polymer ($c = 0.001\\%$ to $0.1\\%$) dramatically changes bubble shape and bursting dynamics. | Polymer Concentration | Bubble Shape | Behavior | Physical Origin | |---|---|---|---| | $c = 0.001\\%$ | Nearly spherical | Like clean water | No elastic effects | | $c = 0.01\\%$ | Slightly distorted | Viscoelastic effects emerge | Polymer chains begin to store energy | | $c = 0.1\\%$ | Highly deformed | Viscoelasticity dominates | Strong elastic resistance to flow | References: - E. Ghabache, G. Liger-Belair, A. Antkowiak & T. S\u00e9on, *Sci. Rep.*, 6, 25148 (2016) - E. Ghabache, A. Antkowiak, C. Josserand & T. S\u00e9on, *Phys. Fluids*, 26(12) (2014) - P. L. L. Walls, L. Henaux & J. C. Bird, *Phys. Rev.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#champagne-bubbles-a-glass-of-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Champagne Bubbles: A Glass of Soft Matter: E*, 92(2), 021002...",
    "content": "E*, 92(2), 021002 (2015) > [!tip] Tiny Additives, Huge Effects > Trace amounts of soft matter (ppm\u2013\u2030 polymer) can dramatically alter flows and instabilities. This is an engineer's lever in mixing, coating, printing, and food science applications. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#champagne-bubbles-a-glass-of-soft-matter",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Rayleigh's Pioneering Observations (1891)",
    "content": "> 179. *SOME APPLICATIONS OF PHOTOGRAPHY.* > [*Proc. Roy. Inst.* XIII. pp. 261\u2013272, Feb. 1891; *Nature*, XLIV. pp. 249\u2013254, 1891.] ![](../../_Media/1-Intro-Soft-Matter-1761105367372.png) John William Strutt, 2nd Baron Rayleigh, one of the 19th century's greatest physicists, used instantaneous photography to capture: - Falling jets breaking into droplets (Rayleigh\u2013Plateau instability) ![](../../_Media/1-Intro-Soft-Matter-1761105418528.png) - Liquid stream dynamics and surface tension effects - Capillary flows driven by interfacial forces His 1891 paper essentially pioneered the study of liquid dynamics\u2014a cornerstone of soft matter physics.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#rayleighs-pioneering-observations-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Taylor\u2013Culick Retraction: The Dupr\u00e9\u2013Rayleigh Paradox",
    "content": "![](../../_Media/1-Intro-Soft-Matter-1761105451051.png) When you puncture a thin soap bubble, the film edge retracts rapidly inward. The film consists of a thin water layer (thickness $h_0$) with surfactant molecules at both liquid\u2013air interfaces (surface tension $\\gamma_{fa}$ per interface). > [!question] The Paradox: > Two seemingly correct approaches give different predictions for retraction speed $v_f$:",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#taylorculick-retraction-the-dupr\u00e9rayleigh-paradox",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Energy Approach (Rayleigh, 1891)",
    "content": "Rate of surface energy decrease = Rate of kinetic energy increase $$\\frac{d}{dt}\\left(\\frac{1}{2}m v^2\\right) = 2\\gamma_{fa}(2\\pi R) v$$ $$\\Rightarrow \\quad v_f = \\sqrt{\\frac{4\\gamma_{fa}}{\\rho h_0}}$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#energy-approach-rayleigh-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Momentum Approach (Taylor, 1959)",
    "content": "Force from surface tension = Rate of momentum change $$\\frac{dP}{dt} = 2\\gamma_{fa}(2\\pi R)$$ $$\\Rightarrow \\quad \\frac{d}{dt}(m v_f) = 2\\gamma_{fa}(2\\pi R)$$ $$\\Rightarrow \\quad v_f = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}}$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#momentum-approach-taylor-1959",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - The Factor of 2 Discrepancy",
    "content": "$$\\text{Energy method:} \\quad v_f = \\sqrt{\\frac{4\\gamma_{fa}}{\\rho h_0}}$$ $$\\text{Momentum method:} \\quad v_f = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}}$$ Question: Where did the energy go? > [!question] Think About It > The resolution of this paradox requires careful accounting of energy dissipation and momentum conservation. We will resolve it in [[1.5-Taylor-Culick-Paradox|Lecture 1.5]], where we properly track kinetic energy, surface energy, and dissipation mechanisms. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#the-factor-of-2-discrepancy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Friday Afternoon Experiment: Timescale Matters",
    "content": "Researchers at Sorbonne Universit\u00e9 studied bubble formation dynamics by varying the air-blowing rate during bubble generation: Reference: D. Tammaro, R. Pasquino, M. M. Villone, G. D'Avino, V. Ferraro, E. Di Maio, A. Langella, N. Grizzuti & P. L. Maffettone, *Langmuir*, 34(19), 5646\u20135654 (2018) Key Observation: - Low blowing rate: Bubbles form slowly; film drains gradually; stable bubble structure - High blowing rate: Bubbles form rapidly; less drainage time; different dynamics and breakup modes Lesson: In soft matter, protocol and timescale are decisive control parameters. The same material exhibits wildly different behavior depending on how fast you drive it. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#friday-afternoon-experiment-timescale-matters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Epilogue: Reflection Questions",
    "content": "1. Name one soft-matter phenomenon you now see in everyday life. Why is it soft? 2. What do you want to get out of this course? 3. *(Optional)* Share a 1\u20132 sentence observation on something from your week that now \"looks like soft matter.\" ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#epilogue-reflection-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Homework (Self-Assessed)",
    "content": "> [!check] Homework Questions > > Q1. Explain, in your own words, why many soft materials have shear moduli orders of magnitude below crystalline solids. (Think about atomic vs mesoscopic length scales and energy sources.) > > Q2. Pick an everyday product and identify: > - Its soft-matter classification (foam, gel, polymer solution, colloid, etc.) > - The microstructural ingredient that gives it its desired function > > Q3. A polymer coil in a good solvent is stretched and released. Why is the restoring force entropic rather than from stiff bond stretching? > > Q4. A thin water stream breaks into drops. Name: > - The instability responsible > - Its thermodynamic driver (what energy is minimized?) > - One engineering application or mitigation strategy (e.g., in printing, mixing, coating) [[1.75-Complementary-Questions-Answers]] ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#homework-self-assessed",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Bulk Modulus ($K$) \u2014 Resistance to Volume Change",
    "content": "- Definition: $\\Delta V / V = -\\Delta p / K$ (uniform compression from all directions) - Large $K$ means small volume changes under pressure \u2192 (nearly) incompressible - Typical values: Water and rubber both have $K \\sim 1$\u2013$2\\,\\text{GPa}$ \u2192 hard to compress Example: A 1 atm pressure change (100 kPa) on water with $K = 2\\,\\text{GPa}$ gives $\\Delta V/V \\approx 5 \\times 10^{-5}$ (0.005% volume change)\u2014effectively incompressible in everyday terms.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#bulk-modulus-k-resistance-to-volume-change",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Shear Modulus ($G$) \u2014 Resistance to Shape Change",
    "content": "- Definition: Stress needed to shear a material at (nearly) constant volume - Small $G$ \u2192 easy to reshape \u2192 \"soft in shear\" - Typical values: Soft matter $G \\sim 1\\,\\text{kPa}$ to $1\\,\\text{MPa}$; hard matter $G \\sim 50$\u2013$200\\,\\text{GPa}$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#shear-modulus-g-resistance-to-shape-change",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Young's Modulus ($E$) \u2014 Uniaxial Stiffness",
    "content": "- Definition: Stress divided by strain in a simple tension/compression test - Not independent: Combines both shear and bulk responses via the Poisson effect - Typical values: Soft matter $E \\sim 1$\u2013$100\\,\\text{MPa}$; hard matter $E \\sim 100$\u2013$1000\\,\\text{GPa}$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#youngs-modulus-e-uniaxial-stiffness",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Poisson's Ratio ($\\nu$) \u2014 Lateral Contraction",
    "content": "- Definition: When you stretch a rod, it gets thinner; $\\nu$ quantifies this lateral contraction - Incompressible limit: $\\nu \\to 0.5$ (no volume change under axial load) - Typical values: Metals $\\nu \\approx 0.2$\u2013$0.35$; rubbers $\\nu \\approx 0.5$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#poissons-ratio-nu-lateral-contraction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Relations Between Elastic Constants",
    "content": "For isotropic, linear elastic solids, any two constants determine the others: $$\\boxed{E = 2G(1 + \\nu)}$$ $$\\boxed{E = \\frac{9KG}{3K + G}}$$ $$\\boxed{K = \\frac{E}{3(1 - 2\\nu)}}$$ Key Limits: - Incompressible limit ($\\nu \\to 0.5$): $K \\gg G$ and $E \\approx 3G$ - This is why rubbers and gels can be \"soft\" ($G$ small) yet \"incompressible\" ($K$ large) - Compressible solids (metals): $\\nu \\approx 0.2$\u2013$0.35$, so $K$ and $G$ are comparable",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#relations-between-elastic-constants",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Liquids: A Special Case",
    "content": "A Newtonian liquid (water, simple oils) cannot support static shear stress, so: - $G = 0$ (no static shear modulus) - $K$ is large (liquids are hard to compress) - Resistance to shear is purely viscous ($\\eta$, viscosity), not elastic > [!abstract] The Incompressible Yet Soft (?) > > Large $K$ doesn't imply large $G$. > > - Bulk modulus ($K$): Controls volume resistance under hydrostatic pressure (bonding/packing physics) > - Shear modulus ($G$): Controls shape resistance at nearly constant volume (entropy in networks; viscosity in liquids) > > Soft matter is soft in $G$ (easy to reshape), not in $K$ (hard to compress). > > - Rubbers/gels: $K \\gg G$, $\\nu \\approx 0.5$, $E \\approx 3G$ > - Liquids: $K$ large, $G = 0$ (use $\\eta$ instead), no meaningful $E$ > - Hard solids: Both $K$ and $G$ large",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#liquids-a-special-case",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Quick Reference Table",
    "content": "| Property | Soft Matter (typical) | Hard Matter (typical) | Meaning | |----------|----------------------|----------------------|---------| | $K$ (Bulk) | 1\u20132 GPa | 100\u2013400 GPa | Volume stiffness (hydrostatic) | | $G$ (Shear) | 1 kPa \u2013 1 MPa | 50\u2013200 GPa | Shape stiffness | | $E$ (Young's) | 1\u2013100 MPa | 100\u20131000 GPa | Uniaxial stiffness | | $\\nu$ (Poisson) | $\\approx 0.5$ | 0.2\u20130.35 | Lateral contraction ratio | ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#quick-reference-table",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Key Takeaways",
    "content": "1. Soft matter is everywhere. From gels and foams to champagne bubbles and mud, soft materials dominate our everyday experience. 2. \"Soft\" and \"incompressible\" are not contradictory. Most soft materials are hard to compress (large $K$) but easy to reshape (small $G$). 3. Entropic elasticity is different. In polymer networks, the shear modulus arises from statistical resistance to entropy loss, not stiff bond stretching. This makes them temperature-sensitive and tunable via crosslink density. 4. Time matters. The same soft material behaves differently over different timescales\u2014as a solid at short times, as a fluid at long times. This time-dependent response is central to soft matter physics. 5. Tiny additives, huge effects. Trace polymer additions can dramatically alter interfacial dynamics, instabilities, and flow behavior\u2014an important design lever in engineering and biology. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1 intro soft matter - Further Reading: - Textbook: Pierre-Gilles...",
    "content": "- Textbook: Pierre-Gilles de Gennes, *Scaling Concepts in Polymer Physics* (Cornell University Press, 1979) \u2014 foundational work on soft matter scaling [Link](https://www.amazon.co.uk/Scaling-Concepts-Polymer-Physics-Pierre-Gilles/dp/080141203X) - Review: Patrick Oswald & Pierre Pieranski, *Nematic and Cholesteric Liquid Crystals: Concepts and Physical Properties Illustrated by Experiments* (Taylor & Francis, 2005) \u2014 detailed liquid crystal physics [DOI: 10.1201/9780203023013](https://doi.org/10.1201/9780203023013) - Modern perspective: Tom McLeish, *Liquid Crystal Polymers* (Oxford University Press, 2018) \u2014 contemporary soft matter overview [Link](https://global.oup.com/academic/product/soft-matter-9780198807131?cc=gb&lang=en&) See the next lecture for a rigorous treatment of the Taylor\u2013Culick paradox and momentum/energy conservation in soft matter flows. --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 14, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1-Intro-Soft-Matter/#further-reading",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Soft Condensed Matter: An Introduction",
    "content": "Course Overview. A journey through soft materials\u2014from everyday foams and gels to polymer networks and interfacial dynamics. We develop the conceptual and mathematical foundations to understand why soft matter behaves so differently from hard solids and liquids.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#soft-condensed-matter-an-introduction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Course Goals",
    "content": "- Develop a basic understanding of key concepts in Soft Condensed Matter - Recognize parallels and differences between Soft Matter and 'Hard Matter' systems - Engage critically with publications and seminars (assessed in final presentations) - Learn how to contribute to Open Source Science (mid-course assignment)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#course-goals",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Course Structure (Lectures + Bridges): - Lecture 1:...",
    "content": "- Lecture 1: [[1-Intro-Soft-Matter|Different Faces of Soft Condensed Matter]] \u2013 What is soft matter, why is it soft, and how do we measure softness? - [[1.5-Taylor-Culick-Paradox|Bridge 1.5: The Taylor\u2013Culick Paradox]] \u2013 Resolving a century-old paradox through proper energy accounting and momentum conservation - [[1.75-Complementary-Questions-Answers|Homework Solutions: Lecture 1]] \u2013 Self-assessed questions with model answers - Lecture 2: [[2-What-is-Viscosity|Viscosity and Momentum Diffusion]] \u2013 Viscosity as an emergent property from kinetic theory; the no-slip condition; continuum momentum transport - [[2.5-Conservation-Laws|Bridge 2.5: From Newton's Laws to Conservation Equations]] \u2013 Microscopic particle dynamics to continuum momentum balance and Cauchy stress - Lecture 3: [[3-Soft-Matter-Instabilities|Soft Matter Instabilities]] \u2013 Pattern formation through instability mechanisms: Rayleigh\u2013Plateau, Kelvin\u2013Helmholtz, Rayleigh\u2013Taylor, Faraday waves, Rayleigh\u2013B\u00e9nard\u2013Marangoni, Saffman\u2013Taylor fingering, and viscous coiling.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#course-structure-lectures-bridges",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Course Structure (Lectures + Bridges): Understanding how competing...",
    "content": "Understanding how competing forces select characteristic length scales and how to harness instabilities for fabrication. - Lecture 4: Soft Matter Singularities - Lecture 5: Elastic vs Viscous vs Viscoelastic Behavior - Lecture 6: Rheology \u2013 Measuring \"Softness\" and Time-Dependent Response - Lecture 7: Advanced Topics & Research Frontiers - Lecture 8: Presentations (10:00\u201312:00)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#course-structure-lectures-bridges",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Administrative Information",
    "content": "> [!info] Course Details > - Format: 8 weekly lectures (2 hours each) > - Homework: Short self-assessed questions at the end of each lecture (model solutions provided) > - Office Hours: Thursdays 14:00\u201316:00 (Ph255) or email [vatsal.sanjay@durham.ac.uk](mailto:vatsal.sanjay@durham.ac.uk) > - Assessments: > - Mid-course: Open Source Science contribution (Week 5) > - Final: Student presentations (Week 8, 10:00\u201312:00) > - Grading: Participation (20%), take-home assignment (30%), final presentation (50%)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#administrative-information",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Key Learning Outcomes",
    "content": "By the end of this course, you will be able to: 1. Identify soft matter in everyday materials and explain what makes it \"soft\" 2. Explain the microscopic origins of soft material properties (entropy, surface tension, weak interactions) 3. Compare and contrast soft and hard condensed matter using scaling arguments and dimensional analysis 4. Apply continuum mechanics to soft matter problems (flows, instabilities, deformations) 5. Interpret rheological data and connect microscopic structure to macroscopic behavior 6. Critically read soft matter research papers and engage in scientific discussion",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#key-learning-outcomes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - How to Use These Lecture Notes",
    "content": "- Start here: Read [[1-Intro-Soft-Matter|Lecture 1]] for foundational concepts and examples - Work through systematically: Each lecture builds on the previous one - Try the homework: Self-assessment questions reinforce key ideas - Use the references: Further reading suggestions at the end of each lecture - Engage with videos and figures: Visual examples illustrate abstract concepts ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#how-to-use-these-lecture-notes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Recommended Prerequisites",
    "content": "- Physics: Mechanics (Newton's laws, energy, momentum) - Mathematics: Calculus (derivatives, integrals), linear algebra basics - Chemistry: Basic atomic/molecular structure, thermodynamics concepts No prior knowledge of soft matter or materials science is required.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#recommended-prerequisites",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Textbooks & References",
    "content": "This list will be populated as we go through the course",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#textbooks-references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Primary References",
    "content": "- de Gennes, P.-G. (1979). *Scaling Concepts in Polymer Physics*. Cornell University Press. [Amazon UK](https://www.amazon.co.uk/Scaling-Concepts-Polymer-Physics-Pierre-Gilles/dp/080141203X) - Oswald, P. & Pieranski, P. (2005). *Nematic and Cholesteric Liquid Crystals: Concepts and Physical Properties Illustrated by Experiments*. Taylor & Francis. - [DOI: 10.1201/9780203023013](https://doi.org/10.1201/9780203023013) - Detailed experimental and theoretical treatment",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#primary-references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Modern Overviews",
    "content": "- Tom McLeish, *Liquid Crystal Polymers* (Oxford University Press, 2018) \u2014 contemporary soft matter overview [Link](https://global.oup.com/academic/product/soft-matter-9780198807131?cc=gb&lang=en&)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#modern-overviews",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Research Journals",
    "content": "- *Phys. Rev. Fluids* (APS) - *J. Fluid Mech.* (Cambridge) - *Soft Matter* (Royal Society of Chemistry) - *Langmuir* (ACS) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#research-journals",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "0 readme - Contact & Support",
    "content": "Instructor: Vatsal Sanjay Email: [vatsal.sanjay@durham.ac.uk](mailto:vatsal.sanjay@durham.ac.uk) Office Hours: Thu 14:00\u201316:00 (Ph255) Have questions? Come to office hours or send an email \u2014 I'm here to help! --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 14, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/0-README.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/0-README/#contact-support",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./3-Soft-Matter-Instabilities.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 0) Why talk about instability?",
    "content": "Patterns are everywhere: dunes and ripples, icicle ribs, dew beads on spider webs, hexagonal cracks in drying mud. Their regularity\u2014despite messy materials\u2014signals robust mechanisms. In fluids (and soft solids), instabilities often set the pattern scale and shape by amplifying tiny disturbances into organized structures. Our goal today is to recognize those mechanisms and the forces that select length and time scales. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#0-why-talk-about-instability",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 1) Stability in one picture",
    "content": "Think of a bead in a landscape: at the bottom of a well (stable), on a flat shelf (neutral), or on a hilltop (unstable). ![](../../_Media/Lecture3-Instabilities-1761841931414.png) A \u201cstanding pencil\u201d fails in practice because the slightest perturbation makes it fall\u2014no physical system is perfectly disturbance\u2011free. We use this picture to interpret flows: _stable_ states damp disturbances; _unstable_ ones amplify them; _neutral_ ones neither grow nor decay until nonlinearities tip them. ![](../../_Media/Lecture3-Instabilities-1761841962795.png) Where do disturbances come from? Ambient vibrations, thermal fluctuations, surface roughness, composition heterogeneity, or imposed forcing (e.g. vibration). Even when continuum hypotheses hold (Knudsen number small), the flow \u201cfeels\u201d these small perturbations; if the base state cannot damp them, patterns emerge. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#1-stability-in-one-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 2) What to identify in any instability",
    "content": "1. Base state: the simplest flow/interface we\u2019d like to hold (a cylinder of liquid, a flat film, two fluids sliding past each other). 2. Competing forces: inertia, viscosity, gravity, surface tension, and sometimes elasticity (soft matter). 3. Positive feedback: does a perturbation increase the driving (pressure, buoyancy, shear) faster than restoring forces (surface tension, viscosity, elasticity) can oppose it? 4. Advection vs absolute growth: disturbances can be swept away while growing (_convective_) or grow in place and contaminate the whole domain (_absolute_). We\u2019ll use this language qualitatively in experiments. Rule of thumb: the same effect (surface tension, elasticity, gravity) that stabilizes short wavelengths often leaves a window of longer wavelengths free to grow\u2014yielding a _most unstable_ wavelength that sets the pattern spacing. In words of James Clerk Maxwell ![](../../_Media/Lecture3-Instabilities-1761842034192.png) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#2-what-to-identify-in-any-instability",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (i) Rayleigh\u2013Plateau (cylindrical thread \u2192 droplets)",
    "content": "Mechanism. A small bulge on a liquid thread lowers capillary pressure locally; liquid is drawn from the necks toward the bulge, further enlarging it\u2014positive feedback. Surface tension itself is the _driver_ (seeking to reduce area) yet also damps very short ripples, so a fastest\u2011growing wavelength emerges and sets droplet spacing. In inviscid limits, that spacing is order\u2011ten radii (qualitative memory worth keeping). What to look for. On a dripping faucet, you see the regular drop train because this instability picks a wavelength/time scale of breakup. ![](../../_Media/Lecture3-Instabilities-1761842080703.png) Cressey, D. 365 days: Images of the year. Nature 516, 304\u2013309 (2014) - image taken at [Physics of Fluids Department, University of Twente](https://pof.tnw.utwente.nl/).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#i-rayleighplateau-cylindrical-thread-droplets",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (ii) Kelvin\u2013Helmholtz (shear across an interface \u2192 billows)",
    "content": "Mechanism. Two fluids sliding past each other create a vorticity sheet at the interface. A ripple tilts that sheet and rolls it up into billows; shear feeding exceeds restoring forces. Surface tension and density contrast stabilize short waves and set a threshold for onset and a preferred scale. What to look for. In counter\u2011flowing layers (or the \u201cflag flapping\u201d movie on your slide set), once the interfacial shear is large enough, coherent vortical waves appear and then pair/roll up. ![](../../_Media/Lecture3-Instabilities-1761842604089.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#ii-kelvinhelmholtz-shear-across-an-interface-billows",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (iii) Rayleigh\u2013Taylor (heavy\u2011over\u2011light \u2192 spikes & bubbles)",
    "content": "Mechanism. Gravity pulls a heavy fluid down through a light one; a downward dent increases the hydrostatic pressure drop there and accelerates further\u2014positive feedback. Surface tension stabilizes short waves; the competition picks a dominant wavelength. Thin\u2011film variants (heavy film above air) yield honeycomb/hexagonal hole patterns. ![](../../_Media/Lecture3-Instabilities-1761842685134.png) Image by Shengtai Li, Hui Li - \"Parallel AMR Code for Compressible MHD or HD Equations\", Attribution, Link",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#iii-rayleightaylor-heavyoverlight-spikes-bubbles",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (iv) Faraday waves (vertical vibration \u2192 subharmonic surface patterns)",
    "content": "Mechanism. Parametric forcing periodically modulates the effective gravity; the flat surface becomes unstable to standing waves at half the drive frequency. Hexagons/stripes are common near onset. Use this as a canonical example of parametric (not spontaneous) instability and _pattern selection near threshold_.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#iv-faraday-waves-vertical-vibration-subharmonic-surface-patterns",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (v) Rayleigh\u2013B\u00e9nard\u2013Marangoni (heated film \u2192 rolls/hexagons)",
    "content": "Mechanism. Heating from below (buoyancy) or surface\u2011tension gradients along a free surface (Marangoni) drive cellular convection. Thin layers emphasize Marangoni; thicker ones emphasize buoyancy, flipping flow directions inside the cells. Amplitude/envelope equations near onset rationalize which planforms (rolls, hexagons) persist.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#v-rayleighb\u00e9nardmarangoni-heated-film-rollshexagons",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (vi) Saffman\u2013Taylor (viscous fingering in Hele\u2011Shaw cells)",
    "content": "Mechanism. A less viscous fluid pushing a more viscous one creates a pressure\u2011gradient focusing at finger tips (\u201ctip effect\u201d). Any protrusion experiences larger local pressure gradient and advances faster\u2014runaway growth\u2014while surface tension blunts the tip and limits short waves. Capillary number ($Ca = \\eta U/\\gamma$) summarizes the competition; channel geometry further selects finger width and number. In radial injection, secondary instabilities (tip\u2011splitting/side\u2011branching) govern the branching morphology.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#vi-saffmantaylor-viscous-fingering-in-heleshaw-cells",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - (vii) Viscous coiling & \u201cfluid mechanical sewing machine\u201d",
    "content": "Mechanism. A falling viscous thread buckles and coils from a balance of gravity, bending, stretching, and surface tension; on a moving belt the contact\u2011point dynamics introduce memory and rich states (coils, meanders, W\u2011patterns). Linear stability alone is insufficient\u2014nonlinear, geometry\u2011driven dynamics dominate far from threshold. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#vii-viscous-coiling-fluid-mechanical-sewing-machine",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 4) How to \u201cpredict\u201d without doing heavy math: Context",
    "content": "1. Force balance & scales. Ask which pair of effects compete: inertia vs capillarity (Weber number), viscous vs capillarity (capillary number), inertia vs viscosity (Reynolds number), gravity vs capillarity (Bond number), elasticity vs capillarity (elastocapillary mumber) or inertia in soft materials (elasticity number). These dimensionless groups flag likely instabilities and the direction of selection. 2. Dispersion\u2011curve picture (qualitative). Most interfacial problems have a \u201cbell\u2011shaped\u201d growth\u2011rate vs wavelength: short waves stabilized by surface tension/viscosity, long waves limited by the finite driving (e.g. pressure or gravity). The peak sets the emergent spacing observed in your videos/demos. (Keep this as a mental model.) ![](../../_Media/3-Soft-Matter-Instabilities-1761860668972.png) Sketch of the interfacial instabilities discussed in F. Gallaire & P-T. Brun, Philos. Trans. R. Soc. A, 375:2093, 20160155 (2017).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#4-how-to-predict-without-doing-heavy-math",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 4) How to \u201cpredict\u201d without doing heavy math: Context",
    "content": "DOI: [10.1098/rsta.2016.0155](https://doi.org/10.1098/rsta.2016.0155) The dispersion relation, $\\sigma$ is the growth rate and $k$ the wave vector, is provided when available. (a(i)\u2013a(iv)) Plateau\u2013Rayleigh instability, (b) Kelvin\u2013Helmoltz instability, (c(i),c(ii)) Rayleigh\u2013Taylor instability in two-phase flows and in a thin layer, (d) Faraday waves arising in a bath subject to periodic oscillatory forcing, (e) Rayleigh\u2013B\u00e9nard\u2013Marangoni instability obtained when heating up a thin layer of fluid, (\\*) hexagonal tilling, (f(i),f (ii)) plane and radial Saffman\u2013Taylor instability in a Hele\u2013Shaw cell, (g(i),g(ii)) capillary ridge instability and wine tears, (h) Kapitza waves and (i) viscous coiling, with the last three being examples of instabilities found in everyday life. (c(ii)),(d) and (e) typically arrange in patterns such as shown in (\\*). Taken from F. Gallaire & P-T. Brun, Philos. Trans. R. Soc. A, 375:2093, 20160155 (2017).",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#4-how-to-predict-without-doing-heavy-math",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 4) How to \u201cpredict\u201d without doing heavy math: Context",
    "content": "DOI: [10.1098/rsta.2016.0155](https://doi.org/10.1098/rsta.2016.0155) - Convective vs absolute. If a disturbance amplifies but is advected away, we get localized activity; if it grows in place, patterns fill the domain. This informs whether we expect clean, global patterns or drifting, patchy ones in experiments. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#4-how-to-predict-without-doing-heavy-math",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 5) From \u201cavoid\u201d to \u201cuse\u201d: harnessing instabilities: Engineers used to...",
    "content": "Engineers used to fear instabilities as failure modes. Soft\u2011matter physics repurposes them as fabrication tools: microfluidic emulsification (controlled Rayleigh\u2013Plateau), capillarity\u2011guided assembly of nanopillars (elastocapillary coalescence), and other self\u2011organization pathways. The mindset shift is to select initial/boundary conditions so the _natural_ instability builds the desired pattern. The inverse problem\u2014choosing those conditions up\u2011front\u2014is still an open research space. See: P-T. Brun, Shape formation in interfacial flows, Phys. Rev.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#5-from-avoid-to-use-harnessing-instabilities",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "3 soft matter instabilities - 5) From \u201cavoid\u201d to \u201cuse\u201d: harnessing instabilities: Fluids, 9:11, 110501...",
    "content": "Fluids, 9:11, 110501 (2024). [DOI: 10.1103/PhysRevFluids.9.110501](https://doi.org/10.1103/PhysRevFluids.9.110501) > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 30, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/3-Soft-Matter-Instabilities/#5-from-avoid-to-use-harnessing-instabilities",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox",
    "content": "> [!info] \ud83d\udcc4 PDF Version > [Download PDF](./1.5-Taylor-Culick-Paradox.pdf)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Lecture 1.5: The Taylor\u2013Culick Paradox \u2014 Where Did the Energy Go?",
    "content": "Resolving the Dupr\u00e9\u2013Rayleigh paradox through proper energy accounting and momentum conservation. This lecture bridges [[1-Intro-Soft-Matter|Lecture 1]]'s introduction to the paradox with a complete resolution. ![](../../_Media/1.5-Taylor-Culick-03.png) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#lecture-15-the-taylorculick-paradox-where-did-the-energy-go",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Introduction: The Unresolved Paradox",
    "content": "In Lecture 1, we encountered a puzzle: when you puncture a soap bubble, the film edge retracts inward with remarkable speed. Yet two seemingly correct physical approaches gave different predictions for this retraction velocity: $$\\text{Dupr\u00e9\u2013Rayleigh (Energy):} \\quad v = \\sqrt{\\frac{4\\gamma_{fa}}{\\rho h_0}} \\quad \\text{(disagreed with experiment)}$$ $$\\text{Taylor\u2013Culick (Momentum):} \\quad v = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}} \\quad \\text{(agreed with experiment)}$$ Question: If momentum conservation gives the right answer, why did energy conservation fail? Where did the missing energy go? This lecture resolves this paradox, which was finally answered convincingly by Pierre-Gilles de Gennes in 1996\u2014more than a century after Rayleigh's original observations. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#introduction-the-unresolved-paradox",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Rayleigh's Pioneering Work (1891)",
    "content": "![](../../_Media/1.5-Taylor-Culick-01.png) John William Strutt, 2nd Baron Rayleigh, used instantaneous photography to capture the dynamics of liquid jets and interfaces. In a remarkable 1891 paper, he observed breaking jets and proposed an energy-balance argument for the speed of film retraction: > Rate of surface energy decrease = Rate of kinetic energy increase Mathematically: $$\\frac{d}{dt}\\left(\\frac{1}{2}mv^2\\right) = 2\\gamma_{fa}(2\\pi R) v$$ This yielded: $$v_{\\text{Dupre-Rayleigh}} = \\sqrt{\\frac{4\\gamma_{fa}}{\\rho h_0}}$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#rayleighs-pioneering-work-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - A Curious Anomaly",
    "content": "Despite its elegant derivation, Rayleigh's prediction was faster than observed\u2014a factor of $\\sqrt{2}$ too fast. For nearly 70 years, this discrepancy puzzled the fluid mechanics community. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#a-curious-anomaly",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 1. The Energy Perspective (Dupr\u00e9 & Rayleigh, 1891): Context",
    "content": "![](../../_Media/1.5-Taylor-Culick-05.png) The energy balance assumes that all surface energy released goes into kinetic energy of the retracting film: Setup: A circular film of radius $R$, thickness $h_0$, with surface energy per interface $\\gamma_{fa}$.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#1-the-energy-perspective-dupr\u00e9-rayleigh-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 1. The Energy Perspective (Dupr\u00e9 & Rayleigh, 1891): Surface energy in...",
    "content": "Surface energy in the film: $$E_s = 2 \\cdot \\gamma_{fa} \\cdot (\\text{area}) = 2\\gamma_{fa} \\cdot 2\\pi R h_0$$ Rate of energy decrease: $$-\\frac{dE_s}{dt} = 2\\gamma_{fa} \\cdot 2\\pi \\frac{dR}{dt} \\cdot h_0 = -2\\gamma_{fa} \\cdot 2\\pi h_0 v_f$$ (Negative because $\\frac{dR}{dt} = -v_f$ as radius shrinks) Kinetic energy of moving film: $$E_k = \\frac{1}{2}m v_f^2 = \\frac{1}{2}\\rho V v_f^2 = \\frac{1}{2}\\rho (2\\pi R h_0) v_f^2$$ Energy conservation: $$\\frac{dE_k}{dt} = 2\\gamma_{fa} \\cdot 2\\pi h_0 v_f$$ $$\\frac{d}{dt}\\left[\\frac{1}{2}\\rho (2\\pi R h_0) v_f^2\\right] = 4\\pi \\gamma_{fa} h_0 v_f$$ Assuming constant velocity $v_f$ (steady-state retraction): $$\\frac{1}{2}\\rho \\cdot 2\\pi h_0 \\cdot (2v_f \\cdot v_f) + \\rho 2\\pi h_0 v_f \\cdot v_f = 4\\pi \\gamma_{fa} h_0 v_f$$ Wait\u2014this is subtle. Let me reconsider carefully. The mass of the rim changes as material flows into it from the retracting film.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#1-the-energy-perspective-dupr\u00e9-rayleigh-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 1. The Energy Perspective (Dupr\u00e9 & Rayleigh, 1891): Correct energy approach...",
    "content": "Correct energy approach (accounting for mass flux): Energy released per unit time: $$\\dot{E}_{released} = 2 \\cdot \\gamma_{fa} \\cdot 2\\pi R \\cdot v_f$$ This energy goes into: 1. Kinetic energy of material in the rim (moving at velocity $v_f$) 2. Heat dissipation (if any) If we assume all energy becomes kinetic: $$\\frac{1}{2}\\frac{dm}{dt}v_f^2 = 2\\gamma_{fa} \\cdot 2\\pi R \\cdot v_f$$ The mass flux into the rim: $$\\frac{dm}{dt} = \\rho \\cdot (2\\pi R) \\cdot h_0 \\cdot v_f$$ Substituting: $$\\frac{1}{2}\\rho (2\\pi R h_0) v_f^2 \\cdot v_f = 4\\pi \\gamma_{fa} R v_f$$ $$v_f^2 = \\frac{4\\gamma_{fa}}{\\rho h_0}$$ $$\\boxed{v_f = \\sqrt{\\frac{4\\gamma_{fa}}{\\rho h_0}}} \\quad \\text{(Dupr\u00e9\u2013Rayleigh prediction)}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#1-the-energy-perspective-dupr\u00e9-rayleigh-1891",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 2. The Momentum Perspective (G. I. Taylor, 1959): Context",
    "content": "![](../../_Media/1.5-Taylor-Culick-08.png) G. I. Taylor (1905\u20131975), one of the greatest fluid mechanicists, approached the problem differently: he used momentum conservation instead of energy. Newton's second law: Force = Rate of momentum change Forces on the film: - Surface tension acts on the perimeter of the film at both interfaces - Total force: $F = 2\\gamma_{fa}(2\\pi R)$ (pointing inward, opposing motion) Rate of momentum change: The film is being pulled inward by surface tension.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#2-the-momentum-perspective-g-i-taylor-1959",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 2. The Momentum Perspective (G. I. Taylor, 1959): The material in...",
    "content": "The material in the rim has momentum $p = mv$. $$\\frac{dp}{dt} = 2\\gamma_{fa}(2\\pi R)$$ For material flowing into the rim at velocity $v_f$: $$\\frac{d}{dt}(mv_f) = 2\\gamma_{fa}(2\\pi R)$$ This gives: $$v_f \\frac{dm}{dt} + m\\frac{dv_f}{dt} = 2\\gamma_{fa}(2\\pi R)$$ Assuming steady-state ($\\frac{dv_f}{dt} = 0$) and $\\frac{dm}{dt} = \\rho (2\\pi R) h_0 v_f$: $$v_f \\cdot \\rho (2\\pi R) h_0 v_f = 2\\gamma_{fa}(2\\pi R)$$ $$\\rho h_0 v_f^2 = 2\\gamma_{fa}$$ $$\\boxed{v_f = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}}} \\quad \\text{(Taylor\u2013Culick prediction)}$$ Remarkable fact: Taylor's prediction agrees with experiments! This immediately suggested that the energy approach was wrong\u2014but why? ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#2-the-momentum-perspective-g-i-taylor-1959",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - 3. The Missing Link: Inelastic Collision (de Gennes, 1996)",
    "content": "![](../../_Media/1.5-Taylor-Culick-13.png) Pierre-Gilles de Gennes, a master of soft matter physics (Nobel Prize 1991), provided the decisive resolution in a 1996 *Faraday Discussion* paper: > [!important] The Key Insight > > The film material does not smoothly flow into the retracting rim. Instead, it collides inelastically with the rim, dissipating energy. This is a plastic collision, not an elastic process.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#3-the-missing-link-inelastic-collision-de-gennes-1996",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Energy Budget with Dissipation",
    "content": "When the soap film retracts, the material at the film edge joins the rim. This material transition is inelastic: - Before collision: Film material moves inward at velocity $v_f$ - After collision: It joins the rim, which is also moving at $v_f$ - Energy dissipated: The \"thickness\" direction has an inelastic collision component ![](../../_Media/1.5-Taylor-Culick-14.png) The energy dissipation rate from the inelastic collision: $$\\dot{E}_{dissipated} = \\frac{1}{2}\\frac{dm}{dt}v_f^2$$ This is exactly the kinetic energy of the material losing its transverse motion as it merges into the rim. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#energy-budget-with-dissipation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Complete Energy Balance",
    "content": "Let's now account for all energy flows: Energy released by surface tension: $$\\dot{E}_{released} = 2\\gamma_{fa} \\cdot 2\\pi R \\cdot v_f = 4\\pi \\gamma_{fa} R v_f$$ Energy dissipated (inelastic collision): $$\\dot{E}_{dissipated} = \\frac{1}{2}\\frac{dm}{dt}v_f^2 = \\frac{1}{2}\\rho (2\\pi R h_0) v_f \\cdot v_f^2 = \\pi \\rho R h_0 v_f^3$$ Energy conservation (with dissipation): $$\\dot{E}_{released} = \\dot{E}_{dissipated} + \\dot{E}_{kinetic}$$ $$4\\pi \\gamma_{fa} R v_f = 2\\pi \\rho R h_0 v_f^3$$ $$2\\gamma_{fa} = \\rho h_0 v_f^2$$ $$\\boxed{v_f = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}}} \\quad \\text{(Corrected energy prediction!)}$$ ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#complete-energy-balance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Resolving the Apparent Contradiction",
    "content": "The resolution lies in momentum conservation vs. energy conservation:",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#resolving-the-apparent-contradiction",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Why Momentum Conservation Works",
    "content": "Momentum balance directly applies regardless of dissipation: $$\\text{Force} = \\frac{dp}{dt}$$ This is valid whether the process is elastic or inelastic. The surface tension force acts on the film perimeter, and momentum is conserved: $$v_f = \\sqrt{\\frac{2\\gamma_{fa}}{\\rho h_0}} \\quad \\checkmark$$",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#why-momentum-conservation-works",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Why the Original Energy Balance Failed",
    "content": "The error in the Dupr\u00e9\u2013Rayleigh approach was assuming that only kinetic energy matters. $$2\\gamma_{fa} \\cdot 2\\pi R \\cdot v_f = \\frac{d}{dt}\\left[\\frac{1}{2}m v_f^2\\right]$$ But this neglected dissipation as the film material is \"compressed\" into the rim. The correct energy balance is: $$2\\gamma_{fa} \\cdot 2\\pi R \\cdot v_f = \\frac{d}{dt}\\left[\\frac{1}{2}m v_f^2\\right] + \\dot{E}_\\text{dissipation}$$ The \"missing\" energy $\\dot{E}_{internal}$ goes into: - Deforming the fluid from a thin film to the thicker rim - Viscous dissipation at high shear rates - Acoustic waves (shock waves in the fluid) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#why-the-original-energy-balance-failed",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - The Ohnesorge Number and Flow Regimes",
    "content": "The dynamics of film retraction depend on the balance between surface tension (driving the flow) and viscosity (resisting it). ![](../../_Media/1.5-Taylor-Culick-11.png) Ohnesorge number: $$Oh = \\frac{\\eta}{\\sqrt{\\rho \\gamma_{fa} h_0}}$$ where $\\eta$ is the dynamic viscosity. - Low $Oh$ regime: Inertia-dominated, momentum conservation dominates - High $Oh$ regime: Viscous-dominated, viscous stresses important The classical Taylor\u2013Culick speed $v_f = \\sqrt{2\\gamma_{fa}/(\\rho h_0)}$ applies in the low-$Oh$ (inertial) regime. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#the-ohnesorge-number-and-flow-regimes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Experimental Validation and Simulations",
    "content": "Modern high-speed imaging and numerical simulations have beautifully confirmed the resolution: Key observations: - Bursting films retract at speeds very close to Taylor's prediction - Velocity field shows strong acceleration from rest to $v_f$ - Dissipation concentrates near the retracting edge (the rim region) - The flow becomes increasingly complex at high Oh (viscoelastic effects emerge) ![](../../_Media/1.5-Taylor-Culick-16.png) Simulations reveal that the velocity profile is not uniform\u2014there's acceleration from the edge into the rim, and stress concentrations that lead to localized dissipation. --- ![](../../_Media/1.5-Taylor-Culick-17.png)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#experimental-validation-and-simulations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Historical Timeline and Key References",
    "content": "| Year | Contributor | Contribution | |------|---|---| | 1891 | Rayleigh | First observation and energy-balance prediction | | 1959 | G. I. Taylor | Momentum-balance approach; predicts $v = \\sqrt{2\\gamma/(\\rho h_0)}$ | | 1960 | F. E. C. Culick | Independent confirmation; bubble breakup dynamics | | 1996 | P.-G. de Gennes | Complete resolution via inelastic collision and energy dissipation | > [!note] On the importance of this problem > The Taylor\u2013Culick paradox exemplifies a deep principle: momentum conservation is always valid, but energy conservation requires accounting for dissipation mechanisms. This lesson transfers to many soft matter phenomena where interfaces dominate. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#historical-timeline-and-key-references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Key Takeaways: Context",
    "content": "1. Momentum conservation is robust. The Taylor\u2013Culick speed $v_f = \\sqrt{2\\gamma_{fa}/(\\rho h_0)}$ follows directly from force balance and does not depend on details of energy dissipation. 2. Energy dissipation is not negligible. The naive energy-balance approach fails because it ignores the inelastic collision process\u2014energy is *not* smoothly converted to kinetic energy alone. 3. Multiple equilibrium approaches. For the same physical process, different conservation laws give different perspectives. Momentum is fundamental; energy requires accounting for all sinks. 4. Time and dissipation matter. In soft matter, the rate of process (viscosity, Ohnesorge number) critically determines dynamics. Fast retraction (low Oh) is momentum-dominated; slow retraction (high Oh) is viscous-dominated. 5. Paradoxes resolve through careful accounting. Many apparent contradictions in physics arise from incomplete accounting of energy or momentum sinks/sources.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Key Takeaways: Always ask: \"Where...",
    "content": "Always ask: \"Where did the energy/momentum go?\" ![](../../_Media/1.5-Taylor-Culick-18.png) ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Primary Literature",
    "content": "- G. I. Taylor, *Proc. R. Soc. A*, 253, 313\u2013321 (1959) \u2014 Classic momentum-balance derivation - F. E. C. Culick, *J. Appl. Phys.*, 31, 1128 (1960) \u2014 Experimental confirmation - P.-G. de Gennes, *Faraday Discuss.*, 104, 1\u20138 (1996) \u2014 Energy dissipation and resolution - N. Savva & J. W. M. Bush, *J. Fluid Mech.*, 626, 211\u2013240 (2009) \u2014 Modern computational studies",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#primary-literature",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Supplementary Materials",
    "content": "- [Dupr\u00e9\u2013Rayleigh paradox (PDF)](Dupre-Rayleigh-paradox.pdf) \u2014 Comprehensive reference document on the paradox resolution ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#supplementary-materials",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Connection to Lecture 2",
    "content": "This resolution of the Taylor\u2013Culick paradox illustrates the power of conservation laws in fluid mechanics. In Lecture 2, we will develop a systematic framework for: - Conservation of momentum \u2192 Euler and Navier\u2013Stokes equations - Conservation of energy \u2192 Thermodynamics and dissipation - Continuum mechanics \u2192 Coarse-grained descriptions of soft matter Understanding *why* momentum conservation works (even when energy accounting is subtle) is central to soft matter hydrodynamics. ---",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#connection-to-lecture-2",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Homework (Self-Assessed): > [!check] Reflection...",
    "content": "> [!check] Reflection Questions > > Q1. In the energy-balance approach, why does neglecting dissipation lead to a speed that's $\\sqrt{2}$ times faster than observed? > > Q2. Explain in words why momentum conservation \"just works\" even though energy dissipation is important. Why is momentum balance insensitive to the details of how energy is dissipated? > > Q3. Consider a highly viscous soap film (large $\\eta$, large Ohnesorge number). Would you expect the retraction speed to be faster or slower than Taylor's prediction? Explain your reasoning using scaling arguments. > > Q4.",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#homework-self-assessed",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "1.5 taylor culick paradox - Homework (Self-Assessed): Design a thought...",
    "content": "Design a thought experiment or simple calculation to estimate the fraction of released surface energy that goes into: > - (a) Kinetic energy of the rim > - (b) Dissipation (heating, deformation) --- --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Oct 28, 2025 > Date modified:: Oct 30, 2025 > [!link] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox.md)",
    "url": "https://blogs.comphy-lab.org/Lecture-Notes/Intro-Soft-Matter/1.5-Taylor-Culick-Paradox/#homework-self-assessed",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Herschel\u2013Bulkley formulation for non-Newtonian flows",
    "content": "> [!tldr] TL;DR > The Herschel\u2013Bulkley model unifies Newtonian, Bingham, and power-law fluids via a yield stress and a strain-rate-dependent viscosity. An \ufffc$\\epsilon$-regularization ensures stable computations and recovers simpler models (Newtonian, Bingham) by tuning model parameters. Dimensionless groups (e.g., the plasto-capillary number \ufffc and the effective Ohnesorge) capture the interplay of fluid rheology, capillarity, and flow scales. Implementation details are provided, along with references, open-source code, and demonstrations of bubble-burst simulations in viscoplastic media.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#herschelbulkley-formulation-for-non-newtonian-flows",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Features:",
    "content": "* Yield stress $\\tau_y$ * Power law dependance on the strain rate * Shear thinning for $n 1$. * Bingham model for $n = 1$. * Newtonian fluid for $n = 1$ and $\\tau_y = 0$.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#features",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - $\\varepsilon$-formulation: $$ \\boldsymbol{\\tau} =...",
    "content": "$$ \\boldsymbol{\\tau} = \\tau_{y}\\,\\boldsymbol{\\mathcal{I}} \\;+\\; K\\left(2\\boldsymbol{\\mathcal{D}}\\right)^{n} = 2\\biggl[\\frac{\\tau_{y}}{2\\|\\boldsymbol{\\mathcal{D}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + K\\,\\bigl(2\\|\\boldsymbol{\\mathcal{D}}\\|+\\epsilon\\bigr)^{n-1} \\biggr]\\boldsymbol{\\mathcal{D}}. $$ Normalizing stresses with $\\gamma/R_0$, length with $R_0$, and velocity with $\\sqrt{\\gamma/\\rho_lR_0}$... $$ \\boldsymbol{\\tilde{\\tau}} = 2\\biggl[\\frac{\\mathcal{J}}{2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + Oh_K\\,\\bigl(2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\epsilon\\bigr)^{n-1} \\biggr]\\boldsymbol{\\tilde{\\mathcal{D}}}. $$ Here, the effective Ohnesorge is $$ Oh_K = \\frac{K}{\\sqrt{\\rho_l^n\\gamma^{2-n}R_0^{3n-2}}} $$ The plasto-capillary number $\\mathcal{J}$ is $$\\mathcal{J} = \\frac{\\tau_yR_0}{\\gamma}$$ One can easily see that putting $n = 1$ recovers the Bingham model with $Oh = \\eta_l/\\sqrt{\\rho_l\\gamma R_0}$.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#varepsilon-formulation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - $\\varepsilon$-formulation: Additionally, with $n...",
    "content": "Additionally, with $n = 1$ & $\\mathcal{J}$ = 0, the model will give a `Newtonian` response.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#varepsilon-formulation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Calculate the norm of the deformation tensor $\\boldsymbol{\\mathcal{D}}$:: $$\\mathcal{D}_{11} = \\frac{\\partial...",
    "content": "$$\\mathcal{D}_{11} = \\frac{\\partial u_r}{\\partial r}$$ $$\\mathcal{D}_{22} = \\frac{u_r}{r}$$ $$\\mathcal{D}_{13} = \\frac{1}{2}\\left( \\frac{\\partial u_r}{\\partial z}+ \\frac{\\partial u_z}{\\partial r}\\right)$$$$\\mathcal{D}_{31} = \\frac{1}{2}\\left( \\frac{\\partial u_z}{\\partial r}+ \\frac{\\partial u_r}{\\partial z}\\right)$$ $$\\mathcal{D}_{33} = \\frac{\\partial u_z}{\\partial z}$$ $$\\mathcal{D}_{12} = \\mathcal{D}_{23} = 0.$$ The second invariant is $\\mathcal{D}_2=\\sqrt{\\mathcal{D}_{ij}\\mathcal{D}_{ij}}$ (this is the Frobenius norm) $$\\mathcal{D}_2^2= \\mathcal{D}_{ij}\\mathcal{D}_{ij}= \\mathcal{D}_{11}\\mathcal{D}_{11} + \\mathcal{D}_{22}\\mathcal{D}_{22} + \\mathcal{D}_{13}\\mathcal{D}_{31} + \\mathcal{D}_{31}\\mathcal{D}_{13} + \\mathcal{D}_{33}\\mathcal{D}_{33}$$ Note: $\\|\\mathcal{D}\\| = D_2/\\sqrt{2}$.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#calculate-the-norm-of-the-deformation-tensor-boldsymbolmathcald",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Calculate the norm of the deformation tensor $\\boldsymbol{\\mathcal{D}}$:: We use the...",
    "content": "We use the formulation as given in [Balmforth et al. (2013)](https://www.annualreviews.org/doi/pdf/10.1146/annurev-fluid-010313-141424) [1], who use the strain rate tensor $\\boldsymbol{\\dot{\\mathcal{S}}}$ which and its norm $\\sqrt{\\frac{1}{2}\\dot{\\mathcal{S}_{ij}}\\dot{\\mathcal{S}_{ij}}}$. Of course, given $\\dot{\\mathcal{S}}_{ij}=2 D_{ij}$.",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#calculate-the-norm-of-the-deformation-tensor-boldsymbolmathcald",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Calculate the equivalent viscosity",
    "content": "Factorizing with $2 \\mathcal{D}_{ij}$ to obtain an equivalent viscosity $$\\eta_{\\text{eff}} = \\frac{\\mathcal{J}}{2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + Oh_K\\,\\bigl(2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\epsilon\\bigr)^{n-1} $$ In this formulation, $\\varepsilon$ is a small number to ensure numerical stability. The term $$\\frac{\\tau_y}{\\varepsilon} + ...$$is equivalent to the $\\mu_{max}$ of the previous (v1.0, see: [GitHub](https://github.com/VatsalSy/Bursting-Bubble-In-a-Viscoplastic-Medium)) formulation [2]. Note: The fluid flows always, it is not a solid, but a very viscous fluid. Reproduced from: [P.-Y. Lagr\u00e9e's Sandbox](http://basilisk.fr/sandbox/M1EMN/Exemples/bingham_simple.c). Here, we use a face implementation of the regularisation method, described [here](http://basilisk.fr/sandbox/vatsal/GenaralizedNewtonian/Couette_NonNewtonian.c). ---",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#calculate-the-equivalent-viscosity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - Video showcasing a typical simulation of bubble bursting in a Herschel\u2013Bulkley fluid medium",
    "content": "[Open on YouTube](https://youtu.be/NmvCVsiEZIA)",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#video-showcasing-a-typical-simulation-of-bubble-bursting-in-a-herschelbulkley-fluid-medium",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - More resources",
    "content": "| [GitHub](https://github.com/comphy-lab/BurstingBubble_Herschel-Bulkley) | [Demo](https://youtu.be/NmvCVsiEZIA) | [License](https://github.com/comphy-lab/BurstingBubble_Herschel-Bulkley/blob/main/LICENSE) | [Latest Changes](https://github.com/comphy-lab/BurstingBubble_Herschel-Bulkley/commits/main) | [[2025-Herschel\u2013Bulkley-formulation.pdf\\|pdf]] | | :---------------------------------------------------------------------: | :----------------------------------: | :----------------------------------------------------------------------------------------: | :------------------------------------------------------------------------------------------: | ----------------------------------------- |",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#more-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 herschel\u2013bulkley formulation - References",
    "content": "[1] N. J. Balmforth, I. A. Frigaard, and G. Ovarlez, \u201cYielding to Stress: Recent Developments in Viscoplastic Fluid Mechanics,\u201d _Annu. Rev. Fluid Mech._, vol. 46, pp. 121\u2013146, Jan. 2014, doi: [10.1146/annurev-fluid-010313-141424](https://doi.org/10.1146/annurev-fluid-010313-141424). [2] V. Sanjay, D. Lohse, and M. Jalaal, \u201cBursting bubble in a viscoplastic medium,\u201d _J. Fluid Mech._, vol. 922, p. A2, 2021. > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Dec 31, 2024 > Date modified:: Jan 26, 2025 at 11:50 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab)",
    "url": "https://blogs.comphy-lab.org/Code-Documentations/2025-Herschel\u2013Bulkley-formulation/#references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - The role of viscosity on drop impact forces on non-wetting surfaces: From Raindrops to Inkjet Printing: When a liquid...",
    "content": "When a liquid drop hits a surface, the impact creates fascinating fluid dynamics that are crucial for applications ranging from inkjet printing to agricultural sprays. In this work, we uncover how a liquid's viscosity dramatically affects the forces generated during these impacts. Let's explore the key findings. ![[_Media/JFM-viscous-drop-impact-blog-1740211822831.png]] > [!tldr] TL;DR > Viscosity alters the forces a liquid drop exerts when it strikes a non-wetting surface, shifting the balance from inertia-dominated (like water) to enhanced viscous effects (like honey). Two force peaks arise: one at the initial impact and another tied to the Worthington jet just before bounce. Dimensionless numbers (Weber and Ohnesorge) govern these regimes, showing why higher-viscosity drops can yield unexpectedly large forces.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#the-role-of-viscosity-on-drop-impact-forces-on-non-wetting-surfaces-from-raindrops-to-inkjet-printing",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - The role of viscosity on drop impact forces on non-wetting surfaces: From Raindrops to Inkjet Printing: The findings unify...",
    "content": "The findings unify scaling laws across viscosities, guiding applications in printing, agriculture, and beyond, and pointing to future inquiries on soft surfaces and non-Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#the-role-of-viscosity-on-drop-impact-forces-on-non-wetting-surfaces-from-raindrops-to-inkjet-printing",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - The Basics: What Happens When a Drop Hits a Surface?",
    "content": "> [!note] Key Point > On a non-wetting surface, a drop goes through distinct phases: impact, spreading, retracting, and sometimes bouncing off. During this process, the surface experiences varying forces that can now be precisely measured and predicted. The impact process reveals two distinct force peaks: 1. An initial peak when the drop first hits 2. A second peak just before the drop potentially bounces off What makes this especially interesting is how these forces change based on two key properties: - Weber number ($We = \\rho V_0^2D_0/\\gamma$): Measures the dimensionless kinetic energy of the impacting drop. - Ohnesorge number ($Oh = \\eta/\\sqrt{\\rho\\gamma D_0}$): Represents the dimensionless viscosity of the impacting drop.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#the-basics-what-happens-when-a-drop-hits-a-surface",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - The First Impact: A Tale of Two Regimes",
    "content": "> [!important] First Peak Findings > The study reveals that the first impact force follows distinctly different patterns depending on the liquid's viscosity: > - For low viscosity liquids (like water), the force mainly depends on inertia > - For high viscosity liquids (like honey), viscous effects create stronger forces than expected",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#the-first-impact-a-tale-of-two-regimes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Low Viscosity Behavior",
    "content": "For liquids with low viscosity ($Oh < 0.1$), the first impact force ($F_1$) scales with the inertial force: $$ F_1 \\sim \\rho V_0^2D_0^2 $$ where $\\rho$ is density, $V_0$ is impact velocity, and $D_0$ is drop diameter. This relationship holds remarkably well for viscosities up to 100 times that of water!",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#low-viscosity-behavior",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - High Viscosity Surprises",
    "content": "When viscosity becomes significant ($Oh > 0.1$), the force increases beyond what inertia alone would predict: $$ F_1 \\sim \\rho V_0^2D_0^2\\sqrt{Oh} $$ This enhancement occurs because viscous forces resist the drop's deformation, leading to higher impact pressures.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#high-viscosity-surprises",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - The Second Peak: Worthington Jets and Bouncing",
    "content": "> [!note] Worthington Jet > The second force peak coincides with a fascinating phenomenon called a Worthington jet - a thin liquid column that can shoot upward just before the drop bounces off. The second peak reveals an intricate balance between different forces: - For low viscosity and high speed impacts: Force scales with inertia - For low speed impacts: Surface tension dominates - At a special condition ($We \\approx 9$, $Oh < 0.01$): A `singular` jet forms with surprisingly high forces ![[_Media/JFM-viscous-drop-impact-blog-1740211923766.png]]",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#the-second-peak-worthington-jets-and-bouncing",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Practical Implications",
    "content": "> [!important] Applications > These findings have direct applications in: > - Inkjet printing: Controlling droplet behavior > - Agricultural sprays: Optimizing pesticide application > - Respiratory disease transmission: Understanding droplet impacts > - Industrial cooling: Enhancing heat transfer through controlled droplet impacts",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#practical-implications",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Future Research Directions",
    "content": "This work opens several interesting avenues for future investigation: - Unifying theories for maximum spread diameter across all viscosities - Understanding impact forces on soft or compliant surfaces - Extending findings to non-Newtonian fluids like polymer solutions",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#future-research-directions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Technical Significance",
    "content": "> [!note] For the technically inclined > The study provides a comprehensive framework for predicting impact forces through dimensionless numbers and scaling laws. For researchers working in this field, the paper presents new scaling laws that unify previous observations and provide a foundation for future work. The careful experimental validation combined with theoretical analysis makes this a significant contribution to our understanding of drop impact dynamics. > [!faq] Original Paper > V. Sanjay, B. Zhang, C. Lv & D. Lohse, The role of viscosity on drop impact forces, J. Fluid Mech., 1004, A6 (2025) [Open Access](https://doi.org/10.1017/jfm.2024.982).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#technical-significance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Cover of J. Fluid Mech. vol 1004",
    "content": "![[_Media/JFM-viscous-drop-impact-blog-1740211513533.jpg]]",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#cover-of-j-fluid-mech-vol-1004",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscous drop impact - Videos",
    "content": "--- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Feb 22, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-JFM-viscous-drop-impact.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-viscous-drop-impact/#videos",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Features of capillary waves during asymmetric bubble coalescence: > [!tldr] TL;DR...",
    "content": "> [!tldr] TL;DR > During the coalescence of bubbles with different sizes, the speed of the ensuing capillary waves remains almost unchanged and scales with the inertio\u2010capillary velocity. However, the strength (or curvature) of these waves depends on the bubble size ratio. In the equal\u2010sized case, the wave curvature diminishes and then plateaus, whereas for highly asymmetric (large vs. tiny) bubbles, the curvature initially decreases but then rebounds sharply due to the changing geometry. Two approximate scaling laws emerge for the strongest wave curvature: \ufffc in the low\u2010viscosity limit and \ufffc in the moderate\u2010to\u2010higher viscosity regime. Experimental data diverge somewhat from these simple power laws, indicating a need for refined models to explain the distinct curvature behavior at low Ohnesorge numbers. ![Fig-1_schematic](_Media/20250112214056729_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 1. Schematic of asymmetric coalescence of bubbles.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#features-of-capillary-waves-during-asymmetric-bubble-coalescence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Features of capillary waves during asymmetric bubble coalescence: Following the coalescnece,...",
    "content": "Following the coalescnece, train of capillary waves travel on the surface of both bubbles.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#features-of-capillary-waves-during-asymmetric-bubble-coalescence",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Control parameters",
    "content": "Ohnesorge number (ratio of the inertio-capillary and inertio-viscous timescales) $$ Oh = \\frac{\\eta_l}{\\sqrt{\\rho_l\\gamma R_0}} $$ Asymmetry parameter (ratio of the radii of the two bubbles) $$ \\chi = \\frac{R}{r} $$",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#control-parameters",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Coalescence of equal sized bubbles ($R = r$)",
    "content": "[Open on YouTube](https://youtu.be/Bm4qC0BSGkc)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#coalescence-of-equal-sized-bubbles-r-r",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Coalescence of tiny bubbles with extremely large ones ($R \\gg r$)",
    "content": "[Open on YouTube](https://youtu.be/QbQ4wrTjTks)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#coalescence-of-tiny-bubbles-with-extremely-large-ones-r-gg-r",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Looking at the speed of the capillary waves",
    "content": "> [!important] > The velocity of this capillary waves still scales with the inertio-capillary velocity! ![Fig-2_waveTrajectory](_Media/20250112214130458_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 2. Trajectory of the capillary waves during coalescence of same sized bubbles ($R = r$). Different colors represent different Ohnesorge numbers $Oh$. ![Fig-3_waveSpeed](_Media/20250112214151030_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 3. Trajectory of the capillary waves during coalescence of same unequal sized bubbles with $R \\gg r$. Different colors represent different Ohnesorge numbers $Oh$. > [!note] > Infact the velocity hardly changes from $R = r$ to $R \\gg r$",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#looking-at-the-speed-of-the-capillary-waves",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Strength of capillary waves for $R = r$",
    "content": "Although the speed of capillary waves remain the same. There can be differences in the strength of the waves. ![Fig-4_capillary-waves-Same-sized](_Media/20250112214226072_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 4. The curvature of the strongest capillary wave decreases in time and then saturates to a constant value. This is different from what happens at $R \\gg r$, ![Fig-5_capillary-waves-champagne-bubbles](_Media/20250112214243110_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 5. The curvature of the strongest capillary wave decreases in time, reaches a minima, and then increases sharply as the bubble cavity configuration changes (see video above, and also see [1]).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#strength-of-capillary-waves-for-r-r",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Can we understand this change in curvature?: Results",
    "content": "Given the asymmetry at $R \\gg r$, the waves have this feature to come back up and the curvature increases whereas for $R = r$ symmetry of the problem results in no significant geometry change following flow focussing and the curvature does not further increase. Looking at the balance between the kinetic energy (generated immediately following the coalescence event), $$ \\frac{d}{d\\tau}\\int_{\\Omega_\\kappa}\\frac{\\rho V^2}{2}d\\Omega_\\kappa \\sim 2\\eta\\int_{\\Omega_\\eta}\\left(\\boldsymbol{\\mathcal{D}:\\mathcal{D}}\\right)d\\Omega_\\eta $$ Note: Here, we balance the kinetic energy of the capillary waves (across volume $\\Omega_\\kappa$) with viscous dissipation across the bulk volume $\\Omega_\\eta$ where velocity gradients are non-zero.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#can-we-understand-this-change-in-curvature",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Can we understand this change in curvature?: Consequently, the volume...",
    "content": "Consequently, the volume scale associated with the kinetic energy carried by the waves is $\\Omega_\\kappa \\sim R\\kappa^{-2}$ and the dissipation volume scales as $\\Omega_\\eta \\sim R\\delta_\\eta^2$ where $\\delta_\\eta$ is the viscous boundary layer attached to the free-surface where velocity gradients are highest (see the videos above, the dark regions in visocus dissipation function characterize $\\Omega_\\eta$ and high velocity regions indicate $\\Omega_\\kappa$) $$ \\frac{1}{\\tau}\\rho V^2 R\\kappa^{-2} \\sim \\eta\\left(\\frac{V}{\\kappa^{-1}}\\right)^2R\\delta^2 $$ Rearranging the above equation, we can find the time scale associated with this transfer process: $$ \\tau \\sim \\frac{\\rho}{\\eta}\\frac{\\kappa^{-4}}{\\delta^2} $$",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#can-we-understand-this-change-in-curvature",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - Rearranging the expression and substituting inertio-capillary timescale",
    "content": "$$ \\kappa^4\\delta^2 \\sim \\frac{\\rho}{\\eta}\\sqrt{\\frac{\\gamma}{\\rho R^3}} $$ Normalize both sides by $R^2$, $$ \\tilde{\\kappa}^4\\tilde{\\delta}^2 \\sim \\frac{\\sqrt{\\rho\\gamma R}}{\\eta} $$",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#rearranging-the-expression-and-substituting-inertio-capillary-timescale",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - In the low viscosity limit,",
    "content": "$\\delta \\sim \\kappa^{-1}$, which giving $$ \\tilde{\\kappa} \\sim Oh^{-1/2} $$",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#in-the-low-viscosity-limit",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - In moderate high viscosity limit,: $$ \\delta \\sim...",
    "content": "$$ \\delta \\sim \\sqrt{\\frac{\\eta}{\\rho}t} = \\sqrt{\\frac{\\eta}{\\rho}\\left(\\frac{\\rho\\kappa^{-3}}{\\gamma}\\right)^{1/2}} $$ Rearranging the expression and filling in the general equation relating $\\kappa$ and $\\delta$ gives $$ \\tilde{\\kappa}^{5/2} \\sim \\frac{\\rho\\gamma R}{\\eta^2} $$ or, $$ \\tilde{\\kappa} \\sim Oh^{-4/5} $$ ![Fig-6_curvatureAndOh-R](_Media/20250112214304930_Features-of-capillary-waves-during-asymmetric-bubble-coalescence.png) Figure 6. Minumum curvature of the strongest capillary wave as a function of the Ohnesorge number and the radii ratio of the two bubbles. The two scaling relations developed above are reasonable but the deviations observed in the data leave room for improvement. > [!cite] Note: > The scaling laws developed here are also described in detail in [2] So, why does the radii ratio influence the curvature strongly but not the wave speed? Unfortunately, this is still an open question.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#in-moderate-high-viscosity-limit",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - In moderate high viscosity limit,: The hand-wavy argument...",
    "content": "The hand-wavy argument is given in this document (including the geometric and asymmetry arguments) but the scaling laws developed here only work approximately and clearly the data for $Oh \\to 0$ shows deviation in curvature. #foodForThought",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#in-moderate-high-viscosity-limit",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - More resources: Context",
    "content": "| [GitHub](https://github.com/VatsalSy/Asymmetries-in-coalescence) | [License](https://github.com/VatsalSy/Asymmetries-in-coalescence/blob/main/LICENSE) | [Latest Changes](https://github.com/VatsalSy/Asymmetries-in-coalescence/commits/main) | [[2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence.pdf\\|pdf]] | | :--------------------------------------------------------------: | :---------------------------------------------------------------------------------: | :-----------------------------------------------------------------------------------: | ----------------------------------------------------------------------------- | [1] V. Sanjay, D. Lohse, and M. Jalaal, \u201cBursting bubble in a viscoplastic medium,\u201d _J. Fluid Mech._, vol. 922, p. A2, 2021. [2] J. M. Gordillo and J. Rodr\u00edguez-Rodr\u00edguez, \u201cCapillary waves control the ejection of bubble bursting jets,\u201d _J.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#more-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 features of capillary waves during asymmetric bubble coalescence - More resources: Context",
    "content": "Fluid Mech._, vol. 867, pp. 556\u2013571, May 2019, doi: [10.1017/jfm.2019.161](https://doi.org/10.1017/jfm.2019.161). > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Jan 12, 2025 > Date modified:: Jan 26, 2025 at 11:50 CET > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Features-of-capillary-waves-during-asymmetric-bubble-coalescence/#more-resources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Executive Summary: - Trailblazer in...",
    "content": "- Trailblazer in Mathematics: Emmy Noether (1882\u20131935) overcame early 20th-century gender barriers in academia to become one of the first women awarded a PhD in mathematics - Symmetry and Conservation: She discovered that every continuous symmetry in nature corresponds to a conserved quantity \u2013 a profound insight now known as Noether's theorem - Universal Examples: Spatial symmetry (physics laws identical everywhere) gives rise to momentum conservation; time symmetry (laws identical at all times) gives rise to energy conservation - A Brief but Transformative Life: Despite dying at just 53, she revolutionized both theoretical physics and abstract algebra, leaving a legacy that continues to guide discovery across all modern science > [!tldr] > Emmy Noether discovered that every continuous symmetry in nature corresponds to a conserved quantity\u2014now called Noether's theorem\u2014one of the most profound insights in physics. She also founded modern abstract algebra.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#executive-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Executive Summary: She accomplished all...",
    "content": "She accomplished all this while overcoming systematic gender discrimination, and her work continues to shape fundamental physics and mathematics today. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#executive-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Against the Odds: Emmy Noether's Early Path",
    "content": "Emmy Noether was born in Erlangen, Germany, in 1882 to a distinguished family of academics\u2014her father, Max Noether, was himself a respected mathematics professor. Yet being born into intellectual privilege offered no protection against the systematic exclusion of women from academia that defined the early 20th century.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#against-the-odds-emmy-noethers-early-path",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The Barriers of Her Time",
    "content": "At the University of Erlangen in 1900, women were categorically prohibited from formal enrollment. Emmy, determined to pursue her passion for mathematics, found a creative workaround: she attended lectures unofficially as an auditor, absorbing the material while officially remaining a non-student. This arrangement lasted until 1904, when the university finally permitted women to enroll. Emmy wasted no time, earning her mathematics degree and completing her PhD by 1907\u2014an extraordinary achievement that made her one of the very first women in Europe to attain a doctorate in mathematics. > [!note] > The early 1900s saw dramatic shifts in women's education in Europe. Emmy's persistence during this transitional period reflected both personal determination and changing (albeit glacial) social attitudes toward female scholarship.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-barriers-of-her-time",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The G\u00f6ttingen Struggle: Yet a doctorate...",
    "content": "Yet a doctorate did not open institutional doors for Noether as it would have for a man. She spent the next several years at Erlangen working without pay or official title, essentially volunteering her talents to research and teaching. Her brilliance, however, had not gone unnoticed. By 1915, two of Europe's most eminent mathematicians\u2014David Hilbert and Felix Klein\u2014recognized her genius and invited her to join them at the University of G\u00f6ttingen, then the world's preeminent center for mathematics and physics. The G\u00f6ttingen faculty's response was deeply discouraging. During a contentious faculty meeting, one professor protested: *\"What will our soldiers think when they return and find they have to learn at the feet of a woman?\"* Hilbert's response became legendary. Incensed by this absurdity, he shot back: *\"We are a university, not a bathhouse!\"*\u2014a withering rebuke asserting that a scholar's intellectual merit should be the only measure of fitness for academic work.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-g\u00f6ttingen-struggle",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The G\u00f6ttingen Struggle: Despite Hilbert's fierce...",
    "content": "Despite Hilbert's fierce advocacy, the university still refused to hire Noether officially as faculty. Undeterred, Hilbert devised a workaround: Emmy would teach courses, but officially she would be listed only as his assistant. For several years, she lectured to students under Hilbert's name, conducting faculty-level work for meager (often nonexistent) compensation. Yet her students recognized the extraordinary mind behind those lectures. A devoted group of talented mathematicians\u2014affectionately nicknamed \"Noether's boys\"\u2014gathered around her, hungry to learn from one of the era's greatest minds. Her lectures were celebrated for their clarity, depth, and novel insights.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-g\u00f6ttingen-struggle",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Recognition and Tragedy: Only after World...",
    "content": "Only after World War I did academic attitudes shift enough for Noether to formalize her position. In 1919, she finally habilitated (formally qualified as an instructor) and began teaching under her own name. By 1922, she received the title of Associate Professor, and a year later, a modest paid position in algebra. By the 1930s, Noether had achieved international acclaim in mathematical circles. In 1932, she was invited to deliver a plenary lecture at the International Congress of Mathematicians\u2014a singular honor reserved for the most distinguished scholars. Yet even as her scientific star ascended, the political darkness of Nazi Germany descended. In 1933, the regime dismissed Noether from her position, both for being Jewish and for her progressive political views. She emigrated to the United States, continuing her work at Bryn Mawr College in Pennsylvania.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#recognition-and-tragedy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Recognition and Tragedy: But her journey...",
    "content": "But her journey was tragically cut short: in 1935, complications from surgery claimed her life at just 53 years old\u2014just as she was beginning to flourish in America. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#recognition-and-tragedy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The Golden Age of Physics",
    "content": "While at G\u00f6ttingen, Noether turned her formidable mathematical powers toward one of physics' deepest puzzles. This was the extraordinary period of the 1910s and 1920s\u2014the golden age of relativity and quantum theory. Einstein and his contemporaries were fundamentally reshaping humanity's understanding of space, time, energy, and matter. In 1915, amid this intellectual ferment, Noether made a discovery that would prove as foundational as the theories around her: she uncovered a profound mathematical connection between the symmetries of nature and the conservation laws of physics. Published in 1918, this result\u2014Noether's theorem\u2014would ultimately be recognized as perhaps the most important theorem in theoretical physics.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-golden-age-of-physics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Understanding Symmetry: To appreciate Noether's...",
    "content": "To appreciate Noether's insight, we must first clarify what physicists mean by symmetry. A system exhibits symmetry if it can be transformed in some way without producing a detectable difference in the outcome. Consider a simple example: a perfect sphere looks identical after you rotate it. This rotational symmetry is obvious to the eye. But Noether's theorem deals with deeper, often invisible symmetries\u2014symmetries embedded in the very laws of physics themselves. For instance: - Spatial symmetry: The laws of physics are the same here as they are on the other side of the world. There is no preferred location in the universe. - Temporal symmetry: The laws of physics are the same today as they were a billion years ago. There is no preferred time. > [!example] > Consider dropping a ball. Whether you drop it in Tokyo or Toronto, whether you drop it today or tomorrow, the laws of gravity and motion governing its fall are identical. This uniformity\u2014this symmetry\u2014is not obvious, but it is fundamental.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#understanding-symmetry",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Noether's Great Insight",
    "content": "Noether's theorem states: For every continuous symmetry in nature, there exists a corresponding conserved quantity. In other words, if the laws of physics remain unchanged under some transformation, then some measurable property of the system must remain constant in time.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#noethers-great-insight",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Spatial Symmetry \u2192 Momentum Conservation",
    "content": "Consider the symmetry of space: physics is invariant if we shift an experiment from one location to another. In mathematical terms, the laws of physics do not depend on our choice of position. This spatial homogeneity guarantees the conservation of momentum. In a uniform universe with no preferred location, an isolated object's momentum cannot spontaneously change. Mathematically: $$\\frac{dp}{dt} = 0$$ where $p$ is momentum. This seemingly obvious principle\u2014that objects keep moving unless pushed\u2014is actually a profound consequence of spatial symmetry.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#spatial-symmetry-momentum-conservation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Temporal Symmetry \u2192 Energy Conservation",
    "content": "Now consider time: the laws of physics are (to extraordinarily high precision) identical whether we perform an experiment now or performed it a century ago. The universe's physical laws show no dependence on the absolute time. This temporal symmetry guarantees the conservation of energy. If the equations of motion contain no explicit dependence on time $t$, energy cannot spontaneously appear or vanish: $$\\frac{dE}{dt} = 0$$ Energy remains constant in time. This profound principle\u2014that energy can be transformed but never created or destroyed\u2014emerges directly from the universe's temporal symmetry.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#temporal-symmetry-energy-conservation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Other Symmetries, Other Conserved Quantities",
    "content": "Noether's framework extends far beyond momentum and energy: - Rotational symmetry (no preferred direction) \u2192 angular momentum conservation - Phase symmetry in quantum mechanics \u2192 electric charge conservation - Gauge symmetries in modern physics \u2192 diverse conservation laws governing particle interactions > [!important] > Before Noether's theorem, conservation laws appeared to be independent empirical discoveries\u2014separate facts about nature. After Noether, they were revealed to be mathematical consequences of *symmetry principles*. This unification was revolutionary.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#other-symmetries-other-conserved-quantities",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The Power of Noether's Unification: Before Noether's work,...",
    "content": "Before Noether's work, conservation of energy, momentum, and angular momentum were treated as separate, empirically discovered principles. Each had its own history, its own justification. Noether showed that these were not disconnected accidents of nature but rather manifestations of a single, elegant mathematical principle: symmetry implies conservation. This insight profoundly reshaped physics. Physicists now recognize symmetry as the guiding light in formulating the laws of nature. Here's how the logic flows: 1. Identify a symmetry of nature (or postulate one based on philosophical or mathematical grounds) 2. Use Noether's theorem to deduce what must be conserved 3. Use conservation laws to constrain possible physical theories 4. Perform experiments to test predictions From Newton's laws to Einstein's relativity to today's quantum field theories, identifying a symmetry directly leads to knowing what quantity will be conserved.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-power-of-noethers-unification",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The Power of Noether's Unification: Conversely, discovering an...",
    "content": "Conversely, discovering an unexpected conserved quantity hints at an unseen symmetry of nature. As one physicist noted, Noether's theorem is \"one of the most important mathematical theorems ever proved in guiding the development of modern physics.\" ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-power-of-noethers-unification",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - When Symmetry Breaks",
    "content": "Noether's theorem teaches us not only *when* conservation laws hold, but equally important\u2014*when they might fail*. If a symmetry is broken or absent, the corresponding conserved quantity need not remain constant. This realization has profound implications for cosmology, particularly regarding one of physics' most sacred principles: the conservation of energy.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#when-symmetry-breaks",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Energy in an Expanding Universe",
    "content": "We typically take it for granted that energy can neither be created nor destroyed. But this principle depends crucially on an assumption: that the laws of physics do not change with time. In other words, energy conservation requires temporal symmetry\u2014the universe must be unchanging on the largest scales. But our universe is not static. Space itself is expanding. The universe is not the same today as it was billions of years ago. Conditions evolve, densities change, and the cosmic environment is fundamentally dynamic. This means the universe lacks perfect time-translation symmetry as a whole. > [!warning] > According to Noether's theorem, when temporal symmetry breaks down, energy conservation breaks down as well. In an expanding universe, total energy need not be strictly conserved.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#energy-in-an-expanding-universe",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Dark Energy and the Creation of Energy",
    "content": "A striking example: \"dark energy,\" the mysterious form of energy driving the accelerated expansion of the universe, has a roughly constant density of energy per unit volume. But as space expands, the total volume increases\u2014and therefore, the total amount of dark energy increases. This is equivalent to *creating energy from nothing*. Where does this energy come from? How can energy conservation be violated? According to Noether's principle, there is no violation. The expansion of the universe breaks the temporal symmetry that would guarantee energy conservation. Therefore, global energy conservation is not required\u2014it simply does not apply as a universal law.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#dark-energy-and-the-creation-of-energy",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Einstein's Discomfort: Interestingly, even Einstein...",
    "content": "Interestingly, even Einstein initially resisted this implication. He reportedly struggled with the idea that his own field equations might permit energy non-conservation in an expanding universe. Eventually, however, the logic became undeniable: energy conservation holds locally (in regions where temporal symmetry is a good approximation), but globally, in a dynamically evolving cosmos, energy can change. This subtle distinction\u2014between local and global conservation\u2014has become central to modern cosmology. It shapes our understanding of dark energy, the evolution of the universe, and the ultimate fate of the cosmos itself. > [!note] > Noether's theorem elegantly accounts for this apparent paradox: it ties the fate of every conservation law to the underlying symmetries of spacetime. When symmetries hold, conservation laws are ironclad. When symmetries break, conservation laws can fail. This is not a loophole or a violation\u2014it's the natural, mathematically consistent behavior of nature. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#einsteins-discomfort",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Dual Revolutions: Physics and Mathematics: Emmy Noether's impact...",
    "content": "Emmy Noether's impact on modern science is difficult to overstate. In physics, her eponymous theorem is now part of the standard canon taught to every theoretical physicist. The inseparable link between symmetries and conserved quantities\u2014a link Noether forged\u2014is woven into the fabric of modern theory. It has been said that \"all of modern physics is built\" on the foundation of Noether's theorem. Much of the formulation of contemporary theories\u2014from the Standard Model of particle physics to general relativity to quantum field theory\u2014is fundamentally governed by symmetry principles that echo Noether's insight. In pure mathematics, her influence is equally towering. She is regarded as a founder of modern abstract algebra\u2014a revolution in how mathematicians think about algebraic structures. Her work on ring theory, ideals, and algebraic systems fundamentally reshaped 20th-century mathematics. The term \"Noetherian\" is now standard mathematical terminology, a permanent tribute to her contributions.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#dual-revolutions-physics-and-mathematics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Dual Revolutions: Physics and Mathematics: One of her...",
    "content": "One of her contemporaries noted that the development of modern algebra was \"largely due to her\u2014in published papers, in lectures, and in personal influence on her contemporaries.\" Whenever physicists speak of a conservation law or a symmetry of nature, and whenever mathematicians work with abstract algebraic structures, they are invoking Emmy Noether's legacy. Her theorem bridges the abstract world of mathematical symmetry to the tangible, measurable laws that govern the universe\u2014and her algebraic innovations form the logical foundation upon which modern mathematics rests.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#dual-revolutions-physics-and-mathematics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - The Enduring Influence of \"Noether's Boys\"",
    "content": "Her students, the members of \"Noether's boys,\" became mathematicians and physicists of distinction in their own right, carrying her ideas forward and amplifying her influence across generations. The mathematics and physics she created outlived her by decades, centuries\u2014and continues to guide discovery today. From the discovery of new subatomic particles to understanding why certain physical processes can (or cannot) occur in nature, Noether's theorem remains a beacon for scientific inquiry.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#the-enduring-influence-of-noethers-boys",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - A Genius Recognized Too Late",
    "content": "It took time for Noether to receive public recognition commensurate with her genius\u2014far too long. Yet when recognition came, it was profound. Albert Einstein's 1935 tribute, published in the *New York Times*, captures the magnitude of her achievement: > \"The most significant creative mathematical genius thus far produced since the higher education of women began.\" In the decades since, that assessment has only been reinforced. Emmy Noether revealed a fundamental truth about the universe: that hidden in every symmetry is a law of conservation. In doing so, she left an indelible mark on both mathematics and physics. Her story\u2014from overcoming systematic prejudice to transforming our understanding of the cosmos\u2014continues to inspire new generations of scientists and scholars. She stands as a testament to the power of genius, the cost of discrimination, and the enduring beauty of mathematical truth. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#a-genius-recognized-too-late",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Primary Sources & Historical References",
    "content": "- MacTutor History of Mathematics: Emmy Noether (1882-1935) biography - [Link](https://mathshistory.st-andrews.ac.uk/Biographies/Noether_Emmy/) - University of St Andrews comprehensive biography - Britannica Encyclopedia: Emmy Noether biography and contributions - [Link](https://www.britannica.com/biography/Emmy-Noether) - Academic encyclopedia entry on her life and achievements - Wikipedia: Comprehensive entry on Emmy Noether with detailed timeline - [Link](https://en.wikipedia.org/wiki/Emmy_Noether) - Detailed historical and scientific information",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#primary-sources-historical-references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Podcasts & Media",
    "content": "- Daniel and Kelly's Extraordinary Universe Podcast: \"What Did Emmy Noether Reveal About the Universe?\" - [Link](https://podcasts.apple.com/us/podcast/what-did-emmy-noether-reveal-about-the-universe/id1436616330?i=1000700056784) - Also available on: Apple Podcasts, Spotify, and other platforms - 52-minute episode featuring detailed discussion of Noether's life, work, and legacy",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#podcasts-media",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Academic & Scientific Sources: - Science News:...",
    "content": "- Science News: \"In her short life, mathematician Emmy Noether changed the face of physics\" - [Link](https://www.sciencenews.org/article/emmy-noether-theorem-legacy-physics-math) - Detailed exploration of Noether's theorem and its applications in modern physics - ScienceBlogs (Principles): \"Science Story: Not a Bath House\" - [Link](https://scienceblogs.com/principles/2015/02/11/science-story-not-a-bath-house) - Historical account of Noether at G\u00f6ttingen and faculty resistance to women in academia - Perimeter Institute: \"Emmy Noether: Her life, work, and influence\" - Public lecture with Peter Olver and Ruth Gregory - [Link](https://pirsa.org/15060040) - Academic discussion of Noether's contributions to mathematics and physics - Jewish Women's Archive: Emmy Noether biography and legacy - [Link](https://jwa.org/encyclopedia/article/noether-emmy) - Noether's life in context of Jewish history and women in science - Max Planck Institute: \"Without Emmy Noether, there would be a huge gap in mathematics and its understanding\" - [Link](https://www.mpg.de/16548098/emmy-noether) - Institutional reflection on her mathematical contributions and legacy",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#academic-scientific-sources",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Mathematical & Physics References",
    "content": "- B.L. van der Waerden: *Moderne Algebra* (1931) - Foundational text built on Noether's ring theory and abstract algebra contributions - Second volume features her algebraic innovations as central framework - Conservation Laws & Symmetry: Noether's Theorem as foundational principle - Incorporated in all modern theoretical physics texts - Standard reference in quantum field theory, general relativity, and particle physics education ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#mathematical-physics-references",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 emmy noether symmetry conservation - Tags & Categories",
    "content": "#biography #mathematics #physics #symmetry #conservation-laws #women-in-science #history-of-science #theoretical-physics #abstract-algebra --- Note: This blog post is part of the CoMPhy Lab's profile series celebrating influential scientists and their contributions to our understanding of the universe. Emmy Noether's story reminds us that the greatest discoveries often come from those who refuse to be silenced by systemic barriers. > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://comphy-lab.org/VatsalSy) > Date published:: Oct 24, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-Emmy-Noether-Symmetry-Conservation.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Emmy-Noether-Symmetry-Conservation/#tags-categories",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - From Newtonian Beginnings to Viscoelastic Surprises (Historical Context): Early studies of...",
    "content": "Early studies of bubble bursting (dating back to at least the early 20th century) focused on Newtonian fluids and laid the groundwork for understanding the bursting mechanism. Pioneering experiments by A.M. Worthington over a century ago captured photographs of jets formed by collapsing cavities, essentially visualizing the birth of the Worthington jet phenomenon. By the mid-20th century, scientists recognized that bursting bubbles were important in nature \u2013 for instance, generating sea spray aerosols and even transporting microorganisms. These studies assumed _ideal_ liquids like pure water, and by the late 1900s the physics was well-charted: when a bubble\u2019s cap ruptures, a bowl-shaped cavity is left in the surface. Capillary waves travel down the cavity\u2019s sides and converge at the cavity\u2019s bottom, shooting a high-speed jet upward, which then often pinches off droplets. This Newtonian paradigm was the default for a long time. However, real-world liquids aren\u2019t always Newtonian.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#from-newtonian-beginnings-to-viscoelastic-surprises-historical-context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - From Newtonian Beginnings to Viscoelastic Surprises (Historical Context): Examples",
    "content": "Sea water, for example, is full of surfactants and organic matter; foods and biofluids can be viscoelastic (think of saliva or mucus which stretches like a weak elastic goo). Researchers gradually realized that these non-Newtonian traits could change the bubble-bursting outcome. A key turning point came in the 1990s. In 1996, J.M. Cheny and K. Walters carried out experiments with water mixed with a tiny amount of polymer (on the order of only tens of parts per million). To everyone\u2019s surprise, the addition of a viscoelastic agent (the polymer) dramatically altered the jet: even such a small polymer concentration reduced the jet height by roughly an order of magnitude. In other words, the normally tall, spire-like jet seen in pure water became stunted. This was a clear indication that something beyond ordinary viscosity \u2013 namely elastic stresses introduced by the polymer \u2013 was influencing the process.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#from-newtonian-beginnings-to-viscoelastic-surprises-historical-context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - From Newtonian Beginnings to Viscoelastic Surprises (Historical Context): This historical milestone...",
    "content": "This historical milestone demonstrated that the classical Newtonian model was not the whole story, sparking fresh interest in bubble bursting under non-Newtonian conditions. Over the following years, interest in _complex fluids_ grew, but only recently have we begun to see a flurry of studies examining bubble bursting in fluids with additives like polymers. The motivation is clear: bubbles burst in nature and industry under all kinds of fluid conditions, so understanding how phenomena like elasticity alter the outcome is crucial. Our current work fits into this evolving narrative by using simulations to dig deeper into those viscoelastic effects that intrigued researchers since the late 20th century.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#from-newtonian-beginnings-to-viscoelastic-surprises-historical-context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Viscoelastic Effects in Prior Studies: What Do We Know?: Several experimental and...",
    "content": "Several experimental and computational studies have set the stage for our current investigation by exploring how viscoelasticity changes the bursting-bubble dynamics. Building on the early findings of Cheny and Walters (1996), later researchers quantified and expanded those observations. Cheny and Walters had shown that introducing a small amount of polymer (roughly 50 ppm of a long-chain polymer in water) could drastically shrink the burst-induced jet. This jet height suppression implied that elastic stresses (even if the fluid had just a \u201cdash\u201d of polymer) were counteracting the forces that typically drive a tall jet. Fast-forward to recent years: Rodr\u00edguez-D\u00edaz _et al._ (2023) carried out bubble-burst experiments with weakly viscoelastic polymer solutions and uncovered a nuanced effect. They observed that at an _optimal_ polymer concentration (around 25 ppm in their case), the tiny amount of polymer actually made the jet _faster_. How?",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#viscoelastic-effects-in-prior-studies-what-do-we-know",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Viscoelastic Effects in Prior Studies: What Do We Know?: The polymer molecules...",
    "content": "The polymer molecules at the interface dampened the small ripples on the collapsing cavity (the short-wavelength capillary waves), leading to a smoother, more focused collapse. Smoothing out those ripples caused the liquid to shoot upward more directly, enhancing the jet\u2019s velocity. In other words, a little elasticity at the interface ironed out disturbances that would normally waste energy, thus the jet came out quicker and slightly more forceful. However, when Rodr\u00edguez-D\u00edaz _et al._ increased the polymer concentration further, the story changed. Higher polymer content introduced stronger bulk elastic effects \u2013 essentially the liquid became noticeably stretchy or resistant to fast flow. In those cases, the rising jet often failed to produce the usual top droplet at all. The fluid\u2019s elastic resistance to stretching (sometimes called extensional thickening) prevented the jet from necking and breaking up into a drop.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#viscoelastic-effects-in-prior-studies-what-do-we-know",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Viscoelastic Effects in Prior Studies: What Do We Know?: Summary - JavaScript",
    "content": "In summary, their experiments showed a viscoelastic sweet spot where a little elasticity boosts the jet, and a regime where too much elasticity chokes off droplet formation. Other studies have echoed these findings. Very recent work by Cabalgante-Corrales _et al._ (2025) further confirmed that beyond a certain elasticity threshold, droplet emission can be completely suppressed. In their observations, if the polymer relaxation time (a measure of how long the fluid\u2019s elastic stresses persist) is sufficiently large compared to the timescale of the jet formation, no droplets are emitted at all \u2013 the jet essentially forms a single column that retracts without snapping off a small drop. This threshold can be described in terms of a dimensionless Weissenberg number (which compares the polymer\u2019s relaxation time to the jet\u2019s characteristic time scale); when it exceeds a value on the order of 0.5, the fluid\u2019s elasticity dominates the breakup process.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#viscoelastic-effects-in-prior-studies-what-do-we-know",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Viscoelastic Effects in Prior Studies: What Do We Know?: JavaScript",
    "content": "All these prior studies, from 1996 to 2025, consistently point to the fact that even _weak_ viscoelasticity can profoundly influence the outcome of a bursting bubble. They provided clues like droplet suppression and capillary-wave damping that any complete theory or model must explain.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#viscoelastic-effects-in-prior-studies-what-do-we-know",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - How Our Simulations Build on These Insights: Our current study...",
    "content": "Our current study uses high-fidelity numerical simulations to explore bubble bursting in viscoelastic liquids, helping to clarify the mechanisms behind the experimental observations above. By employing an Oldroyd-B viscoelastic model (a common model for polymer solutions) in a Volume-of-Fluid simulation framework, we can control and vary the fluid\u2019s key properties systematically \u2013 something difficult to do in experiments. We map out a range of conditions in terms of dimensionless groups (like the _elasto-capillary number_ and _Deborah number_, which relate to polymer elasticity and relaxation time) to see how each influences the jet and droplet outcome. Essentially, these simulations let us rewind, pause, and inspect the bursting process in ways a high-speed camera cannot: we can look at the tension in the fluid, the distribution of polymer stresses, and test \u201cwhat-if\u201d scenarios by dialing elasticity up or down independently of other factors.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#how-our-simulations-build-on-these-insights",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - How Our Simulations Build on These Insights: What we found...",
    "content": "What we found corroborates many of the past experimental findings while also providing a clearer picture of why they happen. For instance, our simulations show that introducing a small amount of polymer indeed dampens the high-frequency capillary waves on the collapsing bubble cavity, much like Rodr\u00edguez-D\u00edaz _et al._ noted. We can directly see the interface becoming smoother in the simulation, which in turn leads to a more coherent jet that can even travel faster than it would in pure water. On the other hand, when we crank up the viscoelastic effects (by increasing polymer concentration or elasticity in the simulation), the jet\u2019s behavior changes dramatically. The jet tends to be thicker and more stable \u2013 so stable, in fact, that it doesn\u2019t break up into a droplet at the tip. This matches the droplet suppression regime reported in experiments.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#how-our-simulations-build-on-these-insights",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - How Our Simulations Build on These Insights: In the simulations,...",
    "content": "In the simulations, we observe that the polymer stresses accumulate during the cavity collapse and jet rise, and if those stresses are high enough, they counteract the necking that would normally pinch off a droplet. The result is a jet that simply subsides back without spraying droplets. By varying the fluid\u2019s relaxation time, we can pinpoint the threshold at which this happens, supporting the idea that there is a critical viscoelastic relaxation timescale beyond which the droplet never forms. In short, our simulations extend the insights of earlier works by providing a full-field view of the flow and isolating the roles of different effects. They confirm that the viscoelastic phenomena observed by Cheny & Walters, Rodr\u00edguez-D\u00edaz _et al._, and others are not just experimental quirks, but fundamental aspects of the physics when polymers are present.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#how-our-simulations-build-on-these-insights",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - How Our Simulations Build on These Insights: Examples",
    "content": "Moreover, the simulations help untangle the interplay between viscous and elastic forces: for example, we find there\u2019s a trade-off between a fluid\u2019s viscosity and its elasticity in setting the jet speed and whether a droplet pinches off. This kind of systematic exploration would be challenging in a lab but is feasible in a simulation, allowing us to fill gaps in the understanding.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#how-our-simulations-build-on-these-insights",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Concluding Thoughts: Bubble bursting might...",
    "content": "Bubble bursting might last only a few milliseconds, but as research over the decades has shown, it\u2019s a rich and complex phenomenon \u2013 especially when you venture beyond ordinary liquids. Historically, scientists figured out the basics in simple fluids, establishing a baseline for how jets and droplets form after a burst. The addition of polymers and other non-Newtonian effects then revealed new twists: slower, stubbier jets or no droplets at all under the right conditions. By comparing past experiments and new simulations, we now have a much clearer picture of _why_ those twists occur. Viscoelasticity, in essence, adds a kind of \u201cmemory\u201d to the liquid: the fluid remembers being stretched and fights back, which can either smooth out the jet formation or halt the droplet breakup \u2013 or both. For a scientifically curious reader or an early-career researcher, the take-home message is that even a dash of polymer can tip the balance of forces during a bubble burst.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#concluding-thoughts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Concluding Thoughts: This means traditional...",
    "content": "This means traditional Newtonian models need adjustments when dealing with real-world fluids. Our study contributes to this evolving understanding by not only confirming the experimental observations in a controlled setting but also by quantifying the thresholds and mechanisms at play. Going forward, these insights could inform everything from predicting oceanic spray in various water conditions to designing industrial processes (or even culinary tricks) where bubble bursting is a factor. The humble bubble, when combined with a bit of polymer physics, continues to teach us new fluid dynamics \u2013 a beautiful example of how revisiting a classic problem with fresh eyes can lead to deeper knowledge. References: _(The cited works correspond to the following)_ - Cheny, J.M. & Walters, K. (1996). Extravagant viscoelastic effects in the Worthington jet experiment. _J. Non-Newtonian Fluid Mech._ 67, 125\u2013135. - Rodr\u00edguez-D\u00edaz, P., Rubio, M., Montanero, J.M., Ga\u00f1\u00e1n-Calvo, A.M. & Cabezas, M.G. (2023).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#concluding-thoughts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 history worthington jets from bursting bubbles - Concluding Thoughts: Bubble bursting in...",
    "content": "Bubble bursting in a weakly viscoelastic liquid. _J. Fluid Mech._ 954, A20. - Cabalgante-Corrales, C., Mu\u00f1oz-S\u00e1nchez, B.N., Ferrera, C., Fuster, D. & Sevilla, A. (2025). Viscoelastic effects on jet drop formation in bubble bursting. _Phys. Rev. Fluids_ 10, 013603. (supporting information on droplet suppression) - _Additional references on bubble bursting in Newtonian and complex fluids are cited in-line above (e.g., Worthington\u2019s early work, studies by Ghabache et al. 2014/2016 on champagne bubbles, etc.), illustrating the progression from classical to modern understanding._",
    "url": "https://blogs.comphy-lab.org/Blog/2025-History-Worthington-jets-from-bursting-bubbles/#concluding-thoughts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Visual PDE: Where mathematics becomes art you can paint with your fingers",
    "content": "VisualPDE lets anyone\u2014students, teachers, and researchers\u2014simulate rich partial differential equation (PDE) models directly in the browser, in real time, no coding or installs. Under the hood it turns your device\u2019s GPU into a math engine, so patterns bloom and waves ripple as fast as you can drag a slider or draw with your finger. It\u2019s \u201cDesmos for PDEs,\u201d except the plots are alive. > [!summary] TL;DR > Open visualpde.com, pick an example (or type your own equations), then paint initial conditions, adjust sliders, and share a link or embed the live sim. It runs on laptops, tablets, and phones, with GPU\u2011accelerated timestepping delivering tens of thousands of steps per second on typical demos.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#visual-pde-where-mathematics-becomes-art-you-can-paint-with-your-fingers",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - What is VisualPDE?",
    "content": "PDEs describe how things change across space and time: heat diffuses, waves propagate, chemicals react and spread, populations move. Historically, exploring them required code, licenses, and compute time. VisualPDE removes those barriers: open a link and you\u2019re simulating on the spot\u2014no installation, works on most devices, and the entire site is open source if you want to peek or fork. > [!info] What to do? > Think interactive PDEs you can play with\u2014edit equations live, watch solutions evolve instantly, and share or embed your setup with one click.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#what-is-visualpde",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - GPU + WebGL",
    "content": "VisualPDE treats the simulation grid like an image. Each pixel stores field values; fragment shaders update every pixel in parallel. Your browser\u2019s WebGL pipeline does the heavy lifting, stepping the system hundreds of times per frame for smooth, responsive dynamics. Result: real\u2011time PDEs in a tab. - WebGL + GLSL shaders = parallel updates - Grid = floating\u2011point textures - \u201cSolve\u2011as\u2011you\u2011type\u201d responsiveness",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#gpu-webgl",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Numerics that favor interactivity",
    "content": "Under the hood are familiar methods from a first course in scientific computing: - Space: Finite difference method on a 1D/2D grid. - Time: explicit schemes you can choose: Forward Euler, Adams\u2013Bashforth (2\u2011step), Midpoint, and RK4. VisualPDE also detects instability (NaNs/infinities) and nudges you to tweak the timestep or scheme. > [!tip] Rules of thumb > If a sim \u201cblows up,\u201d halve $\\Delta t$ or switch from Forward Euler to RK4. For pattern\u2011forming systems, a small $\\Delta t$ is usually fine thanks to modern GPUs.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#numerics-that-favor-interactivity",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Precision & performance",
    "content": "To maximize compatibility\u2014especially on mobile\u2014VisualPDE currently uses single\u2011precision floats. In practice, that\u2019s enough for teaching and rapid exploration; double precision is on the roadmap as browser support matures. Typical demos achieve tens of thousands of timesteps per second on modern hardware.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#precision-performance",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Playful interface, serious models: - Paintable initial...",
    "content": "- Paintable initial conditions. Pause and draw on the domain with a brush\u2014seed a ring for a wave equation, scribble a hot patch for diffusion, or drop \u201cprey\u201d into a corner of a predator\u2013prey model. - Parameter sliders. Declare ranges (e.g., `a = 0.5 in [0,1]`) and explore transitions live. - Live math. LaTeX rendering confirms your equations are interpreted as intended. - Flexible domains & boundaries. Use standard rectangular setups, custom masks, and common boundary conditions (periodic, Dirichlet, Neumann, Robin). - Rich visualization. Toggle 2D colormaps, contours, vector fields, or a 3D surface for 2D sims\u2014instantly. - Share & embed.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#playful-interface-serious-models",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Playful interface, serious models: Examples",
    "content": "Generate a short link that encodes your full setup, or copy an iframe to embed an interactive figure in docs, lectures, or posts. > [!example] Minimal embed snippet > > ```html > src=\"https://visualpde.com/sim/?preset=heatEquation\" > width=\"640\" height=\"480\" loading=\"lazy\" > title=\"VisualPDE simulation\"> > > ``` > > You can also export embed code (tiny or customized), screenshots or short clips for slides and social posts \u2014 use the share button at the right hand side of each simulation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#playful-interface-serious-models",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Pattern formation: spots, stripes, labyrinths",
    "content": "- Gray\u2013Scott model. Two parameters steer a zoo of behaviors: stationary/moving spots, labyrinths, waves, and more. Exploring this interactively is eye\u2011opening. Explore the Gray-Scott model on VisualPDE - Turing systems. Try Schnakenberg or Brusselator; even \u201cTuring on Turing\u201d\u2014use an image/webcam as spatial heterogeneity to watch your face turn into spots and stripes.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#pattern-formation-spots-stripes-labyrinths",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Environment: landscapes come alive",
    "content": "- [Dryland vegetation (Klausmeier):](https://visualpde.com/mathematical-biology/vegetation-patterns.html) Add a rainfall gradient on a slope and watch tiger\u2011bush stripes emerge, rotate, or break up. - [Urban flooding (Oxford):](https://visualpde.com/visual-stories/flooding) A LiDAR\u2011based elevation map lets you \u201cpour\u201d water, adjust river inflow, and even \u201cdig\u201d diversion channels\u2014an intuitive sandbox for flood intuition.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#environment-landscapes-come-alive",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Health: waves of life and risk",
    "content": "- FitzHugh\u2013Nagumo model. Visualize spiral waves and their competition with homogeneous oscillations\u2014an accessible window into arrhythmia\u2011like dynamics. FitzHugh\u2013Nagumo model - [Airborne virus story:](https://visualpde.com/visual-stories/airborne-infections) Toggle ventilation to see how airflow reshapes indoor concentration patterns; an interactive Plus Magazine feature showcased this beautifully.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#health-waves-of-life-and-risk",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Physics & beyond",
    "content": "- Kuramoto\u2013Sivashinsky. A classic spatiotemporal chaos demo in a few lines. Kuramoto\u2013Sivashinsky equation - Cahn\u2013Hilliard. Phase separation that coarsens over time. Cahn\u2013Hilliard equation _(All available as ready\u2011to\u2011run examples.)_ > [!note] Why this matters for learning > Immediate, visual feedback builds intuition for symmetry breaking, instability, and nonlinearity\u2014concepts that are hard to \u201csee\u201d in static notes. In classrooms and outreach, embedded sims consistently boost engagement.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#physics-beyond",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Where VisualPDE fits in the tool landscape",
    "content": "- COMSOL-type codes: good for engineering detail and complex 3D geometries, but closed sourced which is often a deal breaker for reproducibility. - MATLAB / Mathematica: great for coding bespoke solvers and symbolic work; less immediate for shareable, interactive experiments, also closed sourced. - Open source codes like [[Basilisk101/0-README|Basilisk C]], [OpenFOAM](https://www.openfoam.com/), [Pyoomph](https://pyoomph.github.io/): Open source, high precision, but heavy weight \u2014 not ideal for easily sharing. VisualPDE fills the gap: frictionless, free, shareable, and powerful enough for research prototyping and teaching\u2014in a browser.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#where-visualpde-fits-in-the-tool-landscape",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Community, credibility, and what\u2019s next",
    "content": "- The site and solver details are openly documented; the codebase is on [GitHub](https://github.com/Pecnut/visual-pde). - VisualPDE has featured in [Chalkdust](https://chalkdustmagazine.com/regulars/on-the-cover/visual-pde/) and in [Plus magazine](https://plus.maths.org/content/playing-visualpde) (with interactive articles/podcasts), and a [peer\u2011reviewed BMB paper](https://doi.org/10.1007/s11538-023-01218-4) provides technical and pedagogical context. - Roadmap: continued performance and usability improvements, and work toward a Julia\u2011based companion for larger or more complex studies\u2014all while keeping interactivity at the core.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#community-credibility-and-whats-next",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - Get started",
    "content": "1. Visit [visualpde.com](https://visualpde.com) \u2192 Explore an example that catches your eye (waves, epidemics, ecology). 2. Play: - Press pause and paint an initial condition. - Add a slider for a parameter (`a in [0,1]`) and watch the behavior shift. - Flip the time\u2011stepping scheme (try RK4) and compare stability. 3. Share or embed what you made (short link or iframe), or record a short clip for your slides.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#get-started",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - The big picture: VisualPDE democratizes a...",
    "content": "VisualPDE democratizes a language used across science\u2014PDEs\u2014by making them visible, tactile, and shareable. You can draw a hypothesis, nudge a parameter, and see the consequences in seconds. That shift\u2014from static math to interactive exploration\u2014is why this tool resonates in classrooms, labs, and public science alike. Open your browser; the canvas is already waiting. _Acknowledgements & sources:_ this post integrates and cites the VisualPDE paper[^1], documentation[^2], and example library (open source, with extensive user\u2011guide material and \"Visual Stories\").",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#the-big-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 visual pdes - The big picture: Context",
    "content": "Also see: [https://visualpde.com/about/](https://visualpde.com/about/). > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://comphy-lab.org/VatsalSy) > Date published:: Oct 1, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-visual-pdes.md) [^1]: Walker, B. J., Townsend, A. K., Chudasama, A. K., & Krause, A. L. (2023). VisualPDE: rapid interactive simulations of partial differential equations. Bull. Math. Biol., 85(11), 113. [^2]: https://visualpde.com/user-guide",
    "url": "https://blogs.comphy-lab.org/Blog/2025-visual-pdes/#the-big-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Executive Summary",
    "content": "Arrowhead structures, nicknamed \"narwhals,\" were initially discovered as coherent patterns in elastoinertial turbulence (EIT) simulations. While these structures provided valuable insights into polymer-flow interactions $-$ they can be the pathway to explain elastoinertial turbulence $-$ recent research reveals they might be artifacts of 2D simulations that become unstable in realistic 3D flows. > [!abstract] Key Points Overview > - Coherent structures could explain the pathway to elastoinertial turbulence. > - Arrowhead (one such traveling wave coherent solution of viscoelastic channel flow) structures are unstable in 3D flows > - Lack of experimental validation. > - Numerical artifacts play significant role $-$ presence or lack of polymeric diffusion. > - Transient appearances may still influence flow dynamics.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#executive-summary",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Problem Statement",
    "content": "- Central Issue: The existence and significance of arrowhead structures in elastoinertial turbulence. - Importance: Understanding these structures could reveal fundamental mechanisms of polymer-flow interactions and turbulence development.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#problem-statement",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Historical note",
    "content": "The two Phys. Rev. Lett. outline the exact traveling wave solutions $-$ now commonly called arrowheads or narwhals. ![|750](_Media/Arrowheads-in-elastoinertial-turbulence-1740331019797.png) [J. Page, Y. Dubief & R. R. Kerswell, Phys. Rev. Lett., 125:15, 154501 (2020)](https://doi.org/10.1103/PhysRevLett.125.154501) ![](_Media/Arrowheads-in-elastoinertial-turbulence-1740331094800.png) [A. Morozov, Phys. Rev. Lett., 129:1, 017801 (2022)](https://doi.org/10.1103/PhysRevLett.129.017801)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#historical-note",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Methodology",
    "content": "The research community has employed multiple approaches to study arrowhead structures: > [!method] Research Methods > - 2D and 3D numerical simulations > - Linear stability analysis > - Flow visualization experiments > - Polymer diffusion modeling",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#methodology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - What are arrowheads?: Elastoinertial turbulence (EIT)...",
    "content": "Elastoinertial turbulence (EIT) is a chaotic flow state in dilute polymer solutions that arises when fluid inertia and polymer elasticity jointly drive instabilities. In this regime, simulations have revealed distinctive arrowhead-shaped coherent structures (nicknamed \u201cnarwhal\u201d structures for their horn-like appearance). These are highly organized patterns embedded within the turbulence, consisting of a polymer stress distribution coupled with a vortical flow pattern. An arrowhead structure has * Localized polymer stretch: a thin sheet of highly stretched polymer (high elastic stress) forming a triangular, arrowhead-like region spanning from the near-wall area to the channel center (symmetric about the mid-plane). * Flanking vortices: a pair of counter-rotating vortices on either side of this polymer sheet.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#what-are-arrowheads",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - What are arrowheads?: These vortices pull...",
    "content": "These vortices pull fluid (and polymers) up from the walls toward the center, feeding and elongating the polymer-rich \u201chorn\u201d of the arrowhead. * Coherent propagation: the structure travels downstream as a traveling wave, maintaining its shape over time rather than dissipating like a random eddy.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#what-are-arrowheads",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Why do arrowheads form?: Arrowhead structures emerge...",
    "content": "Arrowhead structures emerge from a flow instability driven by polymer elasticity. At high Weissenberg number ($Wi$, dimensionless stress relaxation time $-$ high $Wi$ imply strong elastic effects) and moderate Reynolds number ($Re$), an otherwise laminar channel flow becomes unstable to disturbances at the channel center. This center-mode instability begins as a pattern of vortices and polymer stretch in the middle of the channel, which grows and nonlinearly saturates into the arrowhead form. Above a critical $Wi$, the flow spontaneously develops arrowhead patterns; at higher $Wi$, these patterns persist and can dominate as a stable wave. At sufficiently large $Wi$, the chaotic EIT can give way to a single steady arrowhead state, indicating that this coherent structure becomes a stable attractor when elasticity dominates. Polymer\u2013flow coupling: The self-sustaining nature of an arrowhead comes from a feedback loop between polymer stretching and fluid motion.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#why-do-arrowheads-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Why do arrowheads form?: The polymer\u2019s evolution...",
    "content": "The polymer\u2019s evolution equation captures this interplay: $$ \\frac{D \\mathbf{C}}{Dt} = \\mathbf{C}\\cdot(\\nabla \\mathbf{u})^T + (\\nabla \\mathbf{u})\\cdot \\mathbf{C} - \\frac{1}{Wi}(\\mathbf{C} - \\mathbf{I}) $$ where $C$ is the polymer conformation tensor. In an arrowhead, the vortex pair generates strong shear and extensional flow that continuously amplifies polymer stretch along its arms. Because relaxation is slow at high $Wi$, a persistent high-tension polymer zone forms instead of relaxing away. That stretched-polymer zone exerts elastic stress back on the fluid, reinforcing the vortices that created it. Thus the vortices and polymer sheet sustain each other: the flow keeps the polymers stretched, and the polymer tension keeps the flow organized in the arrowhead pattern.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#why-do-arrowheads-form",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Different types of arrowheads",
    "content": "![](_Media/Arrowheads-in-elastoinertial-turbulence-1740342415364.png) Fig. Different realizations of arrowheads. Figure taken from [Y. Dubief, J. Page, R. R. Kerswell, V. E. Terrapon & V. Steinberg, Phys. Rev. Fluids, 7:7, 073301 (2022)](https://arxiv.org/pdf/2006.06770)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#different-types-of-arrowheads",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Why are arrowheads important?",
    "content": "Identifying arrowhead structures can be pivotal for understanding EIT. They are the viscoelastic analog of coherent structures in Newtonian turbulence (like near-wall streaks and rolls), providing a clear `skeleton` for the turbulence. This shows that EIT is not just random; it is built around repeatable polymer\u2013flow patterns. Arrowhead structures also showcase a new route to sustain turbulence: they show that elastic forces can maintain complex flow structures even at Reynolds numbers where a Newtonian flow would stay laminar. Finally, they offer a bridge between regimes, connecting purely elastic turbulence ($Re \u2248 0$) with elastoinertial turbulence at higher $Re$ with $Wi \\gg 1$.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#why-are-arrowheads-important",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Numerical vs. Experimental Evidence: Do Arrowheads Exist in 3D or in Reality?: A critical question...",
    "content": "A critical question is whether these arrowhead structures are present in 3D flows and experiments, or if they are artifacts of idealized 2D simulations. It has been claimed \u2013 and largely supported by evidence \u2013 that a single arrowhead wave _disappears_ in fully 3D simulations and has never been observed in experiments. Recent studies confirm that in a 3D domain, an arrowhead (narwhal) state is linearly unstable and quickly breaks down into turbulence. Morozov and co-workers performed a linear stability analysis of the 2D travelling-wave solution and found it unstable to spanwise perturbations when embedded in a 3D domain ([M. Lellep, M. Linkmann & A. Morozov, Proc. Natl. Acad. Sci., 121:9, e2318851121 (2024)](https://doi.org/10.1073/pnas.2318851121)). In other words, _\u201cunlike 2D, in 3D the narwhal in a channel appears to become unstable, leading to chaotic flows\u201d_.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#numerical-vs-experimental-evidence-do-arrowheads-exist-in-3d-or-in-reality",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Numerical vs. Experimental Evidence: Do Arrowheads Exist in 3D or in Reality?: This means that...",
    "content": "This means that a coherent arrowhead structure cannot persist as a steady state in a wide 3D channel; it inevitably triggers its own demise into disordered motion. Indeed, direct 3D simulations of EIT show the flow filled with multiscale, transient structures rather than a single arrowhead. The characteristic structures of 3D EIT are sheet-like regions of high polymer stretch and streamwise vortices (often aligned in the spanwise direction) $\u2013$ no long-lived arrowhead pattern is evident. Experimentally, too, no arrowhead or narwhal-shaped structures have been directly observed. Laboratory studies (using techniques like flow visualization or velocimetry in polymer solutions) report chaotic fluctuations and elastic \u201csheets\u201d of polymer stretch, but not a stable arrowhead wave. For example, experimental and high-Reynolds 3D DNS studies show polymers stretched in thin sheets inclined to the flow and emerging vortex tubes, with no mention of a sustained arrowhead structure.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#numerical-vs-experimental-evidence-do-arrowheads-exist-in-3d-or-in-reality",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Numerical vs. Experimental Evidence: Do Arrowheads Exist in 3D or in Reality?: Recent research largely...",
    "content": "Recent research largely _supports_ these claims. The consensus is that the arrowhead/narwhal is a 2D artifact in the sense that it cannot survive the spanwise degrees of freedom of a real 3D flow. Additionally, no experimental evidence of arrowheads has emerged, despite the intensive study of EIT in channels and pipes over the past decade \u2013 reinforcing the idea that such structures, if they form, are immediately disrupted in real flows. However, recent findings do _nuance_ this picture: even though a stable narwhal does not exist in 3D, researchers have noted that transient arrowhead-like patterns can _appear fleetingly_ within a 3D turbulent flow. For instance, simulations of low-Re viscoelastic turbulence sometimes display instantaneous polymer-stress contours resembling the arrowhead shape ([J. R. C. King, R. J. Poole, C. P. Fonte & S. J. Lind, arXiv:2501.09421 (2025)](https://arxiv.org/abs/2501.09421)).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#numerical-vs-experimental-evidence-do-arrowheads-exist-in-3d-or-in-reality",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Numerical vs. Experimental Evidence: Do Arrowheads Exist in 3D or in Reality?: Summary",
    "content": "These transient appearances suggest that the arrowhead solution still exists as an organizing saddle or ephemeral structure in phase space, even if it\u2019s not sustained. In summary, the latest evidence indicates that arrowhead/narwhal structures do not persist in fully 3D EIT or experiments \u2013 they are replaced by more complex chaotic dynamics \u2013 but they may manifest momentarily, hinting that they influence the flow as part of its underlying state space (rather than as an observable steady feature).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#numerical-vs-experimental-evidence-do-arrowheads-exist-in-3d-or-in-reality",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Role of Diffusion, Resolution, and Modeling Choices: Physical Feature or Numerical Artifact?: The formation and...",
    "content": "The formation and persistence of arrowhead structures are highly sensitive to modeling choices like polymer diffusion and domain dimensionality, raising the question of whether these structures are genuine physical features or numerical artifacts. Polymer stress diffusion in particular plays a pivotal role. In simulations of viscoelastic fluids (Oldroyd-B or FENE-P models), a small artificial diffusion term is often added to the polymer constitutive equations for numerical stability. Recent work showed that even an _infinitesimal_ polymer diffusion can qualitatively change the flow\u2019s stability characteristics. [M. Beneitez, J. Page, Y. Dubief & R. R. Kerswell, J. Fluid Mech., 981, A30 (2024)](https://doi.org/10.1017/jfm.2024.50) discovered a _polymer diffusive instability (PDI)_: with a nonzero diffusion, the laminar flow becomes linearly unstable, producing a small-scale traveling wave at the wall as the primary bifurcation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#role-of-diffusion-resolution-and-modeling-choices-physical-feature-or-numerical-artifact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Role of Diffusion, Resolution, and Modeling Choices: Physical Feature or Numerical Artifact?: Notably, this instability...",
    "content": "Notably, this instability does _not_ exist when polymer diffusion is strictly zero \u2013 the base flow would be linearly stable in the absence of diffusion. The implication is that the arrowhead structure in 2D simulations can arise from the PDI \u2013 essentially a numerical artifact of including diffusion. The diffusive term \u201ctriggers\u201d a finite-amplitude arrowhead-like wave that would not naturally appear at that parameter set without diffusion. In reality, molecular diffusion of polymers is extremely small, so such an instability might never dominate the transition; the flow could bypass it via a subcritical route. Thus, one must be cautious: the beautiful arrowhead patterns seen in some simulations may owe their existence to an unphysically large diffusion or other numerical regularization. In that sense, they are partly a _numerical artifact_. Numerical resolution and dimensionality further affect arrowhead formation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#role-of-diffusion-resolution-and-modeling-choices-physical-feature-or-numerical-artifact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Role of Diffusion, Resolution, and Modeling Choices: Physical Feature or Numerical Artifact?: Insufficient resolution can...",
    "content": "Insufficient resolution can introduce excessive numerical diffusion (smoothing out small scales), potentially _artificially stabilizing_ a large-scale structure like the arrowhead. Likewise, restricting the simulation to 2D (as was done in the initial arrowhead studies) removes the 3D disturbances that would break up the arrowhead. The 2D assumption is a strong modeling simplification that essentially _locks in_ the coherent structure. As [M. Lellep, M. Linkmann & A. Morozov, Proc. Natl. Acad. Sci., 121:9, e2318851121 (2024)](https://doi.org/10.1073/pnas.2318851121) note, one cannot draw reliable conclusions about EIT dynamics from strictly 2D simulations. In 2D, the narwhal is \u201cbenign\u201d and can remain as a steady state, but this is sustained only because the normal 3D instability modes are disallowed. In a fully resolved 3D simulation, that arrowhead state sits on a razor\u2019s edge \u2013 any slight spanwise perturbation will cause it to oscillate or breakdown.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#role-of-diffusion-resolution-and-modeling-choices-physical-feature-or-numerical-artifact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Role of Diffusion, Resolution, and Modeling Choices: Physical Feature or Numerical Artifact?: Thus, the arrowhead\u2019s...",
    "content": "Thus, the arrowhead\u2019s longevity in 2D is not reflective of physical reality; it\u2019s a consequence of an artificially constrained simulation. On the other hand, it\u2019s too strong to dismiss arrowheads entirely as a \u201cmere artifact.\u201d They are _mathematically legitimate_ nonlinear solutions of the viscoelastic flow equations (even if attained under special conditions) and they capture real physics \u2013 notably, a mechanism of polymer stretching and feedback. The consensus view is that arrowhead/narwhal structures are embedded but unstable features of the real system. They are \u201creal\u201d solutions, but one that the unconstrained system will only transiently visit. Diffusion and other numerical choices can exaggerate their prominence. In summary, high-fidelity simulations indicate that arrowheads do not represent a permanent physical flow pattern; rather, they are a byproduct of low-dimensional or diffusive modeling that nonetheless offer insight into the polymer\u2013flow interactions in EIT.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#role-of-diffusion-resolution-and-modeling-choices-physical-feature-or-numerical-artifact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Conclusion: Recent research converges...",
    "content": "Recent research converges on a nuanced view of arrowhead (narwhal) structures in EIT. They were a landmark discovery as a coherent viscoelastic wave, and they have deepened our insight into polymer\u2013flow interactions. However, both simulations and theory now indicate that they are transient players in fully developed 3D turbulence rather than the primary architects of it. In fact, the energy transfer analysis between flow and polymer reveals that both chaotic regimes maintain through the same near-wall mechanism, independent of the weak arrowhead structure. These findings indicate that the arrowhead represents a passive flow structure, detached from the self-sustaining mechanics of elastic turbulence inertia (EIT) ([M. Beneitez, J. Page, Y. Dubief & R. R. Kerswell, J. Fluid Mech., 981, A30 (2024)](https://doi.org/10.1017/jfm.2024.50)).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Conclusion: The community\u2019s focus...",
    "content": "The community\u2019s focus has shifted to how such structures populate the state space and trigger transitions, rather than expecting them to appear as steady patterns in experiments. Ongoing work continues to unravel the multi-stage transition to elastic and elasto-inertial turbulence $\u2013$ with arrowhead/narwhal waves serving as a valuable piece of the puzzle, albeit one with clear limitations.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 arrowheads in elastoinertial turbulence - Conclusion: This critical understanding...",
    "content": "This critical understanding ensures that we appreciate the arrowhead structures for what they are: insightful and pedagogical solutions that illuminate EIT\u2019s mechanics, but ultimately unstable in the wild chaos of real 3D turbulence. --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: Feb 24, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-Arrowheads-in-elastoinertial-turbulence.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Arrowheads-in-elastoinertial-turbulence/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Viscoelastic Worthington Jets & Droplets: Breaking the Surface of Bubble Physics: > [!abstract] TL;DR...",
    "content": "> [!abstract] TL;DR > When bubbles burst at a liquid surface, they create jets and droplets through a fascinating physical process. Our research reveals how adding polymers to the liquid dramatically changes this behavior, creating three distinct regimes depending on elasticity and relaxation time. These findings have implications for everything from oceanic aerosols to biomedical applications and industrial processes. Have you ever watched a bubble pop at the surface of your sparkling water or champagne? This seemingly simple event $-$ a bubble bursting $-$ conceals rich physics that connects to remarkably diverse phenomena, from ocean spray formation to pathogen transmission in respiratory droplets. As a fluid dynamicist studying interfacial phenomena, I've long been fascinated by what happens in the fleeting moments after a bubble bursts. When a bubble at a liquid\u2013air interface bursts, it often shoots out a thin, fast jet of liquid \u2013 a striking phenomenon known as a _Worthington jet_.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#viscoelastic-worthington-jets-droplets-breaking-the-surface-of-bubble-physics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Viscoelastic Worthington Jets & Droplets: Breaking the Surface of Bubble Physics: This process isn\u2019t...",
    "content": "This process isn\u2019t just a neat visual; it plays a role in everything from ocean spray to the fizz in a glass of champagne. In a typical Newtonian fluid like water (where the liquid\u2019s viscosity is constant), a bursting bubble leads to an upward jet driven by surface tension. As the jet rises, it can break up into one or multiple tiny droplets due to the Rayleigh\u2013Plateau instability (the same mechanism that causes a stream of water to form droplets). This is the classic picture that decades of research established for bursting bubbles in simple liquids. But what happens if the liquid is not so simple \u2013 say it contains a bit of polymer or has elastic properties? It turns out the story of bubble bursting gets a lot more interesting, which is what our study explores.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#viscoelastic-worthington-jets-droplets-breaking-the-surface-of-bubble-physics",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - The Phenomenon: More Than Just a Pop",
    "content": "When a bubble bursts at a liquid surface, it doesn't simply disappear. Instead, a complex sequence unfolds in milliseconds: 1. The bubble's thin film ruptures[^1][^2] 2. Capillary waves travel along the cavity surface[^3] 3. These waves converge at the bottom of the cavity 4. This convergence creates a focused flow that forms an upward-shooting \"Worthington jet\" [^4][^5][^6] 5. This jet may break into droplets that escape into the air While this process is relatively well-understood for simple liquids like water (Newtonian fluids), many real-world scenarios involve liquids containing polymers\u2014from biological fluids to industrial solutions. Our research investigated how these polymers fundamentally alter the bubble bursting dynamics. See [[2025-History-Worthington-jets-from-bursting-bubbles]] for historical context.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#the-phenomenon-more-than-just-a-pop",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - The Physics at Play: A Dance of Forces",
    "content": "> [!note] What makes a fluid viscoelastic? > Viscoelastic fluids contain polymers\u2014long molecular chains that introduce elastic behavior. Unlike ordinary liquids that simply flow, these fluids partially \"remember\" their shape when deformed, similar to a memory foam mattress, but in liquid form! The addition of polymers introduces two key parameters beyond the conventional Ohnesorge number (which relates viscous forces to inertial and surface tension forces): 1. Elastocapillary number $Ec$: The ratio of elastic modulus to Laplace pressure, measuring the strength of elastic effects. $$Ec = \\frac{GR_0}{\\gamma} $$ 2. Deborah number $De$: The ratio of relaxation time to process time, measuring the fluid's \"memory\". $$De = \\frac{\\lambda}{\\sqrt{\\rho R_0^3/\\gamma}}$$ > [!note] Note: > - Higher $Ec$ means stronger elastic effects > - Higher $De$ means the fluid \"remembers\" deformations longer",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#the-physics-at-play-a-dance-of-forces",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Key Discoveries: Three Distinct Regimes: Our most fascinating...",
    "content": "Our most fascinating finding was the emergence of three distinct regimes: > [!important] The Three Regimes > > 1. Jets forming droplets: At low elasticity or fast relaxation times, similar to Newtonian behavior but with modified dynamics > 2. Jets without droplet formation: At intermediate elasticity, where polymeric stresses suppress droplet breakup > 3. Complete jet suppression: At high elasticity, where polymer stresses prevent jet formation entirely What's particularly interesting is how these regimes depend on the Deborah number. For high De (approaching infinity), the viscoelastic medium preserves memory of deformations, and transitions occur at sharp Ec thresholds. For low De (approaching zero), the system behaves more like a Newtonian fluid with enhanced effective viscosity. The critical thresholds we identified provide fundamental insights into when and how polymers influence Worthington jets and droplets.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#key-discoveries-three-distinct-regimes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Key Discoveries: Three Distinct Regimes: Remarkably, while viscoelasticity...",
    "content": "Remarkably, while viscoelasticity significantly alters the jet dynamics, it doesn't affect the capillary wave speed!",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#key-discoveries-three-distinct-regimes",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Implementation Details: ElastoFlow Framework",
    "content": "To conduct these simulations, we developed a framework we call \"ElastoFlow\" for the Basilisk C environment. The implementation handles the complex interplay between viscoelasticity, surface tension, and inertia through: - Volume of Fluid (VoF) method for interface tracking - Log-conformation approach for numerical stability with viscoelastic constitutive models - Adaptive Mesh Refinement for efficiently capturing multiscale dynamics > [!tip] Technical Deep Dive Our computational approach overcomes the notorious \"high Weissenberg number problem\" that has historically plagued viscoelastic simulations. The log-conformation formulation we employed maintains the positive-definiteness of the conformation tensor, enabling stable simulations even in highly elastic regimes.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#implementation-details-elastoflow-framework",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Broader Implications: Beyond the Laboratory",
    "content": "This research has implications across several domains: - Oceanic aerosol formation: Understanding how polymers in seawater affect bubble bursting could improve climate models - Biomedical applications: Insights into how biological fluids produce droplets could help control pathogen transmission - Industrial processes: Better design of polymer-containing sprays and foams The ability to predict and potentially control droplet formation by adjusting polymer properties opens new avenues for engineering applications.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#broader-implications-beyond-the-laboratory",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - For Fellow Researchers",
    "content": "If you're interested in exploring this topic further, our simulation code is available on GitHub. We've designed ElastoFlow to be extensible and adaptable to various viscoelastic problems beyond bubble bursting. The framework includes: - Comprehensive implementation of the Oldroyd-B model - Adaptable boundary conditions - Detailed error controls for fluid properties - Streamlined workflows for high-performance computing environments We're continuing to develop this research direction, and we welcome collaborations and extensions of this work.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#for-fellow-researchers",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Final Thoughts: What I find...",
    "content": "What I find most fascinating about this study is how the addition of polymers\u2014molecular chains that introduce elasticity\u2014can fundamentally transform fluid behavior in ways that aren't immediately intuitive. A small amount of polymer can completely suppress droplet formation, or in some regimes, enhance it. This work highlights the rich interplay between elasticity, viscosity, and surface tension at fluid interfaces. Each time I watch a bubble burst in slow motion with our simulations, I'm reminded of how complex and beautiful fluid dynamics can be, even in seemingly simple phenomena we observe every day. For those interested in the technical details, please check out our paper and the available code repositories. And as always, I welcome questions and discussions about this fascinating corner of fluid dynamics! > [!faq] Original Paper > A. Dixit, A. Oratis, K. Zinelis, D. Lohse & V. Sanjay, Viscoelastic Worthington jets and droplets produced by bursting bubbles, J.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#final-thoughts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Final Thoughts: Context",
    "content": "Fluid Mech., 1010, A2 (2025) [Open Access](https://doi.org/10.1017/jfm.2025.237).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#final-thoughts",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Videos: Context",
    "content": "--- [^1]: V. Sanjay, U. Sen, P. Kant & D. Lohse, Taylor--Culick retractions and the influence of the surroundings, J. Fluid Mech., 948, A14 (2022), [doi: 10.1017/jfm.2022.671](https://doi.org/10.1017/jfm.2022.671) [^2]: E. Villermaux, Fragmentation versus cohesion, J. Fluid Mech., 898, P1 (2020), [doi: 10.1017/jfm.2020.366](https://doi.org/10.1017/jfm.2020.366) [^3]: V. Sanjay, D. Lohse & M. Jalaal, Bursting bubble in a viscoplastic medium, J. Fluid Mech., 922, A2 (2021), [doi: 10.1017/jfm.2021.489](https://doi.org/10.1017/jfm.2021.489) [^4]: A. M. Worthington, On the forms assumed by drops of liquids falling vertically on a horizontal plate, Proc. R. Soc. London A, 25, 261-272 (1877), [doi: 10.1098/rspl.1876.0048](https://doi.org/10.1098/rspl.1876.0048) [^5]: A. M. Worthington, A second paper on the forms assumed by drops of liquids falling vertically on a horizontal plate, Proc. R. Soc. London, 25, 498-503 (1877), [doi: 10.1098/rspl.1876.0073](https://doi.org/10.1098/rspl.1876.0073) [^6]: A. M.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#videos",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 jfm viscoelatic worthington jets - Videos: Worthington, A study...",
    "content": "Worthington, A study of splashes, London: Longman, Green and Co (1908), [link](https://bit.ly/Worthington-splash-book) --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: May 6, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-JFM-Viscoelatic-Worthington-jets/#videos",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Stokes waves of arbitrary order: Context",
    "content": "Vatsal Sanjay ([https://comphy-lab.org](https://comphy-lab.org)), CoMPhy Lab, Physics of Fluids, Univ.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#stokes-waves-of-arbitrary-order",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Stokes waves of arbitrary order: Function Definition",
    "content": "Twente $$\\eta(x)=a\\sum_{n=1}^{N}\\left[c_{n}\\,\\epsilon^{n}\\,\\cos\\bigl(nkx\\bigr)\\right],$$ where the function $c_n$ is $$ c_{n} = \\frac{(2n - 1)!!}{2^{n-1}\\,n!}.$$ ```c / * @brief Calculates the Stokes coefficient for nth order wave * @param n Order of the wave * @return Coefficient value based on double factorial calculation */ double stokes_coefficient (int n) { if (n == 1) return 1.0; int k = 2*n - 1; double double_factorial = 1.0; for (int i = 1; i <= k; i += 2) double_factorial *= i; return double_factorial / (pow(2,(n-1)) * tgamma(n+1)); } / * @brief Calculates the surface elevation for Stokes wave * @param x Horizontal position * @param a Wave amplitude * @param k Wave number * @param order Order of Stokes expansion * @return Surface elevation at position x */ double eta_stokes (double x, double a, double k, int order) { double eta = 0.0; double epsilon = k*a; for (int n = 1; n <= order; n++) { double c = stokes_coefficient(n); eta += c * pow(epsilon, n)*cos(n*k*x); } return eta * a; } ```",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#stokes-waves-of-arbitrary-order",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Problem Statement",
    "content": "How to describe nonlinear waves? - With a particular emphasis on extending the accuracy and applicability of wave theories for ocean engineering. The primary focus is to address periodic standing waves and Stokes waves, which are critical for understanding wave interactions in shallow and deep water regimes. Central to this is determining coefficients and analytical solutions for arbitrary-order expansions.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#problem-statement",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Methodology",
    "content": "- [[fentonNumericalMethodsNonlinear1999|Fenton (1999)]] emphasizes numerical solutions for nonlinear problems, including high-order Fourier methods for wave field expansions and their convergence properties. [@fentonNumericalMethodsNonlinear1999] - [[fentonNonlinearWaveTheories1990|Fenton (1990)]] extends nonlinear wave theories with cnoidal and Stokes theories to fifth-order expansions, using Fourier techniques for enhanced computational accuracy. [@fentonNonlinearWaveTheories1990] ![schematic-of-problem](_Media/Stokes%20waves_arbitary%20order-20241225034827809.png) Both employ polynomial and trigonometric expansions for solving boundary conditions and streamline the application of nonlinear theories in various wave contexts.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#methodology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Key Findings",
    "content": "1. Equation of Arbitrary Order Standing Waves: The governing expressions for surface elevation and velocity components leverage Fourier series expansions or hyperbolic functions, depending on the wave height and wavelength regime: - Standing wave elevation, $\\eta(x, t)$, approximates multiple harmonics where coefficients stem from iterative numerical techniques. - Stokes coefficients for arbitrary-order expansions use factorial-based formulas for precise amplitude corrections. 1. Numerical Accuracy: - Both methods demonstrate high accuracy when wave heights and wavelengths align with their regimes of validity, but overlap regions where neither theory performs optimally exist. - The fifth-order Stokes expansion offers excellent performance for waves with moderate wavelengths, while cnoidal approximations excel for shallow water waves.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#key-findings",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Implications",
    "content": "The work advances computational methods to extend the precision of nonlinear wave predictions, enabling: - Safer and more cost-effective coastal structure designs. - Improved models for wave propagation over complex seabeds.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#implications",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Recommendations",
    "content": "One option is to use mixed-order Stokes-cnoidal expansions for transitional regimes and refine computational methods for boundary conditions in breaking wave scenarios.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#recommendations",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Conclusion",
    "content": "Both approaches present robust solutions for their respective regimes but highlight the need for further refinement in transitional wavelength-depth conditions. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#conclusion",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Key Takeaways",
    "content": "- \ud83c\udf0a Stokes Theory Excellence: Best for deep water waves where wavelength-depth ratios are small. - \ud83c\udf0d Cnoidal Theory for Shallow Water: Ideal for long waves with large wavelength-depth ratios. - \ud83d\udd17 Overlap Regions: Transitional wave conditions (e.g., intermediate wavelength-depth ratios) challenge accuracy for both theories. - \ud83e\uddee Numerical Methods' Power: Fourier approximations enhance precision across nonlinear wave calculations. - \ud83d\udcc8 Wave Breaking Limits: Experiments suggest practical wave heights rarely approach theoretical maxima. - \ud83d\udc68 Streamline Accuracy: Velocity and pressure fields computed with Stokes and cnoidal methods align closely with Fourier-derived benchmarks. One-line summary: High-order Stokes and cnoidal theories provide accurate tools for nonlinear wave modeling, but computational refinements remain necessary for transitional regimes. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#key-takeaways",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - Arbitrary Order Standing Wave Equation",
    "content": "A general formula for Stokes coefficients of the \\(n\\)-th order wave, as described in the texts, resembles: ```c double stokes_coefficient(int n) { if (n == 1) return 1.0; double double_factorial = 1.0; for (int i = 1; i <= 2*n - 1; i += 2) double_factorial *= i; return double_factorial / (pow(2, n - 1) * tgamma(n + 1)); } ``` And for the surface elevation of Stokes waves: ```c double eta_stokes(double x, double a, double k, int order) { double eta = 0.0; double epsilon = k * a; for (int n = 1; n <= order; n++) { double c = stokes_coefficient(n); eta += c * pow(epsilon, n) * cos(n * k * x); } return eta * a; } ``` These computations involve harmonic terms, with coefficients determined iteratively or analytically, ensuring convergence and numerical stability.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#arbitrary-order-standing-wave-equation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - For dispersion relation in higher order: For the 0th...",
    "content": "For the 0th order: $$\\omega_0 = \\sqrt{gk},$$ Corrections for higher order gives $$\\frac{\\omega}{\\omega_0} = 1 + \\tfrac12\\epsilon^{2} + \\tfrac38\\epsilon^{4} + \\tfrac{5}{16}\\epsilon^{6} + \\tfrac{35}{128}\\epsilon^{8} +\\dots$$ * This is order `8`. - The trick here is how to calculate higher order coefficients. - Ref. - Stokes (1847), for the original perturbation approach [@stokes1847theory] - Longuet-Higgins [@longuet-higginsNewIntegralRelations1984] and other related works. - Lamb (1932): See Chapter 9 (especially art. 246\u2013250). Although Lamb typically writes out the celerity expansions $(c = \\omega / k)$, the frequency version is equivalent. [@Lamb1932] - Most Importantly $$c^2 = 1 + h^2 + \\frac{4}{3}h^4 + \\frac{17}{9}h^6 - \\frac{22}{9}h^8 + \\dots$$where $h = ak$ [[schwartzComputerExtensionAnalytic1974#^e59b15|page 11]] of [@schwartzComputerExtensionAnalytic1974].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#for-dispersion-relation-in-higher-order",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 stokes waves arbitary order - For dispersion relation in higher order: High\u2010order expansions of...",
    "content": "High\u2010order expansions of the Stokes dispersion relation up to ($\\epsilon^8$) have been verified numerically by Schwartz (1974). -> A good place for review is Annu. Rev. Fluid Mech. by L. W. Schwartz and J. D. Fenton [@schwartzStronglyNonlinearWaves1982] -> The code at [@sanjayComphylabStandingnonlinearwavesStanding2024] implements the above formulation for calculating the dispersion relation as a function of $ak$. It also uses the initial condition mentioned at the top of this document as the initial condition for the direct numerical simulations. ![[Stokes waves_arbitary order-20250125232439287.png]] ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Stokes-waves-arbitary-order/#for-dispersion-relation-in-higher-order",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Curvature Inversion in Laser\u2011Struck Droplets",
    "content": "> [!cite] > H. Fran\u00e7a, H. Schubert, O. Versolato & M. Jalaal, Laser-Induced Droplet Deformation: Curvature Inversion Explained from Instantaneous Pressure Impulse, J. Fluid Mech., 1020, A21 (2025). [DOI (OA): 10.1017/jfm.2025.10665](https://doi.org/10.1017/jfm.2025.10665)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#curvature-inversion-in-laserstruck-droplets",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Context: JavaScript",
    "content": "Extreme\u2011ultraviolet (EUV) nanolithography relies on shaping a liquid tin microdroplet into a thin sheet with a nanosecond \u201cprepulse\u201d, then ablating that sheet with a second pulse to create the EUV\u2011emitting plasma. The fluid dynamics between those two laser hits matter: sheet curvature, thickness, and expansion rate all feed directly into plasma formation and light yield. A persistent puzzle has been that many experiments produce _forward\u2011bending_ sheets (curving away from the incoming beam), whereas standard theories\u2014driven by Gaussian pressure impulses\u2014predicted the opposite. A recent JFM paper by Fran\u00e7a _et al._ resolves this discrepancy by introducing a _raised\u2011cosine_ pressure impulse and a single width parameter that governs when the sheet flips from backward to forward curvature. > [!summary] At a glance > > - Key idea: The _kurtosis_ of the instantaneous pressure impulse controls the sign of the tin sheet\u2019s curvature.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Context: Low\u2011kurtosis (raised\u2011cosine) impulses...",
    "content": "Low\u2011kurtosis (raised\u2011cosine) impulses can bend the sheet forward; Gaussian impulses cannot. > > - Switching knob: A dimensionless width (W) of the pressure impulse: curvature flips sign near ($W \\approx 2$). > > - Practical proxy: ($W$) correlates with the beam\u2011to\u2011drop size ratio ($d/D_0$); curvature inversion occurs experimentally at ($d/D_0 \\approx 0.55$). >",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - What\u2019s new?: A one\u2011parameter impulse...",
    "content": "A one\u2011parameter impulse that explains both curvature regimes. The authors propose a raised\u2011cosine surface\u2011pressure impulse ($f(\\theta)$) (truncated by a Heaviside function), tuned by a width ($W$). Unlike a Gaussian, the raised cosine is _platykurtic_ (negative excess kurtosis, about ($-0.59$)), i.e., a broad peak with short tails. That shape places momentum where it matters\u2014wide enough to avoid over\u2011focusing at the pole, but not so wide that the impulse wraps the entire sphere and stalls expansion. With this single control (W), the simulations produce both backward (negative) and forward (positive) curvature and predict a sign change at ($W \\simeq 2$). A predictive diagnostic from the initial velocity field.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#whats-new",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - What\u2019s new?: By solving Laplace\u2019s...",
    "content": "By solving Laplace\u2019s equation for the instantaneous pressure inside the drop and extracting the initial velocity via a Legendre\u2011series construction, the team shows that the _angle of maximum radial velocity_ ($\\theta_\\text{max}$) at ($t=0$) forecasts curvature: ($\\theta_\\text{max} \\pi/2$) \u2192 positive curvature. Gaussian impulses never push ($\\theta_\\text{max}$) beyond ($\\pi/2$); raised\u2011cosine impulses do when ($W$) is large enough. This \u201cearly\u2011time\u201d test lets practitioners vet a pressure impulse _without_ running a full DNS.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#whats-new",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - How did they show it?: Direct numerical simulations...",
    "content": "Direct numerical simulations with experimental anchoring. Using a VOF solver ([Basilisk C](http://basilisk.fr)) at very high resolution (quadtree level 14; minimum cell ($\\Delta = 0.0012 R_0$), i.e., $\\approx 833$ cells per radius), the authors integrate the incompressible two\u2011phase Navier\u2013Stokes equations with surface tension, initializing the droplet with the instantaneous velocity field implied by the chosen impulse. They keep effective Reynolds and Weber numbers large (based on the expansion velocity) to focus on inertial sheet formation; the surrounding gas is modeled at a small density/viscosity ratio for numerical stability. The simulated morphologies are compared side\u2011by\u2011side with stroboscopic shadowgraphs of tin droplets under vacuum, across a sweep of beam sizes. Mapping ($W$) to the lab\u2019s beam\u2011to\u2011drop ratio. To connect simulation to experiment, they correlate the impulse width with the optical focusing parameter.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#how-did-they-show-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - How did they show it?: The sheet curvature...",
    "content": "The sheet curvature measured in experiments varies monotonically with ($d/D_0$) and flips sign near ($d/D_0 \\approx 0.575$). A simple linear map, ($W \\approx 4.4(d/D_0) - 0.5$), aligns the numerical and experimental curvature trends over the tested range; within that map, the curvature sign change at ($W \\approx 2$) corresponds to ($d/D_0 \\approx 0.55$).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#how-did-they-show-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Why does the raised cosine work?",
    "content": "The curvature outcome is set by _where_ the impulse deposits momentum: - Gaussian (mesokurtic): widening the peak also lengthens the tails; the pressure effectively \u201cwraps\u201d the drop, leaving the region of strongest radial push _behind_ the equator ($\\theta_{\\max} \\pi/2$), driving the rim forward and producing positive curvature. The sign flip emerges around ($W \\approx 2$). (See table 1 and the ($\\theta_{\\max}$) analysis.) > [!note] Kurtosis as a design heuristic > Seeking forward curvature? Favor _low\u2011kurtosis_ impulses that are wide\u2011peaked but short\u2011tailed. The raised cosine is one smooth, tunable option\u2014but other low\u2011kurtosis shapes should behave similarly.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#why-does-the-raised-cosine-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - What does this mean for EUV source design?: - A controllable...",
    "content": "- A controllable knob for sheet morphology. Because ($W$) correlates with optical focusing, curvature can be selected via the beam diameter relative to the droplet, with the transition near ($d/D_0 \\approx 0.55$). This provides a practical handle to realize forward\u2011bending sheets\u2014beneficial for subsequent plasma shaping and possibly for more uniform ablation by the second pulse. (See the regime map and time\u2011lapse comparisons.) - Thickness distribution matters. Simulations indicate that larger ($W$) (unfocused, low\u2011kurtosis impulses) yield sheets with more uniform thickness across the span\u2014attractive for even energy deposition. (Snapshots in figure 6 show this trend.) > [!tip] Quick\u2011design recipe (from the paper\u2019s workflow) > > 1. Choose an impulse with _low kurtosis_ (e.g., raised cosine) and estimate ($W$) from the intended ($d/D_0$) using ($W \\approx 4.4(d/D_0) - 0.5$). > > 2.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#what-does-this-mean-for-euv-source-design",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - What does this mean for EUV source design?: Compute the ($t=0$)...",
    "content": "Compute the ($t=0$) velocity field and locate ($\\theta_{\\max}$). > \u2022 If ($\\theta_{\\max}>\\pi/2$) \u2192 expect forward curvature. > \u2022 If ($\\theta_{\\max} > 3. Only then run full DNS to refine thickness and late\u2011time rim dynamics. >",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#what-does-this-mean-for-euv-source-design",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Caveats and open questions",
    "content": "Despite the strong agreement on curvature, two gaps remain\u2014useful pointers for future work: 1. Expansion vs. propulsion speed. In the simulations, positive\u2011curvature cases (large (W)) systematically produce low expansion\u2011to\u2011propulsion ratios ($\\dot{R}_0/U_z [!warning] Outstanding physics to nail down > > - Direct experimental inference of the instantaneous impulse profile (ion/charge diagnostics, angular momentum flux). > > - Multi\u2011physics coupling (plasma expansion + incompressible hydrodynamics) to reconcile ($\\dot{R}_0/U_z$) in the forward\u2011curvature regime. > > - Fully 3D effects and fragmentation (beyond axisymmetry) at the sheet edge. >",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#caveats-and-open-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Perspective: Context",
    "content": "Fran\u00e7a _et al._ put curvature control on a firm mechanistic footing: it is the _spatial statistics_ of the impulse\u2014not merely its magnitude\u2014that sets the sheet\u2019s sign and shape. For engineers, the message is actionable: choose beam sizes (and therefore impulses) that place the maximum radial push beyond the equator; for theorists, the link between kurtosis and morphology suggests a compact language to classify laser\u2013droplet interactions across materials and scales. The raised\u2011cosine model is not the final word on the impulse, but it provides a powerful organizing principle and a practical design rule for EUV source optimization. --- > [!info] footnote > Useful quantities and timescales: ( $\\tau_p \\sim 10,\\mathrm{ns}$ ), ( $\\tau_i = R_0/\\dot{R}_0 \\sim 100,\\mathrm{ns}$ ), ( $\\tau_c = \\sqrt{\\rho R_0^3/\\gamma} \\sim 10,\\mu\\mathrm{s}$ ) for tin; typical ($U_z$) and ($\\dot{R}_0$) are ($\\mathcal{O}(10^2),\\mathrm{m,s^{-1}}$). > [!cite] Source > H. Fran\u00e7a, H. Schubert, O. Versolato & M.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#perspective",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 curvature inversion in laser\u2011struck droplets - Perspective: JavaScript",
    "content": "Jalaal, Laser-Induced Droplet Deformation: Curvature Inversion Explained from Instantaneous Pressure Impulse, J. Fluid Mech., 1020, A21 (2025). [DOI (OA): 10.1017/jfm.2025.10665](https://doi.org/10.1017/jfm.2025.10665) Key details on the impulse definition, ($\\theta_{\\max}$) diagnostic, ($W \\leftrightarrow d/D_0$) map, timescales, numerical setup, and limitations are summarized above; see in particular the introduction and figures 1\u20138, Appendix B (ambient effects), and Appendix E (velocity ratio). --- > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://comphy-lab.org/VatsalSy) > Date published:: Oct 6, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Curvature-Inversion-in-Laser\u2011Struck-Droplets/#perspective",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - James G. Oldroyd: Life, Work, and Legacy in Rheology",
    "content": "![](../_Media/James%20G.%20Oldroyd-1741128879880.png) > Portrait and bio sketch of James G. Oldroyd. Slide taken from John Hinch's talk on _Oldroyd B, and not A?_",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#james-g-oldroyd-life-work-and-legacy-in-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Early Life and Education: James Gardner Oldroyd...",
    "content": "James Gardner Oldroyd (25 April 1921 \u2013 22 November 1982) demonstrated exceptional mathematical aptitude in Bradford, England. He entered Bradford Grammar School at age 10, matriculating in nine subjects by age 14. Unable to advance immediately to university due to his youth, he dedicated four years in sixth form to developing mathematical expertise while acquiring fluency in German and French. In 1939, Oldroyd secured a state scholarship to Trinity College, Cambridge, where he established an exemplary academic record. He received the Rouse Ball Prize in 1941 and the Mayhew Prize in 1942 as Cambridge's outstanding student in applied mathematics, graduating with first-class honors. Oldroyd maintained strong academic affiliations with Trinity College post-graduation, returning as a research scholar (1945\u201346) and securing a junior fellowship (1947).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#early-life-and-education",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Early Life and Education: During this period,...",
    "content": "During this period, he completed his PhD thesis titled *\u201cA mathematical discussion of some rheological problems,\u201d* with guidance and critiques from W. R. Dean (of *Dean flow* fame) and Alan H. Wilson. Dean and Wilson $-$ both Cambridge trained mathematicians significantly influenced Oldroyd's approach to fluid mechanics and solid mechanics. His doctoral work (PhD awarded 1949) established fundamental principles in non-Newtonian fluid mechanics, culminating in his Cambridge Sc.D. in 1958 for his substantial contributions to the field [^1].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#early-life-and-education",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: World War II...",
    "content": "World War II interrupted Oldroyd\u2019s academic pursuits but also broadened his experience. From 1942 to 1945 he worked at the Ministry of Supply in Aberporth, Wales, conducting rocket research for Britain\u2019s war effort. This foray into applied physics and engineering gave him practical insight into fluid and material behavior under extreme conditions. After the war, Oldroyd transitioned back to research in emerging areas of fluid mechanics. In 1945 he joined the Fundamental Research Laboratory of Courtaulds in Maidenhead, a major industrial lab focused on artificial fibers and polymers [^2]. Notably, his former Cambridge tutor, Alan H. Wilson, had also moved to Courtaulds, and likely helped recruit Oldroyd to this innovative environment [^1]. At Courtaulds, Oldroyd worked closely with experimental rheologists D. J. Strawbridge and B. A. Toms, who were investigating the unusual flow behavior of polymer solutions [^2].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: Examples",
    "content": "These collaborations exposed Oldroyd to cutting-edge rheometry and puzzling phenomena \u2013 for example, B. A. Toms had just discovered the drag reduction effect (later called the *Toms effect*) where tiny polymer additives dramatically lower turbulent friction. Oldroyd became fascinated by such non-Newtonian effects and even suggested early on that *wall slip* at the pipe boundary might explain Toms\u2019s observations [^3]. This period at Courtaulds was formative: it immersed Oldroyd in real-world rheological problems, from the processing of viscose fibers to the oddities of polymer solution flows, inspiring him to seek a deeper theoretical framework for these `elastic` liquids. Oldroyd\u2019s first publications in the late 1940s already show him tackling non-Newtonian fluid mechanics with a blend of mathematical rigor and practical insight. He initially focused on *viscoplasticity*, analyzing the flow of Bingham solids (materials that behave as a solid until a yield stress is exceeded when they flow).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: In 1947, while...",
    "content": "In 1947, while still in Cambridge, he published a series of papers on the *plastic flow of Bingham materials*, developing a `rational formulation` of their equations of flow and solving flow problems between moving cylinders. These early works, drawn from his dissertation, addressed how yield-stress fluids deform, essentially bridging solid plasticity and fluid flow. By 1949, Oldroyd had broadened his scope to other types of non-Newtonian fluids: he examined steady laminar flows in non-Newtonian liquids and noted anomalies like pressure gradients in pipe flow that couldn\u2019t be explained by classical viscosity alone. He even proposed experimental methods to detect wall slip and other flow peculiarities at the first International Congress on Rheology in 1948 [^1].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: These experiences convinced...",
    "content": "These experiences convinced Oldroyd that a unifying theoretical description for *complex fluids* was needed \u2013 one that could encompass the behavior of elastic liquids (polymer solutions), viscous suspensions, and even solids with memory. This realization set the stage for his groundbreaking work in 1950.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: In 1950, James...",
    "content": "In 1950, James G. Oldroyd published what is now considered \u201cprobably the most important single paper in theoretical rheology.\u201d[^6] Titled *\u201cOn the Formulation of Rheological Equations of State,\u201d*[^4] this paper established the basic principles for mathematical models of complex fluids. Oldroyd addressed a fundamental issue: existing viscoelastic models at the time (such as the Jeffreys model) were not *frame-invariant* \u2013 their predictions could depend on the observer\u2019s frame of reference, which is unphysical [^5]. Influenced by earlier work of Sir Harold Jeffreys and by a 1946 study of bitumen by H. Fr\u00f6hlich and R. Sack, Oldroyd recognized that the way one computes the time-derivative of stress in a flowing material is crucial. In essence, he argued that when a material element moves, rotates, and deforms, the rate-of-change of stress must be evaluated in a *convected frame* moving with the material.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: Definitions",
    "content": "To achieve this, Oldroyd introduced two new definitions of the stress derivative \u2013 the upper-convected and lower-convected time derivatives \u2013 which account for material rotation and stretching in different ways: > Lower convective Oldroyd derivative: > $$ \\stackrel{\\triangle}{A} = \\frac{DA}{Dt} + \\mathbf{A} \\cdot (\\nabla \\mathbf{u})^T + \\nabla \\mathbf{u} \\cdot \\mathbf{A}. $$ > Upper convective Oldroyd derivative: > $$ \\stackrel{\\nabla}{A} = \\frac{DA}{Dt} - \\mathbf{A} \\cdot (\\nabla \\mathbf{u})^T - \\nabla \\mathbf{u} \\cdot \\mathbf{A}. $$ Applying these ideas, Oldroyd showed that if one takes the classical *Jeffreys model* (a combination of an elastic spring and two viscous dashpots) and replaces the ordinary time derivatives with his convected derivatives, one obtains two consistent viscoelastic models [^5].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: These he called...",
    "content": "These he called \u201cModel A\u201d (using the lower-convected derivative) and \u201cModel B\u201d (using the upper-convected derivative) \u2013 known today as the Oldroyd-A and Oldroyd-B models [^5]. > Oldroyd-A (Lower convected derivative): > $$ \\sigma + \\tau_1 \\stackrel{\\triangle}{\\sigma} = 2\\mu^*(\\mathbf{E} + \\tau_2 \\stackrel{\\triangle}{\\mathbf{E}}),$$ > Oldroyd-B (Upper convected derivative): > $$ \\sigma + \\tau_1 \\stackrel{\\nabla}{\\sigma} = 2\\mu^*(\\mathbf{E} + \\tau_2 \\stackrel{\\nabla}{\\mathbf{E}})$$ Both models reduce to the same behavior in a stationary reference frame, but they differ in how they predict stresses in flows involving rotation or deformation of the fluid parcel. Oldroyd\u2019s 1950 paper thus laid down a clear *frame-indifference* requirement for rheological equations, a cornerstone for modern continuum mechanics of non-Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: It was a...",
    "content": "It was a bold theoretical leap that immediately gave researchers two possible constitutive equations for viscoelastic liquids. > [!danger] Note: > Oldroyd, characteristically cautious, noted that choosing between Model A and B `depends on the physics` of the material, though he offered no immediate criteria for selection [^5]. Nonetheless, the mere formulation of these models has been instructive. It provided, for the first time, a concrete mathematical language to describe fluids with both viscous and elastic characteristics (*viscoelastic* fluids) in a way that is invariant under changes of frame. This achievement earned Oldroyd international recognition \u2013 including the Gold Medal of the British Society of Rheology and a special issue of the BSR Bulletin honoring his 60th birthday [^6] \u2013 and it set the stage for much of the theoretical rheology that followed.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg\u2019s Rod-Climbing and the Preferred Model: While Oldroyd initially...",
    "content": "While Oldroyd initially presented Models A and B as two equally plausible formulations, subsequent insights and experiments soon favored one over the other. In the very same 1950 paper, at the end, Oldroyd himself included a telling calculation: the flow of an elastic liquid around a rotating rod. This was not an arbitrary choice \u2013 it related to a famous experiment by Karl Weissenberg a few years earlier. Weissenberg had observed that when a rod is rotated in a polymer solution, the fluid *climbs up* the rod against gravity (now known as the Weissenberg effect or rod-climbing effect) due to the elastic normal stresses generated in the fluid. Oldroyd wanted to see how his two model fluids would behave in this scenario. The result was striking: Oldroyd-B (upper-convected) predicted the fluid would climb the rod, matching Weissenberg\u2019s observations, whereas Oldroyd-A (lower-convected) predicted the opposite \u2013 the fluid would be pushed downwards (a \u201crod-dropping\u201d effect).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg\u2019s Rod-Climbing and the Preferred Model: The latter phenomenon...",
    "content": "The latter phenomenon had never been observed in polymer fluids. Thus, by comparing both models against empirical reality, Oldroyd-B emerged as the more physically relevant model for polymeric (viscoelastic) fluids. As Oldroyd and others noted, the *rod-climbing test* essentially singled out Model B as the correct choice for liquids like dilute polymer solutions. Oldroyd commented that Model B should *\u201cbe favoured\u201d* in such cases, aligning with Weissenberg\u2019s findings. (Indeed, the inverse \u201crod-dipping\u201d behavior of Model A was only realized decades later in very different materials, such as dense suspensions of particles, confirming Oldroyd\u2019s intuition that the choice depends on the material\u2019s microphysics.) ![](../_Media/James%20G.%20Oldroyd-1741126421305.png) > A classic demonstration of the Weissenberg rod-climbing effect. A rotating rod in a viscoelastic polymer solution causes the fluid to climb up along the rod, due to positive normal stress differences.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg\u2019s Rod-Climbing and the Preferred Model: Oldroyd\u2019s upper-convected Model...",
    "content": "Oldroyd\u2019s upper-convected Model B correctly captures this effect, whereas Model A would predict a downward dip, which is not observed in polymer fluids. Figure credits: [Henry Ng and Rob Poole, University of Liverpool](https://fluids.ac.uk/gallery/zoomify/665). Beyond qualitative rod-climbing, more detailed microstructural studies in subsequent years reinforced the supremacy of Oldroyd-B for polymeric liquids. In the 1960s, rheologists developed molecular models of polymer solutions \u2013 envisioning long polymer molecules as tiny spring\u2013dashpot elements or \u201cdumbbells\u201d dispersed in a solvent. When John Hinch and others revisited Oldroyd\u2019s models in light of these developments, they found a remarkable connection: the simplest molecular model of a polymer chain in flow (the elastic dumbbell model) leads mathematically directly to the Oldroyd-B constitutive equation [^5].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg\u2019s Rod-Climbing and the Preferred Model: In other words,...",
    "content": "In other words, if one treats a polymer molecule as two beads connected by a spring dragged through a viscous solvent, the macroscopic stress evolution follows Oldroyd\u2019s upper-convected form (with the polymer\u2019s finite relaxation time corresponding to Oldroyd-B\u2019s parameters). This result explained why Oldroyd-B captured many polymer solution behaviors so well \u2013 it was essentially *derived from first principles* of polymer micro-dynamics. Oldroyd-A, in contrast, did not emerge from any analogous physical picture for flexible polymers. By the late 20th century, therefore, Oldroyd-B had become the standard viscoelastic fluid model for dilute polymer solutions in rheology and computational fluid dynamics, whereas Oldroyd-A largely faded from use.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg\u2019s Rod-Climbing and the Preferred Model: As John Hinch...",
    "content": "As John Hinch humorously noted, a survey of literature reveals thousands of papers employing \u201cOldroyd-B\u201d in their title or keywords, but only a handful mentioning \u201cOldroyd-A\u201d. ![](../_Media/James%20G.%20Oldroyd-1741126749363.jpeg) The reason is clear: Oldroyd-B not only passes key experimental tests but also has a firm basis in polymer molecular theory, making it the preferred tool for scientists and engineers modeling viscoelastic flows. The legacy of Oldroyd\u2019s 1950 insight is thus encapsulated in the ubiquity of the Oldroyd-B model \u2013 a tribute to his ability to capture the essential physics of elastic fluids in a simple equation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: After 1950, Oldroyd...",
    "content": "After 1950, Oldroyd continued to build on his framework and ventured into new problems, further cementing his status as a pioneer in rheology. In 1953, he published a notable paper on *\u201cThe elastic and viscous properties of emulsions and suspensions.\u201d* [^7] Here, Oldroyd extended his constitutive modeling to multiphase systems, showing how a mixture of a liquid with dispersed droplets or particles could exhibit viscoelastic behavior. He demonstrated (for a dilute emulsion of liquid droplets) that the interfacial tension of the droplets provides a restoring force against deformation, effectively giving the emulsion an elastic component [^3]. This work was an early example of micro-rheology \u2013 linking microscopic structure to macroscopic rheological properties \u2013 and it illustrated Oldroyd\u2019s knack for generalizing his models to diverse materials.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: JavaScript",
    "content": "He also investigated the effect of surfactant films on droplet interfaces in emulsions, recognizing that a stabilizing film could alter the combined fluid\u2019s elasticity. These studies by Oldroyd in the 1950s are considered pioneering, as they connected continuum rheology with micro-scale mechanisms in suspensions and emulsions. Oldroyd\u2019s theoretical explorations in the mid-1950s also produced insights into what we now call \u201csecond-order fluids.\u201d In a 1958 paper, he analyzed normal stress effects (differences in normal stresses) in steady flows of idealized viscoelastic liquids, using a general invariant formulation that included up to quadratic terms in stresses [^8]. Notably, he examined the conditions for the Weissenberg effect (rod-climbing) to occur \u201cin a positive or negative sense,\u201d essentially exploring the parameter space where a fluid would climb or dip around a rod.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: This comprehensive study...",
    "content": "This comprehensive study brought clarity to how non-Newtonian normal stresses arise in shear and rotational flows, and it introduced what became known as the Oldroyd 8-constant model (a generalized linear viscoelastic model with eight material constants). Such work laid the groundwork for later researchers like Coleman, Noll, and Rivlin, who in the same era were developing the modern continuum mechanics of fluids. Oldroyd\u2019s approach was always characterized by careful attention to invariant formulation (he cited the earlier convected-coordinate ideas of F. Hencky and others [^3]) and by a desire to keep models as simple as possible while capturing the essential physics. In 1961, he published a survey in *Rheologica Acta* on *\u201cthe hydrodynamics of materials whose rheological properties are complicated,\u201d* [^9] reflecting on how to extend classical hydrodynamics to fluids with memory and elasticity.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: He even ventured...",
    "content": "He even ventured into esoteric territory by exploring constitutive equations in a general relativistic context (a 1970 paper on equations of state in general relativity [^10]), showing the breadth of his mathematical curiosity. Throughout the 1960s and 1970s, Oldroyd remained an active, though not prolific, author. He was selective in his publications, preferring depth over quantity \u2013 in nearly 40 years he published fewer than 30 papers [^1], mostly as a single author. Yet those papers are dense with ideas that continued to influence rheology. He developed a theory of viscoplastic boundary layers. He also revisited thermodynamics and continuum mechanics, searching for rheological models consistent with the laws of thermodynamics (as seen in his 1976 reflections).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: Even in his...",
    "content": "Even in his final years, Oldroyd continued to synthesize his lifetime of insights: his last paper, published posthumously in 1984, was titled *\u201cAn approach to non-Newtonian fluid mechanics,\u201d*[^11] offering a grand overview of the field - a treat to read for our generation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Oldroyd\u2019s influence extended...",
    "content": "Oldroyd\u2019s influence extended beyond his written work; he was also a guiding figure and mentor in the rheology community. In 1953, the same year he took up a professorship, he served as Treasurer of the 2nd International Congress of Rheology held in Cambridge [^2] \u2013 a gathering of the world\u2019s top rheologists. He later became President of the British Society of Rheology (BSR) from 1955 to 1957, helping to shape the direction of rheological research in the UK [^12]. Oldroyd had moved to academia in 1953 as Professor of Mathematics at the University of Wales, Swansea, where he also headed the Applied Mathematics Department from 1957. In 1965, he was appointed Professor at Liverpool University, eventually becoming Head of the Department of Applied Mathematics and Theoretical Physics there [^2]. In these roles, Oldroyd supervised a small number of doctoral students \u2013 notably Kenneth Walters, who completed his PhD under Oldroyd at Swansea.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Walters would go...",
    "content": "Walters would go on to become a prominent rheologist himself (co-founding the *Journal of Non-Newtonian Fluid Mechanics* in 1976) and later reminisced that although Oldroyd guided only *\u201chalf a dozen\u201d* PhD students, his impact on them \u2013 and on the field \u2013 was profound [^13]. Oldroyd\u2019s students and colleagues admired his deep physical intuition and his knack for reducing complex problems to their core elements. Amusingly, Walters recalled that Oldroyd was *\u201cno sportsman,\u201d* yet somehow many of his research students were star cricket players \u2013 a coincidence that Oldroyd, with his gentle humor, tolerated even if he didn\u2019t share their sporting enthusiasm [^13]. In recognition of his scientific contributions, Oldroyd received numerous honors. Cambridge University awarded him the Adams Prize in 1964, one of its highest accolades in mathematics, for his work on the mechanics of non-Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: The British Society...",
    "content": "The British Society of Rheology bestowed upon him its Gold Medal in 1984 (the year after what would have been Oldroyd\u2019s retirement), celebrating a lifetime of achievement in rheology [^2]. Tributes poured in as he reached his 60th birthday in 1981 \u2013 the BSR dedicated a special issue of its bulletin to him, and luminaries like professor R. B. Bird lauded Oldroyd\u2019s contributions.[^6] In fact, at the 1988 International Congress on Rheology in Sydney, Bob Bird gave an opening lecture entitled *\u201cThe Two JG\u2019s\u201d* in honor of J. G. Oldroyd and J. G. Kirkwood \u2013 comparing Oldroyd, the continuum mechanician, and Kirkwood, the molecular theorist, as two giants who bridged the gap between macroscopic and microscopic understandings of fluid behavior [^1]. This was a testament to how Oldroyd\u2019s work, particularly the Oldroyd-B model, had become a cornerstone that linked molecular theory with continuum modeling. Unfortunately, James G.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Oldroyd\u2019s life was...",
    "content": "Oldroyd\u2019s life was cut short in 1982 \u2013 he died suddenly of an apparent heart attack while on his way to the university in Liverpool [^2] \u2013 but his legacy endures vibrantly. His name is forever attached to the Oldroyd-B model, a staple in rheology textbooks and simulations, and his ideas on convected derivatives underpin all modern viscoelastic fluid theories. In computational fluid dynamics and engineering today, Oldroyd\u2019s models are routinely used to simulate polymer processing, biological fluid flows, and complex material behavior, enabling predictions of how materials will respond under flow with both viscous and elastic forces at play. In hindsight, John Hinch and other colleagues note that Oldroyd\u2019s genius was in formulating simple yet physically sound models \u2013 *\u201cthe first twelve pages\u201d* of his 1950 paper, as Bob Bird once remarked, *contained the seeds of an entire field*.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: By following a...",
    "content": "By following a historical narrative from classical mechanics to modern rheology, Oldroyd essentially wrote the chapter that connects Isaac Newton\u2019s fluid (ideal viscous) to James Clerk Maxwell\u2019s elastic solid, and in doing so, he helped create the science of rheology as we know it. His work evolved from early studies of idealized plastic solids to the elegant Oldroyd-B equation, reflecting a consistent vision: to understand and predict the behavior of materials that are not purely solid nor liquid, but something in between. This vision, shaped by great mentors, wartime experiences, industrial collaboration, and personal insight, makes James G. Oldroyd a towering figure in the history of rheology and fluid mechanics \u2013 one whose influence is still climbing upward, much like the fluid on Weissenberg\u2019s spinning rod. [^1]: I. A. Frigaard, G. H. McKinley, R. J. Poole & K. Walters, Editorial for special issue on \"Oldroyd at 100: Celebrating the impact of JG Oldroyd on non-Newtonian fluid mechanics\", J.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Context",
    "content": "Non-Newtonian Fluid Mech., 301, 104749 (2022), [Link](https://nnf.mit.edu/sites/default/files/publications/files/Oldroyd_SI_Editorial_FINAL.pdf). [^2]: James G. Oldroyd \u2013 Wikipedia: [German](https://de.wikipedia.org/wiki/James_G._Oldroyd) and [English](https://en.wikipedia.org/wiki/James_G._Oldroyd). [^3]: R. I. Tanner & K. Walters, Rheology: An Historical Perspective, Elsevier (1998). [Link](https://bit.ly/4bohW0t). [^4]: J. G. Oldroyd, On the formulation of rheological equations of state, Proc. R. Soc. Lond. A, 200:1063, 523-541 (1950) [^5]: J. Hinch & O. Harlen, Oldroyd B, and not A?, J. Non-Newtonian Fluid Mech., 298, 104668 (2021) [link](http://www.damtp.cam.ac.uk/user/hinch/publications/Oldroyd12b.pdf#:~:text=Sack%20%281946%29%20,would%20climb%20the%20rod%2C%20as). [^6]: #TODO needs citation and wikipedia is not it [^7]: J. G. Oldroyd, The elastic and viscous properties of emulsions and suspensions, Proc. R. Soc. Lond. A, 218:1132, 122-132 (1953) [^8]: J. G.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Oldroyd, Non-Newtonian effects...",
    "content": "Oldroyd, Non-Newtonian effects in steady motion of some idealized elastico-viscous liquids, Proc. R. Soc. Lond. A, 245:1241, 278-297 (1958). [^9]: J. G. Oldroyd, The hydrodynamics of materials whose rheological properties are complicated, Rheol. Acta, 1:4, 337-344 (1961) [^10]: J. G. Oldroyd, Equations of state of continuous matter in general relativity, Proc. R. Soc. Lond. A, 316:1524, 1-28 (1970) [^11]: J. G. Oldroyd, An approach to non-Newtonian fluid mechanics, J. Non-Newtonian Fluid Mech., 14, 9-46 (1984) [^12]: [Former BSR Presidents - British Society of Rheology](https://www.bsr.org.uk/pages/former-bsr-presidents#:~:text=Image%3A%20Photo%20of%20Oldroyd) [^13]: [Oral History Interviews, Kenneth Walters - American Institute of Physics](https://www.aip.org/history-programs/niels-bohr-library/oral-histories/47534#:~:text=match%20at%20L1785%20The%20amazing,Fluid%20Mechanics%2C%E2%80%99%E2%80%99%20Journal%20of%20Non)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - James G. Oldroyd: Life, Work, and Legacy in Rheology",
    "content": "![Portrait of James G. Oldroyd|1066x24](_Media/James%20G.%20Oldroyd-1741128879880.png) > Portrait and bio sketch of James G. Oldroyd. Slide taken from John Hinch's talk on _Oldroyd B, and not A?_",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#james-g-oldroyd-life-work-and-legacy-in-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Early Life and Education: During this period,...",
    "content": "During this period, he completed his PhD thesis titled _\"A mathematical discussion of some rheological problems,\"_ with guidance and critiques from W. R. Dean (of _Dean flow_ fame) and Alan H. Wilson. Dean and Wilson\u2014both Cambridge-trained mathematicians\u2014significantly influenced Oldroyd's approach to fluid mechanics and solid mechanics. His doctoral work (PhD awarded 1949) established fundamental principles in non-Newtonian fluid mechanics, culminating in his Cambridge Sc.D. in 1958 for his substantial contributions to the field [^1].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#early-life-and-education",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: World War II...",
    "content": "World War II interrupted Oldroyd's academic pursuits but also broadened his experience. From 1942 to 1945 he worked at the Ministry of Supply in Aberporth, Wales, conducting rocket research for Britain's war effort. This foray into applied physics and engineering gave him practical insight into fluid and material behavior under extreme conditions. After the war, Oldroyd transitioned back to research in emerging areas of fluid mechanics. In 1945 he joined the Fundamental Research Laboratory of Courtaulds in Maidenhead, a major industrial lab focused on artificial fibers and polymers [^2]. Notably, his former Cambridge tutor, Alan H. Wilson, had also moved to Courtaulds, and likely helped recruit Oldroyd to this innovative environment [^1]. At Courtaulds, Oldroyd worked closely with experimental rheologists D. J. Strawbridge and B. A. Toms, who were investigating the unusual flow behavior of polymer solutions [^2].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: Examples",
    "content": "These collaborations exposed Oldroyd to cutting-edge rheometry and puzzling phenomena \u2013 for example, B. A. Toms had just discovered the drag reduction effect (later called the _Toms effect_) where tiny polymer additives dramatically lower turbulent friction. Oldroyd became fascinated by such non-Newtonian effects and even suggested early on that _wall slip_ at the pipe boundary might explain Toms's observations [^3]. This period at Courtaulds was formative: it immersed Oldroyd in real-world rheological problems, from the processing of viscose fibers to the oddities of polymer solution flows, inspiring him to seek a deeper theoretical framework for these `elastic` liquids. Oldroyd's first publications in the late 1940s already show him tackling non-Newtonian fluid mechanics with a blend of mathematical rigor and practical insight. He initially focused on _viscoplasticity_, analyzing the flow of Bingham solids (materials that behave as a solid until a yield stress is exceeded when they flow).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: In 1947, while...",
    "content": "In 1947, while still in Cambridge, he published a series of papers on the _plastic flow of Bingham materials_, developing a `rational formulation` of their equations of flow and solving flow problems between moving cylinders. These early works, drawn from his dissertation, addressed how yield-stress fluids deform, essentially bridging solid plasticity and fluid flow. By 1949, Oldroyd had broadened his scope to other types of non-Newtonian fluids: he examined steady laminar flows in non-Newtonian liquids and noted anomalies like pressure gradients in pipe flow that couldn't be explained by classical viscosity alone. He even proposed experimental methods to detect wall slip and other flow peculiarities at the first International Congress on Rheology in 1948 [^1].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Wartime Work and the Path to Rheology: These experiences convinced...",
    "content": "These experiences convinced Oldroyd that a unifying theoretical description for _complex fluids_ was needed \u2013 one that could encompass the behavior of elastic liquids (polymer solutions), viscous suspensions, and even solids with memory. This realization set the stage for his groundbreaking work in 1950.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#wartime-work-and-the-path-to-rheology",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: In 1950, James...",
    "content": "In 1950, James G. Oldroyd published what is now considered \"probably the most important single paper in theoretical rheology.\"[^6] Titled _\"On the Formulation of Rheological Equations of State,\"_[^4] this paper established the basic principles for mathematical models of complex fluids. Oldroyd addressed a fundamental issue: existing viscoelastic models at the time (such as the Jeffreys model) were not _frame-invariant_ \u2013 their predictions could depend on the observer's frame of reference, which is unphysical [^5]. Influenced by earlier work of Sir Harold Jeffreys and by a 1946 study of bitumen by H. Fr\u00f6hlich and R. Sack, Oldroyd recognized that the way one computes the time-derivative of stress in a flowing material is crucial. In essence, he argued that when a material element moves, rotates, and deforms, the rate-of-change of stress must be evaluated in a _convected frame_ moving with the material.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: Definitions",
    "content": "To achieve this, Oldroyd introduced two new definitions of the stress derivative \u2013 the upper-convected and lower-convected time derivatives \u2013 which account for material rotation and stretching in different ways: > Lower convective Oldroyd derivative: $$ \\stackrel{\\triangle}{A} = \\frac{DA}{Dt} + \\mathbf{A} \\cdot (\\nabla \\mathbf{u})^T + \\nabla \\mathbf{u} \\cdot \\mathbf{A}. $$ > Upper convective Oldroyd derivative: $$ \\stackrel{\\nabla}{A} = \\frac{DA}{Dt} - \\mathbf{A} \\cdot (\\nabla \\mathbf{u})^T - \\nabla \\mathbf{u} \\cdot \\mathbf{A}. $$ Applying these ideas, Oldroyd showed that if one takes the classical _Jeffreys model_ (a combination of an elastic spring and two viscous dashpots) and replaces the ordinary time derivatives with his convected derivatives, one obtains two consistent viscoelastic models [^5].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: These he called...",
    "content": "These he called \"Model A\" (using the lower-convected derivative) and \"Model B\" (using the upper-convected derivative) \u2013 known today as the Oldroyd-A and Oldroyd-B models [^5]. > Oldroyd-A (Lower convected derivative): > $$ \\sigma + \\tau_1 \\stackrel{\\triangle}{\\sigma} = 2\\mu^*(\\mathbf{E} + \\tau_2 \\stackrel{\\triangle}{\\mathbf{E}}),$$ > Oldroyd-B (Upper convected derivative): > $$ \\sigma + \\tau_1 \\stackrel{\\nabla}{\\sigma} = 2\\mu^*(\\mathbf{E} + \\tau_2 \\stackrel{\\nabla}{\\mathbf{E}})$$ Both models reduce to the same behavior in a stationary reference frame, but they differ in how they predict stresses in flows involving rotation or deformation of the fluid parcel. Oldroyd's 1950 paper thus laid down a clear _frame-indifference_ requirement for rheological equations, a cornerstone for modern continuum mechanics of non-Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - The 1950 Breakthrough: Formulating Rheological Equations of State: It was a...",
    "content": "It was a bold theoretical leap that immediately gave researchers two possible constitutive equations for viscoelastic liquids. > [!danger] Note: Oldroyd, characteristically cautious, noted that choosing between Model A and B `depends on the physics` of the material, though he offered no immediate criteria for selection [^5]. Nonetheless, the mere formulation of these models has been instructive. It provided, for the first time, a concrete mathematical language to describe fluids with both viscous and elastic characteristics (_viscoelastic_ fluids) in a way that is invariant under changes of frame. This achievement earned Oldroyd international recognition \u2013 including the Gold Medal of the British Society of Rheology and a special issue of the BSR Bulletin honoring his 60th birthday [^6] \u2013 and it set the stage for much of the theoretical rheology that followed.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#the-1950-breakthrough-formulating-rheological-equations-of-state",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg's Rod-Climbing and the Preferred Model: While Oldroyd initially...",
    "content": "While Oldroyd initially presented Models A and B as two equally plausible formulations, subsequent insights and experiments soon favored one over the other. In the very same 1950 paper, at the end, Oldroyd himself included a telling calculation: the flow of an elastic liquid around a rotating rod. This was not an arbitrary choice \u2013 it related to a famous experiment by Karl Weissenberg a few years earlier. Weissenberg had observed that when a rod is rotated in a polymer solution, the fluid _climbs up_ the rod against gravity (now known as the Weissenberg effect or rod-climbing effect) due to the elastic normal stresses generated in the fluid. Oldroyd wanted to see how his two model fluids would behave in this scenario. The result was striking: Oldroyd-B (upper-convected) predicted the fluid would climb the rod, matching Weissenberg's observations, whereas Oldroyd-A (lower-convected) predicted the opposite \u2013 the fluid would be pushed downwards (a \"rod-dropping\" effect).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg's Rod-Climbing and the Preferred Model: The latter phenomenon...",
    "content": "The latter phenomenon had never been observed in polymer fluids. Thus, by comparing both models against empirical reality, Oldroyd-B emerged as the more physically relevant model for polymeric (viscoelastic) fluids. As Oldroyd and others noted, the _rod-climbing test_ essentially singled out Model B as the correct choice for liquids like dilute polymer solutions. Oldroyd commented that Model B should _\"be favoured\"_ in such cases, aligning with Weissenberg's findings. (Indeed, the inverse \"rod-dipping\" behavior of Model A was only realized decades later in very different materials, such as dense suspensions of particles, confirming Oldroyd's intuition that the choice depends on the material's microphysics.) ![Weissenberg rod-climbing effect](_Media/James%20G.%20Oldroyd-1741126421305.png) > A classic demonstration of the Weissenberg rod-climbing effect. A rotating rod in a viscoelastic polymer solution causes the fluid to climb up along the rod, due to positive normal stress differences.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg's Rod-Climbing and the Preferred Model: Oldroyd's upper-convected Model...",
    "content": "Oldroyd's upper-convected Model B correctly captures this effect, whereas Model A would predict a downward dip, which is not observed in polymer fluids. Figure credits: [Henry Ng and Rob Poole, University of Liverpool](https://fluids.ac.uk/gallery/zoomify/665). Beyond qualitative rod-climbing, more detailed microstructural studies in subsequent years reinforced the supremacy of Oldroyd-B for polymeric liquids. In the 1960s, rheologists developed molecular models of polymer solutions \u2013 envisioning long polymer molecules as tiny spring\u2013dashpot elements or \"dumbbells\" dispersed in a solvent. When John Hinch and others revisited Oldroyd's models in light of these developments, they found a remarkable connection: the simplest molecular model of a polymer chain in flow (the elastic dumbbell model) leads mathematically directly to the Oldroyd-B constitutive equation [^5].",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg's Rod-Climbing and the Preferred Model: In other words,...",
    "content": "In other words, if one treats a polymer molecule as two beads connected by a spring dragged through a viscous solvent, the macroscopic stress evolution follows Oldroyd's upper-convected form (with the polymer's finite relaxation time corresponding to Oldroyd-B's parameters). This result explained why Oldroyd-B captured many polymer solution behaviors so well \u2013 it was essentially _derived from first principles_ of polymer micro-dynamics. Oldroyd-A, in contrast, did not emerge from any analogous physical picture for flexible polymers. By the late 20th century, therefore, Oldroyd-B had become the standard viscoelastic fluid model for dilute polymer solutions in rheology and computational fluid dynamics, whereas Oldroyd-A largely faded from use.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Oldroyd-A vs. Oldroyd-B: Weissenberg's Rod-Climbing and the Preferred Model: As John Hinch...",
    "content": "As John Hinch humorously noted, a survey of literature reveals thousands of papers employing \"Oldroyd-B\" in their title or keywords, but only a handful mentioning \"Oldroyd-A\". ![Polymer solution model](https://claude.ai/chat/_Media/James%20G.%20Oldroyd-1741126749363.jpeg) The reason is clear: Oldroyd-B not only passes key experimental tests but also has a firm basis in polymer molecular theory, making it the preferred tool for scientists and engineers modeling viscoelastic flows. The legacy of Oldroyd's 1950 insight is thus encapsulated in the ubiquity of the Oldroyd-B model \u2013 a tribute to his ability to capture the essential physics of elastic fluids in a simple equation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#oldroyd-a-vs-oldroyd-b-weissenbergs-rod-climbing-and-the-preferred-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: After 1950, Oldroyd...",
    "content": "After 1950, Oldroyd continued to build on his framework and ventured into new problems, further cementing his status as a pioneer in rheology. In 1953, he published a notable paper on _\"The elastic and viscous properties of emulsions and suspensions.\"_ [^7] Here, Oldroyd extended his constitutive modeling to multiphase systems, showing how a mixture of a liquid with dispersed droplets or particles could exhibit viscoelastic behavior. He demonstrated (for a dilute emulsion of liquid droplets) that the interfacial tension of the droplets provides a restoring force against deformation, effectively giving the emulsion an elastic component [^3]. This work was an early example of micro-rheology \u2013 linking microscopic structure to macroscopic rheological properties \u2013 and it illustrated Oldroyd's knack for generalizing his models to diverse materials.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: JavaScript",
    "content": "He also investigated the effect of surfactant films on droplet interfaces in emulsions, recognizing that a stabilizing film could alter the combined fluid's elasticity. These studies by Oldroyd in the 1950s are considered pioneering, as they connected continuum rheology with micro-scale mechanisms in suspensions and emulsions. Oldroyd's theoretical explorations in the mid-1950s also produced insights into what we now call \"second-order fluids.\" In a 1958 paper, he analyzed normal stress effects (differences in normal stresses) in steady flows of idealized viscoelastic liquids, using a general invariant formulation that included up to quadratic terms in stresses [^8]. Notably, he examined the conditions for the Weissenberg effect (rod-climbing) to occur \"in a positive or negative sense,\" essentially exploring the parameter space where a fluid would climb or dip around a rod.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: This comprehensive study...",
    "content": "This comprehensive study brought clarity to how non-Newtonian normal stresses arise in shear and rotational flows, and it introduced what became known as the Oldroyd 8-constant model (a generalized linear viscoelastic model with eight material constants). Such work laid the groundwork for later researchers like Coleman, Noll, and Rivlin, who in the same era were developing the modern continuum mechanics of fluids. Oldroyd's approach was always characterized by careful attention to invariant formulation (he cited the earlier convected-coordinate ideas of F. Hencky and others [^3]) and by a desire to keep models as simple as possible while capturing the essential physics. In 1961, he published a survey in _Rheologica Acta_ on _\"the hydrodynamics of materials whose rheological properties are complicated,\"_ [^9] reflecting on how to extend classical hydrodynamics to fluids with memory and elasticity.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Later Contributions and Evolving Work: Even in his...",
    "content": "Even in his final years, Oldroyd continued to synthesize his lifetime of insights: his last paper, published posthumously in 1984, was titled _\"An approach to non-Newtonian fluid mechanics,\"_[^11] offering a grand overview of the field - a treat to read for our generation.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#later-contributions-and-evolving-work",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Oldroyd's influence extended...",
    "content": "Oldroyd's influence extended beyond his written work; he was also a guiding figure and mentor in the rheology community. In 1953, the same year he took up a professorship, he served as Treasurer of the 2nd International Congress of Rheology held in Cambridge [^2] \u2013 a gathering of the world's top rheologists. He later became President of the British Society of Rheology (BSR) from 1955 to 1957, helping to shape the direction of rheological research in the UK [^12]. Oldroyd had moved to academia in 1953 as Professor of Mathematics at the University of Wales, Swansea, where he also headed the Applied Mathematics Department from 1957. In 1965, he was appointed Professor at Liverpool University, eventually becoming Head of the Department of Applied Mathematics and Theoretical Physics there [^2]. In these roles, Oldroyd supervised a small number of doctoral students \u2013 notably Kenneth Walters, who completed his PhD under Oldroyd at Swansea.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Walters would go...",
    "content": "Walters would go on to become a prominent rheologist himself (co-founding the _Journal of Non-Newtonian Fluid Mechanics_ in 1976) and later reminisced that although Oldroyd guided only _\"half a dozen\"_ PhD students, his impact on them \u2013 and on the field \u2013 was profound [^13]. Oldroyd's students and colleagues admired his deep physical intuition and his knack for reducing complex problems to their core elements. Amusingly, Walters recalled that Oldroyd was _\"no sportsman,\"_ yet somehow many of his research students were star cricket players \u2013 a coincidence that Oldroyd, with his gentle humor, tolerated even if he didn't share their sporting enthusiasm [^13]. In recognition of his scientific contributions, Oldroyd received numerous honors. Cambridge University awarded him the Adams Prize in 1964, one of its highest accolades in mathematics, for his work on the mechanics of non-Newtonian fluids.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: The British Society...",
    "content": "The British Society of Rheology bestowed upon him its Gold Medal in 1984 (the year after what would have been Oldroyd's retirement), celebrating a lifetime of achievement in rheology [^2]. Tributes poured in as he reached his 60th birthday in 1981 \u2013 the BSR dedicated a special issue of its bulletin to him, and luminaries like professor R. B. Bird lauded Oldroyd's contributions [^6]. In fact, at the 1988 International Congress on Rheology in Sydney, Bob Bird gave an opening lecture entitled _\"The Two JG's\"_ in honor of J. G. Oldroyd and J. G. Kirkwood \u2013 comparing Oldroyd, the continuum mechanician, and Kirkwood, the molecular theorist, as two giants who bridged the gap between macroscopic and microscopic understandings of fluid behavior [^1]. This was a testament to how Oldroyd's work, particularly the Oldroyd-B model, had become a cornerstone that linked molecular theory with continuum modeling. Unfortunately, James G.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: Oldroyd's life was...",
    "content": "Oldroyd's life was cut short in 1982 \u2013 he died suddenly of an apparent heart attack while on his way to the university in Liverpool [^2] \u2013 but his legacy endures vibrantly. His name is forever attached to the Oldroyd-B model, a staple in rheology textbooks and simulations, and his ideas on convected derivatives underpin all modern viscoelastic fluid theories. In computational fluid dynamics and engineering today, Oldroyd's models are routinely used to simulate polymer processing, biological fluid flows, and complex material behavior, enabling predictions of how materials will respond under flow with both viscous and elastic forces at play. In hindsight, John Hinch and other colleagues note that Oldroyd's genius was in formulating simple yet physically sound models \u2013 _\"the first twelve pages\"_ of his 1950 paper, as Bob Bird once remarked, _contained the seeds of an entire field_.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 james g oldroyd - Influence on the Rheology Community and Honors: By following a...",
    "content": "By following a historical narrative from classical mechanics to modern rheology, Oldroyd essentially wrote the chapter that connects Isaac Newton's fluid (ideal viscous) to James Clerk Maxwell's elastic solid, and in doing so, he helped create the science of rheology as we know it. His work evolved from early studies of idealized plastic solids to the elegant Oldroyd-B equation, reflecting a consistent vision: to understand and predict the behavior of materials that are not purely solid nor liquid, but something in between. This vision, shaped by great mentors, wartime experiences, industrial collaboration, and personal insight, makes James G. Oldroyd a towering figure in the history of rheology and fluid mechanics \u2013 one whose influence is still climbing upward, much like the fluid on Weissenberg's spinning rod. [^1]: I. A. Frigaard, G. H. McKinley, R. J. Poole & K. Walters, Editorial for special issue on \"Oldroyd at 100: Celebrating the impact of JG Oldroyd on non-Newtonian fluid mechanics\", J.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-James-G-Oldroyd/#influence-on-the-rheology-community-and-honors",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Why Double-Network Hydrogels Don\u2019t Shatter \u2014 and What That Teaches Us About Tough Design",
    "content": "> [!summary] TL;DR > A minimal *mesoscale* model shows why double-network (DN) hydrogels are both stiff and hard to break: the soft matrix *screens* stress released by broken sacrificial bonds, halting the crack-propagating cascade that plagues single networks. Screening $\\neq$ dissipation: dissipation is the *cost* when a bond breaks; screening is the *redistribution* that stops one break from triggering the next. The model also maps a practical trade-off: more (or stiffer) matrix boosts failure strain but erodes stiffness\u2014revealing a sweet spot.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#why-double-network-hydrogels-dont-shatter-and-what-that-teaches-us-about-tough-design",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - The questions",
    "content": "> [!question] > 1. Why don\u2019t double-network hydrogels shatter like ordinary gels? > 2. What micro-to-macro mechanism makes `sacrificial + matrix` deliver both stiffness and ductility? > 3. Can we extract actionable *design rules* (what to tune, in which direction, with what trade-offs)? This post walks through a recent paper by [Samuel Walker](https://scholar.google.com/citations?user=S3M3Re8AAAAJ&hl=en) & [Suzanne Fielding](https://scholar.google.com/citations?user=lMSrIAQAAAAJ&hl=en) on _Toughness of Double Network Hydrogels: The Role of Reduced Stress Propagation_ in Phys. Rev. Lett., 135:18, 188201 (2025), DOI: [10.1103/kck9-tc46](https://doi.org/10.1103/kck9-tc46) that answers those questions with a minimal model connecting bond-level events to crack-scale behavior.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#the-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Context",
    "content": "> [!definition] What is a double network? > Two interpenetrating polymer networks with complementary roles: > 1. Sacrificial \u2014 sparse, stiff, breakable $\\rightarrow$ sets *stiffness* and provides *dissipation* when it fails. > 2. Matrix \u2014 dense, compliant, tough $\\rightarrow$ sets *ductility* and *screens* stress between sacrificial bonds. Double Networks (DN) gels famously combine high modulus and high failure strain despite being mostly water, and this duality shows up across hydrogels, elastomers, and biomimetic composites. The puzzle has been not *that* they are tough\u2014but *why* they avoid the runaway cracks typical of single networks under load.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#context",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - What\u2019s new",
    "content": "> [!idea] Mechanism in one line > Elastic screening: when a sacrificial bond snaps, nearby matrix carries part of the stress that would otherwise load neighboring sacrificial bonds. That *weakens the effective Eshelby propagator* between sacrificial sites and stops crack-seeding cascades. This puts a quantitative spine in the common slogan \u201csacrificial bonds dissipate energy.\u201d Dissipation explains *cost paid* at each break; screening explains *why breaks don\u2019t avalanche*. The distinction matters for designing materials that deform a lot without catastrophic failure. The stress-propagation patterns reveal striking differences: in double networks, stress from a broken bond spreads more diffusely and decays faster spatially compared to single networks. Tuning the amount or stiffness of the matrix progressively damps how far stress travels to neighboring sacrificial bonds.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#whats-new",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Working hypothesis",
    "content": "> [!key-point] Hypothesis (paper\u2019s own words, paraphrased) > If the matrix is present and stiff enough to *share load*, then the stress propagated from a local sacrificial failure to neighboring sacrificial bonds is reduced. With sufficient screening, the DN will (i) inherit the *stiffness* of the sacrificial network and (ii) inherit the *ductility* (failure strain) of the matrix. Both require a careful balance\u2014too much matrix, and you lose stiffness.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#working-hypothesis",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - How did they test it?: > [!note] The...",
    "content": "> [!note] The minimal model > > * Geometry: build two random spring networks from jammed disk packings; interpenetrate them so nodes overlap $\\rightarrow$ this encodes load sharing. > * Constituents: sacrificial springs (stiff, low break strain) + matrix springs (softer, high break strain). > * Control knobs: > * $M$ \u2014 sacrificial spacing vs matrix mesh (larger M $\\Rightarrow$ sparser sacrificial / more matrix links), > * $\\mu_m$ \u2014 matrix spring stiffness, > * $\\lambda_m$ \u2014 matrix break strain. > * Protocol: quasistatic uniaxial extension with periodic boundaries; allow one bond to fail at a time and fully relax between steps; compute stress via Irving\u2013Kirkwood; examine where stress from a *single* break goes. What to look for in the results 1. Brittle vs ductile response in whole-sample behavior. In a *single* network, a local break seeds a sideways (Eshelby-like) stress pattern that overloads neighbors $\\rightarrow$ a crack races across the sample (sharp stress drop at modest strain).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#how-did-they-test-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - How did they test it?: In a double...",
    "content": "In a double network, the matrix soaks up part of that released stress $\\rightarrow$ many sacrificial microcracks form *without* coalescing; the sample stretches much further. This difference manifests as a sharp stress drop at modest strain in single networks versus a gradual, distributed damage pattern that allows double networks to stretch much further. 2. Direct evidence for \u201cscreening.\u201d Spatial stress maps from a single sacrificial break reveal how screening works in practice. Increasing $M$ (more matrix paths between sacrificial bonds) or $\\mu_m$ (stiffer matrix) clearly damps the propagator; the single-network pattern is recovered when $M \\to 0$ or $\\mu_m \\to 0$. The line-cuts along *x* visualize that reduction in the stress reaching neighbors that would otherwise fail next. 3. A navigable stiffness\u2013toughness trade-off.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#how-did-they-test-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - How did they test it?: Systematic parameter sweeps...",
    "content": "Systematic parameter sweeps reveal the trade-off: failure strain and stress rise with $M$ or $\\mu_m$ (toughness $\\uparrow$), while the sacrificial network contributes progressively less to the overall modulus (stiffness $\\downarrow$).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#how-did-they-test-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - How did they test it?: Around $M \\approx...",
    "content": "Around $M \\approx 3$, $\\mu_m \\approx 0.2$, $\\lambda_m \\approx 3$, the DN remains comparably stiff to the sacrificial network yet gains the matrix\u2019s ductility\u2014an illustrative \u201csweet spot\u201d in this model. > [!tip] Designer\u2019s cheat sheet (model parameters) > > * To increase failure strain: raise M or $\\mu_m$ $\\rightarrow$ more screening. > * To retain stiffness: keep some sacrificial connectivity; avoid M so large that the matrix dominates. > * If you lower matrix coordination (*$z_m$*), modulus becomes even more dominated by the sacrificial network (experimentally consistent), while toughness stays high (this effect is demonstrated in the reduced-coordination simulations). > [!note] Rate effects > They also checked a finite extension rate: the qualitative picture (tough DN vs brittle single network) survives; simulations confirm convergence to the quasistatic limit.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#how-did-they-test-it",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - What design predictions does the model make?",
    "content": "> [!summary] Read these as trends you can use: > > 1. Screening scale is set by matrix presence and stiffness: $\\uparrow M$ or $\\uparrow \\mu_m$ $\\rightarrow$ $\\downarrow$ stress transfer between sacrificial bonds $\\rightarrow$ fewer cascades $\\rightarrow$ $\\uparrow$ failure strain and stress. > 2. But stiffness is not free: $\\uparrow M$ or $\\uparrow \\mu_m$ shifts load to matrix $\\rightarrow$ sacrificial network contributes less to modulus. > 3. There\u2019s a compromise region where you keep much of the sacrificial stiffness *and* gain matrix ductility (illustrated at $M \\approx 3$, $\\mu_m \\approx 0.2$, $\\lambda_m \\approx 3$). > 4. Connectivity matters: making the matrix sub-isostatic (lower *$z_m$*) increases the DN\u2019s reliance on the sacrificial network for stiffness while preserving toughness (bridging to experimental observations). > *All four emerge from systematic parameter sweeps and connectivity variation tests.*",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#what-design-predictions-does-the-model-make",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - What we learn (big picture): * Mechanism over...",
    "content": "* Mechanism over slogan. DN toughness isn\u2019t only about \u201cdissipating\u201d energy in sacrificial breaks\u2014it\u2019s about preventing the chain reaction that turns a few breaks into a running crack. That prevention is elastic screening via matrix load sharing. * Actionable knobs. With M, $\\mu_m$, $\\lambda_m$ you can navigate the stiffness\u2013toughness frontier, aiming for a region that achieves both. * Transferability. The concept \u201csoft sub-network screens stress between brittle load-bearing elements\u201d speaks to other composites: elastomers with sacrificial motifs, biopolymer networks, and engineered lattices. > [!important] Screening vs dissipation (why the distinction matters) > > * Dissipation = energy lost when sacrificial bonds break. > * Screening = reduced amplitude and reach of stress redistribution after a break. > You can dissipate a lot and still crack if stress keeps localizing; you can avoid cracking with *less* dissipation if screening is strong.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#what-we-learn-big-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - What we learn (big picture): Quantitative stress-propagation maps...",
    "content": "Quantitative stress-propagation maps put numbers on this intuition.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#what-we-learn-big-picture",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Is this a predictive model?: > [!question] Short...",
    "content": "> [!question] Short answer: Predictive about trends and mechanisms; not calibrated to chemistry-specific absolutes. Yes, predictive for: * Mechanism: reduced Eshelby-like stress propagation between sacrificial bonds explains ductile micro-damage vs brittle macroscopic cracks. * Trends: how failure strain/stress and modulus shift with M and $\\mu_m$; how reduced matrix connectivity pushes stiffness back to the sacrificial network while retaining toughness. Not intended to predict exact absolute numbers for any given gel formulation\u2014by design it is minimal: 2D, central-force springs, average coordination above Maxwell\u2019s threshold, and no explicit prestretch (the latter is folded into a single stiffness ratio).",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#is-this-a-predictive-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Is this a predictive model?: Those simplifications isolate...",
    "content": "Those simplifications isolate the core physics first; the authors then show that reducing matrix connectivity trends the response toward experiments, improving quantitative agreement. > [!caution] Scope & assumptions (why they\u2019re useful) > 2D, central forces, quasistatic loading, and coarse-grained networks omit bending, 3D geometry, and chemistry. That keeps the model readable and tractable while still bridging single-bond events to macroscopic cracking behavior\u2014precisely what\u2019s hard for atomistic and continuum methods to do simultaneously.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#is-this-a-predictive-model",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Nuances and open questions",
    "content": "* How universal is the \u201cscreened propagator\u201d picture across soft composites? The mechanism should translate wherever a compliant sub-network can intercept stress (e.g., multi-network elastomers), but quantifying the screening length vs chemistry is the next step. * Role of prestretch and 3D architecture. Real sacrificial networks are often prestretched by the matrix synthesis; 3D, sub-isostatic networks may change how screening scales. The paper treats $\\mu_s$>$\\mu_m$ as a proxy for these effects\u2014an explicit 3D, bending-aware extension would be valuable. * Fatigue and cyclic loading. The model suggests where screening suppresses cascades; how that interacts with long-cycle fatigue in hydrogels is a natural target for future work.",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#nuances-and-open-questions",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - How to cite and read more",
    "content": "> [!quote] Core paper > S. B. Walker & S. M. Fielding (2025). *Toughness of Double Network Hydrogels: The Role of Reduced Stress Propagation*. Phys. Rev. Lett., 135(18):188201. DOI: [10.1103/kck9-tc46](https://doi.org/10.1103/kck9-tc46) > Mechanism, model, and parameter sweeps that connect bond-level events to macroscopic fracture in DNs. ---",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#how-to-cite-and-read-more",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 why double\u2011network hydrogels dont shatter - Tags",
    "content": "#hydrogels #double-network #fracture-mechanics #soft-materials #modeling #elastic-screening #polymer-physics > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://comphy-lab.org/VatsalSy) > Date published:: Oct 31, 2025 > [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab), [Blogs](https://blogs.comphy-lab.org) > > \ud83d\udcdd [Edit this page on GitHub](https://github.com/comphy-lab/CoMPhy-Lab-Blogs/blob/main/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter.md)",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Why-Double\u2011Network-Hydrogels-Dont-Shatter/#tags",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "2025 thesis viscous free surface flows",
    "content": "> [!meta] Back to main website > [Home](https://comphy-lab.org/), [Team](https://comphy-lab.org/team), [Research](https://comphy-lab.org/research), [Github](https://github.com/comphy-lab) > [!significance]- Metadata > Author:: [Vatsal Sanjay](https://vatsalsanjay.com) > Date published:: > Date modified::",
    "url": "https://blogs.comphy-lab.org/Blog/2025-Thesis-Viscous-Free-Surface-Flows/",
    "type": "blog_content",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Transforming physics research into development impact",
    "content": "The Commonwealth Split-site PhD Scholarship offers an exceptional opportunity for **doctoral candidates** from developing Commonwealth countries to spend **12 months** conducting research at Durham University while maintaining their PhD registration at their home institution. As one of the UK's top physics departments with confirmed Commonwealth Scholarship Commission (CSC) partnership status, Durham provides world-class facilities and expertise perfectly aligned with development-focused research. This guide, prepared by the Computational Matter Physics (CoMPhy) Lab, will help prospective applicants understand this prestigious opportunity and prepare competitive applications.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#transforming-physics-research-into-development-impact",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Who can apply and from where",
    "content": "The scholarship targets PhD candidates from **42 eligible low and middle-income Commonwealth countries** as classified by the OECD Development Assistance Committee. For a full list of eligible countries, please visit [the list of countries](https://cscuk.fcdo.gov.uk/scholarships/commonwealth-split-site-scholarships-for-low-and-middle-income-countries/).",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#who-can-apply-and-from-where",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Eligibility: Context",
    "content": "Source: [link](https://cscuk.fcdo.gov.uk/scholarships/commonwealth-split-site-scholarships-for-low-and-middle-income-countries/) To be eligible, you must already be **registered for a PhD at a university in one of these countries** by September. Academic requirements include holding at least an upper second-class (2:1) honours degree, or a lower second-class degree plus a relevant Master's qualification. Crucially, you must demonstrate that you cannot afford UK study without this scholarship. There are no age limits, but you must be a citizen or have refugee status in an eligible country and have been residing there for at least two years before applying. The most critical eligibility requirement is the **institutional link between your home university and Durham University**. This must be a formal partnership at the departmental or institutional level - not merely a collaboration between individual researchers.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#eligibility",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Eligibility: Both your home...",
    "content": "Both your home supervisor and proposed Durham University supervisor must provide supporting statements detailing this partnership.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#eligibility",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Navigate the application timeline and process: Applications usually open...",
    "content": "Applications usually open annually in **October and close in mid-December** (16:00 GMT) [Britishcouncil](https://study-uk.britishcouncil.org/scholarships-funding/commonwealth-scholarships). For example, for the 2025/26 cycle, applications have already closed on December 16, 2024, with results expected by July 2025 for September 2025 start. Mark these dates for future cycles as the timeline remains consistent yearly. The application process is **entirely online through CSC Central**, the official CSC application system. You apply directly \u2014 no nomination from your university or government is required. Start your application at least 6 months before the deadline to allow time for securing supervisor agreements, gathering documents, and crafting your proposal. Your application journey involves first identifying a Durham University supervisor whose research aligns with your interests, then confirming the institutional link exists between universities.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#navigate-the-application-timeline-and-process",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Navigate the application timeline and process: Next, secure supporting...",
    "content": "Next, secure supporting statements from both supervisors and gather all required documents. Complete the online application including your research proposal and development impact statement. Upload all documents in the correct format (PDF preferred, maximum 5MB per file) and ensure your referees submit their references by the deadline.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#navigate-the-application-timeline-and-process",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Compile essential documentation: Documentation requirements are...",
    "content": "Documentation requirements are strict - missing or incomplete documents render applications ineligible. You'll need a **passport or national ID** showing your photograph, date of birth, and country of citizenship. Academic documents include complete transcripts for all higher education qualifications with certified English translations if needed [official website](https://cscuk.fcdo.gov.uk/scholarships/commonwealth-split-site-scholarships-for-low-and-middle-income-countries/). Reference requirements include **two academic references** submitted directly by referees through the online system, plus supporting statements from both your home supervisor and proposed Durham Universty supervisor. These supervisor statements are critical they must be on institutional letterhead, signed, and explicitly detail the institutional partnership between universities. Without both statements confirming the institutional link, your application will be considered ineligible.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#compile-essential-documentation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Compile essential documentation: Additional documents include...",
    "content": "Additional documents include your detailed research proposal, a four-part development impact statement, employment history if applicable, and up to 10 publications or prizes if relevant. While no specific English language test is required, all documents must be in English.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#compile-essential-documentation",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Understanding your funding package",
    "content": "The scholarship provides comprehensive financial support for your 12-month UK stay. **Monthly stipend rates for 2025/26** are 1378 GBP for most UK locations or 1690 GBP for London universities. Based on Durham's location, you'll receive the standard rate, which adequately covers living costs in this historic city where accommodation ranges from 174-262 GBP per week in university housing [Link 1](https://uniacco.com/blog/cost-of-living-in-durham) [Link 2](https://en.uhomes.com/uk/durham). **Full tuition fees** are covered through Durham's part-funding agreement with CSC - you pay nothing. The scholarship includes return economy airfare from your home country to the UK, a warm clothing allowance, and a study travel grant for research-related travel. There are also special provisions. Please visit [Financial assistance, official webpage](https://cscuk.fcdo.gov.uk/scholarships/commonwealth-split-site-scholarships-for-low-and-middle-income-countries/) for details.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#understanding-your-funding-package",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Establishing crucial institutional links: The institutional link...",
    "content": "The institutional link requirement is the most common reason for application rejection. Your universities must have a **formal partnership beyond individual researcher collaboration**. Acceptable links include memoranda of understanding between institutions, departmental collaboration agreements, joint research projects, staff exchange programs, or established student mobility frameworks. Durham Physics has existing partnerships with several Commonwealth universities through various research networks. At the CoMPhy Lab, we maintain collaborations in computational multiphase physics. When approaching us, clearly indicate your home university's existing relationship with Durham University or propose how such a partnership could be established. Both supervisors must provide detailed statements explaining the nature of the institutional partnership, any history of collaboration, shared resources or facilities, and future partnership plans.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#establishing-crucial-institutional-links",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Establishing crucial institutional links: These statements must...",
    "content": "These statements must demonstrate that the link exists at an organizational level, not just between individuals. Consider having your department head or international office confirm the partnership formally.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#establishing-crucial-institutional-links",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Crafting a development-focused proposal: Your proposal must...",
    "content": "Your proposal must demonstrate clear development impact while maintaining scientific excellence. Our research aligns perfectly with several **CSC development themes**, particularly `Science and Technology for Development` through our work in #TODO. Structure your development impact statement in four parts. - First, **identify the problem** (200 words) by linking your research to global, national, and local development challenges. Use recent statistics from credible sources and connect to your chosen CSC theme. For CoMPhy-Lab research interests, this might involve `energy access statistics, technology gaps, or infrastructure challenges in your home country` #TODO. - Second, explain **skill application** (200 words) by detailing specific capabilities you'll gain at Durham University and how you'll apply them post-award. Be specific about organizations you'll work with and implementation strategies.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#crafting-a-development-focused-proposal",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Crafting a development-focused proposal: Results",
    "content": "For CoMPhy Lab research, this could include computational modeling skills, #TODO - Third, outline **expected outcomes** (200 words) with specific, measurable results over 1-5 years. Identify clear beneficiary groups and quantify impact where possible. For instance, #TODO improved solar cell efficiency could provide electricity to specific communities, or quantum sensing applications could enhance medical diagnostics in underserved areas. - Finally, describe **impact measurement** (100 words) including data collection methods, key performance indicators, and reporting mechanisms. Show how you'll track and demonstrate the real-world impact of your research.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#crafting-a-development-focused-proposal",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Meeting selection criteria for success: Selection panels evaluate...",
    "content": "Selection panels evaluate applications using three equally weighted criteria, each accounting for 33% of your score [link](https://cscuk.fcdo.gov.uk/advice-for-applicants/). - **Academic merit** assessment considers your degree classifications, research publications, and academic trajectory. While the minimum is a 2:1 degree, successful candidates often have first-class honours or distinction-level Master's degrees. Your referees should specifically address your intellectual capacity and research potential. - **Development impact** evaluation examines how clearly you articulate home country needs, the realism of your impact plans, and alignment with CSC themes. Successful applications demonstrate deep understanding of local contexts and propose achievable, measurable outcomes.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#meeting-selection-criteria-for-success",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Meeting selection criteria for success: Generic statements about...",
    "content": "Generic statements about \"helping development\" fail \u2014 be specific about who benefits and how. - **Research proposal quality** assessment focuses on scientific rigor, innovation, feasibility, and contribution to both knowledge and development. Your proposal should be accessible to non-specialist reviewers while maintaining scholarly standards. With success rates typically 5-10%, only the strongest applications combining all three elements succeed.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#meeting-selection-criteria-for-success",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Post-scholarship commitments and opportunities",
    "content": "Accepting this scholarship commits you to **return home within one month** of completion. CSC cannot support visa extensions, postdoctoral positions, or remaining for graduation ceremonies. This return requirement ensures you apply your UK-gained knowledge for home country development. You'll join a vibrant **lifelong alumni network** with immediate access to regional Commonwealth Scholar groups and ongoing engagement opportunities [British council link](https://www.britishcouncil.in/study-uk/scholarships/commonwealth-scholarships).",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#post-scholarship-commitments-and-opportunities",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Your path forward: The Commonwealth Split-site...",
    "content": "The Commonwealth Split-site PhD Scholarship represents a transformative opportunity to advance both your research career and your home country's development. Start preparing now for the next application cycle by identifying potential Durham supervisors whose research aligns with your interests and development goals. Contact your home university's international office to explore or establish institutional links with Durham. Begin drafting your research proposal and development impact statement, seeking feedback from mentors and previous Commonwealth Scholars. Connect with the CoMPhy Lab through our website to explore supervision possibilities in computational physics, materials science, or quantum applications. We particularly welcome proposals addressing energy access, sustainable materials, quantum technologies for development, climate modeling, or computational solutions to development challenges.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#your-path-forward",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "Commonwealth split site phd scholarships - Your path forward: Class Definition",
    "content": "Our established CSC partnership, world-class facilities, supportive environment, and commitment to development-focused research make Durham an ideal choice for your Commonwealth Split-site PhD experience. Remember that successful applications balance scientific excellence with genuine development commitment. Your research should advance knowledge while creating measurable impact in your home country. With thorough preparation, clear development focus, and strong institutional support, you can join the select group of Commonwealth Scholars using physics to drive positive change across the developing world.",
    "url": "https://blogs.comphy-lab.org/Join-Us/Commonwealth-Split-site-PhD-Scholarships/#your-path-forward",
    "type": "blog_section",
    "priority": 3
  },
  {
    "title": "\"Join Us\"",
    "content": "We are always looking for enthusiastic researchers to join our group. We welcome applicants with strong backgrounds in physics, applied mathematics, or engineering, especially in continuum mechanics, numerics, and scientific computing. vatsal.sanjay@comphy-lab.org vatsal.sanjay@durham.ac.uk",
    "url": "https://comphy-lab.org/join/",
    "type": "website_content",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Current Research Projects",
    "content": "To get an idea of the kind of projects we are interested in, please have a look at our current research topics (see [Research](/research)). Also, below are some of the ongoing research projects:",
    "url": "https://comphy-lab.org/join/#current-research-projects",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Soft Matter Singularities",
    "content": "",
    "url": "https://comphy-lab.org/join/#soft-matter-singularities",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - From Champagne to Coughs: Modelling Droplet Formation",
    "content": "Investigate how bubbles burst in complex fluids that behave like both liquids and elastic solids \u2014 from volcanic mudpots to respiratory mucus. Using Basilisk C simulations, discover how viscosity and elasticity control jet formation and droplet ejection when bubble cavities collapse. Map regimes where elastic stresses suppress or enhance jetting, with experimental validation from collaborators at Twente and Delft. [ View Project PDF](/assets/pdf-files/BubbleBursting.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#from-champagne-to-coughs-modelling-droplet-formation",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Instability Dynamics of Flowing Liquid Films: Plates and Fibers",
    "content": "Thin films transition between instability regimes as inclination varies. Use Basilisk CFD to map stability boundaries, characterize wave dynamics via spectral analysis, and study coupling between Kapitza, Rayleigh\u2013Taylor, and Rayleigh\u2013Plateau instabilities. [ View Project PDF](/assets/pdf-files/DropsOnFibers.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#instability-dynamics-of-flowing-liquid-films-plates-and-fibers",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Sneezing Droplets: Modelling Respiratory Droplet Formation",
    "content": "Numerically investigate how viscoelasticity affects filament breakup \u2014 the second stage of droplet formation. Simulate viscoelastic filaments, compare with Newtonian benchmarks, and improve predictions of droplet size distributions in respiratory events. [ View Project PDF](/assets/pdf-files/FilamentRetraction.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#sneezing-droplets-modelling-respiratory-droplet-formation",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Holey Sheets: Bursting of Liquid Films",
    "content": "Test how submicron impurities trigger hole nucleation in micron\u2011thick sheets. Using CLSVOF in Basilisk C, simulate radial drainage flows to reveal a double threshold for breakup and develop scaling laws for hole formation relevant to aerosols and sprays. [ View Project PDF](/assets/pdf-files/HoleySheets.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#holey-sheets-bursting-of-liquid-films",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Free-Surface Flows",
    "content": "",
    "url": "https://comphy-lab.org/join/#free-surface-flows",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Drops and Bubbles Spreading on Lubricant-Infused Surfaces",
    "content": "Liquid-infused surfaces enable control over fluid spreading. Use Basilisk's adaptive VOF solver to capture capillary-wave cascades when fluids contact LIS, map spreading regimes, and reveal how wave convergence entrains secondary droplets. Develop scaling laws with experimental partners at TU Delft and Univ. Twente. [ View Project PDF](/assets/pdf-files/BubbleSpreadingLIS.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#drops-and-bubbles-spreading-on-lubricant-infused-surfaces",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Playing Ping-Pong with Liquid Droplets",
    "content": "Simulate droplet bouncing on superhydrophobic surfaces \u2014 from Scott Kelly's space ping\u2011pong to hydrodynamic singularities. Map bouncing regimes, quantify force profiles and dissipation, and study Worthington jet formation with high-fidelity CFD. [ View Project PDF](/assets/pdf-files/BouncingDrops.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#playing-ping-pong-with-liquid-droplets",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - Gravity\u2011Defying Liquids: Thermoresponsive Viscoplastic Gels",
    "content": "Study hot droplet impacts on cold substrates in gels transitioning from Newtonian to yield\u2011stress behavior. Implement temperature\u2011dependent rheology in DNS and correlate with experimental data for printing applications. [ View Project PDF](/assets/pdf-files/VP_Numerics.pdf){: .pdf-link }",
    "url": "https://comphy-lab.org/join/#gravitydefying-liquids-thermoresponsive-viscoplastic-gels",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-user-tie\"></i></span> Postdoctoral Positions: We occasionally have...",
    "content": "We occasionally have openings for postdoctoral researchers to lead independent research projects within our computational multiphase physics framework. Postdoc positions offer excellent opportunities for career development and research leadership. **What we're looking for:** - PhD in Physics, Applied Mathematics, Mechanical Engineering, or related field - Strong background in computational fluid dynamics - Experience with numerical methods and high-performance computing - Independent research capabilities and leadership potential **Opportunities include:** - Leading research projects with PhD students - Developing new computational methods and tools - International collaborations and research visits - Grant writing and proposal development - Mentoring junior researchers When positions are available, they will be advertised here.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-user-tieispan-postdoctoral-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-user-tie\"></i></span> Postdoctoral Positions: We also support...",
    "content": "We also support applications to externally funded postdoctoral fellowships that require a UK host, including: - [Marie Sk\u0142odowska\u2011Curie Postdoctoral Fellowships (MSCA PF)](https://marie-sklodowska-curie-actions.ec.europa.eu/actions/postdoctoral-fellowships) - [UKRI EPSRC Postdoctoral Fellowships](https://www.ukri.org/opportunity/?filter_council%5B0%5D=820&filter_funding_type%5B0%5D=18&filter_status%5B0%5D=open&filter_status%5B1%5D=upcoming&filter_submitted=true&filter_order=publication_date/) - [Leverhulme Trust Early Career Fellowships](https://www.leverhulme.ac.uk/schemes-at-a-glance?field_require_funding_for_tid=5) - [Royal Society Newton International Fellowship](https://royalsociety.org/grants-schemes-awards/grants/newton-international/) - [Royal Academy of Engineering Research Fellowships](https://raeng.org.uk/programmes-and-prizes/programmes/uk-grants-and-prizes/support-for-research/research-fellowships/) - [Royal Commission for the Exhibition of 1851 Research Fellowships](https://royalcommission1851.org/fellowships/research-fellowships) If you're interested, please email a brief statement of interest and your CV.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-user-tieispan-postdoctoral-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-user-tie\"></i></span> Postdoctoral Positions: Reaching out 2\u20134...",
    "content": "Reaching out 2\u20134 months before a call deadline is ideal so we can plan a strong application together.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-user-tieispan-postdoctoral-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-graduation-cap\"></i></span> PhD Positions: We are always...",
    "content": "We are always looking for enthusiastic PhD students to join our research group and contribute to cutting-edge computational multiphase physics research. We offer fully funded positions with opportunities for international collaboration and conference participation. **Research Areas:** - High-performance Computing and Numerical Methods - Multiphase flows and Interface Dynamics - Physics-based Modeling and Simulation - Soft Singularities in Fluid Systems - Droplet Dynamics and Respiratory Physics **What we offer:** - Access to high-performance computing resources - Collaboration with leading international research groups - Conference attendance and networking opportunities - Mentorship in both research and career development **Admissions and studentships:** - Entry: First-class BSc or at least a 2:1 MPhys/MSc (or international equivalent).",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-graduation-capispan-phd-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-graduation-cap\"></i></span> PhD Positions: English requirements apply...",
    "content": "English requirements apply for non\u2011native speakers. ([How to Apply](https://www.durham.ac.uk/study/postgraduate/research-degrees/how-to-apply/)) - How to apply (CoMPhy Lab)? - email us ([vatsal.sanjay@comphy-lab.org](mailto:vatsal.sanjay@comphy-lab.org)/[vatsal.sanjay@durham.ac.uk](mailto:vatsal.sanjay@durham.ac.uk)) with a brief statement of fit and CV. - In the portal, select CMP, name Dr. Vatsal Sanjay as supervisor. Final applications can only be submitted via the Postgraduate Applicant Portal. ([How to Apply](https://www.durham.ac.uk/study/postgraduate/research-degrees/how-to-apply/)) - Funding we typically target: [EPSRC DTP (Physics)](https://www.ukri.org/councils/epsrc/), [Durham studentships](https://www.durham.ac.uk/departments/academic/physics/postgraduate-study/studentships-funding/available-studentships/), [CSC](https://www.durham.ac.uk/study/scholarships/international/chinese-scholarships-council/).",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-graduation-capispan-phd-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-graduation-cap\"></i></span> PhD Positions: See: [Fees &...",
    "content": "See: [Fees & Funding](https://www.durham.ac.uk/study/postgraduate/research-degrees/fees-and-funding/) and [Physics studentships](https://www.durham.ac.uk/departments/academic/physics/postgraduate-study/studentships-funding/). - Timeline (Oct start): contact CoMPhy Sep\u2013Dec; internal ranking/interviews Dec\u2013Feb; Spring decisions. Early contact helps your application.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-graduation-capispan-phd-positions",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-book\"></i></span> Bachelor's/Master's/Level-4 Projects",
    "content": "We offer exciting research projects for Bachelor's and Master's students interested in computational physics and fluid dynamics. These projects provide hands-on experience with cutting-edge simulation tools and real-world physics problems. **Project Types:** - Computational fluid dynamics simulations using state-of-the-art [numerical techniques](https://www.github.com/comphy-lab). - Data analysis and visualization of complex flow phenomena. - Development of numerical methods and algorithms. - Experimental-computational comparison studies. **What you'll gain:** - Experience with high-performance computing - Skills in scientific programming (C, Python, Julia, MATLAB) - Understanding of advanced numerical methods - Opportunity to contribute to published research Contact us to discuss project fit and scope for your specific interests and timeline. > See the projects above.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-bookispan-bachelorsmasterslevel-4-projects",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-flask\"></i></span> Internships: We welcome motivated...",
    "content": "We welcome motivated students for summer internships and short-term research projects. Our internship program provides intensive research experience in a collaborative environment. **Internship Details:** - Duration: 2-6 months (flexible based on academic calendar). - Focus on specific research questions within ongoing projects. - Close mentorship and regular progress meetings. - Opportunity to present results at group seminars. **Ideal candidates have:** - Background in physics, mathematics, or engineering. - Basic programming experience (any language). - Curiosity about soft matter, fluid mechanics and computational methods. - Strong motivation for hands-on research. **Application process:** Send a short note describing your interests and any prior experience, along with your transcript, to the email addresses above.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-flaskispan-internships",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "\"Join Us\" - <span class=\"section-icon\"><i class=\"fa-solid fa-flask\"></i></span> Internships: Include your preferred...",
    "content": "Include your preferred internship timeline and any specific research areas of interest. > Eligible PhD candidates from Commonwealth countries may also consider the [Commonwealth Split-site PhD Scholarships](https://cscuk.fcdo.gov.uk/scholarships/commonwealth-split-site-scholarships-for-low-and-middle-income-countries/) to undertake a 1\u2011year research period at CoMPhy Lab as part of their PhD.",
    "url": "https://comphy-lab.org/join/#span-classsection-iconi-classfa-solid-fa-flaskispan-internships",
    "type": "website_section",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # MacOS only. modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk rm -rf basilisk rm -rf .project_config darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config",
    "url": "https://comphy-lab.org/Viscoelastic3D/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#!/bin/zsh# MacOS only. modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basiliskrm-rfbasiliskrm-rf.project_configdarcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimakeecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config",
    "url": "https://comphy-lab.org/Viscoelastic3D/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: ElastoFlow: 2D/3D Viscoelastic...",
    "content": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework \ud83d\ude80 ElastoFlow is a state-of-the-art, open-source framework for simulating viscoelastic fluid flows in 2D and 3D, built as an extension to the Basilisk C CFD library.",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Methods",
    "content": "It implements the log-conformation method for robust, high-Weissenberg number simulations, with a focus on clarity, extensibility, and scientific rigor. \u2728 Key Features Full 3D Log-Conformation Method : Complete scalar implementation for 3D viscoelastic fluids ( log-conform-viscoelastic-scalar-3D.h ) Robust 2D/Axi Support : Scalar and tensor-based log-conformation for 2D and axisymmetric cases ( log-conform-viscoelastic-scalar-2D.h , log-conform-viscoelastic.h ) Optimized Matrix Algebra : Efficient, stable eigenvalue and tensor operations ( eigen_decomposition.h ) Advanced Initialization : Functions for pseudo vectors/tensors in 2D/3D Error Handling : Negative eigenvalue checks, eigenvalue clamping, and detailed diagnostics Performance : Simplified acceleration term calculations and optimized tensor operations Documentation : Extensive inline documentation, mathematical background, and verification notes Compatibility : GPLv3 license, fully compatible with Basilisk and previous ElastoFlow versions \ud83d\udc1b Bug Fixes (v2.5/v2.6) Corrected matrix algebra in 3D Fixed rotation tensor and eigenvalue edge cases Improved error reporting and diagnostics Enhanced axisymmetric and 2D/3D compatibility \ud83d\uddc2\ufe0f Repository Structure basilisk/src/ - # Core Basilisk CFD library (reference only, do not modify) src-local/ - # Custom viscoelastic solvers and tensor utilities log-conform-viscoelastic-scalar-3D.h - # 3D log-conformation (scalar) log-conform-viscoelastic-scalar-2D.h - # 2D/axi log-conformation (scalar) log-conform-viscoelastic.h - # 2D/axi log-conformation (tensor) two-phaseVE.h - # Two-phase viscoelastic extension eigen_decomposition.h - # 3x3 symmetric eigenvalue solver simulationCases/ - # Example/test cases and post-processing scripts dropAtomisation.c - # 3D drop atomisation simulation pinchOff.c - # Pinch-off of viscoelastic jet (2D/axi) testEigenDecomposition.c - # Eigenvalue solver test/verification dropImpact.c - # Drop impact simulation verifyWtihPlots.ipynb - # Jupyter notebook for verification/plots postProcess/ - # Project-specific post-processing tools and utilities getData-elastic-scalar2D.c - # Data extraction utility getFacet2D.c - # Facet extraction utility VideoAxi.py - # Python visualization script \ud83d\udcda Documentation docs/ \u2014 Full HTML documentation, mathematical background, and API Inline documentation in all major headers (see src-local/ ) Example simulation and post-processing scripts in simulationCases/ \ud83d\ude80 Quick Start 1.",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Prerequisites Basilisk C...",
    "content": "Prerequisites Basilisk C (included as submodule in basilisk/ ) C compiler (e.g., gcc) Python 3 (for post-processing) Optional: Jupyter for notebooks 2. Compiling & Running Simulations A. Vanilla Basilisk method: qcc -O2 -Wall -I. /src-local -disable-dimensions simulationCases/{CaseName}.c -o {CaseName} -lm ./{CaseName} B. Using the Makefile (with bview browser): CFLAGS = -DDISPLAY=-1 make simulationCases/{CaseName}.tst For interactive visualization, open the generated display.html in your browser (see Basilisk bview ). 3. Post-Processing & Analysis Python scripts and Jupyter notebooks for data extraction and visualization are in simulationCases/ (e.g., VideoAxi.py , verifyWtihPlots.ipynb ).",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Examples",
    "content": "Example utilities: getData-elastic-scalar2D.c , getFacet2D.c . \ud83d\udcdd Example: Running a 3D Drop Atomisation Simulation qcc -O2 -Wall -I. /src-local -disable-dimensions simulationCases/dropAtomisation.c -o dropAtomisation -lm ./dropAtomisation \ud83d\udd0d Technical Details Log-Conformation Method : See src-local/log-conform-viscoelastic-scalar-3D.h and src-local/log-conform-viscoelastic-scalar-2D.h for mathematical background and implementation notes. Eigenvalue Solver : src-local/eigen_decomposition.h provides robust 3x3 symmetric eigensystem routines. Two-Phase Flows : src-local/two-phaseVE.h extends Basilisk\u2019s two-phase solver for viscoelasticity. Axisymmetric/2D/3D : Use the appropriate header for your geometry (see comments in each header for guidance). \ud83e\uddd1\u200d\ud83d\udcbb Contributing See CLAUDE.md for code style and development guidelines. Issue templates and feature requests: GitHub Issue Templates Pull requests are welcome!",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Examples",
    "content": "Please document your changes and update relevant tests/examples. \ud83d\udccb License This project is licensed under the GNU GPLv3 , in line with the Basilisk codebase. \ud83d\ude4f Acknowledgments Thanks to all contributors and the Basilisk community \ud83d\udd17 References Fattal & Kupferman (2004, 2005): Log-conformation method Comminal et al. (2015): Constitutive model functions Hao & Pan (2007): Split scheme implementation Basilisk C For detailed documentation, see the docs/ folder or open docs/index.html in your browser.",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Generated Documentation Root...",
    "content": "Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/VideoAxi.py postProcess/getData-elastic-scalar2D.c postProcess/getFacet2D.c simulationCases simulationCases/dropAtomisation.c simulationCases/dropImpact.c simulationCases/pinchOff.c simulationCases/testEigenDecomposition.c simulationCases/verifyWtihPlots.ipynb src-local src-local/eigen_decomposition.h src-local/log-conform-viscoelastic-scalar-2D.h src-local/log-conform-viscoelastic-scalar-3D.h src-local/log-conform-viscoelastic.h src-local/two-phaseVE.h",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "qcc-O2-Wall-I./src-local-disable-dimensionssimulationCases/{CaseName}.c-o{CaseName}-lm./{CaseName}",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "CFLAGS=-DDISPLAY=-1makesimulationCases/{CaseName}.tst",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "qcc-O2-Wall-I./src-local-disable-dimensionssimulationCases/dropAtomisation.c-odropAtomisation-lm./dropAtomisation",
    "url": "https://comphy-lab.org/Viscoelastic3D/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData-elastic-scalar2D.c This program extracts and processes data from fluid dynamics simulation snapshots, specifically designed for viscoela... getFacet2D.c A utility for extracting interface facets from fluid simulation data. VideoAxi.py Viscoelastic Visualization Tool =========================================== This script processes and visualizes flui...",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "postProcess/getData-elastic-scalar2D.c See raw file Simulation Data Extraction and Processing This program extracts and processes data from fluid dynamics simulation snapshots, specifically designed for viscoelastic fluid simulations with conformation tensor analysis. It computes important derived quantities including deformation rate tensor components, velocity magnitude, and conformation tensor trace. The program interpolates these quantities onto a regular grid and outputs the results for further analysis or visualization. Physics Background This code handles viscoelastic fluid simulation data where the fluid stress tensor includes both a viscous component (proportional to the deformation rate) and an elastic component (represented by the conformation tensor).",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: C/C++ Code",
    "content": "The trace of the conformation tensor provides a measure of polymer stretching in the fluid. #include \"utils.h\" #include \"output.h\" scalar f []; // Volume fraction field vector u []; // Velocity field scalar A11 [], A12 [], A22 []; // Conformation tensor components scalar conform_qq []; // Additional conformation tensor component char filename [ 80 ]; // Input file name int nx , ny , len ; // Grid dimensions and field count double xmin , ymin , xmax , ymax , Deltax , Deltay ; // Domain boundaries and grid spacing Derived Fields D2c: Log10 of squared deformation rate tensor weighted by volume fraction vel: Magnitude of velocity trA: Log10 of excess trace of conformation tensor scalar D2c [], vel [], trA []; scalar * list = NULL ; // List to store output fields Main Function Processes simulation data and computes derived quantities Arguments: arguments[1]: Input filename arguments[2-5]: Domain boundaries (xmin, ymin, xmax, ymax) arguments[6]: Number of grid points in y-direction (ny) Returns: 0 on successful execution int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); xmin = atof ( arguments [ 2 ]); ymin = atof ( arguments [ 3 ]); xmax = atof ( arguments [ 4 ]); ymax = atof ( arguments [ 5 ]); ny = atoi ( arguments [ 6 ]); // Initialize list of fields to output list = list_add ( list , D2c ); list = list_add ( list , vel ); list = list_add ( list , trA ); Data Processing Workflow Restore simulation state from snapshot file Compute derived quantities at each grid point Interpolate fields onto regular grid Output data to file restore ( file = filename ); Field Computation For each cell, compute: - Components of the deformation rate tensor D - Squared magnitude of D weighted by volume fraction - Velocity magnitude - Excess trace of the conformation tensor foreach () { // Compute deformation rate tensor components double D11 = ( u . y [ 0 , 1 ] - u . y [ 0 , - 1 ]) / ( 2 * Delta ); double D22 = ( u . y [] / y ); double D33 = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ]) / ( 2 * Delta ); double D13 = 0.5 * (( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 , - 1 ]) / ( 2 * Delta )); double D2 = ( sq ( D11 ) + sq ( D22 ) + sq ( D33 ) + 2.0 * sq ( D13 )); D2c [] = f [] * D2 ; // Take log10 of D2c for better visualization if ( D2c [] > 0. ) { D2c [] = log ( D2c []) / log ( 10 ); } else { D2c [] = - 10 ; } // Compute velocity magnitude vel [] = sqrt ( sq ( u . x []) + sq ( u . y [])); // Compute excess trace of conformation tensor trA [] = ( A11 [] + A22 [] + conform_qq []) / 3.0 - 1.0 ; // Take log10 of trA for better visualization if ( trA [] > 0. ) { trA [] = log ( trA []) / log ( 10 ); } else { trA [] = - 10 ; } } Grid Interpolation and Output Calculate grid spacing based on domain size and ny Allocate memory for interpolated field values Interpolate field values onto regular grid Output grid coordinates and field values FILE * fp = ferr ; Deltay = ( double )(( ymax - ymin ) / ( ny )); nx = ( int )(( xmax - xmin ) / Deltay ); Deltax = ( double )(( xmax - xmin ) / ( nx )); len = list_len ( list ); // Allocate memory for field values double ** field = ( double **) matrix_new ( nx , ny + 1 , len * sizeof ( double )); // Interpolate field values onto regular grid for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , x , y ); } } } // Output grid coordinates and field values for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; fprintf ( fp , \" %g %g \" , x , y ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } // Clean up fflush ( fp ); fclose ( fp ); matrix_free ( field ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"scalar f[];// Volume fraction fieldvector u[];// Velocity fieldscalar A11[],A12[],A22[];// Conformation tensor componentsscalar conform_qq[];// Additional conformation tensor componentcharfilename[80];// Input file nameintnx,ny,len;// Grid dimensions and field countdoublexmin,ymin,xmax,ymax,Deltax,Deltay;// Domain boundaries and grid spacing",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "scalar D2c[],vel[],trA[];scalar*list=NULL;// List to store output fields",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);xmin=atof(arguments[2]);ymin=atof(arguments[3]);xmax=atof(arguments[4]);ymax=atof(arguments[5]);ny=atoi(arguments[6]);// Initialize list of fields to outputlist=list_add(list,D2c);list=list_add(list,vel);list=list_add(list,trA);",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: foreach(){// Compute deformation...",
    "content": "foreach(){// Compute deformation rate tensor componentsdoubleD11=(u.y[0,1]-u.y[0,-1])/(2*Delta);doubleD22=(u.y[]/y);doubleD33=(u.x[1,0]-u.x[-1,0])/(2*Delta);doubleD13=0.5*((u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(2*Delta));doubleD2=(sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13));D2c[]=f[]*D2;// Take log10 of D2c for better visualizationif(D2c[]>0.){D2c[]=log(D2c[])/log(10);}else{D2c[]=-10;}// Compute velocity magnitudevel[]=sqrt(sq(u.x[])+sq(u.y[]));// Compute excess trace of conformation tensortrA[]=(A11[]+A22[]+conform_qq[])/3.0-1.0;// Take log10 of trA for better visualizationif(trA[]>0.){trA[]=log(trA[])/log(10);}else{trA[]=-10;}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "FILE*fp=ferr;Deltay=(double)((ymax-ymin)/(ny));nx=(int)((xmax-xmin)/Deltay);Deltax=(double)((xmax-xmin)/(nx));len=list_len(list);// Allocate memory for field valuesdouble**field=(double**)matrix_new(nx,ny+1,len*sizeof(double));// Interpolate field values onto regular gridfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,x,y);}}}// Output grid coordinates and field valuesfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;fprintf(fp,\"%g%g\",x,y);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}// Clean upfflush(fp);fclose(fp);matrix_free(field);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "postProcess/getFacet2D.c See raw file Getting Facets A utility for extracting interface facets from fluid simulation data. Description This program extracts and outputs the facets representing the interface between different phases in a multiphase flow simulation. The facets define the boundary between fluid phases, useful for geometric analysis and visualization of the interface morphology. Physics Background In multiphase fluid simulations, interfaces between different fluids are critical features that determine many physical phenomena like surface tension effects, droplet formation, and coalescence events. This utility identifies these interfaces by extracting facets from volume fraction data, allowing for quantitative analysis of interfacial dynamics.",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: C/C++ Code",
    "content": "Usage ./getFacets input_file Author: Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Department University of Twente #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" scalar f []; // Volume fraction field char filename [ 80 ]; Main Function Loads a simulation snapshot and extracts the interface facets. Input parameters: arguments[1] : Filename of the simulation snapshot to process Process: Restores the simulation state from the specified file Extracts interface facets from the volume fraction field Outputs facet data to standard error Return value: Returns 0 on successful completion Note: The facet extraction algorithm identifies where the volume fraction field crosses a threshold value (typically 0.5) between adjacent cells. int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"scalar f[];// Volume fraction fieldcharfilename[80];",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "postProcess/VideoAxi.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Viscoelastic Visualization Tool This script processes and visualizes fluid dynamics simulation data, particularly focused on droplet impact and deformable soft matter like liquid drops, sheets, and bubbles. It extracts interface positions and scalar field data from simulation files and creates visualizations showing physical quantities like strain rates and stresses. The script is designed to process multiple simulation snapshots in parallel, extracting data using external executables and generating visualizations with proper colormaps, scales, and mathematical labels.",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Features: - Extracts...",
    "content": "Features: - Extracts fluid interfaces and scalar fields from simulation files - Generates visualizations with proper colormaps and mathematical labels - Processes multiple timesteps in parallel using multiprocessing - Configurable via command-line arguments for different simulation cases - Creates publication-quality figures with LaTeX-rendered mathematical expressions Usage: python fluid_vis.py [options] Command-line Arguments: \u2013CPUs Number of CPUs to use for parallel processing (default: all available) \u2013nGFS Number of restart files to process (default: 550) \u2013ZMAX Maximum Z coordinate for visualization (default: 4.0) \u2013RMAX Maximum R coordinate for visualization (default: 2.0) \u2013ZMIN Minimum Z coordinate for visualization (default: -4.0) \u2013caseToProcess Path to simulation case directory (default: \u2018../simulationCases/dropImpact\u2019) \u2013folderToSave Directory to save visualization images (default: \u2018dropImpact\u2019) Dependencies: External executables: getFacet2D, getData-elastic-scalar2D Python libraries: numpy, matplotlib, subprocess, multiprocessing Author: Vatsal Sanjay Email: vatsalsanjay@gmail.com Affiliation: Physics of Fluids Last updated: Jul 24, 2024 import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import multiprocessing as mp from functools import partial import argparse import matplotlib.colors as mcolors custom_colors = [ \"white\" , \"#DA8A67\" , \"#A0522D\" , \"#400000\" ] custom_cmap = mcolors.LinearSegmentedColormap.from_list( \"custom_hot\" , custom_colors) # Configure matplotlib for publication-quality figures with LaTeX rendering matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, includeCoat = 'true' ): Extract interface positions (facets) from simulation files.",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file includeCoat (str, optional): Whether to include coating layer. Defaults to \u2018true\u2019. Returns: list: List of line segments defining fluid interfaces exe = [ \"./getFacet2D\" , filename, includeCoat] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr): Extract scalar field data from simulation files.",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate rmax (float): Maximum R coordinate nr (int): Number of grid points in R direction Returns: tuple: (R, Z, D2, vel, taup, nz) arrays of coordinates and field values exe = [ \"./getData-elastic-scalar2D\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp, taupTemp = [],[],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) taupTemp.append( float (temp3[ 4 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) taup = np.asarray(taupTemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) taup.resize((nz, nr)) return R, Z, D2, vel, taup, nz # ---------------------------------------------------------------------------------------------------------------------- def process_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess): Process a single timestep from simulation data and generate visualization.",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Args: ti (int):...",
    "content": "Args: ti (int): Timestep index folder (str): Directory to save output images nGFS (int): Total number of timesteps GridsPerR (int): Grid points per unit length in R direction rmin (float): Minimum R coordinate rmax (float): Maximum R coordinate zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate lw (float): Line width for plot elements caseToProcess (str): Path to simulation case directory t = 0.01 * ti place = f\" { caseToProcess } /intermediate/snapshot- { t :.4f} \" name = f\" { folder } / { int (t * 1000 ) :08d} .png\" if not os.path.exists(place): print ( f\" { place } File not found!\" ) return if os.path.exists(name): print ( f\" { name } Image present!\" ) return segs1 = gettingFacets(place) segs2 = gettingFacets(place, 'false' ) if not segs1 and not segs2: print ( f\"Problem in the available file { place } \" ) return nr = int (GridsPerR * rmax) R, Z, taus, vel, taup, nz = gettingfield(place, zmin, zmax, rmax, nr) zminp, zmaxp, rminp, rmaxp = Z. min (), Z. max (), R. min (), R. max () # Plotting AxesLabel, TickLabel = 50 , 20 fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) # Draw domain boundaries ax.plot([ 0 , 0 ], [zmin, zmax], '-.' , color = 'grey' , linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) # Add fluid interfaces line_segments = LineCollection(segs2, linewidths = 4 , colors = 'green' , linestyle = 'solid' ) ax.add_collection(line_segments) line_segments = LineCollection(segs1, linewidths = 4 , colors = 'blue' , linestyle = 'solid' ) ax.add_collection(line_segments) # Plot scalar fields with colormaps cntrl1 = ax.imshow(taus, cmap = \"hot_r\" , interpolation = 'Bilinear' , origin = 'lower' , extent = [ - rminp, - rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # TODO : fixme the colorbar bounds for taup must be set manually based on the simulated case. cntrl2 = ax.imshow(taup, interpolation = 'Bilinear' , cmap = custom_cmap, origin = 'lower' , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # Set plot properties ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.set_title( f'$t/ \\\\ tau_ \\\\ gamma$ = { t :4.3f} ' , fontsize = TickLabel) # Add colorbars l, b, w, h = ax.get_position().bounds # Left colorbar cb1 = fig.add_axes([l - 0.04 , b, 0.03 , h]) c1 = plt.colorbar(cntrl1, cax = cb1, orientation = 'vertical' ) c1.set_label( r' $ \\ log_ {10} \\ left ( \\| \\m athcal{D} \\|\\r ight ) $ ' , fontsize = TickLabel, labelpad = 5 ) c1.ax.tick_params(labelsize = TickLabel) c1.ax.yaxis.set_ticks_position( 'left' ) c1.ax.yaxis.set_label_position( 'left' ) c1.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.1f} ' )) # Right colorbar cb2 = fig.add_axes([l + w + 0.01 , b, 0.03 , h]) c2 = plt.colorbar(cntrl2, cax = cb2, orientation = 'vertical' ) c2.ax.tick_params(labelsize = TickLabel) c2.set_label( r' $ \\ log_ {10} \\ left ( \\t ext{tr} \\ left ( \\m athcal{A} \\r ight ) -1 \\r ight ) $ ' , fontsize = TickLabel) c2.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.2f} ' )) ax.axis( 'off' ) plt.savefig(name, bbox_inches = \"tight\" ) plt.close() def main(): Main function that parses command-line arguments and parallelizes processing of timesteps. # Set up command-line argument parsing parser = argparse.ArgumentParser(description = 'Process fluid dynamics simulation data and create visualizations' ) parser.add_argument( '--CPUs' , type = int , default = mp.cpu_count(), help = 'Number of CPUs to use (default: all available)' ) parser.add_argument( '--nGFS' , type = int , default = 550 , help = 'Number of restart files to process (default: 550)' ) parser.add_argument( '--ZMAX' , type = float , default = 4.0 , help = 'Maximum Z value (default: 4.0)' ) parser.add_argument( '--RMAX' , type = float , default = 2.0 , help = 'Maximum R value (default: 2.0)' ) parser.add_argument( '--ZMIN' , type = float , default =- 4.0 , help = 'Minimum Z value (default: -4.0)' ) parser.add_argument( '--caseToProcess' , type = str , default = '../simulationCases/dropImpact' , help = 'Case to process (default: ../simulationCases/dropImpact)' ) parser.add_argument( '--folderToSave' , type = str , default = 'dropImpact' , help = 'Folder to save output images (default: dropImpact)' ) args = parser.parse_args() # Extract arguments CPUStoUse = args.CPUs nGFS = args.nGFS ZMAX = args.ZMAX RMAX = args.RMAX ZMIN = args.ZMIN num_processes = CPUStoUse rmin, rmax, zmin, zmax = [ - RMAX, RMAX, ZMIN, ZMAX] GridsPerR = 128 # Grid resolution parameter lw = 2 # Line width for plot elements folder = args.folderToSave caseToProcess = args.caseToProcess # Create output directory if it doesn't exist if not os.path.isdir(folder): os.makedirs(folder) # Create a pool of worker processes for parallel processing with mp.Pool(processes = num_processes) as pool: # Create partial function with fixed arguments process_func = partial(process_timestep, folder = folder, nGFS = nGFS, GridsPerR = GridsPerR, rmin = rmin, rmax = rmax, zmin = zmin, zmax = zmax, lw = lw, caseToProcess = caseToProcess) # Map the process_func to all timesteps pool. map (process_func, range (nGFS)) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Methods",
    "content": "importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportmultiprocessingasmpfromfunctoolsimportpartialimportargparseimportmatplotlib.colorsasmcolorscustom_colors=[\"white\",\"#DA8A67\",\"#A0522D\",\"#400000\"]custom_cmap=mcolors.LinearSegmentedColormap.from_list(\"custom_hot\", custom_colors)# Configure matplotlib for publication-quality figures with LaTeX renderingmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, includeCoat='true'):",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "exe=[\"./getFacet2D\", filename, includeCoat]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr):",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "exe=[\"./getData-elastic-scalar2D\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp, taupTemp=[],[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))taupTemp.append(float(temp3[4]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)taup=np.asarray(taupTemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))taup.resize((nz, nr))returnR, Z, D2, vel, taup, nz# ----------------------------------------------------------------------------------------------------------------------defprocess_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess):",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "t=0.01*tiplace=f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\"name=f\"{folder}/{int(t*1000):08d}.png\"ifnotos.path.exists(place):print(f\"{place}File not found!\")returnifos.path.exists(name):print(f\"{name}Image present!\")returnsegs1=gettingFacets(place)segs2=gettingFacets(place,'false')ifnotsegs1andnotsegs2:print(f\"Problem in the available file{place}\")returnnr=int(GridsPerR*rmax)R, Z, taus, vel, taup, nz=gettingfield(place, zmin, zmax, rmax, nr)zminp, zmaxp, rminp, rmaxp=Z.min(), Z.max(), R.min(), R.max()# PlottingAxesLabel, TickLabel=50,20fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)# Draw domain boundariesax.plot([0,0], [zmin, zmax],'-.', color='grey', linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-', color='black', linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-', color='black', linewidth=lw)# Add fluid interfacesline_segments=LineCollection(segs2, linewidths=4, colors='green', linestyle='solid')ax.add_collection(line_segments)line_segments=LineCollection(segs1, linewidths=4, colors='blue', linestyle='solid')ax.add_collection(line_segments)# Plot scalar fields with colormapscntrl1=ax.imshow(taus, cmap=\"hot_r\", interpolation='Bilinear', origin='lower',extent=[-rminp,-rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)#TODO: fixme the colorbar bounds for taup must be set manually based on the simulated case.cntrl2=ax.imshow(taup, interpolation='Bilinear', cmap=custom_cmap, origin='lower',extent=[rminp, rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)# Set plot propertiesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.set_title(f'$t/\\\\tau_\\\\gamma$ ={t:4.3f}', fontsize=TickLabel)# Add colorbarsl, b, w, h=ax.get_position().bounds# Left colorbarcb1=fig.add_axes([l-0.04, b,0.03, h])c1=plt.colorbar(cntrl1, cax=cb1, orientation='vertical')c1.set_label(r'$\\log_{10}\\left(\\|\\mathcal{D}\\|\\right)$', fontsize=TickLabel, labelpad=5)c1.ax.tick_params(labelsize=TickLabel)c1.ax.yaxis.set_ticks_position('left')c1.ax.yaxis.set_label_position('left')c1.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}'))# Right colorbarcb2=fig.add_axes([l+w+0.01, b,0.03, h])c2=plt.colorbar(cntrl2, cax=cb2, orientation='vertical')c2.ax.tick_params(labelsize=TickLabel)c2.set_label(r'$\\log_{10}\\left(\\text{tr}\\left(\\mathcal{A}\\right)-1\\right)$', fontsize=TickLabel)c2.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.2f}'))ax.axis('off')plt.savefig(name, bbox_inches=\"tight\")plt.close()defmain():",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: # Set up...",
    "content": "# Set up command-line argument parsingparser=argparse.ArgumentParser(description='Process fluid dynamics simulation data and create visualizations')parser.add_argument('--CPUs',type=int, default=mp.cpu_count(),help='Number of CPUs to use (default: all available)')parser.add_argument('--nGFS',type=int, default=550,help='Number of restart files to process (default: 550)')parser.add_argument('--ZMAX',type=float, default=4.0,help='Maximum Z value (default: 4.0)')parser.add_argument('--RMAX',type=float, default=2.0,help='Maximum R value (default: 2.0)')parser.add_argument('--ZMIN',type=float, default=-4.0,help='Minimum Z value (default: -4.0)')parser.add_argument('--caseToProcess',type=str,default='../simulationCases/dropImpact',help='Case to process (default: ../simulationCases/dropImpact)')parser.add_argument('--folderToSave',type=str, default='dropImpact',help='Folder to save output images (default: dropImpact)')args=parser.parse_args()# Extract argumentsCPUStoUse=args.CPUsnGFS=args.nGFSZMAX=args.ZMAXRMAX=args.RMAXZMIN=args.ZMINnum_processes=CPUStoUsermin, rmax, zmin, zmax=[-RMAX, RMAX, ZMIN, ZMAX]GridsPerR=128# Grid resolution parameterlw=2# Line width for plot elementsfolder=args.folderToSavecaseToProcess=args.caseToProcess# Create output directory if it doesn't existifnotos.path.isdir(folder):os.makedirs(folder)# Create a pool of worker processes for parallel processingwithmp.Pool(processes=num_processes)aspool:# Create partial function with fixed argumentsprocess_func=partial(process_timestep,folder=folder, nGFS=nGFS,GridsPerR=GridsPerR, rmin=rmin, rmax=rmax,zmin=zmin, zmax=zmax, lw=lw, caseToProcess=caseToProcess)# Map the process_func to all timestepspool.map(process_func,range(nGFS))if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Viscoelastic3D/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "simulationCases/dropAtomisation.c See raw file Drop Atomisation Simulation This file contains the simulation code for multiphase drop atomisation processes, with capabilities for both axisymmetric (2D) and full 3D simulations of viscoelastic fluid dynamics.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The physics model...",
    "content": "The physics model incorporates: - Two-phase flow with sharp interface tracking - Surface tension effects (parameterized by Weber number) - Viscous effects in both phases (parameterized by Ohnesorge numbers) - Optional viscoelastic behavior (controlled by Deborah and Elasto-capillary numbers) - Adaptive mesh refinement to efficiently resolve interfaces and high gradient regions File information File: dropAtomisation.c Author: Ayush Dixit & Vatsal Sanjay Version: 5.0 Date: Oct 20, 2024 // #include \"axi.h\" #include \"grid/octree.h\" // #include \"grid/quadtree.h\" #include \"navier-stokes/centered.h\" Viscoelastic Model Configuration Different implementations of the log-conformation viscoelastic model are available depending on simulation dimensionality: - VANILLA: Original implementation (2D only) - AXI: Axisymmetric scalar implementation - 3D: Full three-dimensional scalar implementation #define VANILLA 0 // vanilla cannot do 3D #if VANILLA #include \"log-conform-viscoelastic.h\" #define logFile \"logAxi-vanilla.dat\" 39 #else #if AXI #include \"log-conform-viscoelastic-scalar-2D.h\" #define logFile \"logAxi-scalar.dat\" 43 #else #include \"log-conform-viscoelastic-scalar-3D.h\" #define logFile \"log3D-scalar.dat\" 46 #endif #endif #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" Simulation Parameters tsnap: Time interval between simulation snapshots Error tolerances: fErr: VOF function tolerance KErr: Curvature calculation tolerance VelErr: Velocity field tolerance AErr: Conformation tensor tolerance #define tsnap ( 0.1 ) // 0.001 only for some cases. // Error tolerances #define fErr ( 1e-2 ) // Error tolerance in f1 VOF #define KErr ( 1e-4 ) // Error tolerance in VoF curvature calculated using height function #define VelErr ( 1e-2 ) // Error tolerances in velocity // Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define AErr ( 1e-3 ) // Error tolerances in conformation inside the liquid Domain and Initial Condition R2 defines a spherical distance function from point (3,0,0) #define R2 ( x , y , z ) ( sq ( x - 3. ) + sq ( y ) + sq ( z )) 80 81 Boundary Conditions Left boundary: Inflow with fixed velocity Right boundary: Outflow with zero pressure // Inflow: left u . n [ left ] = dirichlet ( 1. ); // p[left] = dirichlet(0); // Outflow: right u . n [ right ] = neumann ( 0. ); p [ right ] = dirichlet ( 0 ); Global Variables MAXlevel: Maximum refinement level We: Weber number (ratio of inertial to surface tension forces) Oh: Solvent Ohnesorge number (ratio of viscous to inertial and surface forces) Oha: Air Ohnesorge number De: Deborah number (ratio of relaxation time to flow time) Ec: Elasto-capillary number (ratio of elastic to surface tension forces) RhoInOut: Density ratio between phases tmax: Maximum simulation time int MAXlevel ; double Oh , Oha , De , We , RhoInOut , Ec , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes the simulation domain, sets physical parameters, and starts the simulation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Parameters L0: Domain...",
    "content": "Parameters L0: Domain size RhoInOut: Density ratio between phases We, Oh, Oha: Dimensionless flow parameters De, Ec: Viscoelastic parameters @param argc Number of command line arguments @param argv Array of command line arguments @return Exit status int main ( int argc , char const * argv []) { // dtmax = 1e-5; // BEWARE of this for stability issues. L0 = 20 ; init_grid ( 1 << 6 ); origin ( 0 , - L0 / #if dimension == , - L0 / #endif ); // Values taken from the terminal MAXlevel = 7 ; RhoInOut = 830. ; // Elastic parts De = 0.0 ; Ec = 0.0 ; // Newtonian parts We = 15000 ; // Based on the density of the gas Oh = 3e-3 ; // Based on the density of the liquid Oha = 0.018 * Oh ; // Based on the density of the liquid tmax = 200 ; // Create a folder named intermediate where all the simulation snapshots are stored char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: See writingFiles event...",
    "content": "See writingFiles event sprintf ( dumpFile , \"restart\" ); // Phase properties rho1 = RhoInOut , rho2 = 1e0 ; // As both densities are based on the density of the liquid, we must multiply // the Ohnesorge number by the square root of the density ratio mu1 = sqrt ( RhoInOut )* Oh / sqrt ( We ), mu2 = sqrt ( RhoInOut )* Oha / sqrt ( We ); // Elastic parts // In G1, we need to multiply by the density ratio (again, because Ec is based // on the density of the liquid but in the code it is based on the density of the gas) G1 = Ec / We , G2 = 0.0 ; // Here, lambda is essentially the Weissenberg number, so there is no density // in the expression lambda1 = De * sqrt ( We ), lambda2 = 0.0 ; // Surface tension -- the Weber number is based on the density of the gas! f . sigma = 1.0 / We ; run (); } Initialization Sets up the initial condition as a spherical drop centered at (3,0,0) with radius 1, using adaptive mesh refinement to resolve the interface.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: If a restart...",
    "content": "If a restart file exists, the simulation state is loaded from it instead. event init ( t = 0 ) { if (! restore ( file = dumpFile )) { refine ( R2 ( x , y , z ) < 1.1 && R2 ( x , y , z ) > 0.9 && level < MAXlevel ); fraction ( f , 1. - R2 ( x , y , z )); } } Adaptive Mesh Refinement Dynamically refines the computational mesh based on error criteria for: - Volume fraction (f) - Interface curvature (KAPPA) - Velocity components (u.x, u.y, u.z) This ensures optimal resolution where needed while maintaining computational efficiency in regions with smooth solutions. event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , KAPPA , u . x , u . y #if dimension == , u . z #endif }, ( double []){ fErr , KErr , VelErr , VelErr , #if dimension == VelErr #endif }, MAXlevel , 4 ); } Simulation Snapshots Periodically saves the full state of the simulation for: - Visualization - Analysis - Restart capability Files are saved in the \u2018intermediate\u2019 directory with timestamps. event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Simulation Termination Executed at the end of the simulation to print a summary of key parameters. event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); } Logging and Monitoring Tracks simulation progress and stability by: - Computing total kinetic energy - Writing timestep information - Monitoring for stability issues - Terminating if energy becomes too high (explosion) or too low (stagnation) Log files include: - Iteration number - Time step size - Current simulation time - Total kinetic energy event logWriting ( i ++) { // Calculate total kinetic energy double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y []) #if dimension == + sq ( u . z []) #endif ))* pow ( Delta , dimension ); } static FILE * fp ; if ( pid () == 0 ) { const char * mode = ( i == 0 ) ? \"w\" : \"a\" ; fp = fopen ( logFile , mode ); if ( fp == NULL ) { fprintf ( ferr , \"Error opening log file \\n \" ); return 1 ; } if ( i == 0 ) { fprintf ( ferr , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); fprintf ( ferr , \"i dt t ke \\n \" ); fprintf ( fp , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); fprintf ( fp , \"i dt t ke rM \\n \" ); } fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); fflush ( fp ); fclose ( fp ); } assert ( ke > - 1e-10 ); // Check for simulation stability issues after initial iterations if ( i > 1e1 && pid () == 0 ) { if ( ke > 1e6 || ke < 1e-6 ) { const char * message = ( ke > 1e6 ) ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" : \"Kinetic energy too small now! Stopping! \\n \" ; fprintf ( ferr , \" %s \" , message ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %s \" , message ); fflush ( fp ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } }",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "// #include \"axi.h\"#include\"grid/octree.h\"// #include \"grid/quadtree.h\"#include\"navier-stokes/centered.h\"",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "#define VANILLA0// vanilla cannot do 3D#if VANILLA#include\"log-conform-viscoelastic.h\"#define logFile\"logAxi-vanilla.dat\"39#else#if AXI#include\"log-conform-viscoelastic-scalar-2D.h\"#define logFile\"logAxi-scalar.dat\"43#else#include\"log-conform-viscoelastic-scalar-3D.h\"#define logFile\"log3D-scalar.dat\"46#endif#endif#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#define tsnap(0.1)// 0.001 only for some cases.// Error tolerances#define fErr(1e-2)// Error tolerance in f1 VOF#define KErr(1e-4)// Error tolerance in VoF curvature calculated using height function#define VelErr(1e-2)// Error tolerances in velocity// Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J#define AErr(1e-3)// Error tolerances in conformation inside the liquid",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "// Inflow: leftu.n[left]=dirichlet(1.);// p[left] = dirichlet(0);// Outflow: rightu.n[right]=neumann(0.);p[right]=dirichlet(0);",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intMAXlevel;doubleOh,Oha,De,We,RhoInOut,Ec,tmax;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: intmain(intargc,charconst*argv[]){// dtmax =...",
    "content": "intmain(intargc,charconst*argv[]){// dtmax = 1e-5; //  BEWARE of this for stability issues.L0=20;init_grid(1<<6);origin(0,-L0/#if dimension ==,-L0/#endif);// Values taken from the terminalMAXlevel=7;RhoInOut=830.;// Elastic partsDe=0.0;Ec=0.0;// Newtonian partsWe=15000;// Based on the density of the gasOh=3e-3;// Based on the density of the liquidOha=0.018*Oh;// Based on the density of the liquidtmax=200;// Create a folder named intermediate where all the simulation snapshots are storedcharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: See writingFiles eventsprintf(dumpFile,\"restart\");//...",
    "content": "See writingFiles eventsprintf(dumpFile,\"restart\");// Phase propertiesrho1=RhoInOut,rho2=1e0;// As both densities are based on the density of the liquid, we must multiply// the Ohnesorge number by the square root of the density ratiomu1=sqrt(RhoInOut)*Oh/sqrt(We),mu2=sqrt(RhoInOut)*Oha/sqrt(We);// Elastic parts// In G1, we need to multiply by the density ratio (again, because Ec is based// on the density of the liquid but in the code it is based on the density of the gas)G1=Ec/We,G2=0.0;// Here, lambda is essentially the Weissenberg number, so there is no density// in the expressionlambda1=De*sqrt(We),lambda2=0.0;// Surface tension -- the Weber number is based on the density of the gas!f.sigma=1.0/We;run();}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event init(t=0){if(!restore(file=dumpFile)){refine(R2(x,y,z)<1.1&&R2(x,y,z)>0.9&&level<MAXlevel);fraction(f,1.-R2(x,y,z));}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,KAPPA,u.x,u.y#if dimension ==,u.z#endif},(double[]){fErr,KErr,VelErr,VelErr,#if dimension ==VelErr#endif},MAXlevel,4);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: event logWriting(i++){// Calculate...",
    "content": "event logWriting(i++){// Calculate total kinetic energydoubleke=0.;foreach(reduction(+:ke)){ke+=(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])#if dimension ==+sq(u.z[])#endif))*pow(Delta,dimension);}staticFILE*fp;if(pid()==0){constchar*mode=(i==0)?\"w\":\"a\";fp=fopen(logFile,mode);if(fp==NULL){fprintf(ferr,\"Error opening log file\\n\");return1;}if(i==0){fprintf(ferr,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);fprintf(ferr,\"i dt t ke\\n\");fprintf(fp,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);fprintf(fp,\"i dt t ke rM\\n\");}fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);fflush(fp);fclose(fp);}assert(ke>-1e-10);// Check for simulation stability issues after initial iterationsif(i>1e1&&pid()==0){if(ke>1e6||ke<1e-6){constchar*message=(ke>1e6)?\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropAtomisation.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Stopping simulation\\n\":\"Kinetic energy...",
    "content": "Stopping simulation\\n\":\"Kinetic energy too small now! Stopping!\\n\";fprintf(ferr,\"%s\",message);fp=fopen(\"log\",\"a\");fprintf(fp,\"%s\",message);fflush(fp);fclose(fp);dump(file=dumpFile);return1;}}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropAtomisation.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases dropAtomisation.c This file contains the simulation code for multiphase drop atomisation processes, with capabilities for both axisymme... dropImpact.c This file contains the simulation code for drop impact on a solid surface using a Volume of Fluid (VOF) method with v... pinchOff.c This file implements an axisymmetric simulation of the pinch-off dynamics of a viscoelastic liquid jet. The simulatio... testEigenDecomposition.c This module implements the diagonalization of 3D symmetric matrices through eigendecomposition, allowing the computat... verifyWtihPlots.ipynb This notebook provides visualization and analysis related to verifyWtihPlots.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Methods",
    "content": "simulationCases/dropImpact.c See raw file Drop Impact Simulation This file contains the simulation code for drop impact on a solid surface using a Volume of Fluid (VOF) method with viscoelastic fluid modeling capabilities. The simulation uses an adaptive mesh refinement approach to efficiently resolve the interface dynamics during impact. The model can handle both Newtonian and viscoelastic fluids through a log-conformation formulation for the polymeric stress tensor. Physical Model The simulation solves the Navier-Stokes equations for incompressible flow coupled with a viscoelastic constitutive equation. The interface between the two fluids is tracked using a VOF method with surface tension.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Key dimensionless parameters:...",
    "content": "Key dimensionless parameters: Weber number ( \\(We\\) ): Ratio of inertia to surface tension Ohnesorge number ( \\(Oh\\) ): Ratio of viscous to inertial and surface tension forces Deborah number ( \\(De\\) ): Ratio of relaxation time to characteristic flow time Elastocapillary number ( \\(Ec\\) ): Ratio of elastic to capillary forces @file dropImpact.c @author Vatsal Sanjay @version 0.2 @date Oct 18, 2024 // #include \"axi.h\" #include \"grid/octree.h\" // #include \"grid/quadtree.h\" #include \"navier-stokes/centered.h\" #define VANILLA 0 36 #if VANILLA #include \"log-conform-viscoelastic.h\" #define logFile \"logAxi-vanilla.dat\" 39 #else #if AXI #include \"log-conform-viscoelastic-scalar-2D.h\" #define logFile \"logAxi-scalar.dat\" 43 #else #include \"log-conform-viscoelastic-scalar-3D.h\" #define logFile \"log3D-scalar.dat\" 46 #endif #endif #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" Simulation Parameters Timing Parameters tsnap: Time interval between snapshots (1e-2) #define tsnap ( 1e-2 ) 62 63 Numerical Error Tolerances fErr: Error tolerance in VOF function f1 (1e-3) KErr: Error tolerance in VOF curvature calculated using height function method (1e-6) VelErr: Error tolerances in velocity (1e-2) Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define fErr ( 1e-3 ) 71 #define KErr ( 1e-6 ) 72 #define VelErr ( 1e-2 ) 73 74 Domain Configuration xDist: Initial horizontal displacement of droplet center from boundary (5e-2) R2: Function to calculate squared distance from droplet center #define xDist ( 5e-2 ) 80 #define R2 ( x , y , z ) ( sq ( x - 1. - xDist ) + sq ( y ) + sq ( z )) 81 82 Boundary Conditions Dirichlet boundary condition for volume fraction at left boundary.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Note: No-slip boundary...",
    "content": "Note: No-slip boundary conditions are commented out for testing purposes. // u.t[left] = dirichlet(0.); // todo: later on use no-slip. For testing, free-slip is faster. // u.r[left] = dirichlet(0.); // todo: later on use no-slip. For testing, free-slip is faster. f [ left ] = dirichlet ( 0.0 ); Global Variables MAXlevel: Maximum level of grid refinement We: Weber number of the drop Oh: Solvent Ohnesorge number Oha: Air Ohnesorge number De: Deborah number Ec: Elasto-capillary number tmax: Maximum simulation time nameOut: Output filename for snapshots dumpFile: Filename for restart dumps int MAXlevel ; double We , Oh , Oha , De , Ec , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes the simulation parameters and grid, then starts the simulation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: C/C++ Main",
    "content": "Parameters argc: Command-line argument count argv: Command-line argument array Return Value Returns 0 on successful completion int main ( int argc , char const * argv []) { dtmax = 1e-5 ; L0 = 4.0 ; // Values taken from the terminal MAXlevel = 6 ; tmax = 3.0 ; We = 5.0 ; Oh = 1e-2 ; Oha = 1e-2 * Oh ; De = 1.0 ; Ec = 1.0 ; init_grid ( 1 << 4 ); // Create a folder named intermediate where all the simulation snapshots are stored char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file sprintf ( dumpFile , \"restart\" ); // Set fluid properties for both phases rho1 = 1.0 , rho2 = 1e-3 ; mu1 = Oh / sqrt ( We ), mu2 = Oha / sqrt ( We ); G1 = Ec / We , G2 = 0.0 ; lambda1 = De * sqrt ( We ), lambda2 = 0.0 ; f . sigma = 1.0 / We ; run (); return 0 ; } Initialization Event Sets up the initial condition for the droplet and velocity field. The event initializes a spherical droplet using the VOF method and sets an initial horizontal velocity.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: If a restart...",
    "content": "If a restart file exists, the simulation state is restored from it instead. @param t Time (set to 0 for initialization) event init ( t = 0 ) { if (! restore ( file = dumpFile )) { refine ( R2 ( x , y , z ) < ( 1.1 ) && R2 ( x , y , z ) > ( 0.9 ) && level < MAXlevel ); fraction ( f , ( 1 - R2 ( x , y , z ))); foreach () { u . x [] = - f [] * 1.0 ; } } } Adaptive Mesh Refinement Refines the computational mesh based on wavelet error estimates for the tracked fields to efficiently allocate computational resources.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: JavaScript",
    "content": "The refinement criteria track errors in: - Volume fraction field (f) - Velocity components (u.x, u.y, u.z) @param i Current iteration number event adapt ( i ++) { adapt_wavelet (( scalar *){ f , u . x , u . y , u . z }, ( double []){ fErr , VelErr , VelErr , VelErr }, MAXlevel , 4 ); } Snapshot Writing Creates periodic dumps of the simulation state for visualization and restarts. @param t Current simulation time @param tsnap Time interval between snapshots @param tmax Maximum simulation time event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Simulation Termination Outputs final simulation parameters to standard error when the simulation ends. @param t End time event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); } Simulation Logging Records simulation progress and checks for numerical stability.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "This event: 1. Calculates the total kinetic energy of the system 2. Writes simulation data to the log file 3. Checks for numerical stability based on kinetic energy values 4.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Terminates the simulation...",
    "content": "Terminates the simulation if energy values indicate instability @param i Current iteration number @return Returns 1 (terminating the simulation) if instability is detected event logWriting ( i ++) { // Calculate kinetic energy double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 2 * pi * y ) * ( 0.5 * rho ( f []) * ( sq ( u . x []) + sq ( u . y []))) * sq ( Delta ); } static FILE * fp ; if ( pid () == 0 ) { const char * mode = ( i == 0 ) ? \"w\" : \"a\" ; fp = fopen ( logFile , mode ); if ( fp == NULL ) { fprintf ( ferr , \"Error opening log file \\n \" ); return 1 ; } if ( i == 0 ) { fprintf ( ferr , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); fprintf ( ferr , \"i dt t ke \\n \" ); fprintf ( fp , \"Level %d , Oh %2.1e , We %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , We , Oha , De , Ec ); fprintf ( fp , \"i dt t ke rM \\n \" ); } fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); fflush ( fp ); fclose ( fp ); } assert ( ke > - 1e-10 ); // Stability check based on kinetic energy if ( i > 1e1 && pid () == 0 ) { if ( ke > 1e2 || ke < 1e-8 ) { const char * message = ( ke > 1e2 ) ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" : \"Kinetic energy too small now! Stopping! \\n \" ; fprintf ( ferr , \" %s \" , message ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %s \" , message ); fflush ( fp ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } }",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code: C/C++ Code",
    "content": "// #include \"axi.h\"#include\"grid/octree.h\"// #include \"grid/quadtree.h\"#include\"navier-stokes/centered.h\"#define VANILLA036#if VANILLA#include\"log-conform-viscoelastic.h\"#define logFile\"logAxi-vanilla.dat\"39#else#if AXI#include\"log-conform-viscoelastic-scalar-2D.h\"#define logFile\"logAxi-scalar.dat\"43#else#include\"log-conform-viscoelastic-scalar-3D.h\"#define logFile\"log3D-scalar.dat\"46#endif#endif#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#define fErr(1e-3)71#define KErr(1e-6)72#define VelErr(1e-2)7374",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#define xDist(5e-2)80#define R2(x,y,z)(sq(x-1.-xDist)+sq(y)+sq(z))8182",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "// u.t[left] = dirichlet(0.); // todo: later on use no-slip. For testing, free-slip is faster.// u.r[left] = dirichlet(0.); // todo: later on use no-slip. For testing, free-slip is faster.f[left]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intMAXlevel;doubleWe,Oh,Oha,De,Ec,tmax;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intmain(intargc,charconst*argv[]){dtmax=1e-5;L0=4.0;// Values taken from the terminalMAXlevel=6;tmax=3.0;We=5.0;Oh=1e-2;Oha=1e-2*Oh;De=1.0;Ec=1.0;init_grid(1<<4);// Create a folder named intermediate where all the simulation snapshots are storedcharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart filesprintf(dumpFile,\"restart\");// Set fluid properties for both phasesrho1=1.0,rho2=1e-3;mu1=Oh/sqrt(We),mu2=Oha/sqrt(We);G1=Ec/We,G2=0.0;lambda1=De*sqrt(We),lambda2=0.0;f.sigma=1.0/We;run();return0;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event init(t=0){if(!restore(file=dumpFile)){refine(R2(x,y,z)<(1.1)&&R2(x,y,z)>(0.9)&&level<MAXlevel);fraction(f,(1-R2(x,y,z)));foreach(){u.x[]=-f[]*1.0;}}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event adapt(i++){adapt_wavelet((scalar*){f,u.x,u.y,u.z},(double[]){fErr,VelErr,VelErr,VelErr},MAXlevel,4);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: event logWriting(i++){// Calculate...",
    "content": "event logWriting(i++){// Calculate kinetic energydoubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])))*sq(Delta);}staticFILE*fp;if(pid()==0){constchar*mode=(i==0)?\"w\":\"a\";fp=fopen(logFile,mode);if(fp==NULL){fprintf(ferr,\"Error opening log file\\n\");return1;}if(i==0){fprintf(ferr,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);fprintf(ferr,\"i dt t ke\\n\");fprintf(fp,\"Level%d, Oh%2.1e, We%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,We,Oha,De,Ec);fprintf(fp,\"i dt t ke rM\\n\");}fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);fflush(fp);fclose(fp);}assert(ke>-1e-10);// Stability check based on kinetic energyif(i>1e1&&pid()==0){if(ke>1e2||ke<1e-8){constchar*message=(ke>1e2)?\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Stopping simulation\\n\":\"Kinetic energy...",
    "content": "Stopping simulation\\n\":\"Kinetic energy too small now! Stopping!\\n\";fprintf(ferr,\"%s\",message);fp=fopen(\"log\",\"a\");fprintf(fp,\"%s\",message);fflush(fp);fclose(fp);dump(file=dumpFile);return1;}}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "simulationCases/testEigenDecomposition.c See raw file 3D Matrix Diagonalization and Eigendecomposition This module implements the diagonalization of 3D symmetric matrices through eigendecomposition, allowing the computation of eigenvalues and eigenvectors for 3x3 symmetric matrices.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The implementation follows...",
    "content": "The implementation follows standard linear algebra approaches to compute \\(A = R \\times \\Lambda \\times R^T\\) where: \\(A\\) is the original symmetric matrix \\(R\\) is the orthogonal matrix of eigenvectors \\(\\Lambda\\) is the diagonal matrix of eigenvalues Numerical Parameters EPSILON: Used for floating-point comparisons to zero RELATIVE_TOLERANCE: Used for relative error checks in verification #include <stdio.h> #include <math.h> #include <stdlib.h> #include \"eigen_decomposition.h\" #define EPSILON 1e-9 24 #define RELATIVE_TOLERANCE 1e-6 25 #define sq ( x ) (( x )*( x )) 26 27 Data Structures 3D Vector Represents a 3D vector with long double precision components. typedef struct { long double x , y , z ; } pseudo_v3d ; 3D Tensor/Matrix Represents a 3x3 matrix or tensor with long double precision components. Organized as three row vectors (x, y, z). typedef struct { pseudo_v3d x , y , z ; } pseudo_t3d ; diagonalization_3D Performs eigendecomposition of a 3D symmetric matrix.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "This function computes the eigenvalues and eigenvectors of a 3x3 symmetric matrix using the eigen_decomposition function. It handles special cases where the matrix is already diagonal.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "Parameters: - Lambda: Output parameter to store the eigenvalues - R: Output parameter to store the eigenvectors as columns of R - A: Input symmetric matrix to be diagonalized The function maps the struct-based representation to arrays for computation and then maps the results back to the struct-based representation. static void diagonalization_3D ( pseudo_v3d * Lambda , pseudo_t3d * R , pseudo_t3d * A ) { // Check if the matrix is already diagonal if ( sq ( A -> x . y ) + sq ( A -> x . z ) + sq ( A -> y . z ) < 1e-15 ) { R -> x . x = R -> y . y = R -> z . z = 1. ; R -> y . x = R -> x . y = R -> z . x = R -> x . z = R -> z . y = R -> y . z = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; Lambda -> z = A -> z . z ; return ; } // Compute eigenvalues using the eigen_decomposition function double matrix [ 3 ][ 3 ] = { { A -> x . x , A -> x . y , A -> x . z }, { A -> x . y , A -> y . y , A -> y . z }, { A -> x . z , A -> y . z , A -> z . z } }; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); // Store eigenvalues and eigenvectors with proper index mapping Lambda -> x = eigenvalues [ 0 ]; Lambda -> y = eigenvalues [ 1 ]; Lambda -> z = eigenvalues [ 2 ]; R -> x . x = eigenvectors [ 0 ][ 0 ]; R -> x . y = eigenvectors [ 0 ][ 1 ]; R -> x . z = eigenvectors [ 0 ][ 2 ]; R -> y . x = eigenvectors [ 1 ][ 0 ]; R -> y . y = eigenvectors [ 1 ][ 1 ]; R -> y . z = eigenvectors [ 1 ][ 2 ]; R -> z . x = eigenvectors [ 2 ][ 0 ]; R -> z . y = eigenvectors [ 2 ][ 1 ]; R -> z . z = eigenvectors [ 2 ][ 2 ]; } print_pseudo_t3d Prints a 3x3 matrix to standard output with formatting.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: JavaScript",
    "content": "Parameters: - name: Label for the matrix output - matrix: Pointer to the 3x3 matrix to be printed void print_pseudo_t3d ( const char * name , const pseudo_t3d * matrix ) { printf ( \" %s : \\n \" , name ); printf ( \" %12.9Lf %12.9Lf %12.9Lf\\n \" , matrix -> x . x , matrix -> x . y , matrix -> x . z ); printf ( \" %12.9Lf %12.9Lf %12.9Lf\\n \" , matrix -> y . x , matrix -> y . y , matrix -> y . z ); printf ( \" %12.9Lf %12.9Lf %12.9Lf\\n \" , matrix -> z . x , matrix -> z . y , matrix -> z . z ); printf ( \" \\n \" ); } print_pseudo_v3d Prints a 3D vector to standard output with formatting. Parameters: - name: Label for the vector output - vector: Pointer to the 3D vector to be printed void print_pseudo_v3d ( const char * name , const pseudo_v3d * vector ) { printf ( \" %s : %12.9Lf %12.9Lf %12.9Lf\\n\\n \" , name , vector -> x , vector -> y , vector -> z ); } verify_orthonormality Verifies that the eigenvectors form an orthonormal basis. This function checks two key properties of eigenvectors: 1.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Each eigenvector has...",
    "content": "Each eigenvector has unit norm (normalized) 2. Eigenvectors are mutually orthogonal (dot product is zero) Parameters: - R: Matrix containing eigenvectors as columns Returns: - 1 if eigenvectors are orthonormal - 0 otherwise, with diagnostic messages printed to stdout int verify_orthonormality ( const pseudo_t3d * R ) { for ( int i = 0 ; i < 3 ; i ++) { long double norm = sq ((( long double *) R )[ i ]) + sq ((( long double *) R )[ i + 3 ]) + sq ((( long double *) R )[ i + 6 ]); if ( fabsl ( norm - 1.0 L ) > EPSILON ) { printf ( \"Eigenvector %d is not normalized. Norm = %Lf\\n \" , i , sqrtl ( norm )); return 0 ; } for ( int j = i + 1 ; j < 3 ; j ++) { long double dot_product = (( long double *) R )[ i ] * (( long double *) R )[ j ] + (( long double *) R )[ i + 3 ] * (( long double *) R )[ j + 3 ] + (( long double *) R )[ i + 6 ] * (( long double *) R )[ j + 6 ]; if ( fabsl ( dot_product ) > EPSILON ) { printf ( \"Eigenvectors %d and %d are not orthogonal.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Dot product =...",
    "content": "Dot product = %Lf\\n \" , i , j , dot_product ); return 0 ; } } } return 1 ; } verify_diagonalization Verifies that the matrix is properly diagonalized by computing R^T * A * R and checking if it approximates a diagonal matrix with eigenvalues. Parameters: - A: Original matrix - R: Matrix of eigenvectors - Lambda: Vector of eigenvalues Returns: - 1 if diagonalization is verified - 0 otherwise, with diagnostic messages printed to stdout The function checks two properties: 1. Diagonal elements match the eigenvalues within relative tolerance 2.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: JavaScript",
    "content": "Off-diagonal elements are approximately zero int verify_diagonalization ( const pseudo_t3d * A , const pseudo_t3d * R , const pseudo_v3d * Lambda ) { pseudo_t3d temp , diagonalized ; // Compute R^T * A * R for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { (( long double *)& temp )[ i * 3 + j ] = 0 ; for ( int k = 0 ; k < 3 ; k ++) { (( long double *)& temp )[ i * 3 + j ] += (( long double *) R )[ k * 3 + i ] * (( long double *) A )[ k * 3 + j ]; } } } for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { (( long double *)& diagonalized )[ i * 3 + j ] = 0 ; for ( int k = 0 ; k < 3 ; k ++) { (( long double *)& diagonalized )[ i * 3 + j ] += (( long double *)& temp )[ i * 3 + k ] * (( long double *) R )[ k * 3 + j ]; } } } // Print the diagonalized matrix print_pseudo_t3d ( \"Diagonalized matrix: (R^T * A * R)\" , & diagonalized ); for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { if ( i == j ) { long double relative_error = fabsl ((( long double *)& diagonalized )[ i * 3 + j ] - (( long double *) Lambda )[ i ]) / ( fabsl ((( long double *) Lambda )[ i ]) + EPSILON ); if ( relative_error > RELATIVE_TOLERANCE ) { printf ( \"Diagonal element ( %d , %d ) does not match eigenvalue. %Lf != %Lf \" \"(relative error: %Lf ) \\n \" , i , j , (( long double *)& diagonalized )[ i * 3 + j ], (( long double *) Lambda )[ i ], relative_error ); } } else { if ( fabsl ((( long double *)& diagonalized )[ i * 3 + j ]) > EPSILON ) { printf ( \"Off-diagonal element ( %d , %d ) is not zero.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "Value = %Lf\\n \" , i , j , (( long double *)& diagonalized )[ i * 3 + j ]); } } } } return 1 ; } verify_eigenpairs Verifies that \\(A \\times v = \\lambda \\times v\\) for each eigenpair. This function checks the fundamental eigenvalue equation by: 1. Computing \\(A \\times v\\) for each eigenvector 2. Computing \\(\\lambda \\times v\\) for each eigenvector 3.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Comparing the results for approximate equality Parameters: - A: Original matrix - R: Matrix containing eigenvectors as columns - Lambda: Vector of eigenvalues Returns: - 1 if all eigenpairs are verified - 0 otherwise, with diagnostic messages printed to stdout int verify_eigenpairs ( const pseudo_t3d * A , const pseudo_t3d * R , const pseudo_v3d * Lambda ) { printf ( \"Verifying A * v = \u03bb * v for each eigenpair: \\n \" ); for ( int i = 0 ; i < 3 ; i ++) { pseudo_v3d Av = { 0 }, lambda_v = { 0 }; // Compute A * v for ( int j = 0 ; j < 3 ; j ++) { (( double *)& Av )[ j ] = (( double *) A )[ j * 3 ] * (( double *) R )[ i ] + (( double *) A )[ j * 3 + 1 ] * (( double *) R )[ i + 3 ] + (( double *) A )[ j * 3 + 2 ] * (( double *) R )[ i + 6 ]; } // Compute \u03bb * v for ( int j = 0 ; j < 3 ; j ++) { (( double *)& lambda_v )[ j ] = (( double *) Lambda )[ i ] * (( double *) R )[ i + j * 3 ]; } printf ( \"Eigenpair %d : \\n \" , i + 1 ); printf ( \"A * v = %8.4Lf %8.4Lf %8.4Lf\\n \" , Av . x , Av . y , Av . z ); printf ( \"\u03bb * v = %8.4Lf %8.4Lf %8.4Lf\\n \" , lambda_v . x , lambda_v . y , lambda_v . z ); // Check if A * v \u2248 \u03bb * v for ( int j = 0 ; j < 3 ; j ++) { if ( fabs ((( double *)& Av )[ j ] - (( double *)& lambda_v )[ j ]) > EPSILON ) { printf ( \"Mismatch for eigenpair %d , component %d\\n \" , i + 1 , j + 1 ); } } printf ( \"Verification A * v = \u03bb * v for each eigenpair done. \" \"See the messages above! \\n\\n \" ); } return 1 ; } verify_eigendecomposition Main verification function that combines all verification tests.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "This function verifies the eigendecomposition by: 1. Checking orthonormality of eigenvectors 2. Verifying diagonalization ( \\(R^T \\times A \\times R \\approx \\Lambda\\) ) 3.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Confirming the eigenpair...",
    "content": "Confirming the eigenpair equation ( \\(A \\times v = \\lambda \\times v\\) ) Parameters: - A: Original matrix - R: Matrix of eigenvectors - Lambda: Vector of eigenvalues Returns: - 1 when verification completes - Messages about verification status are printed to stdout int verify_eigendecomposition ( const pseudo_t3d * A , const pseudo_t3d * R , const pseudo_v3d * Lambda ) { if (! verify_orthonormality ( R )) { printf ( \"Eigenvectors are not orthonormal. \\n \" ); } else { printf ( \"Eigenvectors are orthonormal. \\n \" ); } printf ( \" \\n \" ); if (! verify_diagonalization ( A , R , Lambda )) { printf ( \"Matrix is not properly diagonalized. \\n \" ); } else { printf ( \"Matrix is properly diagonalized. \\n \" ); } if (! verify_eigenpairs ( A , R , Lambda )) { printf ( \"Eigenpair verification failed. \\n \" ); } else { printf ( \"Eigenpair verification passed. \\n \" ); } printf ( \"Eigendecomposition verification completed.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: See the messages...",
    "content": "See the messages above! \\n \" ); return 1 ; } verify_reconstruction Verifies that \\(A = R \\times \\Lambda \\times R^T\\) by reconstructing \\(A\\) from the eigendecomposition. This function: 1. Creates a diagonal matrix from the eigenvalues 2. Computes \\(R \\times \\Lambda \\times R^T\\) 3.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Compares the result with the original matrix \\(A\\) Parameters: - A: Original matrix - R: Matrix of eigenvectors - Lambda: Vector of eigenvalues Returns: - 1 when verification completes - Differences between original and reconstructed matrices are printed to stdout int verify_reconstruction ( const pseudo_t3d * A , const pseudo_t3d * R , const pseudo_v3d * Lambda ) { pseudo_t3d Lambda_diag , temp , A_reconstructed ; // Create diagonal matrix from Lambda for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { (( long double *)& Lambda_diag )[ i * 3 + j ] = ( i == j ) ? (( long double *) Lambda )[ i ] : 0.0 L ; } } // Compute R * Lambda for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { (( long double *)& temp )[ i * 3 + j ] = 0 ; for ( int k = 0 ; k < 3 ; k ++) { (( long double *)& temp )[ i * 3 + j ] += (( long double *) R )[ i * 3 + k ] * (( long double *)& Lambda_diag )[ k * 3 + j ]; } } } // Compute (R * Lambda) * R^T for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { (( long double *)& A_reconstructed )[ i * 3 + j ] = 0 ; for ( int k = 0 ; k < 3 ; k ++) { (( long double *)& A_reconstructed )[ i * 3 + j ] += (( long double *)& temp )[ i * 3 + k ] * (( long double *) R )[ j * 3 + k ]; } } } print_pseudo_t3d ( \"Reconstructed A = R * Lambda * R^T\" , & A_reconstructed ); // Compare original A with reconstructed A for ( int i = 0 ; i < 3 ; i ++) { for ( int j = 0 ; j < 3 ; j ++) { long double diff = fabsl ((( long double *) A )[ i * 3 + j ] - (( long double *)& A_reconstructed )[ i * 3 + j ]); if ( diff > EPSILON ) { printf ( \"Mismatch at ( %d , %d ): original = %Lf , reconstructed = %Lf , \" \"difference = %Lf\\n \" , i , j , (( long double *) A )[ i * 3 + j ], (( long double *)& A_reconstructed )[ i * 3 + j ], diff ); } } } printf ( \"A = R * Lambda * R^T verification completed.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: See the messages...",
    "content": "See the messages above! \\n \" ); return 1 ; } Main Function Entry point of the program that demonstrates matrix diagonalization and verification. The function: 1. Initializes a symmetric matrix A (default or from command line arguments) 2. Performs eigendecomposition to compute eigenvalues and eigenvectors 3.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Runs verification procedures to confirm the correctness of the results Command-line usage: ./program A11 A12 A13 A22 A23 A33 Where A11\u2026A33 are the elements of the symmetric matrix If no arguments are provided, a default matrix is used: A = [ 1 2 3 ] [ 2 4 5 ] [ 3 5 -6 ] Returns: - 0 on successful execution int main ( int argc , char * argv []) { pseudo_t3d A , R ; pseudo_v3d Lambda ; // Initialize A with the given values Matrix Initialization Options Uncomment one of the following blocks to use a specific test matrix: Diagonal (not identity) matrix: A.x.x = 1; A.x.y = 0; A.x.z = 0; A.y.x = 0; A.y.y = 2; A.y.z = 0; A.z.x = 0; A.z.y = 0; A.z.z = 3; Identity matrix: A.x.x = 1; A.x.y = 0; A.x.z = 0; A.y.x = 0; A.y.y = 1; A.y.z = 0; A.z.x = 0; A.z.y = 0; A.z.z = 1; Non-diagonal matrix: A.x.x = 1; A.x.y = 2; A.x.z = 3; A.y.x = 2; A.y.y = 4; A.y.z = 5; A.z.x = 3; A.z.y = 5; A.z.z = -6; Small magnitude matrix: A.x.x = 1e-6; A.x.y = 0; A.x.z = 0; A.y.x = 0; A.y.y = 1e-12; A.y.z = 0; A.z.x = 0; A.z.y = 0; A.z.z = 1e-10; Large magnitude matrix: A.x.x = 100; A.x.y = 100; A.x.z = 10; A.y.x = 100; A.y.y = 10; A.y.z = 1; A.z.x = 10; A.z.y = 1; A.z.z = 0.1; if ( argc != 7 ) { A . x . x = 1 ; A . x . y = 2 ; A . x . z = 3 ; A . y . x = 2 ; A . y . y = 4 ; A . y . z = 5 ; A . z . x = 3 ; A . z . y = 5 ; A . z . z = - 6 ; } else { // Get matrix elements from command line arguments A . x . x = atof ( argv [ 1 ]); A . x . y = atof ( argv [ 2 ]); A . x . z = atof ( argv [ 3 ]); A . y . x = atof ( argv [ 2 ]); A . y . y = atof ( argv [ 4 ]); A . y . z = atof ( argv [ 5 ]); A . z . x = atof ( argv [ 3 ]); A . z . y = atof ( argv [ 5 ]); A . z . z = atof ( argv [ 6 ]); } print_pseudo_t3d ( \"Original matrix A\" , & A ); diagonalization_3D (& Lambda , & R , & A ); print_pseudo_t3d ( \"Eigenvectors R\" , & R ); print_pseudo_v3d ( \"Eigenvalues Lambda\" , & Lambda ); verify_eigendecomposition (& A , & R , & Lambda ); // Verify that A = R * Lambda * R^T verify_reconstruction (& A , & R , & Lambda ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "#include<stdio.h>#include<math.h>#include<stdlib.h>#include\"eigen_decomposition.h\"#define EPSILON1e-924#define RELATIVE_TOLERANCE1e-625#define sq(x)((x)*(x))2627",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: staticvoiddiagonalization_3D(pseudo_v3d*Lambda,pseudo_t3d*R,pseudo_t3d*A){// Check if...",
    "content": "staticvoiddiagonalization_3D(pseudo_v3d*Lambda,pseudo_t3d*R,pseudo_t3d*A){// Check if the matrix is already diagonalif(sq(A->x.y)+sq(A->x.z)+sq(A->y.z)<1e-15){R->x.x=R->y.y=R->z.z=1.;R->y.x=R->x.y=R->z.x=R->x.z=R->z.y=R->y.z=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;Lambda->z=A->z.z;return;}// Compute eigenvalues using the eigen_decomposition functiondoublematrix[3][3]={{A->x.x,A->x.y,A->x.z},{A->x.y,A->y.y,A->y.z},{A->x.z,A->y.z,A->z.z}};doubleeigenvectors[3][3];doubleeigenvalues[3];compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);// Store eigenvalues and eigenvectors with proper index mappingLambda->x=eigenvalues[0];Lambda->y=eigenvalues[1];Lambda->z=eigenvalues[2];R->x.x=eigenvectors[0][0];R->x.y=eigenvectors[0][1];R->x.z=eigenvectors[0][2];R->y.x=eigenvectors[1][0];R->y.y=eigenvectors[1][1];R->y.z=eigenvectors[1][2];R->z.x=eigenvectors[2][0];R->z.y=eigenvectors[2][1];R->z.z=eigenvectors[2][2];}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "voidprint_pseudo_t3d(constchar*name,constpseudo_t3d*matrix){printf(\"%s:\\n\",name);printf(\"%12.9Lf%12.9Lf%12.9Lf\\n\",matrix->x.x,matrix->x.y,matrix->x.z);printf(\"%12.9Lf%12.9Lf%12.9Lf\\n\",matrix->y.x,matrix->y.y,matrix->y.z);printf(\"%12.9Lf%12.9Lf%12.9Lf\\n\",matrix->z.x,matrix->z.y,matrix->z.z);printf(\"\\n\");}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "voidprint_pseudo_v3d(constchar*name,constpseudo_v3d*vector){printf(\"%s:%12.9Lf%12.9Lf%12.9Lf\\n\\n\",name,vector->x,vector->y,vector->z);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intverify_orthonormality(constpseudo_t3d*R){for(inti=0;i<3;i++){longdoublenorm=sq(((longdouble*)R)[i])+sq(((longdouble*)R)[i+3])+sq(((longdouble*)R)[i+6]);if(fabsl(norm-1.0L)>EPSILON){printf(\"Eigenvector%dis not normalized.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "Norm =%Lf\\n\",i,sqrtl(norm));return0;}for(intj=i+1;j<3;j++){longdoubledot_product=((longdouble*)R)[i]*((longdouble*)R)[j]+((longdouble*)R)[i+3]*((longdouble*)R)[j+3]+((longdouble*)R)[i+6]*((longdouble*)R)[j+6];if(fabsl(dot_product)>EPSILON){printf(\"Eigenvectors%dand%dare not orthogonal. Dot product =%Lf\\n\",i,j,dot_product);return0;}}}return1;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intverify_diagonalization(constpseudo_t3d*A,constpseudo_t3d*R,constpseudo_v3d*Lambda){pseudo_t3d temp,diagonalized;// Compute R^T * A * Rfor(inti=0;i<3;i++){for(intj=0;j<3;j++){((longdouble*)&temp)[i*3+j]=0;for(intk=0;k<3;k++){((longdouble*)&temp)[i*3+j]+=((longdouble*)R)[k*3+i]*((longdouble*)A)[k*3+j];}}}for(inti=0;i<3;i++){for(intj=0;j<3;j++){((longdouble*)&diagonalized)[i*3+j]=0;for(intk=0;k<3;k++){((longdouble*)&diagonalized)[i*3+j]+=((longdouble*)&temp)[i*3+k]*((longdouble*)R)[k*3+j];}}}// Print the diagonalized matrixprint_pseudo_t3d(\"Diagonalized matrix: (R^T * A * R)\",&diagonalized);for(inti=0;i<3;i++){for(intj=0;j<3;j++){if(i==j){longdoublerelative_error=fabsl(((longdouble*)&diagonalized)[i*3+j]-((longdouble*)Lambda)[i])/(fabsl(((longdouble*)Lambda)[i])+EPSILON);if(relative_error>RELATIVE_TOLERANCE){printf(\"Diagonal element (%d,%d) does not match eigenvalue.%Lf!=%Lf\"\"(relative error:%Lf)\\n\",i,j,((longdouble*)&diagonalized)[i*3+j],((longdouble*)Lambda)[i],relative_error);}}else{if(fabsl(((longdouble*)&diagonalized)[i*3+j])>EPSILON){printf(\"Off-diagonal element (%d,%d) is not zero.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "Value =%Lf\\n\",i,j,((longdouble*)&diagonalized)[i*3+j]);}}}}return1;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intverify_eigenpairs(constpseudo_t3d*A,constpseudo_t3d*R,constpseudo_v3d*Lambda){printf(\"Verifying A * v = \u03bb * v for each eigenpair:\\n\");for(inti=0;i<3;i++){pseudo_v3d Av={0},lambda_v={0};// Compute A * vfor(intj=0;j<3;j++){((double*)&Av)[j]=((double*)A)[j*3]*((double*)R)[i]+((double*)A)[j*3+1]*((double*)R)[i+3]+((double*)A)[j*3+2]*((double*)R)[i+6];}// Compute \u03bb * vfor(intj=0;j<3;j++){((double*)&lambda_v)[j]=((double*)Lambda)[i]*((double*)R)[i+j*3];}printf(\"Eigenpair%d:\\n\",i+1);printf(\"A * v =%8.4Lf%8.4Lf%8.4Lf\\n\",Av.x,Av.y,Av.z);printf(\"\u03bb * v =%8.4Lf%8.4Lf%8.4Lf\\n\",lambda_v.x,lambda_v.y,lambda_v.z);// Check if A * v \u2248 \u03bb * vfor(intj=0;j<3;j++){if(fabs(((double*)&Av)[j]-((double*)&lambda_v)[j])>EPSILON){printf(\"Mismatch for eigenpair%d, component%d\\n\",i+1,j+1);}}printf(\"Verification A * v = \u03bb * v for each eigenpair done. \"\"See the messages above!\\n\\n\");}return1;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intverify_eigendecomposition(constpseudo_t3d*A,constpseudo_t3d*R,constpseudo_v3d*Lambda){if(!verify_orthonormality(R)){printf(\"Eigenvectors are not orthonormal.\\n\");}else{printf(\"Eigenvectors are orthonormal.\\n\");}printf(\"\\n\");if(!verify_diagonalization(A,R,Lambda)){printf(\"Matrix is not properly diagonalized.\\n\");}else{printf(\"Matrix is properly diagonalized.\\n\");}if(!verify_eigenpairs(A,R,Lambda)){printf(\"Eigenpair verification failed.\\n\");}else{printf(\"Eigenpair verification passed.\\n\");}printf(\"Eigendecomposition verification completed.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: See the messages...",
    "content": "See the messages above!\\n\");return1;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "intverify_reconstruction(constpseudo_t3d*A,constpseudo_t3d*R,constpseudo_v3d*Lambda){pseudo_t3d Lambda_diag,temp,A_reconstructed;// Create diagonal matrix from Lambdafor(inti=0;i<3;i++){for(intj=0;j<3;j++){((longdouble*)&Lambda_diag)[i*3+j]=(i==j)?((longdouble*)Lambda)[i]:0.0L;}}// Compute R * Lambdafor(inti=0;i<3;i++){for(intj=0;j<3;j++){((longdouble*)&temp)[i*3+j]=0;for(intk=0;k<3;k++){((longdouble*)&temp)[i*3+j]+=((longdouble*)R)[i*3+k]*((longdouble*)&Lambda_diag)[k*3+j];}}}// Compute (R * Lambda) * R^Tfor(inti=0;i<3;i++){for(intj=0;j<3;j++){((longdouble*)&A_reconstructed)[i*3+j]=0;for(intk=0;k<3;k++){((longdouble*)&A_reconstructed)[i*3+j]+=((longdouble*)&temp)[i*3+k]*((longdouble*)R)[j*3+k];}}}print_pseudo_t3d(\"Reconstructed A = R * Lambda * R^T\",&A_reconstructed);// Compare original A with reconstructed Afor(inti=0;i<3;i++){for(intj=0;j<3;j++){longdoublediff=fabsl(((longdouble*)A)[i*3+j]-((longdouble*)&A_reconstructed)[i*3+j]);if(diff>EPSILON){printf(\"Mismatch at (%d,%d): original =%Lf, reconstructed =%Lf, \"\"difference =%Lf\\n\",i,j,((longdouble*)A)[i*3+j],((longdouble*)&A_reconstructed)[i*3+j],diff);}}}printf(\"A = R * Lambda * R^T verification completed.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intmain(intargc,char*argv[]){pseudo_t3d A,R;pseudo_v3d Lambda;// Initialize A with the given values",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A.x.x = 1;  A.x.y = 0; A.x.z = 0;\nA.y.x = 0; A.y.y = 2;  A.y.z = 0;\nA.z.x = 0;  A.z.y = 0;  A.z.z = 3;",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A.x.x = 1;  A.x.y = 0; A.x.z = 0;\nA.y.x = 0; A.y.y = 1;  A.y.z = 0;\nA.z.x = 0;  A.z.y = 0;  A.z.z = 1;",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A.x.x = 1;  A.x.y = 2; A.x.z = 3;\nA.y.x = 2; A.y.y = 4;  A.y.z = 5;\nA.z.x = 3;  A.z.y = 5;  A.z.z = -6;",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A.x.x = 1e-6;  A.x.y = 0; A.x.z = 0;\nA.y.x = 0; A.y.y = 1e-12;  A.y.z = 0;\nA.z.x = 0;  A.z.y = 0;  A.z.z = 1e-10;",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A.x.x = 100;  A.x.y = 100; A.x.z = 10;\nA.y.x = 100; A.y.y = 10;  A.y.z = 1;\nA.z.x = 10;  A.z.y = 1;  A.z.z = 0.1;",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/testEigenDecomposition.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "if(argc!=7){A.x.x=1;A.x.y=2;A.x.z=3;A.y.x=2;A.y.y=4;A.y.z=5;A.z.x=3;A.z.y=5;A.z.z=-6;}else{// Get matrix elements from command line argumentsA.x.x=atof(argv[1]);A.x.y=atof(argv[2]);A.x.z=atof(argv[3]);A.y.x=atof(argv[2]);A.y.y=atof(argv[4]);A.y.z=atof(argv[5]);A.z.x=atof(argv[3]);A.z.y=atof(argv[5]);A.z.z=atof(argv[6]);}print_pseudo_t3d(\"Original matrix A\",&A);diagonalization_3D(&Lambda,&R,&A);print_pseudo_t3d(\"Eigenvectors R\",&R);print_pseudo_v3d(\"Eigenvalues Lambda\",&Lambda);verify_eigendecomposition(&A,&R,&Lambda);// Verify that A = R * Lambda * R^Tverify_reconstruction(&A,&R,&Lambda);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/testEigenDecomposition.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/verifyWtihPlots.ipynb | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework",
    "content": "simulationCases/verifyWtihPlots.ipynb See raw file verifyWtihPlots.ipynb Jupyter Notebook: verifyWtihPlots.ipynb Download Notebook View in nbviewer Open in Colab About this notebook This notebook provides visualization and analysis related to verifyWtihPlots. Key Features: Visualization of data and results Analysis of simulation outputs Interactive exploration of parameters Tip: For the best interactive experience, download the notebook or open it in Google Colab. Notebook Preview Notebook Preview Unavailable The notebook preview could not be loaded. This may be because: The notebook file is not yet available in the repository The nbviewer service is temporarily unavailable The repository is private or has access restrictions You can still download the notebook using the button above or view it directly through one of the external services.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/verifyWtihPlots.ipynb.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "simulationCases/pinchOff.c See raw file Viscoelastic Liquid Jet Pinch-Off Simulation This file implements an axisymmetric simulation of the pinch-off dynamics of a viscoelastic liquid jet. The simulation uses a two-phase approach with log-conformation formulation for the viscoelastic stress tensor.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The model incorporates:...",
    "content": "The model incorporates: - Axisymmetric Navier-Stokes equations - Log-conformation viscoelastic constitutive model - Two-phase interface with surface tension - Adaptive mesh refinement based on interface curvature and velocity gradients File Information File: pinchOff.c Version: 0.2 Author: Vatsal Sanjay Date: Oct 18, 2024 #include \"axi.h\" // #include \"grid/octree.h\" // #include \"grid/quadtree.h\" #include \"navier-stokes/centered.h\" #define VANILLA 1 26 #if VANILLA #include \"../src-local/log-conform-viscoelastic.h\" #define logFile \"logAxi-vanilla.dat\" 29 #else #if AXI #include \"../src-local/log-conform-viscoelastic-scalar-2D.h\" #define logFile \"logAxi-scalar.dat\" 33 #else #include \"../src-local/log-conform-viscoelastic-scalar-3D.h\" #define logFile \"log3D-scalar.dat\" 36 #endif #endif #define FILTERED // Smear density and viscosity jumps #include \"../src-local/two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" ## Simulation Parameters Configuration of time steps, error tolerances, and physical parameters.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Time between snapshots...",
    "content": "Time between snapshots #define tsnap ( 1e-2 ) 53 54 ### Error Tolerances fErr: Error tolerance in volume fraction field (f1 VOF) KErr: Error tolerance in interface curvature calculation using height function VelErr: Error tolerances in velocity field Use 1e-2 for low Oh (Ohnesorge number) cases Use 1e-3 to 5e-3 for high Oh/moderate to high J cases #define fErr ( 1e-3 ) 64 #define KErr ( 1e-6 ) 65 #define VelErr ( 1e-2 ) 66 67 ### Geometry Parameters Parameters defining the initial geometry of the liquid jet #define epsilon ( 0.5 ) 73 #define R2 ( x , y , z , e ) ( sqrt ( sq ( y ) + sq ( z )) + ( e * sin ( x / 4. ))) 74 75 ## Boundary Conditions Neumann boundary condition for velocity and Dirichlet for pressure at the top u . n [ top ] = neumann ( 0.0 ); p [ top ] = dirichlet ( 0.0 ); ## Global Variables MAXlevel: Maximum level of mesh refinement Oh: Ohnesorge number for the liquid phase (solvent) Oha: Ohnesorge number for the gas phase (air) De: Deborah number - ratio of relaxation time to flow time Ec: Elasto-capillary number - ratio of elastic to capillary forces int MAXlevel ; double Oh , Oha , De , Ec , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; ## Main Function Initializes the simulation parameters and starts the simulation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Sets domain size...",
    "content": "Sets domain size Configures physical parameters (Oh, De, Ec) Initializes grid Sets up file storage Configures material properties ### Parameters - argc: Command line argument count - argv: Command line argument values ### Returns - Exit status code int main ( int argc , char const * argv []) { L0 = 2 * pi ; // Values taken from the terminal MAXlevel = 6 ; tmax = 10 ; Oh = 1e-2 ; Oha = 1e-2 * Oh ; De = 1.0 ; // 1e-1; Ec = 1.0 ; // 1e-2; init_grid ( 1 << 4 ); // Create a folder named intermediate where all the simulation snapshots are stored char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file. See writingFiles event sprintf ( dumpFile , \"restart\" ); // Set material properties rho1 = 1. , rho2 = 1e-3 ; mu1 = Oh , mu2 = Oha ; lambda1 = De , lambda2 = 0. ; G1 = Ec , G2 = 0. ; f . sigma = 1.0 ; run (); } ## Initialization Event Sets up the initial condition for the simulation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "Attempts to restore from a restart file if available Otherwise initializes the interface using the geometric function Refines the mesh around the interface ### Parameters - t: Simulation time (starts at 0) event init ( t = 0 ) { if (! restore ( file = dumpFile )) { refine ( R2 ( x , y , z , epsilon ) < ( 1 + epsilon ) && R2 ( x , y , z , epsilon ) > ( 1 - epsilon ) && level < MAXlevel ); fraction ( f , ( 1 - R2 ( x , y , z , epsilon ))); } } ## Adaptive Mesh Refinement Dynamically adjusts the mesh resolution based on interface curvature and flow features. Calculates interface curvature Refines mesh based on error criteria for volume fraction, velocity, and curvature fields ### Parameters - i: Iteration number event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , u . x , u . y , KAPPA }, ( double []){ fErr , VelErr , VelErr , KErr }, MAXlevel , 4 ); } ## Snapshot Generation Saves the state of the simulation at regular intervals.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Creates a restart...",
    "content": "Creates a restart file for potential simulation recovery Generates a snapshot file with timestamped name ### Parameters - t: Simulation time (starts at 0, incremented by tsnap until tmax) event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } ## Simulation Termination Outputs final information when the simulation ends. Prints the maximum refinement level and Ohnesorge number ### Parameters - t: Simulation time (at end) event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d , Oh %2.1e\\n \" , MAXlevel , Oh ); } ## Data Logging Records simulation statistics at each iteration.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Calculates total kinetic...",
    "content": "Calculates total kinetic energy Identifies the minimum position of the interface along the y-axis Writes data to the log file Checks for simulation stability based on kinetic energy ### Parameters - i: Iteration number ### Notes - Terminates the simulation if kinetic energy is too high (blow-up) or too low - Creates a final restart file if the simulation is terminated early event logWriting ( i ++) { // Calculate kinetic energy double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 2 * pi * y )*( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])+ sq ( u . z [])))* sq ( Delta ); } static FILE * fp ; if ( pid () == 0 ) { const char * mode = ( i == 0 ) ? \"w\" : \"a\" ; fp = fopen ( logFile , mode ); if ( fp == NULL ) { fprintf ( ferr , \"Error opening log file \\n \" ); return 1 ; } // Find minimum position of interface along y-axis scalar pos []; position ( f , pos , { 0 , 1 , 0 }); double ymin = statsf ( pos ). min ; // Write header for first iteration if ( i == 0 ) { fprintf ( ferr , \"Level %d , Oh %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , Oha , De , Ec ); fprintf ( ferr , \"i dt t ke ymin \\n \" ); fprintf ( fp , \"Level %d , Oh %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Oh , Oha , De , Ec ); fprintf ( fp , \"i dt t ke ymin \\n \" ); } // Write data row fprintf ( fp , \" %d %g %g %g %g\\n \" , i , dt , t , ke , ymin ); fprintf ( ferr , \" %d %g %g %g %g\\n \" , i , dt , t , ke , ymin ); fflush ( fp ); fclose ( fp ); } // Check for negative kinetic energy (should never happen) assert ( ke > - 1e-10 ); // Check for simulation stability after a few iterations if ( i > 1e1 && pid () == 0 ) { if ( ke > 1e2 || ke < 1e-8 ) { const char * message = ( ke > 1e2 ) ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" : \"kinetic energy too small now! Stopping! \\n \" ; fprintf ( ferr , \" %s \" , message ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %s \" , message ); fflush ( fp ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } }",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code: C/C++ Code",
    "content": "#include\"axi.h\"// #include \"grid/octree.h\"// #include \"grid/quadtree.h\"#include\"navier-stokes/centered.h\"#define VANILLA126#if VANILLA#include\"../src-local/log-conform-viscoelastic.h\"#define logFile\"logAxi-vanilla.dat\"29#else#if AXI#include\"../src-local/log-conform-viscoelastic-scalar-2D.h\"#define logFile\"logAxi-scalar.dat\"33#else#include\"../src-local/log-conform-viscoelastic-scalar-3D.h\"#define logFile\"log3D-scalar.dat\"36#endif#endif#define FILTERED// Smear density and viscosity jumps#include\"../src-local/two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#define fErr(1e-3)64#define KErr(1e-6)65#define VelErr(1e-2)6667",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#define epsilon(0.5)73#define R2(x,y,z,e)(sqrt(sq(y)+sq(z))+(e*sin(x/4.)))7475",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intMAXlevel;doubleOh,Oha,De,Ec,tmax;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "intmain(intargc,charconst*argv[]){L0=2*pi;// Values taken from the terminalMAXlevel=6;tmax=10;Oh=1e-2;Oha=1e-2*Oh;De=1.0;// 1e-1;Ec=1.0;// 1e-2;init_grid(1<<4);// Create a folder named intermediate where all the simulation snapshots are storedcharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file. See writingFiles eventsprintf(dumpFile,\"restart\");// Set material propertiesrho1=1.,rho2=1e-3;mu1=Oh,mu2=Oha;lambda1=De,lambda2=0.;G1=Ec,G2=0.;f.sigma=1.0;run();}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event init(t=0){if(!restore(file=dumpFile)){refine(R2(x,y,z,epsilon)<(1+epsilon)&&R2(x,y,z,epsilon)>(1-epsilon)&&level<MAXlevel);fraction(f,(1-R2(x,y,z,epsilon)));}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,u.x,u.y,KAPPA},(double[]){fErr,VelErr,VelErr,KErr},MAXlevel,4);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level%d, Oh%2.1e\\n\",MAXlevel,Oh);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: event logWriting(i++){// Calculate...",
    "content": "event logWriting(i++){// Calculate kinetic energydoubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])+sq(u.z[])))*sq(Delta);}staticFILE*fp;if(pid()==0){constchar*mode=(i==0)?\"w\":\"a\";fp=fopen(logFile,mode);if(fp==NULL){fprintf(ferr,\"Error opening log file\\n\");return1;}// Find minimum position of interface along y-axisscalar pos[];position(f,pos,{0,1,0});doubleymin=statsf(pos).min;// Write header for first iterationif(i==0){fprintf(ferr,\"Level%d, Oh%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,Oha,De,Ec);fprintf(ferr,\"i dt t ke ymin\\n\");fprintf(fp,\"Level%d, Oh%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Oh,Oha,De,Ec);fprintf(fp,\"i dt t ke ymin\\n\");}// Write data rowfprintf(fp,\"%d%g%g%g%g\\n\",i,dt,t,ke,ymin);fprintf(ferr,\"%d%g%g%g%g\\n\",i,dt,t,ke,ymin);fflush(fp);fclose(fp);}// Check for negative kinetic energy (should never happen)assert(ke>-1e-10);// Check for simulation stability after a few iterationsif(i>1e1&&pid()==0){if(ke>1e2||ke<1e-8){constchar*message=(ke>1e2)?\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/pinchOff.c | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Stopping simulation\\n\":\"kinetic energy...",
    "content": "Stopping simulation\\n\":\"kinetic energy too small now! Stopping!\\n\";fprintf(ferr,\"%s\",message);fp=fopen(\"log\",\"a\");fprintf(fp,\"%s\",message);fflush(fp);fclose(fp);dump(file=dumpFile);return1;}}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/simulationCases/pinchOff.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "src-local/eigen_decomposition.h See raw file Matrix Eigenvalue Solver This module provides algorithms for computing eigenvalues and eigenvectors of 3x3 symmetric matrices, which are commonly encountered in computational fluid dynamics, solid mechanics, and other physics-based simulations. Mathematical Background The implementation uses the Householder transformation to reduce a symmetric matrix to tridiagonal form, followed by the QL algorithm with implicit shifts to compute the eigenvalues and eigenvectors. For a 3x3 symmetric matrix, these methods are particularly efficient and numerically stable, providing accurate results even for matrices with closely spaced eigenvalues. Tridiagonalize a 3x3 Symmetric Matrix Reduces a 3x3 symmetric matrix to tridiagonal form using the Householder method, which applies a series of orthogonal transformations to eliminate elements below the subdiagonal.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Parameters: matrix[in]: Input 3x3 symmetric matrix to be tridiagonalized eigenvectors[out]: Orthogonal matrix of Householder vectors diagonal[out]: Diagonal elements of the resulting tridiagonal matrix subdiagonal[out]: Subdiagonal elements of the tridiagonal matrix Implementation Notes: The original matrix is preserved The eigenvectors matrix is initialized to identity and then transformed The algorithm exploits the symmetry of the input matrix #define SQUARE ( x ) (( x )*( x )) 36 static void tridiagonalize_symmetric_3x3 ( double matrix [ 3 ][ 3 ], double eigenvectors [ 3 ][ 3 ], double diagonal [ 3 ], double subdiagonal [ 2 ]) { const int size = 3 ; double householder_vector [ size ], temp_vector [ size ]; double omega , scale , sigma , tau ; // Initialize eigenvectors to the identity matrix for ( int i = 0 ; i < size ; i ++) { eigenvectors [ i ][ i ] = 1.0 ; for ( int j = 0 ; j < i ; j ++) eigenvectors [ i ][ j ] = eigenvectors [ j ][ i ] = 0.0 ; } // Compute the first Householder reflection scale = SQUARE ( matrix [ 0 ][ 1 ]) + SQUARE ( matrix [ 0 ][ 2 ]); sigma = ( matrix [ 0 ][ 1 ] > 0 ) ? - sqrt ( scale ) : sqrt ( scale ); subdiagonal [ 0 ] = sigma ; tau = sigma * matrix [ 0 ][ 1 ]; householder_vector [ 1 ] = matrix [ 0 ][ 1 ] - sigma ; householder_vector [ 2 ] = matrix [ 0 ][ 2 ]; omega = scale - tau ; if ( omega > 0.0 ) { omega = 1.0 / omega ; sigma = 0.0 ; for ( int i = 1 ; i < size ; i ++) { tau = matrix [ 1 ][ i ] * householder_vector [ 1 ] + matrix [ i ][ 2 ] * householder_vector [ 2 ]; temp_vector [ i ] = omega * tau ; sigma += householder_vector [ i ] * tau ; } sigma *= 0.5 * SQUARE ( omega ); for ( int i = 1 ; i < size ; i ++) temp_vector [ i ] -= sigma * householder_vector [ i ]; diagonal [ 0 ] = matrix [ 0 ][ 0 ]; diagonal [ 1 ] = matrix [ 1 ][ 1 ] - 2.0 * temp_vector [ 1 ] * householder_vector [ 1 ]; diagonal [ 2 ] = matrix [ 2 ][ 2 ] - 2.0 * temp_vector [ 2 ] * householder_vector [ 2 ]; for ( int j = 1 ; j < size ; j ++) { tau = omega * householder_vector [ j ]; for ( int i = 1 ; i < size ; i ++) eigenvectors [ i ][ j ] -= tau * householder_vector [ i ]; } subdiagonal [ 1 ] = matrix [ 1 ][ 2 ] - temp_vector [ 1 ] * householder_vector [ 2 ] - householder_vector [ 1 ] * temp_vector [ 2 ]; } else { for ( int i = 0 ; i < size ; i ++) diagonal [ i ] = matrix [ i ][ i ]; subdiagonal [ 1 ] = matrix [ 1 ][ 2 ]; } } ### Compute Eigenvalues and Eigenvectors of a 3x3 Symmetric Matrix Calculates the complete eigensystem (eigenvalues and eigenvectors) of a 3x3 symmetric matrix using the QL algorithm with implicit shifts, after first reducing the matrix to tridiagonal form.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Parameters: matrix[in]: Input...",
    "content": "Parameters: matrix[in]: Input 3x3 symmetric matrix whose eigensystem will be computed eigenvectors[out]: Matrix whose columns are the eigenvectors eigenvalues[out]: Array containing the eigenvalues Return Value: 0: Computation successful -1: Algorithm failed to converge within the maximum number of iterations Algorithm Details: First checks if the matrix is already diagonal If not, tridiagonalizes the matrix using Householder transformations Applies the QL algorithm with implicit shifts to compute eigenvalues Maximum of 30 iterations are allowed for convergence Numerical tolerance of 1e-15 is used for detecting diagonal matrices Usage Example: double matrix [ 3 ][ 3 ] = {{ 1.0 , 0.5 , 0.3 }, { 0.5 , 2.0 , 0.1 }, { 0.3 , 0.1 , 3.0 }}; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; int result = compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); if ( result == 0 ) { // Computation successful } static int compute_eigensystem_symmetric_3x3 ( double matrix [ 3 ][ 3 ], double eigenvectors [ 3 ][ 3 ], double eigenvalues [ 3 ]) { const int size = 3 ; const int max_iterations = 30 ; double subdiagonal [ 3 ]; double g , r , p , f , b , s , c , t ; int iteration_count ; int m ; // Check for diagonal matrix with unit entries if ( SQUARE ( matrix [ 0 ][ 1 ]) < 1e-15 && SQUARE ( matrix [ 0 ][ 2 ]) < 1e-15 && SQUARE ( matrix [ 1 ][ 2 ]) < 1e-15 ) { for ( int i = 0 ; i < size ; i ++) { for ( int j = 0 ; j < size ; j ++) { eigenvectors [ i ][ j ] = ( i == j ) ? 1.0 : 0.0 ; } eigenvalues [ i ] = matrix [ i ][ i ]; } return 0 ; } tridiagonalize_symmetric_3x3 ( matrix , eigenvectors , eigenvalues , subdiagonal ); for ( int l = 0 ; l < size - 1 ; l ++) { iteration_count = 0 ; while ( 1 ) { for ( m = l ; m <= size - 2 ; m ++) { g = fabs ( eigenvalues [ m ]) + fabs ( eigenvalues [ m + 1 ]); if ( fabs ( subdiagonal [ m ]) + g == g ) break ; } if ( m == l ) break ; if ( iteration_count ++ >= max_iterations ) return - 1 ; g = ( eigenvalues [ l + 1 ] - eigenvalues [ l ]) / ( 2.0 * subdiagonal [ l ]); r = sqrt ( SQUARE ( g ) + 1.0 ); g = eigenvalues [ m ] - eigenvalues [ l ] + subdiagonal [ l ] / ( g + ( g > 0 ? fabs ( r ) : - fabs ( r ))); s = c = 1.0 ; p = 0.0 ; for ( int i = m - 1 ; i >= l ; i --) { f = s * subdiagonal [ i ]; b = c * subdiagonal [ i ]; if ( fabs ( f ) > fabs ( g )) { c = g / f ; r = sqrt ( SQUARE ( c ) + 1.0 ); subdiagonal [ i + 1 ] = f * r ; c *= ( s = 1.0 / r ); } else { s = f / g ; r = sqrt ( SQUARE ( s ) + 1.0 ); subdiagonal [ i + 1 ] = g * r ; s *= ( c = 1.0 / r ); } g = eigenvalues [ i + 1 ] - p ; r = ( eigenvalues [ i ] - g ) * s + 2.0 * c * b ; p = s * r ; eigenvalues [ i + 1 ] = g + p ; g = c * r - b ; for ( int k = 0 ; k < size ; k ++) { t = eigenvectors [ k ][ i + 1 ]; eigenvectors [ k ][ i + 1 ] = s * eigenvectors [ k ][ i ] + c * t ; eigenvectors [ k ][ i ] = c * eigenvectors [ k ][ i ] - s * t ; } } eigenvalues [ l ] -= p ; subdiagonal [ l ] = g ; subdiagonal [ m ] = 0.0 ; } } return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "#define SQUARE(x)((x)*(x))36staticvoidtridiagonalize_symmetric_3x3(doublematrix[3][3],doubleeigenvectors[3][3],doublediagonal[3],doublesubdiagonal[2]){constintsize=3;doublehouseholder_vector[size],temp_vector[size];doubleomega,scale,sigma,tau;// Initialize eigenvectors to the identity matrixfor(inti=0;i<size;i++){eigenvectors[i][i]=1.0;for(intj=0;j<i;j++)eigenvectors[i][j]=eigenvectors[j][i]=0.0;}// Compute the first Householder reflectionscale=SQUARE(matrix[0][1])+SQUARE(matrix[0][2]);sigma=(matrix[0][1]>0)?-sqrt(scale):sqrt(scale);subdiagonal[0]=sigma;tau=sigma*matrix[0][1];householder_vector[1]=matrix[0][1]-sigma;householder_vector[2]=matrix[0][2];omega=scale-tau;if(omega>0.0){omega=1.0/omega;sigma=0.0;for(inti=1;i<size;i++){tau=matrix[1][i]*householder_vector[1]+matrix[i][2]*householder_vector[2];temp_vector[i]=omega*tau;sigma+=householder_vector[i]*tau;}sigma*=0.5*SQUARE(omega);for(inti=1;i<size;i++)temp_vector[i]-=sigma*householder_vector[i];diagonal[0]=matrix[0][0];diagonal[1]=matrix[1][1]-2.0*temp_vector[1]*householder_vector[1];diagonal[2]=matrix[2][2]-2.0*temp_vector[2]*householder_vector[2];for(intj=1;j<size;j++){tau=omega*householder_vector[j];for(inti=1;i<size;i++)eigenvectors[i][j]-=tau*householder_vector[i];}subdiagonal[1]=matrix[1][2]-temp_vector[1]*householder_vector[2]-householder_vector[1]*temp_vector[2];}else{for(inti=0;i<size;i++)diagonal[i]=matrix[i][i];subdiagonal[1]=matrix[1][2];}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doublematrix[3][3]={{1.0,0.5,0.3},{0.5,2.0,0.1},{0.3,0.1,3.0}};doubleeigenvectors[3][3];doubleeigenvalues[3];intresult=compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);if(result==0){// Computation successful}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "staticintcompute_eigensystem_symmetric_3x3(doublematrix[3][3],doubleeigenvectors[3][3],doubleeigenvalues[3]){constintsize=3;constintmax_iterations=30;doublesubdiagonal[3];doubleg,r,p,f,b,s,c,t;intiteration_count;intm;// Check for diagonal matrix with unit entriesif(SQUARE(matrix[0][1])<1e-15&&SQUARE(matrix[0][2])<1e-15&&SQUARE(matrix[1][2])<1e-15){for(inti=0;i<size;i++){for(intj=0;j<size;j++){eigenvectors[i][j]=(i==j)?1.0:0.0;}eigenvalues[i]=matrix[i][i];}return0;}tridiagonalize_symmetric_3x3(matrix,eigenvectors,eigenvalues,subdiagonal);for(intl=0;l<size-1;l++){iteration_count=0;while(1){for(m=l;m<=size-2;m++){g=fabs(eigenvalues[m])+fabs(eigenvalues[m+1]);if(fabs(subdiagonal[m])+g==g)break;}if(m==l)break;if(iteration_count++>=max_iterations)return-1;g=(eigenvalues[l+1]-eigenvalues[l])/(2.0*subdiagonal[l]);r=sqrt(SQUARE(g)+1.0);g=eigenvalues[m]-eigenvalues[l]+subdiagonal[l]/(g+(g>0?fabs(r):-fabs(r)));s=c=1.0;p=0.0;for(inti=m-1;i>=l;i--){f=s*subdiagonal[i];b=c*subdiagonal[i];if(fabs(f)>fabs(g)){c=g/f;r=sqrt(SQUARE(c)+1.0);subdiagonal[i+1]=f*r;c*=(s=1.0/r);}else{s=f/g;r=sqrt(SQUARE(s)+1.0);subdiagonal[i+1]=g*r;s*=(c=1.0/r);}g=eigenvalues[i+1]-p;r=(eigenvalues[i]-g)*s+2.0*c*b;p=s*r;eigenvalues[i+1]=g+p;g=c*r-b;for(intk=0;k<size;k++){t=eigenvectors[k][i+1];eigenvectors[k][i+1]=s*eigenvectors[k][i]+c*t;eigenvectors[k][i]=c*eigenvectors[k][i]-s*t;}}eigenvalues[l]-=p;subdiagonal[l]=g;subdiagonal[m]=0.0;}}return0;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Methods",
    "content": "src-local/log-conform-viscoelastic.h See raw file Log-Conformation Method with Tensor Implementation Overview Title : log-conform-viscoelastic.h Version : 10.5 Description : Tensor-based implementation of the log-conformation method for viscoelastic fluids Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Uses native tensor data structures for better code organization Supports both 2D and axisymmetric configurations Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Nov 23, 2024 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Important Limitations 3D Compatibility Currently limited to 2D and axisymmetric cases only 3D support is blocked by Basilisk core limitations: Boundary conditions for symmetric tensors are not implemented in Basilisk core See basilisk/src/grid/cartesian-common.h lines 230-251 Comment in source: \u201cfixme: boundary conditions don\u2019t work!\u201d Alternative for 3D For 3D simulations, use log-conform-viscoelastic-scalar-3D.h Scalar version uses individual components instead of tensors Provides full 3D functionality without boundary condition limitations Technical Notes Variable Naming conform_p , conform_qq : Represent the Conformation tensor Tensor implementation provides more natural mathematical representation Axisymmetric components handled separately when needed Mathematical Framework The implementation follows the standard log-conformation approach: 1.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Uses tensor mathematics...",
    "content": "Uses tensor mathematics for clean formulation 2. Handles both planar and axisymmetric geometries 3. Provides natural extension to various constitutive models Note: In this code, conform_p, conform_qq are in fact the Conformation tensor. The log-conformation method for viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: In the case...",
    "content": "In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models. Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This instability poses...",
    "content": "This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . TODO: - Perhaps, instead of the Bell\u2013Collela\u2013Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to http://basilisk.fr/src/navier-stokes/conserving.h #include \"bcg.h\" #if dimension == #error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: JavaScript",
    "content": "Use log-conform-viscoelastic-scalar-3D.h for 3D simulations.\" #endif ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time symmetric tensor conform_p [], tau_p []; #if AXI scalar conform_qq [], tau_qq []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; foreach () { foreach_dimension (){ tau_p . x . x [] = 0. ; conform_p . x . x [] = 1. ; } tau_p . x . y [] = 0. ; conform_p . x . y [] = 0. ; #if AXI tau_qq [] = 0 ; conform_qq [] = 1. ; #endif } for ( scalar s in { tau_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } for ( scalar s in { conform_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } #if AXI scalar s1 = tau_p . x . y ; s1 [ bottom ] = dirichlet ( 0. ); #endif #if AXI scalar s2 = conform_p . x . y ; s2 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ). In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { tensor Psi = conform_p ; #if AXI scalar Psiqq = conform_qq ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . y = conform_p . x . y []; foreach_dimension () A . x . x = conform_p . x . x []; In the axisymmetric case, \\(\\Psi_{\\theta \\theta} = \\log A_{\\theta \\theta}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Therefore \\(\\Psi_{\\theta \\theta}...",
    "content": "Therefore \\(\\Psi_{\\theta \\theta} = \\log [ ( 1 + \\text{fa} \\tau_{p_{\\theta \\theta}})]\\) . #if AXI double Aqq = conform_qq []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; pseudo_t R ; diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g , Lambda.y = %g\\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g , y = %g\\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "Psi . x . y [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); foreach_dimension () Psi . x . x [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) . The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Transform omega back...",
    "content": "Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: - R is the eigenvector matrix of the conformation tensor - M is the velocity gradient tensor in the eigenvector basis - The construction ensures B is symmetric and traceless pseudo_t B ; double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi . x . y []; Psi . x . y [] += dt *( 2. * B . x . y + OM *( Psi . y . y [] - Psi . x . x [])); foreach_dimension () { s *= - 1 ; Psi . x . x [] += dt * 2. *( B . x . x + s * OM ); } In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi . x . x , Psi . x . y , Psi . y . y , Psiqq }, uf , dt ); #else advection ({ Psi . x . x , Psi . x . y , Psi . y . y }, uf , dt ); #endif Convert back to _p foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi . x . x [], Psi . x . y []}, { Psi . y . x [], Psi . y . y []}}, R ; pseudo_v Lambda ; diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . conform_p . x . y [] = A . x . y ; tau_p . x . y [] = Gp []* A . x . y ; #if AXI conform_qq [] = Aqq ; tau_qq [] = Gp []*( Aqq - 1. ); #endif foreach_dimension (){ conform_p . x . x [] = A . x . x ; tau_p . x . x [] = Gp []*( A . x . x - 1. ); } } } Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Examples",
    "content": "For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face () if ( fm . x [] > 1e-20 ) { double shear = ( tau_p . x . y [ 0 , 1 ]* cm [ 0 , 1 ] + tau_p . x . y [- 1 , 1 ]* cm [- 1 , 1 ] - tau_p . x . y [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - tau_p . x . y [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shear + cm []* tau_p . x . x [] - cm [- 1 ]* tau_p . x . x [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } #if AXI foreach_face ( y ) if ( y > 0. ) av . y [] -= ( tau_qq [] + tau_qq [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code: C/C++ Code",
    "content": "#include\"bcg.h\"#if dimension ==#error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code: Context",
    "content": "Use log-conform-viscoelastic-scalar-3D.h for 3D simulations.\"#endif(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation timesymmetric tensor conform_p[],tau_p[];#if AXIscalar conform_qq[],tau_qq[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;foreach(){foreach_dimension(){tau_p.x.x[]=0.;conform_p.x.x[]=1.;}tau_p.x.y[]=0.;conform_p.x.y[]=0.;#if AXItau_qq[]=0;conform_qq[]=1.;#endif}for(scalar s in{tau_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}for(scalar s in{conform_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}#if AXIscalar s1=tau_p.x.y;s1[bottom]=dirichlet(0.);#endif#if AXIscalar s2=conform_p.x.y;s2[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event tracer_advection(i++){tensor Psi=conform_p;#if AXIscalar Psiqq=conform_qq;#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_t A;A.x.y=conform_p.x.y[];foreach_dimension()A.x.x=conform_p.x.x[];",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#if AXIdoubleAqq=conform_qq[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_v Lambda;pseudo_t R;diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x =%g, Lambda.y =%g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x =%g, y =%g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "Psi.x.y[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);foreach_dimension()Psi.x.x[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "pseudo_t B;doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubles=-Psi.x.y[];Psi.x.y[]+=dt*(2.*B.x.y+OM*(Psi.y.y[]-Psi.x.x[]));foreach_dimension(){s*=-1;Psi.x.x[]+=dt*2.*(B.x.x+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#if AXIadvection({Psi.x.x,Psi.x.y,Psi.y.y,Psiqq},uf,dt);#elseadvection({Psi.x.x,Psi.x.y,Psi.y.y},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_t A={{Psi.x.x[],Psi.x.y[]},{Psi.y.x[],Psi.y.y[]}},R;pseudo_v Lambda;diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "conform_p.x.y[]=A.x.y;tau_p.x.y[]=Gp[]*A.x.y;#if AXIconform_qq[]=Aqq;tau_qq[]=Gp[]*(Aqq-1.);#endifforeach_dimension(){conform_p.x.x[]=A.x.x;tau_p.x.x[]=Gp[]*(A.x.x-1.);}}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event acceleration(i++){face vector av=a;foreach_face()if(fm.x[]>1e-20){doubleshear=(tau_p.x.y[0,1]*cm[0,1]+tau_p.x.y[-1,1]*cm[-1,1]-tau_p.x.y[0,-1]*cm[0,-1]-tau_p.x.y[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shear+cm[]*tau_p.x.x[]-cm[-1]*tau_p.x.x[-1])*alpha.x[]/(sq(fm.x[])*Delta);}#if AXIforeach_face(y)if(y>0.)av.y[]-=(tau_qq[]+tau_qq[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files eigen_decomposition.h This module provides algorithms for computing eigenvalues and eigenvectors of 3x3 symmetric matrices, which are commo... log-conform-viscoelastic-scalar-2D.h Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materia... log-conform-viscoelastic-scalar-3D.h Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materia... log-conform-viscoelastic.h The implementation follows the standard log-conformation approach: 1. Uses tensor mathematics for clean formulation 2... two-phaseVE.h This is a modified version of [two-phase.h](http://basilisk.fr/src/two-phase.h). It contains the implementation of Vi...",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Methods",
    "content": "src-local/log-conform-viscoelastic-scalar-3D.h See raw file Log-Conformation Method for 3D Viscoelastic Fluids Overview Title : log-conform-viscoelastic-3D.h Version : 2.6 Description : Implementation of the log-conformation method for viscoelastic fluids in 3D Key Features Conformation tensor A exists across the domain and relaxes according to \u03bb Stress acts according to elastic modulus G 3D implementation extending log-conform-viscoelastic-scalar-2D.h Eigenvalue clamping for numerical stability Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Mar 16, 2025 Dependencies bcg.h: Bell-Collela-Glaz scheme for advection eigen_decomposition.h: For 3D eigenvalue computation navier-stokes/centered.h: For base flow solver References Fattal & Kupferman (2004, 2005): Original log-conformation method Comminal et al. (2015): Constitutive model functions Hao & Pan (2007): Split scheme implementation Version History v1.0 (Oct 19, 2024) Initial 3D implementation Scalar implementation approach v1.1 (Oct 20, 2024) Added negative eigenvalue detection Added error reporting system v2.0 (Oct 29, 2024) Major matrix algebra corrections for 3D Optimized tensor calculations Improved code structure and documentation v2.1 (Oct 29, 2024) Added initialization functions for tensor structures v2.2 (Nov 3, 2024) Refactored tensor operations Improved code maintainability Enhanced tensor manipulation consistency v2.3 (Nov 14, 2024) Added infinite Deborah number support v2.5 (Nov 23, 2024) Documentation improvements Added mathematical explanations v2.6 (Mar 16, 2025) Implemented eigenvalue clamping system Added minimum eigenvalue threshold (EIGENVALUE_MIN = 1e-8) Improved numerical stability handling Added diagnostic capabilities Fixed 3D velocity gradient calculation Implementation Notes The code extends the standard Basilisk log-conformation implementation Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling with polymeric stress Includes both 2D and 3D implementations Uses atomic operations for thread-safe diagnostics Future Work Axisymmetric Compatibility Currently not implemented Use log-conform-viscoelastic-scalar-2D.h for axi cases Or use log-conform-viscoelastic.h for better efficiency Metric Terms Improvements Enforce tensor compatibility using foreach_dimension Complete metric terms (cm, fm) implementation #if AXI #error \"axi compatibility is not there.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Introduction",
    "content": "To keep the code easy to read, we will not implement axi compatibility just yet.\" #endif The log-conformation method for some viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: In the case...",
    "content": "In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models. Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This instability poses...",
    "content": "This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . /* TODO : - Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h) */ #define EIGENVALUE_MIN 1e-8 220 #ifdef DEBUG_EIGENVALUES static int eigenvalue_corrections = 0 ; #endif #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time /* conformation tensor */ // diagonal elements scalar A11 [], A22 [], A33 []; // off-diagonal elements scalar A12 [], A13 [], A23 []; /* stress tensor */ // diagonal elements scalar T11 [], T22 [], T33 []; // off-diagonal elements scalar T12 [], T13 [], T23 []; event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 , A33 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T13 , T22 , T23 , T33 , A12 , A13 , A23 }) { foreach (){ s [] = 0. ; } } for ( scalar s in { A11 , A22 , A33 , T11 , T22 , T33 , A12 , A13 , A23 , T12 , T13 , T23 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } if ( s . boundary [ top ] != periodic_bc ) { s [ top ] = neumann ( 0 ); s [ bottom ] = neumann ( 0 ); } #if dimension == if ( s . boundary [ front ] != periodic_bc ) { s [ front ] = neumann ( 0 ); s [ back ] = neumann ( 0 ); } #endif } } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. #if dimension == typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } #endif /* Now this is the 3D implementation. */ #if dimension == #include \"eigen_decomposition.h\" typedef struct { double x , y , z ; } pseudo_v3d ; typedef struct { pseudo_v3d x , y , z ; } pseudo_t3d ; // Function to initialize pseudo_v3d static inline void init_pseudo_v3d ( pseudo_v3d * v , double value ) { v -> x = value ; v -> y = value ; v -> z = value ; } // Function to initialize pseudo_t3d static inline void init_pseudo_t3d ( pseudo_t3d * t , double value ) { init_pseudo_v3d (& t -> x , value ); init_pseudo_v3d (& t -> y , value ); init_pseudo_v3d (& t -> z , value ); } static void diagonalization_3D ( pseudo_v3d * Lambda , pseudo_t3d * R , pseudo_t3d * A ) { // Check if the matrix is already diagonal if ( sq ( A -> x . y ) + sq ( A -> x . z ) + sq ( A -> y . z ) < 1e-15 ) { R -> x . x = R -> y . y = R -> z . z = 1. ; R -> y . x = R -> x . y = R -> z . x = R -> x . z = R -> z . y = R -> y . z = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; Lambda -> z = A -> z . z ; return ; } // Compute eigenvalues using the eigen_decomposition function double matrix [ 3 ][ 3 ] = { { A -> x . x , A -> x . y , A -> x . z }, { A -> y . x , A -> y . y , A -> y . z }, { A -> z . x , A -> z . y , A -> z . z } }; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); // Store eigenvalues and eigenvectors Lambda -> x = eigenvalues [ 0 ]; Lambda -> y = eigenvalues [ 1 ]; Lambda -> z = eigenvalues [ 2 ]; R -> x . x = eigenvectors [ 0 ][ 0 ]; R -> x . y = eigenvectors [ 0 ][ 1 ]; R -> x . z = eigenvectors [ 0 ][ 2 ]; R -> y . x = eigenvectors [ 1 ][ 0 ]; R -> y . y = eigenvectors [ 1 ][ 1 ]; R -> y . z = eigenvectors [ 1 ][ 2 ]; R -> z . x = eigenvectors [ 2 ][ 0 ]; R -> z . y = eigenvectors [ 2 ][ 1 ]; R -> z . z = eigenvectors [ 2 ][ 2 ]; } #endif The stress tensor depends on previous instants and has to be integrated in time.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: In the log-conformation...",
    "content": "In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) . We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ). In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] #if dimension == Advances the log-conformation tensor and updates the corresponding conformation and stress tensors.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Function Definition",
    "content": "This event function performs three primary steps within the viscoelastic fluid simulation: - Diagonalizes the conformation tensor and computes its logarithm (\u03a8) while applying eigenvalue clamping to ensure numerical stability. - Advances \u03a8 in time by incorporating the upper convective term computed from the velocity gradient, which is used to update the log-conformation tensor. - Recovers the physical conformation tensor and stress tensor by exponentiating the diagonalized eigenvalues and integrating the relaxation term.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Note: Although the...",
    "content": "Note: Although the overall simulation targets 3D viscoelastic fluids, this implementation uses a 2D diagonalization routine. event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A = {{ A11 [], A12 []}, { A12 [], A22 []}}; The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at ( %g , %g ): [ %g , %g ] \\n \" , x , y , Lambda . x , Lambda . y ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } #elif dimension == Advances the log-conformation tensor and computes the corresponding conformation and stress tensors for 3D viscoelastic fluid simulations. This event function performs a two-step update for the viscoelastic fluid model using the log-conformation method.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: In the first...",
    "content": "In the first part, it computes the logarithm of the conformation tensor \\(\\Psi\\) from A by: - Diagonalizing A to obtain eigenvalues ( \\(\\Lambda\\) ) and eigenvectors (R). - Clamping any negative eigenvalues to prevent numerical instabilities (using EIGENVALUE_MIN). - Evaluating \\(\\Psi = \\log(A)\\) and incorporating the upper convective contribution via the symmetric tensor B and the skew-symmetric tensor \\(\\Omega\\) . \\(\\Psi\\) is then advanced in time using central difference approximations for the velocity gradients, where degenerate eigenvalue cases are handled with simplified calculations. In the second part, the function converts the updated log-conformation tensor back to the conformation tensor A by exponentiating the eigenvalues and applies the relaxation factor derived from the relaxation time. Finally, it computes the polymeric stress tensor T from A.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Warnings are printed...",
    "content": "Warnings are printed if negative eigenvalues are detected, and a debug counter is incremented when debugging is enabled. event tracer_advection ( i ++) { Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term // start by declaring the scalar variables that will store the components of $\\Psi$ scalar Psi11 = A11 , Psi12 = A12 , Psi13 = A13 , Psi22 = A22 , Psi23 = A23 , Psi33 = A33 ; foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); A . x . x = A11 []; A . x . y = A12 []; A . x . z = A13 []; A . y . x = A12 []; A . y . y = A22 []; A . y . z = A23 []; A . z . x = A13 []; A . z . y = A23 []; A . z . z = A33 []; // Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors R diagonalization_3D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. || Lambda . z <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at ( %g , %g , %g ): [ %g , %g , %g ] \\n \" , x , y , z , Lambda . x , Lambda . y , Lambda . z ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); Lambda . z = max ( Lambda . z , EIGENVALUE_MIN ); } // Compute Psi = log(A) = R * log(Lambda) * R^T Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ) + sq ( R . x . z )* log ( Lambda . z ); Psi22 [] = sq ( R . y . x )* log ( Lambda . x ) + sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . z )* log ( Lambda . z ); Psi33 [] = sq ( R . z . x )* log ( Lambda . x ) + sq ( R . z . y )* log ( Lambda . y ) + sq ( R . z . z )* log ( Lambda . z ); Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . x . y * R . y . y * log ( Lambda . y ) + R . x . z * R . y . z * log ( Lambda . z ); Psi13 [] = R . x . x * R . z . x * log ( Lambda . x ) + R . x . y * R . z . y * log ( Lambda . y ) + R . x . z * R . z . z * log ( Lambda . z ); Psi23 [] = R . y . x * R . z . x * log ( Lambda . x ) + R . y . y * R . z . y * log ( Lambda . y ) + R . y . z * R . z . z * log ( Lambda . z ); // Compute B and Omega tensors (3D version) pseudo_t3d B , M , Omega ; init_pseudo_t3d (& B , 0.0 ); init_pseudo_t3d (& M , 0.0 ); init_pseudo_t3d (& Omega , 0.0 ); // Check if any pair of eigenvalues are numerically equal (within a small tolerance) if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 || fabs ( Lambda . y - Lambda . z ) <= 1e-20 || fabs ( Lambda . z - Lambda . x ) <= 1e-20 ) { // In case of equal eigenvalues, the calculations for B and Omega simplify significantly // B is grad U and Omega is zero. // Compute off-diagonal elements of B using central differences // These represent the symmetric part of the velocity gradient tensor B . x . y = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ] + u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 4. * Delta ); // (dv/dx + du/dy)/2 B . x . z = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ] + u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dx + du/dz)/2 B . y . z = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ] + u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dy + dv/dz)/2 // Compute diagonal elements of B // These represent the normal strain rates B . x . x = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2. * Delta ); // du/dx B . y . y = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2. * Delta ); // dv/dy B . z . z = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2. * Delta ); // dw/dz // Set all components of Omega to zero // This is because Omega represents the antisymmetric part of the velocity gradient tensor, // which vanishes when eigenvalues are equal Omega . x . y = Omega . x . z = Omega . y . z = Omega . y . x = Omega . z . x = Omega . z . y = 0. ; } else { /* ### Compute the velocity gradient tensor components using central differences - These represent the spatial derivatives of each velocity component - These gradients form the velocity gradient tensor (nablaU): [ dudx dudy dudz ] [ dvdx dvdy dvdz ] [ dwdx dwdy dwdz ] */ // Derivatives of u (x-component of velocity) double dudx = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2.0 * Delta ); // du/dx double dudy = ( u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // du/dy double dudz = ( u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // du/dz // Derivatives of v (y-component of velocity) double dvdx = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dv/dx double dvdy = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dv/dy double dvdz = ( u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dv/dz // Derivatives of w (z-component of velocity) double dwdx = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dw/dx double dwdy = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dw/dy double dwdz = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dw/dz /* Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor. * Steps: 1. Compute intermediate products (R * nablaU^T): - Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_* - Each variable represents one row of the intermediate matrix 2.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor: - M.i.j represents the (i,j) component of the transformed velocity gradient - This transformation expresses the velocity gradient in the eigenvector basis - The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that */ // First, compute intermediate products of R and (nablaU)^T double Rx_gradU_x = R . x . x * dudx + R . x . y * dvdx + R . x . z * dwdx ; double Rx_gradU_y = R . x . x * dudy + R . x . y * dvdy + R . x . z * dwdy ; double Rx_gradU_z = R . x . x * dudz + R . x . y * dvdz + R . x . z * dwdz ; double Ry_gradU_x = R . y . x * dudx + R . y . y * dvdx + R . y . z * dwdx ; double Ry_gradU_y = R . y . x * dudy + R . y . y * dvdy + R . y . z * dwdy ; double Ry_gradU_z = R . y . x * dudz + R . y . y * dvdz + R . y . z * dwdz ; double Rz_gradU_x = R . z . x * dudx + R . z . y * dvdx + R . z . z * dwdx ; double Rz_gradU_y = R . z . x * dudy + R . z . y * dvdy + R . z . z * dwdy ; double Rz_gradU_z = R . z . x * dudz + R . z . y * dvdz + R . z . z * dwdz ; // Now compute M components by multiplying the intermediate products with R^T M . x . x = R . x . x * Rx_gradU_x + R . x . y * Rx_gradU_y + R . x . z * Rx_gradU_z ; M . x . y = R . x . x * Ry_gradU_x + R . x . y * Ry_gradU_y + R . x . z * Ry_gradU_z ; M . x . z = R . x . x * Rz_gradU_x + R . x . y * Rz_gradU_y + R . x . z * Rz_gradU_z ; M . y . x = R . y . x * Rx_gradU_x + R . y . y * Rx_gradU_y + R . y . z * Rx_gradU_z ; M . y . y = R . y . x * Ry_gradU_x + R . y . y * Ry_gradU_y + R . y . z * Ry_gradU_z ; M . y . z = R . y . x * Rz_gradU_x + R . y . y * Rz_gradU_y + R . y . z * Rz_gradU_z ; M . z . x = R . z . x * Rx_gradU_x + R . z . y * Rx_gradU_y + R . z . z * Rx_gradU_z ; M . z . y = R . z . x * Ry_gradU_x + R . z . y * Ry_gradU_y + R . z . z * Ry_gradU_z ; M . z . z = R . z . x * Rz_gradU_x + R . z . y * Rz_gradU_y + R . z . z * Rz_gradU_z ; // Compute the off-diagonal elements of the Omega tensor in the eigenvector basis double omega_xy = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); double omega_xz = ( Lambda . z * M . x . z + Lambda . x * M . z . x )/( Lambda . z - Lambda . x ); double omega_yz = ( Lambda . z * M . y . z + Lambda . y * M . z . y )/( Lambda . z - Lambda . y ); // Calculate intermediate rotation combinations for each direction // x-direction rotation combinations double rot_x_xy_yz = ( R . x . x * omega_xy - R . x . z * omega_yz ); // xy rotation minus yz rotation, x components double rot_x_xy_xz = ( R . x . y * omega_xy + R . x . z * omega_xz ); // xy rotation plus xz rotation, x components double rot_x_xz_yz = ( R . x . x * omega_xz + R . x . y * omega_yz ); // xz rotation plus yz rotation, x components // y-direction rotation combinations double rot_y_xy_yz = ( R . y . x * omega_xy - R . y . z * omega_yz ); // xy rotation minus yz rotation, y components double rot_y_xy_xz = ( R . y . y * omega_xy + R . y . z * omega_xz ); // xy rotation plus xz rotation, y components double rot_y_xz_yz = ( R . y . x * omega_xz + R . y . y * omega_yz ); // xz rotation plus yz rotation, y components // z-direction rotation combinations double rot_z_xy_yz = ( R . z . x * omega_xy - R . z . z * omega_yz ); // xy rotation minus yz rotation, z components double rot_z_xy_xz = ( R . z . y * omega_xy + R . z . z * omega_xz ); // xy rotation plus xz rotation, z components double rot_z_xz_yz = ( R . z . x * omega_xz + R . z . y * omega_yz ); // xz rotation plus yz rotation, z components Calculate the components of the Omega tensor in the physical coordinate system The Omega tensor represents the rotational part of the velocity gradient tensor and is computed through the following steps: We already have: R: eigenvector matrix of the conformation tensor rot_*_*_*: pre-computed rotation combinations for each direction Mathematical background: Omega = R * Omega_eigen * R^T where Omega_eigen is the rotation tensor in eigenvector space The components are calculated using the rotation combinations: rot_i_jk_lm represents combined rotations in the i-direction Each component Omega_ij is a linear combination of these rotations // Compute x-row components of Omega Omega . x . x = R . x . y * rot_x_xy_yz // xy-yz rotation contribution - R . x . x * rot_x_xy_xz // xy-xz rotation contribution + R . x . z * rot_x_xz_yz ; // xz-yz rotation contribution Omega . x . y = R . y . y * rot_x_xy_yz // xy-yz rotation mapped to y-direction - R . y . x * rot_x_xy_xz // xy-xz rotation mapped to y-direction + R . y . z * rot_x_xz_yz ; // xz-yz rotation mapped to y-direction Omega . x . z = R . z . y * rot_x_xy_yz // xy-yz rotation mapped to z-direction - R . z . x * rot_x_xy_xz // xy-xz rotation mapped to z-direction + R . z . z * rot_x_xz_yz ; // xz-yz rotation mapped to z-direction // Compute y-row components using similar pattern Omega . y . x = R . x . y * rot_y_xy_yz - R . x . x * rot_y_xy_xz + R . x . z * rot_y_xz_yz ; Omega . y . y = R . y . y * rot_y_xy_yz - R . y . x * rot_y_xy_xz + R . y . z * rot_y_xz_yz ; Omega . y . z = R . z . y * rot_y_xy_yz - R . z . x * rot_y_xy_xz + R . z . z * rot_y_xz_yz ; // Compute z-row components using similar pattern Omega . z . x = R . x . y * rot_z_xy_yz - R . x . x * rot_z_xy_xz + R . x . z * rot_z_xz_yz ; Omega . z . y = R . y . y * rot_z_xy_yz - R . y . x * rot_z_xy_xz + R . y . z * rot_z_xz_yz ; Omega . z . z = R . z . y * rot_z_xy_yz - R . z . x * rot_z_xy_xz + R . z . z * rot_z_xz_yz ; Note: The resulting Omega tensor is skew-symmetric, meaning: - Omega_ij = -Omega_ji This property is automatically satisfied by the construction above and is essential for preserving the physical meaning of rotation // Extract diagonal components of M (velocity gradient tensor in eigenvector basis) double M_diag_x = M . x . x , M_diag_y = M . y . y , M_diag_z = M . z . z ; Compute B tensor: B = R * diag(M) * R^T - This transforms the diagonal velocity gradient tensor back to the original coordinate system - B is symmetric, so we only need to compute the upper triangle // Compute diagonal elements of B B . x . x = M_diag_x * sq ( R . x . x ) + M_diag_y * sq ( R . x . y ) + M_diag_z * sq ( R . x . z ); B . y . y = M_diag_x * sq ( R . y . x ) + M_diag_y * sq ( R . y . y ) + M_diag_z * sq ( R . y . z ); B . z . z = M_diag_x * sq ( R . z . x ) + M_diag_y * sq ( R . z . y ) + M_diag_z * sq ( R . z . z ); // Compute off-diagonal elements of B (upper triangle) B . x . y = M_diag_x * R . x . x * R . y . x + M_diag_y * R . x . y * R . y . y + M_diag_z * R . x . z * R . y . z ; B . x . z = M_diag_x * R . x . x * R . z . x + M_diag_y * R . x . y * R . z . y + M_diag_z * R . x . z * R . z . z ; B . y . z = M_diag_x * R . y . x * R . z . x + M_diag_y * R . y . y * R . z . y + M_diag_z * R . y . z * R . z . z ; // Fill in lower triangle using symmetry of B B . y . x = B . x . y ; B . z . x = B . x . z ; B . z . y = B . y . z ; } We now advance \\(\\Psi\\) in time, adding the upper convective contribution.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This step 1:...",
    "content": "This step 1: _t = 2 + (-) // save old values of Psi components double old_Psi11 = Psi11 []; double old_Psi22 = Psi22 []; double old_Psi33 = Psi33 []; double old_Psi12 = Psi12 []; double old_Psi13 = Psi13 []; double old_Psi23 = Psi23 []; // Psi11 Psi11 [] += dt * ( 2.0 * B . x . x + Omega . x . y * old_Psi12 - Omega . y . x * old_Psi12 + Omega . x . z * old_Psi13 - Omega . z . x * old_Psi13 ); // Psi22 Psi22 [] += dt * ( 2.0 * B . y . y - Omega . x . y * old_Psi12 + Omega . y . x * old_Psi12 + Omega . y . z * old_Psi23 - Omega . z . y * old_Psi23 ); // Psi33 Psi33 [] += dt * ( 2.0 * B . z . z - Omega . x . z * old_Psi13 + Omega . z . x * old_Psi13 - Omega . y . z * old_Psi23 + Omega . z . y * old_Psi23 ); // Psi12 Psi12 [] += dt * ( 2.0 * B . x . y + Omega . x . x * old_Psi12 - Omega . x . y * old_Psi11 + Omega . x . y * old_Psi22 - Omega . y . y * old_Psi12 + Omega . x . z * old_Psi23 - Omega . z . y * old_Psi13 ); // Psi13 Psi13 [] += dt * ( 2.0 * B . x . z + Omega . x . x * old_Psi13 - Omega . x . z * old_Psi11 + Omega . x . y * old_Psi23 - Omega . y . z * old_Psi12 + Omega . x . z * old_Psi33 - Omega . z . z * old_Psi13 ); // Psi23 Psi23 [] += dt * ( 2.0 * B . y . z + Omega . y . x * old_Psi13 - Omega . x . z * old_Psi12 + Omega . y . y * old_Psi23 - Omega . y . z * old_Psi22 + Omega . y . z * old_Psi33 - Omega . z . z * old_Psi23 ); } // Advection of Psi, which is the log-conformation tensor advection ({ Psi11 , Psi12 , Psi13 , Psi22 , Psi23 , Psi33 }, uf , dt ); Convert back to A and T We now convert the log-conformation tensor Psi back to the conformation tensor A and compute the stress tensor T.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This process involves...",
    "content": "This process involves diagonalization, exponentiation of eigenvalues, and application of the relaxation factor. foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); // Reconstruct the log-conformation tensor from its components A . x . x = Psi11 []; A . x . y = Psi12 []; A . x . z = Psi13 []; A . y . x = Psi12 []; A . y . y = Psi22 []; A . y . z = Psi23 []; A . z . x = Psi13 []; A . z . y = Psi23 []; A . z . z = Psi33 []; // Diagonalize A to obtain eigenvalues and eigenvectors diagonalization_3D (& Lambda , & R , & A ); // Exponentiate eigenvalues Lambda . x = exp ( Lambda . x ); Lambda . y = exp ( Lambda . y ); Lambda . z = exp ( Lambda . z ); // Reconstruct A using A = R * diag(Lambda) * R^T A . x . x = Lambda . x * sq ( R . x . x ) + Lambda . y * sq ( R . x . y ) + Lambda . z * sq ( R . x . z ); A . x . y = Lambda . x * R . x . x * R . y . x + Lambda . y * R . x . y * R . y . y + Lambda . z * R . x . z * R . y . z ; A . y . x = A . x . y ; A . x . z = Lambda . x * R . x . x * R . z . x + Lambda . y * R . x . y * R . z . y + Lambda . z * R . x . z * R . z . z ; A . z . x = A . x . z ; A . y . y = Lambda . x * sq ( R . y . x ) + Lambda . y * sq ( R . y . y ) + Lambda . z * sq ( R . y . z ); A . y . z = Lambda . x * R . y . x * R . z . x + Lambda . y * R . y . y * R . z . y + Lambda . z * R . y . z * R . z . z ; A . z . y = A . y . z ; A . z . z = Lambda . x * sq ( R . z . x ) + Lambda . y * sq ( R . z . y ) + Lambda . z * sq ( R . z . z ); // Apply relaxation using the relaxation time lambda double intFactor = lambda [] != 0. ? exp (- dt / lambda []) : 0. ; A . x . y *= intFactor ; A . y . x = A . x . y ; A . x . z *= intFactor ; A . z . x = A . x . z ; A . y . z *= intFactor ; A . z . y = A . y . z ; foreach_dimension () A . x . x = 1. + ( A . x . x - 1. )* intFactor ; Get Aij from A.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: These commands might...",
    "content": "These commands might look repetitive. But, I do this so that in the future, generalization to tensor only form is easier. // diagonal terms: A11 [] = A . x . x ; A22 [] = A . y . y ; A33 [] = A . z . z ; // off-diagonal terms: A12 [] = A . x . y ; A13 [] = A . x . z ; A23 [] = A . y . z ; // Compute the stress tensor T using the polymer modulus Gp T11 [] = Gp []*( A . x . x - 1. ); T22 [] = Gp []*( A . y . y - 1. ); T33 [] = Gp []*( A . z . z - 1. ); T12 [] = Gp []* A . x . y ; T13 [] = Gp []* A . x . z ; T23 [] = Gp []* A . y . z ; } } #endif Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{T}\\) is defined at cell centers, while the corresponding force (acceleration) is defined at cell faces. For each component of the momentum equation, we need to compute the divergence of the corresponding row of the stress tensor.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Examples",
    "content": "For example, for the x-component in 3D: \\[ (\\nabla \\cdot \\mathbf{T})_x = \\partial_x T_{xx} + \\partial_y T_{xy} + \\partial_z T_{xz} \\] The normal stress gradient (e.g. \\(\\partial_x T_{xx}\\) ) is computed directly from cell-centered values.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The shear stress...",
    "content": "The shear stress gradients (e.g. \\(\\partial_y T_{xy}\\) ) are computed using vertex-averaged values to avoid checkerboard instabilities. event acceleration ( i ++) { face vector av = a ; #if dimension == // 2D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 (shear stress) double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // x-gradient of T11 (normal stress) double gradX_T11 = cm []* T11 [] - cm [- 1 ]* T11 [- 1 ]; av . x [] += ( shearX + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 (shear stress) double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // y-gradient of T22 (normal stress) double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ]; av . y [] += ( shearY + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } #elif dimension == // 3D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 double shearY = ( T12 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T12 [- 1 , 1 , 0 ]* cm [- 1 , 1 , 0 ] - T12 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T13 double shearZ = ( T13 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T13 [- 1 , 0 , 1 ]* cm [- 1 , 0 , 1 ] - T13 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // x-gradient of T11 double gradX_T11 = cm []* T11 [] - cm [- 1 , 0 , 0 ]* T11 [- 1 , 0 , 0 ]; av . x [] += ( shearY + shearZ + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 double shearX = ( T12 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T12 [ 1 ,- 1 , 0 ]* cm [ 1 ,- 1 , 0 ] - T12 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T23 double shearZ = ( T23 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T23 [ 0 ,- 1 , 1 ]* cm [ 0 ,- 1 , 1 ] - T23 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // y-gradient of T22 double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 , 0 ]* T22 [ 0 ,- 1 , 0 ]; av . y [] += ( shearX + shearZ + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } foreach_face ( z ) { if ( fm . z [] > 1e-20 ) { // x-gradient of T13 double shearX = ( T13 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T13 [ 1 , 0 ,- 1 ]* cm [ 1 , 0 ,- 1 ] - T13 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // y-gradient of T23 double shearY = ( T23 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T23 [ 0 , 1 ,- 1 ]* cm [ 0 , 1 ,- 1 ] - T23 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // z-gradient of T33 double gradZ_T33 = cm []* T33 [] - cm [ 0 , 0 ,- 1 ]* T33 [ 0 , 0 ,- 1 ]; av . z [] += ( shearX + shearY + gradZ_T33 )* alpha . z []/( sq ( fm . z [])* Delta ); } } #endif }",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#if AXI#error \"axi compatibility is not there. To keep the code easy to read, we will not implement axi compatibility just yet.\"#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: /*TODO:- Perhaps, instead...",
    "content": "/*TODO:- Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h)*/#define EIGENVALUE_MIN1e-8220#ifdef DEBUG_EIGENVALUESstaticinteigenvalue_corrections=0;#endif#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation time/*conformation tensor */// diagonal elementsscalar A11[],A22[],A33[];// off-diagonal elementsscalar A12[],A13[],A23[];/*stress tensor */// diagonal elementsscalar T11[],T22[],T33[];// off-diagonal elementsscalar T12[],T13[],T23[];event defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22,A33}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T13,T22,T23,T33,A12,A13,A23}){foreach(){s[]=0.;}}for(scalar s in{A11,A22,A33,T11,T22,T33,A12,A13,A23,T12,T13,T23}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}if(s.boundary[top]!=periodic_bc){s[top]=neumann(0);s[bottom]=neumann(0);}#if dimension ==if(s.boundary[front]!=periodic_bc){s[front]=neumann(0);s[back]=neumann(0);}#endif}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#if dimension ==typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}#endif/*Now this is the 3D implementation.*/#if dimension ==#include\"eigen_decomposition.h\"typedefstruct{doublex,y,z;}pseudo_v3d;typedefstruct{pseudo_v3d x,y,z;}pseudo_t3d;// Function to initialize pseudo_v3dstaticinlinevoidinit_pseudo_v3d(pseudo_v3d*v,doublevalue){v->x=value;v->y=value;v->z=value;}// Function to initialize pseudo_t3dstaticinlinevoidinit_pseudo_t3d(pseudo_t3d*t,doublevalue){init_pseudo_v3d(&t->x,value);init_pseudo_v3d(&t->y,value);init_pseudo_v3d(&t->z,value);}staticvoiddiagonalization_3D(pseudo_v3d*Lambda,pseudo_t3d*R,pseudo_t3d*A){// Check if the matrix is already diagonalif(sq(A->x.y)+sq(A->x.z)+sq(A->y.z)<1e-15){R->x.x=R->y.y=R->z.z=1.;R->y.x=R->x.y=R->z.x=R->x.z=R->z.y=R->y.z=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;Lambda->z=A->z.z;return;}// Compute eigenvalues using the eigen_decomposition functiondoublematrix[3][3]={{A->x.x,A->x.y,A->x.z},{A->y.x,A->y.y,A->y.z},{A->z.x,A->z.y,A->z.z}};doubleeigenvectors[3][3];doubleeigenvalues[3];compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);// Store eigenvalues and eigenvectorsLambda->x=eigenvalues[0];Lambda->y=eigenvalues[1];Lambda->z=eigenvalues[2];R->x.x=eigenvectors[0][0];R->x.y=eigenvectors[0][1];R->x.z=eigenvectors[0][2];R->y.x=eigenvectors[1][0];R->y.y=eigenvectors[1][1];R->y.z=eigenvectors[1][2];R->z.x=eigenvectors[2][0];R->z.y=eigenvectors[2][1];R->z.z=eigenvectors[2][2];}#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g): [%g,%g]\\n\",x,y,Lambda.x,Lambda.y);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);A.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;A11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}#elif dimension ==",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: // start by...",
    "content": "// start by declaring the scalar variables that will store the components of $\\Psi$scalar Psi11=A11,Psi12=A12,Psi13=A13,Psi22=A22,Psi23=A23,Psi33=A33;foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);A.x.x=A11[];A.x.y=A12[];A.x.z=A13[];A.y.x=A12[];A.y.y=A22[];A.y.z=A23[];A.z.x=A13[];A.z.y=A23[];A.z.z=A33[];// Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors Rdiagonalization_3D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.||Lambda.z<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g,%g): [%g,%g,%g]\\n\",x,y,z,Lambda.x,Lambda.y,Lambda.z);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);Lambda.z=max(Lambda.z,EIGENVALUE_MIN);}// Compute Psi = log(A) = R * log(Lambda) * R^TPsi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y)+sq(R.x.z)*log(Lambda.z);Psi22[]=sq(R.y.x)*log(Lambda.x)+sq(R.y.y)*log(Lambda.y)+sq(R.y.z)*log(Lambda.z);Psi33[]=sq(R.z.x)*log(Lambda.x)+sq(R.z.y)*log(Lambda.y)+sq(R.z.z)*log(Lambda.z);Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.x.y*R.y.y*log(Lambda.y)+R.x.z*R.y.z*log(Lambda.z);Psi13[]=R.x.x*R.z.x*log(Lambda.x)+R.x.y*R.z.y*log(Lambda.y)+R.x.z*R.z.z*log(Lambda.z);Psi23[]=R.y.x*R.z.x*log(Lambda.x)+R.y.y*R.z.y*log(Lambda.y)+R.y.z*R.z.z*log(Lambda.z);// Compute B and Omega tensors (3D version)pseudo_t3d B,M,Omega;init_pseudo_t3d(&B,0.0);init_pseudo_t3d(&M,0.0);init_pseudo_t3d(&Omega,0.0);// Check if any pair of eigenvalues are numerically equal (within a small tolerance)if(fabs(Lambda.x-Lambda.y)<=1e-20||fabs(Lambda.y-Lambda.z)<=1e-20||fabs(Lambda.z-Lambda.x)<=1e-20){// In case of equal eigenvalues, the calculations for B and Omega simplify significantly// B is grad U and Omega is zero.// Compute off-diagonal elements of B using central differences// These represent the symmetric part of the velocity gradient tensorB.x.y=(u.y[1,0,0]-u.y[-1,0,0]+u.x[0,1,0]-u.x[0,-1,0])/(4.*Delta);// (dv/dx + du/dy)/2B.x.z=(u.z[1,0,0]-u.z[-1,0,0]+u.x[0,0,1]-u.x[0,0,-1])/(4.*Delta);// (dw/dx + du/dz)/2B.y.z=(u.z[0,1,0]-u.z[0,-1,0]+u.y[0,0,1]-u.y[0,0,-1])/(4.*Delta);// (dw/dy + dv/dz)/2// Compute diagonal elements of B// These represent the normal strain ratesB.x.x=(u.x[1,0,0]-u.x[-1,0,0])/(2.*Delta);// du/dxB.y.y=(u.y[0,1,0]-u.y[0,-1,0])/(2.*Delta);// dv/dyB.z.z=(u.z[0,0,1]-u.z[0,0,-1])/(2.*Delta);// dw/dz// Set all components of Omega to zero// This is because Omega represents the antisymmetric part of the velocity gradient tensor,// which vanishes when eigenvalues are equalOmega.x.y=Omega.x.z=Omega.y.z=Omega.y.x=Omega.z.x=Omega.z.y=0.;}else{/*###Compute the velocity gradient tensor components using central differences- These represent the spatial derivatives of each velocity component- These gradients form the velocity gradient tensor (nablaU):[ dudx  dudy  dudz ][ dvdx  dvdy  dvdz ][ dwdx  dwdy  dwdz ]*/// Derivatives of u (x-component of velocity)doubledudx=(u.x[1,0,0]-u.x[-1,0,0])/(2.0*Delta);// du/dxdoubledudy=(u.x[0,1,0]-u.x[0,-1,0])/(2.0*Delta);// du/dydoubledudz=(u.x[0,0,1]-u.x[0,0,-1])/(2.0*Delta);// du/dz// Derivatives of v (y-component of velocity)doubledvdx=(u.y[1,0,0]-u.y[-1,0,0])/(2.0*Delta);// dv/dxdoubledvdy=(u.y[0,1,0]-u.y[0,-1,0])/(2.0*Delta);// dv/dydoubledvdz=(u.y[0,0,1]-u.y[0,0,-1])/(2.0*Delta);// dv/dz// Derivatives of w (z-component of velocity)doubledwdx=(u.z[1,0,0]-u.z[-1,0,0])/(2.0*Delta);// dw/dxdoubledwdy=(u.z[0,1,0]-u.z[0,-1,0])/(2.0*Delta);// dw/dydoubledwdz=(u.z[0,0,1]-u.z[0,0,-1])/(2.0*Delta);// dw/dz/*Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor.* Steps:1. Compute intermediate products (R * nablaU^T):- Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_*- Each variable represents one row of the intermediate matrix2.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor:- M.i.j represents the (i,j) component of the transformed velocity gradient- This transformation expresses the velocity gradient in the eigenvector basis- The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that*/// First, compute intermediate products of R and (nablaU)^TdoubleRx_gradU_x=R.x.x*dudx+R.x.y*dvdx+R.x.z*dwdx;doubleRx_gradU_y=R.x.x*dudy+R.x.y*dvdy+R.x.z*dwdy;doubleRx_gradU_z=R.x.x*dudz+R.x.y*dvdz+R.x.z*dwdz;doubleRy_gradU_x=R.y.x*dudx+R.y.y*dvdx+R.y.z*dwdx;doubleRy_gradU_y=R.y.x*dudy+R.y.y*dvdy+R.y.z*dwdy;doubleRy_gradU_z=R.y.x*dudz+R.y.y*dvdz+R.y.z*dwdz;doubleRz_gradU_x=R.z.x*dudx+R.z.y*dvdx+R.z.z*dwdx;doubleRz_gradU_y=R.z.x*dudy+R.z.y*dvdy+R.z.z*dwdy;doubleRz_gradU_z=R.z.x*dudz+R.z.y*dvdz+R.z.z*dwdz;// Now compute M components by multiplying the intermediate products with R^TM.x.x=R.x.x*Rx_gradU_x+R.x.y*Rx_gradU_y+R.x.z*Rx_gradU_z;M.x.y=R.x.x*Ry_gradU_x+R.x.y*Ry_gradU_y+R.x.z*Ry_gradU_z;M.x.z=R.x.x*Rz_gradU_x+R.x.y*Rz_gradU_y+R.x.z*Rz_gradU_z;M.y.x=R.y.x*Rx_gradU_x+R.y.y*Rx_gradU_y+R.y.z*Rx_gradU_z;M.y.y=R.y.x*Ry_gradU_x+R.y.y*Ry_gradU_y+R.y.z*Ry_gradU_z;M.y.z=R.y.x*Rz_gradU_x+R.y.y*Rz_gradU_y+R.y.z*Rz_gradU_z;M.z.x=R.z.x*Rx_gradU_x+R.z.y*Rx_gradU_y+R.z.z*Rx_gradU_z;M.z.y=R.z.x*Ry_gradU_x+R.z.y*Ry_gradU_y+R.z.z*Ry_gradU_z;M.z.z=R.z.x*Rz_gradU_x+R.z.y*Rz_gradU_y+R.z.z*Rz_gradU_z;// Compute the off-diagonal elements of the Omega tensor in the eigenvector basisdoubleomega_xy=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);doubleomega_xz=(Lambda.z*M.x.z+Lambda.x*M.z.x)/(Lambda.z-Lambda.x);doubleomega_yz=(Lambda.z*M.y.z+Lambda.y*M.z.y)/(Lambda.z-Lambda.y);// Calculate intermediate rotation combinations for each direction// x-direction rotation combinationsdoublerot_x_xy_yz=(R.x.x*omega_xy-R.x.z*omega_yz);// xy rotation minus yz rotation, x componentsdoublerot_x_xy_xz=(R.x.y*omega_xy+R.x.z*omega_xz);// xy rotation plus xz rotation, x componentsdoublerot_x_xz_yz=(R.x.x*omega_xz+R.x.y*omega_yz);// xz rotation plus yz rotation, x components// y-direction rotation combinationsdoublerot_y_xy_yz=(R.y.x*omega_xy-R.y.z*omega_yz);// xy rotation minus yz rotation, y componentsdoublerot_y_xy_xz=(R.y.y*omega_xy+R.y.z*omega_xz);// xy rotation plus xz rotation, y componentsdoublerot_y_xz_yz=(R.y.x*omega_xz+R.y.y*omega_yz);// xz rotation plus yz rotation, y components// z-direction rotation combinationsdoublerot_z_xy_yz=(R.z.x*omega_xy-R.z.z*omega_yz);// xy rotation minus yz rotation, z componentsdoublerot_z_xy_xz=(R.z.y*omega_xy+R.z.z*omega_xz);// xy rotation plus xz rotation, z componentsdoublerot_z_xz_yz=(R.z.x*omega_xz+R.z.y*omega_yz);// xz rotation plus yz rotation, z components",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: // Compute x-row...",
    "content": "// Compute x-row components of OmegaOmega.x.x=R.x.y*rot_x_xy_yz// xy-yz rotation contribution-R.x.x*rot_x_xy_xz// xy-xz rotation contribution+R.x.z*rot_x_xz_yz;// xz-yz rotation contributionOmega.x.y=R.y.y*rot_x_xy_yz// xy-yz rotation mapped to y-direction-R.y.x*rot_x_xy_xz// xy-xz rotation mapped to y-direction+R.y.z*rot_x_xz_yz;// xz-yz rotation mapped to y-directionOmega.x.z=R.z.y*rot_x_xy_yz// xy-yz rotation mapped to z-direction-R.z.x*rot_x_xy_xz// xy-xz rotation mapped to z-direction+R.z.z*rot_x_xz_yz;// xz-yz rotation mapped to z-direction// Compute y-row components using similar patternOmega.y.x=R.x.y*rot_y_xy_yz-R.x.x*rot_y_xy_xz+R.x.z*rot_y_xz_yz;Omega.y.y=R.y.y*rot_y_xy_yz-R.y.x*rot_y_xy_xz+R.y.z*rot_y_xz_yz;Omega.y.z=R.z.y*rot_y_xy_yz-R.z.x*rot_y_xy_xz+R.z.z*rot_y_xz_yz;// Compute z-row components using similar patternOmega.z.x=R.x.y*rot_z_xy_yz-R.x.x*rot_z_xy_xz+R.x.z*rot_z_xz_yz;Omega.z.y=R.y.y*rot_z_xy_yz-R.y.x*rot_z_xy_xz+R.y.z*rot_z_xz_yz;Omega.z.z=R.z.y*rot_z_xy_yz-R.z.x*rot_z_xy_xz+R.z.z*rot_z_xz_yz;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "// Extract diagonal components of M (velocity gradient tensor in eigenvector basis)doubleM_diag_x=M.x.x,M_diag_y=M.y.y,M_diag_z=M.z.z;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: // Compute diagonal...",
    "content": "// Compute diagonal elements of BB.x.x=M_diag_x*sq(R.x.x)+M_diag_y*sq(R.x.y)+M_diag_z*sq(R.x.z);B.y.y=M_diag_x*sq(R.y.x)+M_diag_y*sq(R.y.y)+M_diag_z*sq(R.y.z);B.z.z=M_diag_x*sq(R.z.x)+M_diag_y*sq(R.z.y)+M_diag_z*sq(R.z.z);// Compute off-diagonal elements of B (upper triangle)B.x.y=M_diag_x*R.x.x*R.y.x+M_diag_y*R.x.y*R.y.y+M_diag_z*R.x.z*R.y.z;B.x.z=M_diag_x*R.x.x*R.z.x+M_diag_y*R.x.y*R.z.y+M_diag_z*R.x.z*R.z.z;B.y.z=M_diag_x*R.y.x*R.z.x+M_diag_y*R.y.y*R.z.y+M_diag_z*R.y.z*R.z.z;// Fill in lower triangle using symmetry of BB.y.x=B.x.y;B.z.x=B.x.z;B.z.y=B.y.z;}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: // save old...",
    "content": "// save old values of Psi componentsdoubleold_Psi11=Psi11[];doubleold_Psi22=Psi22[];doubleold_Psi33=Psi33[];doubleold_Psi12=Psi12[];doubleold_Psi13=Psi13[];doubleold_Psi23=Psi23[];// Psi11Psi11[]+=dt*(2.0*B.x.x+Omega.x.y*old_Psi12-Omega.y.x*old_Psi12+Omega.x.z*old_Psi13-Omega.z.x*old_Psi13);// Psi22Psi22[]+=dt*(2.0*B.y.y-Omega.x.y*old_Psi12+Omega.y.x*old_Psi12+Omega.y.z*old_Psi23-Omega.z.y*old_Psi23);// Psi33Psi33[]+=dt*(2.0*B.z.z-Omega.x.z*old_Psi13+Omega.z.x*old_Psi13-Omega.y.z*old_Psi23+Omega.z.y*old_Psi23);// Psi12Psi12[]+=dt*(2.0*B.x.y+Omega.x.x*old_Psi12-Omega.x.y*old_Psi11+Omega.x.y*old_Psi22-Omega.y.y*old_Psi12+Omega.x.z*old_Psi23-Omega.z.y*old_Psi13);// Psi13Psi13[]+=dt*(2.0*B.x.z+Omega.x.x*old_Psi13-Omega.x.z*old_Psi11+Omega.x.y*old_Psi23-Omega.y.z*old_Psi12+Omega.x.z*old_Psi33-Omega.z.z*old_Psi13);// Psi23Psi23[]+=dt*(2.0*B.y.z+Omega.y.x*old_Psi13-Omega.x.z*old_Psi12+Omega.y.y*old_Psi23-Omega.y.z*old_Psi22+Omega.y.z*old_Psi33-Omega.z.z*old_Psi23);}// Advection of Psi, which is the log-conformation tensoradvection({Psi11,Psi12,Psi13,Psi22,Psi23,Psi33},uf,dt);",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);// Reconstruct the log-conformation tensor from its componentsA.x.x=Psi11[];A.x.y=Psi12[];A.x.z=Psi13[];A.y.x=Psi12[];A.y.y=Psi22[];A.y.z=Psi23[];A.z.x=Psi13[];A.z.y=Psi23[];A.z.z=Psi33[];// Diagonalize A to obtain eigenvalues and eigenvectorsdiagonalization_3D(&Lambda,&R,&A);// Exponentiate eigenvaluesLambda.x=exp(Lambda.x);Lambda.y=exp(Lambda.y);Lambda.z=exp(Lambda.z);// Reconstruct A using A = R * diag(Lambda) * R^TA.x.x=Lambda.x*sq(R.x.x)+Lambda.y*sq(R.x.y)+Lambda.z*sq(R.x.z);A.x.y=Lambda.x*R.x.x*R.y.x+Lambda.y*R.x.y*R.y.y+Lambda.z*R.x.z*R.y.z;A.y.x=A.x.y;A.x.z=Lambda.x*R.x.x*R.z.x+Lambda.y*R.x.y*R.z.y+Lambda.z*R.x.z*R.z.z;A.z.x=A.x.z;A.y.y=Lambda.x*sq(R.y.x)+Lambda.y*sq(R.y.y)+Lambda.z*sq(R.y.z);A.y.z=Lambda.x*R.y.x*R.z.x+Lambda.y*R.y.y*R.z.y+Lambda.z*R.y.z*R.z.z;A.z.y=A.y.z;A.z.z=Lambda.x*sq(R.z.x)+Lambda.y*sq(R.z.y)+Lambda.z*sq(R.z.z);// Apply relaxation using the relaxation time lambdadoubleintFactor=lambda[]!=0.?exp(-dt/lambda[]):0.;A.x.y*=intFactor;A.y.x=A.x.y;A.x.z*=intFactor;A.z.x=A.x.z;A.y.z*=intFactor;A.z.y=A.y.z;foreach_dimension()A.x.x=1.+(A.x.x-1.)*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "// diagonal terms:A11[]=A.x.x;A22[]=A.y.y;A33[]=A.z.z;// off-diagonal terms:A12[]=A.x.y;A13[]=A.x.z;A23[]=A.y.z;// Compute the stress tensor T using the polymer modulus GpT11[]=Gp[]*(A.x.x-1.);T22[]=Gp[]*(A.y.y-1.);T33[]=Gp[]*(A.z.z-1.);T12[]=Gp[]*A.x.y;T13[]=Gp[]*A.x.z;T23[]=Gp[]*A.y.z;}}#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;#if dimension ==// 2D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12 (shear stress)doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;// x-gradient of T11 (normal stress)doublegradX_T11=cm[]*T11[]-cm[-1]*T11[-1];av.x[]+=(shearX+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12 (shear stress)doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;// y-gradient of T22 (normal stress)doublegradY_T22=cm[]*T22[]-cm[0,-1]*T22[0,-1];av.y[]+=(shearY+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}#elif dimension ==// 3D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12doubleshearY=(T12[0,1,0]*cm[0,1,0]+T12[-1,1,0]*cm[-1,1,0]-T12[0,-1,0]*cm[0,-1,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T13doubleshearZ=(T13[0,0,1]*cm[0,0,1]+T13[-1,0,1]*cm[-1,0,1]-T13[0,0,-1]*cm[0,0,-1]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// x-gradient of T11doublegradX_T11=cm[]*T11[]-cm[-1,0,0]*T11[-1,0,0];av.x[]+=(shearY+shearZ+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12doubleshearX=(T12[1,0,0]*cm[1,0,0]+T12[1,-1,0]*cm[1,-1,0]-T12[-1,0,0]*cm[-1,0,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T23doubleshearZ=(T23[0,0,1]*cm[0,0,1]+T23[0,-1,1]*cm[0,-1,1]-T23[0,0,-1]*cm[0,0,-1]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// y-gradient of T22doublegradY_T22=cm[]*T22[]-cm[0,-1,0]*T22[0,-1,0];av.y[]+=(shearX+shearZ+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}foreach_face(z){if(fm.z[]>1e-20){// x-gradient of T13doubleshearX=(T13[1,0,0]*cm[1,0,0]+T13[1,0,-1]*cm[1,0,-1]-T13[-1,0,0]*cm[-1,0,0]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// y-gradient of T23doubleshearY=(T23[0,1,0]*cm[0,1,0]+T23[0,1,-1]*cm[0,1,-1]-T23[0,-1,0]*cm[0,-1,0]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// z-gradient of T33doublegradZ_T33=cm[]*T33[]-cm[0,0,-1]*T33[0,0,-1];av.z[]+=(shearX+shearY+gradZ_T33)*alpha.z[]/(sq(fm.z[])*Delta);}}#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "src-local/two-phaseVE.h See raw file Modification by Vatsal Sanjay Version 2.0, Oct 17, 2024 Changelog Oct 17, 2024: added support for VE simulations. Brief history v1.0 is the vanilla Basilisk code for two-phase flows: http://basilisk.fr/src/two-phase.h + http://basilisk.fr/src/two-phase-generic.h v2.0 is the modification for viscoelastic fluids using the log-conformation method. Two-phase interfacial flows This is a modified version of two-phase.h . It contains the implementation of Viscoplastic Fluid (Bingham Fluid). This file helps setup simulations for flows of two fluids separated by an interface (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. #include \"vof.h\" scalar f [], * interfaces = { f }; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. ; double G1 = 0. , G2 = 0. ; // elastic moduli double lambda1 = 0. , lambda2 = 0. ; // relaxation times double TOLelastic = 1e-2 ; // tolerance for elastic modulus #TOFIX: this must always be a very small number. Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; scalar Gpd []; scalar lambdapd []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; Gp = Gpd ; lambda = lambdapd ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho # define rho ( f ) ( clamp ( f , 0. , 1. )*( rho1 - rho2 ) + rho2 ) 62 #endif #ifndef mu // for Arithmetic mean, use this # define mu ( f ) ( clamp ( f , 0. , 1. )*( mu1 - mu2 ) + mu2 ) 66 #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf []; #else # define sf f 76 #endif event tracer_advection ( i ++) { When using smearing of the density jump, we initialise sf with the vertex-average of f . #ifndef sf #if dimension <= foreach () sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; #else // dimension == foreach () sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; #endif #endif #if TREE sf . prolongation = refine_bilinear ; sf . dirty = true ; // boundary conditions need to be updated #endif } event properties ( i ++) { foreach_face () { double ff = ( sf [] + sf [- 1 ])/ 2. ; alphav . x [] = fm . x []/ rho ( ff ); face vector muv = mu ; muv . x [] = fm . x []* mu ( ff ); } foreach (){ rhov [] = cm []* rho ( sf []); Gpd [] = 0. ; lambdapd [] = 0. ; if ( clamp ( sf [], 0. , 1. ) > TOLelastic ){ Gpd [] += G1 * clamp ( sf [], 0. , 1. ); lambdapd [] += lambda1 * clamp ( sf [], 0. , 1. ); } if ( clamp (( 1 - sf []), 0. , 1. ) > TOLelastic ){ Gpd [] += G2 * clamp (( 1 - sf []), 0. , 1. ); lambdapd [] += lambda2 * clamp (( 1 - sf []), 0. , 1. ); } } #if TREE sf . prolongation = fraction_refine ; sf . dirty = true ; // boundary conditions need to be updated #endif }",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code",
    "content": "#include\"vof.h\"scalar f[],*interfaces={f};doublerho1=1.,mu1=0.,rho2=1.,mu2=0.;doubleG1=0.,G2=0.;// elastic modulidoublelambda1=0.,lambda2=0.;// relaxation timesdoubleTOLelastic=1e-2;// tolerance for elastic modulus #TOFIX: this must always be a very small number.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "face vector alphav[];scalar rhov[];scalar Gpd[];scalar lambdapd[];event defaults(i=0){alpha=alphav;rho=rhov;Gp=Gpd;lambda=lambdapd;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Function: rho",
    "content": "#ifndef rho# define rho(f)(clamp(f,0.,1.)*(rho1-rho2)+rho2)62#endif#ifndef mu// for Arithmetic mean, use this# define mu(f)(clamp(f,0.,1.)*(mu1-mu2)+mu2)66#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf[];#else# define sf f76#endifevent tracer_advection(i++){",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Function: sf",
    "content": "#ifndef sf#if dimension <=foreach()sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;#else// dimension ==foreach()sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;#endif#endif#if TREEsf.prolongation=refine_bilinear;sf.dirty=true;// boundary conditions need to be updated#endif}event properties(i++){foreach_face(){doubleff=(sf[]+sf[-1])/2.;alphav.x[]=fm.x[]/rho(ff);face vector muv=mu;muv.x[]=fm.x[]*mu(ff);}foreach(){rhov[]=cm[]*rho(sf[]);Gpd[]=0.;lambdapd[]=0.;if(clamp(sf[],0.,1.)>TOLelastic){Gpd[]+=G1*clamp(sf[],0.,1.);lambdapd[]+=lambda1*clamp(sf[],0.,1.);}if(clamp((1-sf[]),0.,1.)>TOLelastic){Gpd[]+=G2*clamp((1-sf[]),0.,1.);lambdapd[]+=lambda2*clamp((1-sf[]),0.,1.);}}#if TREEsf.prolongation=fraction_refine;sf.dirty=true;// boundary conditions need to be updated#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Methods",
    "content": "src-local/log-conform-viscoelastic-scalar-2D.h See raw file Log-Conformation Method for 2D Viscoelastic Fluids Overview Title : log-conform-viscoelastic-scalar-2D.h Version : 2.5 Description : 2D and axisymmetric scalar implementation of viscoelastic fluid dynamics using the log-conformation method Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Supports both 2D and axisymmetric configurations Scalar implementation approach for better performance Compatible with log-conform-viscoelastic.h Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Nov 23, 2024 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Version History v1.0 (Oct 18, 2024) Initial implementation with 2D+axi support Scalar-based implementation for efficiency v2.0 (Nov 3, 2024) Major documentation improvements Made code an axisymmetric mirror of log-conform-viscoelastic-scalar-3D.h Added negative eigenvalue detection with location reporting Added initialization functions for pseudo_v and pseudo_t v2.1 (Nov 14, 2024) Added support for infinite Deborah number cases v2.5 (Nov 23, 2024) Enhanced documentation clarity and completeness Future Work Tensor Formulation Convert to consistent tensor formulation for: Improved readability and maintainability Better computational efficiency Reduced potential for bugs Prerequisites for axi compatibility in 3D version Related issues: https://github.com/comphy-lab/Viscoelastic3D/issues/11 https://github.com/comphy-lab/Viscoelastic3D/issues/5 Code Improvements Enforce tensor usage throughout codebase Implement foreach_dimension compatibility The log-conformation method for viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Therefore these materials...",
    "content": "Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers. Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The conformation tensor...",
    "content": "The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time. In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Parameters The primary...",
    "content": "Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: TODO: - Perhaps,...",
    "content": "TODO: - Perhaps, instead of the Bell\u2013Collela\u2013Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to http://basilisk.fr/src/navier-stokes/conserving.h #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time scalar A11 [], A12 [], A22 []; // conformation tensor scalar T11 [], T12 [], T22 []; // stress tensor #if AXI scalar AThTh [], T_ThTh []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T22 , A12 }) { foreach (){ s [] = 0. ; } } #if AXI foreach (){ T_ThTh [] = 0 ; AThTh [] = 1. ; } #endif for ( scalar s in { T11 , T12 , T22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } for ( scalar s in { A11 , A12 , A22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } #if AXI T12 [ bottom ] = dirichlet ( 0. ); A12 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ).",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: In an Oldroyd-B...",
    "content": "In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; #if AXI scalar Psiqq = AThTh ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . x = A11 []; A . y . y = A22 []; A . x . y = A12 []; #if AXI double Aqq = AThTh []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: If it does,...",
    "content": "If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g , Lambda.y = %g\\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g , y = %g\\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi11 , Psi12 , Psi22 , Psiqq }, uf , dt ); #else advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); #endif Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; #if AXI AThTh [] = Aqq ; T_ThTh [] = Gp []*( Aqq - 1. ); #endif A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Examples",
    "content": "For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face ( x ){ if ( fm . x [] > 1e-20 ) { double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shearX + cm []* T11 [] - cm [- 1 ]* T11 [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ){ if ( fm . y [] > 1e-20 ) { double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . y [] += ( shearY + cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ])* alpha . y []/( sq ( fm . y [])* Delta ); } } #if AXI foreach_face ( y ) if ( y > 1e-20 ) av . y [] -= ( T_ThTh [] + T_ThTh [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - C/C++ Code: C/C++ Code",
    "content": "#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation timescalar A11[],A12[],A22[];// conformation tensorscalar T11[],T12[],T22[];// stress tensor#if AXIscalar AThTh[],T_ThTh[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T22,A12}){foreach(){s[]=0.;}}#if AXIforeach(){T_ThTh[]=0;AThTh[]=1.;}#endiffor(scalar s in{T11,T12,T22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}for(scalar s in{A11,A12,A22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}#if AXIT12[bottom]=dirichlet(0.);A12[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;#if AXIscalar Psiqq=AThTh;#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_t A;A.x.x=A11[];A.y.y=A22[];A.x.y=A12[];#if AXIdoubleAqq=AThTh[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x =%g, Lambda.y =%g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x =%g, y =%g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "#if AXIadvection({Psi11,Psi12,Psi22,Psiqq},uf,dt);#elseadvection({Psi11,Psi12,Psi22},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;#if AXIAThTh[]=Aqq;T_ThTh[]=Gp[]*(Aqq-1.);#endifA11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | ElastoFlow: 2D/3D Viscoelastic Fluid Simulation Framework - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;foreach_face(x){if(fm.x[]>1e-20){doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shearX+cm[]*T11[]-cm[-1]*T11[-1])*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;av.y[]+=(shearY+cm[]*T22[]-cm[0,-1]*T22[0,-1])*alpha.y[]/(sq(fm.y[])*Delta);}}#if AXIforeach_face(y)if(y>1e-20)av.y[]-=(T_ThTh[]+T_ThTh[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic3D/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # tested on MacOS only.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue. # modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to install basilisk install_basilisk() { darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make } # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then echo \"Installing basilisk...\" rm -rf basilisk install_basilisk else echo \"Using existing basilisk installation...\" cd basilisk/src fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\\nChecking qcc installation...\" if ! qcc --version > /dev/null 2 >& 1 ; then echo \"\\033[0;31mError: qcc is not working properly.\\033[0m\" echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" echo \"For more details, visit: http://basilisk.fr/src/INSTALL\" exit 1 else echo \"\\033[0;32mqcc is properly installed.\\033[0m\" qcc --version fi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: #!/bin/zsh# tested on...",
    "content": "#!/bin/zsh# tested on MacOS only.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue.# modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basilisk# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to install basiliskinstall_basilisk(){darcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake}# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenecho\"Installing basilisk...\"rm-rfbasiliskinstall_basiliskelseecho\"Using existing basilisk installation...\"cdbasilisk/srcfi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\\nChecking qcc installation...\"if!qcc--version>/dev/null2>&1;thenecho\"\\033[0;31mError: qcc is not working properly.\\033[0m\"echo\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"echo\"For more details, visit: http://basilisk.fr/src/INSTALL\"exit1elseecho\"\\033[0;32mqcc is properly installed.\\033[0m\"qcc--versionfi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runCodesInParallel.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles",
    "content": "runCodesInParallel.sh See raw file runCodesInParallel.sh #!/bin/bash # check that CLI inputs are there. 1 is compulsory. if 2 is not there, use 4 (default) if [ \\$ # -lt 1 ] ; then echo \"Usage: \\$ 0 <filename> [number_of_processes]\" exit 1 fi file = \\$ 1 NP = \\$ {2:-4} # use 4 as default if not provided mkdir -p \\$ file CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -I\\$PWD /src-local -I\\$PWD /../src-local -disable-dimensions \\$ file.c -o \\$ file/\\$file -lm chmod +x \\$ file/\\$file # Ensure executable has proper permissions cd \\$ file mpirun --allow-run-as-root -np \\$ NP ./\\$file",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runCodesInParallel.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runCodesInParallel.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#!/bin/bash# check that CLI inputs are there. 1 is compulsory. if 2 is not there, use 4 (default)if[\\$#-lt1];thenecho\"Usage:\\$0 <filename> [number_of_processes]\"exit1fifile=\\$1NP=\\${2:-4}# use 4 as default if not providedmkdir-p\\$fileCC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-I\\$PWD/src-local-I\\$PWD/../src-local-disable-dimensions\\$file.c-o\\$file/\\$file-lmchmod+x\\$file/\\$file# Ensure executable has proper permissionscd\\$filempirun--allow-run-as-root-np\\$NP ./\\$file",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runCodesInParallel.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "runParameterSweep.sh See raw file runParameterSweep.sh #!/bin/bash # runParameterSweep.sh - Run parameter sweep with auto-incrementing CaseNo # Generates parameter combinations and runs simulations in simulationCases/<CaseNo>/ set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [sweep_file] Run parameter sweep with auto-incrementing CaseNo.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Creates case folders...",
    "content": "Creates case folders in simulationCases/<CaseNo>/ for each parameter combination. Cases run sequentially (one at a time). By default, runs Stage 1 (generate restart) then Stage 2 (full simulation) for each case. Stage Selection: --stage1-only Run Stage 1 only for all cases (generate restart files) --stage2-only Run Stage 2 only for all cases (requires existing restart files) (default) Run Stage 1 then Stage 2 for each case Parallelization (for Stage 2, or Stage 1 on Linux): --fopenmp [N] Enable OpenMP with N threads (default: 8, Linux only) --mpi [N] Enable MPI with N cores (default: 2, Stage 2 only) Other Options: -n, --dry-run Show parameter combinations without running -v, --verbose Verbose output -c, --compile-only Compile only, don't run simulations -h, --help Show this help message Parameter sweep file (default): \\$ 0 sweep.params If no sweep file specified, uses sweep.params from current directory.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Sweep file format:...",
    "content": "Sweep file format: BASE_CONFIG=default.params CASE_START=1000 CASE_END=1005 SWEEP_De=0.1,0.5,1.0 SWEEP_Oh=0.01,0.02 CaseNo auto-increments from CASE_START for each parameter combination.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "Examples: # Run sweep (Stage 1 + Stage 2 per case, serial) \\$ 0 # Dry run to see parameter combinations \\$ 0 --dry-run # Run only Stage 1 for all cases (generate restart files) \\$ 0 --stage1-only # Run only Stage 2 with MPI (assumes restart files exist) \\$ 0 --stage2-only --mpi 8 # Run full sweep with OpenMP (Linux) \\$ 0 --fopenmp 4 # Run custom sweep file \\$ 0 custom_sweep.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ DRY_RUN = 0 VERBOSE = 0 COMPILE_ONLY = 0 STAGE1_ONLY = 0 STAGE2_ONLY = 0 FOPENMP_ENABLED = 0 FOPENMP_THREADS = 8 MPI_ENABLED = 0 MPI_CORES = 2 while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -c | --compile-only ) COMPILE_ONLY = 1 shift ;; --stage1-only ) STAGE1_ONLY = 1 shift ;; --stage2-only ) STAGE2_ONLY = 1 shift ;; --fopenmp ) FOPENMP_ENABLED = 1 # Check if next arg is a number (optional thread count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then FOPENMP_THREADS = \" \\$ 2\" shift fi shift ;; --mpi ) MPI_ENABLED = 1 # Check if next arg is a number (optional core count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then MPI_CORES = \" \\$ 2\" shift fi shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Validation # ============================================================ # Check mutually exclusive stage flags if [ \\$ STAGE1_ONLY -eq 1 ] && [ \\$ STAGE2_ONLY -eq 1 ] ; then echo \"ERROR: Cannot use both --stage1-only and --stage2-only\" >& 2 exit 1 fi # Check --mpi only with stage2 if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE1_ONLY -eq 1 ] ; then echo \"ERROR: --mpi is only valid for Stage 2 (use --stage2-only or default both-stages mode)\" >& 2 exit 1 fi # Check --mpi and --fopenmp are mutually exclusive if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"ERROR: --mpi and --fopenmp are mutually exclusive\" >& 2 exit 1 fi # ============================================================ # Determine Sweep File # ============================================================ SWEEP_FILE = \" \\$ {1:-sweep.params}\" if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"=========================================\" echo \"Viscoelastic Bubble Bursting - Parameter Sweep\" echo \"=========================================\" echo \"Sweep file: \\$ SWEEP_FILE\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: Dry run (no execution)\" if [ \\$ STAGE1_ONLY -eq 1 ] ; then echo \"Stages: Stage 1 only (generate restart files)\" elif [ \\$ STAGE2_ONLY -eq 1 ] ; then echo \"Stages: Stage 2 only (full simulation)\" else echo \"Stages: Stage 1 + Stage 2 per case\" fi if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Parallelization: MPI ( \\$ MPI_CORES cores)\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Parallelization: OpenMP ( \\$ FOPENMP_THREADS threads)\" else echo \"Parallelization: Serial\" fi echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ # Create temporary directory for generated parameter files TEMP_DIR = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i.bak \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i.bak \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done (( ++ COMBINATION_COUNT )) # Print summary if [ \\$ DRY_RUN -eq 1 ] || [ \\$ VERBOSE -eq 1 ] ; then echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" fi (( CASE_NUM ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+ \" \\$ {current_values[@]}\" } \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # Exit if dry run if [ \\$ DRY_RUN -eq 1 ] ; then echo \"Dry run complete.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "No simulations executed.\" exit 0 fi # ============================================================ # Run Simulations # ============================================================ echo \"=========================================\" echo \"Running Simulations\" echo \"=========================================\" # Build list of parameter files PARAM_FILES = () for case_file in \" \\$ TEMP_DIR\" /case_ * .params ; do PARAM_FILES += ( \" \\$ case_file\" ) done # Build common flags COMMON_FLAGS = \"\" if [ \\$ COMPILE_ONLY -eq 1 ] ; then COMMON_FLAGS = \" \\$ COMMON_FLAGS --compile-only\" fi if [ \\$ VERBOSE -eq 1 ] ; then COMMON_FLAGS = \" \\$ COMMON_FLAGS --verbose\" fi # Build parallelization flags PARALLEL_FLAGS = \"\" if [ \\$ MPI_ENABLED -eq 1 ] ; then PARALLEL_FLAGS = \"--mpi \\$ MPI_CORES\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then PARALLEL_FLAGS = \"--fopenmp \\$ FOPENMP_THREADS\" fi # Run simulations echo \"Running \\$ COMBINATION_COUNT simulations sequentially\" echo \"\" for param_file in \" \\$ {PARAM_FILES[@]}\" ; do case_no = \\$ ( grep \"^CaseNo=\" \" \\$ param_file\" | cut -d '=' -f2 ) echo \"-----------------------------------------\" echo \"Processing Case \\$ case_no\" echo \"-----------------------------------------\" if [ \\$ STAGE1_ONLY -eq 1 ] ; then # Stage 1 only echo \"Running Stage 1...\" ./runSimulation.sh --stage1 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" elif [ \\$ STAGE2_ONLY -eq 1 ] ; then # Stage 2 only echo \"Running Stage 2...\" ./runSimulation.sh --stage2 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" else # Both stages: Stage 1 then Stage 2 echo \"Running Stage 1...\" ./runSimulation.sh --stage1 \\$ COMMON_FLAGS \" \\$ param_file\" echo \"\" echo \"Running Stage 2...\" ./runSimulation.sh --stage2 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" fi echo \"\" done echo \"=========================================\" echo \"Parameter Sweep Complete\" echo \"=========================================\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Case range: \\$ CASE_START to \\$ ((CASE_START + COMBINATION_COUNT - 1))\" echo \"Output location: simulationCases/\" echo \"\"",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#!/bin/bash# runParameterSweep.sh - Run parameter sweep with auto-incrementing CaseNo# Generates parameter combinations and runs simulations in simulationCases/<CaseNo>/set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [sweep_file]Run parameter sweep with auto-incrementing CaseNo.Creates case folders in simulationCases/<CaseNo>/ for each parameter combination.Cases run sequentially (one at a time).By default, runs Stage 1 (generate restart) then Stage 2 (full simulation) for each case.Stage Selection:--stage1-only        Run Stage 1 only for all cases (generate restart files)--stage2-only        Run Stage 2 only for all cases (requires existing restart files)(default)            Run Stage 1 then Stage 2 for each caseParallelization (for Stage 2, or Stage 1 on Linux):--fopenmp [N]        Enable OpenMP with N threads (default: 8, Linux only)--mpi [N]            Enable MPI with N cores (default: 2, Stage 2 only)Other Options:-n, --dry-run        Show parameter combinations without running-v, --verbose        Verbose output-c, --compile-only   Compile only, don't run simulations-h, --help           Show this help messageParameter sweep file (default):\\$0 sweep.paramsIf no sweep file specified, uses sweep.params from current directory.Sweep file format:BASE_CONFIG=default.paramsCASE_START=1000CASE_END=1005SWEEP_De=0.1,0.5,1.0SWEEP_Oh=0.01,0.02CaseNo auto-increments from CASE_START for each parameter combination.Examples:# Run sweep (Stage 1 + Stage 2 per case, serial)\\$0# Dry run to see parameter combinations\\$0 --dry-run# Run only Stage 1 for all cases (generate restart files)\\$0 --stage1-only# Run only Stage 2 with MPI (assumes restart files exist)\\$0 --stage2-only --mpi 8# Run full sweep with OpenMP (Linux)\\$0 --fopenmp 4# Run custom sweep file\\$0 custom_sweep.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================DRY_RUN=0VERBOSE=0COMPILE_ONLY=0STAGE1_ONLY=0STAGE2_ONLY=0FOPENMP_ENABLED=0FOPENMP_THREADS=8MPI_ENABLED=0MPI_CORES=2while[[\\$#-gt0]];docase\\$1in-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-c|--compile-only)COMPILE_ONLY=1shift;;--stage1-only)STAGE1_ONLY=1shift;;--stage2-only)STAGE2_ONLY=1shift;;--fopenmp)FOPENMP_ENABLED=1# Check if next arg is a number (optional thread count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenFOPENMP_THREADS=\"\\$2\"shiftfishift;;--mpi)MPI_ENABLED=1# Check if next arg is a number (optional core count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenMPI_CORES=\"\\$2\"shiftfishift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Validation# ============================================================# Check mutually exclusive stage flagsif[\\$STAGE1_ONLY-eq1]&&[\\$STAGE2_ONLY-eq1];thenecho\"ERROR: Cannot use both --stage1-only and --stage2-only\">&2exit1fi# Check --mpi only with stage2if[\\$MPI_ENABLED-eq1]&&[\\$STAGE1_ONLY-eq1];thenecho\"ERROR: --mpi is only valid for Stage 2 (use --stage2-only or default both-stages mode)\">&2exit1fi# Check --mpi and --fopenmp are mutually exclusiveif[\\$MPI_ENABLED-eq1]&&[\\$FOPENMP_ENABLED-eq1];thenecho\"ERROR: --mpi and --fopenmp are mutually exclusive\">&2exit1fi# ============================================================# Determine Sweep File# ============================================================SWEEP_FILE=\"\\${1:-sweep.params}\"if[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"=========================================\"echo\"Viscoelastic Bubble Bursting - Parameter Sweep\"echo\"=========================================\"echo\"Sweep file:\\$SWEEP_FILE\"[\\$DRY_RUN-eq1]&&echo\"Mode: Dry run (no execution)\"if[\\$STAGE1_ONLY-eq1];thenecho\"Stages: Stage 1 only (generate restart files)\"elif[\\$STAGE2_ONLY-eq1];thenecho\"Stages: Stage 2 only (full simulation)\"elseecho\"Stages: Stage 1 + Stage 2 per case\"fiif[\\$MPI_ENABLED-eq1];thenecho\"Parallelization: MPI (\\$MPI_CORES cores)\"elif[\\$FOPENMP_ENABLED-eq1];thenecho\"Parallelization: OpenMP (\\$FOPENMP_THREADS threads)\"elseecho\"Parallelization: Serial\"fiecho\"\"# ============================================================# Parse Sweep Configuration# ============================================================# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================# Create temporary directory for generated parameter filesTEMP_DIR=\\$(mktemp-d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i.bak\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i.bak\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"done((++COMBINATION_COUNT))# Print summaryif[\\$DRY_RUN-eq1]||[\\$VERBOSE-eq1];thenecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"fi((CASE_NUM++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\\${current_values[@]+\"\\${current_values[@]}\"}\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# Exit if dry runif[\\$DRY_RUN-eq1];thenecho\"Dry run complete.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "No simulations executed.\"exit0fi# ============================================================# Run Simulations# ============================================================echo\"=========================================\"echo\"Running Simulations\"echo\"=========================================\"# Build list of parameter filesPARAM_FILES=()forcase_filein\"\\$TEMP_DIR\"/case_*.params;doPARAM_FILES+=(\"\\$case_file\")done# Build common flagsCOMMON_FLAGS=\"\"if[\\$COMPILE_ONLY-eq1];thenCOMMON_FLAGS=\"\\$COMMON_FLAGS --compile-only\"fiif[\\$VERBOSE-eq1];thenCOMMON_FLAGS=\"\\$COMMON_FLAGS --verbose\"fi# Build parallelization flagsPARALLEL_FLAGS=\"\"if[\\$MPI_ENABLED-eq1];thenPARALLEL_FLAGS=\"--mpi\\$MPI_CORES\"elif[\\$FOPENMP_ENABLED-eq1];thenPARALLEL_FLAGS=\"--fopenmp\\$FOPENMP_THREADS\"fi# Run simulationsecho\"Running\\$COMBINATION_COUNT simulations sequentially\"echo\"\"forparam_filein\"\\${PARAM_FILES[@]}\";docase_no=\\$(grep\"^CaseNo=\"\"\\$param_file\"|cut-d'='-f2)echo\"-----------------------------------------\"echo\"Processing Case\\$case_no\"echo\"-----------------------------------------\"if[\\$STAGE1_ONLY-eq1];then# Stage 1 onlyecho\"Running Stage 1...\"./runSimulation.sh--stage1\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"elif[\\$STAGE2_ONLY-eq1];then# Stage 2 onlyecho\"Running Stage 2...\"./runSimulation.sh--stage2\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"else# Both stages: Stage 1 then Stage 2echo\"Running Stage 1...\"./runSimulation.sh--stage1\\$COMMON_FLAGS\"\\$param_file\"echo\"\"echo\"Running Stage 2...\"./runSimulation.sh--stage2\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"fiecho\"\"doneecho\"=========================================\"echo\"Parameter Sweep Complete\"echo\"=========================================\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Case range:\\$CASE_START to\\$((CASE_START + COMBINATION_COUNT - 1))\"echo\"Output location: simulationCases/\"echo\"\"",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Viscoelastic Worthington Jets...",
    "content": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles This repository contains the simulation code and analysis for studying the dynamics of viscoelastic Worthington jets and droplets produced by bursting bubbles. The code uses the ElastoFlow framework to simulate bubble cavity collapse in viscoelastic media, examining how elastic modulus and relaxation time affect jet and droplet formation. The article can be found at: Overview The project investigates how viscoelasticity influences bubble bursting dynamics by exploring the three-dimensional phase space of solvent Ohnesorge number, elastocapillary number, and Deborah number using volume of fluid-based finite volume simulations. The results demonstrate that polymer addition significantly influences the overall dynamics through the interplay of viscous and elastic effects.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Repository Structure basilisk/src/...",
    "content": "Repository Structure basilisk/src/ - # Core Basilisk CFD library (reference only, do not modify) src-local/ - # Custom viscoelastic solvers and tensor utilities log-conform-viscoelastic-scalar-3D.h - # 3D log-conformation (scalar) log-conform-viscoelastic-scalar-2D.h - # 2D/axi log-conformation (scalar) log-conform-viscoelastic.h - # 2D/axi log-conformation (tensor) two-phaseVE.h - # Two-phase viscoelastic extension eigen_decomposition.h - # 3x3 symmetric eigenvalue solver simulationCases/ - # Example/test cases and post-processing scripts burstingBubbleVE.c - # Bursting bubble simulation postProcess/ - # Project-specific post-processing tools and utilities getData-elastic-scalar2D.c - # Data extraction utility getFacet2D.c - # Facet extraction utility VideoAxi.py - # Python visualization script Installation and Setup To ensure you have the necessary tools and a fresh Basilisk installation, use the provided script: ./reset_install_requirements.sh Function This script checks for Basilisk installation and compiles it if not present.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: OS Compatibility Designed...",
    "content": "OS Compatibility Designed for macOS. If you encounter issues on Linux, consider opening a GitHub issue. Dependencies Basilisk C is fetched and built automatically. Xcode Command Line Tools (macOS) or equivalent compiler toolchain (Linux) are required. Environment Setup After running the script, a .project_config file is created, setting BASILISK and PATH automatically.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "If you have previously installed Basilisk or changed dependencies, re-run the script with --hard : ./reset_install_requirements.sh --hard Running the Code Recommended Method: Using Makefile The easiest way to compile and run the code is using the Makefile approach: Navigate to the testCases directory: cd testCases Compile and run using make: CFLAGS = -DDISPLAY=-1 make burstingBubbleVE.tst Alternative Method: Direct Compilation You can compile the code directly using qcc in two ways: Using include paths (recommended): qcc -O2 -Wall -disable-dimensions -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm Without include paths: qcc -O2 -Wall -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm Note : If using method 2, you must first manually copy the src-local folder to your running directory.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Local Execution MacOS:...",
    "content": "Local Execution MacOS: # First source the configuration source .project_config # Compile using include paths (recommended) qcc -O2 -Wall -disable-dimensions -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm # Or compile without include paths (requires manually copying src-local folder) qcc -O2 -Wall -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm # Run the executable, only supports serial execution ./burstingBubbleVE Linux: # First source the configuration source .project_config # Compile using include paths (recommended) qcc -O2 -Wall -disable-dimensions -fopenmp -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm # Or compile without include paths (requires manually copying src-local folder) qcc -O2 -Wall -disable-dimensions -fopenmp burstingBubbleVE.c -o burstingBubbleVE -lm # Set the number of OpenMP threads export OMP_NUM_THREADS = 4 # Run the executable ./burstingBubbleVE HPC Cluster Execution (e.g., Snellius) For cluster environments, it is strongly recommended to manually copy the src-local folder to your working directory to ensure reliable compilation across different cluster configurations: First, copy the required files: cp -r /path/to/original/src-local .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compile the code...",
    "content": "Compile the code for MPI: CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm Create a SLURM job script (e.g., run_simulation.sh ): #!/bin/bash #SBATCH --nodes=1 #SBATCH --ntasks=32 #SBATCH --time=1:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=v.sanjay@utwente.nl srun --mpi = pmi2 -n 32 --gres = cpu:32 --mem-per-cpu = 1750mb burstingBubbleVE Submit the job: sbatch run_simulation.sh Additional Running Scripts The z_extras/running directory contains supplementary materials and post-processing tools used in the analysis. This includes C-based data extraction utilities, Python visualization scripts, and analysis notebooks. These tools were used to process simulation outputs and generate figures for the study. For detailed documentation of these tools, see the README in the z_extras directory.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Reset Install Requirements...",
    "content": "Reset Install Requirements Script The reset_install_requirements.sh script is designed to reset the installation requirements for the project. This can be useful when you want to ensure that all dependencies are fresh and up-to-date. Purpose The script re-installs all required packages as specified in the requirements file, ensuring that the project\u2019s dependencies are up-to-date and consistent. Usage To run the script, use the following command in your terminal: bash reset_install_requirements.sh Make sure to have the necessary permissions to execute the script. Citation If you use this code in your research, please cite: Paper @article { Dixit_Oratis_Zinelis_Lohse_Sanjay_2025 , title ={Viscoelastic Worthington jets and droplets produced by bursting bubbles}, volume ={1010}, journal ={J. Fluid Mech.}, author ={Dixit, A.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "K. and Oratis, A. and Zinelis, K. and Lohse, D. and Sanjay, V.}, year ={2025}, pages ={A2}, DOI ={10.1017/jfm.2025.237}} Software @software{vatsal_sanjay_2024_14210635, author = {Vatsal Sanjay}, title = {{comphy-lab/Viscoelastic3D: \ud83c\udf0a v2.5: ElastoFlow - Complete 2D/3D Viscoelastic Framework}}, month = nov, year = 2024, publisher = {Zenodo}, version = {v2.5}, doi = {10.5281/zenodo.14210635}, url = {https://doi.org/10.5281/zenodo.14210635} } Features Simulation of bubble cavity collapse in viscoelastic media Analysis of Worthington jet formation and droplet ejection Investigation of polymer effects through: Elastic modulus (elastocapillary number) Relaxation time (Deborah number) Viscous effects (Ohnesorge number) Dependencies The code utilizes: - Basilisk C ( basilliskpopinet ) - Volume of Fluid (VoF) method for interface tracking - Adaptive Mesh Refinement (AMR) with quadtree grids Key Results The simulations reveal: 1.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "Three distinct flow regimes: - Jets forming droplets - Jets without droplet formation - Absence of jet formation 2. Impact of viscoelasticity on: - Capillary wave propagation - Jet elongation and retraction - Droplet formation and size Additional Resources The z_extras directory contains supplementary materials and post-processing tools used in the analysis. This includes C-based data extraction utilities, Python visualization scripts, and analysis notebooks. These tools were used to process simulation outputs and generate figures for the study. For detailed documentation of these tools, see the README in the z_extras directory. Authors Ayush K.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Dixit (University of...",
    "content": "Dixit (University of Twente), a.k.dixit@utwente.nl Alexandros Oratis (University of Twente, now TU Delft), a.t.oratis@tudelft.nl Konstantinos Zinelis (Imperial College London, now MIT), zinelis@mit.edu Detlef Lohse (University of Twente & Max Planck Institute), d.lohse@utwente.nl Vatsal Sanjay (University of Twente), vatsalsanjay@gmail.com License This project is licensed under standard academic terms. Please cite the paper and software if you use this code in your research.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Generated Documentation Root...",
    "content": "Generated Documentation Root Directory reset_install_requirements-no-darcs-no-git.sh reset_install_requirements-no-darcs.sh reset_install_requirements.sh runCodesInParallel.sh runParameterSweep.sh runPostProcess-Ncases.sh runSimulation.sh postProcess postProcess/Video.py postProcess/getData.c postProcess/getFacet.c simulationCases simulationCases/1000/burstingBubbleVE.c simulationCases/Makefile simulationCases/burstingBubbleVE.c simulationCases/runCodesInParallel.sh src-local src-local/eigen_decomposition.h src-local/log-conform-elastoviscoplastic-scalar-2D.h src-local/log-conform-elastoviscoplastic-scalar-3D.h src-local/log-conform-elastoviscoplastic.h src-local/log-conform-viscoelastic-scalar-2D.h src-local/log-conform-viscoelastic-scalar-3D.h src-local/log-conform-viscoelastic.h src-local/parse_params.sh src-local/two-phaseEVP.h src-local/two-phaseVE.h",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "qcc-O2-Wall-disable-dimensions-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "qcc-O2-Wall-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# First source the configurationsource.project_config# Compile using include paths (recommended)qcc-O2-Wall-disable-dimensions-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm# Or compile without include paths (requires manually copying src-local folder)qcc-O2-Wall-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm# Run the executable, only supports serial execution./burstingBubbleVE",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# First source the configurationsource.project_config# Compile using include paths (recommended)qcc-O2-Wall-disable-dimensions-fopenmp-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm# Or compile without include paths (requires manually copying src-local folder)qcc-O2-Wall-disable-dimensions-fopenmpburstingBubbleVE.c-oburstingBubbleVE-lm# Set the number of OpenMP threadsexportOMP_NUM_THREADS=4# Run the executable./burstingBubbleVE",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "CC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#!/bin/bash#SBATCH --nodes=1#SBATCH --ntasks=32#SBATCH --time=1:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=v.sanjay@utwente.nlsrun--mpi=pmi2-n32--gres=cpu:32--mem-per-cpu=1750mb burstingBubbleVE",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "@article{Dixit_Oratis_Zinelis_Lohse_Sanjay_2025,title={Viscoelastic Worthington jets and droplets produced by bursting bubbles},volume={1010},journal={J. Fluid Mech.},author={Dixit, A. K. and Oratis, A. and Zinelis, K. and Lohse, D. and Sanjay, V.},year={2025},pages={A2},DOI={10.1017/jfm.2025.237}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "@software{vatsal_sanjay_2024_14210635,author       = {Vatsal Sanjay},title        = {{comphy-lab/Viscoelastic3D: \ud83c\udf0a v2.5: ElastoFlow -Complete 2D/3D Viscoelastic Framework}},month        = nov,year         = 2024,publisher    = {Zenodo},version      = {v2.5},doi          = {10.5281/zenodo.14210635},url          = {https://doi.org/10.5281/zenodo.14210635}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements-no-darcs-no-git.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "reset_install_requirements-no-darcs-no-git.sh See raw file reset_install_requirements-no-darcs-no-git.sh #!/bin/bash # Linux/macOS version - uses wget and tar instead of darcs # Based on https://basilisk.fr/src/INSTALL # Ensures that we are always using the latest version of basilisk from basilisk.fr # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to check prerequisites check_prerequisites() { local missing_tools = () local found_tools = () echo \"Checking prerequisites...\" echo \"\" # Check for make if ! command -v make > /dev/null 2 >& 1 ; then missing_tools += ( \"make\" ) else found_tools += ( \"make\" ) printf \"\\033[0;32m\u2713 make is installed\\033[0m\\n\" fi # Check for gawk if ! command -v gawk > /dev/null 2 >& 1 ; then missing_tools += ( \"gawk\" ) else found_tools += ( \"gawk\" ) printf \"\\033[0;32m\u2713 gawk is installed\\033[0m\\n\" fi # Check for wget if ! command -v wget > /dev/null 2 >& 1 ; then missing_tools += ( \"wget\" ) else found_tools += ( \"wget\" ) printf \"\\033[0;32m\u2713 wget is installed\\033[0m\\n\" fi # Check for curl (needed for applying patches on macOS) if ! command -v curl > /dev/null 2 >& 1 ; then if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then missing_tools += ( \"curl\" ) fi else found_tools += ( \"curl\" ) printf \"\\033[0;32m\u2713 curl is installed\\033[0m\\n\" fi # Check for tar if ! command -v tar > /dev/null 2 >& 1 ; then missing_tools += ( \"tar\" ) else found_tools += ( \"tar\" ) printf \"\\033[0;32m\u2713 tar is installed\\033[0m\\n\" fi # Check for gcc if ! command -v gcc > /dev/null 2 >& 1 ; then missing_tools += ( \"gcc\" ) else found_tools += ( \"gcc\" ) printf \"\\033[0;32m\u2713 gcc is installed\\033[0m\\n\" fi echo \"\" if [[ \\$ {#missing_tools[@]} -gt 0 ]]; then printf \"\\033[0;31mError: Missing required tools: \\$ {missing_tools[*]}\\033[0m\\n\" echo \"\" if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then # macOS installation instructions echo \"To install missing tools on macOS:\" echo \" xcode-select --install\" echo \" brew install gawk wget\" else # Linux installation instructions echo \"To install missing tools on Linux:\" echo \" sudo apt install \\$ {missing_tools[*]}\" fi echo \"\" echo \"Please install the missing tools and try again.\" exit 1 else printf \"\\033[0;32m\u2705 All prerequisites are satisfied!\\033[0m\\n\" echo \"\" fi } # Function to apply comphy-lab patches (macOS only) apply_patches() { local target_dir = \" \\$ 1\" if [[ \" \\$ OSTYPE\" != \"darwin\" * ]]; then # Patches are macOS-specific, skip on other platforms return 0 fi printf \"\\033[0;36mApplying comphy-lab patches...\\033[0m\\n\" # Create temp directory for patches mkdir -p \" \\$ target_dir/.patches_temp\" # GitHub URLs for patches local PATCHES_URL = \"https://api.github.com/repos/comphy-lab/basilisk-C/contents/patches\" local RAW_BASE_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/patches\" # Get list of patch files (sorted by name for chronological order due to YYYY-MM-DD format) local PATCH_FILES PATCH_FILES = \\$ ( curl -s \" \\$ PATCHES_URL\" | grep -o '\"name\": \"[^\"]*\\.patch\"' | sed 's/\"name\": \"//;s/\"//' | sort ) if [[ -z \" \\$ PATCH_FILES\" ]]; then printf \"\\033[0;33mWarning: No patches found or unable to fetch patch list\\033[0m\\n\" else # Download and apply each patch echo \" \\$ PATCH_FILES\" | while read -r patch_file ; do if [[ -n \" \\$ patch_file\" ]]; then echo \" Downloading \\$ patch_file...\" if curl -s -f \" \\$ RAW_BASE_URL/ \\$ patch_file\" -o \" \\$ target_dir/.patches_temp/ \\$ patch_file\" ; then echo \" Applying \\$ patch_file...\" if ( cd \" \\$ target_dir\" && patch -p1 < \".patches_temp/ \\$ patch_file\" ); then printf \" \\033[0;32m\u2713 Successfully applied \\$ patch_file\\033[0m\\n\" else printf \" \\033[0;31m\u2717 Failed to apply \\$ patch_file\\033[0m\\n\" fi else printf \" \\033[0;31m\u2717 Failed to download \\$ patch_file\\033[0m\\n\" fi fi done fi # Clean up rm -rf \" \\$ target_dir/.patches_temp\" echo \"\" } # Function to install basilisk using wget install_basilisk() { printf \"\\033[0;36mDownloading basilisk using wget...\\033[0m\\n\" wget https://basilisk.fr/basilisk/basilisk.tar.gz if [[ \\$ ? -ne 0 ]]; then printf \"\\033[0;31mError: Failed to download basilisk.tar.gz\\033[0m\\n\" exit 1 fi printf \"\\033[0;36mExtracting basilisk.tar.gz...\\033[0m\\n\" tar xzf basilisk.tar.gz if [[ \\$ ? -ne 0 ]]; then printf \"\\033[0;31mError: Failed to extract basilisk.tar.gz\\033[0m\\n\" exit 1 fi # Clean up the tar file rm basilisk.tar.gz # Apply comphy-lab patches (macOS only) apply_patches \"basilisk\" cd basilisk/src || { printf \"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\" >& 2 ; exit 1 ; } if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then printf \"\\033[0;36mUsing macOS configuration...\\033[0m\\n\" ln -s config.osx config else printf \"\\033[0;36mUsing Linux configuration...\\033[0m\\n\" ln -s config.gcc config fi printf \"\\033[0;36mBuilding basilisk (first pass with -k to continue on errors)...\\033[0m\\n\" make -k printf \"\\033[0;36mBuilding basilisk (final build)...\\033[0m\\n\" make } # Check prerequisites first check_prerequisites # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then printf \"\\033[0;36mInstalling basilisk...\\033[0m\\n\" rm -rf basilisk install_basilisk else printf \"\\033[0;36mUsing existing basilisk installation...\\033[0m\\n\" cd basilisk/src || { printf \"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\" >& 2 ; exit 1 ; } fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\" printf \"\\033[0;36mChecking qcc installation...\\033[0m\\n\" if ! qcc --version > /dev/null 2 >& 1 ; then printf \"\\033[0;31mError: qcc is not working properly.\\033[0m\\n\" if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" else echo \"Please ensure you have build-essential installed.\" echo \"You can install it by running: sudo apt install build-essential\" fi echo \"For more details, visit: https://basilisk.fr/src/INSTALL\" exit 1 else printf \"\\033[0;32m\u2705 qcc is properly installed.\\033[0m\\n\" qcc --version fi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements-no-darcs-no-git.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements-no-darcs-no-git.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: #!/bin/bash# Linux/macOS version...",
    "content": "#!/bin/bash# Linux/macOS version - uses wget and tar instead of darcs# Based on https://basilisk.fr/src/INSTALL# Ensures that we are always using the latest version of basilisk from basilisk.fr# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to check prerequisitescheck_prerequisites(){localmissing_tools=()localfound_tools=()echo\"Checking prerequisites...\"echo\"\"# Check for makeif!command-vmake>/dev/null2>&1;thenmissing_tools+=(\"make\")elsefound_tools+=(\"make\")printf\"\\033[0;32m\u2713 make is installed\\033[0m\\n\"fi# Check for gawkif!command-vgawk>/dev/null2>&1;thenmissing_tools+=(\"gawk\")elsefound_tools+=(\"gawk\")printf\"\\033[0;32m\u2713 gawk is installed\\033[0m\\n\"fi# Check for wgetif!command-vwget>/dev/null2>&1;thenmissing_tools+=(\"wget\")elsefound_tools+=(\"wget\")printf\"\\033[0;32m\u2713 wget is installed\\033[0m\\n\"fi# Check for curl (needed for applying patches on macOS)if!command-vcurl>/dev/null2>&1;thenif[[\"\\$OSTYPE\"==\"darwin\"*]];thenmissing_tools+=(\"curl\")fielsefound_tools+=(\"curl\")printf\"\\033[0;32m\u2713 curl is installed\\033[0m\\n\"fi# Check for tarif!command-vtar>/dev/null2>&1;thenmissing_tools+=(\"tar\")elsefound_tools+=(\"tar\")printf\"\\033[0;32m\u2713 tar is installed\\033[0m\\n\"fi# Check for gccif!command-vgcc>/dev/null2>&1;thenmissing_tools+=(\"gcc\")elsefound_tools+=(\"gcc\")printf\"\\033[0;32m\u2713 gcc is installed\\033[0m\\n\"fiecho\"\"if[[\\${#missing_tools[@]}-gt0]];thenprintf\"\\033[0;31mError: Missing required tools:\\${missing_tools[*]}\\033[0m\\n\"echo\"\"if[[\"\\$OSTYPE\"==\"darwin\"*]];then# macOS installation instructionsecho\"To install missing tools on macOS:\"echo\"  xcode-select --install\"echo\"  brew install gawk wget\"else# Linux installation instructionsecho\"To install missing tools on Linux:\"echo\"  sudo apt install\\${missing_tools[*]}\"fiecho\"\"echo\"Please install the missing tools and try again.\"exit1elseprintf\"\\033[0;32m\u2705 All prerequisites are satisfied!\\033[0m\\n\"echo\"\"fi}# Function to apply comphy-lab patches (macOS only)apply_patches(){localtarget_dir=\"\\$1\"if[[\"\\$OSTYPE\"!=\"darwin\"*]];then# Patches are macOS-specific, skip on other platformsreturn0fiprintf\"\\033[0;36mApplying comphy-lab patches...\\033[0m\\n\"# Create temp directory for patchesmkdir-p\"\\$target_dir/.patches_temp\"# GitHub URLs for patcheslocalPATCHES_URL=\"https://api.github.com/repos/comphy-lab/basilisk-C/contents/patches\"localRAW_BASE_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/patches\"# Get list of patch files (sorted by name for chronological order due to YYYY-MM-DD format)localPATCH_FILESPATCH_FILES=\\$(curl-s\"\\$PATCHES_URL\"|grep-o'\"name\": \"[^\"]*\\.patch\"'|sed's/\"name\": \"//;s/\"//'|sort)if[[-z\"\\$PATCH_FILES\"]];thenprintf\"\\033[0;33mWarning: No patches found or unable to fetch patch list\\033[0m\\n\"else# Download and apply each patchecho\"\\$PATCH_FILES\"|whileread-rpatch_file;doif[[-n\"\\$patch_file\"]];thenecho\"  Downloading\\$patch_file...\"ifcurl-s-f\"\\$RAW_BASE_URL/\\$patch_file\"-o\"\\$target_dir/.patches_temp/\\$patch_file\";thenecho\"  Applying\\$patch_file...\"if(cd\"\\$target_dir\"&&patch-p1<\".patches_temp/\\$patch_file\");thenprintf\"  \\033[0;32m\u2713 Successfully applied\\$patch_file\\033[0m\\n\"elseprintf\"  \\033[0;31m\u2717 Failed to apply\\$patch_file\\033[0m\\n\"fielseprintf\"  \\033[0;31m\u2717 Failed to download\\$patch_file\\033[0m\\n\"fifidonefi# Clean uprm-rf\"\\$target_dir/.patches_temp\"echo\"\"}# Function to install basilisk using wgetinstall_basilisk(){printf\"\\033[0;36mDownloading basilisk using wget...\\033[0m\\n\"wgethttps://basilisk.fr/basilisk/basilisk.tar.gzif[[\\$?-ne0]];thenprintf\"\\033[0;31mError: Failed to download basilisk.tar.gz\\033[0m\\n\"exit1fiprintf\"\\033[0;36mExtracting basilisk.tar.gz...\\033[0m\\n\"tarxzf basilisk.tar.gzif[[\\$?-ne0]];thenprintf\"\\033[0;31mError: Failed to extract basilisk.tar.gz\\033[0m\\n\"exit1fi# Clean up the tar filermbasilisk.tar.gz# Apply comphy-lab patches (macOS only)apply_patches\"basilisk\"cdbasilisk/src||{printf\"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\">&2;exit1;}if[[\"\\$OSTYPE\"==\"darwin\"*]];thenprintf\"\\033[0;36mUsing macOS configuration...\\033[0m\\n\"ln-sconfig.osx configelseprintf\"\\033[0;36mUsing Linux configuration...\\033[0m\\n\"ln-sconfig.gcc configfiprintf\"\\033[0;36mBuilding basilisk (first pass with -k to continue on errors)...\\033[0m\\n\"make-kprintf\"\\033[0;36mBuilding basilisk (final build)...\\033[0m\\n\"make}# Check prerequisites firstcheck_prerequisites# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenprintf\"\\033[0;36mInstalling basilisk...\\033[0m\\n\"rm-rfbasiliskinstall_basiliskelseprintf\"\\033[0;36mUsing existing basilisk installation...\\033[0m\\n\"cdbasilisk/src||{printf\"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\">&2;exit1;}fi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\"printf\"\\033[0;36mChecking qcc installation...\\033[0m\\n\"if!qcc--version>/dev/null2>&1;thenprintf\"\\033[0;31mError: qcc is not working properly.\\033[0m\\n\"if[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"elseecho\"Please ensure you have build-essential installed.\"echo\"You can install it by running: sudo apt install build-essential\"fiecho\"For more details, visit: https://basilisk.fr/src/INSTALL\"exit1elseprintf\"\\033[0;32m\u2705 qcc is properly installed.\\033[0m\\n\"qcc--versionfi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements-no-darcs-no-git.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "runSimulation.sh See raw file runSimulation.sh #!/bin/bash # runSimulation.sh - Run single viscoelastic bubble bursting simulation from root directory # Creates case folder in simulationCases/<CaseNo>/ and runs simulation there # # IMPORTANT: This script uses TWO-STAGE EXECUTION because distance.h is # incompatible with MPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Run Stage 1...",
    "content": "Run Stage 1 first to generate the restart file, # then run Stage 2 for the full simulation. set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source project configuration if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" else echo \"ERROR: .project_config not found\" >& 2 exit 1 fi # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [params_file] Run single viscoelastic bubble bursting simulation from root directory.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Creates case folder...",
    "content": "Creates case folder in simulationCases/<CaseNo>/ based on parameter file. This script uses TWO-STAGE EXECUTION: Stage 1: Generate restart file (distance.h incompatible with MPI) Stage 2: Full simulation from restart file Stage Selection (mutually exclusive): (default) Run both Stage 1 + Stage 2 --stage1 Run Stage 1 only (generate restart file) --stage2 Run Stage 2 only (full simulation from restart) Parallelization: --fopenmp [N] Enable OpenMP with N threads (default: 8) Stage 1: Linux only (macOS always serial) Stage 2: Linux only (macOS runs serial with warning) --mpi [N] Enable MPI with N cores (default: 2, Stage 2 only) Other Options: -c, --compile-only Compile but don't run simulation -d, --debug Compile with debug flags (-g -DTRASH=1) -v, --verbose Verbose output -h, --help Show this help message Parameter file mode (default): \\$ 0 default.params If no parameter file specified, uses default.params from current directory.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "Environment variables: QCC_FLAGS Additional qcc compiler flags Examples: # Run both stages (default) \\$ 0 default.params # Serial, Stage 1 + 2 \\$ 0 --mpi 8 default.params # Stage 1 serial, Stage 2 MPI # Stage 1 only: Generate restart file \\$ 0 --stage1 default.params # Serial \\$ 0 --stage1 --fopenmp default.params # OpenMP (Linux only) # Stage 2 only: Full simulation (requires existing restart) \\$ 0 --stage2 default.params # Serial \\$ 0 --stage2 --mpi 8 default.params # MPI, 8 cores # Compile only (check for errors) \\$ 0 --compile-only default.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ COMPILE_ONLY = 0 DEBUG_FLAGS = \"\" VERBOSE = 0 STAGE = 0 # Default to both stages (0 = both, 1 = stage1, 2 = stage2) FOPENMP_ENABLED = 0 FOPENMP_THREADS = 8 # Default thread count MPI_ENABLED = 0 MPI_CORES = 2 # Default core count STAGE_EXPLICITLY_SET = 0 QCC_FLAGS = \" \\$ {QCC_FLAGS:-}\" while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -c | --compile-only ) COMPILE_ONLY = 1 shift ;; -d | --debug ) DEBUG_FLAGS = \"-g -DTRASH=1\" shift ;; --stage1 ) if [ \\$ STAGE_EXPLICITLY_SET -eq 1 ] && [ \\$ STAGE -ne 1 ] ; then echo \"ERROR: Cannot use both --stage1 and --stage2\" >& 2 exit 1 fi STAGE = 1 STAGE_EXPLICITLY_SET = 1 shift ;; --stage2 ) if [ \\$ STAGE_EXPLICITLY_SET -eq 1 ] && [ \\$ STAGE -ne 2 ] ; then echo \"ERROR: Cannot use both --stage1 and --stage2\" >& 2 exit 1 fi STAGE = 2 STAGE_EXPLICITLY_SET = 1 shift ;; --fopenmp ) FOPENMP_ENABLED = 1 # Check if next arg is a number (optional thread count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then FOPENMP_THREADS = \" \\$ 2\" shift fi shift ;; --mpi ) MPI_ENABLED = 1 # Check if next arg is a number (optional core count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then MPI_CORES = \" \\$ 2\" shift fi shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Detect OS # ============================================================ OS_TYPE = \\$ ( uname -s ) # ============================================================ # Validation # ============================================================ # Check --mpi only valid with stage2 (not stage1-only) if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE -eq 1 ] ; then echo \"ERROR: --mpi is only valid with --stage2 (Stage 1 cannot use MPI due to distance.h)\" >& 2 exit 1 fi # For both-stages mode with MPI, MPI only applies to Stage 2 if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE -eq 0 ] ; then echo \"Note: MPI will be used for Stage 2 only (Stage 1 runs serial)\" fi # Check --mpi and --fopenmp are mutually exclusive if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"ERROR: --mpi and --fopenmp are mutually exclusive\" >& 2 exit 1 fi # Check --fopenmp on macOS if [ \" \\$ OS_TYPE\" = \"Darwin\" ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then if [ \\$ STAGE -eq 1 ] ; then echo \"ERROR: --fopenmp not supported on macOS for Stage 1 (always runs serial)\" >& 2 exit 1 else echo \"WARNING: OpenMP not available on macOS, Stage 2 will run serial\" >& 2 FOPENMP_ENABLED = 0 fi fi # Verify MPI tools if MPI is enabled if [ \\$ MPI_ENABLED -eq 1 ] ; then if ! command -v mpicc &> /dev/null ; then echo \"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi if ! command -v mpirun &> /dev/null ; then echo \"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi fi # ============================================================ # Determine Parameter File # ============================================================ PARAM_FILE = \" \\$ {1:-default.params}\" if [ ! -f \" \\$ PARAM_FILE\" ] ; then echo \"ERROR: Parameter file not found: \\$ PARAM_FILE\" >& 2 exit 1 fi [ \\$ VERBOSE -eq 1 ] && echo \"Parameter file: \\$ PARAM_FILE\" # ============================================================ # Parse Parameters # ============================================================ parse_param_file \" \\$ PARAM_FILE\" CASE_NO = \\$ ( get_param \"CaseNo\" ) De = \\$ ( get_param \"De\" \"0.1\" ) Ec = \\$ ( get_param \"Ec\" \"0.01\" ) Oh = \\$ ( get_param \"Oh\" \"1e-2\" ) Bond = \\$ ( get_param \"Bond\" \"1e-3\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"1.0\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in parameter file\" >& 2 exit 1 fi # Validate CaseNo is 4 digits if ! [[ \" \\$ CASE_NO\" =~ ^ [ 0 - 9 ] { 4 } \\$ ]] || [ \" \\$ CASE_NO\" -lt 1000 ] || [ \" \\$ CASE_NO\" -gt 9999 ] ; then echo \"ERROR: CaseNo must be 4-digit (1000-9999), got: \\$ CASE_NO\" >& 2 exit 1 fi CASE_DIR = \"simulationCases/ \\$ {CASE_NO}\" # ============================================================ # Display Configuration # ============================================================ echo \"=========================================\" echo \"Viscoelastic Bubble Bursting Simulation\" echo \"=========================================\" echo \"Case Number: \\$ CASE_NO\" echo \"Case Directory: \\$ CASE_DIR\" echo \"Parameter File: \\$ PARAM_FILE\" echo \"\" echo \"Physical Parameters:\" echo \" De= \\$ De, Ec= \\$ Ec, Oh= \\$ Oh, Bond= \\$ Bond\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ tmax\" echo \"\" if [ \\$ STAGE -eq 0 ] ; then echo \"Stage: Both (Stage 1 + Stage 2)\" elif [ \\$ STAGE -eq 1 ] ; then echo \"Stage: 1 only (generate restart)\" else echo \"Stage: 2 only (full simulation)\" fi if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Parallelization: MPI ( \\$ MPI_CORES cores)\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Parallelization: OpenMP ( \\$ FOPENMP_THREADS threads)\" else echo \"Parallelization: Serial\" fi echo \"\" # ============================================================ # Create Case Directory # ============================================================ if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"Creating case directory: \\$ CASE_DIR\" mkdir -p \" \\$ CASE_DIR\" else echo \"Case directory exists\" fi # Copy parameter file to case directory for record keeping cp \" \\$ PARAM_FILE\" \" \\$ CASE_DIR/case.params\" # Change to case directory cd \" \\$ CASE_DIR\" [ \\$ VERBOSE -eq 1 ] && echo \"Working directory: \\$ (pwd)\" # ============================================================ # Source File Setup # ============================================================ SRC_FILE_ORIG = \"../burstingBubbleVE.c\" SRC_FILE_LOCAL = \"burstingBubbleVE.c\" EXECUTABLE = \"burstingBubbleVE\" # Check if source file exists if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 exit 1 fi # Copy source file to case directory cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Copied source file to case directory\" # Copy Bond-specific geometry file if exists # Format Bond as 4 decimal places (e.g., 1e-3 -> 0.0010) BOND_FORMATTED = \\$ ( printf \"%.4f\" \" \\$ Bond\" ) BOND_FILE = \"../DataFiles/Bo \\$ {BOND_FORMATTED}.dat\" if [ -f \" \\$ BOND_FILE\" ] ; then cp \" \\$ BOND_FILE\" . echo \"Copied geometry file Bo \\$ {BOND_FORMATTED}.dat\" else # Try alternate location (one level up from case dir) BOND_FILE_ALT = \"../Bo \\$ {BOND_FORMATTED}.dat\" if [ -f \" \\$ BOND_FILE_ALT\" ] ; then cp \" \\$ BOND_FILE_ALT\" . echo \"Copied geometry file Bo \\$ {BOND_FORMATTED}.dat\" else echo \"WARNING: Geometry file Bo \\$ {BOND_FORMATTED}.dat not found\" >& 2 echo \" Checked: \\$ BOND_FILE and \\$ BOND_FILE_ALT\" >& 2 echo \" Simulation may fail during initialization\" >& 2 fi fi # ============================================================ # Stage 1: Generate Restart File # ============================================================ if [ \\$ STAGE -eq 1 ] || [ \\$ STAGE -eq 0 ] ; then echo \"\" echo \"=========================================\" echo \"Stage 1: Generate Initial Condition\" echo \"=========================================\" # Compilation if [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Compiling with OpenMP...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -O2 -Wall -disable-dimensions -fopenmp \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -O2 -Wall -disable-dimensions -fopenmp \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else echo \"Compiling for serial execution...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -O2 -Wall -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -O2 -Wall -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi if [ \\$ ? -ne 0 ] ; then echo \"ERROR: Stage 1 compilation failed\" >& 2 exit 1 fi echo \"Compilation successful: \\$ EXECUTABLE\" # Exit if compile-only mode if [ \\$ COMPILE_ONLY -eq 1 ] ; then echo \"\" echo \"Compile-only mode: Stopping here\" cd ../.. exit 0 fi # Execution echo \"\" echo \"Running briefly to generate restart file...\" if [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \" OMP_NUM_THREADS= \\$ FOPENMP_THREADS\" export OMP_NUM_THREADS = \\$ FOPENMP_THREADS else echo \" Running single-threaded\" fi echo \" Command: ./ \\$ {EXECUTABLE} \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond 0.01\" ./\\${EXECUTABLE} \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond 0.01 if [ ! -f \"restart\" ] ; then echo \"ERROR: Stage 1 failed - restart file was not created\" >& 2 exit 1 fi echo \"\" echo \"=========================================\" echo \"Stage 1 complete: restart file created\" echo \"Restart file location: \\$ CASE_DIR/restart\" if [ \\$ STAGE -eq 1 ] ; then echo \"\" echo \"To run Stage 2:\" echo \" \\$ 0 --stage2 \\$ PARAM_FILE\" echo \" \\$ 0 --stage2 --mpi \\$ PARAM_FILE\" fi echo \"=========================================\" fi # ============================================================ # Stage 2: Full Simulation # ============================================================ if [ \\$ STAGE -eq 2 ] || [ \\$ STAGE -eq 0 ] ; then # Check restart file exists if [ ! -f \"restart\" ] ; then echo \"ERROR: restart file not found in \\$ CASE_DIR\" >& 2 echo \" Run Stage 1 first: \\$ 0 --stage1 \\$ PARAM_FILE\" >& 2 exit 1 fi echo \"\" echo \"=========================================\" echo \"Stage 2: Full Simulation\" echo \"=========================================\" # Compilation if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Compiling with MPI...\" if [ \" \\$ OS_TYPE\" = \"Darwin\" ] ; then # macOS [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else # Linux [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Compiling with OpenMP...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -O2 -Wall -disable-dimensions -fopenmp \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -O2 -Wall -disable-dimensions -fopenmp \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else echo \"Compiling for serial execution...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -O2 -Wall -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -O2 -Wall -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi if [ \\$ ? -ne 0 ] ; then echo \"ERROR: Stage 2 compilation failed\" >& 2 exit 1 fi echo \"Compilation successful: \\$ EXECUTABLE\" # Exit if compile-only mode if [ \\$ COMPILE_ONLY -eq 1 ] ; then echo \"\" echo \"Compile-only mode: Stopping here\" cd ../.. exit 0 fi # Execution echo \"\" echo \"Starting full simulation...\" echo \" Command args: \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax\" echo \"=========================================\" if [ \\$ MPI_ENABLED -eq 1 ] ; then [ \\$ VERBOSE -eq 1 ] && echo \"Command: mpirun -np \\$ MPI_CORES ./ \\$ EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax\" mpirun -np \\$ MPI_CORES ./\\$EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then export OMP_NUM_THREADS = \\$ FOPENMP_THREADS [ \\$ VERBOSE -eq 1 ] && echo \"OMP_NUM_THREADS= \\$ FOPENMP_THREADS\" [ \\$ VERBOSE -eq 1 ] && echo \"Command: ./ \\$ EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax\" ./\\$EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax else [ \\$ VERBOSE -eq 1 ] && echo \"Command: ./ \\$ EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax\" ./\\$EXECUTABLE \\$ MAXlevel \\$ De \\$ Ec \\$ Oh \\$ Bond \\$ tmax fi EXIT_CODE = \\$ ? echo \"=========================================\" if [ \\$ EXIT_CODE -eq 0 ] ; then echo \"Simulation completed successfully\" echo \"Output location: \\$ CASE_DIR\" else echo \"Simulation failed with exit code \\$ EXIT_CODE\" fi echo \"=========================================\" # Return to root directory cd ../.. exit \\$ EXIT_CODE fi # Return to root directory cd ../.. exit 0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#!/bin/bash# runSimulation.sh - Run single viscoelastic bubble bursting simulation from root directory# Creates case folder in simulationCases/<CaseNo>/ and runs simulation there## IMPORTANT: This script uses TWO-STAGE EXECUTION because distance.h is# incompatible with MPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Run Stage 1...",
    "content": "Run Stage 1 first to generate the restart file,# then run Stage 2 for the full simulation.set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source project configurationif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"elseecho\"ERROR: .project_config not found\">&2exit1fi# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [params_file]Run single viscoelastic bubble bursting simulation from root directory.Creates case folder in simulationCases/<CaseNo>/ based on parameter file.This script uses TWO-STAGE EXECUTION:Stage 1: Generate restart file (distance.h incompatible with MPI)Stage 2: Full simulation from restart fileStage Selection (mutually exclusive):(default)           Run both Stage 1 + Stage 2--stage1            Run Stage 1 only (generate restart file)--stage2            Run Stage 2 only (full simulation from restart)Parallelization:--fopenmp [N]       Enable OpenMP with N threads (default: 8)Stage 1: Linux only (macOS always serial)Stage 2: Linux only (macOS runs serial with warning)--mpi [N]           Enable MPI with N cores (default: 2, Stage 2 only)Other Options:-c, --compile-only  Compile but don't run simulation-d, --debug         Compile with debug flags (-g -DTRASH=1)-v, --verbose       Verbose output-h, --help          Show this help messageParameter file mode (default):\\$0 default.paramsIf no parameter file specified, uses default.params from current directory.Environment variables:QCC_FLAGS     Additional qcc compiler flagsExamples:# Run both stages (default)\\$0 default.params                         # Serial, Stage 1 + 2\\$0 --mpi 8 default.params                 # Stage 1 serial, Stage 2 MPI# Stage 1 only: Generate restart file\\$0 --stage1 default.params                # Serial\\$0 --stage1 --fopenmp default.params      # OpenMP (Linux only)# Stage 2 only: Full simulation (requires existing restart)\\$0 --stage2 default.params                # Serial\\$0 --stage2 --mpi 8 default.params        # MPI, 8 cores# Compile only (check for errors)\\$0 --compile-only default.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================COMPILE_ONLY=0DEBUG_FLAGS=\"\"VERBOSE=0STAGE=0# Default to both stages (0 = both, 1 = stage1, 2 = stage2)FOPENMP_ENABLED=0FOPENMP_THREADS=8# Default thread countMPI_ENABLED=0MPI_CORES=2# Default core countSTAGE_EXPLICITLY_SET=0QCC_FLAGS=\"\\${QCC_FLAGS:-}\"while[[\\$#-gt0]];docase\\$1in-c|--compile-only)COMPILE_ONLY=1shift;;-d|--debug)DEBUG_FLAGS=\"-g -DTRASH=1\"shift;;--stage1)if[\\$STAGE_EXPLICITLY_SET-eq1]&&[\\$STAGE-ne1];thenecho\"ERROR: Cannot use both --stage1 and --stage2\">&2exit1fiSTAGE=1STAGE_EXPLICITLY_SET=1shift;;--stage2)if[\\$STAGE_EXPLICITLY_SET-eq1]&&[\\$STAGE-ne2];thenecho\"ERROR: Cannot use both --stage1 and --stage2\">&2exit1fiSTAGE=2STAGE_EXPLICITLY_SET=1shift;;--fopenmp)FOPENMP_ENABLED=1# Check if next arg is a number (optional thread count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenFOPENMP_THREADS=\"\\$2\"shiftfishift;;--mpi)MPI_ENABLED=1# Check if next arg is a number (optional core count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenMPI_CORES=\"\\$2\"shiftfishift;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Detect OS# ============================================================OS_TYPE=\\$(uname-s)# ============================================================# Validation# ============================================================# Check --mpi only valid with stage2 (not stage1-only)if[\\$MPI_ENABLED-eq1]&&[\\$STAGE-eq1];thenecho\"ERROR: --mpi is only valid with --stage2 (Stage 1 cannot use MPI due to distance.h)\">&2exit1fi# For both-stages mode with MPI, MPI only applies to Stage 2if[\\$MPI_ENABLED-eq1]&&[\\$STAGE-eq0];thenecho\"Note: MPI will be used for Stage 2 only (Stage 1 runs serial)\"fi# Check --mpi and --fopenmp are mutually exclusiveif[\\$MPI_ENABLED-eq1]&&[\\$FOPENMP_ENABLED-eq1];thenecho\"ERROR: --mpi and --fopenmp are mutually exclusive\">&2exit1fi# Check --fopenmp on macOSif[\"\\$OS_TYPE\"=\"Darwin\"]&&[\\$FOPENMP_ENABLED-eq1];thenif[\\$STAGE-eq1];thenecho\"ERROR: --fopenmp not supported on macOS for Stage 1 (always runs serial)\">&2exit1elseecho\"WARNING: OpenMP not available on macOS, Stage 2 will run serial\">&2FOPENMP_ENABLED=0fifi# Verify MPI tools if MPI is enabledif[\\$MPI_ENABLED-eq1];thenif!command-vmpicc&>/dev/null;thenecho\"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fiif!command-vmpirun&>/dev/null;thenecho\"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fifi# ============================================================# Determine Parameter File# ============================================================PARAM_FILE=\"\\${1:-default.params}\"if[!-f\"\\$PARAM_FILE\"];thenecho\"ERROR: Parameter file not found:\\$PARAM_FILE\">&2exit1fi[\\$VERBOSE-eq1]&&echo\"Parameter file:\\$PARAM_FILE\"# ============================================================# Parse Parameters# ============================================================parse_param_file\"\\$PARAM_FILE\"CASE_NO=\\$(get_param\"CaseNo\")De=\\$(get_param\"De\"\"0.1\")Ec=\\$(get_param\"Ec\"\"0.01\")Oh=\\$(get_param\"Oh\"\"1e-2\")Bond=\\$(get_param\"Bond\"\"1e-3\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"1.0\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in parameter file\">&2exit1fi# Validate CaseNo is 4 digitsif![[\"\\$CASE_NO\"=~^[0-9]{4}\\$]]||[\"\\$CASE_NO\"-lt1000]||[\"\\$CASE_NO\"-gt9999];thenecho\"ERROR: CaseNo must be 4-digit (1000-9999), got:\\$CASE_NO\">&2exit1fiCASE_DIR=\"simulationCases/\\${CASE_NO}\"# ============================================================# Display Configuration# ============================================================echo\"=========================================\"echo\"Viscoelastic Bubble Bursting Simulation\"echo\"=========================================\"echo\"Case Number:\\$CASE_NO\"echo\"Case Directory:\\$CASE_DIR\"echo\"Parameter File:\\$PARAM_FILE\"echo\"\"echo\"Physical Parameters:\"echo\"  De=\\$De, Ec=\\$Ec, Oh=\\$Oh, Bond=\\$Bond\"echo\"  MAXlevel=\\$MAXlevel, tmax=\\$tmax\"echo\"\"if[\\$STAGE-eq0];thenecho\"Stage: Both (Stage 1 + Stage 2)\"elif[\\$STAGE-eq1];thenecho\"Stage: 1 only (generate restart)\"elseecho\"Stage: 2 only (full simulation)\"fiif[\\$MPI_ENABLED-eq1];thenecho\"Parallelization: MPI (\\$MPI_CORES cores)\"elif[\\$FOPENMP_ENABLED-eq1];thenecho\"Parallelization: OpenMP (\\$FOPENMP_THREADS threads)\"elseecho\"Parallelization: Serial\"fiecho\"\"# ============================================================# Create Case Directory# ============================================================if[!-d\"\\$CASE_DIR\"];thenecho\"Creating case directory:\\$CASE_DIR\"mkdir-p\"\\$CASE_DIR\"elseecho\"Case directory exists\"fi# Copy parameter file to case directory for record keepingcp\"\\$PARAM_FILE\"\"\\$CASE_DIR/case.params\"# Change to case directorycd\"\\$CASE_DIR\"[\\$VERBOSE-eq1]&&echo\"Working directory:\\$(pwd)\"# ============================================================# Source File Setup# ============================================================SRC_FILE_ORIG=\"../burstingBubbleVE.c\"SRC_FILE_LOCAL=\"burstingBubbleVE.c\"EXECUTABLE=\"burstingBubbleVE\"# Check if source file existsif[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2exit1fi# Copy source file to case directorycp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Copied source file to case directory\"# Copy Bond-specific geometry file if exists# Format Bond as 4 decimal places (e.g., 1e-3 -> 0.0010)BOND_FORMATTED=\\$(printf\"%.4f\"\"\\$Bond\")BOND_FILE=\"../DataFiles/Bo\\${BOND_FORMATTED}.dat\"if[-f\"\\$BOND_FILE\"];thencp\"\\$BOND_FILE\".echo\"Copied geometry file Bo\\${BOND_FORMATTED}.dat\"else# Try alternate location (one level up from case dir)BOND_FILE_ALT=\"../Bo\\${BOND_FORMATTED}.dat\"if[-f\"\\$BOND_FILE_ALT\"];thencp\"\\$BOND_FILE_ALT\".echo\"Copied geometry file Bo\\${BOND_FORMATTED}.dat\"elseecho\"WARNING: Geometry file Bo\\${BOND_FORMATTED}.dat not found\">&2echo\"         Checked:\\$BOND_FILE and\\$BOND_FILE_ALT\">&2echo\"         Simulation may fail during initialization\">&2fifi# ============================================================# Stage 1: Generate Restart File# ============================================================if[\\$STAGE-eq1]||[\\$STAGE-eq0];thenecho\"\"echo\"=========================================\"echo\"Stage 1: Generate Initial Condition\"echo\"=========================================\"# Compilationif[\\$FOPENMP_ENABLED-eq1];thenecho\"Compiling with OpenMP...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -O2 -Wall -disable-dimensions -fopenmp\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-O2-Wall-disable-dimensions-fopenmp\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelseecho\"Compiling for serial execution...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -O2 -Wall -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-O2-Wall-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfiif[\\$?-ne0];thenecho\"ERROR: Stage 1 compilation failed\">&2exit1fiecho\"Compilation successful:\\$EXECUTABLE\"# Exit if compile-only modeif[\\$COMPILE_ONLY-eq1];thenecho\"\"echo\"Compile-only mode: Stopping here\"cd../..exit0fi# Executionecho\"\"echo\"Running briefly to generate restart file...\"if[\\$FOPENMP_ENABLED-eq1];thenecho\"  OMP_NUM_THREADS=\\$FOPENMP_THREADS\"exportOMP_NUM_THREADS=\\$FOPENMP_THREADSelseecho\"  Running single-threaded\"fiecho\"  Command: ./\\${EXECUTABLE}\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond 0.01\"./\\${EXECUTABLE}\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond 0.01if[!-f\"restart\"];thenecho\"ERROR: Stage 1 failed - restart file was not created\">&2exit1fiecho\"\"echo\"=========================================\"echo\"Stage 1 complete: restart file created\"echo\"Restart file location:\\$CASE_DIR/restart\"if[\\$STAGE-eq1];thenecho\"\"echo\"To run Stage 2:\"echo\"\\$0 --stage2\\$PARAM_FILE\"echo\"\\$0 --stage2 --mpi\\$PARAM_FILE\"fiecho\"=========================================\"fi# ============================================================# Stage 2: Full Simulation# ============================================================if[\\$STAGE-eq2]||[\\$STAGE-eq0];then# Check restart file existsif[!-f\"restart\"];thenecho\"ERROR: restart file not found in\\$CASE_DIR\">&2echo\"       Run Stage 1 first:\\$0 --stage1\\$PARAM_FILE\">&2exit1fiecho\"\"echo\"=========================================\"echo\"Stage 2: Full Simulation\"echo\"=========================================\"# Compilationif[\\$MPI_ENABLED-eq1];thenecho\"Compiling with MPI...\"if[\"\\$OS_TYPE\"=\"Darwin\"];then# macOS[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelse# Linux[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfielif[\\$FOPENMP_ENABLED-eq1];thenecho\"Compiling with OpenMP...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -O2 -Wall -disable-dimensions -fopenmp\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-O2-Wall-disable-dimensions-fopenmp\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelseecho\"Compiling for serial execution...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -O2 -Wall -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-O2-Wall-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfiif[\\$?-ne0];thenecho\"ERROR: Stage 2 compilation failed\">&2exit1fiecho\"Compilation successful:\\$EXECUTABLE\"# Exit if compile-only modeif[\\$COMPILE_ONLY-eq1];thenecho\"\"echo\"Compile-only mode: Stopping here\"cd../..exit0fi# Executionecho\"\"echo\"Starting full simulation...\"echo\"  Command args:\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmax\"echo\"=========================================\"if[\\$MPI_ENABLED-eq1];then[\\$VERBOSE-eq1]&&echo\"Command: mpirun -np\\$MPI_CORES ./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmax\"mpirun-np\\$MPI_CORES ./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmaxelif[\\$FOPENMP_ENABLED-eq1];thenexportOMP_NUM_THREADS=\\$FOPENMP_THREADS[\\$VERBOSE-eq1]&&echo\"OMP_NUM_THREADS=\\$FOPENMP_THREADS\"[\\$VERBOSE-eq1]&&echo\"Command: ./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmax\"./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmaxelse[\\$VERBOSE-eq1]&&echo\"Command: ./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmax\"./\\$EXECUTABLE\\$MAXlevel\\$De\\$Ec\\$Oh\\$Bond\\$tmaxfiEXIT_CODE=\\$?echo\"=========================================\"if[\\$EXIT_CODE-eq0];thenecho\"Simulation completed successfully\"echo\"Output location:\\$CASE_DIR\"elseecho\"Simulation failed with exit code\\$EXIT_CODE\"fiecho\"=========================================\"# Return to root directorycd../..exit\\$EXIT_CODEfi# Return to root directorycd../..exit0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "test-workflow-locally.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "test-workflow-locally.sh See raw file test-workflow-locally.sh #!/bin/bash # Test the Darcs sync workflow locally using Docker # This simulates the GitHub Actions workflow to verify HTTPS connectivity # # First run: builds a Docker image with Darcs pre-installed (~10-15 min) # Subsequent runs: uses cached image (seconds) # # Usage: # ./test-workflow-locally.sh # Use cached image or build if needed # ./test-workflow-locally.sh --rebuild # Force rebuild the image set -e IMAGE_NAME = \"darcs-test\" SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" echo \"==============================================\" echo \"Testing Darcs Sync Workflow Locally (Docker)\" echo \"==============================================\" echo \"\" # Check if Docker is running if ! docker info > /dev/null 2 >& 1 ; then echo \"Error: Docker is not running.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/test-workflow-locally.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "test-workflow-locally.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Please start Docker...",
    "content": "Please start Docker and try again.\" exit 1 fi echo \"Docker is running.\" # Check if we need to build the image BUILD_IMAGE = \\f alse if [[ \" \\$ 1\" == \"--rebuild\" ]]; then BUILD_IMAGE = \\t rue echo \"Forcing image rebuild...\" elif ! docker image inspect \" \\$ IMAGE_NAME\" > /dev/null 2 >& 1 ; then BUILD_IMAGE = \\t rue echo \"Image ' \\$ IMAGE_NAME' not found. Building (this takes ~10-15 min first time)...\" fi if [[ \" \\$ BUILD_IMAGE\" == true ]]; then echo \"\" echo \"Building Docker image with Darcs pre-installed...\" echo \"This only needs to happen once.\" echo \"\" docker build -f \" \\$ SCRIPT_DIR/Dockerfile.darcs-test\" -t \" \\$ IMAGE_NAME\" \" \\$ SCRIPT_DIR\" echo \"\" echo \"Image built successfully! Future runs will be fast.\" echo \"\" fi echo \"\" echo \"Running Darcs sync test...\" echo \"\" # Run the test using the pre-built image docker run --rm \" \\$ IMAGE_NAME\" echo \"\" echo \"Local test completed successfully!\" exit 0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/test-workflow-locally.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "test-workflow-locally.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: #!/bin/bash# Test the...",
    "content": "#!/bin/bash# Test the Darcs sync workflow locally using Docker# This simulates the GitHub Actions workflow to verify HTTPS connectivity## First run: builds a Docker image with Darcs pre-installed (~10-15 min)# Subsequent runs: uses cached image (seconds)## Usage:#   ./test-workflow-locally.sh          # Use cached image or build if needed#   ./test-workflow-locally.sh --rebuild # Force rebuild the imageset-eIMAGE_NAME=\"darcs-test\"SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"echo\"==============================================\"echo\"Testing Darcs Sync Workflow Locally (Docker)\"echo\"==============================================\"echo\"\"# Check if Docker is runningif!dockerinfo>/dev/null2>&1;thenecho\"Error: Docker is not running.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/test-workflow-locally.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "test-workflow-locally.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Please start Docker...",
    "content": "Please start Docker and try again.\"exit1fiecho\"Docker is running.\"# Check if we need to build the imageBUILD_IMAGE=\\falseif[[\"\\$1\"==\"--rebuild\"]];thenBUILD_IMAGE=\\trueecho\"Forcing image rebuild...\"elif!dockerimage inspect\"\\$IMAGE_NAME\">/dev/null2>&1;thenBUILD_IMAGE=\\trueecho\"Image '\\$IMAGE_NAME' not found.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/test-workflow-locally.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "test-workflow-locally.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Building (this takes...",
    "content": "Building (this takes ~10-15 min first time)...\"fiif[[\"\\$BUILD_IMAGE\"==true]];thenecho\"\"echo\"Building Docker image with Darcs pre-installed...\"echo\"This only needs to happen once.\"echo\"\"dockerbuild-f\"\\$SCRIPT_DIR/Dockerfile.darcs-test\"-t\"\\$IMAGE_NAME\"\"\\$SCRIPT_DIR\"echo\"\"echo\"Image built successfully! Future runs will be fast.\"echo\"\"fiecho\"\"echo\"Running Darcs sync test...\"echo\"\"# Run the test using the pre-built imagedockerrun--rm\"\\$IMAGE_NAME\"echo\"\"echo\"Local test completed successfully!\"exit0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/test-workflow-locally.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "runPostProcess-Ncases.sh See raw file runPostProcess-Ncases.sh #!/bin/bash # runPostProcess-Ncases.sh - Run post-processing pipeline on multiple VE simulation cases # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab - Durham University # Last updated: Jan 2026 set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Post-processing script paths VIDEO_SCRIPT = \" \\$ {SCRIPT_DIR}/postProcess/Video.py\" # C helper executables HELPER_GETFACET = \" \\$ {SCRIPT_DIR}/postProcess/getFacet\" HELPER_GETDATA = \" \\$ {SCRIPT_DIR}/postProcess/getData\" # Case directory root CASES_DIR = \" \\$ {SCRIPT_DIR}/simulationCases\" # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] CASE_NO [CASE_NO ...] Run post-processing pipeline on multiple viscoelastic bubble bursting simulation cases.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: For each case,...",
    "content": "For each case, generates video frames with strain-rate and velocity fields, and interface facets.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Options: --CPUs N...",
    "content": "Options: --CPUs N Number of parallel workers (default: 4) --nGFS N Number of snapshots to process (default: 500) --tsnap F Time interval between snapshots (default: 0.01) --GridsPerR N Radial grid resolution for video (default: 256) --ZMIN F Minimum Z coordinate (default: -4.0) --ZMAX F Maximum Z coordinate (default: 4.0) --RMAX F Maximum R coordinate (default: 2.0) Colorbar bounds: --d2-vmin F Min value for strain-rate colorbar (default: -3.0) --d2-vmax F Max value for strain-rate colorbar (default: 2.0) --vel-vmin F Min value for velocity colorbar (default: 0.0) --vel-vmax F Max value for velocity colorbar (default: 1.0) --skip-video-encode Skip ffmpeg video encoding after frame generation -n, --dry-run Show what would run without executing -v, --verbose Verbose output -h, --help Show this help message Arguments: CASE_NO 4-digit case numbers (1000-9999) Examples: # Process multiple cases with default settings \\$ 0 1000 1001 1002 # Process with 8 CPUs \\$ 0 --CPUs 8 1000 1001 # Process first 100 snapshots only (for testing) \\$ 0 --nGFS 100 1000 # Skip video encoding (only generate frames) \\$ 0 --skip-video-encode 1000 1001 # Dry run to preview commands \\$ 0 --dry-run 1000 Output locations: simulationCases/<CaseNo>/Video/ # PNG frames simulationCases/<CaseNo>/<CaseNo>.mp4 # Encoded video For more information, see CLAUDE.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ CPUS = 4 NGFS = 500 TSNAP = 0.01 GRIDS_PER_R = 256 ZMIN = \"-4.0\" ZMAX = \"4.0\" RMAX = \"2.0\" D2_VMIN = \"-3.0\" D2_VMAX = \"2.0\" VEL_VMIN = \"0.0\" VEL_VMAX = \"1.0\" SKIP_VIDEO_ENCODE = 0 DRY_RUN = 0 VERBOSE = 0 CASE_NUMBERS = () while [[ \\$ # -gt 0 ]]; do case \\$ 1 in --CPUs ) CPUS = \" \\$ 2\" if ! [[ \" \\$ CPUS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ CPUS\" -lt 1 ] ; then echo \"ERROR: --CPUs requires a positive integer, got: \\$ CPUS\" >& 2 exit 1 fi shift 2 ;; --nGFS ) NGFS = \" \\$ 2\" if ! [[ \" \\$ NGFS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ NGFS\" -lt 1 ] ; then echo \"ERROR: --nGFS requires a positive integer, got: \\$ NGFS\" >& 2 exit 1 fi shift 2 ;; --tsnap ) TSNAP = \" \\$ 2\" shift 2 ;; --GridsPerR ) GRIDS_PER_R = \" \\$ 2\" if ! [[ \" \\$ GRIDS_PER_R\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ GRIDS_PER_R\" -lt 1 ] ; then echo \"ERROR: --GridsPerR requires a positive integer, got: \\$ GRIDS_PER_R\" >& 2 exit 1 fi shift 2 ;; --ZMIN ) ZMIN = \" \\$ 2\" shift 2 ;; --ZMAX ) ZMAX = \" \\$ 2\" shift 2 ;; --RMAX ) RMAX = \" \\$ 2\" shift 2 ;; --d2-vmin ) D2_VMIN = \" \\$ 2\" shift 2 ;; --d2-vmax ) D2_VMAX = \" \\$ 2\" shift 2 ;; --vel-vmin ) VEL_VMIN = \" \\$ 2\" shift 2 ;; --vel-vmax ) VEL_VMAX = \" \\$ 2\" shift 2 ;; --skip-video-encode ) SKIP_VIDEO_ENCODE = 1 shift ;; -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) # Collect case numbers CASE_NUMBERS += ( \" \\$ 1\" ) shift ;; esac done # ============================================================ # Validation # ============================================================ # Check at least one case number provided if [ \\$ {#CASE_NUMBERS[@]} -eq 0 ] ; then echo \"ERROR: No case numbers provided\" >& 2 usage exit 1 fi # Validate case numbers are 4-digit for case_no in \" \\$ {CASE_NUMBERS[@]}\" ; do if ! [[ \" \\$ case_no\" =~ ^ [ 0 - 9 ] { 4 } \\$ ]]; then echo \"ERROR: Case number must be 4 digits (1000-9999), got: \\$ case_no\" >& 2 exit 1 fi if [ \" \\$ case_no\" -lt 1000 ] || [ \" \\$ case_no\" -gt 9999 ] ; then echo \"ERROR: Case number out of range (1000-9999), got: \\$ case_no\" >& 2 exit 1 fi done # Check Python availability if ! command -v python &> /dev/null ; then echo \"ERROR: python not found in PATH\" >& 2 exit 1 fi # Check Python script exists if [ ! -f \" \\$ VIDEO_SCRIPT\" ] ; then echo \"ERROR: Python script not found: \\$ VIDEO_SCRIPT\" >& 2 exit 1 fi # Check C helpers exist for helper in \" \\$ HELPER_GETFACET\" \" \\$ HELPER_GETDATA\" ; do if [ ! -x \" \\$ helper\" ] ; then helper_name = \\$ ( basename \" \\$ helper\" ) echo \"ERROR: Compiled helper not found or not executable: \\$ helper\" >& 2 echo \" Compile with: qcc -O2 -Wall postProcess/ \\$ {helper_name}.c -o postProcess/ \\$ {helper_name} -lm\" >& 2 exit 1 fi done # ============================================================ # Display Configuration # ============================================================ echo \"=========================================\" echo \"Viscoelastic Bubble Bursting - Post-Processing Pipeline\" echo \"=========================================\" echo \"Cases to process: \\$ {CASE_NUMBERS[*]}\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"\" echo \"Settings:\" echo \" CPUs: \\$ CPUS\" echo \" nGFS: \\$ NGFS\" echo \" tsnap: \\$ TSNAP\" echo \" GridsPerR: \\$ GRIDS_PER_R\" echo \" Domain: Z=[ \\$ ZMIN, \\$ ZMAX], R=[0, \\$ RMAX]\" echo \" Colorbars: D2=[ \\$ D2_VMIN, \\$ D2_VMAX], vel=[ \\$ VEL_VMIN, \\$ VEL_VMAX]\" echo \"\" echo \"Pipeline:\" [ \\$ SKIP_VIDEO_ENCODE -eq 0 ] && echo \" [1] Video.py (frames + video)\" || echo \" [1] Video.py (frames only, video SKIPPED)\" echo \"\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: DRY RUN (no execution)\" echo \"\" # ============================================================ # Processing Functions # ============================================================ run_video() { local case_no = \" \\$ 1\" local case_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}\" local video_dir = \" \\$ {case_dir}/Video\" # Build command local cmd_args = ( \"--caseToProcess\" \" \\$ {case_dir}\" \"--folderToSave\" \" \\$ {video_dir}\" \"--CPUs\" \" \\$ {CPUS}\" \"--nGFS\" \" \\$ {NGFS}\" \"--tsnap\" \" \\$ {TSNAP}\" \"--GridsPerR\" \" \\$ {GRIDS_PER_R}\" \"--ZMIN\" \" \\$ {ZMIN}\" \"--ZMAX\" \" \\$ {ZMAX}\" \"--RMAX\" \" \\$ {RMAX}\" \"--d2-vmin\" \" \\$ {D2_VMIN}\" \"--d2-vmax\" \" \\$ {D2_VMAX}\" \"--vel-vmin\" \" \\$ {VEL_VMIN}\" \"--vel-vmax\" \" \\$ {VEL_VMAX}\" ) # Add skip flag if needed [ \\$ SKIP_VIDEO_ENCODE -eq 1 ] && cmd_args += ( \"--skip-video-encode\" ) if [ \\$ VERBOSE -eq 1 ] || [ \\$ DRY_RUN -eq 1 ] ; then echo \" CMD: python \\$ {VIDEO_SCRIPT} \\$ {cmd_args[*]}\" fi if [ \\$ DRY_RUN -eq 0 ] ; then python \" \\$ {VIDEO_SCRIPT}\" \" \\$ {cmd_args[@]}\" fi } # ============================================================ # Main Processing Loop # ============================================================ echo \"=========================================\" echo \"Processing Cases\" echo \"=========================================\" SUCCESSFUL_CASES = () FAILED_CASES = () FAILURE_REASONS = () for case_no in \" \\$ {CASE_NUMBERS[@]}\" ; do echo \"\" echo \"-----------------------------------------\" echo \"Case \\$ case_no\" echo \"-----------------------------------------\" case_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}\" intermediate_dir = \" \\$ {case_dir}/intermediate\" # Validate case directory exists if [ ! -d \" \\$ case_dir\" ] ; then echo \" ERROR: Case directory not found: \\$ case_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Case directory not found\" ) continue fi if [ ! -d \" \\$ intermediate_dir\" ] ; then echo \" ERROR: Intermediate directory not found: \\$ intermediate_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No intermediate/ snapshots\" ) continue fi # Count snapshots snapshot_count = \\$ ( find \" \\$ intermediate_dir\" -name \"snapshot-*\" 2 > /dev/null | wc -l | tr -d ' ' ) echo \" Found \\$ snapshot_count snapshots in intermediate/\" if [ \" \\$ snapshot_count\" -eq 0 ] ; then echo \" ERROR: No snapshots found\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No snapshots in intermediate/\" ) continue fi # Display case parameters if case.params exists case_params = \" \\$ {case_dir}/case.params\" if [ -f \" \\$ case_params\" ] && [ \\$ VERBOSE -eq 1 ] ; then parse_param_file \" \\$ case_params\" echo \" Parameters: De= \\$ (get_param \" De \" \" ? \"), Ec= \\$ (get_param \" Ec \" \" ? \"), Oh= \\$ (get_param \" Oh \" \" ? \")\" fi # Track step failures step_failed = 0 # Run video generation echo \"\" echo \" [1/1] Running Video.py...\" if ! run_video \" \\$ case_no\" ; then echo \" ERROR: Video generation failed\" step_failed = 1 else [ \\$ DRY_RUN -eq 0 ] && echo \" [1/1] Video generation complete\" fi # Record result if [ \\$ step_failed -eq 0 ] ; then SUCCESSFUL_CASES += ( \" \\$ case_no\" ) echo \"\" echo \" Case \\$ case_no: SUCCESS\" else FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Processing step failed\" ) echo \"\" echo \" Case \\$ case_no: FAILED\" fi done # ============================================================ # Summary # ============================================================ echo \"\" echo \"=========================================\" echo \"Post-Processing Complete\" echo \"=========================================\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"Successful: \\$ {#SUCCESSFUL_CASES[@]}\" echo \"Failed: \\$ {#FAILED_CASES[@]}\" if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Failed cases:\" for i in \" \\$ {!FAILED_CASES[@]}\" ; do echo \" - Case \\$ {FAILED_CASES[ \\$ i]}: \\$ {FAILURE_REASONS[ \\$ i]}\" done fi if [ \\$ {#SUCCESSFUL_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Output locations:\" for case_no in \" \\$ {SUCCESSFUL_CASES[@]}\" ; do echo \" \\$ {CASES_DIR}/ \\$ {case_no}/\" done fi echo \"\" # Exit with error if any cases failed if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#!/bin/bash# runPostProcess-Ncases.sh - Run post-processing pipeline on multiple VE simulation cases# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab - Durham University# Last updated: Jan 2026set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Post-processing script pathsVIDEO_SCRIPT=\"\\${SCRIPT_DIR}/postProcess/Video.py\"# C helper executablesHELPER_GETFACET=\"\\${SCRIPT_DIR}/postProcess/getFacet\"HELPER_GETDATA=\"\\${SCRIPT_DIR}/postProcess/getData\"# Case directory rootCASES_DIR=\"\\${SCRIPT_DIR}/simulationCases\"# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] CASE_NO [CASE_NO ...]Run post-processing pipeline on multiple viscoelastic bubble bursting simulation cases.For each case, generates video frames with strain-rate and velocity fields,and interface facets.Options:--CPUs N            Number of parallel workers (default: 4)--nGFS N            Number of snapshots to process (default: 500)--tsnap F           Time interval between snapshots (default: 0.01)--GridsPerR N       Radial grid resolution for video (default: 256)--ZMIN F            Minimum Z coordinate (default: -4.0)--ZMAX F            Maximum Z coordinate (default: 4.0)--RMAX F            Maximum R coordinate (default: 2.0)Colorbar bounds:--d2-vmin F         Min value for strain-rate colorbar (default: -3.0)--d2-vmax F         Max value for strain-rate colorbar (default: 2.0)--vel-vmin F        Min value for velocity colorbar (default: 0.0)--vel-vmax F        Max value for velocity colorbar (default: 1.0)--skip-video-encode Skip ffmpeg video encoding after frame generation-n, --dry-run       Show what would run without executing-v, --verbose       Verbose output-h, --help          Show this help messageArguments:CASE_NO             4-digit case numbers (1000-9999)Examples:# Process multiple cases with default settings\\$0 1000 1001 1002# Process with 8 CPUs\\$0 --CPUs 8 1000 1001# Process first 100 snapshots only (for testing)\\$0 --nGFS 100 1000# Skip video encoding (only generate frames)\\$0 --skip-video-encode 1000 1001# Dry run to preview commands\\$0 --dry-run 1000Output locations:simulationCases/<CaseNo>/Video/        # PNG framessimulationCases/<CaseNo>/<CaseNo>.mp4  # Encoded videoFor more information, see CLAUDE.mdEOF}# ============================================================# Parse Command Line Options# ============================================================CPUS=4NGFS=500TSNAP=0.01GRIDS_PER_R=256ZMIN=\"-4.0\"ZMAX=\"4.0\"RMAX=\"2.0\"D2_VMIN=\"-3.0\"D2_VMAX=\"2.0\"VEL_VMIN=\"0.0\"VEL_VMAX=\"1.0\"SKIP_VIDEO_ENCODE=0DRY_RUN=0VERBOSE=0CASE_NUMBERS=()while[[\\$#-gt0]];docase\\$1in--CPUs)CPUS=\"\\$2\"if![[\"\\$CPUS\"=~^[0-9]+\\$]]||[\"\\$CPUS\"-lt1];thenecho\"ERROR: --CPUs requires a positive integer, got:\\$CPUS\">&2exit1fishift2;;--nGFS)NGFS=\"\\$2\"if![[\"\\$NGFS\"=~^[0-9]+\\$]]||[\"\\$NGFS\"-lt1];thenecho\"ERROR: --nGFS requires a positive integer, got:\\$NGFS\">&2exit1fishift2;;--tsnap)TSNAP=\"\\$2\"shift2;;--GridsPerR)GRIDS_PER_R=\"\\$2\"if![[\"\\$GRIDS_PER_R\"=~^[0-9]+\\$]]||[\"\\$GRIDS_PER_R\"-lt1];thenecho\"ERROR: --GridsPerR requires a positive integer, got:\\$GRIDS_PER_R\">&2exit1fishift2;;--ZMIN)ZMIN=\"\\$2\"shift2;;--ZMAX)ZMAX=\"\\$2\"shift2;;--RMAX)RMAX=\"\\$2\"shift2;;--d2-vmin)D2_VMIN=\"\\$2\"shift2;;--d2-vmax)D2_VMAX=\"\\$2\"shift2;;--vel-vmin)VEL_VMIN=\"\\$2\"shift2;;--vel-vmax)VEL_VMAX=\"\\$2\"shift2;;--skip-video-encode)SKIP_VIDEO_ENCODE=1shift;;-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)# Collect case numbersCASE_NUMBERS+=(\"\\$1\")shift;;esacdone# ============================================================# Validation# ============================================================# Check at least one case number providedif[\\${#CASE_NUMBERS[@]}-eq0];thenecho\"ERROR: No case numbers provided\">&2usageexit1fi# Validate case numbers are 4-digitforcase_noin\"\\${CASE_NUMBERS[@]}\";doif![[\"\\$case_no\"=~^[0-9]{4}\\$]];thenecho\"ERROR: Case number must be 4 digits (1000-9999), got:\\$case_no\">&2exit1fiif[\"\\$case_no\"-lt1000]||[\"\\$case_no\"-gt9999];thenecho\"ERROR: Case number out of range (1000-9999), got:\\$case_no\">&2exit1fidone# Check Python availabilityif!command-vpython&>/dev/null;thenecho\"ERROR: python not found in PATH\">&2exit1fi# Check Python script existsif[!-f\"\\$VIDEO_SCRIPT\"];thenecho\"ERROR: Python script not found:\\$VIDEO_SCRIPT\">&2exit1fi# Check C helpers existforhelperin\"\\$HELPER_GETFACET\"\"\\$HELPER_GETDATA\";doif[!-x\"\\$helper\"];thenhelper_name=\\$(basename\"\\$helper\")echo\"ERROR: Compiled helper not found or not executable:\\$helper\">&2echo\"       Compile with: qcc -O2 -Wall postProcess/\\${helper_name}.c -o postProcess/\\${helper_name} -lm\">&2exit1fidone# ============================================================# Display Configuration# ============================================================echo\"=========================================\"echo\"Viscoelastic Bubble Bursting - Post-Processing Pipeline\"echo\"=========================================\"echo\"Cases to process:\\${CASE_NUMBERS[*]}\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"\"echo\"Settings:\"echo\"  CPUs:\\$CPUS\"echo\"  nGFS:\\$NGFS\"echo\"  tsnap:\\$TSNAP\"echo\"  GridsPerR:\\$GRIDS_PER_R\"echo\"  Domain:     Z=[\\$ZMIN,\\$ZMAX], R=[0,\\$RMAX]\"echo\"  Colorbars:  D2=[\\$D2_VMIN,\\$D2_VMAX], vel=[\\$VEL_VMIN,\\$VEL_VMAX]\"echo\"\"echo\"Pipeline:\"[\\$SKIP_VIDEO_ENCODE-eq0]&&echo\"  [1] Video.py (frames + video)\"||echo\"  [1] Video.py (frames only, video SKIPPED)\"echo\"\"[\\$DRY_RUN-eq1]&&echo\"Mode: DRY RUN (no execution)\"echo\"\"# ============================================================# Processing Functions# ============================================================run_video(){localcase_no=\"\\$1\"localcase_dir=\"\\${CASES_DIR}/\\${case_no}\"localvideo_dir=\"\\${case_dir}/Video\"# Build commandlocalcmd_args=(\"--caseToProcess\"\"\\${case_dir}\"\"--folderToSave\"\"\\${video_dir}\"\"--CPUs\"\"\\${CPUS}\"\"--nGFS\"\"\\${NGFS}\"\"--tsnap\"\"\\${TSNAP}\"\"--GridsPerR\"\"\\${GRIDS_PER_R}\"\"--ZMIN\"\"\\${ZMIN}\"\"--ZMAX\"\"\\${ZMAX}\"\"--RMAX\"\"\\${RMAX}\"\"--d2-vmin\"\"\\${D2_VMIN}\"\"--d2-vmax\"\"\\${D2_VMAX}\"\"--vel-vmin\"\"\\${VEL_VMIN}\"\"--vel-vmax\"\"\\${VEL_VMAX}\")# Add skip flag if needed[\\$SKIP_VIDEO_ENCODE-eq1]&&cmd_args+=(\"--skip-video-encode\")if[\\$VERBOSE-eq1]||[\\$DRY_RUN-eq1];thenecho\"  CMD: python\\${VIDEO_SCRIPT}\\${cmd_args[*]}\"fiif[\\$DRY_RUN-eq0];thenpython\"\\${VIDEO_SCRIPT}\"\"\\${cmd_args[@]}\"fi}# ============================================================# Main Processing Loop# ============================================================echo\"=========================================\"echo\"Processing Cases\"echo\"=========================================\"SUCCESSFUL_CASES=()FAILED_CASES=()FAILURE_REASONS=()forcase_noin\"\\${CASE_NUMBERS[@]}\";doecho\"\"echo\"-----------------------------------------\"echo\"Case\\$case_no\"echo\"-----------------------------------------\"case_dir=\"\\${CASES_DIR}/\\${case_no}\"intermediate_dir=\"\\${case_dir}/intermediate\"# Validate case directory existsif[!-d\"\\$case_dir\"];thenecho\"  ERROR: Case directory not found:\\$case_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Case directory not found\")continuefiif[!-d\"\\$intermediate_dir\"];thenecho\"  ERROR: Intermediate directory not found:\\$intermediate_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No intermediate/ snapshots\")continuefi# Count snapshotssnapshot_count=\\$(find\"\\$intermediate_dir\"-name\"snapshot-*\"2>/dev/null|wc-l|tr-d' ')echo\"  Found\\$snapshot_count snapshots in intermediate/\"if[\"\\$snapshot_count\"-eq0];thenecho\"  ERROR: No snapshots found\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No snapshots in intermediate/\")continuefi# Display case parameters if case.params existscase_params=\"\\${case_dir}/case.params\"if[-f\"\\$case_params\"]&&[\\$VERBOSE-eq1];thenparse_param_file\"\\$case_params\"echo\"  Parameters: De=\\$(get_param \"De\" \"?\"), Ec=\\$(get_param \"Ec\" \"?\"), Oh=\\$(get_param \"Oh\" \"?\")\"fi# Track step failuresstep_failed=0# Run video generationecho\"\"echo\"  [1/1] Running Video.py...\"if!run_video\"\\$case_no\";thenecho\"  ERROR: Video generation failed\"step_failed=1else[\\$DRY_RUN-eq0]&&echo\"  [1/1] Video generation complete\"fi# Record resultif[\\$step_failed-eq0];thenSUCCESSFUL_CASES+=(\"\\$case_no\")echo\"\"echo\"  Case\\$case_no: SUCCESS\"elseFAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Processing step failed\")echo\"\"echo\"  Case\\$case_no: FAILED\"fidone# ============================================================# Summary# ============================================================echo\"\"echo\"=========================================\"echo\"Post-Processing Complete\"echo\"=========================================\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"Successful:\\${#SUCCESSFUL_CASES[@]}\"echo\"Failed:\\${#FAILED_CASES[@]}\"if[\\${#FAILED_CASES[@]}-gt0];thenecho\"\"echo\"Failed cases:\"foriin\"\\${!FAILED_CASES[@]}\";doecho\"  - Case\\${FAILED_CASES[\\$i]}:\\${FAILURE_REASONS[\\$i]}\"donefiif[\\${#SUCCESSFUL_CASES[@]}-gt0];thenecho\"\"echo\"Output locations:\"forcase_noin\"\\${SUCCESSFUL_CASES[@]}\";doecho\"\\${CASES_DIR}/\\${case_no}/\"donefiecho\"\"# Exit with error if any cases failedif[\\${#FAILED_CASES[@]}-gt0];thenexit1fiexit0",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/runPostProcess-Ncases.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements-no-darcs.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "reset_install_requirements-no-darcs.sh See raw file reset_install_requirements-no-darcs.sh #!/bin/bash # Linux/macOS version - uses git instead of darcs # Clones basilisk-source from comphy-lab/basilisk-C GitHub repo # Ensures that we are always using the latest version from our fork # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to check prerequisites check_prerequisites() { local missing_tools = () local found_tools = () echo \"Checking prerequisites...\" echo \"\" # Check for make if ! command -v make > /dev/null 2 >& 1 ; then missing_tools += ( \"make\" ) else found_tools += ( \"make\" ) printf \"\\033[0;32m\u2713 make is installed\\033[0m\\n\" fi # Check for gawk if ! command -v gawk > /dev/null 2 >& 1 ; then missing_tools += ( \"gawk\" ) else found_tools += ( \"gawk\" ) printf \"\\033[0;32m\u2713 gawk is installed\\033[0m\\n\" fi # Check for git if ! command -v git > /dev/null 2 >& 1 ; then missing_tools += ( \"git\" ) else found_tools += ( \"git\" ) printf \"\\033[0;32m\u2713 git is installed\\033[0m\\n\" fi # Check for gcc if ! command -v gcc > /dev/null 2 >& 1 ; then missing_tools += ( \"gcc\" ) else found_tools += ( \"gcc\" ) printf \"\\033[0;32m\u2713 gcc is installed\\033[0m\\n\" fi echo \"\" if [[ \\$ {#missing_tools[@]} -gt 0 ]]; then printf \"\\033[0;31mError: Missing required tools: \\$ {missing_tools[*]}\\033[0m\\n\" echo \"\" if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then # macOS installation instructions echo \"To install missing tools on macOS:\" echo \" xcode-select --install\" echo \" brew install gawk\" else # Linux installation instructions echo \"To install missing tools on Linux:\" echo \" sudo apt install \\$ {missing_tools[*]}\" fi echo \"\" echo \"Please install the missing tools and try again.\" exit 1 else printf \"\\033[0;32m\u2705 All prerequisites are satisfied!\\033[0m\\n\" echo \"\" fi } # Function to apply comphy-lab patches (macOS only) apply_patches() { local target_dir = \" \\$ 1\" if [[ \" \\$ OSTYPE\" != \"darwin\" * ]]; then # Patches are macOS-specific, skip on other platforms return 0 fi printf \"\\033[0;36mApplying comphy-lab patches...\\033[0m\\n\" # Create temp directory for patches mkdir -p \" \\$ target_dir/.patches_temp\" # GitHub URLs for patches local PATCHES_URL = \"https://api.github.com/repos/comphy-lab/basilisk-C/contents/patches\" local RAW_BASE_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/patches\" # Get list of patch files (sorted by name for chronological order due to YYYY-MM-DD format) local PATCH_FILES PATCH_FILES = \\$ ( curl -s \" \\$ PATCHES_URL\" | grep -o '\"name\": \"[^\"]*\\.patch\"' | sed 's/\"name\": \"//;s/\"//' | sort ) if [[ -z \" \\$ PATCH_FILES\" ]]; then printf \"\\033[0;33mWarning: No patches found or unable to fetch patch list\\033[0m\\n\" else # Download and apply each patch echo \" \\$ PATCH_FILES\" | while read -r patch_file ; do if [[ -n \" \\$ patch_file\" ]]; then echo \" Downloading \\$ patch_file...\" if curl -s -f \" \\$ RAW_BASE_URL/ \\$ patch_file\" -o \" \\$ target_dir/.patches_temp/ \\$ patch_file\" ; then echo \" Applying \\$ patch_file...\" if ( cd \" \\$ target_dir\" && patch -p1 < \".patches_temp/ \\$ patch_file\" ); then printf \" \\033[0;32m\u2713 Successfully applied \\$ patch_file\\033[0m\\n\" else printf \" \\033[0;31m\u2717 Failed to apply \\$ patch_file\\033[0m\\n\" fi else printf \" \\033[0;31m\u2717 Failed to download \\$ patch_file\\033[0m\\n\" fi fi done fi # Clean up rm -rf \" \\$ target_dir/.patches_temp\" echo \"\" } # Function to install basilisk using git sparse checkout from GitHub install_basilisk() { local REPO_URL = \"https://github.com/comphy-lab/basilisk-C.git\" printf \"\\033[0;36mCloning basilisk-source from comphy-lab/basilisk-C (sparse checkout)...\\033[0m\\n\" # Use sparse checkout to only get basilisk-source directory git clone --depth 1 --filter = blob:none --sparse \" \\$ REPO_URL\" basilisk-C-temp if [[ \\$ ? -ne 0 ]]; then printf \"\\033[0;31mError: Failed to clone repository\\033[0m\\n\" echo \"URL: \\$ REPO_URL\" exit 1 fi cd basilisk-C-temp || { printf \"\\033[0;31mError: Failed to change directory to basilisk-C-temp\\033[0m\\n\" >& 2 ; exit 1 ; } git sparse-checkout set basilisk-source cd .. # Move basilisk-source to basilisk printf \"\\033[0;36mSetting up basilisk directory...\\033[0m\\n\" mv basilisk-C-temp/basilisk-source basilisk # Clean up temp clone rm -rf basilisk-C-temp # Apply comphy-lab patches (macOS only) apply_patches \"basilisk\" cd basilisk/src || { printf \"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\" >& 2 ; exit 1 ; } if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then printf \"\\033[0;36mUsing macOS configuration...\\033[0m\\n\" ln -s config.osx config else printf \"\\033[0;36mUsing Linux configuration...\\033[0m\\n\" ln -s config.gcc config fi printf \"\\033[0;36mBuilding basilisk (first pass with -k to continue on errors)...\\033[0m\\n\" make -k printf \"\\033[0;36mBuilding basilisk (final build)...\\033[0m\\n\" make } # Check prerequisites first check_prerequisites # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then printf \"\\033[0;36mInstalling basilisk...\\033[0m\\n\" rm -rf basilisk install_basilisk else printf \"\\033[0;36mUsing existing basilisk installation...\\033[0m\\n\" cd basilisk/src || { printf \"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\" >& 2 ; exit 1 ; } fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\" printf \"\\033[0;36mChecking qcc installation...\\033[0m\\n\" if ! qcc --version > /dev/null 2 >& 1 ; then printf \"\\033[0;31mError: qcc is not working properly.\\033[0m\\n\" if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" else echo \"Please ensure you have build-essential installed.\" echo \"You can install it by running: sudo apt install build-essential\" fi echo \"For more details, visit: https://basilisk.fr/src/INSTALL\" exit 1 else printf \"\\033[0;32m\u2705 qcc is properly installed.\\033[0m\\n\" qcc --version fi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements-no-darcs.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements-no-darcs.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: #!/bin/bash# Linux/macOS version...",
    "content": "#!/bin/bash# Linux/macOS version - uses git instead of darcs# Clones basilisk-source from comphy-lab/basilisk-C GitHub repo# Ensures that we are always using the latest version from our fork# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to check prerequisitescheck_prerequisites(){localmissing_tools=()localfound_tools=()echo\"Checking prerequisites...\"echo\"\"# Check for makeif!command-vmake>/dev/null2>&1;thenmissing_tools+=(\"make\")elsefound_tools+=(\"make\")printf\"\\033[0;32m\u2713 make is installed\\033[0m\\n\"fi# Check for gawkif!command-vgawk>/dev/null2>&1;thenmissing_tools+=(\"gawk\")elsefound_tools+=(\"gawk\")printf\"\\033[0;32m\u2713 gawk is installed\\033[0m\\n\"fi# Check for gitif!command-vgit>/dev/null2>&1;thenmissing_tools+=(\"git\")elsefound_tools+=(\"git\")printf\"\\033[0;32m\u2713 git is installed\\033[0m\\n\"fi# Check for gccif!command-vgcc>/dev/null2>&1;thenmissing_tools+=(\"gcc\")elsefound_tools+=(\"gcc\")printf\"\\033[0;32m\u2713 gcc is installed\\033[0m\\n\"fiecho\"\"if[[\\${#missing_tools[@]}-gt0]];thenprintf\"\\033[0;31mError: Missing required tools:\\${missing_tools[*]}\\033[0m\\n\"echo\"\"if[[\"\\$OSTYPE\"==\"darwin\"*]];then# macOS installation instructionsecho\"To install missing tools on macOS:\"echo\"  xcode-select --install\"echo\"  brew install gawk\"else# Linux installation instructionsecho\"To install missing tools on Linux:\"echo\"  sudo apt install\\${missing_tools[*]}\"fiecho\"\"echo\"Please install the missing tools and try again.\"exit1elseprintf\"\\033[0;32m\u2705 All prerequisites are satisfied!\\033[0m\\n\"echo\"\"fi}# Function to apply comphy-lab patches (macOS only)apply_patches(){localtarget_dir=\"\\$1\"if[[\"\\$OSTYPE\"!=\"darwin\"*]];then# Patches are macOS-specific, skip on other platformsreturn0fiprintf\"\\033[0;36mApplying comphy-lab patches...\\033[0m\\n\"# Create temp directory for patchesmkdir-p\"\\$target_dir/.patches_temp\"# GitHub URLs for patcheslocalPATCHES_URL=\"https://api.github.com/repos/comphy-lab/basilisk-C/contents/patches\"localRAW_BASE_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/patches\"# Get list of patch files (sorted by name for chronological order due to YYYY-MM-DD format)localPATCH_FILESPATCH_FILES=\\$(curl-s\"\\$PATCHES_URL\"|grep-o'\"name\": \"[^\"]*\\.patch\"'|sed's/\"name\": \"//;s/\"//'|sort)if[[-z\"\\$PATCH_FILES\"]];thenprintf\"\\033[0;33mWarning: No patches found or unable to fetch patch list\\033[0m\\n\"else# Download and apply each patchecho\"\\$PATCH_FILES\"|whileread-rpatch_file;doif[[-n\"\\$patch_file\"]];thenecho\"  Downloading\\$patch_file...\"ifcurl-s-f\"\\$RAW_BASE_URL/\\$patch_file\"-o\"\\$target_dir/.patches_temp/\\$patch_file\";thenecho\"  Applying\\$patch_file...\"if(cd\"\\$target_dir\"&&patch-p1<\".patches_temp/\\$patch_file\");thenprintf\"  \\033[0;32m\u2713 Successfully applied\\$patch_file\\033[0m\\n\"elseprintf\"  \\033[0;31m\u2717 Failed to apply\\$patch_file\\033[0m\\n\"fielseprintf\"  \\033[0;31m\u2717 Failed to download\\$patch_file\\033[0m\\n\"fifidonefi# Clean uprm-rf\"\\$target_dir/.patches_temp\"echo\"\"}# Function to install basilisk using git sparse checkout from GitHubinstall_basilisk(){localREPO_URL=\"https://github.com/comphy-lab/basilisk-C.git\"printf\"\\033[0;36mCloning basilisk-source from comphy-lab/basilisk-C (sparse checkout)...\\033[0m\\n\"# Use sparse checkout to only get basilisk-source directorygitclone--depth1--filter=blob:none--sparse\"\\$REPO_URL\"basilisk-C-tempif[[\\$?-ne0]];thenprintf\"\\033[0;31mError: Failed to clone repository\\033[0m\\n\"echo\"URL:\\$REPO_URL\"exit1ficdbasilisk-C-temp||{printf\"\\033[0;31mError: Failed to change directory to basilisk-C-temp\\033[0m\\n\">&2;exit1;}gitsparse-checkout set basilisk-sourcecd..# Move basilisk-source to basiliskprintf\"\\033[0;36mSetting up basilisk directory...\\033[0m\\n\"mvbasilisk-C-temp/basilisk-source basilisk# Clean up temp clonerm-rfbasilisk-C-temp# Apply comphy-lab patches (macOS only)apply_patches\"basilisk\"cdbasilisk/src||{printf\"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\">&2;exit1;}if[[\"\\$OSTYPE\"==\"darwin\"*]];thenprintf\"\\033[0;36mUsing macOS configuration...\\033[0m\\n\"ln-sconfig.osx configelseprintf\"\\033[0;36mUsing Linux configuration...\\033[0m\\n\"ln-sconfig.gcc configfiprintf\"\\033[0;36mBuilding basilisk (first pass with -k to continue on errors)...\\033[0m\\n\"make-kprintf\"\\033[0;36mBuilding basilisk (final build)...\\033[0m\\n\"make}# Check prerequisites firstcheck_prerequisites# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenprintf\"\\033[0;36mInstalling basilisk...\\033[0m\\n\"rm-rfbasiliskinstall_basiliskelseprintf\"\\033[0;36mUsing existing basilisk installation...\\033[0m\\n\"cdbasilisk/src||{printf\"\\033[0;31mError: Failed to change directory to basilisk/src\\033[0m\\n\">&2;exit1;}fi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\"printf\"\\033[0;36mChecking qcc installation...\\033[0m\\n\"if!qcc--version>/dev/null2>&1;thenprintf\"\\033[0;31mError: qcc is not working properly.\\033[0m\\n\"if[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"elseecho\"Please ensure you have build-essential installed.\"echo\"You can install it by running: sudo apt install build-essential\"fiecho\"For more details, visit: https://basilisk.fr/src/INSTALL\"exit1elseprintf\"\\033[0;32m\u2705 qcc is properly installed.\\033[0m\\n\"qcc--versionfi",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/reset_install_requirements-no-darcs.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData.c scalar f[]; 25 vector u[]; 26 27 ~~~ Lightweight utility for extracting Basilisk snapshot data on a structured Cartes... getFacet.c A utility for extracting interface facets from fluid simulation data. Video.py Post-processing pipeline for Basilisk bubble bursting simulations. Overview -------- The helper executables postProce...",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getData-elastic-scalar2D.c See raw file Simulation Data Extraction and Processing This program extracts and processes data from fluid dynamics simulation snapshots, specifically designed for viscoelastic fluid simulations with conformation tensor analysis. It computes important derived quantities including deformation rate tensor components, velocity magnitude, and conformation tensor trace. The program interpolates these quantities onto a regular grid and outputs the results for further analysis or visualization. Physics Background This code handles viscoelastic fluid simulation data where the fluid stress tensor includes both a viscous component (proportional to the deformation rate) and an elastic component (represented by the conformation tensor).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "The trace of the conformation tensor provides a measure of polymer stretching in the fluid. #include \"utils.h\" #include \"output.h\" scalar f []; // Volume fraction field vector u []; // Velocity field scalar A11 [], A12 [], A22 []; // Conformation tensor components scalar conform_qq []; // Additional conformation tensor component char filename [ 80 ]; // Input file name int nx , ny , len ; // Grid dimensions and field count double xmin , ymin , xmax , ymax , Deltax , Deltay ; // Domain boundaries and grid spacing Derived Fields D2c: Log10 of squared deformation rate tensor weighted by volume fraction vel: Magnitude of velocity trA: Log10 of excess trace of conformation tensor scalar D2c [], vel [], trA []; scalar * list = NULL ; // List to store output fields Main Function Processes simulation data and computes derived quantities Arguments: arguments[1]: Input filename arguments[2-5]: Domain boundaries (xmin, ymin, xmax, ymax) arguments[6]: Number of grid points in y-direction (ny) Returns: 0 on successful execution int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); xmin = atof ( arguments [ 2 ]); ymin = atof ( arguments [ 3 ]); xmax = atof ( arguments [ 4 ]); ymax = atof ( arguments [ 5 ]); ny = atoi ( arguments [ 6 ]); // Initialize list of fields to output list = list_add ( list , D2c ); list = list_add ( list , vel ); list = list_add ( list , trA ); Data Processing Workflow Restore simulation state from snapshot file Compute derived quantities at each grid point Interpolate fields onto regular grid Output data to file restore ( file = filename ); Field Computation For each cell, compute: - Components of the deformation rate tensor D - Squared magnitude of D weighted by volume fraction - Velocity magnitude - Excess trace of the conformation tensor foreach () { // Compute deformation rate tensor components double D11 = ( u . y [ 0 , 1 ] - u . y [ 0 , - 1 ]) / ( 2 * Delta ); double D22 = ( u . y [] / y ); double D33 = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ]) / ( 2 * Delta ); double D13 = 0.5 * (( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 , - 1 ]) / ( 2 * Delta )); double D2 = ( sq ( D11 ) + sq ( D22 ) + sq ( D33 ) + 2.0 * sq ( D13 )); D2c [] = f [] * D2 ; // Take log10 of D2c for better visualization if ( D2c [] > 0. ) { D2c [] = log ( D2c []) / log ( 10 ); } else { D2c [] = - 10 ; } // Compute velocity magnitude vel [] = sqrt ( sq ( u . x []) + sq ( u . y [])); // Compute excess trace of conformation tensor trA [] = ( A11 [] + A22 [] + conform_qq []) / 3.0 - 1.0 ; // Take log10 of trA for better visualization if ( trA [] > 0. ) { trA [] = log ( trA []) / log ( 10 ); } else { trA [] = - 10 ; } } Grid Interpolation and Output Calculate grid spacing based on domain size and ny Allocate memory for interpolated field values Interpolate field values onto regular grid Output grid coordinates and field values FILE * fp = ferr ; Deltay = ( double )(( ymax - ymin ) / ( ny )); nx = ( int )(( xmax - xmin ) / Deltay ); Deltax = ( double )(( xmax - xmin ) / ( nx )); len = list_len ( list ); // Allocate memory for field values double ** field = ( double **) matrix_new ( nx , ny + 1 , len * sizeof ( double )); // Interpolate field values onto regular grid for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , x , y ); } } } // Output grid coordinates and field values for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; fprintf ( fp , \" %g %g \" , x , y ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } // Clean up fflush ( fp ); fclose ( fp ); matrix_free ( field ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"scalar f[];// Volume fraction fieldvector u[];// Velocity fieldscalar A11[],A12[],A22[];// Conformation tensor componentsscalar conform_qq[];// Additional conformation tensor componentcharfilename[80];// Input file nameintnx,ny,len;// Grid dimensions and field countdoublexmin,ymin,xmax,ymax,Deltax,Deltay;// Domain boundaries and grid spacing",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "scalar D2c[],vel[],trA[];scalar*list=NULL;// List to store output fields",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);xmin=atof(arguments[2]);ymin=atof(arguments[3]);xmax=atof(arguments[4]);ymax=atof(arguments[5]);ny=atoi(arguments[6]);// Initialize list of fields to outputlist=list_add(list,D2c);list=list_add(list,vel);list=list_add(list,trA);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: foreach(){// Compute deformation...",
    "content": "foreach(){// Compute deformation rate tensor componentsdoubleD11=(u.y[0,1]-u.y[0,-1])/(2*Delta);doubleD22=(u.y[]/y);doubleD33=(u.x[1,0]-u.x[-1,0])/(2*Delta);doubleD13=0.5*((u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(2*Delta));doubleD2=(sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13));D2c[]=f[]*D2;// Take log10 of D2c for better visualizationif(D2c[]>0.){D2c[]=log(D2c[])/log(10);}else{D2c[]=-10;}// Compute velocity magnitudevel[]=sqrt(sq(u.x[])+sq(u.y[]));// Compute excess trace of conformation tensortrA[]=(A11[]+A22[]+conform_qq[])/3.0-1.0;// Take log10 of trA for better visualizationif(trA[]>0.){trA[]=log(trA[])/log(10);}else{trA[]=-10;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "FILE*fp=ferr;Deltay=(double)((ymax-ymin)/(ny));nx=(int)((xmax-xmin)/Deltay);Deltax=(double)((xmax-xmin)/(nx));len=list_len(list);// Allocate memory for field valuesdouble**field=(double**)matrix_new(nx,ny+1,len*sizeof(double));// Interpolate field values onto regular gridfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,x,y);}}}// Output grid coordinates and field valuesfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;fprintf(fp,\"%g%g\",x,y);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}// Clean upfflush(fp);fclose(fp);matrix_free(field);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getFacet2D.c See raw file Getting Facets A utility for extracting interface facets from fluid simulation data. Description This program extracts and outputs the facets representing the interface between different phases in a multiphase flow simulation. The facets define the boundary between fluid phases, useful for geometric analysis and visualization of the interface morphology. Physics Background In multiphase fluid simulations, interfaces between different fluids are critical features that determine many physical phenomena like surface tension effects, droplet formation, and coalescence events. This utility identifies these interfaces by extracting facets from volume fraction data, allowing for quantitative analysis of interfacial dynamics.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "Usage ./getFacets input_file Author: Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Department University of Twente #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" scalar f []; // Volume fraction field char filename [ 80 ]; Main Function Loads a simulation snapshot and extracts the interface facets. Input parameters: arguments[1] : Filename of the simulation snapshot to process Process: Restores the simulation state from the specified file Extracts interface facets from the volume fraction field Outputs facet data to standard error Return value: Returns 0 on successful completion Note: The facet extraction algorithm identifies where the volume fraction field crosses a threshold value (typically 0.5) between adjacent cells. int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"scalar f[];// Volume fraction fieldcharfilename[80];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/Video.py See raw file # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab # Durham University # Last updated: Jan 2026 Post-processing pipeline for Basilisk bubble bursting simulations. Overview The helper executables postProcess/getFacet and postProcess/getData are compiled as part of the Basilisk workflow. This Python wrapper shells out to those binaries for every snapshot, reshapes the returned grids, and renders axisymmetric visualisations with strain-rate and velocity fields. Usage Typical invocation from the repository root:: python3 postProcess/Video.py \u2013caseToProcess simulationCases/1000 Command-line switches expose all relevant knobs (grid density, domain limits, time stride, CPU count).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Import Statements",
    "content": "The output directory is created on-demand and filled with zero-padded PNG files compatible with downstream stitching utilities. import argparse import multiprocessing as mp import os import shutil import subprocess as sp from dataclasses import dataclass from functools import partial from datetime import datetime from typing import Sequence, Tuple, Optional import matplotlib import matplotlib.pyplot as plt import numpy as np from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter # Configure matplotlib with LaTeX if available, fallback otherwise matplotlib.rcParams[ \"font.family\" ] = \"serif\" if shutil.which( \"latex\" ): try : matplotlib.rcParams[ \"text.usetex\" ] = True matplotlib.rcParams[ \"text.latex.preamble\" ] = r\"\\usepackage {amsmath} \" except Exception : matplotlib.rcParams[ \"text.usetex\" ] = False else : matplotlib.rcParams[ \"text.usetex\" ] = False # Script directory for finding helper executables SCRIPT_DIR = os.path.dirname(os.path.abspath( __file__ )) HELPER_GETFACET = os.path.join(SCRIPT_DIR, \"getFacet\" ) HELPER_GETDATA = os.path.join(SCRIPT_DIR, \"getData\" ) @dataclass (frozen = True ) class DomainBounds: Symmetry-aware domain description in cylindrical coordinates.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Class Definition",
    "content": "The code expects r in [rmin, rmax] with rmin <= 0 to leverage the axis of symmetry; z spans freely between zmin and zmax. rmin: float rmax: float zmin: float zmax: float @dataclass (frozen = True ) class RuntimeConfig: Run-time knobs collected from CLI arguments. Multiprocessing workers only need a single instance of this struct, making later CLI additions painless. cpus: int n_snapshots: int grids_per_r: int tsnap: float zmin: float zmax: float rmax: float case_dir: str output_dir: str skip_video_encode: bool framerate: int output_fps: int # Colorbar bounds d2_vmin: float d2_vmax: float vel_vmin: float vel_vmax: float @property def rmin( self ) -> float : return - self .rmax @property def bounds( self ) -> DomainBounds: return DomainBounds( self .rmin, self .rmax, self .zmin, self .zmax) @dataclass (frozen = True ) class PlotStyle: Single source of truth for plot-level choices.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Matplotlib tweaks become...",
    "content": "Matplotlib tweaks become traceable: alter colours, fonts, or geometry here and every rendered frame will stay consistent without touching plotting logic. figure_size: Tuple[ float , float ] = ( 19.20 , 10.80 ) tick_label_size: int = 20 zero_axis_color: str = \"grey\" axis_color: str = \"black\" line_width: float = 2.0 interface_color: str = \"#00B2FF\" colorbar_width: float = 0.03 left_colorbar_offset: float = 0.04 right_colorbar_offset: float = 0.01 @dataclass (frozen = True ) class SnapshotInfo: Metadata for an input snapshot and its output image. Storing paths and the physical time together simplifies filename logic and ensures logging statements stay informative. index: int time: float source: str target: str @dataclass class FieldData: Structured holder around the grids returned by getData. Includes strain-rate (D2) and velocity magnitude fields.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "R: np.ndarray Z: np.ndarray strain_rate: np.ndarray velocity: np.ndarray nz: int @property def radial_extent( self ) -> Tuple[ float , float ]: return self .R. min (), self .R. max () @property def axial_extent( self ) -> Tuple[ float , float ]: return self .Z. min (), self .Z. max () PLOT_STYLE = PlotStyle() def log_status(message: str , * , level: str = \"INFO\" ) -> None : timestamp = datetime.now().strftime(\u201c%H:%M:%S\u201d) print(f\u201d[{timestamp}] [{level}] {message}\u201c, flush=True) def parse_arguments() -> RuntimeConfig: Returns: RuntimeConfig: Configuration object containing all parameters. parser = argparse.ArgumentParser( description=\u201cGenerate snapshot videos for bubble bursting simulations.\u201d ) parser.add_argument(\u201c\u2013CPUs\u201d, type=int, default=4, help=\u201cNumber of CPUs to use\u201d) parser.add_argument( \u201c\u2013nGFS\u201d, type=int, default=500, help=\u201cNumber of restart files to process\u201d ) parser.add_argument( \u201c\u2013GridsPerR\u201d, type=int, default=256, help=\u201cNumber of grids per R\u201d ) parser.add_argument( \u201c\u2013ZMIN\u201d, type=float, default=-4.0, help=\u201cMinimum Z value (default: -4.0)\u201d ) parser.add_argument( \u201c\u2013ZMAX\u201d, type=float, default=4.0, help=\u201cMaximum Z value (default: 4.0)\u201d ) parser.add_argument( \u201c\u2013RMAX\u201d, type=float, default=2.0, help=\u201cMaximum R value (default: 2.0)\u201d ) parser.add_argument(\u201c\u2013tsnap\u201d, type=float, default=0.01, help=\u201cTime snap interval\u201d) parser.add_argument( \u201c\u2013caseToProcess\u201d, type=str, default=\u201csimulationCases/1000\u201d, help=\u201cCase to process\u201d, ) parser.add_argument( \u201c\u2013folderToSave\u201d, type=str, default=None, help=\u201cFolder to save (default: /Video)\u201d ) parser.add_argument( \u201c\u2013skip-video-encode\u201d, action=\u201cstore_true\u201d, help=\u201cSkip ffmpeg video encoding after frame generation\u201d ) parser.add_argument( \u201c\u2013framerate\u201d, type=int, default=90, help=\u201cInput framerate for ffmpeg (default: 90)\u201d ) parser.add_argument( \u201c\u2013output-fps\u201d, type=int, default=30, help=\u201cOutput video framerate (default: 30)\u201d ) # Colorbar bounds parser.add_argument( \u201c\u2013d2-vmin\u201d, type=float, default=-2.0, help=\u201cMin value for strain-rate colorbar (default: -2.0)\u201d ) parser.add_argument( \u201c\u2013d2-vmax\u201d, type=float, default=2.0, help=\u201cMax value for strain-rate colorbar (default: 2.0)\u201d ) parser.add_argument( \u201c\u2013vel-vmin\u201d, type=float, default=0.0, help=\u201cMin value for velocity colorbar (default: 0.0)\u201d ) parser.add_argument( \u201c\u2013vel-vmax\u201d, type=float, default=1.0, help=\u201cMax value for velocity colorbar (default: 1.0)\u201d ) args = parser.parse_args() Default output directory output_dir = args.folderToSave if args.folderToSave else os.path.join(args.caseToProcess, \u201cVideo\u201d) return RuntimeConfig( cpus=args.CPUs, n_snapshots=args.nGFS, grids_per_r=args.GridsPerR, tsnap=args.tsnap, zmin=args.ZMIN, zmax=args.ZMAX, rmax=args.RMAX, case_dir=args.caseToProcess, output_dir=output_dir, skip_video_encode=args.skip_video_encode, framerate=args.framerate, output_fps=args.output_fps, d2_vmin=args.d2_vmin, d2_vmax=args.d2_vmax, vel_vmin=args.vel_vmin, vel_vmax=args.vel_vmax, ) def ensure_directory(path: str) -> None: if not os.path.isdir(path): os.makedirs(path, exist_ok = True ) def run_helper(command: Sequence[ str ], cwd: Optional[ str ] = None ) -> Sequence[ str ]: Run a helper executable and return its stderr as decoded lines.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The compiled helpers...",
    "content": "The compiled helpers deliberately emit their payload to stderr, so stdout is ignored and we return the informative stderr content. Note: Basilisk executables have issues with very long absolute paths, so we support running from a specific working directory with relative paths. process = sp.Popen(command, stdout = sp.PIPE, stderr = sp.PIPE, cwd = cwd) _, stderr = process.communicate() if process.returncode != 0 : raise RuntimeError ( f\"Command { ' ' . join(command) } failed with code { process . returncode } : \\n \" f\" { stderr . decode( 'utf-8' ) } \" ) return stderr.decode( \"utf-8\" ).split( \" \\n \" ) def get_facets(filename: str , case_dir: str ): Shells out to the compiled getFacet executable, which extracts the volume-of-fluid (VOF) interface as a sequence of line segments. Since the simulation uses axisymmetric coordinates, only the r >= 0 half is computed. This function mirrors each segment about r=0.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Args: filename: Relative...",
    "content": "Args: filename: Relative path to snapshot file (e.g., \u2018intermediate/snapshot-0.0100\u2019) case_dir: Absolute path to case directory (used as cwd) Returns: list[tuple]: Sequence of line segments, each as ((r1, z1), (r2, z2)). temp2 = run_helper([HELPER_GETFACET, filename], cwd = case_dir) segs = [] skip = False if len (temp2) > 1e2 : for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: skip = False continue if not skip and n1 + 1 < len (temp2): temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1), (r2, z2))) segs.append((( - r1, z1), ( - r2, z2))) skip = True return segs def get_field(filename: str , case_dir: str , zmin: float , zmax: float , rmax: float , nr: int ) -> FieldData: Shells out to the compiled getData executable, which samples the strain-rate and velocity fields on a structured grid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Args: filename: Relative...",
    "content": "Args: filename: Relative path to snapshot file (e.g., \u2018intermediate/snapshot-0.0100\u2019) case_dir: Absolute path to case directory (used as cwd) zmin: Minimum axial coordinate for sampling domain zmax: Maximum axial coordinate for sampling domain rmax: Maximum radial coordinate (positive branch only) nr: Number of grid points in radial direction Returns: FieldData: Structured container with reshaped 2D arrays. temp2 = run_helper( [ HELPER_GETDATA, filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr), ], cwd = case_dir, ) Rtemp, Ztemp, D2temp, veltemp = [], [], [], [] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: continue Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) nz = int ( len (Z) / nr) log_status( f\" { os . path . basename(filename) } : nz = { nz } \" ) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) return FieldData(R = R, Z = Z, strain_rate = D2, velocity = vel, nz = nz) def build_snapshot_info(index: int , config: RuntimeConfig) -> SnapshotInfo: time = config.tsnap * index source = os.path.join(config.case_dir, \u201cintermediate\u201d, f\u201dsnapshot-{time:.4f}\u201c) target = os.path.join(config.output_dir, f\u201d{int(time * 1000):08d}.png\u201d) return SnapshotInfo(index=index, time=time, source=source, target=target) def draw_domain_outline(ax, bounds: DomainBounds, style: PlotStyle) -> None: ax.plot( [ 0 , 0 ], [bounds.zmin, bounds.zmax], \"-.\" , color = style.zero_axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmin], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmin, bounds.zmin], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmax, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmax, bounds.rmax], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) def add_colorbar(fig, ax, mappable, * , align: str , label: str , style: PlotStyle): l, b, w, h = ax.get_position().bounds if align == \u201cleft\u201d: position = [l - style.left_colorbar_offset, b, style.colorbar_width, h] else: position = [l + w + style.right_colorbar_offset, b, style.colorbar_width, h] cb_ax = fig.add_axes(position) colorbar = plt.colorbar(mappable, cax=cb_ax, orientation=\u201cvertical\u201d) colorbar.set_label(label, fontsize=style.tick_label_size, labelpad=5) colorbar.ax.tick_params(labelsize=style.tick_label_size) colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter(\u201c{x:,.2f}\u201d)) if align == \u201cleft\u201d: colorbar.ax.yaxis.set_ticks_position(\u201cleft\u201d) colorbar.ax.yaxis.set_label_position(\u201cleft\u201d) return colorbar def plot_snapshot( field_data: FieldData, facets, bounds: DomainBounds, snapshot: SnapshotInfo, config: RuntimeConfig, style: PlotStyle, ) -> None: Render and persist a single snapshot figure.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Visualization: - Left...",
    "content": "Visualization: - Left side: log10(D:D) strain - rate field - Right side: velocity magnitude fig, ax = plt.subplots() fig.set_size_inches(*style.figure_size) draw_domain_outline(ax, bounds, style) line_segments = LineCollection( facets, linewidths=4, colors=style.interface_color, linestyle=\u201csolid\u201d ) ax.add_collection(line_segments) rminp, rmaxp = field_data.radial_extent zminp, zmaxp = field_data.axial_extent Left: Strain-rate field (D:D) cntrl1 = ax.imshow( field_data.strain_rate, cmap=\u201chot_r\u201d, interpolation=\u201cBilinear\u201d, origin=\u201clower\u201d, extent=[-rminp, -rmaxp, zminp, zmaxp], vmax=config.d2_vmax, vmin=config.d2_vmin, ) Right: Velocity magnitude cntrl2 = ax.imshow( field_data.velocity, interpolation=\u201cBilinear\u201d, cmap=\u201cPurples\u201d, origin=\u201clower\u201d, extent=[rminp, rmaxp, zminp, zmaxp], vmax=config.vel_vmax, vmin=config.vel_vmin, ) ax.set_aspect(\u201cequal\u201d) ax.set_xlim(bounds.rmin, bounds.rmax) ax.set_ylim(bounds.zmin, bounds.zmax) ax.set_title(f\u201d \\(t/\\\\tau_0\\) = {snapshot.time:4.3f}\u201c, fontsize=style.tick_label_size) ax.axis(\u201doff\u201d) add_colorbar( fig, ax, cntrl1, align=\u201cleft\u201d, label=r\u201d \\(\\log_{10}\\left(\\boldsymbol{\\mathcal{D}:\\mathcal{D}}\\right)\\) \u201c, style=style, ) add_colorbar( fig, ax, cntrl2, align=\u201dright\u201d, label=r\u201d \\(\\|\\boldsymbol{u}\\|\\) \u201c, style=style, ) plt.savefig(snapshot.target, bbox_inches=\u201ctight\u201d) plt.close(fig) def process_timestep(index: int, config: RuntimeConfig, style: PlotStyle) -> None: Worker executed for every timestep index.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Performs availability checks,...",
    "content": "Performs availability checks, loads helper outputs, and calls plot_snapshot. snapshot = build_snapshot_info(index, config) if not os.path.exists(snapshot.source): log_status(f\u201dMissing: {os.path.basename(snapshot.source)}\u201c, level=\u201dWARN\u201d) return if os.path.exists(snapshot.target): log_status(f\u201dExists, skipping: {os.path.basename(snapshot.target)}\u201c) return Show relative path: CaseNo/intermediate/filename src_parts = snapshot.source.split(os.sep) src_rel = os.sep.join(src_parts[-3:]) if len(src_parts) >= 3 else snapshot.source log_status(f\u201dProcessing {src_rel}\u201c) Relative path for Basilisk helpers (they crash with very long absolute paths) rel_snapshot = os.path.join(\u201cintermediate\u201d, f\u201dsnapshot-{snapshot.time:.4f}\u201c) case_dir = os.path.abspath(config.case_dir) try: facets = get_facets(rel_snapshot, case_dir) nr = int(config.grids_per_r * config.rmax) field_data = get_field( rel_snapshot, case_dir, config.zmin, config.zmax, config.rmax, nr ) plot_snapshot(field_data, facets, config.bounds, snapshot, config, style) Show relative path: CaseNo/Video/filename tgt_parts = snapshot.target.split(os.sep) tgt_rel = os.sep.join(tgt_parts[-3:]) if len(tgt_parts) >= 3 else snapshot.target log_status(f\u201dSaved: {tgt_rel}\u201c) except Exception as err: log_status( f\u201dError at {src_rel} (t={snapshot.time:.4f}): {err}\u201c, level=\u201dERROR\u201d ) raise def encode_video(config: RuntimeConfig) -> None: Run ffmpeg to stitch PNG frames into an MP4 video.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The output video...",
    "content": "The output video is saved in the case directory with the case number as filename (e.g., simulationCases / 1000 / 1000. mp4 ).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Extract case number...",
    "content": "Extract case number from path case_no = os.path.basename(config.case_dir) Output path: / .mp4 output_path = os.path.join(config.case_dir, f\u201d{case_no}.mp4\u201d) input_pattern = os.path.join(config.output_dir, \u201c*.png\u201d) cmd = [ \u201cffmpeg\u201d, \u201c-y\u201d, \u201c-framerate\u201d, str(config.framerate), \u201c-pattern_type\u201d, \u201cglob\u201d, \u201c-i\u201d, input_pattern, \u201c-vf\u201d, \u201cpad=ceil(iw/2) 2:ceil(ih/2) 2\u201d, \u201c-c:v\u201d, \u201clibx264\u201d, \u201c-r\u201d, str(config.output_fps), \u201c-pix_fmt\u201d, \u201cyuv420p\u201d, output_path] log_status(f\u201dEncoding video: {output_path}\u201c) result = sp.run(cmd, capture_output=True, text=True) if result.returncode != 0: log_status(f\u201dffmpeg error: {result.stderr}\u201c, level=\u201dERROR\u201d) raise RuntimeError(f\u201dffmpeg failed with code {result.returncode}\u201c) log_status(f\u201dVideo saved: {output_path}\u201c) def main(): config = parse_arguments() ensure_directory(config.output_dir) log_status( f\"Processing case: { config . case_dir } \" ) log_status( f\"Domain: R=[ { config . rmin :.2f} , { config . rmax :.2f} ], Z=[ { config . zmin :.2f} , { config . zmax :.2f} ]\" ) with mp.Pool(processes = config.cpus) as pool: worker = partial(process_timestep, config = config, style = PLOT_STYLE) pool. map (worker, range (config.n_snapshots)) # Encode video unless skipped if not config.skip_video_encode: encode_video(config) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab# Durham University# Last updated: Jan 2026",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "importargparseimportmultiprocessingasmpimportosimportshutilimportsubprocessasspfromdataclassesimportdataclassfromfunctoolsimportpartialfromdatetimeimportdatetimefromtypingimportSequence, Tuple, Optionalimportmatplotlibimportmatplotlib.pyplotaspltimportnumpyasnpfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatter# Configure matplotlib with LaTeX if available, fallback otherwisematplotlib.rcParams[\"font.family\"]=\"serif\"ifshutil.which(\"latex\"):try:matplotlib.rcParams[\"text.usetex\"]=Truematplotlib.rcParams[\"text.latex.preamble\"]=r\"\\usepackage{amsmath}\"exceptException:matplotlib.rcParams[\"text.usetex\"]=Falseelse:matplotlib.rcParams[\"text.usetex\"]=False# Script directory for finding helper executablesSCRIPT_DIR=os.path.dirname(os.path.abspath(__file__))HELPER_GETFACET=os.path.join(SCRIPT_DIR,\"getFacet\")HELPER_GETDATA=os.path.join(SCRIPT_DIR,\"getData\")@dataclass(frozen=True)classDomainBounds:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "rmin:floatrmax:floatzmin:floatzmax:float@dataclass(frozen=True)classRuntimeConfig:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "cpus:intn_snapshots:intgrids_per_r:inttsnap:floatzmin:floatzmax:floatrmax:floatcase_dir:stroutput_dir:strskip_video_encode:boolframerate:intoutput_fps:int# Colorbar boundsd2_vmin:floatd2_vmax:floatvel_vmin:floatvel_vmax:float@propertydefrmin(self)->float:return-self.rmax@propertydefbounds(self)->DomainBounds:returnDomainBounds(self.rmin,self.rmax,self.zmin,self.zmax)@dataclass(frozen=True)classPlotStyle:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "figure_size: Tuple[float,float]=(19.20,10.80)tick_label_size:int=20zero_axis_color:str=\"grey\"axis_color:str=\"black\"line_width:float=2.0interface_color:str=\"#00B2FF\"colorbar_width:float=0.03left_colorbar_offset:float=0.04right_colorbar_offset:float=0.01@dataclass(frozen=True)classSnapshotInfo:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "index:inttime:floatsource:strtarget:str@dataclassclassFieldData:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "R: np.ndarrayZ: np.ndarraystrain_rate: np.ndarrayvelocity: np.ndarraynz:int@propertydefradial_extent(self)->Tuple[float,float]:returnself.R.min(),self.R.max()@propertydefaxial_extent(self)->Tuple[float,float]:returnself.Z.min(),self.Z.max()PLOT_STYLE=PlotStyle()deflog_status(message:str,*, level:str=\"INFO\")->None:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Returns:RuntimeConfig: Configurationobjectcontainingallparameters.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "ifnotos.path.isdir(path):os.makedirs(path, exist_ok=True)defrun_helper(command: Sequence[str], cwd: Optional[str]=None)->Sequence[str]:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "process=sp.Popen(command, stdout=sp.PIPE, stderr=sp.PIPE, cwd=cwd)_, stderr=process.communicate()ifprocess.returncode!=0:raiseRuntimeError(f\"Command{' '.join(command)}failed with code{process.returncode}:\\n\"f\"{stderr.decode('utf-8')}\")returnstderr.decode(\"utf-8\").split(\"\\n\")defget_facets(filename:str, case_dir:str):",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "temp2=run_helper([HELPER_GETFACET, filename], cwd=case_dir)segs=[]skip=Falseiflen(temp2)>1e2:forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:skip=Falsecontinueifnotskipandn1+1<len(temp2):temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1), (r2, z2)))segs.append(((-r1, z1), (-r2, z2)))skip=Truereturnsegsdefget_field(filename:str, case_dir:str, zmin:float, zmax:float, rmax:float, nr:int)->FieldData:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "temp2=run_helper([HELPER_GETDATA,filename,str(zmin),str(0),str(zmax),str(rmax),str(nr),],cwd=case_dir,)Rtemp, Ztemp, D2temp, veltemp=[], [], [], []forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:continueZtemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)nz=int(len(Z)/nr)log_status(f\"{os.path.basename(filename)}: nz ={nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))returnFieldData(R=R, Z=Z, strain_rate=D2, velocity=vel, nz=nz)defbuild_snapshot_info(index:int, config: RuntimeConfig)->SnapshotInfo:",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "ax.plot([0,0],[bounds.zmin, bounds.zmax],\"-.\",color=style.zero_axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmin],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmin, bounds.zmin],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmax, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmax, bounds.rmax],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)defadd_colorbar(fig, ax, mappable,*, align:str, label:str, style: PlotStyle):",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Renderandpersist a single snapshot figure.Visualization:-Left side: log10(D:D) strain-rate field-Right side: velocity magnitude",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Worker executedforevery timestep index.Performs availability checks, loads helper outputs,andcalls plot_snapshot.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Run ffmpeg to stitch PNG frames into an MP4 video.The output videoissavedinthe case directorywiththe case numberasfilename (e.g., simulationCases/1000/1000.mp4).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "config=parse_arguments()ensure_directory(config.output_dir)log_status(f\"Processing case:{config.case_dir}\")log_status(f\"Domain: R=[{config.rmin:.2f},{config.rmax:.2f}], Z=[{config.zmin:.2f},{config.zmax:.2f}]\")withmp.Pool(processes=config.cpus)aspool:worker=partial(process_timestep, config=config, style=PLOT_STYLE)pool.map(worker,range(config.n_snapshots))# Encode video unless skippedifnotconfig.skip_video_encode:encode_video(config)if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/Video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/VideoAxi.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Viscoelastic Visualization Tool This script processes and visualizes fluid dynamics simulation data, particularly focused on droplet impact and deformable soft matter like liquid drops, sheets, and bubbles. It extracts interface positions and scalar field data from simulation files and creates visualizations showing physical quantities like strain rates and stresses. The script is designed to process multiple simulation snapshots in parallel, extracting data using external executables and generating visualizations with proper colormaps, scales, and mathematical labels.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Features: - Extracts...",
    "content": "Features: - Extracts fluid interfaces and scalar fields from simulation files - Generates visualizations with proper colormaps and mathematical labels - Processes multiple timesteps in parallel using multiprocessing - Configurable via command-line arguments for different simulation cases - Creates publication-quality figures with LaTeX-rendered mathematical expressions Usage: python fluid_vis.py [options] Command-line Arguments: \u2013CPUs Number of CPUs to use for parallel processing (default: all available) \u2013nGFS Number of restart files to process (default: 550) \u2013ZMAX Maximum Z coordinate for visualization (default: 4.0) \u2013RMAX Maximum R coordinate for visualization (default: 2.0) \u2013ZMIN Minimum Z coordinate for visualization (default: -4.0) \u2013caseToProcess Path to simulation case directory (default: \u2018../simulationCases/dropImpact\u2019) \u2013folderToSave Directory to save visualization images (default: \u2018dropImpact\u2019) Dependencies: External executables: getFacet2D, getData-elastic-scalar2D Python libraries: numpy, matplotlib, subprocess, multiprocessing Author: Vatsal Sanjay Email: vatsalsanjay@gmail.com Affiliation: Physics of Fluids Last updated: Jul 24, 2024 import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import multiprocessing as mp from functools import partial import argparse import matplotlib.colors as mcolors custom_colors = [ \"white\" , \"#DA8A67\" , \"#A0522D\" , \"#400000\" ] custom_cmap = mcolors.LinearSegmentedColormap.from_list( \"custom_hot\" , custom_colors) # Configure matplotlib for publication-quality figures with LaTeX rendering matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, includeCoat = 'true' ): Extract interface positions (facets) from simulation files.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file includeCoat (str, optional): Whether to include coating layer. Defaults to \u2018true\u2019. Returns: list: List of line segments defining fluid interfaces exe = [ \"./getFacet2D\" , filename, includeCoat] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr): Extract scalar field data from simulation files.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate rmax (float): Maximum R coordinate nr (int): Number of grid points in R direction Returns: tuple: (R, Z, D2, vel, taup, nz) arrays of coordinates and field values exe = [ \"./getData-elastic-scalar2D\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp, taupTemp = [],[],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) taupTemp.append( float (temp3[ 4 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) taup = np.asarray(taupTemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) taup.resize((nz, nr)) return R, Z, D2, vel, taup, nz # ---------------------------------------------------------------------------------------------------------------------- def process_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess): Process a single timestep from simulation data and generate visualization.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Args: ti (int):...",
    "content": "Args: ti (int): Timestep index folder (str): Directory to save output images nGFS (int): Total number of timesteps GridsPerR (int): Grid points per unit length in R direction rmin (float): Minimum R coordinate rmax (float): Maximum R coordinate zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate lw (float): Line width for plot elements caseToProcess (str): Path to simulation case directory t = 0.01 * ti place = f\" { caseToProcess } /intermediate/snapshot- { t :.4f} \" name = f\" { folder } / { int (t * 1000 ) :08d} .png\" if not os.path.exists(place): print ( f\" { place } File not found!\" ) return if os.path.exists(name): print ( f\" { name } Image present!\" ) return segs1 = gettingFacets(place) segs2 = gettingFacets(place, 'false' ) if not segs1 and not segs2: print ( f\"Problem in the available file { place } \" ) return nr = int (GridsPerR * rmax) R, Z, taus, vel, taup, nz = gettingfield(place, zmin, zmax, rmax, nr) zminp, zmaxp, rminp, rmaxp = Z. min (), Z. max (), R. min (), R. max () # Plotting AxesLabel, TickLabel = 50 , 20 fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) # Draw domain boundaries ax.plot([ 0 , 0 ], [zmin, zmax], '-.' , color = 'grey' , linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) # Add fluid interfaces line_segments = LineCollection(segs2, linewidths = 4 , colors = 'green' , linestyle = 'solid' ) ax.add_collection(line_segments) line_segments = LineCollection(segs1, linewidths = 4 , colors = 'blue' , linestyle = 'solid' ) ax.add_collection(line_segments) # Plot scalar fields with colormaps cntrl1 = ax.imshow(taus, cmap = \"hot_r\" , interpolation = 'Bilinear' , origin = 'lower' , extent = [ - rminp, - rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # TODO : fixme the colorbar bounds for taup must be set manually based on the simulated case. cntrl2 = ax.imshow(taup, interpolation = 'Bilinear' , cmap = custom_cmap, origin = 'lower' , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # Set plot properties ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.set_title( f'$t/ \\\\ tau_ \\\\ gamma$ = { t :4.3f} ' , fontsize = TickLabel) # Add colorbars l, b, w, h = ax.get_position().bounds # Left colorbar cb1 = fig.add_axes([l - 0.04 , b, 0.03 , h]) c1 = plt.colorbar(cntrl1, cax = cb1, orientation = 'vertical' ) c1.set_label( r' $ \\ log_ {10} \\ left ( \\| \\m athcal{D} \\|\\r ight ) $ ' , fontsize = TickLabel, labelpad = 5 ) c1.ax.tick_params(labelsize = TickLabel) c1.ax.yaxis.set_ticks_position( 'left' ) c1.ax.yaxis.set_label_position( 'left' ) c1.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.1f} ' )) # Right colorbar cb2 = fig.add_axes([l + w + 0.01 , b, 0.03 , h]) c2 = plt.colorbar(cntrl2, cax = cb2, orientation = 'vertical' ) c2.ax.tick_params(labelsize = TickLabel) c2.set_label( r' $ \\ log_ {10} \\ left ( \\t ext{tr} \\ left ( \\m athcal{A} \\r ight ) -1 \\r ight ) $ ' , fontsize = TickLabel) c2.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.2f} ' )) ax.axis( 'off' ) plt.savefig(name, bbox_inches = \"tight\" ) plt.close() def main(): Main function that parses command-line arguments and parallelizes processing of timesteps. # Set up command-line argument parsing parser = argparse.ArgumentParser(description = 'Process fluid dynamics simulation data and create visualizations' ) parser.add_argument( '--CPUs' , type = int , default = mp.cpu_count(), help = 'Number of CPUs to use (default: all available)' ) parser.add_argument( '--nGFS' , type = int , default = 550 , help = 'Number of restart files to process (default: 550)' ) parser.add_argument( '--ZMAX' , type = float , default = 4.0 , help = 'Maximum Z value (default: 4.0)' ) parser.add_argument( '--RMAX' , type = float , default = 2.0 , help = 'Maximum R value (default: 2.0)' ) parser.add_argument( '--ZMIN' , type = float , default =- 4.0 , help = 'Minimum Z value (default: -4.0)' ) parser.add_argument( '--caseToProcess' , type = str , default = '../simulationCases/dropImpact' , help = 'Case to process (default: ../simulationCases/dropImpact)' ) parser.add_argument( '--folderToSave' , type = str , default = 'dropImpact' , help = 'Folder to save output images (default: dropImpact)' ) args = parser.parse_args() # Extract arguments CPUStoUse = args.CPUs nGFS = args.nGFS ZMAX = args.ZMAX RMAX = args.RMAX ZMIN = args.ZMIN num_processes = CPUStoUse rmin, rmax, zmin, zmax = [ - RMAX, RMAX, ZMIN, ZMAX] GridsPerR = 128 # Grid resolution parameter lw = 2 # Line width for plot elements folder = args.folderToSave caseToProcess = args.caseToProcess # Create output directory if it doesn't exist if not os.path.isdir(folder): os.makedirs(folder) # Create a pool of worker processes for parallel processing with mp.Pool(processes = num_processes) as pool: # Create partial function with fixed arguments process_func = partial(process_timestep, folder = folder, nGFS = nGFS, GridsPerR = GridsPerR, rmin = rmin, rmax = rmax, zmin = zmin, zmax = zmax, lw = lw, caseToProcess = caseToProcess) # Map the process_func to all timesteps pool. map (process_func, range (nGFS)) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Methods",
    "content": "importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportmultiprocessingasmpfromfunctoolsimportpartialimportargparseimportmatplotlib.colorsasmcolorscustom_colors=[\"white\",\"#DA8A67\",\"#A0522D\",\"#400000\"]custom_cmap=mcolors.LinearSegmentedColormap.from_list(\"custom_hot\", custom_colors)# Configure matplotlib for publication-quality figures with LaTeX renderingmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, includeCoat='true'):",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "exe=[\"./getFacet2D\", filename, includeCoat]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr):",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "exe=[\"./getData-elastic-scalar2D\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp, taupTemp=[],[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))taupTemp.append(float(temp3[4]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)taup=np.asarray(taupTemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))taup.resize((nz, nr))returnR, Z, D2, vel, taup, nz# ----------------------------------------------------------------------------------------------------------------------defprocess_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess):",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "t=0.01*tiplace=f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\"name=f\"{folder}/{int(t*1000):08d}.png\"ifnotos.path.exists(place):print(f\"{place}File not found!\")returnifos.path.exists(name):print(f\"{name}Image present!\")returnsegs1=gettingFacets(place)segs2=gettingFacets(place,'false')ifnotsegs1andnotsegs2:print(f\"Problem in the available file{place}\")returnnr=int(GridsPerR*rmax)R, Z, taus, vel, taup, nz=gettingfield(place, zmin, zmax, rmax, nr)zminp, zmaxp, rminp, rmaxp=Z.min(), Z.max(), R.min(), R.max()# PlottingAxesLabel, TickLabel=50,20fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)# Draw domain boundariesax.plot([0,0], [zmin, zmax],'-.', color='grey', linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-', color='black', linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-', color='black', linewidth=lw)# Add fluid interfacesline_segments=LineCollection(segs2, linewidths=4, colors='green', linestyle='solid')ax.add_collection(line_segments)line_segments=LineCollection(segs1, linewidths=4, colors='blue', linestyle='solid')ax.add_collection(line_segments)# Plot scalar fields with colormapscntrl1=ax.imshow(taus, cmap=\"hot_r\", interpolation='Bilinear', origin='lower',extent=[-rminp,-rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)#TODO: fixme the colorbar bounds for taup must be set manually based on the simulated case.cntrl2=ax.imshow(taup, interpolation='Bilinear', cmap=custom_cmap, origin='lower',extent=[rminp, rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)# Set plot propertiesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.set_title(f'$t/\\\\tau_\\\\gamma$ ={t:4.3f}', fontsize=TickLabel)# Add colorbarsl, b, w, h=ax.get_position().bounds# Left colorbarcb1=fig.add_axes([l-0.04, b,0.03, h])c1=plt.colorbar(cntrl1, cax=cb1, orientation='vertical')c1.set_label(r'$\\log_{10}\\left(\\|\\mathcal{D}\\|\\right)$', fontsize=TickLabel, labelpad=5)c1.ax.tick_params(labelsize=TickLabel)c1.ax.yaxis.set_ticks_position('left')c1.ax.yaxis.set_label_position('left')c1.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}'))# Right colorbarcb2=fig.add_axes([l+w+0.01, b,0.03, h])c2=plt.colorbar(cntrl2, cax=cb2, orientation='vertical')c2.ax.tick_params(labelsize=TickLabel)c2.set_label(r'$\\log_{10}\\left(\\text{tr}\\left(\\mathcal{A}\\right)-1\\right)$', fontsize=TickLabel)c2.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.2f}'))ax.axis('off')plt.savefig(name, bbox_inches=\"tight\")plt.close()defmain():",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: # Set up...",
    "content": "# Set up command-line argument parsingparser=argparse.ArgumentParser(description='Process fluid dynamics simulation data and create visualizations')parser.add_argument('--CPUs',type=int, default=mp.cpu_count(),help='Number of CPUs to use (default: all available)')parser.add_argument('--nGFS',type=int, default=550,help='Number of restart files to process (default: 550)')parser.add_argument('--ZMAX',type=float, default=4.0,help='Maximum Z value (default: 4.0)')parser.add_argument('--RMAX',type=float, default=2.0,help='Maximum R value (default: 2.0)')parser.add_argument('--ZMIN',type=float, default=-4.0,help='Minimum Z value (default: -4.0)')parser.add_argument('--caseToProcess',type=str,default='../simulationCases/dropImpact',help='Case to process (default: ../simulationCases/dropImpact)')parser.add_argument('--folderToSave',type=str, default='dropImpact',help='Folder to save output images (default: dropImpact)')args=parser.parse_args()# Extract argumentsCPUStoUse=args.CPUsnGFS=args.nGFSZMAX=args.ZMAXRMAX=args.RMAXZMIN=args.ZMINnum_processes=CPUStoUsermin, rmax, zmin, zmax=[-RMAX, RMAX, ZMIN, ZMAX]GridsPerR=128# Grid resolution parameterlw=2# Line width for plot elementsfolder=args.folderToSavecaseToProcess=args.caseToProcess# Create output directory if it doesn't existifnotos.path.isdir(folder):os.makedirs(folder)# Create a pool of worker processes for parallel processingwithmp.Pool(processes=num_processes)aspool:# Create partial function with fixed argumentsprocess_func=partial(process_timestep,folder=folder, nGFS=nGFS,GridsPerR=GridsPerR, rmin=rmin, rmax=rmax,zmin=zmin, zmax=zmax, lw=lw, caseToProcess=caseToProcess)# Map the process_func to all timestepspool.map(process_func,range(nGFS))if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getFacet.c See raw file Getting Facets A utility for extracting interface facets from fluid simulation data. Description This program extracts and outputs the facets representing the interface between different phases in a multiphase flow simulation. The facets define the boundary between fluid phases, useful for geometric analysis and visualization of the interface morphology. Physics Background In multiphase fluid simulations, interfaces between different fluids are critical features that determine many physical phenomena like surface tension effects, droplet formation, and coalescence events. This utility identifies these interfaces by extracting facets from volume fraction data, allowing for quantitative analysis of interfacial dynamics.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "Usage ./getFacets input_file Author: Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Department University of Twente #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" scalar f []; // Volume fraction field char filename [ 80 ]; Main Function Loads a simulation snapshot and extracts the interface facets. Input parameters: arguments[1] : Filename of the simulation snapshot to process Process: Restores the simulation state from the specified file Extracts interface facets from the volume fraction field Outputs facet data to standard error Return value: Returns 0 on successful completion Note: The facet extraction algorithm identifies where the volume fraction field crosses a threshold value (typically 0.5) between adjacent cells. int main ( int a , char const * arguments []) { sprintf ( filename , \"%s\" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"scalar f[];// Volume fraction fieldcharfilename[80];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);return0;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getFacet.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getData.c See raw file /* Title: getting Data from simulation snapshot # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab # Durham University # Last updated: Jan 2026 #include \u201cutils.h\u201d #include \u201coutput.h\u201d Geometry configuration: Set AXI=1 for axisymmetric, AXI=0 for 2D Cartesian. Axisymmetric: x=radial, y=axial (includes azimuthal D22 term) 2D Cartesian: x=x-coordinate, y=y-coordinate (no D22 term) To change geometry: Method 1: Edit line 22 below - change \u201cAXI 1\u201d to \u201cAXI 0\u201d for 2D Method 2: Compile with flag: qcc -DAXI=0 \u2026 (for 2D executable) #ifndef AXI #define AXI // Default to axisymmetric #endif scalar f []; vector u []; Lightweight utility for extracting Basilisk snapshot data on a structured Cartesian sampling grid. The workflow is intentionally linear: Parse CLI bounds/grid spacing into extraction_config . Restore the snapshot ( restore(file=...) ). Register each derived scalar in field_list . Compute fields and interpolate them onto a regular grid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Stream x, y,...",
    "content": "Stream x, y, <fields\u2026> rows to stderr (used as output pipe).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: To add a...",
    "content": "To add a new derived quantity (e.g., Aij): Declare scalar: scalar Aij[]; (line ~38) Register in register_fields() : field_list = list_add(field_list, Aij); Compute in compute_fields() : compute_Aij_field(Aij); Write compute function: static void compute_Aij_field(scalar target) { ... } typedef struct { char filename [ 4096 ]; double xmin , ymin , xmax , ymax ; double Deltax , Deltay ; int nx , ny ; } extraction_config ; scalar D2c [], vel []; scalar * field_list = NULL ; static int parse_arguments ( int argc , char const * argv [], extraction_config * cfg ); static int configure_grid ( extraction_config * cfg ); static void register_fields ( void ); static void compute_fields ( void ); static double ** allocate_field_buffer ( const extraction_config * cfg , int field_count ); static void sample_fields ( const extraction_config * cfg , double ** field_buffer , int field_count ); static void write_fields ( const extraction_config * cfg , double ** field_buffer , int field_count , FILE * fp ); static void cleanup_output ( FILE * fp , double ** field_buffer ); static void compute_D2c_field ( scalar target ); static void compute_velocity_field ( scalar target ); @brief Entry point for simulation snapshot extraction and processing.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "This function validates command-line arguments and orchestrates the simulation data restoration, derivative and velocity computations, and interpolation onto a grid. It expects the program name followed by exactly six parameters: a filename, the lower bounds (xmin and ymin), the upper bounds (xmax and ymax), and the number of divisions along the y-axis (ny).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: If the argument...",
    "content": "If the argument count is incorrect, an error message and usage instructions are printed to stderr and the program exits with a status of 1. @param a The total number of command-line arguments. @param arguments Array of command-line argument strings, where arguments[0] is the program name and the remaining elements provide the required simulation parameters. @return int Exit status of the program (1 on error, 0 on success). int main ( int a , char const * arguments []) { extraction_config cfg ; if (! parse_arguments ( a , arguments , & cfg )) return 1 ; if (! configure_grid (& cfg )) return 1 ; register_fields (); restore ( file = cfg . filename ); compute_fields (); int registered_fields = list_len ( field_list ); double ** field = allocate_field_buffer (& cfg , registered_fields ); sample_fields (& cfg , field , registered_fields ); FILE * fp = ferr ; write_fields (& cfg , field , registered_fields , fp ); cleanup_output ( fp , field ); } static int parse_arguments ( int argc , char const * argv [], extraction_config * cfg ) { Read CLI arguments and guard against invalid bounds/grid sizes. if ( argc != 7 ) { fprintf ( stderr , \"Error: Expected 6 arguments \\n \" ); fprintf ( stderr , \"Usage: %s <filename> <xmin> <ymin> \" \"<xmax> <ymax> <ny> \\n \" , argv [ 0 ]); return 0 ; } snprintf ( cfg -> filename , sizeof ( cfg -> filename ), \"%s\" , argv [ 1 ]); cfg -> xmin = atof ( argv [ 2 ]); cfg -> ymin = atof ( argv [ 3 ]); cfg -> xmax = atof ( argv [ 4 ]); cfg -> ymax = atof ( argv [ 5 ]); cfg -> ny = atoi ( argv [ 6 ]); if ( cfg -> ny <= 0 ) { fprintf ( stderr , \"Error: ny must be positive. \\n \" ); return 0 ; } if ( cfg -> xmax <= cfg -> xmin || cfg -> ymax <= cfg -> ymin ) { fprintf ( stderr , \"Error: Bounds must satisfy xmax>xmin \" \"and ymax>ymin. \\n \" ); return 0 ; } return 1 ; } static int configure_grid ( extraction_config * cfg ) { Translate bounds and ny into nx, \u0394x, \u0394y for regular sampling. cfg -> Deltay = ( cfg -> ymax - cfg -> ymin )/(( double ) cfg -> ny ); cfg -> nx = ( int ) (( cfg -> xmax - cfg -> xmin )/ cfg -> Deltay ); if ( cfg -> nx <= 0 ) { fprintf ( stderr , \"Error: Computed nx <= 0. \" \"Check the provided bounds. \\n \" ); return 0 ; } cfg -> Deltax = ( cfg -> xmax - cfg -> xmin )/(( double ) cfg -> nx ); return 1 ; } static void register_fields ( void ) { Populate Basilisk list with each scalar field.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: To add a...",
    "content": "To add a new field, declare the scalar at the top and add it here. field_list = list_add ( field_list , D2c ); field_list = list_add ( field_list , vel ); } static void compute_fields ( void ) { Dispatch compute callbacks for each field. To add a new field, add a compute call here. compute_D2c_field ( D2c ); compute_velocity_field ( vel ); } static double ** allocate_field_buffer ( const extraction_config * cfg , int registered_fields ) { return ( double **) matrix_new ( cfg -> nx , cfg -> ny + 1 , registered_fields * sizeof ( double )); } static void sample_fields ( const extraction_config * cfg , double ** field_buffer , int registered_fields ) { Interpolate every registered scalar on the regular grid that we later dump.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The matrix layout...",
    "content": "The matrix layout follows Basilisk\u2019s matrix_new : row-major on i (x), with contiguous blocks of registered_fields entries per (i, j). for ( int i = 0 ; i < cfg -> nx ; i ++) { double x = cfg -> Deltax *( i + 1. / 2 ) + cfg -> xmin ; for ( int j = 0 ; j < cfg -> ny ; j ++) { double y = cfg -> Deltay *( j + 1. / 2 ) + cfg -> ymin ; int k = 0 ; for ( scalar s in field_list ) field_buffer [ i ][ registered_fields * j + k ++] = interpolate ( s , x , y ); } } } static void write_fields ( const extraction_config * cfg , double ** field_buffer , int registered_fields , FILE * fp ) { Stream rows in the format: x y field0 field1 \u2026 for ( int i = 0 ; i < cfg -> nx ; i ++) { double x = cfg -> Deltax *( i + 1. / 2 ) + cfg -> xmin ; for ( int j = 0 ; j < cfg -> ny ; j ++) { double y = cfg -> Deltay *( j + 1. / 2 ) + cfg -> ymin ; fprintf ( fp , \"%g %g\" , x , y ); int k = 0 ; for ( scalar s in field_list ) fprintf ( fp , \" %g\" , field_buffer [ i ][ registered_fields * j + k ++]); fputc ( '\\n' , fp ); } } } static void cleanup_output ( FILE * fp , double ** field_buffer ) { fflush ( fp ); fclose ( fp ); matrix_free ( field_buffer ); } @brief Compute log10(D\u00b2) where D\u00b2 is the second invariant of the strain rate tensor.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Geometry-dependent formulation: Axisymmetric...",
    "content": "Geometry-dependent formulation: Axisymmetric (AXI=1, x=radial, y=axial): D11 = \u2202u_y/\u2202y (axial velocity gradient) D22 = u_y/y (azimuthal component from cylindrical geometry) D33 = \u2202u_x/\u2202x (radial velocity gradient) D13 = (\u2202u_y/\u2202x + \u2202u_x/\u2202y)/2 (shear component) D\u00b2 = D11\u00b2 + D22\u00b2 + D33\u00b2 + 2*D13\u00b2 2D Cartesian (AXI=0, x and y coordinates): D11 = \u2202u_y/\u2202y D33 = \u2202u_x/\u2202x D13 = (\u2202u_y/\u2202x + \u2202u_x/\u2202y)/2 D\u00b2 = D11\u00b2 + D33\u00b2 + 2*D13\u00b2 (no D22 term) Returns log10(D\u00b2) for positive values, -10 otherwise (floor for visualization).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Shown throughout the...",
    "content": "Shown throughout the entire domain. static void compute_D2c_field ( scalar target ) { foreach () { double D11 = ( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ])/( 2 * Delta ); #if AXI double D22 = ( y > 1e-10 ) ? u . y []/ y : 0.0 ; // Epsilon guard for axis #endif double D33 = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2 * Delta ); double D13 = 0.5 *(( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 2 * Delta )); #if AXI double D2 = sq ( D11 ) + sq ( D22 ) + sq ( D33 ) + 2. * sq ( D13 ); #else double D2 = sq ( D11 ) + sq ( D33 ) + 2. * sq ( D13 ); #endif target [] = D2 ; if ( target [] > 0. ) target [] = log ( target [])/ log ( 10 ); else target [] = - 10 ; } } @brief Compute velocity magnitude.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Geometry-independent calculation: Axisymmetric...",
    "content": "Geometry-independent calculation: Axisymmetric (AXI=1): u.x=radial, u.y=axial 2D Cartesian (AXI=0): u.x=x-component, u.y=y-component Returns |u| = sqrt(u_x\u00b2 + u_y\u00b2). static void compute_velocity_field ( scalar target ) { foreach () target [] = sqrt ( sq ( u . x []) + sq ( u . y [])); }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: AXI",
    "content": "#ifndef AXI#define AXI// Default to axisymmetric#endifscalar f[];vector u[];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "static void compute_Aij_field(scalar target) { ... }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "typedefstruct{charfilename[4096];doublexmin,ymin,xmax,ymax;doubleDeltax,Deltay;intnx,ny;}extraction_config;scalar D2c[],vel[];scalar*field_list=NULL;staticintparse_arguments(intargc,charconst*argv[],extraction_config*cfg);staticintconfigure_grid(extraction_config*cfg);staticvoidregister_fields(void);staticvoidcompute_fields(void);staticdouble**allocate_field_buffer(constextraction_config*cfg,intfield_count);staticvoidsample_fields(constextraction_config*cfg,double**field_buffer,intfield_count);staticvoidwrite_fields(constextraction_config*cfg,double**field_buffer,intfield_count,FILE*fp);staticvoidcleanup_output(FILE*fp,double**field_buffer);staticvoidcompute_D2c_field(scalar target);staticvoidcompute_velocity_field(scalar target);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "intmain(inta,charconst*arguments[]){extraction_config cfg;if(!parse_arguments(a,arguments,&cfg))return1;if(!configure_grid(&cfg))return1;register_fields();restore(file=cfg.filename);compute_fields();intregistered_fields=list_len(field_list);double**field=allocate_field_buffer(&cfg,registered_fields);sample_fields(&cfg,field,registered_fields);FILE*fp=ferr;write_fields(&cfg,field,registered_fields,fp);cleanup_output(fp,field);}staticintparse_arguments(intargc,charconst*argv[],extraction_config*cfg){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: if(argc!=7){fprintf(stderr,\"Error: Expected 6...",
    "content": "if(argc!=7){fprintf(stderr,\"Error: Expected 6 arguments\\n\");fprintf(stderr,\"Usage: %s <filename> <xmin> <ymin> \"\"<xmax> <ymax> <ny>\\n\",argv[0]);return0;}snprintf(cfg->filename,sizeof(cfg->filename),\"%s\",argv[1]);cfg->xmin=atof(argv[2]);cfg->ymin=atof(argv[3]);cfg->xmax=atof(argv[4]);cfg->ymax=atof(argv[5]);cfg->ny=atoi(argv[6]);if(cfg->ny<=0){fprintf(stderr,\"Error: ny must be positive.\\n\");return0;}if(cfg->xmax<=cfg->xmin||cfg->ymax<=cfg->ymin){fprintf(stderr,\"Error: Bounds must satisfy xmax>xmin \"\"and ymax>ymin.\\n\");return0;}return1;}staticintconfigure_grid(extraction_config*cfg){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "cfg->Deltay=(cfg->ymax-cfg->ymin)/((double)cfg->ny);cfg->nx=(int)((cfg->xmax-cfg->xmin)/cfg->Deltay);if(cfg->nx<=0){fprintf(stderr,\"Error: Computed nx <= 0. \"\"Check the provided bounds.\\n\");return0;}cfg->Deltax=(cfg->xmax-cfg->xmin)/((double)cfg->nx);return1;}staticvoidregister_fields(void){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "field_list=list_add(field_list,D2c);field_list=list_add(field_list,vel);}staticvoidcompute_fields(void){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "compute_D2c_field(D2c);compute_velocity_field(vel);}staticdouble**allocate_field_buffer(constextraction_config*cfg,intregistered_fields){return(double**)matrix_new(cfg->nx,cfg->ny+1,registered_fields*sizeof(double));}staticvoidsample_fields(constextraction_config*cfg,double**field_buffer,intregistered_fields){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "for(inti=0;i<cfg->nx;i++){doublex=cfg->Deltax*(i+1./2)+cfg->xmin;for(intj=0;j<cfg->ny;j++){doubley=cfg->Deltay*(j+1./2)+cfg->ymin;intk=0;for(scalar s in field_list)field_buffer[i][registered_fields*j+k++]=interpolate(s,x,y);}}}staticvoidwrite_fields(constextraction_config*cfg,double**field_buffer,intregistered_fields,FILE*fp){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "for(inti=0;i<cfg->nx;i++){doublex=cfg->Deltax*(i+1./2)+cfg->xmin;for(intj=0;j<cfg->ny;j++){doubley=cfg->Deltay*(j+1./2)+cfg->ymin;fprintf(fp,\"%g %g\",x,y);intk=0;for(scalar s in field_list)fprintf(fp,\" %g\",field_buffer[i][registered_fields*j+k++]);fputc('\\n',fp);}}}staticvoidcleanup_output(FILE*fp,double**field_buffer){fflush(fp);fclose(fp);matrix_free(field_buffer);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "staticvoidcompute_D2c_field(scalar target){foreach(){doubleD11=(u.y[0,1]-u.y[0,-1])/(2*Delta);#if AXIdoubleD22=(y>1e-10)?u.y[]/y:0.0;// Epsilon guard for axis#endifdoubleD33=(u.x[1,0]-u.x[-1,0])/(2*Delta);doubleD13=0.5*((u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(2*Delta));#if AXIdoubleD2=sq(D11)+sq(D22)+sq(D33)+2.*sq(D13);#elsedoubleD2=sq(D11)+sq(D33)+2.*sq(D13);#endiftarget[]=D2;if(target[]>0.)target[]=log(target[])/log(10);elsetarget[]=-10;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "staticvoidcompute_velocity_field(scalar target){foreach()target[]=sqrt(sq(u.x[])+sq(u.y[]));}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "simulationCases/burstingBubbleVE.c See raw file Bursting Bubbles in Viscoelastic Media Simulation This simulation models the dynamics of bursting bubbles in viscoelastic media using the Basilisk framework. It particularly focuses on the formation of Worthington jets and droplets that emerge during the bursting process. Physics Overview The simulation implements a two-phase flow model with viscoelastic properties, utilizing the log-conformation approach for numerical stability. This approach preserves the positive-definiteness of the conformation tensor, which is crucial for stable simulations of viscoelastic fluids at high Deborah numbers. For theoretical details, see: V.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Sanjay, Zenodo, DOI:...",
    "content": "Sanjay, Zenodo, DOI: 10.5281/zenodo.14210635 (2024) Usage ./program maxLevel De Ec Oh Bond tmax Where: - maxLevel : Maximum refinement level for adaptive mesh - De : Deborah number (ratio of relaxation time to flow time) - Ec : Elasto-capillary number (ratio of elastic to surface tension forces) - Oh : Ohnesorge number (ratio of viscous to inertial-capillary forces) - Bond : Bond number (ratio of gravitational to surface tension forces) - tmax : Maximum simulation time @file burstingBubbleVE.c @author Vatsal Sanjay and Ayush Dixit @version 1.0 @date Nov 23, 2024 - Work used in the paper: DOI: 10.1017/jfm.2025.237 #include \"axi.h\" #include \"navier-stokes/centered.h\" // Uncomment to use the scalar version of the viscoelastic code // #define _SCALAR #if !_SCALAR #include \"log-conform-viscoelastic.h\" #else #include \"log-conform-viscoelastic-scalar-2D.h\" #endif Simulation Parameters FILTERED : Enable density and viscosity jump smoothing tsnap : Time interval between snapshots (default: 1e-2) fErr : Error tolerance for volume fraction (1e-3) KErr : Error tolerance for curvature calculation (1e-6) VelErr : Error tolerance for velocity field (1e-3) AErr : Error tolerance for conformation tensor (1e-3) Ldomain : Domain size in characteristic lengths (8) #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #if !_MPI #include \"distance.h\" #endif #define tsnap ( 1e-2 ) // 0.001 only for some cases. // Error tolerances #define fErr ( 1e-3 ) // Error tolerance in f1 VOF #define KErr ( 1e-6 ) // Error tolerance in VoF curvature calculated using height function method #define VelErr ( 1e-3 ) // Error tolerances in velocity - Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define AErr ( 1e-3 ) // Error tolerances in conformation inside the liquid // Domain size #define Ldomain 8 79 // Boundary conditions - outflow on the right boundary u . n [ right ] = neumann ( 0. ); p [ right ] = dirichlet ( 0. ); int MAXlevel ; // Physical parameters: // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // De -> Deborah number // Ec -> Elasto-capillary number double Oh , Oha , De , Ec , Bond , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes the simulation parameters and sets up the domain.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Uses command line...",
    "content": "Uses command line arguments to set simulation parameters Sets up the physical domain with appropriate dimensions Configures fluid properties for both phases Creates necessary directories for output int main ( int argc , char const * argv []) { dtmax = 1e-5 ; // BEWARE of this for stability issues. L0 = Ldomain ; origin (- L0 / 2. , 0. ); // Values taken from the terminal. Here we use some representative values. // In production run, you can pass it from the command line. MAXlevel = 10 ; // atoi(argv[1]); De = 0.1 ; // atof(argv[2]); // Use 1e30 to simulate the De \u2192 \u221e limit Ec = 0.01 ; // atof(argv[3]); Oh = 1e-2 ; // atof(argv[4]); Bond = 1e-3 ; // atof(argv[5]); tmax = 1e0 ; // atof(argv[6]); // Ensure that all the variables were transferred properly from the terminal or job script. // if (argc < 7){ // fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Need %d more...",
    "content": "Need %d more arguments\\n\", 7-argc); // return 1; // } init_grid ( 1 << 5 ); // Create a folder named intermediate where all the simulation snapshots are stored. char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "See writingFiles event. sprintf ( dumpFile , \"restart\" ); Physical Properties Configuration Sets up the material properties for both phases: - rho1 , rho2 : Density of liquid and gas phases - mu1 , mu2 : Dynamic viscosity of liquid and gas phases - lambda1 , lambda2 : Relaxation times - G1 , G2 : Elastic moduli Dimensionless parameters: - Oh : Ohnesorge number for liquid phase - Oha : Ohnesorge number for gas phase (= 2e-2 * Oh) - De : Deborah number - Ec : Elasto-capillary number - Bond : Bond number rho1 = 1. , rho2 = 1e-3 ; Oha = 2e-2 * Oh ; mu1 = Oh , mu2 = Oha ; lambda1 = De ; lambda2 = 0. ; G1 = Ec ; G2 = 0. ; f . sigma = 1.0 ; TOLERANCE = 1e-4 ; CFL = 1e-1 ; run (); } Initialization Event Sets up the initial conditions for the simulation. The function attempts to restore from a dump file first.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: If that fails:...",
    "content": "If that fails: - For MPI runs: Ends with an error - For non-MPI runs: Tries to load an initial shape from a data file, creates a distance field, and initializes the volume fraction event init ( t = 0 ) { #if _MPI // This is for supercomputers without OpenMP support if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else // Note that distance.h is incompatible with OpenMPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: So, the below...",
    "content": "So, the below code should not be used with MPI if (! restore ( file = dumpFile )) { char filename [ 60 ]; sprintf ( filename , \"Bo %5.4f .dat\" , Bond ); FILE * fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); // Try in folder one level up sprintf ( filename , \"../Bo %5.4f .dat\" , Bond ); fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); return 1 ; } } coord * InitialShape ; InitialShape = input_xy ( fp ); fclose ( fp ); scalar d []; distance ( d , InitialShape ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-8 , 1e-8 }, MAXlevel ). nf ); // The distance function is defined at the center of each cell, we have // to calculate the value of this function at each vertex. vertex scalar phi []; foreach_vertex () { phi [] = -( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ])/ 4. ; } // We can now initialize the volume fraction of the domain. fractions ( phi , f ); } // return 1; #endif } Adaptive Mesh Refinement Refines the mesh based on gradients of key fields: - Volume fraction - Velocity components - Conformation tensor components - Curvature The refinement criteria are set by the error tolerance parameters defined at the beginning of the file.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This adaptive approach...",
    "content": "This adaptive approach allows for high resolution in regions of interest while maintaining computational efficiency. event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); #if !_SCALAR adapt_wavelet (( scalar *){ f , u . x , u . y , conform_p . x . x , conform_p . y . y , conform_p . y . x , conform_qq , KAPPA }, ( double []){ fErr , VelErr , VelErr , AErr , AErr , AErr , AErr , KErr }, MAXlevel , MAXlevel - 6 ); #else adapt_wavelet (( scalar *){ f , u . x , u . y , A11 , A22 , A12 , AThTh , KAPPA }, ( double []){ fErr , VelErr , VelErr , AErr , AErr , AErr , AErr , KErr }, MAXlevel , MAXlevel - 6 ); #endif } Output Management Creates periodic snapshots of the simulation state. - Dumps restart files for simulation recovery - Saves intermediate snapshots at regular intervals defined by tsnap event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Simulation Termination Writes a final summary of the simulation parameters when the simulation ends. event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d , De %2.1e , Ec %2.1e , Oh %2.1e , Oha %2.1e , Bo %4.3f\\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); } Simulation Logging Records key simulation data at each timestep: - Iteration number - Timestep size - Current simulation time - Kinetic energy Also performs safety checks: - Monitors kinetic energy for stability - Terminates simulation if energy becomes too high or too low - Creates log files for post-processing analysis event logWriting ( i ++) { // Calculate kinetic energy double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 2 * pi * y )*( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); } if ( pid () == 0 ) { static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"Level %d , De %2.1e , Ec %2.1e , Oh %2.1e , Oha %2.1e , Bo %4.3f\\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); fprintf ( ferr , \"De Ec Oh i dt t ke \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d , De %2.1e , Ec %2.1e , Oh %2.1e , Oha %2.1e , Bo %4.3f\\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); assert ( ke > - 1e-10 ); // Check for energy blowup (numerical instability) if ( ke > 1e2 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"The kinetic energy blew up. Stopping simulation \\n \" ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } assert ( ke < 1e2 ); // Check for energy dissipation below threshold if ( ke < 1e-6 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"kinetic energy too small now! Stopping! \\n \" ); dump ( file = dumpFile ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"kinetic energy too small now! Stopping! \\n \" ); fclose ( fp ); return 1 ; } } } }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"// Uncomment to use the scalar version of the viscoelastic code// #define _SCALAR#if !_SCALAR#include\"log-conform-viscoelastic.h\"#else#include\"log-conform-viscoelastic-scalar-2D.h\"#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: C/C++ Code",
    "content": "#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#if !_MPI#include\"distance.h\"#endif#define tsnap(1e-2)// 0.001 only for some cases.// Error tolerances#define fErr(1e-3)// Error tolerance in f1 VOF#define KErr(1e-6)// Error tolerance in VoF curvature calculated using height function method#define VelErr(1e-3)// Error tolerances in velocity - Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J#define AErr(1e-3)// Error tolerances in conformation inside the liquid// Domain size#define Ldomain879// Boundary conditions - outflow on the right boundaryu.n[right]=neumann(0.);p[right]=dirichlet(0.);intMAXlevel;// Physical parameters:// Oh -> Solvent Ohnesorge number// Oha -> air Ohnesorge number// De -> Deborah number// Ec -> Elasto-capillary numberdoubleOh,Oha,De,Ec,Bond,tmax;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: intmain(intargc,charconst*argv[]){dtmax=1e-5;// BEWARE of...",
    "content": "intmain(intargc,charconst*argv[]){dtmax=1e-5;// BEWARE of this for stability issues.L0=Ldomain;origin(-L0/2.,0.);// Values taken from the terminal.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Here we use...",
    "content": "Here we use some representative values.// In production run, you can pass it from the command line.MAXlevel=10;// atoi(argv[1]);De=0.1;// atof(argv[2]); // Use 1e30 to simulate the De \u2192 \u221e limitEc=0.01;// atof(argv[3]);Oh=1e-2;// atof(argv[4]);Bond=1e-3;// atof(argv[5]);tmax=1e0;// atof(argv[6]);// Ensure that all the variables were transferred properly from the terminal or job script.// if (argc < 7){//   fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Need %d more...",
    "content": "Need %d more arguments\\n\", 7-argc);//   return 1;// }init_grid(1<<5);// Create a folder named intermediate where all the simulation snapshots are stored.charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file. See writingFiles event.sprintf(dumpFile,\"restart\");",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "rho1=1.,rho2=1e-3;Oha=2e-2*Oh;mu1=Oh,mu2=Oha;lambda1=De;lambda2=0.;G1=Ec;G2=0.;f.sigma=1.0;TOLERANCE=1e-4;CFL=1e-1;run();}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event init(t=0){#if _MPI//...",
    "content": "event init(t=0){#if _MPI// This is for supercomputers without OpenMP supportif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#else// Note that distance.h is incompatible with OpenMPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: So, the below...",
    "content": "So, the below code should not be used with MPIif(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"Bo%5.4f.dat\",Bond);FILE*fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);// Try in folder one level upsprintf(filename,\"../Bo%5.4f.dat\",Bond);fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);return1;}}coord*InitialShape;InitialShape=input_xy(fp);fclose(fp);scalar d[];distance(d,InitialShape);while(adapt_wavelet((scalar*){f,d},(double[]){1e-8,1e-8},MAXlevel).nf);// The distance function is defined at the center of each cell, we have// to calculate the value of this function at each vertex.vertex scalar phi[];foreach_vertex(){phi[]=-(d[]+d[-1]+d[0,-1]+d[-1,-1])/4.;}// We can now initialize the volume fraction of the domain.fractions(phi,f);}// return 1;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);#if !_SCALARadapt_wavelet((scalar*){f,u.x,u.y,conform_p.x.x,conform_p.y.y,conform_p.y.x,conform_qq,KAPPA},(double[]){fErr,VelErr,VelErr,AErr,AErr,AErr,AErr,KErr},MAXlevel,MAXlevel-6);#elseadapt_wavelet((scalar*){f,u.x,u.y,A11,A22,A12,AThTh,KAPPA},(double[]){fErr,VelErr,VelErr,AErr,AErr,AErr,AErr,KErr},MAXlevel,MAXlevel-6);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level%d, De%2.1e, Ec%2.1e, Oh%2.1e, Oha%2.1e, Bo%4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event logWriting(i++){// Calculate...",
    "content": "event logWriting(i++){// Calculate kinetic energydoubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])))*sq(Delta);}if(pid()==0){staticFILE*fp;if(i==0){fprintf(ferr,\"Level%d, De%2.1e, Ec%2.1e, Oh%2.1e, Oha%2.1e, Bo%4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);fprintf(ferr,\"De Ec Oh i dt t ke\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level%d, De%2.1e, Ec%2.1e, Oh%2.1e, Oha%2.1e, Bo%4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);assert(ke>-1e-10);// Check for energy blowup (numerical instability)if(ke>1e2&&i>1e1){if(pid()==0){fprintf(ferr,\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Stopping simulation\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"The kinetic...",
    "content": "Stopping simulation\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"The kinetic energy blew up. Stopping simulation\\n\");fclose(fp);dump(file=dumpFile);return1;}}assert(ke<1e2);// Check for energy dissipation below thresholdif(ke<1e-6&&i>1e1){if(pid()==0){fprintf(ferr,\"kinetic energy too small now! Stopping!\\n\");dump(file=dumpFile);fp=fopen(\"log\",\"a\");fprintf(fp,\"kinetic energy too small now! Stopping!\\n\");fclose(fp);return1;}}}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runCodesInParallel.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles",
    "content": "simulationCases/runCodesInParallel.sh See raw file runCodesInParallel.sh #!/bin/bash # check that CLI inputs are there. 1 is compulsory. if 2 is not there, use 4 (default) if [ \\$ # -lt 1 ] ; then echo \"Usage: \\$ 0 <filename> [number_of_processes]\" exit 1 fi file = \\$ 1 NP = \\$ {2:-4} # use 4 as default if not provided mkdir -p \\$ file CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -I\\$PWD /src-local -I\\$PWD /../src-local -disable-dimensions \\$ file.c -o \\$ file/\\$file -lm chmod +x \\$ file/\\$file # Ensure executable has proper permissions cd \\$ file mpirun --allow-run-as-root -np \\$ NP ./\\$file",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/runCodesInParallel.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCodesInParallel.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#!/bin/bash# check that CLI inputs are there. 1 is compulsory. if 2 is not there, use 4 (default)if[\\$#-lt1];thenecho\"Usage:\\$0 <filename> [number_of_processes]\"exit1fifile=\\$1NP=\\${2:-4}# use 4 as default if not providedmkdir-p\\$fileCC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-I\\$PWD/src-local-I\\$PWD/../src-local-disable-dimensions\\$file.c-o\\$file/\\$file-lmchmod+x\\$file/\\$file# Ensure executable has proper permissionscd\\$filempirun--allow-run-as-root-np\\$NP ./\\$file",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/runCodesInParallel.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles",
    "content": "simulationCases/Makefile See raw file Makefile # Check if .project_config exists ifeq ( \\$ ( wildcard ../.project_config ) , ) \\$ ( error \"../.project_config not found\" ) endif BASILISK := \\$ ( shell . ../.project_config && echo \\$\\$ BASILISK ) CFLAGS += -O2 -disable-dimensions CFLAGS += -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local include \\$ ( BASILISK ) /Makefile.defs",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/Makefile.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# Check if .project_config existsifeq(\\$(wildcard../.project_config),)\\$(error\"../.project_config not found\")endifBASILISK:=\\$(shell. ../.project_config&&echo\\$\\$BASILISK)CFLAGS+=-O2-disable-dimensionsCFLAGS+=-I\\$(PWD)/src-local-I\\$(PWD)/../src-localinclude\\$(BASILISK)/Makefile.defs",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/Makefile.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases burstingBubbleVE.c This simulation models the dynamics of bursting bubbles in viscoelastic media using the Basilisk framework. It partic... Makefile ifeq (\\$(wildcard ../.projectconfig),) \\$(error '../.projectconfig not found') endif BASILISK := \\$(shell . ../.proje... runCodesInParallel.sh if [ \\$ -lt 1 ]; then echo 'Usage: \\$0 [numberofprocesses]' exit 1 fi file=\\$1 NP=\\${2:-4} use 4 as default if not p...",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "simulationCases/1000/burstingBubbleVE.c See raw file Bursting Bubbles in Viscoelastic Media Simulation This simulation models the dynamics of bursting bubbles in viscoelastic media using the Basilisk framework. It particularly focuses on the formation of Worthington jets and droplets that emerge during the bursting process. Physics Overview The simulation implements a two-phase flow model with viscoelastic properties, utilizing the log-conformation approach for numerical stability. This approach preserves the positive-definiteness of the conformation tensor, which is crucial for stable simulations of viscoelastic fluids at high Deborah numbers. For theoretical details, see: V.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Sanjay, Zenodo, DOI:...",
    "content": "Sanjay, Zenodo, DOI: 10.5281/zenodo.14210635 (2024) Usage ./program maxLevel De Ec Oh Bond tmax Where: - maxLevel : Maximum refinement level for adaptive mesh - De : Deborah number (ratio of relaxation time to flow time) - Ec : Elasto-capillary number (ratio of elastic to surface tension forces) - Oh : Ohnesorge number (ratio of viscous to inertial-capillary forces) - Bond : Bond number (ratio of gravitational to surface tension forces) - tmax : Maximum simulation time @file burstingBubbleVE.c @author Vatsal Sanjay and Ayush Dixit @version 1.0 @date Nov 23, 2024 - Work used in the paper: DOI: 10.1017/jfm.2025.237 #include \"axi.h\" #include \"navier-stokes/centered.h\" // Uncomment to use the scalar version of the viscoelastic code #define _SCALAR #if !_SCALAR #include \"log-conform-viscoelastic.h\" #else #include \"log-conform-viscoelastic-scalar-2D.h\" #endif Simulation Parameters FILTERED : Enable density and viscosity jump smoothing tsnap : Time interval between snapshots (default: 1e-2) fErr : Error tolerance for volume fraction (1e-3) KErr : Error tolerance for curvature calculation (1e-6) VelErr : Error tolerance for velocity field (1e-3) AErr : Error tolerance for conformation tensor (1e-3) Ldomain : Domain size in characteristic lengths (8) #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #if !_MPI #include \"distance.h\" #endif #define tsnap (1e-2) // 0.001 only for some cases. // Error tolerances #define fErr (1e-3) // Error tolerance in f1 VOF #define VelErr (1e-3) // Error tolerances in velocity - Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define AErr (1e-3) // Error tolerances in conformation inside the liquid // Domain size #define Ldomain // Boundary conditions - outflow on the right boundary u . n [ right ] = neumann ( 0. ); p [ right ] = dirichlet ( 0. ); int MAXlevel ; // Physical parameters: // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // De -> Deborah number // Ec -> Elasto-capillary number double Oh , Oha , De , Ec , Bond , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes the simulation parameters and sets up the domain.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Uses command line...",
    "content": "Uses command line arguments to set simulation parameters Sets up the physical domain with appropriate dimensions Configures fluid properties for both phases Creates necessary directories for output int main ( int argc , char const * argv []) { dtmax = 1e-5 ; // BEWARE of this for stability issues. L0 = Ldomain ; origin (- L0 / 2. , 0. ); // Ensure that all the variables were transferred properly from the terminal or job script. if ( argc < 7 ){ fprintf ( ferr , \"Usage: %s MAXlevel De Ec Oh Bond tmax \\n \" , argv [ 0 ]); fprintf ( ferr , \"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Need %d more...",
    "content": "Need %d more arguments \\n \" , 7 - argc ); return 1 ; } // Values taken from the terminal MAXlevel = atoi ( argv [ 1 ]); De = atof ( argv [ 2 ]); // Use 1e30 to simulate the De \u2192 \u221e limit Ec = atof ( argv [ 3 ]); Oh = atof ( argv [ 4 ]); Bond = atof ( argv [ 5 ]); tmax = atof ( argv [ 6 ]); init_grid ( 1 << 5 ); // Create a folder named intermediate where all the simulation snapshots are stored. char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "See writingFiles event. sprintf ( dumpFile , \"restart\" ); Physical Properties Configuration Sets up the material properties for both phases: - rho1 , rho2 : Density of liquid and gas phases - mu1 , mu2 : Dynamic viscosity of liquid and gas phases - lambda1 , lambda2 : Relaxation times - G1 , G2 : Elastic moduli Dimensionless parameters: - Oh : Ohnesorge number for liquid phase - Oha : Ohnesorge number for gas phase (= 2e-2 * Oh) - De : Deborah number - Ec : Elasto-capillary number - Bond : Bond number rho1 = 1. , rho2 = 1e-3 ; Oha = 2e-2 * Oh ; mu1 = Oh , mu2 = Oha ; lambda1 = De ; lambda2 = 0. ; G1 = Ec ; G2 = 0. ; f . sigma = 1.0 ; TOLERANCE = 1e-4 ; CFL = 1e-1 ; run (); } Initialization Event Sets up the initial conditions for the simulation. The function attempts to restore from a dump file first.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: If that fails:...",
    "content": "If that fails: - For MPI runs: Ends with an error - For non-MPI runs: Tries to load an initial shape from a data file, creates a distance field, and initializes the volume fraction event init ( t = 0 ) { #if _MPI // This is for supercomputers without OpenMP support if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else // Note that distance.h is incompatible with OpenMPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: So, the below...",
    "content": "So, the below code should not be used with MPI if (! restore ( file = dumpFile )) { char filename [ 60 ]; sprintf ( filename , \"Bo%5.4f.dat\" , Bond ); FILE * fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s \\n \" , filename ); // Try in folder one level up sprintf ( filename , \"../Bo%5.4f.dat\" , Bond ); fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s \\n \" , filename ); return 1 ; } } coord * InitialShape ; InitialShape = input_xy ( fp ); fclose ( fp ); scalar d []; distance ( d , InitialShape ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-8 , 1e-8 }, MAXlevel ). nf ); // The distance function is defined at the center of each cell, we have // to calculate the value of this function at each vertex. vertex scalar phi []; foreach_vertex () { phi [] = -( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ])/ 4. ; } // We can now initialize the volume fraction of the domain. fractions ( phi , f ); } // return 1; #endif } Adaptive Mesh Refinement Refines the mesh based on gradients of key fields: - Volume fraction - Velocity components - Conformation tensor components - Curvature The refinement criteria are set by the error tolerance parameters defined at the beginning of the file.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "This adaptive approach allows for high resolution in regions of interest while maintaining computational efficiency. event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , u . x , u . y }, ( double []){ fErr , VelErr , VelErr }, MAXlevel , MAXlevel - 6 ); // #if !_SCALAR // adapt_wavelet((scalar *){f, u.x, u.y, conform_p.x.x, conform_p.y.y, conform_p.y.x, conform_qq, KAPPA}, // (double[]){fErr, VelErr, VelErr, AErr, AErr, AErr, AErr, KErr}, // MAXlevel, MAXlevel-6); // #else // adapt_wavelet((scalar *){f, u.x, u.y, A11, A22, A12, AThTh, KAPPA}, // (double[]){fErr, VelErr, VelErr, AErr, AErr, AErr, AErr, KErr}, // MAXlevel, MAXlevel-6); // #endif } Output Management Creates periodic snapshots of the simulation state. - Dumps restart files for simulation recovery - Saves intermediate snapshots at regular intervals defined by tsnap event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot-%5.4f\" , t ); dump ( file = nameOut ); } Simulation Termination Writes a final summary of the simulation parameters when the simulation ends. event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f \\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); } Simulation Logging Records key simulation data at each timestep: - Iteration number - Timestep size - Current simulation time - Kinetic energy Also performs safety checks: - Monitors kinetic energy for stability - Terminates simulation if energy becomes too high or too low - Creates log files for post-processing analysis event logWriting ( i ++) { // Calculate kinetic energy double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 2 * pi * y )*( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); } if ( pid () == 0 ) { static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f \\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); fprintf ( ferr , \"De Ec Oh i dt t ke \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f \\n \" , MAXlevel , De , Ec , Oh , Oha , Bond ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \"%d %g %g %g \\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"%d %g %g %g \\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \"%d %g %g %g \\n \" , i , dt , t , ke ); assert ( ke > - 1e-10 ); // Check for energy blowup (numerical instability) if ( ke > 1e2 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"The kinetic energy blew up. Stopping simulation \\n \" ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } assert ( ke < 1e2 ); // Check for energy dissipation below threshold if ( ke < 1e-6 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"kinetic energy too small now! Stopping! \\n \" ); dump ( file = dumpFile ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"kinetic energy too small now! Stopping! \\n \" ); fclose ( fp ); return 1 ; } } } }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"// Uncomment to use the scalar version of the viscoelastic code#define _SCALAR#if !_SCALAR#include\"log-conform-viscoelastic.h\"#else#include\"log-conform-viscoelastic-scalar-2D.h\"#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: C/C++ Code",
    "content": "#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#if !_MPI#include\"distance.h\"#endif#define tsnap (1e-2)// 0.001 only for some cases.// Error tolerances#define fErr (1e-3)// Error tolerance in f1 VOF#define VelErr (1e-3)// Error tolerances in velocity - Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J#define AErr (1e-3)// Error tolerances in conformation inside the liquid// Domain size#define Ldomain// Boundary conditions - outflow on the right boundaryu.n[right]=neumann(0.);p[right]=dirichlet(0.);intMAXlevel;// Physical parameters:// Oh -> Solvent Ohnesorge number// Oha -> air Ohnesorge number// De -> Deborah number// Ec -> Elasto-capillary numberdoubleOh,Oha,De,Ec,Bond,tmax;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: intmain(intargc,charconst*argv[]){dtmax=1e-5;// BEWARE of...",
    "content": "intmain(intargc,charconst*argv[]){dtmax=1e-5;// BEWARE of this for stability issues.L0=Ldomain;origin(-L0/2.,0.);// Ensure that all the variables were transferred properly from the terminal or job script.if(argc<7){fprintf(ferr,\"Usage: %s MAXlevel De Ec Oh Bond tmax\\n\",argv[0]);fprintf(ferr,\"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Need %d more...",
    "content": "Need %d more arguments\\n\",7-argc);return1;}// Values taken from the terminalMAXlevel=atoi(argv[1]);De=atof(argv[2]);// Use 1e30 to simulate the De \u2192 \u221e limitEc=atof(argv[3]);Oh=atof(argv[4]);Bond=atof(argv[5]);tmax=atof(argv[6]);init_grid(1<<5);// Create a folder named intermediate where all the simulation snapshots are stored.charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file. See writingFiles event.sprintf(dumpFile,\"restart\");",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "rho1=1.,rho2=1e-3;Oha=2e-2*Oh;mu1=Oh,mu2=Oha;lambda1=De;lambda2=0.;G1=Ec;G2=0.;f.sigma=1.0;TOLERANCE=1e-4;CFL=1e-1;run();}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event init(t=0){#if _MPI//...",
    "content": "event init(t=0){#if _MPI// This is for supercomputers without OpenMP supportif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#else// Note that distance.h is incompatible with OpenMPI.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: So, the below...",
    "content": "So, the below code should not be used with MPIif(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"Bo%5.4f.dat\",Bond);FILE*fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named %s\\n\",filename);// Try in folder one level upsprintf(filename,\"../Bo%5.4f.dat\",Bond);fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named %s\\n\",filename);return1;}}coord*InitialShape;InitialShape=input_xy(fp);fclose(fp);scalar d[];distance(d,InitialShape);while(adapt_wavelet((scalar*){f,d},(double[]){1e-8,1e-8},MAXlevel).nf);// The distance function is defined at the center of each cell, we have// to calculate the value of this function at each vertex.vertex scalar phi[];foreach_vertex(){phi[]=-(d[]+d[-1]+d[0,-1]+d[-1,-1])/4.;}// We can now initialize the volume fraction of the domain.fractions(phi,f);}// return 1;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,u.x,u.y},(double[]){fErr,VelErr,VelErr},MAXlevel,MAXlevel-6);// #if !_SCALAR//   adapt_wavelet((scalar *){f, u.x, u.y, conform_p.x.x, conform_p.y.y, conform_p.y.x, conform_qq, KAPPA},//     (double[]){fErr, VelErr, VelErr, AErr, AErr, AErr, AErr, KErr},//     MAXlevel, MAXlevel-6);// #else//   adapt_wavelet((scalar *){f, u.x, u.y, A11, A22, A12, AThTh, KAPPA},//     (double[]){fErr, VelErr, VelErr, AErr, AErr, AErr, AErr, KErr},//     MAXlevel, MAXlevel-6);// #endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event logWriting(i++){// Calculate...",
    "content": "event logWriting(i++){// Calculate kinetic energydoubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])))*sq(Delta);}if(pid()==0){staticFILE*fp;if(i==0){fprintf(ferr,\"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);fprintf(ferr,\"De Ec Oh i dt t ke\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level %d, De %2.1e, Ec %2.1e, Oh %2.1e, Oha %2.1e, Bo %4.3f\\n\",MAXlevel,De,Ec,Oh,Oha,Bond);fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d %g %g %g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d %g %g %g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d %g %g %g\\n\",i,dt,t,ke);assert(ke>-1e-10);// Check for energy blowup (numerical instability)if(ke>1e2&&i>1e1){if(pid()==0){fprintf(ferr,\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/1000/burstingBubbleVE.c | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Stopping simulation\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"The kinetic...",
    "content": "Stopping simulation\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"The kinetic energy blew up. Stopping simulation\\n\");fclose(fp);dump(file=dumpFile);return1;}}assert(ke<1e2);// Check for energy dissipation below thresholdif(ke<1e-6&&i>1e1){if(pid()==0){fprintf(ferr,\"kinetic energy too small now! Stopping!\\n\");dump(file=dumpFile);fp=fopen(\"log\",\"a\");fprintf(fp,\"kinetic energy too small now! Stopping!\\n\");fclose(fp);return1;}}}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/simulationCases/1000/burstingBubbleVE.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "src-local/two-phaseEVP.h See raw file Modification by Vatsal Sanjay, Arivazhagan G. Balasubramanian (Ari) Version 2.0, Jun 30, 2025 Changelog Jun 30, 2025: added support for EVP simulations. Brief history v1.0 is the vanilla Basilisk code for two-phase flows: http://basilisk.fr/src/two-phase.h + http://basilisk.fr/src/two-phase-generic.h v2.0 is the modification for elasto-viscoplastic fluids using the log-conformation method. Two-phase interfacial flows This is a modified version of two-phase.h . It contains the implementation of Viscoplastic Fluid (Bingham Fluid). This file helps setup simulations for flows of two fluids separated by an interface (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. #include \"vof.h\" scalar f [], * interfaces = { f }; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. ; double G1 = 0. , G2 = 0. ; // elastic moduli double lambda1 = 0. , lambda2 = 0. ; // relaxation times double tau01 = 0. , tau02 = 0. ; // yield-stress double TOLelastic = 1e-2 ; // tolerance for elastic modulus #TOFIX: this must always be a very small number. Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; scalar Gpd []; scalar lambdapd []; scalar tau0d []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; Gp = Gpd ; lambda = lambdapd ; tau0 = tau0d ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho # define rho(f) (clamp(f,0.,1.)*(rho1 - rho2) + rho2) #endif #ifndef mu // for Arithmetic mean, use this # define mu(f) (clamp(f,0.,1.)*(mu1 - mu2) + mu2) #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf []; #else # define sf f #endif event tracer_advection ( i ++) { When using smearing of the density jump, we initialise sf with the vertex-average of f . #ifndef sf #if dimension <= foreach () sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; #else // dimension == foreach () sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; #endif #endif #if TREE sf . prolongation = refine_bilinear ; sf . dirty = true ; // boundary conditions need to be updated #endif } event properties ( i ++) { foreach_face () { double ff = ( sf [] + sf [- 1 ])/ 2. ; alphav . x [] = fm . x []/ rho ( ff ); face vector muv = mu ; muv . x [] = fm . x []* mu ( ff ); } foreach (){ rhov [] = cm []* rho ( sf []); Gpd [] = 0. ; lambdapd [] = 0. ; tau0d [] = 0. ; if ( clamp ( sf [], 0. , 1. ) > TOLelastic ){ Gpd [] += G1 * clamp ( sf [], 0. , 1. ); lambdapd [] += lambda1 * clamp ( sf [], 0. , 1. ); tau0d [] += tau01 * clamp ( sf [], 0. , 1. ); } if ( clamp (( 1 - sf []), 0. , 1. ) > TOLelastic ){ Gpd [] += G2 * clamp (( 1 - sf []), 0. , 1. ); lambdapd [] += lambda2 * clamp (( 1 - sf []), 0. , 1. ); tau0d [] += tau02 * clamp (( 1 - sf []), 0. , 1. ); } } #if TREE sf . prolongation = fraction_refine ; sf . dirty = true ; // boundary conditions need to be updated #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"vof.h\"scalar f[],*interfaces={f};doublerho1=1.,mu1=0.,rho2=1.,mu2=0.;doubleG1=0.,G2=0.;// elastic modulidoublelambda1=0.,lambda2=0.;// relaxation timesdoubletau01=0.,tau02=0.;// yield-stressdoubleTOLelastic=1e-2;// tolerance for elastic modulus #TOFIX: this must always be a very small number.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "face vector alphav[];scalar rhov[];scalar Gpd[];scalar lambdapd[];scalar tau0d[];event defaults(i=0){alpha=alphav;rho=rhov;Gp=Gpd;lambda=lambdapd;tau0=tau0d;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: rho",
    "content": "#ifndef rho# define rho(f) (clamp(f,0.,1.)*(rho1 - rho2) + rho2)#endif#ifndef mu// for Arithmetic mean, use this# define mu(f)  (clamp(f,0.,1.)*(mu1 - mu2) + mu2)#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf[];#else# define sf f#endifevent tracer_advection(i++){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseEVP.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: sf",
    "content": "#ifndef sf#if dimension <=foreach()sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;#else// dimension ==foreach()sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;#endif#endif#if TREEsf.prolongation=refine_bilinear;sf.dirty=true;// boundary conditions need to be updated#endif}event properties(i++){foreach_face(){doubleff=(sf[]+sf[-1])/2.;alphav.x[]=fm.x[]/rho(ff);face vector muv=mu;muv.x[]=fm.x[]*mu(ff);}foreach(){rhov[]=cm[]*rho(sf[]);Gpd[]=0.;lambdapd[]=0.;tau0d[]=0.;if(clamp(sf[],0.,1.)>TOLelastic){Gpd[]+=G1*clamp(sf[],0.,1.);lambdapd[]+=lambda1*clamp(sf[],0.,1.);tau0d[]+=tau01*clamp(sf[],0.,1.);}if(clamp((1-sf[]),0.,1.)>TOLelastic){Gpd[]+=G2*clamp((1-sf[]),0.,1.);lambdapd[]+=lambda2*clamp((1-sf[]),0.,1.);tau0d[]+=tau02*clamp((1-sf[]),0.,1.);}}#if TREEsf.prolongation=fraction_refine;sf.dirty=true;// boundary conditions need to be updated#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseEVP.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "src-local/eigen_decomposition.h See raw file Matrix Eigenvalue Solver This module provides algorithms for computing eigenvalues and eigenvectors of 3x3 symmetric matrices, which are commonly encountered in computational fluid dynamics, solid mechanics, and other physics-based simulations. Mathematical Background The implementation uses the Householder transformation to reduce a symmetric matrix to tridiagonal form, followed by the QL algorithm with implicit shifts to compute the eigenvalues and eigenvectors. For a 3x3 symmetric matrix, these methods are particularly efficient and numerically stable, providing accurate results even for matrices with closely spaced eigenvalues. Tridiagonalize a 3x3 Symmetric Matrix Reduces a 3x3 symmetric matrix to tridiagonal form using the Householder method, which applies a series of orthogonal transformations to eliminate elements below the subdiagonal.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "Parameters: matrix[in]: Input 3x3 symmetric matrix to be tridiagonalized eigenvectors[out]: Orthogonal matrix of Householder vectors diagonal[out]: Diagonal elements of the resulting tridiagonal matrix subdiagonal[out]: Subdiagonal elements of the tridiagonal matrix Implementation Notes: The original matrix is preserved The eigenvectors matrix is initialized to identity and then transformed The algorithm exploits the symmetry of the input matrix #define SQUARE ( x ) (( x )*( x )) 36 static void tridiagonalize_symmetric_3x3 ( double matrix [ 3 ][ 3 ], double eigenvectors [ 3 ][ 3 ], double diagonal [ 3 ], double subdiagonal [ 2 ]) { const int size = 3 ; double householder_vector [ size ], temp_vector [ size ]; double omega , scale , sigma , tau ; // Initialize eigenvectors to the identity matrix for ( int i = 0 ; i < size ; i ++) { eigenvectors [ i ][ i ] = 1.0 ; for ( int j = 0 ; j < i ; j ++) eigenvectors [ i ][ j ] = eigenvectors [ j ][ i ] = 0.0 ; } // Compute the first Householder reflection scale = SQUARE ( matrix [ 0 ][ 1 ]) + SQUARE ( matrix [ 0 ][ 2 ]); sigma = ( matrix [ 0 ][ 1 ] > 0 ) ? - sqrt ( scale ) : sqrt ( scale ); subdiagonal [ 0 ] = sigma ; tau = sigma * matrix [ 0 ][ 1 ]; householder_vector [ 1 ] = matrix [ 0 ][ 1 ] - sigma ; householder_vector [ 2 ] = matrix [ 0 ][ 2 ]; omega = scale - tau ; if ( omega > 0.0 ) { omega = 1.0 / omega ; sigma = 0.0 ; for ( int i = 1 ; i < size ; i ++) { tau = matrix [ 1 ][ i ] * householder_vector [ 1 ] + matrix [ i ][ 2 ] * householder_vector [ 2 ]; temp_vector [ i ] = omega * tau ; sigma += householder_vector [ i ] * tau ; } sigma *= 0.5 * SQUARE ( omega ); for ( int i = 1 ; i < size ; i ++) temp_vector [ i ] -= sigma * householder_vector [ i ]; diagonal [ 0 ] = matrix [ 0 ][ 0 ]; diagonal [ 1 ] = matrix [ 1 ][ 1 ] - 2.0 * temp_vector [ 1 ] * householder_vector [ 1 ]; diagonal [ 2 ] = matrix [ 2 ][ 2 ] - 2.0 * temp_vector [ 2 ] * householder_vector [ 2 ]; for ( int j = 1 ; j < size ; j ++) { tau = omega * householder_vector [ j ]; for ( int i = 1 ; i < size ; i ++) eigenvectors [ i ][ j ] -= tau * householder_vector [ i ]; } subdiagonal [ 1 ] = matrix [ 1 ][ 2 ] - temp_vector [ 1 ] * householder_vector [ 2 ] - householder_vector [ 1 ] * temp_vector [ 2 ]; } else { for ( int i = 0 ; i < size ; i ++) diagonal [ i ] = matrix [ i ][ i ]; subdiagonal [ 1 ] = matrix [ 1 ][ 2 ]; } } ### Compute Eigenvalues and Eigenvectors of a 3x3 Symmetric Matrix Calculates the complete eigensystem (eigenvalues and eigenvectors) of a 3x3 symmetric matrix using the QL algorithm with implicit shifts, after first reducing the matrix to tridiagonal form.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Parameters: matrix[in]: Input...",
    "content": "Parameters: matrix[in]: Input 3x3 symmetric matrix whose eigensystem will be computed eigenvectors[out]: Matrix whose columns are the eigenvectors eigenvalues[out]: Array containing the eigenvalues Return Value: 0: Computation successful -1: Algorithm failed to converge within the maximum number of iterations Algorithm Details: First checks if the matrix is already diagonal If not, tridiagonalizes the matrix using Householder transformations Applies the QL algorithm with implicit shifts to compute eigenvalues Maximum of 30 iterations are allowed for convergence Numerical tolerance of 1e-15 is used for detecting diagonal matrices Usage Example: double matrix [ 3 ][ 3 ] = {{ 1.0 , 0.5 , 0.3 }, { 0.5 , 2.0 , 0.1 }, { 0.3 , 0.1 , 3.0 }}; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; int result = compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); if ( result == 0 ) { // Computation successful } static int compute_eigensystem_symmetric_3x3 ( double matrix [ 3 ][ 3 ], double eigenvectors [ 3 ][ 3 ], double eigenvalues [ 3 ]) { const int size = 3 ; const int max_iterations = 30 ; double subdiagonal [ 3 ]; double g , r , p , f , b , s , c , t ; int iteration_count ; int m ; // Check for diagonal matrix with unit entries if ( SQUARE ( matrix [ 0 ][ 1 ]) < 1e-15 && SQUARE ( matrix [ 0 ][ 2 ]) < 1e-15 && SQUARE ( matrix [ 1 ][ 2 ]) < 1e-15 ) { for ( int i = 0 ; i < size ; i ++) { for ( int j = 0 ; j < size ; j ++) { eigenvectors [ i ][ j ] = ( i == j ) ? 1.0 : 0.0 ; } eigenvalues [ i ] = matrix [ i ][ i ]; } return 0 ; } tridiagonalize_symmetric_3x3 ( matrix , eigenvectors , eigenvalues , subdiagonal ); for ( int l = 0 ; l < size - 1 ; l ++) { iteration_count = 0 ; while ( 1 ) { for ( m = l ; m <= size - 2 ; m ++) { g = fabs ( eigenvalues [ m ]) + fabs ( eigenvalues [ m + 1 ]); if ( fabs ( subdiagonal [ m ]) + g == g ) break ; } if ( m == l ) break ; if ( iteration_count ++ >= max_iterations ) return - 1 ; g = ( eigenvalues [ l + 1 ] - eigenvalues [ l ]) / ( 2.0 * subdiagonal [ l ]); r = sqrt ( SQUARE ( g ) + 1.0 ); g = eigenvalues [ m ] - eigenvalues [ l ] + subdiagonal [ l ] / ( g + ( g > 0 ? fabs ( r ) : - fabs ( r ))); s = c = 1.0 ; p = 0.0 ; for ( int i = m - 1 ; i >= l ; i --) { f = s * subdiagonal [ i ]; b = c * subdiagonal [ i ]; if ( fabs ( f ) > fabs ( g )) { c = g / f ; r = sqrt ( SQUARE ( c ) + 1.0 ); subdiagonal [ i + 1 ] = f * r ; c *= ( s = 1.0 / r ); } else { s = f / g ; r = sqrt ( SQUARE ( s ) + 1.0 ); subdiagonal [ i + 1 ] = g * r ; s *= ( c = 1.0 / r ); } g = eigenvalues [ i + 1 ] - p ; r = ( eigenvalues [ i ] - g ) * s + 2.0 * c * b ; p = s * r ; eigenvalues [ i + 1 ] = g + p ; g = c * r - b ; for ( int k = 0 ; k < size ; k ++) { t = eigenvectors [ k ][ i + 1 ]; eigenvectors [ k ][ i + 1 ] = s * eigenvectors [ k ][ i ] + c * t ; eigenvectors [ k ][ i ] = c * eigenvectors [ k ][ i ] - s * t ; } } eigenvalues [ l ] -= p ; subdiagonal [ l ] = g ; subdiagonal [ m ] = 0.0 ; } } return 0 ; }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#define SQUARE(x)((x)*(x))36staticvoidtridiagonalize_symmetric_3x3(doublematrix[3][3],doubleeigenvectors[3][3],doublediagonal[3],doublesubdiagonal[2]){constintsize=3;doublehouseholder_vector[size],temp_vector[size];doubleomega,scale,sigma,tau;// Initialize eigenvectors to the identity matrixfor(inti=0;i<size;i++){eigenvectors[i][i]=1.0;for(intj=0;j<i;j++)eigenvectors[i][j]=eigenvectors[j][i]=0.0;}// Compute the first Householder reflectionscale=SQUARE(matrix[0][1])+SQUARE(matrix[0][2]);sigma=(matrix[0][1]>0)?-sqrt(scale):sqrt(scale);subdiagonal[0]=sigma;tau=sigma*matrix[0][1];householder_vector[1]=matrix[0][1]-sigma;householder_vector[2]=matrix[0][2];omega=scale-tau;if(omega>0.0){omega=1.0/omega;sigma=0.0;for(inti=1;i<size;i++){tau=matrix[1][i]*householder_vector[1]+matrix[i][2]*householder_vector[2];temp_vector[i]=omega*tau;sigma+=householder_vector[i]*tau;}sigma*=0.5*SQUARE(omega);for(inti=1;i<size;i++)temp_vector[i]-=sigma*householder_vector[i];diagonal[0]=matrix[0][0];diagonal[1]=matrix[1][1]-2.0*temp_vector[1]*householder_vector[1];diagonal[2]=matrix[2][2]-2.0*temp_vector[2]*householder_vector[2];for(intj=1;j<size;j++){tau=omega*householder_vector[j];for(inti=1;i<size;i++)eigenvectors[i][j]-=tau*householder_vector[i];}subdiagonal[1]=matrix[1][2]-temp_vector[1]*householder_vector[2]-householder_vector[1]*temp_vector[2];}else{for(inti=0;i<size;i++)diagonal[i]=matrix[i][i];subdiagonal[1]=matrix[1][2];}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doublematrix[3][3]={{1.0,0.5,0.3},{0.5,2.0,0.1},{0.3,0.1,3.0}};doubleeigenvectors[3][3];doubleeigenvalues[3];intresult=compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);if(result==0){// Computation successful}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/eigen_decomposition.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "staticintcompute_eigensystem_symmetric_3x3(doublematrix[3][3],doubleeigenvectors[3][3],doubleeigenvalues[3]){constintsize=3;constintmax_iterations=30;doublesubdiagonal[3];doubleg,r,p,f,b,s,c,t;intiteration_count;intm;// Check for diagonal matrix with unit entriesif(SQUARE(matrix[0][1])<1e-15&&SQUARE(matrix[0][2])<1e-15&&SQUARE(matrix[1][2])<1e-15){for(inti=0;i<size;i++){for(intj=0;j<size;j++){eigenvectors[i][j]=(i==j)?1.0:0.0;}eigenvalues[i]=matrix[i][i];}return0;}tridiagonalize_symmetric_3x3(matrix,eigenvectors,eigenvalues,subdiagonal);for(intl=0;l<size-1;l++){iteration_count=0;while(1){for(m=l;m<=size-2;m++){g=fabs(eigenvalues[m])+fabs(eigenvalues[m+1]);if(fabs(subdiagonal[m])+g==g)break;}if(m==l)break;if(iteration_count++>=max_iterations)return-1;g=(eigenvalues[l+1]-eigenvalues[l])/(2.0*subdiagonal[l]);r=sqrt(SQUARE(g)+1.0);g=eigenvalues[m]-eigenvalues[l]+subdiagonal[l]/(g+(g>0?fabs(r):-fabs(r)));s=c=1.0;p=0.0;for(inti=m-1;i>=l;i--){f=s*subdiagonal[i];b=c*subdiagonal[i];if(fabs(f)>fabs(g)){c=g/f;r=sqrt(SQUARE(c)+1.0);subdiagonal[i+1]=f*r;c*=(s=1.0/r);}else{s=f/g;r=sqrt(SQUARE(s)+1.0);subdiagonal[i+1]=g*r;s*=(c=1.0/r);}g=eigenvalues[i+1]-p;r=(eigenvalues[i]-g)*s+2.0*c*b;p=s*r;eigenvalues[i+1]=g+p;g=c*r-b;for(intk=0;k<size;k++){t=eigenvectors[k][i+1];eigenvectors[k][i+1]=s*eigenvectors[k][i]+c*t;eigenvectors[k][i]=c*eigenvectors[k][i]-s*t;}}eigenvalues[l]-=p;subdiagonal[l]=g;subdiagonal[m]=0.0;}}return0;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/eigen_decomposition.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-elastoviscoplastic.h See raw file Log-Conformation Method with Tensor Implementation Overview Title : log-conform-elastoviscoplastic.h Version : 10.5 Description : Tensor-based implementation of the log-conformation method for elasto-viscoplastic fluids Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Uses native tensor data structures for better code organization Supports both 2D and axisymmetric configurations Author Information Name : Vatsal Sanjay, Arivazhagan G.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Balasubramanian Email :...",
    "content": "Balasubramanian Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Jun 30, 2025 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Important Limitations 3D Compatibility Currently limited to 2D and axisymmetric cases only 3D support is blocked by Basilisk core limitations: Boundary conditions for symmetric tensors are not implemented in Basilisk core See basilisk/src/grid/cartesian-common.h lines 230-251 Comment in source: \u201cfixme: boundary conditions don\u2019t work!\u201d Alternative for 3D For 3D simulations, use log-conform-elastoviscoplastic-scalar-3D.h Scalar version uses individual components instead of tensors Provides full 3D functionality without boundary condition limitations Technical Notes Variable Naming conform_p , conform_qq : Represent the Conformation tensor Tensor implementation provides more natural mathematical representation Axisymmetric components handled separately when needed Mathematical Framework The implementation follows the standard log-conformation approach: 1.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Uses tensor mathematics...",
    "content": "Uses tensor mathematics for clean formulation 2. Handles both planar and axisymmetric geometries 3. Provides natural extension to various constitutive models // In this code, conform_p, conform_qq are in fact the Conformation tensor. The log-conformation method for elasto-viscoplastic constitutive models Introduction Elasto-viscoplastic fluids exhibit viscous, elastic and plastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the EVP fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The extra stress...",
    "content": "The extra stress \\(\\mathbf{T}\\) includes memory effects due to the polymers and the plasticity effects associated with internal structural changes in the material that constitutes to yielding the material and fluidizes it. Several constitutive rheological models are available in the literature where the extra stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the elasto-viscoplastic matrix. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Here, \\(\\lambda\\) is...",
    "content": "Here, \\(\\lambda\\) is the relaxation time. In the case of Saramito (2007) elasto-viscoplastic model, where the material before yielding is represented by Kelvin-Voigt viscoelastic solid and long after yielding recovers the Oldroyd-B type viscoelastic fluid behaviour, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , \\(\\mathbf{f}_r (\\mathbf{A}) = \\mathcal{F}(\\mathbf{A} -\\mathbf{I})\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ (\\mathcal{F}/\\lambda) \\mathbf{T} + (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Here, \\(\\mathcal{F} = max(0., \\frac{\\|\\tau_d\\|-\\tau_y}{\\|\\tau_d\\|}\\) . Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different viscoelastic constitutive models. This work is an extension of such formulation for elasto-viscoplastic materials.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Parameters The primary...",
    "content": "Parameters The primary parameters are the relaxation time \\(\\lambda\\) , the elastic modulus \\(G_p\\) and the yield stress \\(\\tau_y\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp, lambda, tau0 are defined in two-phaseEVP.h . The log conformation approach The numerical resolution of viscoelastic and elasto-viscoplastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic and elastoviscoplastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the extra stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . /* TODO : - Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h) */ #include \"bcg.h\" #if dimension == #error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "Use log-conform-elastoviscoplastic-scalar-3D.h for 3D simulations.\" #endif ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time ( const ) scalar tau0 = unity ; // yield stress symmetric tensor conform_p [], tau_p []; #if AXI scalar conform_qq [], tau_qq []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; foreach () { foreach_dimension (){ tau_p . x . x [] = 0. ; conform_p . x . x [] = 1. ; } tau_p . x . y [] = 0. ; conform_p . x . y [] = 0. ; #if AXI tau_qq [] = 0 ; conform_qq [] = 1. ; #endif } for ( scalar s in { tau_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } for ( scalar s in { conform_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } #if AXI scalar s1 = tau_p . x . y ; s1 [ bottom ] = dirichlet ( 0. ); #endif #if AXI scalar s2 = conform_p . x . y ; s2 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ). In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { tensor Psi = conform_p ; #if AXI scalar Psiqq = conform_qq ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . y = conform_p . x . y []; foreach_dimension () A . x . x = conform_p . x . x []; In the axisymmetric case, \\(\\Psi_{\\theta \\theta} = \\log A_{\\theta \\theta}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore \\(\\Psi_{\\theta \\theta}...",
    "content": "Therefore \\(\\Psi_{\\theta \\theta} = \\log [ ( 1 + \\text{fa} \\tau_{p_{\\theta \\theta}})]\\) . #if AXI double Aqq = conform_qq []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; pseudo_t R ; diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g, Lambda.y = %g \\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g, y = %g \\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "Psi . x . y [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); foreach_dimension () Psi . x . x [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) . The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Transform omega back...",
    "content": "Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: - R is the eigenvector matrix of the conformation tensor - M is the velocity gradient tensor in the eigenvector basis - The construction ensures B is symmetric and traceless pseudo_t B ; double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi . x . y []; Psi . x . y [] += dt *( 2. * B . x . y + OM *( Psi . y . y [] - Psi . x . x [])); foreach_dimension () { s *= - 1 ; Psi . x . x [] += dt * 2. *( B . x . x + s * OM ); } In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi . x . x , Psi . x . y , Psi . y . y , Psiqq }, uf , dt ); #else advection ({ Psi . x . x , Psi . x . y , Psi . y . y }, uf , dt ); #endif Convert back to _p foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi . x . x [], Psi . x . y []}, { Psi . y . x [], Psi . y . y []}}, R ; pseudo_v Lambda ; diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\mathcal{F} \\Delta t}{\\lambda} \\] #if AXI double tauD = sqrt (( 1. / 6. )*(( tau_p . x . x [] - tau_p . y . y [])*( tau_p . x . x [] - tau_p . y . y [])+( tau_p . y . y [] - tau_qq [])*( tau_p . y . y [] - tau_qq [])+( tau_qq [] - tau_p . x . x [])*( tau_qq [] - tau_p . x . x [])) + tau_p . x . y []* tau_p . x . y []); #else double tauD = sqrt ( 0.25 *( tau_p . x . x [] - tau_p . y . y [])*( tau_p . x . x [] - tau_p . y . y []) + tau_p . x . y []* tau_p . x . y []); #endif double yieldFactor = max ( 0. , ( tauD - tau0 [])/( tauD + 1e-6 )); // $\\mathcal{F}$ double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt * yieldFactor / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . conform_p . x . y [] = A . x . y ; tau_p . x . y [] = Gp []* A . x . y ; #if AXI conform_qq [] = Aqq ; tau_qq [] = Gp []*( Aqq - 1. ); #endif foreach_dimension (){ conform_p . x . x [] = A . x . x ; tau_p . x . x [] = Gp []*( A . x . x - 1. ); } } } Divergence of the extra stress tensor The extra stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "Two terms contribute to each component of the momentum equation. For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face () if ( fm . x [] > 1e-20 ) { double shear = ( tau_p . x . y [ 0 , 1 ]* cm [ 0 , 1 ] + tau_p . x . y [- 1 , 1 ]* cm [- 1 , 1 ] - tau_p . x . y [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - tau_p . x . y [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shear + cm []* tau_p . x . x [] - cm [- 1 ]* tau_p . x . x [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } #if AXI foreach_face ( y ) if ( y > 0. ) av . y [] -= ( tau_qq [] + tau_qq [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "// In this code, conform_p, conform_qq are in fact the Conformation tensor.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: /*TODO:- Perhaps, instead...",
    "content": "/*TODO:- Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h)*/#include\"bcg.h\"#if dimension ==#error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "Use log-conform-elastoviscoplastic-scalar-3D.h for 3D simulations.\"#endif(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation time(const)scalar tau0=unity;// yield stresssymmetric tensor conform_p[],tau_p[];#if AXIscalar conform_qq[],tau_qq[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;foreach(){foreach_dimension(){tau_p.x.x[]=0.;conform_p.x.x[]=1.;}tau_p.x.y[]=0.;conform_p.x.y[]=0.;#if AXItau_qq[]=0;conform_qq[]=1.;#endif}for(scalar s in{tau_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}for(scalar s in{conform_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}#if AXIscalar s1=tau_p.x.y;s1[bottom]=dirichlet(0.);#endif#if AXIscalar s2=conform_p.x.y;s2[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event tracer_advection(i++){tensor Psi=conform_p;#if AXIscalar Psiqq=conform_qq;#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A;A.x.y=conform_p.x.y[];foreach_dimension()A.x.x=conform_p.x.x[];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIdoubleAqq=conform_qq[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_v Lambda;pseudo_t R;diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x = %g, Lambda.y = %g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x = %g, y = %g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi.x.y[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);foreach_dimension()Psi.x.x[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi.x.y[];Psi.x.y[]+=dt*(2.*B.x.y+OM*(Psi.y.y[]-Psi.x.x[]));foreach_dimension(){s*=-1;Psi.x.x[]+=dt*2.*(B.x.x+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIadvection({Psi.x.x,Psi.x.y,Psi.y.y,Psiqq},uf,dt);#elseadvection({Psi.x.x,Psi.x.y,Psi.y.y},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi.x.x[],Psi.x.y[]},{Psi.y.x[],Psi.y.y[]}},R;pseudo_v Lambda;diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#if AXIdoubletauD=sqrt((1./6.)*((tau_p.x.x[]-tau_p.y.y[])*(tau_p.x.x[]-tau_p.y.y[])+(tau_p.y.y[]-tau_qq[])*(tau_p.y.y[]-tau_qq[])+(tau_qq[]-tau_p.x.x[])*(tau_qq[]-tau_p.x.x[]))+tau_p.x.y[]*tau_p.x.y[]);#elsedoubletauD=sqrt(0.25*(tau_p.x.x[]-tau_p.y.y[])*(tau_p.x.x[]-tau_p.y.y[])+tau_p.x.y[]*tau_p.x.y[]);#endifdoubleyieldFactor=max(0.,(tauD-tau0[])/(tauD+1e-6));// $\\mathcal{F}$doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt*yieldFactor/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "conform_p.x.y[]=A.x.y;tau_p.x.y[]=Gp[]*A.x.y;#if AXIconform_qq[]=Aqq;tau_qq[]=Gp[]*(Aqq-1.);#endifforeach_dimension(){conform_p.x.x[]=A.x.x;tau_p.x.x[]=Gp[]*(A.x.x-1.);}}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event acceleration(i++){face vector av=a;foreach_face()if(fm.x[]>1e-20){doubleshear=(tau_p.x.y[0,1]*cm[0,1]+tau_p.x.y[-1,1]*cm[-1,1]-tau_p.x.y[0,-1]*cm[0,-1]-tau_p.x.y[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shear+cm[]*tau_p.x.x[]-cm[-1]*tau_p.x.x[-1])*alpha.x[]/(sq(fm.x[])*Delta);}#if AXIforeach_face(y)if(y>0.)av.y[]-=(tau_qq[]+tau_qq[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-viscoelastic.h See raw file Log-Conformation Method with Tensor Implementation Overview Title : log-conform-viscoelastic.h Version : 10.5 Description : Tensor-based implementation of the log-conformation method for viscoelastic fluids Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Uses native tensor data structures for better code organization Supports both 2D and axisymmetric configurations Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Nov 23, 2024 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Important Limitations 3D Compatibility Currently limited to 2D and axisymmetric cases only 3D support is blocked by Basilisk core limitations: Boundary conditions for symmetric tensors are not implemented in Basilisk core See basilisk/src/grid/cartesian-common.h lines 230-251 Comment in source: \u201cfixme: boundary conditions don\u2019t work!\u201d Alternative for 3D For 3D simulations, use log-conform-viscoelastic-scalar-3D.h Scalar version uses individual components instead of tensors Provides full 3D functionality without boundary condition limitations Technical Notes Variable Naming conform_p , conform_qq : Represent the Conformation tensor Tensor implementation provides more natural mathematical representation Axisymmetric components handled separately when needed Mathematical Framework The implementation follows the standard log-conformation approach: 1.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Uses tensor mathematics...",
    "content": "Uses tensor mathematics for clean formulation 2. Handles both planar and axisymmetric geometries 3. Provides natural extension to various constitutive models Note: In this code, conform_p, conform_qq are in fact the Conformation tensor. The log-conformation method for viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the case...",
    "content": "In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models. Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This instability poses...",
    "content": "This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . TODO: - Perhaps, instead of the Bell\u2013Collela\u2013Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to http://basilisk.fr/src/navier-stokes/conserving.h #include \"bcg.h\" #if dimension == #error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "Use log-conform-viscoelastic-scalar-3D.h for 3D simulations.\" #endif ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time symmetric tensor conform_p [], tau_p []; #if AXI scalar conform_qq [], tau_qq []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; foreach () { foreach_dimension (){ tau_p . x . x [] = 0. ; conform_p . x . x [] = 1. ; } tau_p . x . y [] = 0. ; conform_p . x . y [] = 0. ; #if AXI tau_qq [] = 0 ; conform_qq [] = 1. ; #endif } for ( scalar s in { tau_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } for ( scalar s in { conform_p }) { s . v . x . i = - 1 ; // just a scalar, not the component of a vector foreach_dimension (){ if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } } #if AXI scalar s1 = tau_p . x . y ; s1 [ bottom ] = dirichlet ( 0. ); #endif #if AXI scalar s2 = conform_p . x . y ; s2 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ). In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { tensor Psi = conform_p ; #if AXI scalar Psiqq = conform_qq ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . y = conform_p . x . y []; foreach_dimension () A . x . x = conform_p . x . x []; In the axisymmetric case, \\(\\Psi_{\\theta \\theta} = \\log A_{\\theta \\theta}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore \\(\\Psi_{\\theta \\theta}...",
    "content": "Therefore \\(\\Psi_{\\theta \\theta} = \\log [ ( 1 + \\text{fa} \\tau_{p_{\\theta \\theta}})]\\) . #if AXI double Aqq = conform_qq []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; pseudo_t R ; diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g , Lambda.y = %g\\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g , y = %g\\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "Psi . x . y [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); foreach_dimension () Psi . x . x [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) . The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Transform omega back...",
    "content": "Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: - R is the eigenvector matrix of the conformation tensor - M is the velocity gradient tensor in the eigenvector basis - The construction ensures B is symmetric and traceless pseudo_t B ; double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi . x . y []; Psi . x . y [] += dt *( 2. * B . x . y + OM *( Psi . y . y [] - Psi . x . x [])); foreach_dimension () { s *= - 1 ; Psi . x . x [] += dt * 2. *( B . x . x + s * OM ); } In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi . x . x , Psi . x . y , Psi . y . y , Psiqq }, uf , dt ); #else advection ({ Psi . x . x , Psi . x . y , Psi . y . y }, uf , dt ); #endif Convert back to _p foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi . x . x [], Psi . x . y []}, { Psi . y . x [], Psi . y . y []}}, R ; pseudo_v Lambda ; diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . conform_p . x . y [] = A . x . y ; tau_p . x . y [] = Gp []* A . x . y ; #if AXI conform_qq [] = Aqq ; tau_qq [] = Gp []*( Aqq - 1. ); #endif foreach_dimension (){ conform_p . x . x [] = A . x . x ; tau_p . x . x [] = Gp []*( A . x . x - 1. ); } } } Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face () if ( fm . x [] > 1e-20 ) { double shear = ( tau_p . x . y [ 0 , 1 ]* cm [ 0 , 1 ] + tau_p . x . y [- 1 , 1 ]* cm [- 1 , 1 ] - tau_p . x . y [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - tau_p . x . y [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shear + cm []* tau_p . x . x [] - cm [- 1 ]* tau_p . x . x [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } #if AXI foreach_face ( y ) if ( y > 0. ) av . y [] -= ( tau_qq [] + tau_qq [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: C/C++ Code",
    "content": "#include\"bcg.h\"#if dimension ==#error \"This implementation does not support 3D due to missing tensor boundary conditions in Basilisk (see cartesian-common.h line ~246).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: Context",
    "content": "Use log-conform-viscoelastic-scalar-3D.h for 3D simulations.\"#endif(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation timesymmetric tensor conform_p[],tau_p[];#if AXIscalar conform_qq[],tau_qq[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;foreach(){foreach_dimension(){tau_p.x.x[]=0.;conform_p.x.x[]=1.;}tau_p.x.y[]=0.;conform_p.x.y[]=0.;#if AXItau_qq[]=0;conform_qq[]=1.;#endif}for(scalar s in{tau_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}for(scalar s in{conform_p}){s.v.x.i=-1;// just a scalar, not the component of a vectorforeach_dimension(){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}}#if AXIscalar s1=tau_p.x.y;s1[bottom]=dirichlet(0.);#endif#if AXIscalar s2=conform_p.x.y;s2[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event tracer_advection(i++){tensor Psi=conform_p;#if AXIscalar Psiqq=conform_qq;#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A;A.x.y=conform_p.x.y[];foreach_dimension()A.x.x=conform_p.x.x[];",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIdoubleAqq=conform_qq[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_v Lambda;pseudo_t R;diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x =%g, Lambda.y =%g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x =%g, y =%g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi.x.y[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);foreach_dimension()Psi.x.x[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi.x.y[];Psi.x.y[]+=dt*(2.*B.x.y+OM*(Psi.y.y[]-Psi.x.x[]));foreach_dimension(){s*=-1;Psi.x.x[]+=dt*2.*(B.x.x+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIadvection({Psi.x.x,Psi.x.y,Psi.y.y,Psiqq},uf,dt);#elseadvection({Psi.x.x,Psi.x.y,Psi.y.y},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi.x.x[],Psi.x.y[]},{Psi.y.x[],Psi.y.y[]}},R;pseudo_v Lambda;diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "conform_p.x.y[]=A.x.y;tau_p.x.y[]=Gp[]*A.x.y;#if AXIconform_qq[]=Aqq;tau_qq[]=Gp[]*(Aqq-1.);#endifforeach_dimension(){conform_p.x.x[]=A.x.x;tau_p.x.x[]=Gp[]*(A.x.x-1.);}}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event acceleration(i++){face vector av=a;foreach_face()if(fm.x[]>1e-20){doubleshear=(tau_p.x.y[0,1]*cm[0,1]+tau_p.x.y[-1,1]*cm[-1,1]-tau_p.x.y[0,-1]*cm[0,-1]-tau_p.x.y[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shear+cm[]*tau_p.x.x[]-cm[-1]*tau_p.x.x[-1])*alpha.x[]/(sq(fm.x[])*Delta);}#if AXIforeach_face(y)if(y>0.)av.y[]-=(tau_qq[]+tau_qq[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-elastoviscoplastic-scalar-2D.h See raw file Log-Conformation Method for 2D Elasto-viscoplastic Fluids Overview Title : log-conform-elastoviscoplastic-scalar-2D.h Version : 2.5 Description : 2D and axisymmetric scalar implementation of elastoviscoplastic fluid dynamics using the log-conformation method Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Supports both 2D and axisymmetric configurations Scalar implementation approach for better performance Compatible with log-conform-elastoviscoplastic.h Author Information Name : Vatsal Sanjay, Arivazhagan G.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Balasubramanian (Ari) Email...",
    "content": "Balasubramanian (Ari) Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Jun 30, 2025 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Version History v1.0 (Oct 18, 2024) Initial implementation with 2D+axi support Scalar-based implementation for efficiency v2.0 (Nov 3, 2024) Major documentation improvements Made code an axisymmetric mirror of log-conform-elastoviscoplastic-scalar-3D.h Added negative eigenvalue detection with location reporting Added initialization functions for pseudo_v and pseudo_t v2.1 (Nov 14, 2024) Added support for infinite Deborah number cases v2.5 (Nov 23, 2024) Enhanced documentation clarity and completeness Future Work Tensor Formulation Convert to consistent tensor formulation for: Improved readability and maintainability Better computational efficiency Reduced potential for bugs Prerequisites for axi compatibility in 3D version Related issues: https://github.com/comphy-lab/Viscoelastic3D/issues/11 https://github.com/comphy-lab/Viscoelastic3D/issues/5 Code Improvements Enforce tensor usage throughout codebase Implement foreach_dimension compatibility The log-conformation method for viscoelastic constitutive models Introduction Elasto-viscoplastic fluids exhibit viscous, elastic and plastic behaviour when subjected to deformation.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore these materials...",
    "content": "Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the EVP fluid. The extra stress \\(\\mathbf{T}\\) includes memory effects due to the polymers and the plasticity effects associated with internal structural changes in the material that constitutes to yielding the material and fluidizes it. Several constitutive rheological models are available in the literature where the extra stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The conformation tensor...",
    "content": "The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the elasto-viscoplastic matrix. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the case...",
    "content": "In the case of Saramito (2007) elasto-viscoplastic model, where the material before yielding is represented by Kelvin-Voigt viscoelastic solid and long after yielding recovers the Oldroyd-B type viscoelastic fluid behaviour, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , \\(\\mathbf{f}_r (\\mathbf{A}) = \\mathcal{F}(\\mathbf{A} -\\mathbf{I})\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ (\\mathcal{F}/\\lambda) \\mathbf{T} + (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Here, \\(\\mathcal{F} = max(0., \\frac{\\|\\tau_d\\|-\\tau_y}{\\|\\tau_d\\|}\\) . Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different viscoelastic constitutive models. This work is an extension of such formulation for elasto-viscoplastic materials.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Parameters The primary...",
    "content": "Parameters The primary parameters are the relaxation time \\(\\lambda\\) , elastic modulus \\(G_p\\) and yield stress \\(\\tau_y\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp, lambda and tau_y are defined in two-phaseEVP.h . The log conformation approach The numerical resolution of viscoelastic and EVP fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic and EVP fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the extra stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . /* TODO : - Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h) */ #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time ( const ) scalar tau0 = unity ; // yield-stress scalar A11 [], A12 [], A22 []; // conformation tensor scalar T11 [], T12 [], T22 []; // stress tensor #if AXI scalar AThTh [], T_ThTh []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T22 , A12 }) { foreach (){ s [] = 0. ; } } #if AXI foreach (){ T_ThTh [] = 0 ; AThTh [] = 1. ; } #endif for ( scalar s in { T11 , T12 , T22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } for ( scalar s in { A11 , A12 , A22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } #if AXI T12 [ bottom ] = dirichlet ( 0. ); A12 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In an Oldroyd-B...",
    "content": "In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; #if AXI scalar Psiqq = AThTh ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . x = A11 []; A . y . y = A22 []; A . x . y = A12 []; #if AXI double Aqq = AThTh []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: If it does,...",
    "content": "If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g, Lambda.y = %g \\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g, y = %g \\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi11 , Psi12 , Psi22 , Psiqq }, uf , dt ); #else advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); #endif Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] #if AXI double tauD = sqrt (( 1. / 6. )*(( T11 [] - T22 [])*( T11 [] - T22 [])+( T22 [] - T_ThTh [])*( T22 [] - T_ThTh [])+( T_ThTh [] - T11 [])*( T_ThTh [] - T11 [])) + T12 []* T12 []); #else double tauD = sqrt ( 0.25 *( T11 [] - T22 [])*( T11 [] - T22 []) + T12 []* T12 []); #endif double yieldFactor = max ( 0. , ( tauD - tau0 [])/( tauD + 1e-6 )); // $\\mathcal{F}$ double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt * yieldFactor / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: A12 [] =...",
    "content": "A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; #if AXI AThTh [] = Aqq ; T_ThTh [] = Gp []*( Aqq - 1. ); #endif A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } Divergence of the extra stress tensor The extra stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation. For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face ( x ){ if ( fm . x [] > 1e-20 ) { double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shearX + cm []* T11 [] - cm [- 1 ]* T11 [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ){ if ( fm . y [] > 1e-20 ) { double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . y [] += ( shearY + cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ])* alpha . y []/( sq ( fm . y [])* Delta ); } } #if AXI foreach_face ( y ) if ( y > 1e-20 ) av . y [] -= ( T_ThTh [] + T_ThTh [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: /*TODO:- Perhaps, instead...",
    "content": "/*TODO:- Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h)*/#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation time(const)scalar tau0=unity;// yield-stressscalar A11[],A12[],A22[];// conformation tensorscalar T11[],T12[],T22[];// stress tensor#if AXIscalar AThTh[],T_ThTh[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T22,A12}){foreach(){s[]=0.;}}#if AXIforeach(){T_ThTh[]=0;AThTh[]=1.;}#endiffor(scalar s in{T11,T12,T22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}for(scalar s in{A11,A12,A22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}#if AXIT12[bottom]=dirichlet(0.);A12[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;#if AXIscalar Psiqq=AThTh;#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A;A.x.x=A11[];A.y.y=A22[];A.x.y=A12[];#if AXIdoubleAqq=AThTh[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x = %g, Lambda.y = %g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x = %g, y = %g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIadvection({Psi11,Psi12,Psi22,Psiqq},uf,dt);#elseadvection({Psi11,Psi12,Psi22},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIdoubletauD=sqrt((1./6.)*((T11[]-T22[])*(T11[]-T22[])+(T22[]-T_ThTh[])*(T22[]-T_ThTh[])+(T_ThTh[]-T11[])*(T_ThTh[]-T11[]))+T12[]*T12[]);#elsedoubletauD=sqrt(0.25*(T11[]-T22[])*(T11[]-T22[])+T12[]*T12[]);#endifdoubleyieldFactor=max(0.,(tauD-tau0[])/(tauD+1e-6));// $\\mathcal{F}$doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt*yieldFactor/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;#if AXIAThTh[]=Aqq;T_ThTh[]=Gp[]*(Aqq-1.);#endifA11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;foreach_face(x){if(fm.x[]>1e-20){doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shearX+cm[]*T11[]-cm[-1]*T11[-1])*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;av.y[]+=(shearY+cm[]*T22[]-cm[0,-1]*T22[0,-1])*alpha.y[]/(sq(fm.y[])*Delta);}}#if AXIforeach_face(y)if(y>1e-20)av.y[]-=(T_ThTh[]+T_ThTh[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation: Local Source Files...",
    "content": "Local Source Files eigen_decomposition.h This module provides algorithms for computing eigenvalues and eigenvectors of 3x3 symmetric matrices, which are commo... log-conform-elastoviscoplastic-scalar-2D.h Elasto-viscoplastic fluids exhibit viscous, elastic and plastic behaviour when subjected to deformation. Therefore th... log-conform-elastoviscoplastic-scalar-3D.h Elasto-viscoplastic fluids exhibit viscous, elastic and plastic behaviour when subjected to deformation. Therefore th... log-conform-elastoviscoplastic.h The implementation follows the standard log-conformation approach: 1. Uses tensor mathematics for clean formulation 2... log-conform-viscoelastic-scalar-2D.h Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materia... log-conform-viscoelastic-scalar-3D.h Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation: Context",
    "content": "Therefore these materia... log-conform-viscoelastic.h The implementation follows the standard log-conformation approach: 1. Uses tensor mathematics for clean formulation 2... parse_params.sh parseparamfile() { local paramfile=\\$1 if [ ! -f '\\$paramfile' ]; then echo 'ERROR: Parameter file \\$paramfile not fo... two-phaseEVP.h This is a modified version of [two-phase.h](http://basilisk.fr/src/two-phase.h). It contains the implementation of Vi... two-phaseVE.h This is a modified version of [two-phase.h](http://basilisk.fr/src/two-phase.h). It contains the implementation of Vi...",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "src-local/parse_params.sh See raw file parse_params.sh #!/bin/bash # parse_params.sh - Shell library for parameter file parsing # Source this file: source src-local/parse_params.sh # Parse a parameter file and export all parameters as environment variables # Usage: parse_param_file <file> parse_param_file() { local param_file = \\$ 1 if [ ! -f \" \\$ param_file\" ] ; then echo \"ERROR: Parameter file \\$ param_file not found\" >& 2 return 1 fi # Read parameters (skip comments and empty lines) while IFS = '=' read -r key value || [ -n \" \\$ key\" ] ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) key = \\$ ( echo \" \\$ key\" | xargs ) # Skip if key or value is empty [ -z \" \\$ key\" ] && continue [ -z \" \\$ value\" ] && continue # Export as environment variable with PARAM_ prefix export \"PARAM_ \\$ {key}= \\$ {value}\" done < \" \\$ param_file\" return 0 } # Get a parameter value with optional default # Usage: get_param <key> [default] get_param() { local key = \\$ 1 local default = \\$ {2:-} local var_name = \"PARAM_ \\$ {key}\" echo \" \\$ {!var_name:- \\$ default}\" } # Generate sweep combinations and create parameter files # Usage: generate_sweep_cases <sweep_file> # Returns: directory containing generated parameter files generate_sweep_cases() { local sweep_file = \\$ 1 if [ ! -f \" \\$ sweep_file\" ] ; then echo \"ERROR: Sweep file \\$ sweep_file not found\" >& 2 return 1 fi # Source the sweep file to get variables source \" \\$ sweep_file\" # Check if BASE_CONFIG is defined if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 return 1 fi # Parse base configuration parse_param_file \" \\$ BASE_CONFIG\" # Create temporary directory for generated cases local temp_dir = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) # Extract sweep variables local sweep_vars = () local sweep_values = () while IFS = '=' read -r line ; do # Remove comments line = \\$ ( echo \" \\$ line\" | sed 's/#.*//' ) [ -z \" \\$ line\" ] && continue # Match SWEEP_* variables if [[ \" \\$ line\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) = ( .+ ) \\$ ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" var_values = \" \\$ {BASH_REMATCH[2]}\" sweep_vars += ( \" \\$ var_name\" ) sweep_values += ( \" \\$ var_values\" ) fi done < \" \\$ sweep_file\" if [ \\$ {#sweep_vars[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ sweep_file\" >& 2 rm -rf \" \\$ temp_dir\" return 1 fi # Generate cartesian product of sweep values local case_num = 0 # Recursive function to generate all combinations generate_recursive() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#sweep_vars[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {temp_dir}/case_ \\$ (printf \" %04d \" \\$ case_num).params\" local output_dir = \" \\$ OUTPUT_TEMPLATE\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override with sweep values for i in \" \\$ {!sweep_vars[@]}\" ; do local var = \" \\$ {sweep_vars[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" # Replace in parameter file if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i.bak \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Replace in output template output_dir = \" \\$ {output_dir//\\{ \\$ {var}\\}/ \\$ {val}}\" done # Set output directory if grep -q \"^output_dir=\" \" \\$ case_file\" ; then sed -i.bak \"s|^output_dir=.*|output_dir= \\$ {output_dir}|\" \" \\$ case_file\" else echo \"output_dir= \\$ {output_dir}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" (( case_num ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {sweep_values[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_recursive \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion generate_recursive 0 echo \" \\$ temp_dir\" return 0 } # Validate that required variables are set in parameter file # Usage: validate_required_params <param1> <param2> ... validate_required_params() { local missing = 0 for param in \" \\$ @\" ; do local var_name = \"PARAM_ \\$ {param}\" if [ -z \" \\$ {!var_name}\" ] ; then echo \"ERROR: Required parameter ' \\$ param' not found\" >& 2 missing = 1 fi done return \\$missing } # Print all loaded parameters (for debugging) print_params() { echo \"Loaded parameters:\" env | grep \"^PARAM_\" | sort | while IFS = '=' read -r key value ; do key = \" \\$ {key#PARAM_}\" echo \" \\$ key = \\$ value\" done }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "#!/bin/bash# parse_params.sh - Shell library for parameter file parsing# Source this file: source src-local/parse_params.sh# Parse a parameter file and export all parameters as environment variables# Usage: parse_param_file <file>parse_param_file(){localparam_file=\\$1if[!-f\"\\$param_file\"];thenecho\"ERROR: Parameter file\\$param_file not found\">&2return1fi# Read parameters (skip comments and empty lines)whileIFS='='read-rkeyvalue||[-n\"\\$key\"];do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)key=\\$(echo\"\\$key\"|xargs)# Skip if key or value is empty[-z\"\\$key\"]&&continue[-z\"\\$value\"]&&continue# Export as environment variable with PARAM_ prefixexport\"PARAM_\\${key}=\\${value}\"done<\"\\$param_file\"return0}# Get a parameter value with optional default# Usage: get_param <key> [default]get_param(){localkey=\\$1localdefault=\\${2:-}localvar_name=\"PARAM_\\${key}\"echo\"\\${!var_name:-\\$default}\"}# Generate sweep combinations and create parameter files# Usage: generate_sweep_cases <sweep_file># Returns: directory containing generated parameter filesgenerate_sweep_cases(){localsweep_file=\\$1if[!-f\"\\$sweep_file\"];thenecho\"ERROR: Sweep file\\$sweep_file not found\">&2return1fi# Source the sweep file to get variablessource\"\\$sweep_file\"# Check if BASE_CONFIG is definedif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2return1fi# Parse base configurationparse_param_file\"\\$BASE_CONFIG\"# Create temporary directory for generated caseslocaltemp_dir=\\$(mktemp -d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")# Extract sweep variableslocalsweep_vars=()localsweep_values=()whileIFS='='read-rline;do# Remove commentsline=\\$(echo\"\\$line\"|sed's/#.*//')[-z\"\\$line\"]&&continue# Match SWEEP_* variablesif[[\"\\$line\"=~^[[:space:]]*SWEEP_([^=]+)=(.+)\\$]];thenvar_name=\"\\${BASH_REMATCH[1]}\"var_values=\"\\${BASH_REMATCH[2]}\"sweep_vars+=(\"\\$var_name\")sweep_values+=(\"\\$var_values\")fidone<\"\\$sweep_file\"if[\\${#sweep_vars[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$sweep_file\">&2rm-rf\"\\$temp_dir\"return1fi# Generate cartesian product of sweep valueslocalcase_num=0# Recursive function to generate all combinationsgenerate_recursive(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#sweep_vars[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${temp_dir}/case_\\$(printf \"%04d\"\\$case_num).params\"localoutput_dir=\"\\$OUTPUT_TEMPLATE\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override with sweep valuesforiin\"\\${!sweep_vars[@]}\";dolocalvar=\"\\${sweep_vars[\\$i]}\"localval=\"\\${current_values[\\$i]}\"# Replace in parameter fileifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i.bak\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Replace in output templateoutput_dir=\"\\${output_dir//\\{\\${var}\\}/\\${val}}\"done# Set output directoryifgrep-q\"^output_dir=\"\"\\$case_file\";thensed-i.bak\"s|^output_dir=.*|output_dir=\\${output_dir}|\"\"\\$case_file\"elseecho\"output_dir=\\${output_dir}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"((case_num++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${sweep_values[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_recursive\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursiongenerate_recursive0echo\"\\$temp_dir\"return0}# Validate that required variables are set in parameter file# Usage: validate_required_params <param1> <param2> ...validate_required_params(){localmissing=0forparamin\"\\$@\";dolocalvar_name=\"PARAM_\\${param}\"if[-z\"\\${!var_name}\"];thenecho\"ERROR: Required parameter '\\$param' not found\">&2missing=1fidonereturn\\$missing}# Print all loaded parameters (for debugging)print_params(){echo\"Loaded parameters:\"env|grep\"^PARAM_\"|sort|whileIFS='='read-rkeyvalue;dokey=\"\\${key#PARAM_}\"echo\"\\$key =\\$value\"done}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-elastoviscoplastic-scalar-3D.h See raw file Log-Conformation Method for 3D Elasto-viscoplastic Fluids Overview Title : log-conform-elastoviscoplastic-3D.h Version : 2.7 Description : Implementation of the log-conformation method for elasto-viscoplastic fluids in 3D Key Features Conformation tensor A exists across the domain and relaxes according to \u03bb Stress acts according to elastic modulus G 3D implementation extending log-conform-elastoviscoplastic.h Eigenvalue clamping for numerical stability Author Information Name : Vatsal Sanjay, Arivazhagan G.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Balasubramanian (Ari) Email...",
    "content": "Balasubramanian (Ari) Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Jun 30, 2025 Dependencies bcg.h: Bell-Collela-Glaz scheme for advection eigen_decomposition.h: For 3D eigenvalue computation navier-stokes/centered.h: For base flow solver References Fattal & Kupferman (2004, 2005): Original log-conformation method Comminal et al. (2015): Constitutive model functions Hao & Pan (2007): Split scheme implementation Version History v1.0 (Oct 19, 2024) Initial 3D implementation Scalar implementation approach v1.1 (Oct 20, 2024) Added negative eigenvalue detection Added error reporting system v2.0 (Oct 29, 2024) Major matrix algebra corrections for 3D Optimized tensor calculations Improved code structure and documentation v2.1 (Oct 29, 2024) Added initialization functions for tensor structures v2.2 (Nov 3, 2024) Refactored tensor operations Improved code maintainability Enhanced tensor manipulation consistency v2.3 (Nov 14, 2024) Added infinite Deborah number support v2.5 (Nov 23, 2024) Documentation improvements Added mathematical explanations v2.6 (Mar 16, 2025) Implemented eigenvalue clamping system Added minimum eigenvalue threshold (EIGENVALUE_MIN = 1e-8) Improved numerical stability handling Added diagnostic capabilities Fixed 3D velocity gradient calculation v2.7 (Jun 30, 2025) Added the plasticity based relaxation module (Saramito (2007) model) Implementation Notes The code extends the standard Basilisk log-conformation implementation Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling with polymeric stress Includes both 2D and 3D implementations Uses atomic operations for thread-safe diagnostics Future Work Axisymmetric Compatibility Currently not implemented Use log-conform-elastoviscoplastic-scalar-2D.h for axi cases Or use log-conform-elastoviscoplastic.h for better efficiency Metric Terms Improvements Enforce tensor compatibility using foreach_dimension Complete metric terms (cm, fm) implementation #if AXI #error \"axi compatibility is not there.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Introduction",
    "content": "To keep the code easy to read, we will not implement axi compatibility just yet.\" #endif The log-conformation method for some elasto-viscoplastic constitutive models Introduction Elasto-viscoplastic fluids exhibit viscous, elastic and plastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the EVP fluid. The extra stress \\(\\mathbf{T}\\) includes memory effects due to the polymers and the plasticity effects associated with internal structural changes in the material that constitutes to yielding the material and fluidizes it.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "Several constitutive rheological models are available in the literature where the extra stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the case...",
    "content": "In the case of Saramito (2007) elasto-viscoplastic model, where the material before yielding is represented by Kelvin-Voigt viscoelastic solid and long after yielding recovers the Oldroyd-B type viscoelastic fluid behaviour, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , \\(\\mathbf{f}_r (\\mathbf{A}) = \\mathcal{F}(\\mathbf{A} -\\mathbf{I})\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ (\\mathcal{F}/\\lambda) \\mathbf{T} + (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Here, \\(\\mathcal{F} = max(0., \\frac{\\|\\tau_d\\|-\\tau_y}{\\|\\tau_d\\|}\\) . Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different viscoelastic constitutive models. This work is an extension of such formulation for elasto-viscoplastic materials. Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The solvent viscosity...",
    "content": "The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic and EVP fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic and EVP fluids, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the extra stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}). \\] We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . /* TODO : - Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h) */ #define EIGENVALUE_MIN 1e-8 #ifdef DEBUG_EIGENVALUES static int eigenvalue_corrections = 0 ; #endif #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time ( const ) scalar tau0 = unity ; // yield-stress /* conformation tensor */ // diagonal elements scalar A11 [], A22 [], A33 []; // off-diagonal elements scalar A12 [], A13 [], A23 []; /* stress tensor */ // diagonal elements scalar T11 [], T22 [], T33 []; // off-diagonal elements scalar T12 [], T13 [], T23 []; event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 , A33 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T13 , T22 , T23 , T33 , A12 , A13 , A23 }) { foreach (){ s [] = 0. ; } } for ( scalar s in { A11 , A22 , A33 , T11 , T22 , T33 , A12 , A13 , A23 , T12 , T13 , T23 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } if ( s . boundary [ top ] != periodic_bc ) { s [ top ] = neumann ( 0 ); s [ bottom ] = neumann ( 0 ); } #if dimension == if ( s . boundary [ front ] != periodic_bc ) { s [ front ] = neumann ( 0 ); s [ back ] = neumann ( 0 ); } #endif } } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. #if dimension == typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } #endif /* Now this is the 3D implementation. */ #if dimension == #include \"eigen_decomposition.h\" typedef struct { double x , y , z ; } pseudo_v3d ; typedef struct { pseudo_v3d x , y , z ; } pseudo_t3d ; // Function to initialize pseudo_v3d static inline void init_pseudo_v3d ( pseudo_v3d * v , double value ) { v -> x = value ; v -> y = value ; v -> z = value ; } // Function to initialize pseudo_t3d static inline void init_pseudo_t3d ( pseudo_t3d * t , double value ) { init_pseudo_v3d (& t -> x , value ); init_pseudo_v3d (& t -> y , value ); init_pseudo_v3d (& t -> z , value ); } static void diagonalization_3D ( pseudo_v3d * Lambda , pseudo_t3d * R , pseudo_t3d * A ) { // Check if the matrix is already diagonal if ( sq ( A -> x . y ) + sq ( A -> x . z ) + sq ( A -> y . z ) < 1e-15 ) { R -> x . x = R -> y . y = R -> z . z = 1. ; R -> y . x = R -> x . y = R -> z . x = R -> x . z = R -> z . y = R -> y . z = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; Lambda -> z = A -> z . z ; return ; } // Compute eigenvalues using the eigen_decomposition function double matrix [ 3 ][ 3 ] = { { A -> x . x , A -> x . y , A -> x . z }, { A -> y . x , A -> y . y , A -> y . z }, { A -> z . x , A -> z . y , A -> z . z } }; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); // Store eigenvalues and eigenvectors Lambda -> x = eigenvalues [ 0 ]; Lambda -> y = eigenvalues [ 1 ]; Lambda -> z = eigenvalues [ 2 ]; R -> x . x = eigenvectors [ 0 ][ 0 ]; R -> x . y = eigenvectors [ 0 ][ 1 ]; R -> x . z = eigenvectors [ 0 ][ 2 ]; R -> y . x = eigenvectors [ 1 ][ 0 ]; R -> y . y = eigenvectors [ 1 ][ 1 ]; R -> y . z = eigenvectors [ 1 ][ 2 ]; R -> z . x = eigenvectors [ 2 ][ 0 ]; R -> z . y = eigenvectors [ 2 ][ 1 ]; R -> z . z = eigenvectors [ 2 ][ 2 ]; } #endif The stress tensor depends on previous instants and has to be integrated in time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the log-conformation...",
    "content": "In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) . We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In an Oldroyd-B...",
    "content": "In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] #if dimension == event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A = {{ A11 [], A12 []}, { A12 [], A22 []}}; The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at (%g,%g): [%g,%g] \\n \" , x , y , Lambda . x , Lambda . y ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double tauD = sqrt ( 0.25 *( T11 [] - T22 [])*( T11 [] - T22 []) + T12 []* T12 []); double yieldFactor = max ( 0. , ( tauD - tau0 [])/( tauD + 1e-6 )); // $\\mathcal{F}$ double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt * yieldFactor / lambda [])): 0. ); A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: A12 [] =...",
    "content": "A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } #elif dimension == event tracer_advection ( i ++) { Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term // start by declaring the scalar variables that will store the components of $\\Psi$ scalar Psi11 = A11 , Psi12 = A12 , Psi13 = A13 , Psi22 = A22 , Psi23 = A23 , Psi33 = A33 ; foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); A . x . x = A11 []; A . x . y = A12 []; A . x . z = A13 []; A . y . x = A12 []; A . y . y = A22 []; A . y . z = A23 []; A . z . x = A13 []; A . z . y = A23 []; A . z . z = A33 []; // Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors R diagonalization_3D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. || Lambda . z <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at (%g,%g,%g): [%g,%g,%g] \\n \" , x , y , z , Lambda . x , Lambda . y , Lambda . z ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); Lambda . z = max ( Lambda . z , EIGENVALUE_MIN ); } // Compute Psi = log(A) = R * log(Lambda) * R^T Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ) + sq ( R . x . z )* log ( Lambda . z ); Psi22 [] = sq ( R . y . x )* log ( Lambda . x ) + sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . z )* log ( Lambda . z ); Psi33 [] = sq ( R . z . x )* log ( Lambda . x ) + sq ( R . z . y )* log ( Lambda . y ) + sq ( R . z . z )* log ( Lambda . z ); Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . x . y * R . y . y * log ( Lambda . y ) + R . x . z * R . y . z * log ( Lambda . z ); Psi13 [] = R . x . x * R . z . x * log ( Lambda . x ) + R . x . y * R . z . y * log ( Lambda . y ) + R . x . z * R . z . z * log ( Lambda . z ); Psi23 [] = R . y . x * R . z . x * log ( Lambda . x ) + R . y . y * R . z . y * log ( Lambda . y ) + R . y . z * R . z . z * log ( Lambda . z ); // Compute B and Omega tensors (3D version) pseudo_t3d B , M , Omega ; init_pseudo_t3d (& B , 0.0 ); init_pseudo_t3d (& M , 0.0 ); init_pseudo_t3d (& Omega , 0.0 ); // Check if any pair of eigenvalues are numerically equal (within a small tolerance) if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 || fabs ( Lambda . y - Lambda . z ) <= 1e-20 || fabs ( Lambda . z - Lambda . x ) <= 1e-20 ) { // In case of equal eigenvalues, the calculations for B and Omega simplify significantly // B is grad U and Omega is zero. // Compute off-diagonal elements of B using central differences // These represent the symmetric part of the velocity gradient tensor B . x . y = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ] + u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 4. * Delta ); // (dv/dx + du/dy)/2 B . x . z = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ] + u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dx + du/dz)/2 B . y . z = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ] + u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dy + dv/dz)/2 // Compute diagonal elements of B // These represent the normal strain rates B . x . x = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2. * Delta ); // du/dx B . y . y = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2. * Delta ); // dv/dy B . z . z = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2. * Delta ); // dw/dz // Set all components of Omega to zero // This is because Omega represents the antisymmetric part of the velocity gradient tensor, // which vanishes when eigenvalues are equal Omega . x . y = Omega . x . z = Omega . y . z = Omega . y . x = Omega . z . x = Omega . z . y = 0. ; } else { /* ### Compute the velocity gradient tensor components using central differences - These represent the spatial derivatives of each velocity component - These gradients form the velocity gradient tensor (nablaU): [ dudx dudy dudz ] [ dvdx dvdy dvdz ] [ dwdx dwdy dwdz ] */ // Derivatives of u (x-component of velocity) double dudx = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2.0 * Delta ); // du/dx double dudy = ( u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // du/dy double dudz = ( u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // du/dz // Derivatives of v (y-component of velocity) double dvdx = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dv/dx double dvdy = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dv/dy double dvdz = ( u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dv/dz // Derivatives of w (z-component of velocity) double dwdx = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dw/dx double dwdy = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dw/dy double dwdz = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dw/dz /* Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor. * Steps: 1. Compute intermediate products (R * nablaU^T): - Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_* - Each variable represents one row of the intermediate matrix 2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor: - M.i.j represents the (i,j) component of the transformed velocity gradient - This transformation expresses the velocity gradient in the eigenvector basis - The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that */ // First, compute intermediate products of R and (nablaU)^T double Rx_gradU_x = R . x . x * dudx + R . x . y * dvdx + R . x . z * dwdx ; double Rx_gradU_y = R . x . x * dudy + R . x . y * dvdy + R . x . z * dwdy ; double Rx_gradU_z = R . x . x * dudz + R . x . y * dvdz + R . x . z * dwdz ; double Ry_gradU_x = R . y . x * dudx + R . y . y * dvdx + R . y . z * dwdx ; double Ry_gradU_y = R . y . x * dudy + R . y . y * dvdy + R . y . z * dwdy ; double Ry_gradU_z = R . y . x * dudz + R . y . y * dvdz + R . y . z * dwdz ; double Rz_gradU_x = R . z . x * dudx + R . z . y * dvdx + R . z . z * dwdx ; double Rz_gradU_y = R . z . x * dudy + R . z . y * dvdy + R . z . z * dwdy ; double Rz_gradU_z = R . z . x * dudz + R . z . y * dvdz + R . z . z * dwdz ; // Now compute M components by multiplying the intermediate products with R^T M . x . x = R . x . x * Rx_gradU_x + R . x . y * Rx_gradU_y + R . x . z * Rx_gradU_z ; M . x . y = R . x . x * Ry_gradU_x + R . x . y * Ry_gradU_y + R . x . z * Ry_gradU_z ; M . x . z = R . x . x * Rz_gradU_x + R . x . y * Rz_gradU_y + R . x . z * Rz_gradU_z ; M . y . x = R . y . x * Rx_gradU_x + R . y . y * Rx_gradU_y + R . y . z * Rx_gradU_z ; M . y . y = R . y . x * Ry_gradU_x + R . y . y * Ry_gradU_y + R . y . z * Ry_gradU_z ; M . y . z = R . y . x * Rz_gradU_x + R . y . y * Rz_gradU_y + R . y . z * Rz_gradU_z ; M . z . x = R . z . x * Rx_gradU_x + R . z . y * Rx_gradU_y + R . z . z * Rx_gradU_z ; M . z . y = R . z . x * Ry_gradU_x + R . z . y * Ry_gradU_y + R . z . z * Ry_gradU_z ; M . z . z = R . z . x * Rz_gradU_x + R . z . y * Rz_gradU_y + R . z . z * Rz_gradU_z ; // Compute the off-diagonal elements of the Omega tensor in the eigenvector basis double omega_xy = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); double omega_xz = ( Lambda . z * M . x . z + Lambda . x * M . z . x )/( Lambda . z - Lambda . x ); double omega_yz = ( Lambda . z * M . y . z + Lambda . y * M . z . y )/( Lambda . z - Lambda . y ); // Calculate intermediate rotation combinations for each direction // x-direction rotation combinations double rot_x_xy_yz = ( R . x . x * omega_xy - R . x . z * omega_yz ); // xy rotation minus yz rotation, x components double rot_x_xy_xz = ( R . x . y * omega_xy + R . x . z * omega_xz ); // xy rotation plus xz rotation, x components double rot_x_xz_yz = ( R . x . x * omega_xz + R . x . y * omega_yz ); // xz rotation plus yz rotation, x components // y-direction rotation combinations double rot_y_xy_yz = ( R . y . x * omega_xy - R . y . z * omega_yz ); // xy rotation minus yz rotation, y components double rot_y_xy_xz = ( R . y . y * omega_xy + R . y . z * omega_xz ); // xy rotation plus xz rotation, y components double rot_y_xz_yz = ( R . y . x * omega_xz + R . y . y * omega_yz ); // xz rotation plus yz rotation, y components // z-direction rotation combinations double rot_z_xy_yz = ( R . z . x * omega_xy - R . z . z * omega_yz ); // xy rotation minus yz rotation, z components double rot_z_xy_xz = ( R . z . y * omega_xy + R . z . z * omega_xz ); // xy rotation plus xz rotation, z components double rot_z_xz_yz = ( R . z . x * omega_xz + R . z . y * omega_yz ); // xz rotation plus yz rotation, z components /* Calculate the components of the Omega tensor in the physical coordinate system * * The Omega tensor represents the rotational part of the velocity gradient tensor * and is computed through the following steps: * * 1.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We already have:...",
    "content": "We already have: * - R: eigenvector matrix of the conformation tensor * - rot_*_*_*: pre-computed rotation combinations for each direction * * 2. Mathematical background: * Omega = R * Omega_eigen * R^T * where Omega_eigen is the rotation tensor in eigenvector space * * 3.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The components are...",
    "content": "The components are calculated using the rotation combinations: * - rot_i_jk_lm represents combined rotations in the i-direction * - Each component Omega_ij is a linear combination of these rotations */ // Compute x-row components of Omega Omega . x . x = R . x . y * rot_x_xy_yz // xy-yz rotation contribution - R . x . x * rot_x_xy_xz // xy-xz rotation contribution + R . x . z * rot_x_xz_yz ; // xz-yz rotation contribution Omega . x . y = R . y . y * rot_x_xy_yz // xy-yz rotation mapped to y-direction - R . y . x * rot_x_xy_xz // xy-xz rotation mapped to y-direction + R . y . z * rot_x_xz_yz ; // xz-yz rotation mapped to y-direction Omega . x . z = R . z . y * rot_x_xy_yz // xy-yz rotation mapped to z-direction - R . z . x * rot_x_xy_xz // xy-xz rotation mapped to z-direction + R . z . z * rot_x_xz_yz ; // xz-yz rotation mapped to z-direction // Compute y-row components using similar pattern Omega . y . x = R . x . y * rot_y_xy_yz - R . x . x * rot_y_xy_xz + R . x . z * rot_y_xz_yz ; Omega . y . y = R . y . y * rot_y_xy_yz - R . y . x * rot_y_xy_xz + R . y . z * rot_y_xz_yz ; Omega . y . z = R . z . y * rot_y_xy_yz - R . z . x * rot_y_xy_xz + R . z . z * rot_y_xz_yz ; // Compute z-row components using similar pattern Omega . z . x = R . x . y * rot_z_xy_yz - R . x . x * rot_z_xy_xz + R . x . z * rot_z_xz_yz ; Omega . z . y = R . y . y * rot_z_xy_yz - R . y . x * rot_z_xy_xz + R . y . z * rot_z_xz_yz ; Omega . z . z = R . z . y * rot_z_xy_yz - R . z . x * rot_z_xy_xz + R . z . z * rot_z_xz_yz ; /* Note: The resulting Omega tensor is skew-symmetric, meaning: * Omega_ij = -Omega_ji * This property is automatically satisfied by the construction above * and is essential for preserving the physical meaning of rotation */ // Extract diagonal components of M (velocity gradient tensor in eigenvector basis) double M_diag_x = M . x . x , M_diag_y = M . y . y , M_diag_z = M . z . z ; /* Compute B tensor: B = R * diag(M) * R^T - This transforms the diagonal velocity gradient tensor back to the original coordinate system - B is symmetric, so we only need to compute the upper triangle */ // Compute diagonal elements of B B . x . x = M_diag_x * sq ( R . x . x ) + M_diag_y * sq ( R . x . y ) + M_diag_z * sq ( R . x . z ); B . y . y = M_diag_x * sq ( R . y . x ) + M_diag_y * sq ( R . y . y ) + M_diag_z * sq ( R . y . z ); B . z . z = M_diag_x * sq ( R . z . x ) + M_diag_y * sq ( R . z . y ) + M_diag_z * sq ( R . z . z ); // Compute off-diagonal elements of B (upper triangle) B . x . y = M_diag_x * R . x . x * R . y . x + M_diag_y * R . x . y * R . y . y + M_diag_z * R . x . z * R . y . z ; B . x . z = M_diag_x * R . x . x * R . z . x + M_diag_y * R . x . y * R . z . y + M_diag_z * R . x . z * R . z . z ; B . y . z = M_diag_x * R . y . x * R . z . x + M_diag_y * R . y . y * R . z . y + M_diag_z * R . y . z * R . z . z ; // Fill in lower triangle using symmetry of B B . y . x = B . x . y ; B . z . x = B . x . z ; B . z . y = B . y . z ; } We now advance \\(\\Psi\\) in time, adding the upper convective contribution.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step 1:...",
    "content": "This step 1: _t = 2 + (-) // save old values of Psi components double old_Psi11 = Psi11 []; double old_Psi22 = Psi22 []; double old_Psi33 = Psi33 []; double old_Psi12 = Psi12 []; double old_Psi13 = Psi13 []; double old_Psi23 = Psi23 []; // Psi11 Psi11 [] += dt * ( 2.0 * B . x . x + Omega . x . y * old_Psi12 - Omega . y . x * old_Psi12 + Omega . x . z * old_Psi13 - Omega . z . x * old_Psi13 ); // Psi22 Psi22 [] += dt * ( 2.0 * B . y . y - Omega . x . y * old_Psi12 + Omega . y . x * old_Psi12 + Omega . y . z * old_Psi23 - Omega . z . y * old_Psi23 ); // Psi33 Psi33 [] += dt * ( 2.0 * B . z . z - Omega . x . z * old_Psi13 + Omega . z . x * old_Psi13 - Omega . y . z * old_Psi23 + Omega . z . y * old_Psi23 ); // Psi12 Psi12 [] += dt * ( 2.0 * B . x . y + Omega . x . x * old_Psi12 - Omega . x . y * old_Psi11 + Omega . x . y * old_Psi22 - Omega . y . y * old_Psi12 + Omega . x . z * old_Psi23 - Omega . z . y * old_Psi13 ); // Psi13 Psi13 [] += dt * ( 2.0 * B . x . z + Omega . x . x * old_Psi13 - Omega . x . z * old_Psi11 + Omega . x . y * old_Psi23 - Omega . y . z * old_Psi12 + Omega . x . z * old_Psi33 - Omega . z . z * old_Psi13 ); // Psi23 Psi23 [] += dt * ( 2.0 * B . y . z + Omega . y . x * old_Psi13 - Omega . x . z * old_Psi12 + Omega . y . y * old_Psi23 - Omega . y . z * old_Psi22 + Omega . y . z * old_Psi33 - Omega . z . z * old_Psi23 ); } // Advection of Psi, which is the log-conformation tensor advection ({ Psi11 , Psi12 , Psi13 , Psi22 , Psi23 , Psi33 }, uf , dt ); Convert back to A and T We now convert the log-conformation tensor Psi back to the conformation tensor A and compute the stress tensor T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This process involves...",
    "content": "This process involves diagonalization, exponentiation of eigenvalues, and application of the relaxation factor. foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); // Reconstruct the log-conformation tensor from its components A . x . x = Psi11 []; A . x . y = Psi12 []; A . x . z = Psi13 []; A . y . x = Psi12 []; A . y . y = Psi22 []; A . y . z = Psi23 []; A . z . x = Psi13 []; A . z . y = Psi23 []; A . z . z = Psi33 []; // Diagonalize A to obtain eigenvalues and eigenvectors diagonalization_3D (& Lambda , & R , & A ); // Exponentiate eigenvalues Lambda . x = exp ( Lambda . x ); Lambda . y = exp ( Lambda . y ); Lambda . z = exp ( Lambda . z ); // Reconstruct A using A = R * diag(Lambda) * R^T A . x . x = Lambda . x * sq ( R . x . x ) + Lambda . y * sq ( R . x . y ) + Lambda . z * sq ( R . x . z ); A . x . y = Lambda . x * R . x . x * R . y . x + Lambda . y * R . x . y * R . y . y + Lambda . z * R . x . z * R . y . z ; A . y . x = A . x . y ; A . x . z = Lambda . x * R . x . x * R . z . x + Lambda . y * R . x . y * R . z . y + Lambda . z * R . x . z * R . z . z ; A . z . x = A . x . z ; A . y . y = Lambda . x * sq ( R . y . x ) + Lambda . y * sq ( R . y . y ) + Lambda . z * sq ( R . y . z ); A . y . z = Lambda . x * R . y . x * R . z . x + Lambda . y * R . y . y * R . z . y + Lambda . z * R . y . z * R . z . z ; A . z . y = A . y . z ; A . z . z = Lambda . x * sq ( R . z . x ) + Lambda . y * sq ( R . z . y ) + Lambda . z * sq ( R . z . z ); // Apply relaxation using the relaxation time lambda double tauD = sqrt (( 1. / 6. )*(( T11 [] - T22 [])*( T11 [] - T22 [])+( T22 [] - T33 [])*( T22 [] - T33 [])+( T33 [] - T11 [])*( T33 [] - T11 [])) + 3. *( T12 []* T12 [] + T23 []* T23 [] + T13 []* T13 [])); double yieldFactor = max ( 0. , ( tauD - tau0 [])/( tauD + 1e-6 )); // $\\mathcal{F}$ double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt * yieldFactor / lambda [])): 0. ); A . x . y *= intFactor ; A . y . x = A . x . y ; A . x . z *= intFactor ; A . z . x = A . x . z ; A . y . z *= intFactor ; A . z . y = A . y . z ; foreach_dimension () A . x . x = 1. + ( A . x . x - 1. )* intFactor ; /* Get Aij from A.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: These commands might...",
    "content": "These commands might look repetitive. But, I do this so that in the future, generalization to tensor only form is easier. */ // diagonal terms: A11 [] = A . x . x ; A22 [] = A . y . y ; A33 [] = A . z . z ; // off-diagonal terms: A12 [] = A . x . y ; A13 [] = A . x . z ; A23 [] = A . y . z ; // Compute the stress tensor T using the polymer modulus Gp T11 [] = Gp []*( A . x . x - 1. ); T22 [] = Gp []*( A . y . y - 1. ); T33 [] = Gp []*( A . z . z - 1. ); T12 [] = Gp []* A . x . y ; T13 [] = Gp []* A . x . z ; T23 [] = Gp []* A . y . z ; } } #endif Divergence of the extra stress tensor The extra stress tensor \\(\\mathbf{T}\\) is defined at cell centers, while the corresponding force (acceleration) is defined at cell faces. For each component of the momentum equation, we need to compute the divergence of the corresponding row of the stress tensor.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "For example, for the x-component in 3D: \\[ (\\nabla \\cdot \\mathbf{T})_x = \\partial_x T_{xx} + \\partial_y T_{xy} + \\partial_z T_{xz} \\] The normal stress gradient (e.g. \\(\\partial_x T_{xx}\\) ) is computed directly from cell-centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The shear stress...",
    "content": "The shear stress gradients (e.g. \\(\\partial_y T_{xy}\\) ) are computed using vertex-averaged values to avoid checkerboard instabilities. event acceleration ( i ++) { face vector av = a ; #if dimension == // 2D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 (shear stress) double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // x-gradient of T11 (normal stress) double gradX_T11 = cm []* T11 [] - cm [- 1 ]* T11 [- 1 ]; av . x [] += ( shearX + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 (shear stress) double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // y-gradient of T22 (normal stress) double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ]; av . y [] += ( shearY + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } #elif dimension == // 3D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 double shearY = ( T12 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T12 [- 1 , 1 , 0 ]* cm [- 1 , 1 , 0 ] - T12 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T13 double shearZ = ( T13 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T13 [- 1 , 0 , 1 ]* cm [- 1 , 0 , 1 ] - T13 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // x-gradient of T11 double gradX_T11 = cm []* T11 [] - cm [- 1 , 0 , 0 ]* T11 [- 1 , 0 , 0 ]; av . x [] += ( shearY + shearZ + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 double shearX = ( T12 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T12 [ 1 ,- 1 , 0 ]* cm [ 1 ,- 1 , 0 ] - T12 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T23 double shearZ = ( T23 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T23 [ 0 ,- 1 , 1 ]* cm [ 0 ,- 1 , 1 ] - T23 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // y-gradient of T22 double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 , 0 ]* T22 [ 0 ,- 1 , 0 ]; av . y [] += ( shearX + shearZ + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } foreach_face ( z ) { if ( fm . z [] > 1e-20 ) { // x-gradient of T13 double shearX = ( T13 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T13 [ 1 , 0 ,- 1 ]* cm [ 1 , 0 ,- 1 ] - T13 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // y-gradient of T23 double shearY = ( T23 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T23 [ 0 , 1 ,- 1 ]* cm [ 0 , 1 ,- 1 ] - T23 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // z-gradient of T33 double gradZ_T33 = cm []* T33 [] - cm [ 0 , 0 ,- 1 ]* T33 [ 0 , 0 ,- 1 ]; av . z [] += ( shearX + shearY + gradZ_T33 )* alpha . z []/( sq ( fm . z [])* Delta ); } } #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXI#error \"axi compatibility is not there. To keep the code easy to read, we will not implement axi compatibility just yet.\"#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: /*TODO:- Perhaps, instead...",
    "content": "/*TODO:- Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h)*/#define EIGENVALUE_MIN 1e-8#ifdef DEBUG_EIGENVALUESstaticinteigenvalue_corrections=0;#endif#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation time(const)scalar tau0=unity;// yield-stress/*conformation tensor */// diagonal elementsscalar A11[],A22[],A33[];// off-diagonal elementsscalar A12[],A13[],A23[];/*stress tensor */// diagonal elementsscalar T11[],T22[],T33[];// off-diagonal elementsscalar T12[],T13[],T23[];event defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22,A33}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T13,T22,T23,T33,A12,A13,A23}){foreach(){s[]=0.;}}for(scalar s in{A11,A22,A33,T11,T22,T33,A12,A13,A23,T12,T13,T23}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}if(s.boundary[top]!=periodic_bc){s[top]=neumann(0);s[bottom]=neumann(0);}#if dimension ==if(s.boundary[front]!=periodic_bc){s[front]=neumann(0);s[back]=neumann(0);}#endif}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if dimension ==typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}#endif/*Now this is the 3D implementation.*/#if dimension ==#include\"eigen_decomposition.h\"typedefstruct{doublex,y,z;}pseudo_v3d;typedefstruct{pseudo_v3d x,y,z;}pseudo_t3d;// Function to initialize pseudo_v3dstaticinlinevoidinit_pseudo_v3d(pseudo_v3d*v,doublevalue){v->x=value;v->y=value;v->z=value;}// Function to initialize pseudo_t3dstaticinlinevoidinit_pseudo_t3d(pseudo_t3d*t,doublevalue){init_pseudo_v3d(&t->x,value);init_pseudo_v3d(&t->y,value);init_pseudo_v3d(&t->z,value);}staticvoiddiagonalization_3D(pseudo_v3d*Lambda,pseudo_t3d*R,pseudo_t3d*A){// Check if the matrix is already diagonalif(sq(A->x.y)+sq(A->x.z)+sq(A->y.z)<1e-15){R->x.x=R->y.y=R->z.z=1.;R->y.x=R->x.y=R->z.x=R->x.z=R->z.y=R->y.z=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;Lambda->z=A->z.z;return;}// Compute eigenvalues using the eigen_decomposition functiondoublematrix[3][3]={{A->x.x,A->x.y,A->x.z},{A->y.x,A->y.y,A->y.z},{A->z.x,A->z.y,A->z.z}};doubleeigenvectors[3][3];doubleeigenvalues[3];compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);// Store eigenvalues and eigenvectorsLambda->x=eigenvalues[0];Lambda->y=eigenvalues[1];Lambda->z=eigenvalues[2];R->x.x=eigenvectors[0][0];R->x.y=eigenvectors[0][1];R->x.z=eigenvectors[0][2];R->y.x=eigenvectors[1][0];R->y.y=eigenvectors[1][1];R->y.z=eigenvectors[1][2];R->z.x=eigenvectors[2][0];R->z.y=eigenvectors[2][1];R->z.z=eigenvectors[2][2];}#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if dimension ==event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g): [%g,%g]\\n\",x,y,Lambda.x,Lambda.y);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubletauD=sqrt(0.25*(T11[]-T22[])*(T11[]-T22[])+T12[]*T12[]);doubleyieldFactor=max(0.,(tauD-tau0[])/(tauD+1e-6));// $\\mathcal{F}$doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt*yieldFactor/lambda[])):0.);A.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;A11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}#elif dimension ==event tracer_advection(i++){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // start by...",
    "content": "// start by declaring the scalar variables that will store the components of $\\Psi$scalar Psi11=A11,Psi12=A12,Psi13=A13,Psi22=A22,Psi23=A23,Psi33=A33;foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);A.x.x=A11[];A.x.y=A12[];A.x.z=A13[];A.y.x=A12[];A.y.y=A22[];A.y.z=A23[];A.z.x=A13[];A.z.y=A23[];A.z.z=A33[];// Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors Rdiagonalization_3D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.||Lambda.z<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g,%g): [%g,%g,%g]\\n\",x,y,z,Lambda.x,Lambda.y,Lambda.z);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);Lambda.z=max(Lambda.z,EIGENVALUE_MIN);}// Compute Psi = log(A) = R * log(Lambda) * R^TPsi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y)+sq(R.x.z)*log(Lambda.z);Psi22[]=sq(R.y.x)*log(Lambda.x)+sq(R.y.y)*log(Lambda.y)+sq(R.y.z)*log(Lambda.z);Psi33[]=sq(R.z.x)*log(Lambda.x)+sq(R.z.y)*log(Lambda.y)+sq(R.z.z)*log(Lambda.z);Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.x.y*R.y.y*log(Lambda.y)+R.x.z*R.y.z*log(Lambda.z);Psi13[]=R.x.x*R.z.x*log(Lambda.x)+R.x.y*R.z.y*log(Lambda.y)+R.x.z*R.z.z*log(Lambda.z);Psi23[]=R.y.x*R.z.x*log(Lambda.x)+R.y.y*R.z.y*log(Lambda.y)+R.y.z*R.z.z*log(Lambda.z);// Compute B and Omega tensors (3D version)pseudo_t3d B,M,Omega;init_pseudo_t3d(&B,0.0);init_pseudo_t3d(&M,0.0);init_pseudo_t3d(&Omega,0.0);// Check if any pair of eigenvalues are numerically equal (within a small tolerance)if(fabs(Lambda.x-Lambda.y)<=1e-20||fabs(Lambda.y-Lambda.z)<=1e-20||fabs(Lambda.z-Lambda.x)<=1e-20){// In case of equal eigenvalues, the calculations for B and Omega simplify significantly// B is grad U and Omega is zero.// Compute off-diagonal elements of B using central differences// These represent the symmetric part of the velocity gradient tensorB.x.y=(u.y[1,0,0]-u.y[-1,0,0]+u.x[0,1,0]-u.x[0,-1,0])/(4.*Delta);// (dv/dx + du/dy)/2B.x.z=(u.z[1,0,0]-u.z[-1,0,0]+u.x[0,0,1]-u.x[0,0,-1])/(4.*Delta);// (dw/dx + du/dz)/2B.y.z=(u.z[0,1,0]-u.z[0,-1,0]+u.y[0,0,1]-u.y[0,0,-1])/(4.*Delta);// (dw/dy + dv/dz)/2// Compute diagonal elements of B// These represent the normal strain ratesB.x.x=(u.x[1,0,0]-u.x[-1,0,0])/(2.*Delta);// du/dxB.y.y=(u.y[0,1,0]-u.y[0,-1,0])/(2.*Delta);// dv/dyB.z.z=(u.z[0,0,1]-u.z[0,0,-1])/(2.*Delta);// dw/dz// Set all components of Omega to zero// This is because Omega represents the antisymmetric part of the velocity gradient tensor,// which vanishes when eigenvalues are equalOmega.x.y=Omega.x.z=Omega.y.z=Omega.y.x=Omega.z.x=Omega.z.y=0.;}else{/*###Compute the velocity gradient tensor components using central differences- These represent the spatial derivatives of each velocity component- These gradients form the velocity gradient tensor (nablaU):[ dudx  dudy  dudz ][ dvdx  dvdy  dvdz ][ dwdx  dwdy  dwdz ]*/// Derivatives of u (x-component of velocity)doubledudx=(u.x[1,0,0]-u.x[-1,0,0])/(2.0*Delta);// du/dxdoubledudy=(u.x[0,1,0]-u.x[0,-1,0])/(2.0*Delta);// du/dydoubledudz=(u.x[0,0,1]-u.x[0,0,-1])/(2.0*Delta);// du/dz// Derivatives of v (y-component of velocity)doubledvdx=(u.y[1,0,0]-u.y[-1,0,0])/(2.0*Delta);// dv/dxdoubledvdy=(u.y[0,1,0]-u.y[0,-1,0])/(2.0*Delta);// dv/dydoubledvdz=(u.y[0,0,1]-u.y[0,0,-1])/(2.0*Delta);// dv/dz// Derivatives of w (z-component of velocity)doubledwdx=(u.z[1,0,0]-u.z[-1,0,0])/(2.0*Delta);// dw/dxdoubledwdy=(u.z[0,1,0]-u.z[0,-1,0])/(2.0*Delta);// dw/dydoubledwdz=(u.z[0,0,1]-u.z[0,0,-1])/(2.0*Delta);// dw/dz/*Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor.* Steps:1. Compute intermediate products (R * nablaU^T):- Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_*- Each variable represents one row of the intermediate matrix2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor:- M.i.j represents the (i,j) component of the transformed velocity gradient- This transformation expresses the velocity gradient in the eigenvector basis- The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that*/// First, compute intermediate products of R and (nablaU)^TdoubleRx_gradU_x=R.x.x*dudx+R.x.y*dvdx+R.x.z*dwdx;doubleRx_gradU_y=R.x.x*dudy+R.x.y*dvdy+R.x.z*dwdy;doubleRx_gradU_z=R.x.x*dudz+R.x.y*dvdz+R.x.z*dwdz;doubleRy_gradU_x=R.y.x*dudx+R.y.y*dvdx+R.y.z*dwdx;doubleRy_gradU_y=R.y.x*dudy+R.y.y*dvdy+R.y.z*dwdy;doubleRy_gradU_z=R.y.x*dudz+R.y.y*dvdz+R.y.z*dwdz;doubleRz_gradU_x=R.z.x*dudx+R.z.y*dvdx+R.z.z*dwdx;doubleRz_gradU_y=R.z.x*dudy+R.z.y*dvdy+R.z.z*dwdy;doubleRz_gradU_z=R.z.x*dudz+R.z.y*dvdz+R.z.z*dwdz;// Now compute M components by multiplying the intermediate products with R^TM.x.x=R.x.x*Rx_gradU_x+R.x.y*Rx_gradU_y+R.x.z*Rx_gradU_z;M.x.y=R.x.x*Ry_gradU_x+R.x.y*Ry_gradU_y+R.x.z*Ry_gradU_z;M.x.z=R.x.x*Rz_gradU_x+R.x.y*Rz_gradU_y+R.x.z*Rz_gradU_z;M.y.x=R.y.x*Rx_gradU_x+R.y.y*Rx_gradU_y+R.y.z*Rx_gradU_z;M.y.y=R.y.x*Ry_gradU_x+R.y.y*Ry_gradU_y+R.y.z*Ry_gradU_z;M.y.z=R.y.x*Rz_gradU_x+R.y.y*Rz_gradU_y+R.y.z*Rz_gradU_z;M.z.x=R.z.x*Rx_gradU_x+R.z.y*Rx_gradU_y+R.z.z*Rx_gradU_z;M.z.y=R.z.x*Ry_gradU_x+R.z.y*Ry_gradU_y+R.z.z*Ry_gradU_z;M.z.z=R.z.x*Rz_gradU_x+R.z.y*Rz_gradU_y+R.z.z*Rz_gradU_z;// Compute the off-diagonal elements of the Omega tensor in the eigenvector basisdoubleomega_xy=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);doubleomega_xz=(Lambda.z*M.x.z+Lambda.x*M.z.x)/(Lambda.z-Lambda.x);doubleomega_yz=(Lambda.z*M.y.z+Lambda.y*M.z.y)/(Lambda.z-Lambda.y);// Calculate intermediate rotation combinations for each direction// x-direction rotation combinationsdoublerot_x_xy_yz=(R.x.x*omega_xy-R.x.z*omega_yz);// xy rotation minus yz rotation, x componentsdoublerot_x_xy_xz=(R.x.y*omega_xy+R.x.z*omega_xz);// xy rotation plus xz rotation, x componentsdoublerot_x_xz_yz=(R.x.x*omega_xz+R.x.y*omega_yz);// xz rotation plus yz rotation, x components// y-direction rotation combinationsdoublerot_y_xy_yz=(R.y.x*omega_xy-R.y.z*omega_yz);// xy rotation minus yz rotation, y componentsdoublerot_y_xy_xz=(R.y.y*omega_xy+R.y.z*omega_xz);// xy rotation plus xz rotation, y componentsdoublerot_y_xz_yz=(R.y.x*omega_xz+R.y.y*omega_yz);// xz rotation plus yz rotation, y components// z-direction rotation combinationsdoublerot_z_xy_yz=(R.z.x*omega_xy-R.z.z*omega_yz);// xy rotation minus yz rotation, z componentsdoublerot_z_xy_xz=(R.z.y*omega_xy+R.z.z*omega_xz);// xy rotation plus xz rotation, z componentsdoublerot_z_xz_yz=(R.z.x*omega_xz+R.z.y*omega_yz);// xz rotation plus yz rotation, z components/* Calculate the components of the Omega tensor in the physical coordinate system** The Omega tensor represents the rotational part of the velocity gradient tensor* and is computed through the following steps:** 1.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: We already have:*...",
    "content": "We already have:*    - R: eigenvector matrix of the conformation tensor*    - rot_*_*_*: pre-computed rotation combinations for each direction** 2. Mathematical background:*    Omega = R * Omega_eigen * R^T*    where Omega_eigen is the rotation tensor in eigenvector space** 3.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: The components are...",
    "content": "The components are calculated using the rotation combinations:*    - rot_i_jk_lm represents combined rotations in the i-direction*    - Each component Omega_ij is a linear combination of these rotations*/// Compute x-row components of OmegaOmega.x.x=R.x.y*rot_x_xy_yz// xy-yz rotation contribution-R.x.x*rot_x_xy_xz// xy-xz rotation contribution+R.x.z*rot_x_xz_yz;// xz-yz rotation contributionOmega.x.y=R.y.y*rot_x_xy_yz// xy-yz rotation mapped to y-direction-R.y.x*rot_x_xy_xz// xy-xz rotation mapped to y-direction+R.y.z*rot_x_xz_yz;// xz-yz rotation mapped to y-directionOmega.x.z=R.z.y*rot_x_xy_yz// xy-yz rotation mapped to z-direction-R.z.x*rot_x_xy_xz// xy-xz rotation mapped to z-direction+R.z.z*rot_x_xz_yz;// xz-yz rotation mapped to z-direction// Compute y-row components using similar patternOmega.y.x=R.x.y*rot_y_xy_yz-R.x.x*rot_y_xy_xz+R.x.z*rot_y_xz_yz;Omega.y.y=R.y.y*rot_y_xy_yz-R.y.x*rot_y_xy_xz+R.y.z*rot_y_xz_yz;Omega.y.z=R.z.y*rot_y_xy_yz-R.z.x*rot_y_xy_xz+R.z.z*rot_y_xz_yz;// Compute z-row components using similar patternOmega.z.x=R.x.y*rot_z_xy_yz-R.x.x*rot_z_xy_xz+R.x.z*rot_z_xz_yz;Omega.z.y=R.y.y*rot_z_xy_yz-R.y.x*rot_z_xy_xz+R.y.z*rot_z_xz_yz;Omega.z.z=R.z.y*rot_z_xy_yz-R.z.x*rot_z_xy_xz+R.z.z*rot_z_xz_yz;/* Note: The resulting Omega tensor is skew-symmetric, meaning:* Omega_ij = -Omega_ji* This property is automatically satisfied by the construction above* and is essential for preserving the physical meaning of rotation*/// Extract diagonal components of M (velocity gradient tensor in eigenvector basis)doubleM_diag_x=M.x.x,M_diag_y=M.y.y,M_diag_z=M.z.z;/*Compute B tensor: B = R * diag(M) * R^T- This transforms the diagonal velocity gradient tensor back to the original coordinate system- B is symmetric, so we only need to compute the upper triangle*/// Compute diagonal elements of BB.x.x=M_diag_x*sq(R.x.x)+M_diag_y*sq(R.x.y)+M_diag_z*sq(R.x.z);B.y.y=M_diag_x*sq(R.y.x)+M_diag_y*sq(R.y.y)+M_diag_z*sq(R.y.z);B.z.z=M_diag_x*sq(R.z.x)+M_diag_y*sq(R.z.y)+M_diag_z*sq(R.z.z);// Compute off-diagonal elements of B (upper triangle)B.x.y=M_diag_x*R.x.x*R.y.x+M_diag_y*R.x.y*R.y.y+M_diag_z*R.x.z*R.y.z;B.x.z=M_diag_x*R.x.x*R.z.x+M_diag_y*R.x.y*R.z.y+M_diag_z*R.x.z*R.z.z;B.y.z=M_diag_x*R.y.x*R.z.x+M_diag_y*R.y.y*R.z.y+M_diag_z*R.y.z*R.z.z;// Fill in lower triangle using symmetry of BB.y.x=B.x.y;B.z.x=B.x.z;B.z.y=B.y.z;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // save old...",
    "content": "// save old values of Psi componentsdoubleold_Psi11=Psi11[];doubleold_Psi22=Psi22[];doubleold_Psi33=Psi33[];doubleold_Psi12=Psi12[];doubleold_Psi13=Psi13[];doubleold_Psi23=Psi23[];// Psi11Psi11[]+=dt*(2.0*B.x.x+Omega.x.y*old_Psi12-Omega.y.x*old_Psi12+Omega.x.z*old_Psi13-Omega.z.x*old_Psi13);// Psi22Psi22[]+=dt*(2.0*B.y.y-Omega.x.y*old_Psi12+Omega.y.x*old_Psi12+Omega.y.z*old_Psi23-Omega.z.y*old_Psi23);// Psi33Psi33[]+=dt*(2.0*B.z.z-Omega.x.z*old_Psi13+Omega.z.x*old_Psi13-Omega.y.z*old_Psi23+Omega.z.y*old_Psi23);// Psi12Psi12[]+=dt*(2.0*B.x.y+Omega.x.x*old_Psi12-Omega.x.y*old_Psi11+Omega.x.y*old_Psi22-Omega.y.y*old_Psi12+Omega.x.z*old_Psi23-Omega.z.y*old_Psi13);// Psi13Psi13[]+=dt*(2.0*B.x.z+Omega.x.x*old_Psi13-Omega.x.z*old_Psi11+Omega.x.y*old_Psi23-Omega.y.z*old_Psi12+Omega.x.z*old_Psi33-Omega.z.z*old_Psi13);// Psi23Psi23[]+=dt*(2.0*B.y.z+Omega.y.x*old_Psi13-Omega.x.z*old_Psi12+Omega.y.y*old_Psi23-Omega.y.z*old_Psi22+Omega.y.z*old_Psi33-Omega.z.z*old_Psi23);}// Advection of Psi, which is the log-conformation tensoradvection({Psi11,Psi12,Psi13,Psi22,Psi23,Psi33},uf,dt);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);// Reconstruct the log-conformation tensor from its componentsA.x.x=Psi11[];A.x.y=Psi12[];A.x.z=Psi13[];A.y.x=Psi12[];A.y.y=Psi22[];A.y.z=Psi23[];A.z.x=Psi13[];A.z.y=Psi23[];A.z.z=Psi33[];// Diagonalize A to obtain eigenvalues and eigenvectorsdiagonalization_3D(&Lambda,&R,&A);// Exponentiate eigenvaluesLambda.x=exp(Lambda.x);Lambda.y=exp(Lambda.y);Lambda.z=exp(Lambda.z);// Reconstruct A using A = R * diag(Lambda) * R^TA.x.x=Lambda.x*sq(R.x.x)+Lambda.y*sq(R.x.y)+Lambda.z*sq(R.x.z);A.x.y=Lambda.x*R.x.x*R.y.x+Lambda.y*R.x.y*R.y.y+Lambda.z*R.x.z*R.y.z;A.y.x=A.x.y;A.x.z=Lambda.x*R.x.x*R.z.x+Lambda.y*R.x.y*R.z.y+Lambda.z*R.x.z*R.z.z;A.z.x=A.x.z;A.y.y=Lambda.x*sq(R.y.x)+Lambda.y*sq(R.y.y)+Lambda.z*sq(R.y.z);A.y.z=Lambda.x*R.y.x*R.z.x+Lambda.y*R.y.y*R.z.y+Lambda.z*R.y.z*R.z.z;A.z.y=A.y.z;A.z.z=Lambda.x*sq(R.z.x)+Lambda.y*sq(R.z.y)+Lambda.z*sq(R.z.z);// Apply relaxation using the relaxation time lambdadoubletauD=sqrt((1./6.)*((T11[]-T22[])*(T11[]-T22[])+(T22[]-T33[])*(T22[]-T33[])+(T33[]-T11[])*(T33[]-T11[]))+3.*(T12[]*T12[]+T23[]*T23[]+T13[]*T13[]));doubleyieldFactor=max(0.,(tauD-tau0[])/(tauD+1e-6));// $\\mathcal{F}$doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt*yieldFactor/lambda[])):0.);A.x.y*=intFactor;A.y.x=A.x.y;A.x.z*=intFactor;A.z.x=A.x.z;A.y.z*=intFactor;A.z.y=A.y.z;foreach_dimension()A.x.x=1.+(A.x.x-1.)*intFactor;/*Get Aij from A.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: These commands might...",
    "content": "These commands might look repetitive. But, I do this so that in the future, generalization to tensor only form is easier.*/// diagonal terms:A11[]=A.x.x;A22[]=A.y.y;A33[]=A.z.z;// off-diagonal terms:A12[]=A.x.y;A13[]=A.x.z;A23[]=A.y.z;// Compute the stress tensor T using the polymer modulus GpT11[]=Gp[]*(A.x.x-1.);T22[]=Gp[]*(A.y.y-1.);T33[]=Gp[]*(A.z.z-1.);T12[]=Gp[]*A.x.y;T13[]=Gp[]*A.x.z;T23[]=Gp[]*A.y.z;}}#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-elastoviscoplastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;#if dimension ==// 2D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12 (shear stress)doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;// x-gradient of T11 (normal stress)doublegradX_T11=cm[]*T11[]-cm[-1]*T11[-1];av.x[]+=(shearX+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12 (shear stress)doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;// y-gradient of T22 (normal stress)doublegradY_T22=cm[]*T22[]-cm[0,-1]*T22[0,-1];av.y[]+=(shearY+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}#elif dimension ==// 3D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12doubleshearY=(T12[0,1,0]*cm[0,1,0]+T12[-1,1,0]*cm[-1,1,0]-T12[0,-1,0]*cm[0,-1,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T13doubleshearZ=(T13[0,0,1]*cm[0,0,1]+T13[-1,0,1]*cm[-1,0,1]-T13[0,0,-1]*cm[0,0,-1]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// x-gradient of T11doublegradX_T11=cm[]*T11[]-cm[-1,0,0]*T11[-1,0,0];av.x[]+=(shearY+shearZ+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12doubleshearX=(T12[1,0,0]*cm[1,0,0]+T12[1,-1,0]*cm[1,-1,0]-T12[-1,0,0]*cm[-1,0,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T23doubleshearZ=(T23[0,0,1]*cm[0,0,1]+T23[0,-1,1]*cm[0,-1,1]-T23[0,0,-1]*cm[0,0,-1]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// y-gradient of T22doublegradY_T22=cm[]*T22[]-cm[0,-1,0]*T22[0,-1,0];av.y[]+=(shearX+shearZ+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}foreach_face(z){if(fm.z[]>1e-20){// x-gradient of T13doubleshearX=(T13[1,0,0]*cm[1,0,0]+T13[1,0,-1]*cm[1,0,-1]-T13[-1,0,0]*cm[-1,0,0]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// y-gradient of T23doubleshearY=(T23[0,1,0]*cm[0,1,0]+T23[0,1,-1]*cm[0,1,-1]-T23[0,-1,0]*cm[0,-1,0]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// z-gradient of T33doublegradZ_T33=cm[]*T33[]-cm[0,0,-1]*T33[0,0,-1];av.z[]+=(shearX+shearY+gradZ_T33)*alpha.z[]/(sq(fm.z[])*Delta);}}#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-elastoviscoplastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-viscoelastic-scalar-3D.h See raw file Log-Conformation Method for 3D Viscoelastic Fluids Overview Title : log-conform-viscoelastic-3D.h Version : 2.6 Description : Implementation of the log-conformation method for viscoelastic fluids in 3D Key Features Conformation tensor A exists across the domain and relaxes according to \u03bb Stress acts according to elastic modulus G 3D implementation extending log-conform-viscoelastic-scalar-2D.h Eigenvalue clamping for numerical stability Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Mar 16, 2025 Dependencies bcg.h: Bell-Collela-Glaz scheme for advection eigen_decomposition.h: For 3D eigenvalue computation navier-stokes/centered.h: For base flow solver References Fattal & Kupferman (2004, 2005): Original log-conformation method Comminal et al. (2015): Constitutive model functions Hao & Pan (2007): Split scheme implementation Version History v1.0 (Oct 19, 2024) Initial 3D implementation Scalar implementation approach v1.1 (Oct 20, 2024) Added negative eigenvalue detection Added error reporting system v2.0 (Oct 29, 2024) Major matrix algebra corrections for 3D Optimized tensor calculations Improved code structure and documentation v2.1 (Oct 29, 2024) Added initialization functions for tensor structures v2.2 (Nov 3, 2024) Refactored tensor operations Improved code maintainability Enhanced tensor manipulation consistency v2.3 (Nov 14, 2024) Added infinite Deborah number support v2.5 (Nov 23, 2024) Documentation improvements Added mathematical explanations v2.6 (Mar 16, 2025) Implemented eigenvalue clamping system Added minimum eigenvalue threshold (EIGENVALUE_MIN = 1e-8) Improved numerical stability handling Added diagnostic capabilities Fixed 3D velocity gradient calculation Implementation Notes The code extends the standard Basilisk log-conformation implementation Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling with polymeric stress Includes both 2D and 3D implementations Uses atomic operations for thread-safe diagnostics Future Work Axisymmetric Compatibility Currently not implemented Use log-conform-viscoelastic-scalar-2D.h for axi cases Or use log-conform-viscoelastic.h for better efficiency Metric Terms Improvements Enforce tensor compatibility using foreach_dimension Complete metric terms (cm, fm) implementation #if AXI #error \"axi compatibility is not there.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Introduction",
    "content": "To keep the code easy to read, we will not implement axi compatibility just yet.\" #endif The log-conformation method for some viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function. The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the case...",
    "content": "In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models. Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This instability poses...",
    "content": "This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) . /* TODO : - Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h) */ #define EIGENVALUE_MIN 1e-8 220 #ifdef DEBUG_EIGENVALUES static int eigenvalue_corrections = 0 ; #endif #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time /* conformation tensor */ // diagonal elements scalar A11 [], A22 [], A33 []; // off-diagonal elements scalar A12 [], A13 [], A23 []; /* stress tensor */ // diagonal elements scalar T11 [], T22 [], T33 []; // off-diagonal elements scalar T12 [], T13 [], T23 []; event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 , A33 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T13 , T22 , T23 , T33 , A12 , A13 , A23 }) { foreach (){ s [] = 0. ; } } for ( scalar s in { A11 , A22 , A33 , T11 , T22 , T33 , A12 , A13 , A23 , T12 , T13 , T23 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } if ( s . boundary [ top ] != periodic_bc ) { s [ top ] = neumann ( 0 ); s [ bottom ] = neumann ( 0 ); } #if dimension == if ( s . boundary [ front ] != periodic_bc ) { s [ front ] = neumann ( 0 ); s [ back ] = neumann ( 0 ); } #endif } } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. #if dimension == typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } #endif /* Now this is the 3D implementation. */ #if dimension == #include \"eigen_decomposition.h\" typedef struct { double x , y , z ; } pseudo_v3d ; typedef struct { pseudo_v3d x , y , z ; } pseudo_t3d ; // Function to initialize pseudo_v3d static inline void init_pseudo_v3d ( pseudo_v3d * v , double value ) { v -> x = value ; v -> y = value ; v -> z = value ; } // Function to initialize pseudo_t3d static inline void init_pseudo_t3d ( pseudo_t3d * t , double value ) { init_pseudo_v3d (& t -> x , value ); init_pseudo_v3d (& t -> y , value ); init_pseudo_v3d (& t -> z , value ); } static void diagonalization_3D ( pseudo_v3d * Lambda , pseudo_t3d * R , pseudo_t3d * A ) { // Check if the matrix is already diagonal if ( sq ( A -> x . y ) + sq ( A -> x . z ) + sq ( A -> y . z ) < 1e-15 ) { R -> x . x = R -> y . y = R -> z . z = 1. ; R -> y . x = R -> x . y = R -> z . x = R -> x . z = R -> z . y = R -> y . z = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; Lambda -> z = A -> z . z ; return ; } // Compute eigenvalues using the eigen_decomposition function double matrix [ 3 ][ 3 ] = { { A -> x . x , A -> x . y , A -> x . z }, { A -> y . x , A -> y . y , A -> y . z }, { A -> z . x , A -> z . y , A -> z . z } }; double eigenvectors [ 3 ][ 3 ]; double eigenvalues [ 3 ]; compute_eigensystem_symmetric_3x3 ( matrix , eigenvectors , eigenvalues ); // Store eigenvalues and eigenvectors Lambda -> x = eigenvalues [ 0 ]; Lambda -> y = eigenvalues [ 1 ]; Lambda -> z = eigenvalues [ 2 ]; R -> x . x = eigenvectors [ 0 ][ 0 ]; R -> x . y = eigenvectors [ 0 ][ 1 ]; R -> x . z = eigenvectors [ 0 ][ 2 ]; R -> y . x = eigenvectors [ 1 ][ 0 ]; R -> y . y = eigenvectors [ 1 ][ 1 ]; R -> y . z = eigenvectors [ 1 ][ 2 ]; R -> z . x = eigenvectors [ 2 ][ 0 ]; R -> z . y = eigenvectors [ 2 ][ 1 ]; R -> z . z = eigenvectors [ 2 ][ 2 ]; } #endif The stress tensor depends on previous instants and has to be integrated in time.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the log-conformation...",
    "content": "In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) . We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ). In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] #if dimension == Advances the log-conformation tensor and updates the corresponding conformation and stress tensors.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "This event function performs three primary steps within the viscoelastic fluid simulation: - Diagonalizes the conformation tensor and computes its logarithm (\u03a8) while applying eigenvalue clamping to ensure numerical stability. - Advances \u03a8 in time by incorporating the upper convective term computed from the velocity gradient, which is used to update the log-conformation tensor. - Recovers the physical conformation tensor and stress tensor by exponentiating the diagonalized eigenvalues and integrating the relaxation term.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Note: Although the...",
    "content": "Note: Although the overall simulation targets 3D viscoelastic fluids, this implementation uses a 2D diagonalization routine. event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A = {{ A11 [], A12 []}, { A12 [], A22 []}}; The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at ( %g , %g ): [ %g , %g ] \\n \" , x , y , Lambda . x , Lambda . y ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } #elif dimension == Advances the log-conformation tensor and computes the corresponding conformation and stress tensors for 3D viscoelastic fluid simulations. This event function performs a two-step update for the viscoelastic fluid model using the log-conformation method.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In the first...",
    "content": "In the first part, it computes the logarithm of the conformation tensor \\(\\Psi\\) from A by: - Diagonalizing A to obtain eigenvalues ( \\(\\Lambda\\) ) and eigenvectors (R). - Clamping any negative eigenvalues to prevent numerical instabilities (using EIGENVALUE_MIN). - Evaluating \\(\\Psi = \\log(A)\\) and incorporating the upper convective contribution via the symmetric tensor B and the skew-symmetric tensor \\(\\Omega\\) . \\(\\Psi\\) is then advanced in time using central difference approximations for the velocity gradients, where degenerate eigenvalue cases are handled with simplified calculations. In the second part, the function converts the updated log-conformation tensor back to the conformation tensor A by exponentiating the eigenvalues and applies the relaxation factor derived from the relaxation time. Finally, it computes the polymeric stress tensor T from A.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Warnings are printed...",
    "content": "Warnings are printed if negative eigenvalues are detected, and a debug counter is incremented when debugging is enabled. event tracer_advection ( i ++) { Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term // start by declaring the scalar variables that will store the components of $\\Psi$ scalar Psi11 = A11 , Psi12 = A12 , Psi13 = A13 , Psi22 = A22 , Psi23 = A23 , Psi33 = A33 ; foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); A . x . x = A11 []; A . x . y = A12 []; A . x . z = A13 []; A . y . x = A12 []; A . y . y = A22 []; A . y . z = A23 []; A . z . x = A13 []; A . z . y = A23 []; A . z . z = A33 []; // Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors R diagonalization_3D (& Lambda , & R , & A ); /* Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This prevents numerical...",
    "content": "This prevents numerical instabilities while maintaining physical meaning. */ if ( Lambda . x <= 0. || Lambda . y <= 0. || Lambda . z <= 0. ) { fprintf ( ferr , \"WARNING: Negative eigenvalue detected at ( %g , %g , %g ): [ %g , %g , %g ] \\n \" , x , y , z , Lambda . x , Lambda . y , Lambda . z ); #ifdef DEBUG_EIGENVALUES atomic_increment (& eigenvalue_corrections ); #endif Lambda . x = max ( Lambda . x , EIGENVALUE_MIN ); Lambda . y = max ( Lambda . y , EIGENVALUE_MIN ); Lambda . z = max ( Lambda . z , EIGENVALUE_MIN ); } // Compute Psi = log(A) = R * log(Lambda) * R^T Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ) + sq ( R . x . z )* log ( Lambda . z ); Psi22 [] = sq ( R . y . x )* log ( Lambda . x ) + sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . z )* log ( Lambda . z ); Psi33 [] = sq ( R . z . x )* log ( Lambda . x ) + sq ( R . z . y )* log ( Lambda . y ) + sq ( R . z . z )* log ( Lambda . z ); Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . x . y * R . y . y * log ( Lambda . y ) + R . x . z * R . y . z * log ( Lambda . z ); Psi13 [] = R . x . x * R . z . x * log ( Lambda . x ) + R . x . y * R . z . y * log ( Lambda . y ) + R . x . z * R . z . z * log ( Lambda . z ); Psi23 [] = R . y . x * R . z . x * log ( Lambda . x ) + R . y . y * R . z . y * log ( Lambda . y ) + R . y . z * R . z . z * log ( Lambda . z ); // Compute B and Omega tensors (3D version) pseudo_t3d B , M , Omega ; init_pseudo_t3d (& B , 0.0 ); init_pseudo_t3d (& M , 0.0 ); init_pseudo_t3d (& Omega , 0.0 ); // Check if any pair of eigenvalues are numerically equal (within a small tolerance) if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 || fabs ( Lambda . y - Lambda . z ) <= 1e-20 || fabs ( Lambda . z - Lambda . x ) <= 1e-20 ) { // In case of equal eigenvalues, the calculations for B and Omega simplify significantly // B is grad U and Omega is zero. // Compute off-diagonal elements of B using central differences // These represent the symmetric part of the velocity gradient tensor B . x . y = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ] + u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 4. * Delta ); // (dv/dx + du/dy)/2 B . x . z = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ] + u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dx + du/dz)/2 B . y . z = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ] + u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 4. * Delta ); // (dw/dy + dv/dz)/2 // Compute diagonal elements of B // These represent the normal strain rates B . x . x = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2. * Delta ); // du/dx B . y . y = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2. * Delta ); // dv/dy B . z . z = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2. * Delta ); // dw/dz // Set all components of Omega to zero // This is because Omega represents the antisymmetric part of the velocity gradient tensor, // which vanishes when eigenvalues are equal Omega . x . y = Omega . x . z = Omega . y . z = Omega . y . x = Omega . z . x = Omega . z . y = 0. ; } else { /* ### Compute the velocity gradient tensor components using central differences - These represent the spatial derivatives of each velocity component - These gradients form the velocity gradient tensor (nablaU): [ dudx dudy dudz ] [ dvdx dvdy dvdz ] [ dwdx dwdy dwdz ] */ // Derivatives of u (x-component of velocity) double dudx = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ])/( 2.0 * Delta ); // du/dx double dudy = ( u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // du/dy double dudz = ( u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // du/dz // Derivatives of v (y-component of velocity) double dvdx = ( u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dv/dx double dvdy = ( u . y [ 0 , 1 , 0 ] - u . y [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dv/dy double dvdz = ( u . y [ 0 , 0 , 1 ] - u . y [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dv/dz // Derivatives of w (z-component of velocity) double dwdx = ( u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ])/( 2.0 * Delta ); // dw/dx double dwdy = ( u . z [ 0 , 1 , 0 ] - u . z [ 0 ,- 1 , 0 ])/( 2.0 * Delta ); // dw/dy double dwdz = ( u . z [ 0 , 0 , 1 ] - u . z [ 0 , 0 ,- 1 ])/( 2.0 * Delta ); // dw/dz /* Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor. * Steps: 1. Compute intermediate products (R * nablaU^T): - Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_* - Each variable represents one row of the intermediate matrix 2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor: - M.i.j represents the (i,j) component of the transformed velocity gradient - This transformation expresses the velocity gradient in the eigenvector basis - The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that */ // First, compute intermediate products of R and (nablaU)^T double Rx_gradU_x = R . x . x * dudx + R . x . y * dvdx + R . x . z * dwdx ; double Rx_gradU_y = R . x . x * dudy + R . x . y * dvdy + R . x . z * dwdy ; double Rx_gradU_z = R . x . x * dudz + R . x . y * dvdz + R . x . z * dwdz ; double Ry_gradU_x = R . y . x * dudx + R . y . y * dvdx + R . y . z * dwdx ; double Ry_gradU_y = R . y . x * dudy + R . y . y * dvdy + R . y . z * dwdy ; double Ry_gradU_z = R . y . x * dudz + R . y . y * dvdz + R . y . z * dwdz ; double Rz_gradU_x = R . z . x * dudx + R . z . y * dvdx + R . z . z * dwdx ; double Rz_gradU_y = R . z . x * dudy + R . z . y * dvdy + R . z . z * dwdy ; double Rz_gradU_z = R . z . x * dudz + R . z . y * dvdz + R . z . z * dwdz ; // Now compute M components by multiplying the intermediate products with R^T M . x . x = R . x . x * Rx_gradU_x + R . x . y * Rx_gradU_y + R . x . z * Rx_gradU_z ; M . x . y = R . x . x * Ry_gradU_x + R . x . y * Ry_gradU_y + R . x . z * Ry_gradU_z ; M . x . z = R . x . x * Rz_gradU_x + R . x . y * Rz_gradU_y + R . x . z * Rz_gradU_z ; M . y . x = R . y . x * Rx_gradU_x + R . y . y * Rx_gradU_y + R . y . z * Rx_gradU_z ; M . y . y = R . y . x * Ry_gradU_x + R . y . y * Ry_gradU_y + R . y . z * Ry_gradU_z ; M . y . z = R . y . x * Rz_gradU_x + R . y . y * Rz_gradU_y + R . y . z * Rz_gradU_z ; M . z . x = R . z . x * Rx_gradU_x + R . z . y * Rx_gradU_y + R . z . z * Rx_gradU_z ; M . z . y = R . z . x * Ry_gradU_x + R . z . y * Ry_gradU_y + R . z . z * Ry_gradU_z ; M . z . z = R . z . x * Rz_gradU_x + R . z . y * Rz_gradU_y + R . z . z * Rz_gradU_z ; // Compute the off-diagonal elements of the Omega tensor in the eigenvector basis double omega_xy = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); double omega_xz = ( Lambda . z * M . x . z + Lambda . x * M . z . x )/( Lambda . z - Lambda . x ); double omega_yz = ( Lambda . z * M . y . z + Lambda . y * M . z . y )/( Lambda . z - Lambda . y ); // Calculate intermediate rotation combinations for each direction // x-direction rotation combinations double rot_x_xy_yz = ( R . x . x * omega_xy - R . x . z * omega_yz ); // xy rotation minus yz rotation, x components double rot_x_xy_xz = ( R . x . y * omega_xy + R . x . z * omega_xz ); // xy rotation plus xz rotation, x components double rot_x_xz_yz = ( R . x . x * omega_xz + R . x . y * omega_yz ); // xz rotation plus yz rotation, x components // y-direction rotation combinations double rot_y_xy_yz = ( R . y . x * omega_xy - R . y . z * omega_yz ); // xy rotation minus yz rotation, y components double rot_y_xy_xz = ( R . y . y * omega_xy + R . y . z * omega_xz ); // xy rotation plus xz rotation, y components double rot_y_xz_yz = ( R . y . x * omega_xz + R . y . y * omega_yz ); // xz rotation plus yz rotation, y components // z-direction rotation combinations double rot_z_xy_yz = ( R . z . x * omega_xy - R . z . z * omega_yz ); // xy rotation minus yz rotation, z components double rot_z_xy_xz = ( R . z . y * omega_xy + R . z . z * omega_xz ); // xy rotation plus xz rotation, z components double rot_z_xz_yz = ( R . z . x * omega_xz + R . z . y * omega_yz ); // xz rotation plus yz rotation, z components Calculate the components of the Omega tensor in the physical coordinate system The Omega tensor represents the rotational part of the velocity gradient tensor and is computed through the following steps: We already have: R: eigenvector matrix of the conformation tensor rot_*_*_*: pre-computed rotation combinations for each direction Mathematical background: Omega = R * Omega_eigen * R^T where Omega_eigen is the rotation tensor in eigenvector space The components are calculated using the rotation combinations: rot_i_jk_lm represents combined rotations in the i-direction Each component Omega_ij is a linear combination of these rotations // Compute x-row components of Omega Omega . x . x = R . x . y * rot_x_xy_yz // xy-yz rotation contribution - R . x . x * rot_x_xy_xz // xy-xz rotation contribution + R . x . z * rot_x_xz_yz ; // xz-yz rotation contribution Omega . x . y = R . y . y * rot_x_xy_yz // xy-yz rotation mapped to y-direction - R . y . x * rot_x_xy_xz // xy-xz rotation mapped to y-direction + R . y . z * rot_x_xz_yz ; // xz-yz rotation mapped to y-direction Omega . x . z = R . z . y * rot_x_xy_yz // xy-yz rotation mapped to z-direction - R . z . x * rot_x_xy_xz // xy-xz rotation mapped to z-direction + R . z . z * rot_x_xz_yz ; // xz-yz rotation mapped to z-direction // Compute y-row components using similar pattern Omega . y . x = R . x . y * rot_y_xy_yz - R . x . x * rot_y_xy_xz + R . x . z * rot_y_xz_yz ; Omega . y . y = R . y . y * rot_y_xy_yz - R . y . x * rot_y_xy_xz + R . y . z * rot_y_xz_yz ; Omega . y . z = R . z . y * rot_y_xy_yz - R . z . x * rot_y_xy_xz + R . z . z * rot_y_xz_yz ; // Compute z-row components using similar pattern Omega . z . x = R . x . y * rot_z_xy_yz - R . x . x * rot_z_xy_xz + R . x . z * rot_z_xz_yz ; Omega . z . y = R . y . y * rot_z_xy_yz - R . y . x * rot_z_xy_xz + R . y . z * rot_z_xz_yz ; Omega . z . z = R . z . y * rot_z_xy_yz - R . z . x * rot_z_xy_xz + R . z . z * rot_z_xz_yz ; Note: The resulting Omega tensor is skew-symmetric, meaning: - Omega_ij = -Omega_ji This property is automatically satisfied by the construction above and is essential for preserving the physical meaning of rotation // Extract diagonal components of M (velocity gradient tensor in eigenvector basis) double M_diag_x = M . x . x , M_diag_y = M . y . y , M_diag_z = M . z . z ; Compute B tensor: B = R * diag(M) * R^T - This transforms the diagonal velocity gradient tensor back to the original coordinate system - B is symmetric, so we only need to compute the upper triangle // Compute diagonal elements of B B . x . x = M_diag_x * sq ( R . x . x ) + M_diag_y * sq ( R . x . y ) + M_diag_z * sq ( R . x . z ); B . y . y = M_diag_x * sq ( R . y . x ) + M_diag_y * sq ( R . y . y ) + M_diag_z * sq ( R . y . z ); B . z . z = M_diag_x * sq ( R . z . x ) + M_diag_y * sq ( R . z . y ) + M_diag_z * sq ( R . z . z ); // Compute off-diagonal elements of B (upper triangle) B . x . y = M_diag_x * R . x . x * R . y . x + M_diag_y * R . x . y * R . y . y + M_diag_z * R . x . z * R . y . z ; B . x . z = M_diag_x * R . x . x * R . z . x + M_diag_y * R . x . y * R . z . y + M_diag_z * R . x . z * R . z . z ; B . y . z = M_diag_x * R . y . x * R . z . x + M_diag_y * R . y . y * R . z . y + M_diag_z * R . y . z * R . z . z ; // Fill in lower triangle using symmetry of B B . y . x = B . x . y ; B . z . x = B . x . z ; B . z . y = B . y . z ; } We now advance \\(\\Psi\\) in time, adding the upper convective contribution.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step 1:...",
    "content": "This step 1: _t = 2 + (-) // save old values of Psi components double old_Psi11 = Psi11 []; double old_Psi22 = Psi22 []; double old_Psi33 = Psi33 []; double old_Psi12 = Psi12 []; double old_Psi13 = Psi13 []; double old_Psi23 = Psi23 []; // Psi11 Psi11 [] += dt * ( 2.0 * B . x . x + Omega . x . y * old_Psi12 - Omega . y . x * old_Psi12 + Omega . x . z * old_Psi13 - Omega . z . x * old_Psi13 ); // Psi22 Psi22 [] += dt * ( 2.0 * B . y . y - Omega . x . y * old_Psi12 + Omega . y . x * old_Psi12 + Omega . y . z * old_Psi23 - Omega . z . y * old_Psi23 ); // Psi33 Psi33 [] += dt * ( 2.0 * B . z . z - Omega . x . z * old_Psi13 + Omega . z . x * old_Psi13 - Omega . y . z * old_Psi23 + Omega . z . y * old_Psi23 ); // Psi12 Psi12 [] += dt * ( 2.0 * B . x . y + Omega . x . x * old_Psi12 - Omega . x . y * old_Psi11 + Omega . x . y * old_Psi22 - Omega . y . y * old_Psi12 + Omega . x . z * old_Psi23 - Omega . z . y * old_Psi13 ); // Psi13 Psi13 [] += dt * ( 2.0 * B . x . z + Omega . x . x * old_Psi13 - Omega . x . z * old_Psi11 + Omega . x . y * old_Psi23 - Omega . y . z * old_Psi12 + Omega . x . z * old_Psi33 - Omega . z . z * old_Psi13 ); // Psi23 Psi23 [] += dt * ( 2.0 * B . y . z + Omega . y . x * old_Psi13 - Omega . x . z * old_Psi12 + Omega . y . y * old_Psi23 - Omega . y . z * old_Psi22 + Omega . y . z * old_Psi33 - Omega . z . z * old_Psi23 ); } // Advection of Psi, which is the log-conformation tensor advection ({ Psi11 , Psi12 , Psi13 , Psi22 , Psi23 , Psi33 }, uf , dt ); Convert back to A and T We now convert the log-conformation tensor Psi back to the conformation tensor A and compute the stress tensor T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This process involves...",
    "content": "This process involves diagonalization, exponentiation of eigenvalues, and application of the relaxation factor. foreach () { pseudo_t3d A , R ; init_pseudo_t3d (& R , 0.0 ); pseudo_v3d Lambda ; init_pseudo_v3d (& Lambda , 0.0 ); // Reconstruct the log-conformation tensor from its components A . x . x = Psi11 []; A . x . y = Psi12 []; A . x . z = Psi13 []; A . y . x = Psi12 []; A . y . y = Psi22 []; A . y . z = Psi23 []; A . z . x = Psi13 []; A . z . y = Psi23 []; A . z . z = Psi33 []; // Diagonalize A to obtain eigenvalues and eigenvectors diagonalization_3D (& Lambda , & R , & A ); // Exponentiate eigenvalues Lambda . x = exp ( Lambda . x ); Lambda . y = exp ( Lambda . y ); Lambda . z = exp ( Lambda . z ); // Reconstruct A using A = R * diag(Lambda) * R^T A . x . x = Lambda . x * sq ( R . x . x ) + Lambda . y * sq ( R . x . y ) + Lambda . z * sq ( R . x . z ); A . x . y = Lambda . x * R . x . x * R . y . x + Lambda . y * R . x . y * R . y . y + Lambda . z * R . x . z * R . y . z ; A . y . x = A . x . y ; A . x . z = Lambda . x * R . x . x * R . z . x + Lambda . y * R . x . y * R . z . y + Lambda . z * R . x . z * R . z . z ; A . z . x = A . x . z ; A . y . y = Lambda . x * sq ( R . y . x ) + Lambda . y * sq ( R . y . y ) + Lambda . z * sq ( R . y . z ); A . y . z = Lambda . x * R . y . x * R . z . x + Lambda . y * R . y . y * R . z . y + Lambda . z * R . y . z * R . z . z ; A . z . y = A . y . z ; A . z . z = Lambda . x * sq ( R . z . x ) + Lambda . y * sq ( R . z . y ) + Lambda . z * sq ( R . z . z ); // Apply relaxation using the relaxation time lambda double intFactor = lambda [] != 0. ? exp (- dt / lambda []) : 0. ; A . x . y *= intFactor ; A . y . x = A . x . y ; A . x . z *= intFactor ; A . z . x = A . x . z ; A . y . z *= intFactor ; A . z . y = A . y . z ; foreach_dimension () A . x . x = 1. + ( A . x . x - 1. )* intFactor ; Get Aij from A.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: These commands might...",
    "content": "These commands might look repetitive. But, I do this so that in the future, generalization to tensor only form is easier. // diagonal terms: A11 [] = A . x . x ; A22 [] = A . y . y ; A33 [] = A . z . z ; // off-diagonal terms: A12 [] = A . x . y ; A13 [] = A . x . z ; A23 [] = A . y . z ; // Compute the stress tensor T using the polymer modulus Gp T11 [] = Gp []*( A . x . x - 1. ); T22 [] = Gp []*( A . y . y - 1. ); T33 [] = Gp []*( A . z . z - 1. ); T12 [] = Gp []* A . x . y ; T13 [] = Gp []* A . x . z ; T23 [] = Gp []* A . y . z ; } } #endif Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{T}\\) is defined at cell centers, while the corresponding force (acceleration) is defined at cell faces. For each component of the momentum equation, we need to compute the divergence of the corresponding row of the stress tensor.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "For example, for the x-component in 3D: \\[ (\\nabla \\cdot \\mathbf{T})_x = \\partial_x T_{xx} + \\partial_y T_{xy} + \\partial_z T_{xz} \\] The normal stress gradient (e.g. \\(\\partial_x T_{xx}\\) ) is computed directly from cell-centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The shear stress...",
    "content": "The shear stress gradients (e.g. \\(\\partial_y T_{xy}\\) ) are computed using vertex-averaged values to avoid checkerboard instabilities. event acceleration ( i ++) { face vector av = a ; #if dimension == // 2D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 (shear stress) double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // x-gradient of T11 (normal stress) double gradX_T11 = cm []* T11 [] - cm [- 1 ]* T11 [- 1 ]; av . x [] += ( shearX + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 (shear stress) double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; // y-gradient of T22 (normal stress) double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ]; av . y [] += ( shearY + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } #elif dimension == // 3D implementation foreach_face ( x ) { if ( fm . x [] > 1e-20 ) { // y-gradient of T12 double shearY = ( T12 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T12 [- 1 , 1 , 0 ]* cm [- 1 , 1 , 0 ] - T12 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T13 double shearZ = ( T13 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T13 [- 1 , 0 , 1 ]* cm [- 1 , 0 , 1 ] - T13 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // x-gradient of T11 double gradX_T11 = cm []* T11 [] - cm [- 1 , 0 , 0 ]* T11 [- 1 , 0 , 0 ]; av . x [] += ( shearY + shearZ + gradX_T11 )* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ) { if ( fm . y [] > 1e-20 ) { // x-gradient of T12 double shearX = ( T12 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T12 [ 1 ,- 1 , 0 ]* cm [ 1 ,- 1 , 0 ] - T12 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T12 [- 1 ,- 1 , 0 ]* cm [- 1 ,- 1 , 0 ])/ 4. ; // z-gradient of T23 double shearZ = ( T23 [ 0 , 0 , 1 ]* cm [ 0 , 0 , 1 ] + T23 [ 0 ,- 1 , 1 ]* cm [ 0 ,- 1 , 1 ] - T23 [ 0 , 0 ,- 1 ]* cm [ 0 , 0 ,- 1 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // y-gradient of T22 double gradY_T22 = cm []* T22 [] - cm [ 0 ,- 1 , 0 ]* T22 [ 0 ,- 1 , 0 ]; av . y [] += ( shearX + shearZ + gradY_T22 )* alpha . y []/( sq ( fm . y [])* Delta ); } } foreach_face ( z ) { if ( fm . z [] > 1e-20 ) { // x-gradient of T13 double shearX = ( T13 [ 1 , 0 , 0 ]* cm [ 1 , 0 , 0 ] + T13 [ 1 , 0 ,- 1 ]* cm [ 1 , 0 ,- 1 ] - T13 [- 1 , 0 , 0 ]* cm [- 1 , 0 , 0 ] - T13 [- 1 , 0 ,- 1 ]* cm [- 1 , 0 ,- 1 ])/ 4. ; // y-gradient of T23 double shearY = ( T23 [ 0 , 1 , 0 ]* cm [ 0 , 1 , 0 ] + T23 [ 0 , 1 ,- 1 ]* cm [ 0 , 1 ,- 1 ] - T23 [ 0 ,- 1 , 0 ]* cm [ 0 ,- 1 , 0 ] - T23 [ 0 ,- 1 ,- 1 ]* cm [ 0 ,- 1 ,- 1 ])/ 4. ; // z-gradient of T33 double gradZ_T33 = cm []* T33 [] - cm [ 0 , 0 ,- 1 ]* T33 [ 0 , 0 ,- 1 ]; av . z [] += ( shearX + shearY + gradZ_T33 )* alpha . z []/( sq ( fm . z [])* Delta ); } } #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXI#error \"axi compatibility is not there. To keep the code easy to read, we will not implement axi compatibility just yet.\"#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: /*TODO:- Perhaps, instead...",
    "content": "/*TODO:- Perhaps, instead of the Bell--Collela--Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to [http://basilisk.fr/src/navier-stokes/conserving.h](http://basilisk.fr/src/navier-stokes/conserving.h)*/#define EIGENVALUE_MIN1e-8220#ifdef DEBUG_EIGENVALUESstaticinteigenvalue_corrections=0;#endif#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation time/*conformation tensor */// diagonal elementsscalar A11[],A22[],A33[];// off-diagonal elementsscalar A12[],A13[],A23[];/*stress tensor */// diagonal elementsscalar T11[],T22[],T33[];// off-diagonal elementsscalar T12[],T13[],T23[];event defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22,A33}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T13,T22,T23,T33,A12,A13,A23}){foreach(){s[]=0.;}}for(scalar s in{A11,A22,A33,T11,T22,T33,A12,A13,A23,T12,T13,T23}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}if(s.boundary[top]!=periodic_bc){s[top]=neumann(0);s[bottom]=neumann(0);}#if dimension ==if(s.boundary[front]!=periodic_bc){s[front]=neumann(0);s[back]=neumann(0);}#endif}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if dimension ==typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}#endif/*Now this is the 3D implementation.*/#if dimension ==#include\"eigen_decomposition.h\"typedefstruct{doublex,y,z;}pseudo_v3d;typedefstruct{pseudo_v3d x,y,z;}pseudo_t3d;// Function to initialize pseudo_v3dstaticinlinevoidinit_pseudo_v3d(pseudo_v3d*v,doublevalue){v->x=value;v->y=value;v->z=value;}// Function to initialize pseudo_t3dstaticinlinevoidinit_pseudo_t3d(pseudo_t3d*t,doublevalue){init_pseudo_v3d(&t->x,value);init_pseudo_v3d(&t->y,value);init_pseudo_v3d(&t->z,value);}staticvoiddiagonalization_3D(pseudo_v3d*Lambda,pseudo_t3d*R,pseudo_t3d*A){// Check if the matrix is already diagonalif(sq(A->x.y)+sq(A->x.z)+sq(A->y.z)<1e-15){R->x.x=R->y.y=R->z.z=1.;R->y.x=R->x.y=R->z.x=R->x.z=R->z.y=R->y.z=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;Lambda->z=A->z.z;return;}// Compute eigenvalues using the eigen_decomposition functiondoublematrix[3][3]={{A->x.x,A->x.y,A->x.z},{A->y.x,A->y.y,A->y.z},{A->z.x,A->z.y,A->z.z}};doubleeigenvectors[3][3];doubleeigenvalues[3];compute_eigensystem_symmetric_3x3(matrix,eigenvectors,eigenvalues);// Store eigenvalues and eigenvectorsLambda->x=eigenvalues[0];Lambda->y=eigenvalues[1];Lambda->z=eigenvalues[2];R->x.x=eigenvectors[0][0];R->x.y=eigenvectors[0][1];R->x.z=eigenvectors[0][2];R->y.x=eigenvectors[1][0];R->y.y=eigenvectors[1][1];R->y.z=eigenvectors[1][2];R->z.x=eigenvectors[2][0];R->z.y=eigenvectors[2][1];R->z.z=eigenvectors[2][2];}#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g): [%g,%g]\\n\",x,y,Lambda.x,Lambda.y);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);A.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;A11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}#elif dimension ==",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // start by...",
    "content": "// start by declaring the scalar variables that will store the components of $\\Psi$scalar Psi11=A11,Psi12=A12,Psi13=A13,Psi22=A22,Psi23=A23,Psi33=A33;foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);A.x.x=A11[];A.x.y=A12[];A.x.z=A13[];A.y.x=A12[];A.y.y=A22[];A.y.z=A23[];A.z.x=A13[];A.z.y=A23[];A.z.z=A33[];// Diagonalize the conformation tensor A to obtain the eigenvalues Lambda and eigenvectors Rdiagonalization_3D(&Lambda,&R,&A);/*Check for negative eigenvalues and clamp them to EIGENVALUE_MIN.This prevents numerical instabilities while maintaining physical meaning.*/if(Lambda.x<=0.||Lambda.y<=0.||Lambda.z<=0.){fprintf(ferr,\"WARNING: Negative eigenvalue detected at (%g,%g,%g): [%g,%g,%g]\\n\",x,y,z,Lambda.x,Lambda.y,Lambda.z);#ifdef DEBUG_EIGENVALUESatomic_increment(&eigenvalue_corrections);#endifLambda.x=max(Lambda.x,EIGENVALUE_MIN);Lambda.y=max(Lambda.y,EIGENVALUE_MIN);Lambda.z=max(Lambda.z,EIGENVALUE_MIN);}// Compute Psi = log(A) = R * log(Lambda) * R^TPsi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y)+sq(R.x.z)*log(Lambda.z);Psi22[]=sq(R.y.x)*log(Lambda.x)+sq(R.y.y)*log(Lambda.y)+sq(R.y.z)*log(Lambda.z);Psi33[]=sq(R.z.x)*log(Lambda.x)+sq(R.z.y)*log(Lambda.y)+sq(R.z.z)*log(Lambda.z);Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.x.y*R.y.y*log(Lambda.y)+R.x.z*R.y.z*log(Lambda.z);Psi13[]=R.x.x*R.z.x*log(Lambda.x)+R.x.y*R.z.y*log(Lambda.y)+R.x.z*R.z.z*log(Lambda.z);Psi23[]=R.y.x*R.z.x*log(Lambda.x)+R.y.y*R.z.y*log(Lambda.y)+R.y.z*R.z.z*log(Lambda.z);// Compute B and Omega tensors (3D version)pseudo_t3d B,M,Omega;init_pseudo_t3d(&B,0.0);init_pseudo_t3d(&M,0.0);init_pseudo_t3d(&Omega,0.0);// Check if any pair of eigenvalues are numerically equal (within a small tolerance)if(fabs(Lambda.x-Lambda.y)<=1e-20||fabs(Lambda.y-Lambda.z)<=1e-20||fabs(Lambda.z-Lambda.x)<=1e-20){// In case of equal eigenvalues, the calculations for B and Omega simplify significantly// B is grad U and Omega is zero.// Compute off-diagonal elements of B using central differences// These represent the symmetric part of the velocity gradient tensorB.x.y=(u.y[1,0,0]-u.y[-1,0,0]+u.x[0,1,0]-u.x[0,-1,0])/(4.*Delta);// (dv/dx + du/dy)/2B.x.z=(u.z[1,0,0]-u.z[-1,0,0]+u.x[0,0,1]-u.x[0,0,-1])/(4.*Delta);// (dw/dx + du/dz)/2B.y.z=(u.z[0,1,0]-u.z[0,-1,0]+u.y[0,0,1]-u.y[0,0,-1])/(4.*Delta);// (dw/dy + dv/dz)/2// Compute diagonal elements of B// These represent the normal strain ratesB.x.x=(u.x[1,0,0]-u.x[-1,0,0])/(2.*Delta);// du/dxB.y.y=(u.y[0,1,0]-u.y[0,-1,0])/(2.*Delta);// dv/dyB.z.z=(u.z[0,0,1]-u.z[0,0,-1])/(2.*Delta);// dw/dz// Set all components of Omega to zero// This is because Omega represents the antisymmetric part of the velocity gradient tensor,// which vanishes when eigenvalues are equalOmega.x.y=Omega.x.z=Omega.y.z=Omega.y.x=Omega.z.x=Omega.z.y=0.;}else{/*###Compute the velocity gradient tensor components using central differences- These represent the spatial derivatives of each velocity component- These gradients form the velocity gradient tensor (nablaU):[ dudx  dudy  dudz ][ dvdx  dvdy  dvdz ][ dwdx  dwdy  dwdz ]*/// Derivatives of u (x-component of velocity)doubledudx=(u.x[1,0,0]-u.x[-1,0,0])/(2.0*Delta);// du/dxdoubledudy=(u.x[0,1,0]-u.x[0,-1,0])/(2.0*Delta);// du/dydoubledudz=(u.x[0,0,1]-u.x[0,0,-1])/(2.0*Delta);// du/dz// Derivatives of v (y-component of velocity)doubledvdx=(u.y[1,0,0]-u.y[-1,0,0])/(2.0*Delta);// dv/dxdoubledvdy=(u.y[0,1,0]-u.y[0,-1,0])/(2.0*Delta);// dv/dydoubledvdz=(u.y[0,0,1]-u.y[0,0,-1])/(2.0*Delta);// dv/dz// Derivatives of w (z-component of velocity)doubledwdx=(u.z[1,0,0]-u.z[-1,0,0])/(2.0*Delta);// dw/dxdoubledwdy=(u.z[0,1,0]-u.z[0,-1,0])/(2.0*Delta);// dw/dydoubledwdz=(u.z[0,0,1]-u.z[0,0,-1])/(2.0*Delta);// dw/dz/*Calculate the M tensor through matrix multiplication: M = R * (nablaU)^T R^T.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: This represents the...",
    "content": "This represents the velocity gradient tensor transformed to the eigenvector basis of the conformation tensor.* Steps:1. Compute intermediate products (R * nablaU^T):- Store row-wise products in Rx_gradU_*, Ry_gradU_*, Rz_gradU_*- Each variable represents one row of the intermediate matrix2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Multiply by R^T...",
    "content": "Multiply by R^T to obtain the final M tensor:- M.i.j represents the (i,j) component of the transformed velocity gradient- This transformation expresses the velocity gradient in the eigenvector basis- The resulting M tensor is used to compute Omega (\u03a9) and B tensors, such that*/// First, compute intermediate products of R and (nablaU)^TdoubleRx_gradU_x=R.x.x*dudx+R.x.y*dvdx+R.x.z*dwdx;doubleRx_gradU_y=R.x.x*dudy+R.x.y*dvdy+R.x.z*dwdy;doubleRx_gradU_z=R.x.x*dudz+R.x.y*dvdz+R.x.z*dwdz;doubleRy_gradU_x=R.y.x*dudx+R.y.y*dvdx+R.y.z*dwdx;doubleRy_gradU_y=R.y.x*dudy+R.y.y*dvdy+R.y.z*dwdy;doubleRy_gradU_z=R.y.x*dudz+R.y.y*dvdz+R.y.z*dwdz;doubleRz_gradU_x=R.z.x*dudx+R.z.y*dvdx+R.z.z*dwdx;doubleRz_gradU_y=R.z.x*dudy+R.z.y*dvdy+R.z.z*dwdy;doubleRz_gradU_z=R.z.x*dudz+R.z.y*dvdz+R.z.z*dwdz;// Now compute M components by multiplying the intermediate products with R^TM.x.x=R.x.x*Rx_gradU_x+R.x.y*Rx_gradU_y+R.x.z*Rx_gradU_z;M.x.y=R.x.x*Ry_gradU_x+R.x.y*Ry_gradU_y+R.x.z*Ry_gradU_z;M.x.z=R.x.x*Rz_gradU_x+R.x.y*Rz_gradU_y+R.x.z*Rz_gradU_z;M.y.x=R.y.x*Rx_gradU_x+R.y.y*Rx_gradU_y+R.y.z*Rx_gradU_z;M.y.y=R.y.x*Ry_gradU_x+R.y.y*Ry_gradU_y+R.y.z*Ry_gradU_z;M.y.z=R.y.x*Rz_gradU_x+R.y.y*Rz_gradU_y+R.y.z*Rz_gradU_z;M.z.x=R.z.x*Rx_gradU_x+R.z.y*Rx_gradU_y+R.z.z*Rx_gradU_z;M.z.y=R.z.x*Ry_gradU_x+R.z.y*Ry_gradU_y+R.z.z*Ry_gradU_z;M.z.z=R.z.x*Rz_gradU_x+R.z.y*Rz_gradU_y+R.z.z*Rz_gradU_z;// Compute the off-diagonal elements of the Omega tensor in the eigenvector basisdoubleomega_xy=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);doubleomega_xz=(Lambda.z*M.x.z+Lambda.x*M.z.x)/(Lambda.z-Lambda.x);doubleomega_yz=(Lambda.z*M.y.z+Lambda.y*M.z.y)/(Lambda.z-Lambda.y);// Calculate intermediate rotation combinations for each direction// x-direction rotation combinationsdoublerot_x_xy_yz=(R.x.x*omega_xy-R.x.z*omega_yz);// xy rotation minus yz rotation, x componentsdoublerot_x_xy_xz=(R.x.y*omega_xy+R.x.z*omega_xz);// xy rotation plus xz rotation, x componentsdoublerot_x_xz_yz=(R.x.x*omega_xz+R.x.y*omega_yz);// xz rotation plus yz rotation, x components// y-direction rotation combinationsdoublerot_y_xy_yz=(R.y.x*omega_xy-R.y.z*omega_yz);// xy rotation minus yz rotation, y componentsdoublerot_y_xy_xz=(R.y.y*omega_xy+R.y.z*omega_xz);// xy rotation plus xz rotation, y componentsdoublerot_y_xz_yz=(R.y.x*omega_xz+R.y.y*omega_yz);// xz rotation plus yz rotation, y components// z-direction rotation combinationsdoublerot_z_xy_yz=(R.z.x*omega_xy-R.z.z*omega_yz);// xy rotation minus yz rotation, z componentsdoublerot_z_xy_xz=(R.z.y*omega_xy+R.z.z*omega_xz);// xy rotation plus xz rotation, z componentsdoublerot_z_xz_yz=(R.z.x*omega_xz+R.z.y*omega_yz);// xz rotation plus yz rotation, z components",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // Compute x-row...",
    "content": "// Compute x-row components of OmegaOmega.x.x=R.x.y*rot_x_xy_yz// xy-yz rotation contribution-R.x.x*rot_x_xy_xz// xy-xz rotation contribution+R.x.z*rot_x_xz_yz;// xz-yz rotation contributionOmega.x.y=R.y.y*rot_x_xy_yz// xy-yz rotation mapped to y-direction-R.y.x*rot_x_xy_xz// xy-xz rotation mapped to y-direction+R.y.z*rot_x_xz_yz;// xz-yz rotation mapped to y-directionOmega.x.z=R.z.y*rot_x_xy_yz// xy-yz rotation mapped to z-direction-R.z.x*rot_x_xy_xz// xy-xz rotation mapped to z-direction+R.z.z*rot_x_xz_yz;// xz-yz rotation mapped to z-direction// Compute y-row components using similar patternOmega.y.x=R.x.y*rot_y_xy_yz-R.x.x*rot_y_xy_xz+R.x.z*rot_y_xz_yz;Omega.y.y=R.y.y*rot_y_xy_yz-R.y.x*rot_y_xy_xz+R.y.z*rot_y_xz_yz;Omega.y.z=R.z.y*rot_y_xy_yz-R.z.x*rot_y_xy_xz+R.z.z*rot_y_xz_yz;// Compute z-row components using similar patternOmega.z.x=R.x.y*rot_z_xy_yz-R.x.x*rot_z_xy_xz+R.x.z*rot_z_xz_yz;Omega.z.y=R.y.y*rot_z_xy_yz-R.y.x*rot_z_xy_xz+R.y.z*rot_z_xz_yz;Omega.z.z=R.z.y*rot_z_xy_yz-R.z.x*rot_z_xy_xz+R.z.z*rot_z_xz_yz;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "// Extract diagonal components of M (velocity gradient tensor in eigenvector basis)doubleM_diag_x=M.x.x,M_diag_y=M.y.y,M_diag_z=M.z.z;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // Compute diagonal...",
    "content": "// Compute diagonal elements of BB.x.x=M_diag_x*sq(R.x.x)+M_diag_y*sq(R.x.y)+M_diag_z*sq(R.x.z);B.y.y=M_diag_x*sq(R.y.x)+M_diag_y*sq(R.y.y)+M_diag_z*sq(R.y.z);B.z.z=M_diag_x*sq(R.z.x)+M_diag_y*sq(R.z.y)+M_diag_z*sq(R.z.z);// Compute off-diagonal elements of B (upper triangle)B.x.y=M_diag_x*R.x.x*R.y.x+M_diag_y*R.x.y*R.y.y+M_diag_z*R.x.z*R.y.z;B.x.z=M_diag_x*R.x.x*R.z.x+M_diag_y*R.x.y*R.z.y+M_diag_z*R.x.z*R.z.z;B.y.z=M_diag_x*R.y.x*R.z.x+M_diag_y*R.y.y*R.z.y+M_diag_z*R.y.z*R.z.z;// Fill in lower triangle using symmetry of BB.y.x=B.x.y;B.z.x=B.x.z;B.z.y=B.y.z;}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: // save old...",
    "content": "// save old values of Psi componentsdoubleold_Psi11=Psi11[];doubleold_Psi22=Psi22[];doubleold_Psi33=Psi33[];doubleold_Psi12=Psi12[];doubleold_Psi13=Psi13[];doubleold_Psi23=Psi23[];// Psi11Psi11[]+=dt*(2.0*B.x.x+Omega.x.y*old_Psi12-Omega.y.x*old_Psi12+Omega.x.z*old_Psi13-Omega.z.x*old_Psi13);// Psi22Psi22[]+=dt*(2.0*B.y.y-Omega.x.y*old_Psi12+Omega.y.x*old_Psi12+Omega.y.z*old_Psi23-Omega.z.y*old_Psi23);// Psi33Psi33[]+=dt*(2.0*B.z.z-Omega.x.z*old_Psi13+Omega.z.x*old_Psi13-Omega.y.z*old_Psi23+Omega.z.y*old_Psi23);// Psi12Psi12[]+=dt*(2.0*B.x.y+Omega.x.x*old_Psi12-Omega.x.y*old_Psi11+Omega.x.y*old_Psi22-Omega.y.y*old_Psi12+Omega.x.z*old_Psi23-Omega.z.y*old_Psi13);// Psi13Psi13[]+=dt*(2.0*B.x.z+Omega.x.x*old_Psi13-Omega.x.z*old_Psi11+Omega.x.y*old_Psi23-Omega.y.z*old_Psi12+Omega.x.z*old_Psi33-Omega.z.z*old_Psi13);// Psi23Psi23[]+=dt*(2.0*B.y.z+Omega.y.x*old_Psi13-Omega.x.z*old_Psi12+Omega.y.y*old_Psi23-Omega.y.z*old_Psi22+Omega.y.z*old_Psi33-Omega.z.z*old_Psi23);}// Advection of Psi, which is the log-conformation tensoradvection({Psi11,Psi12,Psi13,Psi22,Psi23,Psi33},uf,dt);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "foreach(){pseudo_t3d A,R;init_pseudo_t3d(&R,0.0);pseudo_v3d Lambda;init_pseudo_v3d(&Lambda,0.0);// Reconstruct the log-conformation tensor from its componentsA.x.x=Psi11[];A.x.y=Psi12[];A.x.z=Psi13[];A.y.x=Psi12[];A.y.y=Psi22[];A.y.z=Psi23[];A.z.x=Psi13[];A.z.y=Psi23[];A.z.z=Psi33[];// Diagonalize A to obtain eigenvalues and eigenvectorsdiagonalization_3D(&Lambda,&R,&A);// Exponentiate eigenvaluesLambda.x=exp(Lambda.x);Lambda.y=exp(Lambda.y);Lambda.z=exp(Lambda.z);// Reconstruct A using A = R * diag(Lambda) * R^TA.x.x=Lambda.x*sq(R.x.x)+Lambda.y*sq(R.x.y)+Lambda.z*sq(R.x.z);A.x.y=Lambda.x*R.x.x*R.y.x+Lambda.y*R.x.y*R.y.y+Lambda.z*R.x.z*R.y.z;A.y.x=A.x.y;A.x.z=Lambda.x*R.x.x*R.z.x+Lambda.y*R.x.y*R.z.y+Lambda.z*R.x.z*R.z.z;A.z.x=A.x.z;A.y.y=Lambda.x*sq(R.y.x)+Lambda.y*sq(R.y.y)+Lambda.z*sq(R.y.z);A.y.z=Lambda.x*R.y.x*R.z.x+Lambda.y*R.y.y*R.z.y+Lambda.z*R.y.z*R.z.z;A.z.y=A.y.z;A.z.z=Lambda.x*sq(R.z.x)+Lambda.y*sq(R.z.y)+Lambda.z*sq(R.z.z);// Apply relaxation using the relaxation time lambdadoubleintFactor=lambda[]!=0.?exp(-dt/lambda[]):0.;A.x.y*=intFactor;A.y.x=A.x.y;A.x.z*=intFactor;A.z.x=A.x.z;A.y.z*=intFactor;A.z.y=A.y.z;foreach_dimension()A.x.x=1.+(A.x.x-1.)*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "// diagonal terms:A11[]=A.x.x;A22[]=A.y.y;A33[]=A.z.z;// off-diagonal terms:A12[]=A.x.y;A13[]=A.x.z;A23[]=A.y.z;// Compute the stress tensor T using the polymer modulus GpT11[]=Gp[]*(A.x.x-1.);T22[]=Gp[]*(A.y.y-1.);T33[]=Gp[]*(A.z.z-1.);T12[]=Gp[]*A.x.y;T13[]=Gp[]*A.x.z;T23[]=Gp[]*A.y.z;}}#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-3D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;#if dimension ==// 2D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12 (shear stress)doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;// x-gradient of T11 (normal stress)doublegradX_T11=cm[]*T11[]-cm[-1]*T11[-1];av.x[]+=(shearX+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12 (shear stress)doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;// y-gradient of T22 (normal stress)doublegradY_T22=cm[]*T22[]-cm[0,-1]*T22[0,-1];av.y[]+=(shearY+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}#elif dimension ==// 3D implementationforeach_face(x){if(fm.x[]>1e-20){// y-gradient of T12doubleshearY=(T12[0,1,0]*cm[0,1,0]+T12[-1,1,0]*cm[-1,1,0]-T12[0,-1,0]*cm[0,-1,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T13doubleshearZ=(T13[0,0,1]*cm[0,0,1]+T13[-1,0,1]*cm[-1,0,1]-T13[0,0,-1]*cm[0,0,-1]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// x-gradient of T11doublegradX_T11=cm[]*T11[]-cm[-1,0,0]*T11[-1,0,0];av.x[]+=(shearY+shearZ+gradX_T11)*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){// x-gradient of T12doubleshearX=(T12[1,0,0]*cm[1,0,0]+T12[1,-1,0]*cm[1,-1,0]-T12[-1,0,0]*cm[-1,0,0]-T12[-1,-1,0]*cm[-1,-1,0])/4.;// z-gradient of T23doubleshearZ=(T23[0,0,1]*cm[0,0,1]+T23[0,-1,1]*cm[0,-1,1]-T23[0,0,-1]*cm[0,0,-1]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// y-gradient of T22doublegradY_T22=cm[]*T22[]-cm[0,-1,0]*T22[0,-1,0];av.y[]+=(shearX+shearZ+gradY_T22)*alpha.y[]/(sq(fm.y[])*Delta);}}foreach_face(z){if(fm.z[]>1e-20){// x-gradient of T13doubleshearX=(T13[1,0,0]*cm[1,0,0]+T13[1,0,-1]*cm[1,0,-1]-T13[-1,0,0]*cm[-1,0,0]-T13[-1,0,-1]*cm[-1,0,-1])/4.;// y-gradient of T23doubleshearY=(T23[0,1,0]*cm[0,1,0]+T23[0,1,-1]*cm[0,1,-1]-T23[0,-1,0]*cm[0,-1,0]-T23[0,-1,-1]*cm[0,-1,-1])/4.;// z-gradient of T33doublegradZ_T33=cm[]*T33[]-cm[0,0,-1]*T33[0,0,-1];av.z[]+=(shearX+shearY+gradZ_T33)*alpha.z[]/(sq(fm.z[])*Delta);}}#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-3D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "src-local/two-phaseVE.h See raw file Modification by Vatsal Sanjay Version 2.0, Oct 17, 2024 Changelog Oct 17, 2024: added support for VE simulations. Brief history v1.0 is the vanilla Basilisk code for two-phase flows: http://basilisk.fr/src/two-phase.h + http://basilisk.fr/src/two-phase-generic.h v2.0 is the modification for viscoelastic fluids using the log-conformation method. Two-phase interfacial flows This is a modified version of two-phase.h . It contains the implementation of Viscoplastic Fluid (Bingham Fluid). This file helps setup simulations for flows of two fluids separated by an interface (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. #include \"vof.h\" scalar f [], * interfaces = { f }; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. ; double G1 = 0. , G2 = 0. ; // elastic moduli double lambda1 = 0. , lambda2 = 0. ; // relaxation times double TOLelastic = 1e-2 ; // tolerance for elastic modulus #TOFIX: this must always be a very small number. Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; scalar Gpd []; scalar lambdapd []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; Gp = Gpd ; lambda = lambdapd ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho # define rho ( f ) ( clamp ( f , 0. , 1. )*( rho1 - rho2 ) + rho2 ) 62 #endif #ifndef mu // for Arithmetic mean, use this # define mu ( f ) ( clamp ( f , 0. , 1. )*( mu1 - mu2 ) + mu2 ) 66 #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf []; #else # define sf f 76 #endif event tracer_advection ( i ++) { When using smearing of the density jump, we initialise sf with the vertex-average of f . #ifndef sf #if dimension <= foreach () sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; #else // dimension == foreach () sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; #endif #endif #if TREE sf . prolongation = refine_bilinear ; sf . dirty = true ; // boundary conditions need to be updated #endif } event properties ( i ++) { foreach_face () { double ff = ( sf [] + sf [- 1 ])/ 2. ; alphav . x [] = fm . x []/ rho ( ff ); face vector muv = mu ; muv . x [] = fm . x []* mu ( ff ); } foreach (){ rhov [] = cm []* rho ( sf []); Gpd [] = 0. ; lambdapd [] = 0. ; if ( clamp ( sf [], 0. , 1. ) > TOLelastic ){ Gpd [] += G1 * clamp ( sf [], 0. , 1. ); lambdapd [] += lambda1 * clamp ( sf [], 0. , 1. ); } if ( clamp (( 1 - sf []), 0. , 1. ) > TOLelastic ){ Gpd [] += G2 * clamp (( 1 - sf []), 0. , 1. ); lambdapd [] += lambda2 * clamp (( 1 - sf []), 0. , 1. ); } } #if TREE sf . prolongation = fraction_refine ; sf . dirty = true ; // boundary conditions need to be updated #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"vof.h\"scalar f[],*interfaces={f};doublerho1=1.,mu1=0.,rho2=1.,mu2=0.;doubleG1=0.,G2=0.;// elastic modulidoublelambda1=0.,lambda2=0.;// relaxation timesdoubleTOLelastic=1e-2;// tolerance for elastic modulus #TOFIX: this must always be a very small number.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "face vector alphav[];scalar rhov[];scalar Gpd[];scalar lambdapd[];event defaults(i=0){alpha=alphav;rho=rhov;Gp=Gpd;lambda=lambdapd;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: rho",
    "content": "#ifndef rho# define rho(f)(clamp(f,0.,1.)*(rho1-rho2)+rho2)62#endif#ifndef mu// for Arithmetic mean, use this# define mu(f)(clamp(f,0.,1.)*(mu1-mu2)+mu2)66#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf[];#else# define sf f76#endifevent tracer_advection(i++){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Function: sf",
    "content": "#ifndef sf#if dimension <=foreach()sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;#else// dimension ==foreach()sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;#endif#endif#if TREEsf.prolongation=refine_bilinear;sf.dirty=true;// boundary conditions need to be updated#endif}event properties(i++){foreach_face(){doubleff=(sf[]+sf[-1])/2.;alphav.x[]=fm.x[]/rho(ff);face vector muv=mu;muv.x[]=fm.x[]*mu(ff);}foreach(){rhov[]=cm[]*rho(sf[]);Gpd[]=0.;lambdapd[]=0.;if(clamp(sf[],0.,1.)>TOLelastic){Gpd[]+=G1*clamp(sf[],0.,1.);lambdapd[]+=lambda1*clamp(sf[],0.,1.);}if(clamp((1-sf[]),0.,1.)>TOLelastic){Gpd[]+=G2*clamp((1-sf[]),0.,1.);lambdapd[]+=lambda2*clamp((1-sf[]),0.,1.);}}#if TREEsf.prolongation=fraction_refine;sf.dirty=true;// boundary conditions need to be updated#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "src-local/log-conform-viscoelastic-scalar-2D.h See raw file Log-Conformation Method for 2D Viscoelastic Fluids Overview Title : log-conform-viscoelastic-scalar-2D.h Version : 2.5 Description : 2D and axisymmetric scalar implementation of viscoelastic fluid dynamics using the log-conformation method Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Supports both 2D and axisymmetric configurations Scalar implementation approach for better performance Compatible with log-conform-viscoelastic.h Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Nov 23, 2024 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Version History v1.0 (Oct 18, 2024) Initial implementation with 2D+axi support Scalar-based implementation for efficiency v2.0 (Nov 3, 2024) Major documentation improvements Made code an axisymmetric mirror of log-conform-viscoelastic-scalar-3D.h Added negative eigenvalue detection with location reporting Added initialization functions for pseudo_v and pseudo_t v2.1 (Nov 14, 2024) Added support for infinite Deborah number cases v2.5 (Nov 23, 2024) Enhanced documentation clarity and completeness Future Work Tensor Formulation Convert to consistent tensor formulation for: Improved readability and maintainability Better computational efficiency Reduced potential for bugs Prerequisites for axi compatibility in 3D version Related issues: https://github.com/comphy-lab/Viscoelastic3D/issues/11 https://github.com/comphy-lab/Viscoelastic3D/issues/5 Code Improvements Enforce tensor usage throughout codebase Implement foreach_dimension compatibility The log-conformation method for viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore these materials...",
    "content": "Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers. Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The conformation tensor...",
    "content": "The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time. In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Parameters The primary...",
    "content": "Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: TODO: - Perhaps,...",
    "content": "TODO: - Perhaps, instead of the Bell\u2013Collela\u2013Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to http://basilisk.fr/src/navier-stokes/conserving.h #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time scalar A11 [], A12 [], A22 []; // conformation tensor scalar T11 [], T12 [], T22 []; // stress tensor #if AXI scalar AThTh [], T_ThTh []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T22 , A12 }) { foreach (){ s [] = 0. ; } } #if AXI foreach (){ T_ThTh [] = 0 ; AThTh [] = 1. ; } #endif for ( scalar s in { T11 , T12 , T22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } for ( scalar s in { A11 , A12 , A22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } #if AXI T12 [ bottom ] = dirichlet ( 0. ); A12 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ).",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: In an Oldroyd-B...",
    "content": "In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; #if AXI scalar Psiqq = AThTh ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . x = A11 []; A . y . y = A22 []; A . x . y = A12 []; #if AXI double Aqq = AThTh []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: If it does,...",
    "content": "If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g , Lambda.y = %g\\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g , y = %g\\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi11 , Psi12 , Psi22 , Psiqq }, uf , dt ); #else advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); #endif Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; #if AXI AThTh [] = Aqq ; T_ThTh [] = Gp []*( Aqq - 1. ); #endif A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Examples",
    "content": "For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face ( x ){ if ( fm . x [] > 1e-20 ) { double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shearX + cm []* T11 [] - cm [- 1 ]* T11 [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ){ if ( fm . y [] > 1e-20 ) { double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . y [] += ( shearY + cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ])* alpha . y []/( sq ( fm . y [])* Delta ); } } #if AXI foreach_face ( y ) if ( y > 1e-20 ) av . y [] -= ( T_ThTh [] + T_ThTh [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: C/C++ Code",
    "content": "#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation timescalar A11[],A12[],A22[];// conformation tensorscalar T11[],T12[],T22[];// stress tensor#if AXIscalar AThTh[],T_ThTh[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T22,A12}){foreach(){s[]=0.;}}#if AXIforeach(){T_ThTh[]=0;AThTh[]=1.;}#endiffor(scalar s in{T11,T12,T22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}for(scalar s in{A11,A12,A22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}#if AXIT12[bottom]=dirichlet(0.);A12[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;#if AXIscalar Psiqq=AThTh;#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A;A.x.x=A11[];A.y.y=A22[];A.x.y=A12[];#if AXIdoubleAqq=AThTh[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x =%g, Lambda.y =%g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x =%g, y =%g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#if AXIadvection({Psi11,Psi12,Psi22,Psiqq},uf,dt);#elseadvection({Psi11,Psi12,Psi22},uf,dt);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;#if AXIAThTh[]=Aqq;T_ThTh[]=Gp[]*(Aqq-1.);#endifA11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | Viscoelastic Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;foreach_face(x){if(fm.x[]>1e-20){doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shearX+cm[]*T11[]-cm[-1]*T11[-1])*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;av.y[]+=(shearY+cm[]*T22[]-cm[0,-1]*T22[0,-1])*alpha.y[]/(sq(fm.y[])*Delta);}}#if AXIforeach_face(y)if(y>1e-20)av.y[]-=(T_ThTh[]+T_ThTh[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/Viscoelastic-Worthington-jets-and-droplets-produced-by-bursting-bubbles/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # tested on MacOS only.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue. # modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to install basilisk install_basilisk() { darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make -k make } # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then echo \"Installing basilisk...\" rm -rf basilisk install_basilisk else echo \"Using existing basilisk installation...\" cd basilisk/src fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\\nChecking qcc installation...\" if ! qcc --version > /dev/null 2 >& 1 ; then echo \"\\033[0;31mError: qcc is not working properly.\\033[0m\" echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" echo \"For more details, visit: http://basilisk.fr/src/INSTALL\" exit 1 else echo \"\\033[0;32mqcc is properly installed.\\033[0m\" qcc --version fi",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: #!/bin/zsh# tested on...",
    "content": "#!/bin/zsh# tested on MacOS only.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue.# modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basilisk# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to install basiliskinstall_basilisk(){darcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake-kmake}# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenecho\"Installing basilisk...\"rm-rfbasiliskinstall_basiliskelseecho\"Using existing basilisk installation...\"cdbasilisk/srcfi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\\nChecking qcc installation...\"if!qcc--version>/dev/null2>&1;thenecho\"\\033[0;31mError: qcc is not working properly.\\033[0m\"echo\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"echo\"For more details, visit: http://basilisk.fr/src/INSTALL\"exit1elseecho\"\\033[0;32mqcc is properly installed.\\033[0m\"qcc--versionfi",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Herschel-Bulkley Worthington Jets...",
    "content": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles This repository contains the simulation code and analysis for studying the dynamics of Herschel-Bulkley Worthington jets and droplets produced by bursting bubbles.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "The code uses the Basilisk framework to simulate bubble cavity collapse in non-Newtonian media, examining how power-law index, yield stress, and viscosity affect jet and droplet formation. basilisk/src/ - Core Basilisk CFD library (reference only, do not modify) simulationCases/ - Simulation cases and input/output data burstingBubbleHB.c - Main Herschel-Bulkley bursting bubble simulation initial-condition-test.ipynb - Jupyter notebook for initial condition tests Makefile - Makefile for compiling/running cases runMake.sh - Helper script for running make src-local/ - Custom header files extending Basilisk functionality two-phaseVP-HB.h - Herschel-Bulkley two-phase flow model postProcess/ - Project-specific post-processing tools getData.c - Data extraction utility getFacets.c - Facet extraction utility video.py - Python script for video/visualization reset_install_requirements.sh - Script to set up Basilisk and dependencies Overview The project investigates how non-Newtonian behavior influences bubble bursting dynamics by exploring the phase space of effective Ohnesorge number, power-law index, and plasto-capillary number using volume of fluid-based finite volume simulations.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Results",
    "content": "The results demonstrate how shear-thinning/thickening behavior and yield stress significantly influence the overall dynamics through the interplay of viscous and plastic effects. Installation and Setup To ensure you have the necessary tools and a fresh Basilisk installation, use the provided script: ./reset_install_requirements.sh Function This script checks for Basilisk installation and compiles it if not present. OS Compatibility Designed for macOS. If you encounter issues on Linux, please open a GitHub issue. Dependencies Basilisk C is fetched and built automatically. Xcode Command Line Tools (macOS) or equivalent compiler toolchain (Linux) are required. Environment Setup After running the script, a .project_config file is created, setting BASILISK and PATH automatically.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "If you have previously installed Basilisk or changed dependencies, re-run the script with --hard : ./reset_install_requirements.sh --hard Running the Code Recommended Method: Using Makefile The easiest way to compile and run the code is using the Makefile approach: Navigate to the testCases directory: cd testCases Compile and run using make (this runs the code interactively using the browser): CFLAGS = -DDISPLAY=-1 make burstingBubbleVE.tst To run the code non-interactively, use the following command: make burstingBubbleVE.tst Alternative Method: Direct Compilation You can compile the code directly using qcc in two ways: Using include paths (recommended): qcc -O2 -Wall -disable-dimensions -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm Without include paths: qcc -O2 -Wall -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm Note : If using method 2, you must first manually copy the src-local folder to your running directory.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Local Execution MacOS:...",
    "content": "Local Execution MacOS: # First source the configuration source .project_config # Compile using include paths (recommended) qcc -O2 -Wall -disable-dimensions -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm # Or compile without include paths (requires manually copying src-local folder) qcc -O2 -Wall -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm # Run the executable, only supports serial execution ./burstingBubbleVE Linux: # First source the configuration source .project_config # Compile using include paths (recommended) qcc -O2 -Wall -disable-dimensions -fopenmp -I $( PWD ) /src-local -I $( PWD ) /../src-local burstingBubbleVE.c -o burstingBubbleVE -lm # Or compile without include paths (requires manually copying src-local folder) qcc -O2 -Wall -disable-dimensions -fopenmp burstingBubbleVE.c -o burstingBubbleVE -lm # Set the number of OpenMP threads export OMP_NUM_THREADS = 4 # Run the executable ./burstingBubbleVE HPC Cluster Execution (e.g., Snellius) For cluster environments, it is strongly recommended to manually copy the src-local folder to your working directory to ensure reliable compilation across different cluster configurations: First, copy the required files: cp -r /path/to/original/src-local .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Compile the code...",
    "content": "Compile the code for MPI: CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions burstingBubbleVE.c -o burstingBubbleVE -lm Create a SLURM job script (e.g., run_simulation.sh ): #!/bin/bash #SBATCH --nodes=1 #SBATCH --ntasks=32 #SBATCH --time=1:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=v.sanjay@utwente.nl srun --mpi = pmi2 -n 32 --gres = cpu:32 --mem-per-cpu = 1750mb burstingBubbleVE Submit the job: sbatch run_simulation.sh Additional Running Scripts The z_extras/running directory contains supplementary materials and post-processing tools used in the analysis. This includes C-based data extraction utilities, Python visualization scripts, and analysis notebooks. These tools were used to process simulation outputs and generate figures for the study. For detailed documentation of these tools, see the README in the z_extras directory. Contributing Issues & Contributions : Please file bug reports, feature requests, or pull requests on GitHub .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: When creating an...",
    "content": "When creating an issue, please: For bug reports: Include the error message, OS version, and steps to reproduce the issue For feature requests: Clearly describe the proposed feature and its use case For questions: Check existing issues and documentation first We welcome contributions! Please feel free to submit a Pull Request. Reset Install Requirements Script The reset_install_requirements.sh script is designed to reset the installation requirements for the project. This can be useful when you want to ensure that all dependencies are fresh and up-to-date. Purpose The script re-installs all required packages as specified in the requirements file, ensuring that the project\u2019s dependencies are up-to-date and consistent. Usage To run the script, use the following command in your terminal: bash reset_install_requirements.sh Make sure to have the necessary permissions to execute the script.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Citation If you...",
    "content": "Citation If you use this code in your research, please cite: Software Authors Vatsal Sanjay (University of Twente), vatsalsanjay@gmail.com License This project is licensed under standard academic terms. Please cite the paper and software if you use this code in your research. Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/getData.c postProcess/getFacets.c postProcess/video.py simulationCases simulationCases/Makefile simulationCases/burstingBubbleHB.c simulationCases/initial-condition-test.ipynb simulationCases/runMake.sh src-local src-local/two-phaseVP-HB.h",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "qcc-O2-Wall-disable-dimensions-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "qcc-O2-Wall-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# First source the configurationsource.project_config# Compile using include paths (recommended)qcc-O2-Wall-disable-dimensions-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm# Or compile without include paths (requires manually copying src-local folder)qcc-O2-Wall-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm# Run the executable, only supports serial execution./burstingBubbleVE",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# First source the configurationsource.project_config# Compile using include paths (recommended)qcc-O2-Wall-disable-dimensions-fopenmp-I$(PWD)/src-local-I$(PWD)/../src-local burstingBubbleVE.c-oburstingBubbleVE-lm# Or compile without include paths (requires manually copying src-local folder)qcc-O2-Wall-disable-dimensions-fopenmpburstingBubbleVE.c-oburstingBubbleVE-lm# Set the number of OpenMP threadsexportOMP_NUM_THREADS=4# Run the executable./burstingBubbleVE",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "CC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensionsburstingBubbleVE.c-oburstingBubbleVE-lm",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#!/bin/bash#SBATCH --nodes=1#SBATCH --ntasks=32#SBATCH --time=1:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=v.sanjay@utwente.nlsrun--mpi=pmi2-n32--gres=cpu:32--mem-per-cpu=1750mb burstingBubbleVE",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getFacets.c See raw file Getting Facets A utility for extracting interface facets from fluid simulation data. Description This program extracts and outputs the facets representing the interface between different phases in a multiphase flow simulation. The facets define the boundary between fluid phases, useful for geometric analysis and visualization of the interface morphology. Physics Background In multiphase fluid simulations, interfaces between different fluids are critical features that determine many physical phenomena like surface tension effects, droplet formation, and coalescence events. This utility identifies these interfaces by extracting facets from volume fraction data, allowing for quantitative analysis of interfacial dynamics.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getFacets.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "Usage ./getFacets input_file Author: Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Department University of Twente #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" scalar f []; // Volume fraction field char filename [ 80 ]; Main Function Loads a simulation snapshot and extracts the interface facets. Input parameters: arguments[1] : Filename of the simulation snapshot to process Process: Restores the simulation state from the specified file Extracts interface facets from the volume fraction field Outputs facet data to standard error Return value: Returns 0 on successful completion Note: The facet extraction algorithm identifies where the volume fraction field crosses a threshold value (typically 0.5) between adjacent cells. int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); return 0 ; }",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getFacets.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"scalar f[];// Volume fraction fieldcharfilename[80];",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getFacets.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);return0;}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getFacets.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData.c This program extracts and processes data from fluid dynamics simulation snapshots. It calculates key fluid mechanics ... getFacets.c A utility for extracting interface facets from fluid simulation data. video.py import numpy as np import os import subprocess as sp import matplotlib matplotlib.use('Agg') Use non-interactive back...",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/video.py | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Import Statements",
    "content": "postProcess/video.py See raw file # Author: Vatsal Sanjay # vatsalsanjay@gmail.com # Physics of Fluids # Last updated: Dec 24, 2024 import numpy as np import os import subprocess as sp import matplotlib matplotlib.use( 'Agg' ) # Use non-interactive backend import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import multiprocessing as mp from functools import partial import argparse import matplotlib.colors as mcolors custom_colors = [ \"white\" , \"#DA8A67\" , \"#A0522D\" , \"#400000\" ] custom_cmap = mcolors.LinearSegmentedColormap.from_list( \"custom_hot\" , custom_colors) # Set up matplotlib configuration plt.rcParams[ 'text.usetex' ] = True plt.rcParams[ 'font.family' ] = 'serif' plt.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath} \\ usepackage{amssymb}' plt.rcParams[ 'mathtext.fontset' ] = 'cm' plt.rcParams[ 'font.serif' ] = [ 'Computer Modern Roman' ] + plt.rcParams[ 'font.serif' ] def gettingFacets(filename): exe = [ \"./getFacets\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) skip = True return segs def gettingfield(filename, zmin, rmin, zmax, rmax, nr): exe = [ \"./getData\" , filename, str (zmin), str (rmin), str (zmax), str (rmax), str (nr)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp = [],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) return R, Z, D2, vel, nz # ---------------------------------------------------------------------------------------------------------------------- def process_timestep(ti, caseToProcess, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw): t = 0.01 * ti place = f\" { caseToProcess } /intermediate/snapshot- { t :.4f} \" name = f\" { folder } / { int (t * 1000 ) :08d} .png\" if not os.path.exists(place): print ( f\" { place } File not found!\" ) return if os.path.exists(name): print ( f\" { name } Image present!\" ) return # --- Gather interface segments and field data as before --- segs = gettingFacets(place) nr = int (GridsPerR * rmax) R, Z, D2, vel, nz = gettingfield(place, zmin, rmin, zmax, rmax, nr) [xminp, xmaxp, yminp, ymaxp] = R. min (), R. max (), Z. min (), Z. max () extent_vel = [ - xminp, - xmaxp, yminp, ymaxp] extent_D2 = [xminp, xmaxp, yminp, ymaxp] AxesLabel, TickLabel = 30 , 20 fig, ax = plt.subplots( 1 , 1 , figsize = ( 19.20 , 10.80 )) ax.plot([ - rmax, rmax], [ 0 , 0 ], '--' , color = 'grey' , linewidth = lw) # \"horizontal\" axis is z ax.plot([ 0 , 0 ], [zmin, zmax], '-.' , color = 'grey' , linewidth = lw) # \"vertical\" axis is r # Domain box: ax.plot([ - rmax, rmax], [zmin, zmin], '-' , color = 'black' , linewidth = lw) ax.plot([ - rmax, rmax], [zmax, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([ - rmax, - rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) line_segments = LineCollection(segs, linewidths = 4 , colors = 'green' ) ax.add_collection(line_segments) # ---------------------------------------------------------- # Now show imshow with the rotated arrays and extents: # ---------------------------------------------------------- cntrl1 = ax.imshow( vel, cmap = \"Blues\" , interpolation = 'bilinear' , origin = 'lower' , extent = extent_vel, vmin = 0.0 , vmax = 4e0 ) cntrl2 = ax.imshow( D2, cmap = \"hot_r\" , interpolation = 'bilinear' , origin = 'lower' , extent = extent_D2, vmin =- 3e0 , vmax = 2e0 ) # Equal aspect ensures squares in the new orientation ax.set_aspect( 'equal' ) ax.set_xlim( - rmax, rmax) # x range ax.set_ylim(zmin, zmax) # y range # Titles and labels that match the new orientation ax.set_title( fr' $ t/ \\t au_ {{ \\ gamma }} = { t :.4f} $ ' , fontsize = TickLabel) # Colorbars: place them closer to the plot edges fig.subplots_adjust(left = 0.1 , right = 0.9 ) # adjust spacing for vertical colorbars # Left colorbar cbar_ax1 = fig.add_axes([ 0.07 , 0.15 , 0.02 , 0.7 ]) # x,y,width,height in figure coords c1 = plt.colorbar(cntrl1, cax = cbar_ax1, orientation = 'vertical' ) c1.ax.tick_params(labelsize = TickLabel) c1.set_label( r' $ \\| u_i \\| /V_{ \\ gamma} $ ' , fontsize = AxesLabel, labelpad = 10 , rotation = 90 , position = ( 0 , 0.5 )) c1.ax.yaxis.set_label_position( 'left' ) c1.ax.yaxis.set_ticks_position( 'left' ) # Move ticks to left side c1.ax.tick_params(axis = 'y' , labelright = False , labelleft = True ) # Move tick labels to left side # Right colorbar cbar_ax2 = fig.add_axes([ 0.92 , 0.15 , 0.02 , 0.7 ]) c2 = plt.colorbar(cntrl2, cax = cbar_ax2, orientation = 'vertical' ) c2.ax.tick_params(labelsize = TickLabel) c2.set_label( r' $ \\| \\m athcal{D}_{ij} \\|\\t au_{ \\ gamma} $ ' , fontsize = AxesLabel, labelpad = 10 ) ax.axis( 'off' ) # Save with higher DPI and specific backend plt.savefig(name, bbox_inches = \"tight\" , dpi = 150 , backend = 'agg' ) plt.close() def main(): # Get number of CPUs from command line argument, or use all available import argparse parser = argparse.ArgumentParser() parser.add_argument( '--CPUs' , type = int , default = mp.cpu_count(), help = 'Number of CPUs to use' ) parser.add_argument( '--nGFS' , type = int , default = 256 , help = 'Number of restart files to process' ) parser.add_argument( '--ZMAX' , type = float , default = 1.0 , help = 'Maximum Z value' ) parser.add_argument( '--RMAX' , type = float , default = 4.0 , help = 'Maximum R value' ) parser.add_argument( '--ZMIN' , type = float , default =- 3.0 , help = 'Minimum Z value' ) parser.add_argument( '--RMIN' , type = float , default = 0.0 , help = 'Minimum R value' ) parser.add_argument( '--caseToProcess' , type = str , default = '../testCases/burstingBubbleHB' , help = 'Case to process' ) args = parser.parse_args() CPUStoUse = args.CPUs nGFS = args.nGFS ZMAX = args.ZMAX RMAX = args.RMAX ZMIN = args.ZMIN RMIN = args.RMIN caseToProcess = args.caseToProcess num_processes = CPUStoUse rmin, rmax, zmin, zmax = [RMIN, RMAX, ZMIN, ZMAX] GridsPerR = 128 lw = 2 folder = 'Video' if not os.path.isdir(folder): os.makedirs(folder) # Create a pool of worker processes with mp.Pool(processes = num_processes) as pool: # Create partial function with fixed arguments process_func = partial(process_timestep, caseToProcess = caseToProcess, folder = folder, nGFS = nGFS, GridsPerR = GridsPerR, rmin = rmin, rmax = rmax, zmin = zmin, zmax = zmax, lw = lw) # Map the process_func to all timesteps pool. map (process_func, range (nGFS)) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/video.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/video.py | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: # Author: Vatsal...",
    "content": "# Author: Vatsal Sanjay# vatsalsanjay@gmail.com# Physics of Fluids# Last updated: Dec 24, 2024importnumpyasnpimportosimportsubprocessasspimportmatplotlibmatplotlib.use('Agg')# Use non-interactive backendimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportmultiprocessingasmpfromfunctoolsimportpartialimportargparseimportmatplotlib.colorsasmcolorscustom_colors=[\"white\",\"#DA8A67\",\"#A0522D\",\"#400000\"]custom_cmap=mcolors.LinearSegmentedColormap.from_list(\"custom_hot\", custom_colors)# Set up matplotlib configurationplt.rcParams['text.usetex']=Trueplt.rcParams['font.family']='serif'plt.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}\\usepackage{amssymb}'plt.rcParams['mathtext.fontset']='cm'plt.rcParams['font.serif']=['Computer Modern Roman']+plt.rcParams['font.serif']defgettingFacets(filename):exe=[\"./getFacets\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, rmin, zmax, rmax, nr):exe=[\"./getData\", filename,str(zmin),str(rmin),str(zmax),str(rmax),str(nr)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp=[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))returnR, Z, D2, vel, nz# ----------------------------------------------------------------------------------------------------------------------defprocess_timestep(ti, caseToProcess, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw):t=0.01*tiplace=f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\"name=f\"{folder}/{int(t*1000):08d}.png\"ifnotos.path.exists(place):print(f\"{place}File not found!\")returnifos.path.exists(name):print(f\"{name}Image present!\")return# --- Gather interface segments and field data as before ---segs=gettingFacets(place)nr=int(GridsPerR*rmax)R, Z, D2, vel, nz=gettingfield(place, zmin, rmin, zmax, rmax, nr)[xminp, xmaxp, yminp, ymaxp]=R.min(), R.max(), Z.min(), Z.max()extent_vel=[-xminp,-xmaxp, yminp, ymaxp]extent_D2=[xminp, xmaxp, yminp, ymaxp]AxesLabel, TickLabel=30,20fig, ax=plt.subplots(1,1, figsize=(19.20,10.80))ax.plot([-rmax, rmax], [0,0],'--', color='grey', linewidth=lw)# \"horizontal\" axis is zax.plot([0,0], [zmin, zmax],'-.', color='grey', linewidth=lw)# \"vertical\" axis is r# Domain box:ax.plot([-rmax, rmax], [zmin, zmin],'-', color='black', linewidth=lw)ax.plot([-rmax, rmax], [zmax, zmax],'-', color='black', linewidth=lw)ax.plot([-rmax,-rmax], [zmin, zmax],'-', color='black', linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-', color='black', linewidth=lw)line_segments=LineCollection(segs, linewidths=4, colors='green')ax.add_collection(line_segments)# ----------------------------------------------------------# Now show imshow with the rotated arrays and extents:# ----------------------------------------------------------cntrl1=ax.imshow(vel,cmap=\"Blues\",interpolation='bilinear',origin='lower',extent=extent_vel,vmin=0.0,vmax=4e0)cntrl2=ax.imshow(D2,cmap=\"hot_r\",interpolation='bilinear',origin='lower',extent=extent_D2,vmin=-3e0,vmax=2e0)# Equal aspect ensures squares in the new orientationax.set_aspect('equal')ax.set_xlim(-rmax, rmax)# x rangeax.set_ylim(zmin, zmax)# y range# Titles and labels that match the new orientationax.set_title(fr'$t/\\tau_{{\\gamma}}={t:.4f}$', fontsize=TickLabel)# Colorbars: place them closer to the plot edgesfig.subplots_adjust(left=0.1, right=0.9)# adjust spacing for vertical colorbars# Left colorbarcbar_ax1=fig.add_axes([0.07,0.15,0.02,0.7])# x,y,width,height in figure coordsc1=plt.colorbar(cntrl1, cax=cbar_ax1, orientation='vertical')c1.ax.tick_params(labelsize=TickLabel)c1.set_label(r'$\\|u_i\\|/V_{\\gamma}$', fontsize=AxesLabel, labelpad=10, rotation=90, position=(0,0.5))c1.ax.yaxis.set_label_position('left')c1.ax.yaxis.set_ticks_position('left')# Move ticks to left sidec1.ax.tick_params(axis='y', labelright=False, labelleft=True)# Move tick labels to left side# Right colorbarcbar_ax2=fig.add_axes([0.92,0.15,0.02,0.7])c2=plt.colorbar(cntrl2, cax=cbar_ax2, orientation='vertical')c2.ax.tick_params(labelsize=TickLabel)c2.set_label(r'$\\|\\mathcal{D}_{ij}\\|\\tau_{\\gamma}$', fontsize=AxesLabel, labelpad=10)ax.axis('off')# Save with higher DPI and specific backendplt.savefig(name, bbox_inches=\"tight\", dpi=150, backend='agg')plt.close()defmain():# Get number of CPUs from command line argument, or use all availableimportargparseparser=argparse.ArgumentParser()parser.add_argument('--CPUs',type=int, default=mp.cpu_count(),help='Number of CPUs to use')parser.add_argument('--nGFS',type=int, default=256,help='Number of restart files to process')parser.add_argument('--ZMAX',type=float, default=1.0,help='Maximum Z value')parser.add_argument('--RMAX',type=float, default=4.0,help='Maximum R value')parser.add_argument('--ZMIN',type=float, default=-3.0,help='Minimum Z value')parser.add_argument('--RMIN',type=float, default=0.0,help='Minimum R value')parser.add_argument('--caseToProcess',type=str, default='../testCases/burstingBubbleHB',help='Case to process')args=parser.parse_args()CPUStoUse=args.CPUsnGFS=args.nGFSZMAX=args.ZMAXRMAX=args.RMAXZMIN=args.ZMINRMIN=args.RMINcaseToProcess=args.caseToProcessnum_processes=CPUStoUsermin, rmax, zmin, zmax=[RMIN, RMAX, ZMIN, ZMAX]GridsPerR=128lw=2folder='Video'ifnotos.path.isdir(folder):os.makedirs(folder)# Create a pool of worker processeswithmp.Pool(processes=num_processes)aspool:# Create partial function with fixed argumentsprocess_func=partial(process_timestep, caseToProcess=caseToProcess,folder=folder, nGFS=nGFS,GridsPerR=GridsPerR, rmin=rmin, rmax=rmax,zmin=zmin, zmax=zmax, lw=lw)# Map the process_func to all timestepspool.map(process_func,range(nGFS))if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/video.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "postProcess/getData.c See raw file Fluid Simulation Data Extraction This program extracts and processes data from fluid dynamics simulation snapshots. It calculates key fluid mechanics quantities like strain rate tensor invariants and velocity magnitudes from simulation output files. Physical Background The code analyzes the spatial derivatives of velocity fields to compute the second invariant of the strain rate tensor, which is an important quantity for identifying vortical structures in fluid flows. Additionally, it calculates velocity magnitudes throughout the flow field. The strain rate tensor is a fundamental quantity in fluid mechanics that describes the rate of deformation of fluid elements. Its second invariant is particularly useful for identifying regions of strong vorticity and shear, making it valuable for visualizing coherent structures in turbulent flows.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "Usage ./program filename xmin ymin xmax ymax ny filename: Path to simulation snapshot file xmin, ymin: Minimum coordinates of the region of interest xmax, ymax: Maximum coordinates of the region of interest ny: Number of grid points in y-direction (resolution) @author Vatsal Sanjay @affiliation Physics of Fluids Group, University of Twente @email vatsalsanjay@gmail.com #include \"utils.h\" #include \"output.h\" scalar f []; // Volume fraction field vector u []; // Velocity field char filename [ 80 ]; int nx , ny , len ; double xmin , ymin , xmax , ymax , Deltax , Deltay ; scalar D2c [], vel []; // Derived fields scalar * list = NULL ; // List of fields to output Main Function Processes command line arguments, restores simulation data, computes derived quantities, and outputs results to a formatted file. a: Number of command line arguments arguments: Array of command line argument strings Returns exit status code int main ( int a , char const * arguments []) { // Parse command line arguments sprintf ( filename , \" %s \" , arguments [ 1 ]); xmin = atof ( arguments [ 2 ]); ymin = atof ( arguments [ 3 ]); xmax = atof ( arguments [ 4 ]); ymax = atof ( arguments [ 5 ]); ny = atoi ( arguments [ 6 ]); // Initialize list of fields to output list = list_add ( list , D2c ); list = list_add ( list , vel ); Data Processing Restores simulation data and calculates derived quantities at each point: D2c: Log10 of the second invariant of the strain rate tensor vel: Velocity magnitude field The strain rate tensor components are computed using finite difference approximations of the velocity gradients. restore ( file = filename ); foreach () { // Calculate components of the strain rate tensor double D11 = ( u . y [ 0 , 1 ] - u . y [ 0 , - 1 ])/( 2 * Delta ); double D22 = ( u . y []/ y ); double D33 = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2 * Delta ); double D13 = 0.5 * (( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 , - 1 ])/( 2 * Delta )); // Calculate the second invariant double D2 = ( sq ( D11 ) + sq ( D22 ) + sq ( D33 ) + 2.0 * sq ( D13 )); D2c [] = f [] * sqrt ( D2 / 2.0 ); // Convert to log scale for better visualization if ( D2c [] > 0. ) { D2c [] = log ( D2c [])/ log ( 10 ); } else { D2c [] = - 10 ; // Floor value for zero or negative values } // Calculate velocity magnitude vel [] = f [] * sqrt ( sq ( u . x []) + sq ( u . y [])); } Data Output This section handles the output of processed data: Calculates the mesh dimensions based on user-specified bounds Interpolates field values onto a regular grid Writes output data to a formatted text file The output format is a space-separated values file with columns: x-coordinate, y-coordinate, followed by values of each field in \u2018list\u2019.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: FILE * fp...",
    "content": "FILE * fp = ferr ; // Calculate grid spacing and dimensions Deltay = ( double )(( ymax - ymin )/( ny )); nx = ( int )(( xmax - xmin )/ Deltay ); Deltax = ( double )(( xmax - xmin )/( nx )); len = list_len ( list ); // Allocate memory for interpolated field values double ** field = ( double **) matrix_new ( nx , ny + 1 , len * sizeof ( double )); // Interpolate field values onto regular grid for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , x , y ); } } } // Write interpolated data to output file for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; fprintf ( fp , \" %g %g \" , x , y ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } // Clean up resources fflush ( fp ); fclose ( fp ); matrix_free ( field ); }",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"scalar f[];// Volume fraction fieldvector u[];// Velocity fieldcharfilename[80];intnx,ny,len;doublexmin,ymin,xmax,ymax,Deltax,Deltay;scalar D2c[],vel[];// Derived fieldsscalar*list=NULL;// List of fields to output",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){// Parse command line argumentssprintf(filename,\"%s\",arguments[1]);xmin=atof(arguments[2]);ymin=atof(arguments[3]);xmax=atof(arguments[4]);ymax=atof(arguments[5]);ny=atoi(arguments[6]);// Initialize list of fields to outputlist=list_add(list,D2c);list=list_add(list,vel);",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: restore(file=filename);foreach(){// Calculate components...",
    "content": "restore(file=filename);foreach(){// Calculate components of the strain rate tensordoubleD11=(u.y[0,1]-u.y[0,-1])/(2*Delta);doubleD22=(u.y[]/y);doubleD33=(u.x[1,0]-u.x[-1,0])/(2*Delta);doubleD13=0.5*((u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(2*Delta));// Calculate the second invariantdoubleD2=(sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13));D2c[]=f[]*sqrt(D2/2.0);// Convert to log scale for better visualizationif(D2c[]>0.){D2c[]=log(D2c[])/log(10);}else{D2c[]=-10;// Floor value for zero or negative values}// Calculate velocity magnitudevel[]=f[]*sqrt(sq(u.x[])+sq(u.y[]));}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: FILE*fp=ferr;// Calculate grid...",
    "content": "FILE*fp=ferr;// Calculate grid spacing and dimensionsDeltay=(double)((ymax-ymin)/(ny));nx=(int)((xmax-xmin)/Deltay);Deltax=(double)((xmax-xmin)/(nx));len=list_len(list);// Allocate memory for interpolated field valuesdouble**field=(double**)matrix_new(nx,ny+1,len*sizeof(double));// Interpolate field values onto regular gridfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,x,y);}}}// Write interpolated data to output filefor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;fprintf(fp,\"%g%g\",x,y);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}// Clean up resourcesfflush(fp);fclose(fp);matrix_free(field);}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles",
    "content": "simulationCases/Makefile See raw file Makefile # Check if .project_config exists ifeq ( \\$ ( wildcard ../.project_config ) , ) \\$ ( error \"../.project_config not found\" ) endif BASILISK := \\$ ( shell . ../.project_config && echo \\$\\$ BASILISK ) CFLAGS += -O2 -disable-dimensions CFLAGS += -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local # Fix permissions for runtest script fix-permissions: @chmod +x \\$ ( BASILISK ) /src/runtest # Make all test targets depend on fix-permissions %.tst: fix-permissions include \\$ ( BASILISK ) /Makefile.defs",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/Makefile.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "# Check if .project_config existsifeq(\\$(wildcard../.project_config),)\\$(error\"../.project_config not found\")endifBASILISK:=\\$(shell. ../.project_config&&echo\\$\\$BASILISK)CFLAGS+=-O2-disable-dimensionsCFLAGS+=-I\\$(PWD)/src-local-I\\$(PWD)/../src-local# Fix permissions for runtest scriptfix-permissions:@chmod+x\\$(BASILISK)/src/runtest# Make all test targets depend on fix-permissions%.tst:fix-permissionsinclude\\$(BASILISK)/Makefile.defs",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/Makefile.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "simulationCases/burstingBubbleHB.c See raw file Bursting Bubbles in Herschel-Bulkley Media Simulation This simulation models the dynamics of bursting bubbles in Herschel-Bulkley media, with particular focus on Worthington jet formation and droplet ejection. The code implements a two-phase flow model with non-Newtonian rheology using an epsilon-regularisation approach.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: File Information File:...",
    "content": "File Information File: burstingBubbleHB.c Author: Vatsal Sanjay Version: 1.0 Date: Dec 31, 2024 Usage ./program maxLevel n OhK J Bond tmax Parameters maxLevel : Maximum refinement level for adaptive mesh n : Power-law index OhK : k-effective Ohnesorge number for the liquid phase: \\(Oh_k = \\frac{k}{\\sqrt{\\rho^nR_0^{3n-1}\\gamma^{2-n}}}\\) J : Plasto-capillary number: \\(\\mathcal{J} = \\frac{\\tau_yR_0}{\\gamma}\\) Bond : Bond number (ratio of gravitational to surface tension forces): \\(Bo = \\frac{\\rho g R_0^2}{\\gamma}\\) tmax : Maximum simulation time #include \"axi.h\" #include \"navier-stokes/centered.h\" Simulation Configuration Global Parameters FILTERED : Enable density and viscosity jump smoothing tsnap : Time interval between snapshots (default: 1e-2) fErr : Error tolerance for volume fraction (1e-3) KErr : Error tolerance for curvature calculation (1e-6) VelErr : Error tolerance for velocity field (1e-3) D2Err : Error tolerance for conformation inside the liquid (1e-2) Ldomain : Domain size in characteristic lengths (8) #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVP-HB.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"reduced.h\" #if !_MPI #include \"distance.h\" #endif #define tsnap ( 1e-2 ) // 0.001 only for some cases. // Error tolerances #define fErr ( 1e-3 ) // Error tolerance in f1 VOF #define KErr ( 1e-6 ) // Error tolerance in VoF curvature calculated using // height function method (see adapt event) #define VelErr ( 1e-3 ) // Error tolerances in velocity -- Use 1e-2 for low Oh // and 1e-3 to 5e-3 for high Oh/moderate to high J #define D2Err ( 1e-2 ) // Error tolerances in conformation inside the liquid // Domain size #define Ldomain 8 66 // Boundary conditions - outflow on the right boundary u . n [ right ] = neumann ( 0. ); p [ right ] = dirichlet ( 0. ); int MAXlevel ; double OhK , Oha , J , Bond , tmax ; char nameOut [ 80 ], dumpFile [ 80 ], logFile [ 80 ]; Main Function The entry point of the simulation that initializes parameters and starts the simulation run.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Main",
    "content": "Parameters argc : Number of command line arguments argv : Array of command line argument strings Returns Integer status code (0 on successful completion) int main ( int argc , char const * argv []) { L0 = Ldomain ; origin (- L0 / 2. , 0. ); Parameter Initialization Setting default values for simulation parameters. In production runs, these values can be passed from the command line. MAXlevel = 10 ; n = 0.4 ; OhK = 0.001 ; J = 2e-1 ; Bond = 1.1 ; G . x = - Bond ; tmax = 2.5e0 ; epsilon = 1e-2 ; Command Line Argument Parsing To get parameters from the terminal, uncomment the following block. // First ensure that all the variables were transferred properly from the // terminal or job script. if ( argc < 7 ) { fprintf ( ferr , \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Need %d more...",
    "content": "Need %d more \" \"arguments \\n \" , 7 - argc ); return 1 ; } MAXlevel = atoi ( argv [ 1 ]); n = atof ( argv [ 2 ]); OhK = atof ( argv [ 3 ]); J = atof ( argv [ 4 ]); Bond = atof ( argv [ 5 ]); tmax = atof ( argv [ 6 ]); epsilon = 1e-2 ; init_grid ( 1 << 5 ); // Create a folder named intermediate where all the simulation snapshots are stored char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file. See writingFiles event sprintf ( dumpFile , \"restart\" ); // Name of the log file.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: See logWriting event...",
    "content": "See logWriting event sprintf ( logFile , \"logData.dat\" ); Physical Properties Configuration Phase Properties rho1 , rho2 : Density of liquid and gas phases mu1 , mu2 : Dynamic viscosity of liquid and gas phases Dimensionless Numbers Oh : Ohnesorge number for liquid phase Oha : Ohnesorge number for gas phase (= 2e-2 * Oh) J : Plasto-capillary number Bond : Bond number rho1 = 1. , rho2 = 1e-3 ; Oha = 2e-2 * OhK ; mu1 = OhK , mu2 = Oha ; tauy = J ; f . sigma = 1.0 ; TOLERANCE = 1e-4 ; CFL = 1e-1 ; run (); } Initialization Event Sets up the initial conditions for the simulation at t=0.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Function Definition",
    "content": "Process Attempts to restore from a dump file If not available, loads initial shape from data file Sets up distance function and volume fraction event init ( t = 0 ) { #if _MPI // This is for supercomputers without OpenMP support if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else if (! restore ( file = dumpFile )) { char filename [ 60 ]; // sprintf(filename,\"Bo%5.4f-buggy.dat\",Bond); // sprintf(filename,\"Bo%5.4f.dat\",Bond); sprintf ( filename , \"Bo %5.4f -buggy_fixed.dat\" , Bond ); FILE * fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); // Try in folder one level up // sprintf(filename,\"../Bo%5.4f-buggy.dat\",Bond); // sprintf(filename,\"../Bo%5.4f.dat\",Bond); sprintf ( filename , \"../Bo %5.4f -buggy_fixed.dat\" , Bond ); fp = fopen ( filename , \"rb\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); return 1 ; } } coord * InitialShape ; InitialShape = input_xy ( fp ); fclose ( fp ); scalar d []; distance ( d , InitialShape ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-8 , 1e-8 }, MAXlevel ). nf ); // The distance function is defined at the center of each cell, we have // to calculate the value of this function at each vertex. vertex scalar phi []; foreach_vertex () { phi [] = -( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ])/ 4. ; } // We can now initialize the volume fraction of the domain. fractions ( phi , f ); } // return 1; #endif } Adaptive Mesh Refinement Implements wavelet-based adaptive mesh refinement to focus computational resources on areas of interest.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: JavaScript",
    "content": "Refinement Criteria Volume fraction gradient Velocity field changes Conformation tensor variations Curvature details event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , u . x , u . y , D2 , KAPPA }, ( double []){ fErr , VelErr , VelErr , D2Err , KErr }, MAXlevel , MAXlevel - 6 ); } Output Generation Periodically saves simulation state for post-processing and creates snapshots at regular intervals.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Output Files Restart...",
    "content": "Output Files Restart file for continuing simulations Snapshot files for visualization and analysis event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Simulation Termination Executes when the simulation reaches its end time, displaying a summary of key simulation parameters. event end ( t = end ) { if ( pid () == 0 ) fprintf ( ferr , \"Level %d , n %2.1e , OhK %2.1e , Oha %2.1e , J %4.3f , \" \"Bo %4.3f\\n \" , MAXlevel , n , OhK , Oha , J , Bond ); } Simulation Monitoring Tracks key metrics like kinetic energy during simulation and logs to file.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Features Calculates total...",
    "content": "Features Calculates total kinetic energy Logs simulation progress Implements safety checks to stop simulation if instabilities occur event logWriting ( i ++) { // if (i > 5){ // FILE * ftest = fopen(\"test.txt\", \"w\"); // output_facets(f, ftest); // return 1;} double ke = 0. ; foreach ( reduction (+: ke )) { ke += ( 2 * pi * y )*( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); } if ( pid () == 0 ) { static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"Level %d , n %2.1e , OhK %2.1e , Oha %2.1e , J %4.3f , \" \"Bo %4.3f\\n \" , MAXlevel , n , OhK , Oha , J , Bond ); fprintf ( ferr , \"i dt t ke \\n \" ); fp = fopen ( logFile , \"w\" ); fprintf ( fp , \"Level %d , n %2.1e , OhK %2.1e , Oha %2.1e , J %4.3f , \" \"Bo %4.3f\\n \" , MAXlevel , n , OhK , Oha , J , Bond ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( logFile , \"a\" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); assert ( ke > - 1e-10 ); if ( ke > 1e2 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" ); fp = fopen ( logFile , \"a\" ); fprintf ( fp , \"The kinetic energy blew up. Stopping simulation \\n \" ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } assert ( ke < 1e2 ); if ( ke < 1e-6 && i > 1e1 ) { if ( pid () == 0 ) { fprintf ( ferr , \"Kinetic energy too small now! Stopping! \\n \" ); dump ( file = dumpFile ); fp = fopen ( logFile , \"a\" ); fprintf ( fp , \"Kinetic energy too small now! Stopping! \\n \" ); fclose ( fp ); return 1 ; } } } }",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code: C/C++ Code",
    "content": "#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVP-HB.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include\"reduced.h\"#if !_MPI#include\"distance.h\"#endif#define tsnap(1e-2)// 0.001 only for some cases.// Error tolerances#define fErr(1e-3)// Error tolerance in f1 VOF#define KErr(1e-6)// Error tolerance in VoF curvature calculated using// height function method (see adapt event)#define VelErr(1e-3)// Error tolerances in velocity -- Use 1e-2 for low Oh// and 1e-3 to 5e-3 for high Oh/moderate to high J#define D2Err(1e-2)// Error tolerances in conformation inside the liquid// Domain size#define Ldomain866// Boundary conditions - outflow on the right boundaryu.n[right]=neumann(0.);p[right]=dirichlet(0.);intMAXlevel;doubleOhK,Oha,J,Bond,tmax;charnameOut[80],dumpFile[80],logFile[80];",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "intmain(intargc,charconst*argv[]){L0=Ldomain;origin(-L0/2.,0.);",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "MAXlevel=10;n=0.4;OhK=0.001;J=2e-1;Bond=1.1;G.x=-Bond;tmax=2.5e0;epsilon=1e-2;",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "// First ensure that all the variables were transferred properly from the// terminal or job script.if(argc<7){fprintf(ferr,\"Lack of command line arguments. Check! Need%dmore \"\"arguments\\n\",7-argc);return1;}MAXlevel=atoi(argv[1]);n=atof(argv[2]);OhK=atof(argv[3]);J=atof(argv[4]);Bond=atof(argv[5]);tmax=atof(argv[6]);epsilon=1e-2;",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "init_grid(1<<5);// Create a folder named intermediate where all the simulation snapshots are storedcharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file. See writingFiles eventsprintf(dumpFile,\"restart\");// Name of the log file. See logWriting eventsprintf(logFile,\"logData.dat\");",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "rho1=1.,rho2=1e-3;Oha=2e-2*OhK;mu1=OhK,mu2=Oha;tauy=J;f.sigma=1.0;TOLERANCE=1e-4;CFL=1e-1;run();}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event init(t=0){#if _MPI//...",
    "content": "event init(t=0){#if _MPI// This is for supercomputers without OpenMP supportif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#elseif(!restore(file=dumpFile)){charfilename[60];// sprintf(filename,\"Bo%5.4f-buggy.dat\",Bond);// sprintf(filename,\"Bo%5.4f.dat\",Bond);sprintf(filename,\"Bo%5.4f-buggy_fixed.dat\",Bond);FILE*fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);// Try in folder one level up// sprintf(filename,\"../Bo%5.4f-buggy.dat\",Bond);// sprintf(filename,\"../Bo%5.4f.dat\",Bond);sprintf(filename,\"../Bo%5.4f-buggy_fixed.dat\",Bond);fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);return1;}}coord*InitialShape;InitialShape=input_xy(fp);fclose(fp);scalar d[];distance(d,InitialShape);while(adapt_wavelet((scalar*){f,d},(double[]){1e-8,1e-8},MAXlevel).nf);// The distance function is defined at the center of each cell, we have// to calculate the value of this function at each vertex.vertex scalar phi[];foreach_vertex(){phi[]=-(d[]+d[-1]+d[0,-1]+d[-1,-1])/4.;}// We can now initialize the volume fraction of the domain.fractions(phi,f);}// return 1;#endif}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,u.x,u.y,D2,KAPPA},(double[]){fErr,VelErr,VelErr,D2Err,KErr},MAXlevel,MAXlevel-6);}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "event end(t=end){if(pid()==0)fprintf(ferr,\"Level%d, n%2.1e, OhK%2.1e, Oha%2.1e, J%4.3f, \"\"Bo%4.3f\\n\",MAXlevel,n,OhK,Oha,J,Bond);}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: event logWriting(i++){// if...",
    "content": "event logWriting(i++){// if (i > 5){// FILE * ftest = fopen(\"test.txt\", \"w\");// output_facets(f, ftest);// return 1;}doubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])))*sq(Delta);}if(pid()==0){staticFILE*fp;if(i==0){fprintf(ferr,\"Level%d, n%2.1e, OhK%2.1e, Oha%2.1e, J%4.3f, \"\"Bo%4.3f\\n\",MAXlevel,n,OhK,Oha,J,Bond);fprintf(ferr,\"i dt t ke\\n\");fp=fopen(logFile,\"w\");fprintf(fp,\"Level%d, n%2.1e, OhK%2.1e, Oha%2.1e, J%4.3f, \"\"Bo%4.3f\\n\",MAXlevel,n,OhK,Oha,J,Bond);fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(logFile,\"a\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);assert(ke>-1e-10);if(ke>1e2&&i>1e1){if(pid()==0){fprintf(ferr,\"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/burstingBubbleHB.c | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Stopping simulation\\n\");fp=fopen(logFile,\"a\");fprintf(fp,\"The kinetic...",
    "content": "Stopping simulation\\n\");fp=fopen(logFile,\"a\");fprintf(fp,\"The kinetic energy blew up. Stopping simulation\\n\");fclose(fp);dump(file=dumpFile);return1;}}assert(ke<1e2);if(ke<1e-6&&i>1e1){if(pid()==0){fprintf(ferr,\"Kinetic energy too small now! Stopping!\\n\");dump(file=dumpFile);fp=fopen(logFile,\"a\");fprintf(fp,\"Kinetic energy too small now! Stopping!\\n\");fclose(fp);return1;}}}}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/burstingBubbleHB.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases burstingBubbleHB.c This simulation models the dynamics of bursting bubbles in Herschel-Bulkley media, with particular focus on Worthingt... initial-condition-test.ipynb The basilisk script needs the points to be sorted such that the first point is the south pole of the bubble cavity th... Makefile ifeq (\\$(wildcard ../.projectconfig),) \\$(error '../.projectconfig not found') endif BASILISK := \\$(shell . ../.proje... runMake.sh source ../.projectconfig echo \\$BASILISK mkdir -p \\$1 qcc -O2 -Wall -disable-dimensions -I\\$(PWD)/src-local -I\\$(PWD)...",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runMake.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles",
    "content": "simulationCases/runMake.sh See raw file runMake.sh #!/bin/bash source ../.project_config echo \\$ BASILISK mkdir -p \\$ 1 qcc -O2 -Wall -disable-dimensions -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local \\$ 1.c -o \\$ 1/\\$1 -lm cd \\$ 1 ./\\$1",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/runMake.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runMake.sh | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "#!/bin/bashsource../.project_configecho\\$BASILISKmkdir-p\\$1qcc-O2-Wall-disable-dimensions-I\\$(PWD)/src-local-I\\$(PWD)/../src-local\\$1.c-o\\$1/\\$1-lmcd\\$1./\\$1",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/runMake.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/initial-condition-test.ipynb | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "simulationCases/initial-condition-test.ipynb See raw file Reverse engineer to fix bug Jupyter Notebook: Reverse engineer to fix bug Download Notebook View in nbviewer Open in Colab About this notebook The basilisk script needs the points to be sorted such that the first point is the south pole of the bubble cavity then you walk along the liquid-gas interface towards the bubble cap and then join to the far field liquid-gas interface (which is a straight line). Key Features: Visualization of data and results Analysis of simulation outputs Interactive exploration of parameters Tip: For the best interactive experience, download the notebook or open it in Google Colab. Notebook Preview Notebook Preview Unavailable The notebook preview could not be loaded.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/initial-condition-test.ipynb.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/initial-condition-test.ipynb | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: This may be...",
    "content": "This may be because: The notebook file is not yet available in the repository The nbviewer service is temporarily unavailable The repository is private or has access restrictions You can still download the notebook using the button above or view it directly through one of the external services.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/simulationCases/initial-condition-test.ipynb.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files two-phaseVP-HB.h This is a modified version of [two-phase.h](http://basilisk.fr/src/two-phase.h). It contains the implementation of Vi...",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "src-local/two-phaseVP-HB.h See raw file Modification by Vatsal Sanjay Version 4.0, Jan 1, 2025 Changelog Jan 1, 2025 (v4.0) There was a bug in calculation of D2 which would trigger while using parallel computing only. This has been fixed. Dec 31, 2024 (v3.5) Added the Herschel-Bulkley formulation. n = 1 recovers the Bingham formulation. n = 1, tau_y = 0 recovers the Newtonian formulation. Oct 11, 2024 (v2.0) Using the epsilon formulation for the viscoplastic fluid. Unified the code to handle both planar and axi-symmetric cases seamlessly. This eliminates the need for a separate codebase when switching to axi-symmetric formulations. Only fluid 1 can be viscoplastic, fluid 2 is always Newtonian.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Context",
    "content": "Brief history: v0.0 is of course the original code on http://basilisk.fr/src/two-phase.h valid for Newtonian fluids. v1.0 is the modification for viscoplastic fluids using the min(temp, mumax) formulation where one needed to use a separate codebase for axi-symmetric cases (see: git@github.com:VatsalSy/Bursting-Bubble-In-a-Viscoplastic-Medium.git). v2.0 is the modification for viscoplastic fluids using the epsilon formulation (this code) where I also unified the code to handle both planar and axi-symmetric cases seamlessly. Two-phase interfacial flows This is a modified version of two-phase.h . It contains the implementation of Viscoplastic Fluid (Bingham Fluid). This file helps setup simulations for flows of two fluids separated by an interface (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. #include \"vof.h\" scalar f [], * interfaces = { f }; scalar D2 []; face vector D2f []; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. ; double epsilon = 1e-6 , tauy = 0. , n = 1. ; Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho # define rho ( f ) ( clamp ( f , 0. , 1. )*( rho1 - rho2 ) + rho2 ) 66 #endif #ifndef mu // for Arithmetic mean, use this // # define mu(muTemp, mu2, f) (clamp(f,0.,1.)*(muTemp - mu2) + mu2) // for Harmonic mean, use this # define mu ( muTemp , mu2 , f ) ( 1.0 / (( clamp ( f , 0. , 1. ) / muTemp ) + (( 1.0 - clamp ( f , 0. , 1. )) / mu2 ))) 72 #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf []; #else # define sf f 82 #endif event tracer_advection ( i ++) { When using smearing of the density jump, we initialise sf with the vertex-average of f . #ifndef sf #if dimension <= foreach () sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; #else // dimension == foreach () sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; #endif #endif #if TREE sf . prolongation = refine_bilinear ; sf . dirty = true ; // boundary conditions need to be updated #endif } event properties ( i ++) { This is the part where we have made changes. # Herschel\u2013Bulkley formulation for non-Newtonian flows ## Features: * Yield stress \\(\\tau_y\\) * Power law dependance on the strain rate * Shear thinning for \\(n < 1\\) . * Shear thickening for \\(n > 1\\) . * Bingham model for \\(n = 1\\) . * Newtonian fluid for \\(n = 1\\) and \\(\\tau_y = 0\\) . \\(\\varepsilon\\) -formulation \\[ \\boldsymbol{\\tau} = \\tau_{y}\\,\\boldsymbol{\\mathcal{I}} \\;+\\; K\\left(2\\boldsymbol{\\mathcal{D}}\\right)^{n} = 2\\biggl[\\frac{\\tau_{y}}{2\\|\\boldsymbol{\\mathcal{D}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + K\\,\\bigl(2\\|\\boldsymbol{\\mathcal{D}}\\|+\\epsilon\\bigr)^{n-1} \\biggr]\\boldsymbol{\\mathcal{D}}. \\] Normalizing stresses with \\(\\gamma/R_0\\) , length with \\(R_0\\) , and velocity with \\(\\sqrt{\\gamma/\\rho_lR_0}\\) \u2026 \\[ \\boldsymbol{\\tilde{\\tau}} = 2\\biggl[\\frac{\\mathcal{J}}{2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + Oh_K\\,\\bigl(2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\epsilon\\bigr)^{n-1} \\biggr]\\boldsymbol{\\tilde{\\mathcal{D}}}. \\] Here, the effective Ohnesorge is \\[ Oh_K = \\frac{K}{\\sqrt{\\rho_l^n\\gamma^{2-n}R_0^{3n-2}}} \\] One can easily see that putting \\(n = 1\\) recovers the Bingham model with \\(Oh = \\eta_l/\\sqrt{\\rho_l\\gamma R_0}\\) .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Additionally, with \\(n...",
    "content": "Additionally, with \\(n = 1\\) & \\(\\mathcal{J}\\) = 0, the model will give a Newtonian response.",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: More details on...",
    "content": "More details on the implementation Calculate the norm of the deformation tensor \\(\\boldsymbol{\\mathcal{D}}\\) : \\[\\mathcal{D}_{11} = \\frac{\\partial u_r}{\\partial r}\\] \\[\\mathcal{D}_{22} = \\frac{u_r}{r}\\] \\[\\mathcal{D}_{13} = \\frac{1}{2}\\left( \\frac{\\partial u_r}{\\partial z}+ \\frac{\\partial u_z}{\\partial r}\\right)\\] \\[\\mathcal{D}_{31} = \\frac{1}{2}\\left( \\frac{\\partial u_z}{\\partial r}+ \\frac{\\partial u_r}{\\partial z}\\right)\\] \\[\\mathcal{D}_{33} = \\frac{\\partial u_z}{\\partial z}\\] \\[\\mathcal{D}_{12} = \\mathcal{D}_{23} = 0.\\] The second invariant is \\(\\mathcal{D}_2=\\sqrt{\\mathcal{D}_{ij}\\mathcal{D}_{ij}}\\) (this is the Frobenius norm) \\[\\mathcal{D}_2^2= \\mathcal{D}_{ij}\\mathcal{D}_{ij}= \\mathcal{D}_{11}\\mathcal{D}_{11} + \\mathcal{D}_{22}\\mathcal{D}_{22} + \\mathcal{D}_{13}\\mathcal{D}_{31} + \\mathcal{D}_{31}\\mathcal{D}_{13} + \\mathcal{D}_{33}\\mathcal{D}_{33}\\] Note: \\(\\|\\mathcal{D}\\| = D_2/\\sqrt{2}\\) .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: We use the...",
    "content": "We use the formulation as given in Balmforth et al. (2013) [@balmforthYieldingStressRecent2014] , who use the strain rate tensor \\(\\boldsymbol{\\dot{\\mathcal{S}}}\\) which and its norm \\(\\sqrt{\\frac{1}{2}\\dot{\\mathcal{S}_{ij}}\\dot{\\mathcal{S}_{ij}}}\\) . Of course, given \\(\\dot{\\mathcal{S}}_{ij}=2 D_{ij}\\) . Calculate the equivalent viscosity Factorizing with \\(2 \\mathcal{D}_{ij}\\) to obtain an equivalent viscosity \\[\\eta_{\\text{eff}} = \\frac{\\mathcal{J}}{2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\varepsilon}\\,\\boldsymbol{\\mathcal{I}} + Oh_K\\,\\bigl(2\\|\\boldsymbol{\\tilde{\\mathcal{D}}}\\|+\\epsilon\\bigr)^{n-1} \\] In this formulation, \\(\\varepsilon\\) is a small number to ensure numerical stability. The term \\[\\frac{\\tau_y}{\\varepsilon} + ...\\] is equivalent to the \\(\\mu_{max}\\) of the previous (v1.0, see: GitHub ) formulation [@sanjayBurstingBubbleViscoplastic2021] . Note: The fluid flows always, it is not a solid, but a very viscous fluid. Reproduced from: P.-Y. Lagr\u00e9e\u2019s Sandbox .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: Methods",
    "content": "Here, we use a face implementation of the regularisation method, described here . foreach_face ( x ) { double ff = ( sf [] + sf [- 1 ])/ 2. ; alphav . x [] = fm . x []/ rho ( ff ); double muTemp = mu1 ; face vector muv = mu ; double D2temp = 0. ; D2temp += sq ( 0.5 *( ( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ] + u . y [- 1 , 1 ] - u . y [- 1 ,- 1 ])/( 2. * Delta ) )); // D11 #if AXI D2temp += sq (( u . y [ 0 , 0 ] + u . y [- 1 , 0 ])/( 2 * max ( y , 1e-20 ))); // D22 #endif D2temp += sq (( u . x [] - u . x [- 1 , 0 ])/ Delta ); // D33 D2temp += 2.0 * sq ( 0.5 *( ( u . y [] - u . y [- 1 , 0 ])/ Delta + 0.5 *( ( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . x [- 1 , 1 ] - u . x [- 1 ,- 1 ])/( 2. * Delta ) ) )); // D13 D2temp = sqrt ( D2temp / 2.0 ); if ( tauy > 0. ){ muTemp = tauy /( 2.0 * D2temp + epsilon ) + mu1 * pow (( 2.0 * D2temp + epsilon ), n - 1 ); } muv . x [] = fm . x []* mu ( muTemp , mu2 , ff ); D2f . x [] = D2temp ; } foreach_face ( y ) { double ff = ( sf [ 0 , 0 ] + sf [ 0 ,- 1 ])/ 2. ; alphav . y [] = fm . y []/ rho ( ff ); double muTemp = mu1 ; face vector muv = mu ; double D2temp = 0. ; D2temp += sq (( u . y [ 0 , 0 ] - u . y [ 0 ,- 1 ])/ Delta ); // D11 #if AXI D2temp += sq (( u . y [ 0 , 0 ] + u . y [ 0 ,- 1 ])/( 2 * max ( y , 1e-20 ))); // D22 #endif D2temp += sq ( 0.5 *( ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ] + u . x [ 1 ,- 1 ] - u . x [- 1 ,- 1 ])/( 2. * Delta ) )); // D33 D2temp += 2.0 * sq ( 0.5 *( ( u . x [ 0 , 0 ] - u . x [ 0 ,- 1 ])/ Delta + 0.5 *( ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . y [ 1 ,- 1 ] - u . y [- 1 ,- 1 ])/( 2. * Delta ) ) )); // D13 D2temp = sqrt ( D2temp / 2.0 ); if ( tauy > 0. ){ muTemp = tauy /( 2.0 * D2temp + epsilon ) + mu1 * pow (( 2.0 * D2temp + epsilon ), n - 1 ); } muv . y [] = fm . y []* mu ( muTemp , mu2 , ff ); D2f . y [] = D2temp ; } #if dimension == error ( \"3D not implemented yet\" ); #endif I also calculate a cell-centered scalar D2, where I store \\(\\|\\mathbf{\\mathcal{D}}\\|\\) .",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles: This can also...",
    "content": "This can also be used for refimnement to accurately refine the fake-yield surfaces. foreach (){ rhov [] = cm []* rho ( sf []); D2 [] = f []*( D2f . x []+ D2f . y []+ D2f . x [ 1 , 0 ]+ D2f . y [ 0 , 1 ])/ 4. ; } #if TREE sf . prolongation = fraction_refine ; sf . dirty = true ; // boundary conditions need to be updated #endif }",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - C/C++ Code",
    "content": "#include\"vof.h\"scalar f[],*interfaces={f};scalar D2[];face vector D2f[];doublerho1=1.,mu1=0.,rho2=1.,mu2=0.;doubleepsilon=1e-6,tauy=0.,n=1.;",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "face vector alphav[];scalar rhov[];event defaults(i=0){alpha=alphav;rho=rhov;",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Function: rho",
    "content": "#ifndef rho# define rho(f)(clamp(f,0.,1.)*(rho1-rho2)+rho2)66#endif#ifndef mu// for Arithmetic mean, use this// # define mu(muTemp, mu2, f)  (clamp(f,0.,1.)*(muTemp - mu2) + mu2)// for Harmonic mean, use this# define mu(muTemp,mu2,f)(1.0/((clamp(f,0.,1.)/muTemp)+((1.0-clamp(f,0.,1.))/mu2)))72#endif",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf[];#else# define sf f82#endifevent tracer_advection(i++){",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Function: sf",
    "content": "#ifndef sf#if dimension <=foreach()sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;#else// dimension ==foreach()sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;#endif#endif#if TREEsf.prolongation=refine_bilinear;sf.dirty=true;// boundary conditions need to be updated#endif}event properties(i++){",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example: Context",
    "content": "foreach_face(x){doubleff=(sf[]+sf[-1])/2.;alphav.x[]=fm.x[]/rho(ff);doublemuTemp=mu1;face vector muv=mu;doubleD2temp=0.;D2temp+=sq(0.5*((u.y[0,1]-u.y[0,-1]+u.y[-1,1]-u.y[-1,-1])/(2.*Delta)));// D11#if AXID2temp+=sq((u.y[0,0]+u.y[-1,0])/(2*max(y,1e-20)));// D22#endifD2temp+=sq((u.x[]-u.x[-1,0])/Delta);// D33D2temp+=2.0*sq(0.5*((u.y[]-u.y[-1,0])/Delta+0.5*((u.x[0,1]-u.x[0,-1]+u.x[-1,1]-u.x[-1,-1])/(2.*Delta))));// D13D2temp=sqrt(D2temp/2.0);if(tauy>0.){muTemp=tauy/(2.0*D2temp+epsilon)+mu1*pow((2.0*D2temp+epsilon),n-1);}muv.x[]=fm.x[]*mu(muTemp,mu2,ff);D2f.x[]=D2temp;}foreach_face(y){doubleff=(sf[0,0]+sf[0,-1])/2.;alphav.y[]=fm.y[]/rho(ff);doublemuTemp=mu1;face vector muv=mu;doubleD2temp=0.;D2temp+=sq((u.y[0,0]-u.y[0,-1])/Delta);// D11#if AXID2temp+=sq((u.y[0,0]+u.y[0,-1])/(2*max(y,1e-20)));// D22#endifD2temp+=sq(0.5*((u.x[1,0]-u.x[-1,0]+u.x[1,-1]-u.x[-1,-1])/(2.*Delta)));// D33D2temp+=2.0*sq(0.5*((u.x[0,0]-u.x[0,-1])/Delta+0.5*((u.y[1,0]-u.y[-1,0]+u.y[1,-1]-u.y[-1,-1])/(2.*Delta))));// D13D2temp=sqrt(D2temp/2.0);if(tauy>0.){muTemp=tauy/(2.0*D2temp+epsilon)+mu1*pow((2.0*D2temp+epsilon),n-1);}muv.y[]=fm.y[]*mu(muTemp,mu2,ff);D2f.y[]=D2temp;}#if dimension ==error(\"3D not implemented yet\");#endif",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVP-HB.h | Herschel-Bulkley Worthington Jets & Droplets Produced by Bursting Bubbles - Code Example",
    "content": "foreach(){rhov[]=cm[]*rho(sf[]);D2[]=f[]*(D2f.x[]+D2f.y[]+D2f.x[1,0]+D2f.y[0,1])/4.;}#if TREEsf.prolongation=fraction_refine;sf.dirty=true;// boundary conditions need to be updated#endif}",
    "url": "https://comphy-lab.org/BurstingBubble_Herschel-Bulkley/src-local/two-phaseVP-HB.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # tested on MacOS only.",
    "url": "https://comphy-lab.org/soapy/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue. # modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to install basilisk install_basilisk() { darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make -k make } # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then echo \"Installing basilisk...\" rm -rf basilisk install_basilisk else echo \"Using existing basilisk installation...\" cd basilisk/src fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\\nChecking qcc installation...\" if ! qcc --version > /dev/null 2 >& 1 ; then echo \"\\033[0;31mError: qcc is not working properly.\\033[0m\" echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" echo \"For more details, visit: http://basilisk.fr/src/INSTALL\" exit 1 else echo \"\\033[0;32mqcc is properly installed.\\033[0m\" qcc --version fi",
    "url": "https://comphy-lab.org/soapy/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: #!/bin/zsh# tested on...",
    "content": "#!/bin/zsh# tested on MacOS only.",
    "url": "https://comphy-lab.org/soapy/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue.# modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basilisk# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to install basiliskinstall_basilisk(){darcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake-kmake}# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenecho\"Installing basilisk...\"rm-rfbasiliskinstall_basiliskelseecho\"Using existing basilisk installation...\"cdbasilisk/srcfi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\\nChecking qcc installation...\"if!qcc--version>/dev/null2>&1;thenecho\"\\033[0;31mError: qcc is not working properly.\\033[0m\"echo\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"echo\"For more details, visit: http://basilisk.fr/src/INSTALL\"exit1elseecho\"\\033[0;32mqcc is properly installed.\\033[0m\"qcc--versionfi",
    "url": "https://comphy-lab.org/soapy/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: SOAPY - Simulation...",
    "content": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films S imulation O f A xisymmetric P henomena in bubbl Y films High-fidelity simulations of soap bubble dynamics and wrinkling instabilities using Basilisk C. Research Overview This repository contains computational tools for studying the dynamics of thin liquid films forming bubbles, with a focus on wrinkling instabilities driven by surface tension and viscous effects.",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: The simulations solve...",
    "content": "The simulations solve the two-phase Navier-Stokes equations in axisymmetric configurations, capturing the complex interplay between: Surface tension-driven dynamics at the liquid-gas interface Viscous dissipation within the thin film Gravitational effects characterized by the Bond number Film thickness variations leading to instability formation Physical System The code models a soap bubble consisting of: - A thin liquid film (water with surfactants) - Surrounding gas phase (air) - Interface dynamics tracked using Volume-of-Fluid (VOF) method - Smoke tracer diffusion for flow visualization Key Dimensionless Parameters Ohnesorge number (Oh) : Ratio of viscous to inertio-capillary forces \\[\\text{Oh} = \\frac{\\mu}{\\sqrt{\\rho\\sigma R}}\\] Bond number (Bo) : Ratio of gravitational to surface tension forces \\[\\text{Bo} = \\frac{\\rho g R^2}{\\sigma}\\] P\u00e9clet number (Pe) : Ratio of advective to diffusive transport \\[\\text{Pe} = \\frac{V_\\gamma R}{D}\\] where \\(V_\\gamma\\) is the inertio-capillary velocity Curvature parameter (k) : Ratio of bubble radius to film thickness \\[k = \\frac{R}{h}\\] Repository Structure basilisk/src/ - Core Basilisk CFD library (reference only, do not modify) simulationCases/ - Test cases for simulation soapBubble-full.c - Full bubble simulation (spherical cap + rim) soapBubble-half.c - Half-bubble simulation variant postProcess/ - Project-specific post-processing tools getData.c - Data extraction utility getFacet.c - Interface facet extraction Video-generic.py - Python script for post-processing Simulation Configurations Full Bubble Simulation ( soapBubble-full.c ) Models a complete bubble with: - Lower hemisphere: Circular cap geometry - Upper region: Spherical rim structure - Initial film thickness: \\(h = 1/k\\) - Adaptive mesh refinement near interfaces Half Bubble Simulation ( soapBubble-half.c ) Variant configuration for studying partial bubble dynamics with modified boundary conditions.",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Physical Parameters Used...",
    "content": "Physical Parameters Used Parameter Symbol Typical Value Description Ohnesorge number \\(\\text{Oh}\\) \\(10^{-3}\\) Viscous effects Density ratio \\(\\rho_2/\\rho_1\\) \\(10^{-3}\\) Gas/liquid density Viscosity ratio \\(\\mu_2/\\mu_1\\) \\(10^{-3}\\) Gas/liquid viscosity Curvature parameter \\(k\\) 25 \\(R/h\\) ratio P\u00e9clet number (gas) \\(\\text{Pe}_{\\text{gas}}\\) \\(10^{-1}\\) Smoke diffusion Domain size \\(L\\) 5.0 Computational domain Installation and Usage Prerequisites C99-compliant compiler (gcc or clang) GNU make Python 3+ with matplotlib, numpy for post-processing Quick Setup # Clone repository git clone git@github.com:comphy-lab/soapy.git cd soapy # Install Basilisk locally ./reset_install_requirements.sh source .project_config # Compile simulations cd simulationCases make soapBubble-full.tst Running Simulations # Run full bubble simulation ./soapBubble-full.tst # Run with custom parameters (edit source file for parameter changes) # Key parameters: Oh1, k, tmax, MAXlevel # Output files are saved in intermediate/ directory Post-Processing cd postProcess # Compile data extraction tools qcc -autolink getData.c -o getData -lm qcc -autolink getFacet.c -o getFacet -lm # Generate animations python Video-generic.py --case ../simulationCases --folder output_frames Output Data The simulations generate: - Snapshot files : Binary dumps at regular intervals ( \\(\\Delta t = 0.01\\) ) - Interface data : VOF field and curvature information - Velocity fields : Full velocity components in axisymmetric coordinates - Tracer concentration : Smoke diffusion patterns - Pressure fields : Dynamic pressure evolution Scientific Background The simulations investigate the Taylor-Culick instability in soap bubbles, where: Thin film dynamics : The bubble consists of a liquid film of thickness \\(h \\ll R\\) (bubble radius) Wrinkling mechanism : Instabilities arise from the competition between surface tension and viscous forces Rim formation : The bubble edge develops a toroidal rim structure that influences stability Drainage patterns : Gravity and capillary forces create complex flow patterns within the film Relevant Physics Taylor-Culick velocity : Characteristic retraction speed \\[V_{\\text{TC}} = \\sqrt{\\frac{2\\sigma}{\\rho h}}\\] Rayleigh-Plateau instability : Drives rim breakup and droplet formation Marangoni effects : Surface tension gradients due to surfactant concentration Film thinning : Coupled drainage and evaporation processes Numerical Methods The code employs: Volume-of-Fluid (VOF) method for interface tracking Adaptive mesh refinement (AMR) for resolving thin films Implicit viscous solver for stability at low Oh numbers Conservative momentum advection for accurate interface dynamics Height-function curvature computation for surface tension Contributing This code is part of ongoing research.",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: For collaborations or...",
    "content": "For collaborations or questions: Open an issue for bug reports or feature requests Contact the authors for research collaborations See CLAUDE.md for code style guidelines Authors Saumili Jana - Primary developer ( jsaumili@gmail.com ) Vatsal Sanjay - vatsalsy@comphy-lab.org License This project is licensed under the GNU General Public License v3.0 - see the LICENSE file for details. Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/Video-generic.py postProcess/getData.c postProcess/getFacet.c simulationCases simulationCases/Makefile simulationCases/cleanup.sh simulationCases/runCases.sh simulationCases/soapBubble-full.c simulationCases/soapBubble-half.c",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "# Clone repositorygitclone git@github.com:comphy-lab/soapy.gitcdsoapy# Install Basilisk locally./reset_install_requirements.shsource.project_config# Compile simulationscdsimulationCasesmakesoapBubble-full.tst",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "# Run full bubble simulation./soapBubble-full.tst# Run with custom parameters (edit source file for parameter changes)# Key parameters: Oh1, k, tmax, MAXlevel# Output files are saved in intermediate/ directory",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "cdpostProcess# Compile data extraction toolsqcc-autolinkgetData.c-ogetData-lmqcc-autolinkgetFacet.c-ogetFacet-lm# Generate animationspythonVideo-generic.py--case../simulationCases--folderoutput_frames",
    "url": "https://comphy-lab.org/soapy/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "postProcess/Video-generic.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Basilisk Fluid Dynamics Visualization Script This script processes Basilisk simulation snapshots to create high-quality visualizations of fluid dynamics simulations, particularly for soap bubble and multiphase flow problems. It reads simulation data from intermediate snapshot files, extracts facet information (interfaces), and temperature/scalar fields, then generates publication-quality plots. The script supports parallel processing for efficient generation of animation frames from large simulation datasets.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "Usage: python Video-generic.py [options] Basic usage: python Video-generic.py -CPUs 8 -nGFS 1000 Custom simulation: python Video-generic.py -caseToProcess ../mySimulation -RMAX 5.0 Dependencies: - numpy: For numerical operations - matplotlib: For visualization - multiprocessing: For parallel processing - subprocess: For calling external Basilisk utilities - argparse: For command-line argument parsing External Requirements: - ./getFacet: Basilisk utility to extract interface facets - ./getData: Basilisk utility to extract field data - LaTeX: For rendering mathematical expressions in plots Author: Vatsal Sanjay Email: vatsalsy@comphy-lab.org Affiliation: CoMPhy Lab, Physics of Fluids Department Last updated: Mar 8, 2025 import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import multiprocessing as mp from functools import partial import argparse import sys # =============================== # Matplotlib Configuration # =============================== matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' # =============================== # Data Extraction Functions # =============================== def gettingFacets(filename, includeCoat = 'true' ): Extract interface facets from a Basilisk snapshot file.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Function Definition",
    "content": "This function calls the external getFacet utility to extract the coordinates of interface segments (facets) from a Basilisk simulation snapshot. The facets represent the boundaries between different phases or the free surface. The function automatically mirrors facets across the r=0 axis for axisymmetric simulations, creating a full 2D representation. Args: filename (str): Path to the Basilisk snapshot file includeCoat (str, optional): Whether to include coating interfaces. Defaults to \u2018true\u2019. Returns: list: List of line segments, where each segment is a tuple of two points ((r1, z1), (r2, z2)). Returns empty list if file has insufficient data.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Examples",
    "content": "Raises: subprocess.CalledProcessError: If getFacet utility fails Example: >>> facets = gettingFacets(\u201csnapshot-0.1000\u201d) >>> print(f\u201dFound {len(facets)} facet segments\u201d) # Execute the getFacet utility exe = [ \"./getFacet\" , filename, includeCoat] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() # Parse the output from stderr (Basilisk utilities output to stderr) temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False # Only process if we have substantial output (>100 lines indicates valid data) if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: # Parse the next line for the second point of the segment temp4 = temp2[n1 + 1 ].split( \" \" ) # Note: getFacet outputs in (z, r) format, we convert to (r, z) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) # Add the original segment segs.append(((r1, z1), (r2, z2))) # Mirror across r=0 for axisymmetric visualization segs.append((( - r1, z1), ( - r2, z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr): Extract field data from a Basilisk snapshot within specified bounds.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Function Definition",
    "content": "This function calls the getData utility to extract scalar field data (e.g., temperature, concentration) from a Basilisk simulation on a regular grid. The data is extracted in a rectangular region for efficient visualization.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Args: filename (str):...",
    "content": "Args: filename (str): Path to the Basilisk snapshot file zmin (float): Minimum z-coordinate for data extraction zmax (float): Maximum z-coordinate for data extraction rmax (float): Maximum radial coordinate for data extraction nr (int): Number of grid points in the radial direction Returns: tuple: Contains: - R (numpy.ndarray): 2D array of radial coordinates (nz x nr) - Z (numpy.ndarray): 2D array of axial coordinates (nz x nr) - T (numpy.ndarray): 2D array of field values (nz x nr) - nz (int): Number of grid points in the axial direction Raises: subprocess.CalledProcessError: If getData utility fails ValueError: If data reshaping fails due to inconsistent dimensions Example: >>> R, Z, T, nz = gettingfield(\u201csnapshot-0.1000\u201d, 0, 4, 2, 256) >>> print(f\u201dGrid size: {nz} x {nr}\u201c) # Execute the getData utility with specified bounds exe = [ \"./getData\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() # Parse the output temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) Rtemp, Ztemp, Ttemp = [], [], [] # Extract data points from output for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : # getData outputs in (z, r, field) format Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) Ttemp.append( float (temp3[ 2 ])) # Convert to numpy arrays R = np.asarray(Rtemp) Z = np.asarray(Ztemp) T = np.asarray(Ttemp) # Calculate grid dimensions nz = int ( len (Z) / nr) print ( \"nz is %d \" % nz) # Reshape into 2D grids for visualization R.resize((nz, nr)) Z.resize((nz, nr)) T.resize((nz, nr)) return R, Z, T, nz # =============================== # Visualization Functions # =============================== def process_timestep(ti, caseToProcess, folder, tsnap, GridsPerR, rmin, rmax, zmin, zmax, lw): Process and visualize a single timestep from the simulation.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Function Definition",
    "content": "This function handles the complete visualization pipeline for one timestep: reading data, creating the plot with field visualization and interface contours, and saving the image. It\u2019s designed to be called in parallel for multiple timesteps.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: The visualization includes:...",
    "content": "The visualization includes: - Temperature/scalar field as a colored heatmap - Interface facets as blue lines - Domain boundaries - Axis of symmetry (for axisymmetric cases) Args: ti (int): Timestep index caseToProcess (str): Path to the simulation case directory folder (str): Output directory for saving images tsnap (float): Time interval between snapshots GridsPerR (int): Number of grid points per unit radius rmin (float): Minimum radial coordinate for plotting rmax (float): Maximum radial coordinate for plotting zmin (float): Minimum axial coordinate for plotting zmax (float): Maximum axial coordinate for plotting lw (float): Line width for plotting boundaries Returns: None: Saves image to disk Note: - Skips processing if output image already exists - Prints error messages if snapshot file is missing or corrupted - Images are saved with 8-digit zero-padded filenames for proper sorting Example: >>> process_timestep(100, \u201c../simCase\u201d, \u201coutput\u201d, 0.01, 128, -2, 2, 0, 4, 2) # Creates output/00001000.png for t=1.0 # Calculate physical time for this timestep t = tsnap * ti place = f\" { caseToProcess } /intermediate/snapshot- { t :.4f} \" name = f\" { folder } / { int (t * 1000 ) :08d} .png\" # Check if snapshot file exists if not os.path.exists(place): print ( f\" { place } File not found!\" ) return # Skip if output already exists (useful for resuming interrupted runs) if os.path.exists(name): print ( f\" { name } Image present!\" ) return # Extract interface facets segs = gettingFacets(place) if not segs: print ( f\"Problem in the available file { place } \" ) return # Calculate grid resolution based on domain size nr = int (GridsPerR * rmax) # Extract field data R, Z, T, nz = gettingfield(place, zmin, zmax, rmax, nr) zminp, zmaxp, rminp, rmaxp = Z. min (), Z. max (), R. min (), R. max () # =============================== # Plotting Configuration # =============================== AxesLabel, TickLabel = 50 , 20 fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) # Full HD resolution # Plot domain boundaries and axis of symmetry ax.plot([ 0 , 0 ], [zmin, zmax], '-.' , color = 'grey' , linewidth = lw) # Symmetry axis ax.plot([rmin, rmin], [zmin, zmax], '-' , color = 'black' , linewidth = lw) # Left boundary ax.plot([rmin, rmax], [zmin, zmin], '-' , color = 'black' , linewidth = lw) # Bottom boundary ax.plot([rmin, rmax], [zmax, zmax], '-' , color = 'black' , linewidth = lw) # Top boundary ax.plot([rmax, rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) # Right boundary # Add interface facets as a collection for efficiency line_segments = LineCollection(segs, linewidths = 4 , colors = 'blue' , linestyle = 'solid' ) ax.add_collection(line_segments) # Create temperature/scalar field visualization cntrl2 = ax.imshow(T, interpolation = 'Bilinear' , cmap = 'hot_r' , origin = 'lower' , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 1.0 , vmin = 0.0 ) # Configure plot appearance ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.set_title( f'$t/ \\\\ tau_ \\\\ gamma$ = { t :4.3f} ' , fontsize = TickLabel) ax.axis( 'off' ) # Remove axes for cleaner visualization # Save figure with tight layout plt.savefig(name, bbox_inches = \"tight\" ) plt.close() # =============================== # Main Execution # =============================== def main(): Main function that orchestrates the parallel visualization process.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "This function: 1. Parses command-line arguments for configuration 2. Sets up the output directory 3. Creates a multiprocessing pool 4.",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Distributes timestep processing...",
    "content": "Distributes timestep processing across available CPUs The parallel processing significantly speeds up visualization of large simulation datasets by processing multiple timesteps simultaneously. parser = argparse.ArgumentParser( description = 'Generate visualizations from Basilisk simulation snapshots' , formatter_class = argparse.RawDescriptionHelpFormatter) parser.add_argument( '--CPUs' , type = int , default = 8 , help = 'Number of CPUs to use for parallel processing' ) parser.add_argument( '--nGFS' , type = int , default = 4000 , help = 'Number of snapshot files to process' ) parser.add_argument( '--GridsPerR' , type = int , default = 128 , help = 'Grid resolution per unit radius (affects image quality)' ) parser.add_argument( '--ZMAX' , type = float , default = 4.0 , help = 'Maximum Z coordinate for visualization domain' ) parser.add_argument( '--RMAX' , type = float , default = 4.0 , help = 'Maximum R coordinate for visualization domain' ) parser.add_argument( '--ZMIN' , type = float , default = 0.0 , help = 'Minimum Z coordinate for visualization domain' ) parser.add_argument( '--tsnap' , type = float , default = 0.01 , help = 'Time interval between snapshots' ) parser.add_argument( '--caseToProcess' , type = str , default = '../simulationCases/soapBubble-full' , help = 'Path to simulation case directory' ) parser.add_argument( '--folderToSave' , type = str , default = 'Video' , help = 'Output directory for images' ) args = parser.parse_args() # Extract arguments num_processes = args.CPUs nGFS = args.nGFS tsnap = args.tsnap ZMAX = args.ZMAX RMAX = args.RMAX ZMIN = args.ZMIN # Set up visualization domain (full domain for axisymmetric cases) rmin, rmax, zmin, zmax = [ - RMAX, RMAX, ZMIN, ZMAX] GridsPerR = args.GridsPerR # Visualization parameters lw = 2 # Line width for boundaries folder = args.folderToSave caseToProcess = args.caseToProcess # Create output directory if it doesn't exist if not os.path.isdir(folder): os.makedirs(folder) print ( f\"Created output directory: { folder } \" ) # =============================== # Parallel Processing # =============================== print ( f\"Starting parallel processing with { num_processes } CPUs...\" ) print ( f\"Processing { nGFS } timesteps from { caseToProcess } \" ) # Create a pool of worker processes with mp.Pool(processes = num_processes) as pool: # Create partial function with fixed arguments # This allows us to pass only the timestep index to each worker process_func = partial(process_timestep, caseToProcess = caseToProcess, folder = folder, tsnap = tsnap, GridsPerR = GridsPerR, rmin = rmin, rmax = rmax, zmin = zmin, zmax = zmax, lw = lw) # Map the process function to all timesteps # This distributes the work across available CPUs pool. map (process_func, range (nGFS)) print ( f\"Processing complete!",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Images saved to...",
    "content": "Images saved to { folder } /\" ) print ( \"To create a video from images, use:\" ) print ( f\" ffmpeg -framerate 30 -pattern_type glob -i ' { folder } /*.png' -c:v libx264 output.mp4\" ) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Methods",
    "content": "importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportmultiprocessingasmpfromfunctoolsimportpartialimportargparseimportsys# ===============================# Matplotlib Configuration# ===============================matplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'# ===============================# Data Extraction Functions# ===============================defgettingFacets(filename, includeCoat='true'):",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: # Execute the...",
    "content": "# Execute the getFacet utilityexe=[\"./getFacet\", filename, includeCoat]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()# Parse the output from stderr (Basilisk utilities output to stderr)temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=False# Only process if we have substantial output (>100 lines indicates valid data)if(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:# Parse the next line for the second point of the segmenttemp4=temp2[n1+1].split(\" \")# Note: getFacet outputs in (z, r) format, we convert to (r, z)r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])# Add the original segmentsegs.append(((r1, z1), (r2, z2)))# Mirror across r=0 for axisymmetric visualizationsegs.append(((-r1, z1), (-r2, z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr):",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: # Execute the...",
    "content": "# Execute the getData utility with specified boundsexe=[\"./getData\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()# Parse the outputtemp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")Rtemp, Ztemp, Ttemp=[], [], []# Extract data points from outputforn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:# getData outputs in (z, r, field) formatZtemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))Ttemp.append(float(temp3[2]))# Convert to numpy arraysR=np.asarray(Rtemp)Z=np.asarray(Ztemp)T=np.asarray(Ttemp)# Calculate grid dimensionsnz=int(len(Z)/nr)print(\"nz is%d\"%nz)# Reshape into 2D grids for visualizationR.resize((nz, nr))Z.resize((nz, nr))T.resize((nz, nr))returnR, Z, T, nz# ===============================# Visualization Functions# ===============================defprocess_timestep(ti, caseToProcess, folder, tsnap, GridsPerR, rmin, rmax, zmin, zmax, lw):",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: # Calculate physical...",
    "content": "# Calculate physical time for this timestept=tsnap*tiplace=f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\"name=f\"{folder}/{int(t*1000):08d}.png\"# Check if snapshot file existsifnotos.path.exists(place):print(f\"{place}File not found!\")return# Skip if output already exists (useful for resuming interrupted runs)ifos.path.exists(name):print(f\"{name}Image present!\")return# Extract interface facetssegs=gettingFacets(place)ifnotsegs:print(f\"Problem in the available file{place}\")return# Calculate grid resolution based on domain sizenr=int(GridsPerR*rmax)# Extract field dataR, Z, T, nz=gettingfield(place, zmin, zmax, rmax, nr)zminp, zmaxp, rminp, rmaxp=Z.min(), Z.max(), R.min(), R.max()# ===============================# Plotting Configuration# ===============================AxesLabel, TickLabel=50,20fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)# Full HD resolution# Plot domain boundaries and axis of symmetryax.plot([0,0], [zmin, zmax],'-.', color='grey', linewidth=lw)# Symmetry axisax.plot([rmin, rmin], [zmin, zmax],'-', color='black', linewidth=lw)# Left boundaryax.plot([rmin, rmax], [zmin, zmin],'-', color='black', linewidth=lw)# Bottom boundaryax.plot([rmin, rmax], [zmax, zmax],'-', color='black', linewidth=lw)# Top boundaryax.plot([rmax, rmax], [zmin, zmax],'-', color='black', linewidth=lw)# Right boundary# Add interface facets as a collection for efficiencyline_segments=LineCollection(segs, linewidths=4, colors='blue', linestyle='solid')ax.add_collection(line_segments)# Create temperature/scalar field visualizationcntrl2=ax.imshow(T, interpolation='Bilinear', cmap='hot_r', origin='lower',extent=[rminp, rmaxp, zminp, zmaxp], vmax=1.0, vmin=0.0)# Configure plot appearanceax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.set_title(f'$t/\\\\tau_\\\\gamma$ ={t:4.3f}', fontsize=TickLabel)ax.axis('off')# Remove axes for cleaner visualization# Save figure with tight layoutplt.savefig(name, bbox_inches=\"tight\")plt.close()# ===============================# Main Execution# ===============================defmain():",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "parser=argparse.ArgumentParser(description='Generate visualizations from Basilisk simulation snapshots',formatter_class=argparse.RawDescriptionHelpFormatter)parser.add_argument('--CPUs',type=int, default=8,help='Number of CPUs to use for parallel processing')parser.add_argument('--nGFS',type=int, default=4000,help='Number of snapshot files to process')parser.add_argument('--GridsPerR',type=int, default=128,help='Grid resolution per unit radius (affects image quality)')parser.add_argument('--ZMAX',type=float, default=4.0,help='Maximum Z coordinate for visualization domain')parser.add_argument('--RMAX',type=float, default=4.0,help='Maximum R coordinate for visualization domain')parser.add_argument('--ZMIN',type=float, default=0.0,help='Minimum Z coordinate for visualization domain')parser.add_argument('--tsnap',type=float, default=0.01,help='Time interval between snapshots')parser.add_argument('--caseToProcess',type=str,default='../simulationCases/soapBubble-full',help='Path to simulation case directory')parser.add_argument('--folderToSave',type=str, default='Video',help='Output directory for images')args=parser.parse_args()# Extract argumentsnum_processes=args.CPUsnGFS=args.nGFStsnap=args.tsnapZMAX=args.ZMAXRMAX=args.RMAXZMIN=args.ZMIN# Set up visualization domain (full domain for axisymmetric cases)rmin, rmax, zmin, zmax=[-RMAX, RMAX, ZMIN, ZMAX]GridsPerR=args.GridsPerR# Visualization parameterslw=2# Line width for boundariesfolder=args.folderToSavecaseToProcess=args.caseToProcess# Create output directory if it doesn't existifnotos.path.isdir(folder):os.makedirs(folder)print(f\"Created output directory:{folder}\")# ===============================# Parallel Processing# ===============================print(f\"Starting parallel processing with{num_processes}CPUs...\")print(f\"Processing{nGFS}timesteps from{caseToProcess}\")# Create a pool of worker processeswithmp.Pool(processes=num_processes)aspool:# Create partial function with fixed arguments# This allows us to pass only the timestep index to each workerprocess_func=partial(process_timestep,caseToProcess=caseToProcess,folder=folder,tsnap=tsnap,GridsPerR=GridsPerR,rmin=rmin,rmax=rmax,zmin=zmin,zmax=zmax,lw=lw)# Map the process function to all timesteps# This distributes the work across available CPUspool.map(process_func,range(nGFS))print(f\"Processing complete!",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Images saved to{folder}/\")print(\"To...",
    "content": "Images saved to{folder}/\")print(\"To create a video from images, use:\")print(f\"  ffmpeg -framerate 30 -pattern_type glob -i '{folder}/*.png' -c:v libx264 output.mp4\")if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/soapy/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData.c Extract and interpolate field data from Basilisk snapshots onto a regular grid. - Author: Vatsal Sanjay (vatsalsy@com... getFacet.c Extract interface facets from Basilisk simulation files. - Author: Vatsal Sanjay (vatsalsy@comphy-lab.org) - Lab: CoM... Video-generic.py Basilisk Fluid Dynamics Visualization Script This script processes Basilisk simulation snapshots to create high-quali...",
    "url": "https://comphy-lab.org/soapy/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films",
    "content": "postProcess/getFacet.c See raw file Facet Extraction Utility Extract interface facets from Basilisk simulation files. Author : Vatsal Sanjay (vatsalsy@comphy-lab.org) Lab : CoMPhy Lab, Physics of Fluids Department Updated : March 8, 2025 Usage ./getFacet < simulation_file > Output: Facet data to stderr #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" VOF fraction field scalar f []; Input filename buffer char filename [ 80 ]; Main Function Extract facets from a saved simulation state. Parameters a : Argument count arguments : Command-line arguments arguments[1] : Simulation file path Process Load simulation file Extract facets from VOF field Output to stderr int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); }",
    "url": "https://comphy-lab.org/soapy/postProcess/getFacet.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"",
    "url": "https://comphy-lab.org/soapy/postProcess/getFacet.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);}",
    "url": "https://comphy-lab.org/soapy/postProcess/getFacet.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "postProcess/getData.c See raw file Simulation Data Extraction Extract and interpolate field data from Basilisk snapshots onto a regular grid. Author : Vatsal Sanjay (vatsalsy@comphy-lab.org) Lab : CoMPhy Lab, Physics of Fluids Department Updated : March 8, 2025 Usage ./getData < filename > < xmin > < ymin > < xmax > < ymax > < ny > Output: Grid data (x, y, field_values) to stderr #include \"utils.h\" #include \"output.h\" VOF and velocity fields scalar f []; vector u []; Command-line parameters char filename [ 80 ]; int nx , ny , len ; double xmin , ymin , xmax , ymax , Deltax , Deltay ; Temperature field and scalar list scalar T []; scalar * list = NULL ; Main Function Extract simulation data and interpolate onto a regular grid.",
    "url": "https://comphy-lab.org/soapy/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Parameters filename :...",
    "content": "Parameters filename : Simulation snapshot file xmin , ymin : Lower bounds of extraction region xmax , ymax : Upper bounds of extraction region ny : Number of grid points in y-direction Process Parse arguments and validate input Load simulation and normalize T field Create uniform grid with spacing Deltay Interpolate fields onto grid points Output grid data to stderr int main ( int a , char const * arguments []) { if ( a != 7 ) { fprintf ( stderr , \"Error: Expected 6 arguments \\n \" ); fprintf ( stderr , \"Usage: %s <filename> <xmin> <ymin> <xmax> <ymax> <ny> \\n \" , arguments [ 0 ]); return 1 ; } sprintf ( filename , \" %s \" , arguments [ 1 ]); xmin = atof ( arguments [ 2 ]); ymin = atof ( arguments [ 3 ]); xmax = atof ( arguments [ 4 ]); ymax = atof ( arguments [ 5 ]); ny = atoi ( arguments [ 6 ]); list = list_add ( list , T ); /* Load simulation */ restore ( file = filename ); /* Normalize T by maximum value */",
    "url": "https://comphy-lab.org/soapy/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "charfilename[80];intnx,ny,len;doublexmin,ymin,xmax,ymax,Deltax,Deltay;",
    "url": "https://comphy-lab.org/soapy/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "intmain(inta,charconst*arguments[]){if(a!=7){fprintf(stderr,\"Error: Expected 6 arguments\\n\");fprintf(stderr,\"Usage:%s<filename> <xmin> <ymin> <xmax> <ymax> <ny>\\n\",arguments[0]);return1;}sprintf(filename,\"%s\",arguments[1]);xmin=atof(arguments[2]);ymin=atof(arguments[3]);xmax=atof(arguments[4]);ymax=atof(arguments[5]);ny=atoi(arguments[6]);list=list_add(list,T);/* Load simulation */restore(file=filename);/* Normalize T by maximum value */",
    "url": "https://comphy-lab.org/soapy/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films",
    "content": "simulationCases/Makefile See raw file Makefile # Check if .project_config exists ifeq ( \\$ ( wildcard ../.project_config ) , ) \\$ ( error \"../.project_config not found\" ) endif BASILISK := \\$ ( shell . ../.project_config && echo \\$\\$ BASILISK ) CFLAGS += -O2 -disable-dimensions CFLAGS += -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local # Fix permissions for runtest script fix-permissions: @chmod +x \\$ ( BASILISK ) /src/runtest # Make all test targets depend on fix-permissions %.tst: fix-permissions include \\$ ( BASILISK ) /Makefile.defs",
    "url": "https://comphy-lab.org/soapy/simulationCases/Makefile.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "# Check if .project_config existsifeq(\\$(wildcard../.project_config),)\\$(error\"../.project_config not found\")endifBASILISK:=\\$(shell. ../.project_config&&echo\\$\\$BASILISK)CFLAGS+=-O2-disable-dimensionsCFLAGS+=-I\\$(PWD)/src-local-I\\$(PWD)/../src-local# Fix permissions for runtest scriptfix-permissions:@chmod+x\\$(BASILISK)/src/runtest# Make all test targets depend on fix-permissions%.tst:fix-permissionsinclude\\$(BASILISK)/Makefile.defs",
    "url": "https://comphy-lab.org/soapy/simulationCases/Makefile.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "simulationCases/soapBubble-half.c See raw file Axisymmetric Bubble Wrinkling Simulation Overview This simulation models the dynamics of a thin liquid film forming a bubble with wrinkling instabilities. The code solves the two-phase Navier-Stokes equations in an axisymmetric configuration, capturing the interface dynamics between a liquid film and surrounding gas phase.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Physics Description The...",
    "content": "Physics Description The simulation captures: - Two-phase flow dynamics with surface tension effects - Gravitational forcing characterized by Bond number (Bo) - Viscous effects characterized by Ohnesorge number (Oh) - Interface tracking using Volume-of-Fluid (VOF) method - Adaptive mesh refinement for efficient computation Authors and Changelog Author : Saumili Jana (jsaumili@gmail.com) Created : October 18, 2024 Version History Oct 28, 2024 (Vatsal): Fixed initial condition implementation Mar 6, 2025 (Saumili): Corrected boundary condition formulation Mar 15, 2025 (Saumili): Updated pressure boundary conditions Mar 31, 2025 (Saumili): Increased iterations for convergence Apr 4, 2025 (Saumili): Corrected pressure initial condition Phase Convention f = 1: Liquid phase (thin film) f = 0: Gas phase (surrounding medium) #include \"axi.h\" #include \"navier-stokes/centered.h\" #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"henry.h\" scalar T [], * stracers = { T }; Simulation Parameters Adaptive Mesh Refinement Tolerances These control the error thresholds for grid adaptation: - Volume fraction error tolerance - Velocity component error tolerance - Curvature error tolerance - Acceleration error tolerance #define fErr ( 1e-3 ) 52 #define VelErr ( 1e-3 ) 53 #define KErr ( 1e-3 ) 54 #define AErr ( 1e-3 ) 55 #define MINlevel 2 56 57 Time Control Parameters tsnap : Interval for saving simulation snapshots #define tsnap ( 0.01 ) 62 63 Physical Properties Rho21 : Density ratio between gas and liquid phases ( \\(\\rho_g/\\rho_l\\) ) Mu21 : Viscosity ratio between gas and liquid phases ( \\(\\mu_g/\\mu_l\\) ) Xcent , Ycent : Center coordinates of the bubble R2circle : Macro for computing squared radial distance #define Rho21 ( 1e-3 ) 71 #define Mu21 ( 1e-3 ) 72 #define Xcent ( 0.0 ) 74 #define Ycent ( 0.0 ) 75 #define R2circle ( x , y ) ( sq ( x - Xcent ) + sq ( y - Ycent )) 76 77 Boundary Conditions Left Boundary (Axis of Symmetry) No-slip wall condition for velocity Contact angle set to 90 degrees via Dirichlet condition on f u . t [ left ] = dirichlet ( 0.0 ); u . n [ left ] = dirichlet ( 0.0 ); f [ left ] = dirichlet ( 0.0 ); Right Boundary (Outflow) Neumann conditions for velocity components Dirichlet condition for pressure (atmospheric) u . t [ right ] = neumann ( 0.0 ); u . n [ right ] = neumann ( 0.0 ); p [ right ] = dirichlet ( 0.0 ); Top Boundary (Outflow) Neumann conditions for velocity components Dirichlet condition for pressure (atmospheric) u . t [ top ] = neumann ( 0.0 ); u . n [ top ] = neumann ( 0.0 ); p [ top ] = dirichlet ( 0.0 ); Global Variables MAXlevel : Maximum refinement level for adaptive mesh tmax : Maximum simulation time Oh1 : Ohnesorge number for liquid film Bo : Bond number (gravity/surface tension ratio) Ldomain : Domain size k : Curvature parameter (R/h ratio) h : Film thickness int MAXlevel ; double tmax , Oh1 , Pe_gas , Ldomain , k , h ; Main Function Purpose Initializes simulation parameters and launches the computation.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Key Parameters Set...",
    "content": "Key Parameters Set Maximum grid refinement level: 8 Simulation duration: 1.0 time units Domain size: 2.4 units Ohnesorge number: 0.01 (moderate viscous effects) Curvature parameter: 10 (thin film approximation) int main ( int argc , char const * argv []) { // Parameter assignments MAXlevel = 11 ; tmax = 1.0 ; Ldomain = 5.0 ; Oh1 = 1e-3 ; k = 2.5e1 ; Note on the Peclet number: Peclet number based on diffusion coefficient of smoke in air. \\[ Pe = \\frac{V_\\gamma R_0}{D} \\] The inertio-capillary velocity is usuallly 0.1-1 m/s. Typical bubble radius is 1 mm. The diffusion coefficient of smoke in air is 1e-4 to 1e-5 m^2/s.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Pe_gas = 1e-1...",
    "content": "Pe_gas = 1e-1 ; fprintf ( ferr , \"Level %d , tmax %g , Oh1 %3.2e , Lo %g\\n \" , MAXlevel , tmax , Oh1 , Ldomain ); // Domain configuration L0 = Ldomain ; init_grid ( 1 << 6 ); // Create output directory char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Physical properties assignment rho1 = 1.0 ; rho2 = Rho21 ; mu1 = Oh1 ; mu2 = Mu21 * Oh1 ; f . sigma = 1.0 ; // Surface tension coefficient // for smoke concentration T T . D1 = 1e-3 / Pe_gas ; // inverse Peclet number based on diffusion coefficient of smoke in water, $Pe_\\text{water} \\to \\infty$. T . D2 = 1e0 / Pe_gas ; // inverse Peclet number based on diffusion coefficient of smoke in air. T . alpha = 1e-3 ; // proportion of smoke in water right at the interface (this should be close to 0.). run (); } Initial Condition Event Purpose Sets up the initial bubble geometry with a half-circle lower part and spherical rim upper part.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: This creates a...",
    "content": "This creates a bubble with controlled wrinkling potential based on the curvature parameter k.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Geometry Construction Lower...",
    "content": "Geometry Construction Lower region: Half-circular cap Upper region: Spherical shell rim Film thickness: h = 1/k Initial refinement focused near the interface event init ( t = 0 ) { if (! restore ( file = \"dump\" )) { float y_p , x_p , x1 , x2 ; h = 1 / k ; y_p = 0.1 ; x1 = sqrt ( sq ( 1.0 - h ) - sq ( y_p )); x2 = sqrt ( 1 - sq ( y_p )); x_p = ( x1 + x2 ) / 2 ; // Adaptive refinement near interface refine (( R2circle ( x , y ) < 1.05 ) && ( R2circle ( x , y ) > sq ( 0.025 *( 1.0 - h ))) && ( level < MAXlevel )); // Initialize level-set function for interface vertex scalar phi []; foreach_vertex () { if ( y < y_p && x > 0.0 ) { // Lower part - half circle geometry phi [] = ( sq ( h / 2 ) - ( sq ( x - x_p ) + sq ( y - y_p ))); } else { // Upper part - spherical rim double r = sqrt ( sq ( x ) + sq ( y )); double shell = min ( 1. - r , ( r - ( 1. - h ))); phi [] = shell ; } } fractions ( phi , f ); fraction ( T , ( sq (( 1.0 - h )* 0.5 ) - R2circle ( x , y ))); // Initialize pressure field based on region foreach () { T [] *= 1e1 ; if ( R2circle ( x , y ) < sq ( 1.0 - h )) { p [] = 2. + 2. /( 1. - h ); // Inner bubble pressure } else if (( R2circle ( x , y ) <= 1 ) && ( R2circle ( x , y ) >= sq ( 1.0 - h ))) { p [] = 2 * f []; // Film pressure } else { p [] = 0 ; // Atmospheric pressure } u . x [] = 0 ; u . y [] = 0 ; } } } Adaptive Mesh Refinement Event Purpose Dynamically refines the computational mesh based on solution gradients.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: This ensures high...",
    "content": "This ensures high resolution near the interface and regions of high curvature while maintaining efficiency in smooth regions. Refinement Criteria Volume fraction gradients (interface tracking) Velocity component gradients (flow features) Curvature gradients (wrinkling detection) scalar KAPPA []; event adapt ( i ++) { curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , u . x , u . y , KAPPA }, ( double []){ fErr , VelErr , VelErr , KErr }, MAXlevel , MAXlevel - 4 ); } Data Output Event Purpose Saves simulation state at regular intervals for post-processing and restart capability.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Output Schedule Initial...",
    "content": "Output Schedule Initial condition saved at t = 0 Snapshots saved every tsnap time units Full field data including pressure dumped event writingFiles ( t = 0 , t += tsnap ; t <= tmax ) { p . nodump = false ; // Enable pressure output dump ( file = \"dump\" ); char nameOut [ 80 ]; sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Logging Event Purpose Maintains a detailed log of simulation progress including timestep information and key parameters.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Log Contents Iteration...",
    "content": "Log Contents Iteration number Current timestep size Simulation time Initial header with all simulation parameters event logWriting ( i ++) { static FILE * fp ; if ( pid () == 0 ) { if ( i == 0 ) { fprintf ( ferr , \"i dt t \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d , tmax %g , Oh %3.2e , Lo %g\\n \" , MAXlevel , tmax , Oh1 , Ldomain ); fprintf ( fp , \"i dt t \\n \" ); fprintf ( fp , \" %d %g %g \\n \" , i , dt , t ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %d %g %g\\n \" , i , dt , t ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g\\n \" , i , dt , t ); } }",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include\"henry.h\"scalar T[],*stracers={T};",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "#define fErr(1e-3)52#define VelErr(1e-3)53#define KErr(1e-3)54#define AErr(1e-3)55#define MINlevel25657",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "#define Rho21(1e-3)71#define Mu21(1e-3)72#define Xcent(0.0)74#define Ycent(0.0)75#define R2circle(x,y)(sq(x-Xcent)+sq(y-Ycent))7677",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[left]=dirichlet(0.0);u.n[left]=dirichlet(0.0);f[left]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[right]=neumann(0.0);u.n[right]=neumann(0.0);p[right]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[top]=neumann(0.0);u.n[top]=neumann(0.0);p[top]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "intmain(intargc,charconst*argv[]){// Parameter assignmentsMAXlevel=11;tmax=1.0;Ldomain=5.0;Oh1=1e-3;k=2.5e1;",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "Pe_gas=1e-1;fprintf(ferr,\"Level%d, tmax%g, Oh1%3.2e, Lo%g\\n\",MAXlevel,tmax,Oh1,Ldomain);// Domain configurationL0=Ldomain;init_grid(1<<6);// Create output directorycharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Physical properties assignmentrho1=1.0;rho2=Rho21;mu1=Oh1;mu2=Mu21*Oh1;f.sigma=1.0;// Surface tension coefficient// for smoke concentration TT.D1=1e-3/Pe_gas;// inverse Peclet number based on diffusion coefficient of smoke in water, $Pe_\\text{water} \\to \\infty$.T.D2=1e0/Pe_gas;// inverse Peclet number based on diffusion coefficient of smoke in air.T.alpha=1e-3;// proportion of smoke in water right at the interface (this should be close to 0.).run();}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "event init(t=0){if(!restore(file=\"dump\")){floaty_p,x_p,x1,x2;h=1/k;y_p=0.1;x1=sqrt(sq(1.0-h)-sq(y_p));x2=sqrt(1-sq(y_p));x_p=(x1+x2)/2;// Adaptive refinement near interfacerefine((R2circle(x,y)<1.05)&&(R2circle(x,y)>sq(0.025*(1.0-h)))&&(level<MAXlevel));// Initialize level-set function for interfacevertex scalar phi[];foreach_vertex(){if(y<y_p&&x>0.0){// Lower part - half circle geometryphi[]=(sq(h/2)-(sq(x-x_p)+sq(y-y_p)));}else{// Upper part - spherical rimdoubler=sqrt(sq(x)+sq(y));doubleshell=min(1.-r,(r-(1.-h)));phi[]=shell;}}fractions(phi,f);fraction(T,(sq((1.0-h)*0.5)-R2circle(x,y)));// Initialize pressure field based on regionforeach(){T[]*=1e1;if(R2circle(x,y)<sq(1.0-h)){p[]=2.+2./(1.-h);// Inner bubble pressure}elseif((R2circle(x,y)<=1)&&(R2circle(x,y)>=sq(1.0-h))){p[]=2*f[];// Film pressure}else{p[]=0;// Atmospheric pressure}u.x[]=0;u.y[]=0;}}}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "scalar KAPPA[];event adapt(i++){curvature(f,KAPPA);adapt_wavelet((scalar*){f,u.x,u.y,KAPPA},(double[]){fErr,VelErr,VelErr,KErr},MAXlevel,MAXlevel-4);}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "event writingFiles(t=0,t+=tsnap;t<=tmax){p.nodump=false;// Enable pressure outputdump(file=\"dump\");charnameOut[80];sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-half.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "event logWriting(i++){staticFILE*fp;if(pid()==0){if(i==0){fprintf(ferr,\"i dt t\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level%d, tmax%g, Oh%3.2e, Lo%g\\n\",MAXlevel,tmax,Oh1,Ldomain);fprintf(fp,\"i dt t\\n\");fprintf(fp,\"%d%g%g\\n\",i,dt,t);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d%g%g\\n\",i,dt,t);fclose(fp);}fprintf(ferr,\"%d%g%g\\n\",i,dt,t);}}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-half.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "simulationCases/cleanup.sh See raw file cleanup.sh \u26a0\ufe0f DANGER: Destructive Script Warning This script permanently deletes directories and ALL their contents! Files deleted with rm -rf CANNOT be recovered No recycle bin or trash - deletion is immediate and permanent Can delete entire directory trees including subdirectories Always double-check the directory path before running Purpose This script is designed to clean up simulation output directories in the SOAPY project. It's commonly used to remove the intermediate/ directories that contain large binary dump files from completed simulations.",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Examples",
    "content": "Usage ./cleanup.sh < directory_name > Example: # Remove intermediate simulation data ./cleanup.sh intermediate # Remove a specific output directory ./cleanup.sh output_test_run Safety Features The enhanced script now includes several safety checks: Argument verification - Ensures a directory name is provided Existence check - Verifies the directory exists before attempting deletion Path display - Shows the full absolute path of the directory to be deleted Size information - Displays directory size and file count Confirmation prompt - Requires explicit \"yes\" confirmation before deletion Graceful cancellation - Any response other than \"yes\" cancels the operation Script Source #!/bin/bash # cleanup.sh - Safely remove directories with confirmation # WARNING: This script permanently deletes directories and all contents! # Usage: ./cleanup.sh <directory_name> # Check if argument is provided if [ \\$ # -eq 0 ] ; then echo \"Error: No directory specified\" echo \"Usage: \\$0 <directory_name>\" exit 1 fi # Check if directory exists if [ ! -d \"\\$1\" ] ; then echo \"Error: Directory '\\$1' does not exist\" exit 1 fi # Get absolute path for clarity FULLPATH = \\$ ( cd \"\\$1\" 2 > /dev/null && pwd ) if [ -z \"\\$FULLPATH\" ] ; then echo \"Error: Cannot access directory '\\$1'\" exit 1 fi # Show directory size and confirm deletion echo \"WARNING: This will permanently delete the following directory and ALL its contents:\" echo \" \\$FULLPATH\" echo \"\" echo \"Directory information:\" du -sh \"\\$1\" 2 > /dev/null || echo \" Size: Unable to determine\" echo \" Number of files: \\$(find \" \\$ 1\" -type f 2>/dev/null | wc -l)\" echo \"\" read -p \"Are you sure you want to delete this directory?",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Type 'yes' to...",
    "content": "Type 'yes' to confirm: \" CONFIRM if [ \"\\$CONFIRM\" = \"yes\" ] ; then echo \"Deleting directory...\" rm -rf \"\\$1\" if [ \\$ ? -eq 0 ] ; then echo \"Directory successfully deleted.\" else echo \"Error: Failed to delete directory.\" exit 1 fi else echo \"Deletion cancelled.\" exit 0 fi",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "# Remove intermediate simulation data./cleanup.shintermediate# Remove a specific output directory./cleanup.shoutput_test_run",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "#!/bin/bash# cleanup.sh - Safely remove directories with confirmation# WARNING: This script permanently deletes directories and all contents!# Usage: ./cleanup.sh <directory_name># Check if argument is providedif[\\$#-eq0];thenecho\"Error: No directory specified\"echo\"Usage: \\$0 <directory_name>\"exit1fi# Check if directory existsif[!-d\"\\$1\"];thenecho\"Error: Directory '\\$1' does not exist\"exit1fi# Get absolute path for clarityFULLPATH=\\$(cd\"\\$1\"2>/dev/null&&pwd)if[-z\"\\$FULLPATH\"];thenecho\"Error: Cannot access directory '\\$1'\"exit1fi# Show directory size and confirm deletionecho\"WARNING: This will permanently delete the following directory and ALL its contents:\"echo\"  \\$FULLPATH\"echo\"\"echo\"Directory information:\"du-sh\"\\$1\"2>/dev/null||echo\"  Size: Unable to determine\"echo\"  Number of files: \\$(find \"\\$1\" -type f 2>/dev/null | wc -l)\"echo\"\"read-p\"Are you sure you want to delete this directory?",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Type 'yes' to...",
    "content": "Type 'yes' to confirm: \"CONFIRMif[\"\\$CONFIRM\"=\"yes\"];thenecho\"Deleting directory...\"rm-rf\"\\$1\"if[\\$?-eq0];thenecho\"Directory successfully deleted.\"elseecho\"Error: Failed to delete directory.\"exit1fielseecho\"Deletion cancelled.\"exit0fi",
    "url": "https://comphy-lab.org/soapy/simulationCases/cleanup.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases cleanup.sh rm -rf \\$1 Makefile ifeq (\\$(wildcard ../.projectconfig),) \\$(error '../.projectconfig not found') endif BASILISK := \\$(shell . ../.proje... runCases.sh ORIGDIR=\\$(pwd) mkdir -p \\$1 cp \\$1.c \\$1/ cd \\$1 CC99='mpicc -std=c99' qcc -Wall -O2 -DMPI=1 -disable-dimensions -I\\... soapBubble-full.c This simulation models the dynamics of a thin liquid film forming a bubble with wrinkling instabilities. The code sol... soapBubble-half.c This simulation models the dynamics of a thin liquid film forming a bubble with wrinkling instabilities. The code sol...",
    "url": "https://comphy-lab.org/soapy/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Context",
    "content": "simulationCases/soapBubble-full.c See raw file Axisymmetric Bubble Wrinkling Simulation Overview This simulation models the dynamics of a thin liquid film forming a bubble with wrinkling instabilities. The code solves the two-phase Navier-Stokes equations in an axisymmetric configuration, capturing the interface dynamics between a liquid film and surrounding gas phase.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Physics Description The...",
    "content": "Physics Description The simulation captures: - Two-phase flow dynamics with surface tension effects - Gravitational forcing characterized by Bond number (Bo) - Viscous effects characterized by Ohnesorge number (Oh) - Interface tracking using Volume-of-Fluid (VOF) method - Adaptive mesh refinement for efficient computation Authors and Changelog Author : Saumili Jana (jsaumili@gmail.com) Created : October 18, 2024 Version History Oct 28, 2024 (Vatsal): Fixed initial condition implementation Mar 6, 2025 (Saumili): Corrected boundary condition formulation Mar 15, 2025 (Saumili): Updated pressure boundary conditions Mar 31, 2025 (Saumili): Increased iterations for convergence Apr 4, 2025 (Saumili): Corrected pressure initial condition Phase Convention f = 1: Liquid phase (thin film) f = 0: Gas phase (surrounding medium) #include \"axi.h\" #include \"navier-stokes/centered.h\" #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"henry.h\" scalar T [], * stracers = { T }; Simulation Parameters Adaptive Mesh Refinement Tolerances These control the error thresholds for grid adaptation: - Volume fraction error tolerance - Velocity component error tolerance - Curvature error tolerance - Acceleration error tolerance #define fErr ( 1e-3 ) 52 #define VelErr ( 1e-3 ) 53 #define KErr ( 1e-3 ) 54 #define AErr ( 1e-3 ) 55 #define MINlevel 2 56 57 Time Control Parameters tsnap : Interval for saving simulation snapshots #define tsnap ( 0.01 ) 62 63 Physical Properties Rho21 : Density ratio between gas and liquid phases ( \\(\\rho_g/\\rho_l\\) ) Mu21 : Viscosity ratio between gas and liquid phases ( \\(\\mu_g/\\mu_l\\) ) Xcent , Ycent : Center coordinates of the bubble R2circle : Macro for computing squared radial distance #define Rho21 ( 1e-3 ) 71 #define Mu21 ( 1e-3 ) 72 #define Xcent ( 0.0 ) 74 #define Ycent ( 0.0 ) 75 #define R2circle ( x , y ) ( sq ( x - Xcent ) + sq ( y - Ycent )) 76 77 Boundary Conditions Left Boundary (Axis of Symmetry) No-slip wall condition for velocity Contact angle set to 90 degrees via Dirichlet condition on f u . t [ left ] = dirichlet ( 0.0 ); u . n [ left ] = dirichlet ( 0.0 ); f [ left ] = dirichlet ( 0.0 ); Right Boundary (Outflow) Neumann conditions for velocity components Dirichlet condition for pressure (atmospheric) u . t [ right ] = neumann ( 0.0 ); u . n [ right ] = neumann ( 0.0 ); p [ right ] = dirichlet ( 0.0 ); Top Boundary (Outflow) Neumann conditions for velocity components Dirichlet condition for pressure (atmospheric) u . t [ top ] = neumann ( 0.0 ); u . n [ top ] = neumann ( 0.0 ); p [ top ] = dirichlet ( 0.0 ); Global Variables MAXlevel : Maximum refinement level for adaptive mesh tmax : Maximum simulation time Oh1 : Ohnesorge number for liquid film Bo : Bond number (gravity/surface tension ratio) Ldomain : Domain size k : Curvature parameter (R/h ratio) h : Film thickness int MAXlevel ; double tmax , Oh1 , Pe_gas , Ldomain , k , h ; Main Function Purpose Initializes simulation parameters and launches the computation.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Key Parameters Set...",
    "content": "Key Parameters Set Maximum grid refinement level: 8 Simulation duration: 1.0 time units Domain size: 2.4 units Ohnesorge number: 0.01 (moderate viscous effects) Curvature parameter: 10 (thin film approximation) int main ( int argc , char const * argv []) { // Parameter assignments MAXlevel = 11 ; tmax = 1.0 ; Ldomain = 5.0 ; X0 = - 1.005 ; Oh1 = 1e-3 ; k = 2.5e1 ; Note on the Peclet number: Peclet number based on diffusion coefficient of smoke in air. \\[ Pe = \\frac{V_\\gamma R_0}{D} \\] The inertio-capillary velocity is usuallly 0.1-1 m/s. Typical bubble radius is 1 mm. The diffusion coefficient of smoke in air is 1e-4 to 1e-5 m^2/s.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Pe_gas = 1e-1...",
    "content": "Pe_gas = 1e-1 ; fprintf ( ferr , \"Level %d , tmax %g , Oh1 %3.2e , Lo %g\\n \" , MAXlevel , tmax , Oh1 , Ldomain ); // Domain configuration L0 = Ldomain ; init_grid ( 1 << 6 ); // Create output directory char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Physical properties assignment rho1 = 1.0 ; rho2 = Rho21 ; mu1 = Oh1 ; mu2 = Mu21 * Oh1 ; f . sigma = 1.0 ; // Surface tension coefficient // for smoke concentration T T . D1 = 1e-3 / Pe_gas ; // inverse Peclet number based on diffusion coefficient of smoke in water, $Pe_\\text{water} \\to \\infty$. T . D2 = 1e0 / Pe_gas ; // inverse Peclet number based on diffusion coefficient of smoke in air. T . alpha = 1e-3 ; // proportion of smoke in water right at the interface (this should be close to 0.). run (); } Initial Condition Event Purpose Sets up the initial bubble geometry with a half-circle lower part and spherical rim upper part.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: This creates a...",
    "content": "This creates a bubble with controlled wrinkling potential based on the curvature parameter k.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Geometry Construction Lower...",
    "content": "Geometry Construction Lower region: Half-circular cap Upper region: Spherical shell rim Film thickness: h = 1/k Initial refinement focused near the interface event init ( t = 0 ) { if (! restore ( file = \"dump\" )) { float y_p , x_p , x1 , x2 ; h = 1 / k ; y_p = 0.1 ; x1 = sqrt ( sq ( 1.0 - h ) - sq ( y_p )); x2 = sqrt ( 1 - sq ( y_p )); x_p = ( x1 + x2 ) / 2 ; // Adaptive refinement near interface refine (( R2circle ( x , y ) < 1.05 ) && ( R2circle ( x , y ) > sq ( 0.025 *( 1.0 - h ))) && ( level < MAXlevel )); // Initialize level-set function for interface vertex scalar phi []; foreach_vertex () { if ( y < y_p && x > 0.0 ) { // Lower part - half circle geometry phi [] = ( sq ( h / 2 ) - ( sq ( x - x_p ) + sq ( y - y_p ))); } else { // Upper part - spherical rim double r = sqrt ( sq ( x ) + sq ( y )); double shell = min ( 1. - r , ( r - ( 1. - h ))); phi [] = shell ; } } fractions ( phi , f ); fraction ( T , ( sq (( 1.0 - h )* 0.5 ) - R2circle ( x , y ))); // Initialize pressure field based on region foreach () { T [] *= 1e1 ; if ( R2circle ( x , y ) < sq ( 1.0 - h )) { p [] = 2. + 2. /( 1. - h ); // Inner bubble pressure } else if (( R2circle ( x , y ) <= 1 ) && ( R2circle ( x , y ) >= sq ( 1.0 - h ))) { p [] = 2 * f []; // Film pressure } else { p [] = 0 ; // Atmospheric pressure } u . x [] = 0 ; u . y [] = 0 ; } } } Adaptive Mesh Refinement Event Purpose Dynamically refines the computational mesh based on solution gradients.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: This ensures high...",
    "content": "This ensures high resolution near the interface and regions of high curvature while maintaining efficiency in smooth regions. Refinement Criteria Volume fraction gradients (interface tracking) Velocity component gradients (flow features) Curvature gradients (wrinkling detection) scalar KAPPA []; event adapt ( i ++) { curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , u . x , u . y , KAPPA }, ( double []){ fErr , VelErr , VelErr , KErr }, MAXlevel , MAXlevel - 4 ); } Data Output Event Purpose Saves simulation state at regular intervals for post-processing and restart capability.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Output Schedule Initial...",
    "content": "Output Schedule Initial condition saved at t = 0 Snapshots saved every tsnap time units Full field data including pressure dumped event writingFiles ( t = 0 , t += tsnap ; t <= tmax ) { p . nodump = false ; // Enable pressure output dump ( file = \"dump\" ); char nameOut [ 80 ]; sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Logging Event Purpose Maintains a detailed log of simulation progress including timestep information and key parameters.",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films: Log Contents Iteration...",
    "content": "Log Contents Iteration number Current timestep size Simulation time Initial header with all simulation parameters event logWriting ( i ++) { static FILE * fp ; if ( pid () == 0 ) { if ( i == 0 ) { fprintf ( ferr , \"i dt t \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d , tmax %g , Oh %3.2e , Lo %g\\n \" , MAXlevel , tmax , Oh1 , Ldomain ); fprintf ( fp , \"i dt t \\n \" ); fprintf ( fp , \" %d %g %g \\n \" , i , dt , t ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %d %g %g\\n \" , i , dt , t ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g\\n \" , i , dt , t ); } }",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include\"henry.h\"scalar T[],*stracers={T};",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "#define fErr(1e-3)52#define VelErr(1e-3)53#define KErr(1e-3)54#define AErr(1e-3)55#define MINlevel25657",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "#define Rho21(1e-3)71#define Mu21(1e-3)72#define Xcent(0.0)74#define Ycent(0.0)75#define R2circle(x,y)(sq(x-Xcent)+sq(y-Ycent))7677",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[left]=dirichlet(0.0);u.n[left]=dirichlet(0.0);f[left]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[right]=neumann(0.0);u.n[right]=neumann(0.0);p[right]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "u.t[top]=neumann(0.0);u.n[top]=neumann(0.0);p[top]=dirichlet(0.0);",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "intmain(intargc,charconst*argv[]){// Parameter assignmentsMAXlevel=11;tmax=1.0;Ldomain=5.0;X0=-1.005;Oh1=1e-3;k=2.5e1;",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "Pe_gas=1e-1;fprintf(ferr,\"Level%d, tmax%g, Oh1%3.2e, Lo%g\\n\",MAXlevel,tmax,Oh1,Ldomain);// Domain configurationL0=Ldomain;init_grid(1<<6);// Create output directorycharcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Physical properties assignmentrho1=1.0;rho2=Rho21;mu1=Oh1;mu2=Mu21*Oh1;f.sigma=1.0;// Surface tension coefficient// for smoke concentration TT.D1=1e-3/Pe_gas;// inverse Peclet number based on diffusion coefficient of smoke in water, $Pe_\\text{water} \\to \\infty$.T.D2=1e0/Pe_gas;// inverse Peclet number based on diffusion coefficient of smoke in air.T.alpha=1e-3;// proportion of smoke in water right at the interface (this should be close to 0.).run();}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example: Context",
    "content": "event init(t=0){if(!restore(file=\"dump\")){floaty_p,x_p,x1,x2;h=1/k;y_p=0.1;x1=sqrt(sq(1.0-h)-sq(y_p));x2=sqrt(1-sq(y_p));x_p=(x1+x2)/2;// Adaptive refinement near interfacerefine((R2circle(x,y)<1.05)&&(R2circle(x,y)>sq(0.025*(1.0-h)))&&(level<MAXlevel));// Initialize level-set function for interfacevertex scalar phi[];foreach_vertex(){if(y<y_p&&x>0.0){// Lower part - half circle geometryphi[]=(sq(h/2)-(sq(x-x_p)+sq(y-y_p)));}else{// Upper part - spherical rimdoubler=sqrt(sq(x)+sq(y));doubleshell=min(1.-r,(r-(1.-h)));phi[]=shell;}}fractions(phi,f);fraction(T,(sq((1.0-h)*0.5)-R2circle(x,y)));// Initialize pressure field based on regionforeach(){T[]*=1e1;if(R2circle(x,y)<sq(1.0-h)){p[]=2.+2./(1.-h);// Inner bubble pressure}elseif((R2circle(x,y)<=1)&&(R2circle(x,y)>=sq(1.0-h))){p[]=2*f[];// Film pressure}else{p[]=0;// Atmospheric pressure}u.x[]=0;u.y[]=0;}}}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "scalar KAPPA[];event adapt(i++){curvature(f,KAPPA);adapt_wavelet((scalar*){f,u.x,u.y,KAPPA},(double[]){fErr,VelErr,VelErr,KErr},MAXlevel,MAXlevel-4);}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "event writingFiles(t=0,t+=tsnap;t<=tmax){p.nodump=false;// Enable pressure outputdump(file=\"dump\");charnameOut[80];sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/soapBubble-full.c | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "event logWriting(i++){staticFILE*fp;if(pid()==0){if(i==0){fprintf(ferr,\"i dt t\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level%d, tmax%g, Oh%3.2e, Lo%g\\n\",MAXlevel,tmax,Oh1,Ldomain);fprintf(fp,\"i dt t\\n\");fprintf(fp,\"%d%g%g\\n\",i,dt,t);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d%g%g\\n\",i,dt,t);fclose(fp);}fprintf(ferr,\"%d%g%g\\n\",i,dt,t);}}",
    "url": "https://comphy-lab.org/soapy/simulationCases/soapBubble-full.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runCases.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films",
    "content": "simulationCases/runCases.sh See raw file runCases.sh #!/bin/bash # Save the original directory ORIG_DIR = \\$ ( pwd ) mkdir -p \\$ 1 cp \\$ 1.c \\$ 1/ cd \\$ 1 CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions -I\\${ORIG_DIR} /src-local -I\\${ORIG_DIR} /../src-local \\$ 1.c -o \\$ 1 -lm mpirun -np \\$ 2 ./\\$1",
    "url": "https://comphy-lab.org/soapy/simulationCases/runCases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCases.sh | SOAPY - Simulation Of Axisymmetric Phenomena in bubblY films - Code Example",
    "content": "#!/bin/bash# Save the original directoryORIG_DIR=\\$(pwd)mkdir-p\\$1cp\\$1.c\\$1/cd\\$1CC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensions-I\\${ORIG_DIR}/src-local-I\\${ORIG_DIR}/../src-local\\$1.c-o\\$1-lmmpirun-np\\$2 ./\\$1",
    "url": "https://comphy-lab.org/soapy/simulationCases/runCases.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Documentation: Context",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # tested on MacOS only.",
    "url": "https://comphy-lab.org/HoleySheet/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Documentation: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue. # modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to install basilisk install_basilisk() { darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make -k make } # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then echo \"Installing basilisk...\" rm -rf basilisk install_basilisk else echo \"Using existing basilisk installation...\" cd basilisk/src fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\\nChecking qcc installation...\" if ! qcc --version > /dev/null 2 >& 1 ; then echo \"\\033[0;31mError: qcc is not working properly.\\033[0m\" echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" echo \"For more details, visit: http://basilisk.fr/src/INSTALL\" exit 1 else echo \"\\033[0;32mqcc is properly installed.\\033[0m\" qcc --version fi",
    "url": "https://comphy-lab.org/HoleySheet/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Documentation - Code Example: #!/bin/zsh# tested on...",
    "content": "#!/bin/zsh# tested on MacOS only.",
    "url": "https://comphy-lab.org/HoleySheet/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Documentation - Code Example: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue.# modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basilisk# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to install basiliskinstall_basilisk(){darcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake-kmake}# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenecho\"Installing basilisk...\"rm-rfbasiliskinstall_basiliskelseecho\"Using existing basilisk installation...\"cdbasilisk/srcfi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\\nChecking qcc installation...\"if!qcc--version>/dev/null2>&1;thenecho\"\\033[0;31mError: qcc is not working properly.\\033[0m\"echo\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"echo\"For more details, visit: http://basilisk.fr/src/INSTALL\"exit1elseecho\"\\033[0;32mqcc is properly installed.\\033[0m\"qcc--versionfi",
    "url": "https://comphy-lab.org/HoleySheet/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Documentation | Documentation: Work in progress...",
    "content": "Work in progress Together with St\u00e9phane Zaleski, Chunheng Zhao, and Detlef Lohse For postprocessing: Run the command as follows sh python3 VideoBubbleinSheet.py --asy --Oh 0.01 Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/VideoBubbleinSheet.py postProcess/VideoBubbleinSheet_02.1_tp.py postProcess/VideoBubbleinSheet_02_tp.py postProcess/VideoBubbleinSheet_03.py postProcess/VideoBubbleinSheet_03_all.py postProcess/VideoBubbleinSheet_04.py postProcess/getData.c postProcess/getData_02.c postProcess/getFacet.c postProcess/getFacet1.c postProcess/getFacet2.c postProcess/getFacet_02.c postProcess/getab.c postProcess/geth.c postProcess/out_ab_time.py postProcess/out_h_time.py postProcess/out_theta_time_01.py postProcess/runpostProcess.sh simulationCases simulationCases/asyBubbleinSheet_01.c simulationCases/asyBubbleinSheet_03.c simulationCases/bubbleinSheet_01.1.c simulationCases/bubbleinSheet_01.c simulationCases/bubbleinSheet_02.c simulationCases/bubbleinSheet_03.1.c simulationCases/bubbleinSheet_03.2.c simulationCases/bubbleinSheet_03.3.c simulationCases/bubbleinSheet_03.c simulationCases/bubbleinSheet_04.c simulationCases/bubbleinSheet_05.c simulationCases/makeDirs.sh simulationCases/outEqshape_01.ipynb simulationCases/runCodes_snellius_singleNode.sh src-local src-local/three-phase.h",
    "url": "https://comphy-lab.org/HoleySheet/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Documentation | Documentation - Code Example",
    "content": "sh   python3 VideoBubbleinSheet.py --asy --Oh 0.01",
    "url": "https://comphy-lab.org/HoleySheet/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03_all.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet_03_all.py See raw file # To get facets for bubbles in sheets import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import sys matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True # matplotlib.rcParams['text.latex.preamble'] = [r''] def gettingFacets1(filename): exe = [ \"./getFacet1\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingFacets2(filename): exe = [ \"./getFacet2\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingFacets(filename): exe = [ \"./getFacet\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs # ---------------------------------------------------------------------------------------------------------------------- nGFS = 1000 Ldomain = 4 GridsPerR = 64 nr = int (GridsPerR * Ldomain) rmin, rmax, zmin, zmax = [ - Ldomain, Ldomain, - Ldomain / 2 , Ldomain / 2 ] lw = 2 folder = 'Video_all' # output folder if not os.path.isdir(folder): os.makedirs(folder) for ti in range (nGFS): t = 0.1 * ti place = \"snapshot- %5.4f \" % t place2 = \"intermediate/snapshot- %5.4f \" % 0e0 name = \" %s / %8.8d .png\" % (folder, int (t * 1000 )) if not os.path.exists(place): print ( \" %s File not found!\" % place) else : if os.path.exists(name): print ( \" %s Image present!\" % name) else : segs1 = gettingFacets1(place) segs2 = gettingFacets2(place) segs = gettingFacets(place2) if ( len (segs1) == 0 ): print ( \"Problem in the available file %s \" % place) else : # Part to plot AxesLabel, TickLabel = [ 50 , 35 ] fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) ax.plot([ 0 , 0 ], [zmin, zmax], '-.' ,color = 'grey' ,linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ## Drawing Facets line_segments1 = LineCollection(segs1, linewidths = 3.25 , colors = 'green' , linestyle = 'solid' ) line_segments2 = LineCollection(segs2, linewidths = 3.25 , colors = 'purple' , linestyle = 'solid' ) line_segments3 = LineCollection(segs, linewidths = 1.25 , colors = 'black' , linestyle = 'solid' ) ax.add_collection(line_segments1) ax.add_collection(line_segments2) ax.add_collection(line_segments3) ax.set_title( '$t/ \\\\ tau_ \\ gamma$ = %4.3f ' % t, fontsize = TickLabel) #plt.scatter(segs[0], segs[1]) #print(\"The line collection array: \",segs) ## Copied Lines ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.axis( 'off' ) # plt.show() plt.savefig(name, bbox_inches = \"tight\" , dpi = 250 ) plt.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03_all.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03_all.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheetsimportnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportsysmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=True# matplotlib.rcParams['text.latex.preamble'] = [r'']defgettingFacets1(filename):exe=[\"./getFacet1\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=TruereturnsegsdefgettingFacets2(filename):exe=[\"./getFacet2\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=TruereturnsegsdefgettingFacets(filename):exe=[\"./getFacet\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=Truereturnsegs# ----------------------------------------------------------------------------------------------------------------------nGFS=1000Ldomain=4GridsPerR=64nr=int(GridsPerR*Ldomain)rmin, rmax, zmin, zmax=[-Ldomain, Ldomain,-Ldomain/2, Ldomain/2]lw=2folder='Video_all'# output folderifnotos.path.isdir(folder):os.makedirs(folder)fortiinrange(nGFS):t=0.1*tiplace=\"snapshot-%5.4f\"%tplace2=\"intermediate/snapshot-%5.4f\"%0e0name=\"%s/%8.8d.png\"%(folder,int(t*1000))ifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:ifos.path.exists(name):print(\"%sImage present!\"%name)else:segs1=gettingFacets1(place)segs2=gettingFacets2(place)segs=gettingFacets(place2)if(len(segs1)==0):print(\"Problem in the available file%s\"%place)else:# Part to plotAxesLabel, TickLabel=[50,35]fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)ax.plot([0,0], [zmin, zmax],'-.',color='grey',linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-',color='black',linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw)## Drawing Facetsline_segments1=LineCollection(segs1, linewidths=3.25, colors='green', linestyle='solid')line_segments2=LineCollection(segs2, linewidths=3.25, colors='purple', linestyle='solid')line_segments3=LineCollection(segs, linewidths=1.25, colors='black', linestyle='solid')ax.add_collection(line_segments1)ax.add_collection(line_segments2)ax.add_collection(line_segments3)ax.set_title('$t/\\\\tau_\\gamma$ =%4.3f'%t, fontsize=TickLabel)#plt.scatter(segs[0], segs[1])#print(\"The line collection array: \",segs)## Copied Linesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.axis('off')# plt.show()plt.savefig(name, bbox_inches=\"tight\", dpi=250)plt.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03_all.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_02.1_tp.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet_02.1_tp.py See raw file # To get facets for bubbles in sheets # Add theta point as well. import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import sys from scipy.optimize import fsolve matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True # matplotlib.rcParams['text.latex.preamble'] = [r''] def gettingFacets1(filename): exe = [ \"./getFacet1\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingFacets2(filename): exe = [ \"./getFacet2\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr, Ohs, Ohp, Oha): exe = [ \"./getData\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr), str (Ohs), str (Ohp), str (Oha)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp, taupTemp = [],[],[],[],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) Utemp.append( float (temp3[ 4 ])) Vtemp.append( float (temp3[ 5 ])) taupTemp.append( float (temp3[ 6 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) U = np.asarray(Utemp) V = np.asarray(Vtemp) taup = np.asarray(taupTemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) U.resize((nz, nr)) V.resize((nz, nr)) taup.resize((nz, nr)) return R, Z, D2, vel, U, V, taup, nz # ---------------------------------------------------------------------------------------------------------------------- def getting_facet1(filename): exe = [ \"./getFacet1\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) lines = temp1.splitlines() x = [] y = [] for line in lines: values = line.split() if len (values) == 2 : try : x_val = float (values[ 0 ]) y_val = float (values[ 1 ]) x.append(x_val) y.append(y_val) except ValueError : continue # Convert lists to numpy arrays x = np.array(x) y = np.array(y) theta = np.arctan2(y, x) sorted_indices = np.argsort(theta) return np.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices] # ---------------------------------------------------------------------------------------------------------------------- def getting_facet2(filename): exe = [ \"./getFacet2\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) lines = temp1.splitlines() x = [] y = [] for line in lines: values = line.split() if len (values) == 2 : try : x_val = float (values[ 0 ]) y_val = float (values[ 1 ]) x.append(x_val) y.append(y_val) except ValueError : continue # Convert lists to numpy arrays x = np.array(x) y = np.array(y) theta = np.arctan2(y, x) sorted_indices = np.argsort(theta) return np.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices] # ---------------------------------------------------------------------------------------------------------------------- def func(theta): # Interpolate r_fit1 and r_fit2 at the given theta r1 = np.interp(theta, theta_fit, r_fit1) r2 = np.interp(theta, theta_fit, r_fit2) return r1 - r2 - 2e-2 def fitradius(r, theta, theta_fit): degree = 10 coefficients = np.polyfit(theta, r, degree) return np.polyval(coefficients, theta_fit) nGFS = 5000 Ldomain = 4 GridsPerR = 64 nr = int (GridsPerR * Ldomain) Ohs, Ohp, Oha = 1e-2 , 1e-2 , 1e-4 rmin, rmax, zmin, zmax = [ - Ldomain, Ldomain, - Ldomain / 2 , Ldomain / 2 ] lw = 2 folder = 'Video_02.1' # output folder if not os.path.isdir(folder): os.makedirs(folder) for ti in range (nGFS): t = 0.1 * ti place = \"intermediate/snapshot- %5.4f \" % t name = \" %s / %8.8d .png\" % (folder, int (t * 1000 )) if not os.path.exists(place): print ( \" %s File not found!\" % place) else : if os.path.exists(name): print ( \" %s Image present!\" % name) else : segs1 = gettingFacets1(place) segs2 = gettingFacets2(place) if ( len (segs1) == 0 ): print ( \"Problem in the available file %s \" % place) else : #R, Z, taus, vel, U, V, taup, nz = gettingfield(place, zmin, zmax, rmax, nr, Ohs, Ohp, Oha) #zminp, zmaxp, rminp, rmaxp = Z.min(), Z.max(), R.min(), R.max() # print(zminp, zmaxp, rminp, rmaxp) # Part to plot AxesLabel, TickLabel = [ 50 , 35 ] fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) ax.plot([ 0 , 0 ], [zmin, zmax], '-.' ,color = 'grey' ,linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ## Drawing Facets line_segments1 = LineCollection(segs1, linewidths = 3.25 , colors = 'green' , linestyle = 'solid' ) line_segments2 = LineCollection(segs2, linewidths = 3.25 , colors = 'purple' , linestyle = 'solid' ) ax.add_collection(line_segments1) ax.add_collection(line_segments2) ax.set_title( '$t/ \\\\ tau_ \\ gamma$ = %4.3f ' % t, fontsize = TickLabel) #plt.scatter(segs[0], segs[1]) #print(\"The line collection array: \",segs) x1, y1, theta1 = getting_facet1(place) x2, y2, theta2 = getting_facet2(place) r1 = np.sqrt(x1 * x1 + y1 * y1) r2 = np.sqrt(x2 * x2 + y2 * y2) theta_fit = np.linspace( 0 , np.pi / 2 , 1000 ) r_fit1 = fitradius(r1, theta1, theta_fit) r_fit2 = fitradius(r2, theta2, theta_fit) theta_sol = fsolve(func, 1.3 ) print (theta_sol) theta_sol[theta_sol < 0 ] = 0 f = open ( \"out_theta_time.txt\" , \"a\" ) f.write( \" %4.6f \" % (t)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (theta_sol)) f.write( \" \\t \" ) f.write( \" \\n \" ) # Add lines theta_x_line = np.linspace( 0 , 2 , 100 ) theta_y_line = theta_x_line / np.tan(theta_sol) ax.plot(theta_x_line, theta_y_line, color = 'black' ) ## Copied Lines ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.axis( 'off' ) # plt.show() plt.savefig(name, bbox_inches = \"tight\" , dpi = 250 ) plt.close() f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_02.1_tp.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_02.1_tp.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheets # Add theta point as well.importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportsysfromscipy.optimizeimportfsolvematplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=True# matplotlib.rcParams['text.latex.preamble'] = [r'']defgettingFacets1(filename):exe=[\"./getFacet1\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=TruereturnsegsdefgettingFacets2(filename):exe=[\"./getFacet2\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr, Ohs, Ohp, Oha):exe=[\"./getData\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr),str(Ohs),str(Ohp),str(Oha)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp, taupTemp=[],[],[],[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))Utemp.append(float(temp3[4]))Vtemp.append(float(temp3[5]))taupTemp.append(float(temp3[6]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)U=np.asarray(Utemp)V=np.asarray(Vtemp)taup=np.asarray(taupTemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))U.resize((nz, nr))V.resize((nz, nr))taup.resize((nz, nr))returnR, Z, D2, vel, U, V, taup, nz# ----------------------------------------------------------------------------------------------------------------------defgetting_facet1(filename):exe=[\"./getFacet1\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")lines=temp1.splitlines()x=[]y=[]forlineinlines:values=line.split()iflen(values)==2:try:x_val=float(values[0])y_val=float(values[1])x.append(x_val)y.append(y_val)exceptValueError:continue# Convert lists to numpy arraysx=np.array(x)y=np.array(y)theta=np.arctan2(y, x)sorted_indices=np.argsort(theta)returnnp.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices]# ----------------------------------------------------------------------------------------------------------------------defgetting_facet2(filename):exe=[\"./getFacet2\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")lines=temp1.splitlines()x=[]y=[]forlineinlines:values=line.split()iflen(values)==2:try:x_val=float(values[0])y_val=float(values[1])x.append(x_val)y.append(y_val)exceptValueError:continue# Convert lists to numpy arraysx=np.array(x)y=np.array(y)theta=np.arctan2(y, x)sorted_indices=np.argsort(theta)returnnp.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices]# ----------------------------------------------------------------------------------------------------------------------deffunc(theta):# Interpolate r_fit1 and r_fit2 at the given thetar1=np.interp(theta, theta_fit, r_fit1)r2=np.interp(theta, theta_fit, r_fit2)returnr1-r2-2e-2deffitradius(r, theta, theta_fit):degree=10coefficients=np.polyfit(theta, r, degree)returnnp.polyval(coefficients, theta_fit)nGFS=5000Ldomain=4GridsPerR=64nr=int(GridsPerR*Ldomain)Ohs, Ohp, Oha=1e-2,1e-2,1e-4rmin, rmax, zmin, zmax=[-Ldomain, Ldomain,-Ldomain/2, Ldomain/2]lw=2folder='Video_02.1'# output folderifnotos.path.isdir(folder):os.makedirs(folder)fortiinrange(nGFS):t=0.1*tiplace=\"intermediate/snapshot-%5.4f\"%tname=\"%s/%8.8d.png\"%(folder,int(t*1000))ifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:ifos.path.exists(name):print(\"%sImage present!\"%name)else:segs1=gettingFacets1(place)segs2=gettingFacets2(place)if(len(segs1)==0):print(\"Problem in the available file%s\"%place)else:#R, Z, taus, vel, U, V, taup, nz = gettingfield(place, zmin, zmax, rmax, nr, Ohs, Ohp, Oha)#zminp, zmaxp, rminp, rmaxp = Z.min(), Z.max(), R.min(), R.max()# print(zminp, zmaxp, rminp, rmaxp)# Part to plotAxesLabel, TickLabel=[50,35]fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)ax.plot([0,0], [zmin, zmax],'-.',color='grey',linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-',color='black',linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw)## Drawing Facetsline_segments1=LineCollection(segs1, linewidths=3.25, colors='green', linestyle='solid')line_segments2=LineCollection(segs2, linewidths=3.25, colors='purple', linestyle='solid')ax.add_collection(line_segments1)ax.add_collection(line_segments2)ax.set_title('$t/\\\\tau_\\gamma$ =%4.3f'%t, fontsize=TickLabel)#plt.scatter(segs[0], segs[1])#print(\"The line collection array: \",segs)x1, y1, theta1=getting_facet1(place)x2, y2, theta2=getting_facet2(place)r1=np.sqrt(x1*x1+y1*y1)r2=np.sqrt(x2*x2+y2*y2)theta_fit=np.linspace(0, np.pi/2,1000)r_fit1=fitradius(r1, theta1, theta_fit)r_fit2=fitradius(r2, theta2, theta_fit)theta_sol=fsolve(func,1.3)print(theta_sol)theta_sol[theta_sol<0]=0f=open(\"out_theta_time.txt\",\"a\")f.write(\"%4.6f\"%(t))f.write(\"\\t\")f.write(\"%4.6f\"%(theta_sol))f.write(\"\\t\")f.write(\"\\n\")# Add linestheta_x_line=np.linspace(0,2,100)theta_y_line=theta_x_line/np.tan(theta_sol)ax.plot(theta_x_line, theta_y_line, color='black')## Copied Linesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.axis('off')# plt.show()plt.savefig(name, bbox_inches=\"tight\", dpi=250)plt.close()f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_02.1_tp.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getab.c | Documentation",
    "content": "postProcess/getab.c See raw file // get major axis a, and minor axis b of the bubble #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d char filename[80], nameTrack[80]; scalar * list = NULL; scalar f2[]; int main(int a, char const *arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); boundary((scalar *){f2, u.x, u.y}); double xmax = -HUGE; double ymax = -HUGE; double x_ymax = 0, y_xmax = 0; foreach(){ if (x > xmax && f2[] > 1-1e-3) { xmax = x; y_xmax = y; } if (y > ymax && f2[] > 1-1e-3) { ymax = y; x_ymax = x; } } FILE * fp = ferr; fprintf(ferr, \u201c%f %7.6e %7.6e %7.6e %7.6e\u201d, t, xmax, y_xmax, x_ymax, ymax); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getab.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet.py See raw file # To get facets for bubbles in sheets import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection import multiprocessing as mp from functools import partial from pathlib import Path import argparse from matplotlib.ticker import StrMethodFormatter import random matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, asy): exe = [ \"./getFacet\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() stderr_output = stderr.decode( \"utf-8\" ) points = stderr_output.split( \" \\n \" ) segments = [] if len (points) > 100 : for i in range ( len (points) - 1 ): current_point = points[i].split() if current_point: next_point = points[i + 1 ].split() if next_point: r1, z1 = float (current_point[ 1 ]), float (current_point[ 0 ]) r2, z2 = float (next_point[ 1 ]), float (next_point[ 0 ]) if asy: segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)) ] else : segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)), ((r1, - z1), (r2, - z2)), (( - r1, - z1), ( - r2, - z2)) ] segments.extend(segment_variants) return segments def gettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh): exe = [ \"./getData\" , filename, str (zmin), str (rmin), str (zmax), str (rmax), str (nr), str (Oh)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() lines = stderr.decode( \"utf-8\" ).split( \" \\n \" ) Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp = [],[],[],[],[],[] for i in range ( len (lines)): values = lines[i].split( \" \" ) if values == [ '' ]: pass else : Ztemp.append( float (values[ 0 ])) Rtemp.append( float (values[ 1 ])) D2temp.append( float (values[ 2 ])) veltemp.append( float (values[ 3 ])) Utemp.append( float (values[ 4 ])) Vtemp.append( float (values[ 5 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) U = np.asarray(Utemp) V = np.asarray(Vtemp) nz = int ( len (Z) / nr) # print(f\"nz is {nz}\") R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) U.resize((nz, nr)) V.resize((nz, nr)) return R, Z, D2, vel, U, V, nz def process_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain): t = 0.01*ti snapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\") output_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists(): print(f\"{snapshot_file} not found!\") return if output_file.exists(): print(f\"{output_file} already present!\") return segs = gettingFacets(snapshot_file, asy) if not segs: print(f\"Problem in the available file {snapshot_file}\") return R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh) # Part to plot AxesLabel, TickLabel = [50, 35] fig, ax = plt.subplots() fig.set_size_inches(19.20, 10.80) if not asy: rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2 ax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw) ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw) ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Drawing Facets line_segments = LineCollection(segs, linewidths=3.25, colors='green', linestyle='solid') ax.add_collection(line_segments) ax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.3f}', fontsize=TickLabel) ## Copied Lines ax.set_aspect('equal') ax.set_xlim(-rmax, rmax) ax.set_ylim(zmin, zmax) # velmax, velmin = np.max(vel), np.min(vel) # d2max, d2min = np.max(D2), np.min(D2) # print(f\"max D2 is {d2max} and min D2 is {d2min}\") # print(f\"max vel is {velmax} and min vel is {velmin}\") # if asy: # cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) # cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) # else: # rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 # cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) # cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) # cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin) # cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min) # l, b, w, h = ax.get_position().bounds # cb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03]) # c1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal') # c1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25) # c1.ax.tick_params(labelsize=TickLabel) # c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.3f}')) # c1.set_ticks([velmax, velmin]) # cb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03]) # c2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal') # c2.ax.tick_params(labelsize=TickLabel) # c2.set_label(r\"$\\log_{10}\\left(2 Oh \\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25) # c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) # c2.set_ticks([d2max, d2min]) ax.axis('off') # plt.show() plt.savefig(output_file, bbox_inches=\"tight\", dpi=250) plt.close() print(f\"{ti+1} is done\") def main(): parser = argparse.ArgumentParser(description=\u201cProcess facets for bubbles in sheets.\u201d) parser.add_argument(\u2018\u2013asy\u2019, action=\u2018store_true\u2019, help=\u201cIf set, use asymmetric variants.",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation: Context",
    "content": "Default is false.\u201d) parser.add_argument(\u2018\u2013Oh\u2019, type=float, default=0.01, help=\u201cOh value.\u201d) args = parser.parse_args() nGFS = 10000 Ldomain = 4 GridsPerR = 64 nr = int(GridsPerR*Ldomain) if args.asy: rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2 else: rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 lw = 2 folder = Path('Video') # output folder if not folder.is_dir(): os.makedirs(folder) # Prepare the partial function with fixed arguments # process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr) process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores num_processes = 5 #mp.cpu_count() nGFS_list = list(range(nGFS)) random.shuffle(nGFS_list) # Create a pool of worker processes with mp.Pool(processes=num_processes) as pool: # Map the process_func to all timesteps pool.map(process_func, nGFS_list) if name == \u201c main \u201d: main()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheetsimportnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionimportmultiprocessingasmpfromfunctoolsimportpartialfrompathlibimportPathimportargparsefrommatplotlib.tickerimportStrMethodFormatterimportrandommatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, asy):exe=[\"./getFacet\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()stderr_output=stderr.decode(\"utf-8\")points=stderr_output.split(\"\\n\")segments=[]iflen(points)>100:foriinrange(len(points)-1):current_point=points[i].split()ifcurrent_point:next_point=points[i+1].split()ifnext_point:r1, z1=float(current_point[1]),float(current_point[0])r2, z2=float(next_point[1]),float(next_point[0])ifasy:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2))]else:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2)),((r1,-z1), (r2,-z2)),((-r1,-z1), (-r2,-z2))]segments.extend(segment_variants)returnsegmentsdefgettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh):exe=[\"./getData\", filename,str(zmin),str(rmin),str(zmax),str(rmax),str(nr),str(Oh)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()lines=stderr.decode(\"utf-8\").split(\"\\n\")Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp=[],[],[],[],[],[]foriinrange(len(lines)):values=lines[i].split(\" \")ifvalues==['']:passelse:Ztemp.append(float(values[0]))Rtemp.append(float(values[1]))D2temp.append(float(values[2]))veltemp.append(float(values[3]))Utemp.append(float(values[4]))Vtemp.append(float(values[5]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)U=np.asarray(Utemp)V=np.asarray(Vtemp)nz=int(len(Z)/nr)# print(f\"nz is {nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))U.resize((nz, nr))V.resize((nz, nr))returnR, Z, D2, vel, U, V, nzdefprocess_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain):",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: Context",
    "content": "t = 0.01*ti\nsnapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\")\noutput_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists():\n    print(f\"{snapshot_file} not found!\")\n    return if output_file.exists():\n    print(f\"{output_file} already present!\")\n    return segs = gettingFacets(snapshot_file, asy) if not segs:\n    print(f\"Problem in the available file {snapshot_file}\")\n    return",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: R, Z, D2,...",
    "content": "R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh)\n# Part to plot\nAxesLabel, TickLabel = [50, 35]\nfig, ax = plt.subplots()\nfig.set_size_inches(19.20, 10.80) if not asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2\n    \nax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: Context",
    "content": "ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw)\nax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Drawing Facets\nline_segments = LineCollection(segs, linewidths=3.25, colors='green', linestyle='solid')\nax.add_collection(line_segments)\nax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.3f}', fontsize=TickLabel)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: ## Copied Lines...",
    "content": "## Copied Lines\nax.set_aspect('equal')\nax.set_xlim(-rmax, rmax)\nax.set_ylim(zmin, zmax) # velmax, velmin = np.max(vel), np.min(vel) \n# d2max, d2min = np.max(D2), np.min(D2) \n# print(f\"max D2 is {d2max} and min D2 is {d2min}\")\n# print(f\"max vel is {velmax} and min vel is {velmin}\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: # if asy:...",
    "content": "# if asy:\n#     cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n#     cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: # else: #...",
    "content": "# else:   \n#     rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\n    # cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n    # cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)\n    # cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin)\n    # cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: # l, b,...",
    "content": "# l, b, w, h = ax.get_position().bounds\n# cb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03])\n# c1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal')\n# c1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25)\n# c1.ax.tick_params(labelsize=TickLabel)\n# c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.3f}'))\n# c1.set_ticks([velmax, velmin])\n# cb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03])\n# c2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal')\n# c2.ax.tick_params(labelsize=TickLabel)\n# c2.set_label(r\"$\\log_{10}\\left(2 Oh \\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25)\n# c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) \n# c2.set_ticks([d2max, d2min])",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: Context",
    "content": "ax.axis('off')\n# plt.show()\nplt.savefig(output_file, bbox_inches=\"tight\", dpi=250)\nplt.close()\nprint(f\"{ti+1} is done\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: nGFS = 10000...",
    "content": "nGFS = 10000\nLdomain = 4\nGridsPerR = 64\nnr = int(GridsPerR*Ldomain) if args.asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2\nelse:\n    rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\nlw = 2 folder = Path('Video')  # output folder if not folder.is_dir():\n    os.makedirs(folder)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: Function Definition",
    "content": "# Prepare the partial function with fixed arguments\n# process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr)\nprocess_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores\nnum_processes = 5 #mp.cpu_count() nGFS_list = list(range(nGFS))\nrandom.shuffle(nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet.py | Documentation - Code Example: # Create a...",
    "content": "# Create a pool of worker processes\nwith mp.Pool(processes=num_processes) as pool:\n    # Map the process_func to all timesteps\n    pool.map(process_func, nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation: C/C++ Main",
    "content": "Post-Processing Tools getab.c char filename[80], nameTrack[80]; scalar list = NULL; scalar f2[]; int main(int a, char const arguments[]) { sprintf ... getData.c char filename[80]; int nx, ny, len; double xmin, ymin, xmax, ymax, Deltax, Deltay, Oh = 0.; scalar f[], D2c[], vel[];... getData_02.c char filename[80]; int nx, ny, len; double xmin, ymin, xmax, ymax, Deltax, Deltay, Oh = 0.; scalar f[], D2c[], vel[],... getFacet.c scalar f[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, '%s', arguments[1]); rest... getFacet1.c scalar f1[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, '%s', arguments[1]); res... getFacet2.c scalar f2[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, '%s', arguments[1]); res... getFacet_02.c scalar f[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, '%s', arguments[1]); rest... geth.c char filename[80], nameTrack[80]; scalar list = NULL; scalar f[]; int main(int a, char const arguments[]) { sprintf (... out_ab_time.py import numpy as np import os import subprocess as sp def gettingab(filename): exe = ['./getab', filename] p = sp.Pope... out_h_time.py import numpy as np import os import subprocess as sp def gettingh(filename): exe = ['./geth', filename] p = sp.Popen(... out_theta_time_01.py import numpy as np import os import subprocess as sp from scipy.optimize import fsolve def gettingfacet1(filename): e... runpostProcess.sh source ~/.bashshell Oh=('1.00E-03' '3.00E-03' '6.00E-03' '1.00E-02' '3.00E-02' '6.00E-02' '1.00E-01') startdata=1010 ...",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation: Import Statements",
    "content": "VideoBubbleinSheet.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli... VideoBubbleinSheet_02.1_tp.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli... VideoBubbleinSheet_02_tp.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli... VideoBubbleinSheet_03.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli... VideoBubbleinSheet_03_all.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli... VideoBubbleinSheet_04.py import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotli...",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/out_ab_time.py | Documentation: Python Function",
    "content": "postProcess/out_ab_time.py See raw file # To out major axis a, and minor axis b, over time import numpy as np import os import subprocess as sp def getting_ab(filename): exe = [ \"./getab\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) temp3 = temp2[ 0 ].split( \" \" ) return float (temp3[ 0 ]), float (temp3[ 1 ]), float (temp3[ 2 ]), float (temp3[ 3 ]), float (temp3[ 4 ]) # ---------------------------------------------------------------------------------------------------------------------- nGFS = 10000 tsnap = 0.1 for ti in range (nGFS): t = tsnap * ti place = \"intermediate/snapshot- %5.4f \" % t if not os.path.exists(place): print ( \" %s File not found!\" % place) else : tp, xmax, y_xmax, x_ymax, ymax = getting_ab(place) # time, number od drops, volume, x, y print (tp) print ( \"Time: %4.3f , xmax: %4.3f , y_xmax: %4.3f , x_ymax: %4.3f , ymax: %4.3f \" % (tp, xmax, y_xmax, x_ymax, ymax)) f = open ( \"out_ab_time.txt\" , \"a\" ) f.write( \" %4.6f \" % (tp)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (xmax)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (y_xmax)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (x_ymax)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (ymax)) f.write( \" \\t \" ) f.write( \" \\n \" ) f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_ab_time.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/out_ab_time.py | Documentation - Code Example: # To out...",
    "content": "# To out major axis a, and minor axis b, over timeimportnumpyasnpimportosimportsubprocessasspdefgetting_ab(filename):exe=[\"./getab\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")temp3=temp2[0].split(\" \")returnfloat(temp3[0]),float(temp3[1]),float(temp3[2]),float(temp3[3]),float(temp3[4])# ----------------------------------------------------------------------------------------------------------------------nGFS=10000tsnap=0.1fortiinrange(nGFS):t=tsnap*tiplace=\"intermediate/snapshot-%5.4f\"%tifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:tp, xmax, y_xmax, x_ymax, ymax=getting_ab(place)# time, number od drops, volume, x, yprint(tp)print(\"Time:%4.3f, xmax:%4.3f, y_xmax:%4.3f, x_ymax:%4.3f, ymax:%4.3f\"%(tp, xmax, y_xmax, x_ymax, ymax))f=open(\"out_ab_time.txt\",\"a\")f.write(\"%4.6f\"%(tp))f.write(\"\\t\")f.write(\"%4.6f\"%(xmax))f.write(\"\\t\")f.write(\"%4.6f\"%(y_xmax))f.write(\"\\t\")f.write(\"%4.6f\"%(x_ymax))f.write(\"\\t\")f.write(\"%4.6f\"%(ymax))f.write(\"\\t\")f.write(\"\\n\")f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_ab_time.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/runpostProcess.sh | Documentation",
    "content": "postProcess/runpostProcess.sh See raw file runpostProcess.sh #!/bin/bash #SBATCH -N 1 #SBATCH --partition=genoa #SBATCH --ntasks-per-node=32 #SBATCH --time=2:00:00 #SBATCH --error=job.%J.err #SBATCH --output=job.%J.out source ~/.bash_shell Oh = ( \"1.00E-03\" \"3.00E-03\" \"6.00E-03\" \"1.00E-02\" \"3.00E-02\" \"6.00E-02\" \"1.00E-01\" ) start_data = 1010 start = 1015 end = 1016 for (( i = start ; i <= end ; i ++ )); do dir = \\$ i index = \\$ (( i - start_data )) cd \\$ dir || { echo \"Failed to change directory to \\$ dir\" ; exit 1 ; } python3 VideoBubbleinSheet.py --Oh \\$ {Oh [ index ] } & cd ../ done wait for (( i = start ; i <= end ; i ++ )); do dir = \\$ i/Video cd \\$ dir || { echo \"Failed to change directory to \\$ dir\" ; exit 1 ; } rm -f * .mp4 mkvids \\$ i.mp4 & cd ../../ done wait",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/runpostProcess.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/runpostProcess.sh | Documentation - Code Example: #!/bin/bash#SBATCH -N 1#SBATCH...",
    "content": "#!/bin/bash#SBATCH -N 1#SBATCH --partition=genoa#SBATCH --ntasks-per-node=32#SBATCH --time=2:00:00#SBATCH --error=job.%J.err#SBATCH --output=job.%J.outsource~/.bash_shellOh=(\"1.00E-03\"\"3.00E-03\"\"6.00E-03\"\"1.00E-02\"\"3.00E-02\"\"6.00E-02\"\"1.00E-01\")start_data=1010start=1015end=1016for((i=start;i<=end;i++));dodir=\\$iindex=\\$((i-start_data))cd\\$dir||{echo\"Failed to change directory to\\$dir\";exit1;}python3VideoBubbleinSheet.py--Oh\\${Oh[index]}&cd../donewaitfor((i=start;i<=end;i++));dodir=\\$i/Videocd\\$dir||{echo\"Failed to change directory to\\$dir\";exit1;}rm-f*.mp4mkvids\\$i.mp4&cd../../donewait",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/runpostProcess.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet1.c | Documentation",
    "content": "postProcess/getFacet1.c See raw file /* Title: Getting Facets # Author: Vatsal Sanjay # vatsalsanjay@gmail.com # Physics of Fluids #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d scalar f1[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); #if TREE f1.prolongation = fraction_refine; #endif boundary((scalar ){f1}); FILE * fp = ferr; output_facets(f1,fp); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getFacet1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation: C/C++ Code",
    "content": "postProcess/getData_02.c See raw file // get data #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d char filename[80]; int nx, ny, len; double xmin, ymin, xmax, ymax, Deltax, Deltay, Oh = 0.; scalar f[], D2c[], vel[], rhov[]; scalar *list = NULL; int main(int a, char const *arguments[]) { sprintf(filename, \u201c%s\u201d, arguments[1]); xmin = atof(arguments[2]); ymin = atof(arguments[3]); xmax = atof(arguments[4]); ymax = atof(arguments[5]); ny = atoi(arguments[6]); Oh = atof(arguments[7]); list = list_add(list, D2c); list = list_add(list, vel); list = list_add(list, u.x); list = list_add(list, u.y); // boundary conditions u.n[right] = neumann(0.); p[right] = dirichlet(0.); restore(file = filename); f.prolongation = fraction_refine; boundary((scalar *){f, u.x, u.y}); foreach () { double D11 = (u.y[0, 1] - u.y[0, -1]) / (2 * Delta); double D22 = (u.y[] / y); double D33 = (u.x[1, 0] - u.x[-1, 0]) / (2 * Delta); double D13 = 0.5 * ((u.y[1, 0] - u.y[-1, 0] + u.x[0, 1] - u.x[0, -1]) / (2 * Delta)); double D2 = (sq(D11) + sq(D22) + sq(D33) + 2.0 * sq(D13)); D2c[] = 2 * (clamp(f[], 0., 1.) * (Oh - 2e-2 * Oh) + 2e-2 * Oh) * D2; D2c[] = (D2c[] > 0.) ? log(D2c[]) / log(10) : -10; // vel[] = clamp(f[], 0., 1.)*(sqrt(sq(u.x[]) + sq(u.y[]))); vel[] = clamp(f[], 0., 1.-1e-6); } boundary((scalar *){D2c, vel}); FILE *fp = ferr; Deltay = (double)(ymax - ymin) / (ny); nx = (int)(xmax - xmin) / Deltay; Deltax = (double)(xmax - xmin) / (nx); len = list_len(list); double **field = (double **)matrix_new(nx, ny + 1, len * sizeof(double)); for (int i = 0; i < nx; i++) { double x = Deltax * (i + 0.5) + xmin; for (int j = 0; j < ny; j++) { double y = Deltay * (j + 0.5) + ymin; int k = 0; for (scalar s in list) { field[i][len * j + k++] = interpolate(s, x, y); } } } for (int i = 0; i < nx; i++) { double x = Deltax * (i + 0.5) + xmin; for (int j = 0; j < ny; j++) { double y = Deltay * (j + 0.5) + ymin; fprintf(fp, \"%g %g\", x, y); int k = 0; for (scalar s in list) { fprintf(fp, \" %g\", field[i][len * j + k++]); } fputc('\\n', fp); } } fflush(fp); fclose(fp); matrix_free(field); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation - Code Example: list = list_add(list,...",
    "content": "list = list_add(list, D2c);\nlist = list_add(list, vel);\nlist = list_add(list, u.x);\nlist = list_add(list, u.y); // boundary conditions\nu.n[right] = neumann(0.);\np[right] = dirichlet(0.); restore(file = filename);\nf.prolongation = fraction_refine;\nboundary((scalar *){f, u.x, u.y});",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation - Code Example: foreach () {...",
    "content": "foreach ()\n{\n    double D11 = (u.y[0, 1] - u.y[0, -1]) / (2 * Delta);\n    double D22 = (u.y[] / y);\n    double D33 = (u.x[1, 0] - u.x[-1, 0]) / (2 * Delta);\n    double D13 = 0.5 * ((u.y[1, 0] - u.y[-1, 0] + u.x[0, 1] - u.x[0, -1]) / (2 * Delta));\n    double D2 = (sq(D11) + sq(D22) + sq(D33) + 2.0 * sq(D13));\n    D2c[] = 2 * (clamp(f[], 0., 1.) * (Oh - 2e-2 * Oh) + 2e-2 * Oh) * D2;",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation - Code Example: D2c[] = (D2c[]...",
    "content": "D2c[] = (D2c[] > 0.) ? log(D2c[]) / log(10) : -10;\n    // vel[] = clamp(f[], 0., 1.)*(sqrt(sq(u.x[]) + sq(u.y[])));\n    vel[] = clamp(f[], 0., 1.-1e-6);\n}\nboundary((scalar *){D2c, vel}); FILE *fp = ferr;\nDeltay = (double)(ymax - ymin) / (ny);\nnx = (int)(xmax - xmin) / Deltay;\nDeltax = (double)(xmax - xmin) / (nx);\nlen = list_len(list);",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation - Code Example: double **field =...",
    "content": "double **field = (double **)matrix_new(nx, ny + 1, len * sizeof(double));\nfor (int i = 0; i < nx; i++)\n{\n    double x = Deltax * (i + 0.5) + xmin;\n    for (int j = 0; j < ny; j++)\n    {\n        double y = Deltay * (j + 0.5) + ymin;\n        int k = 0;\n        for (scalar s in list)\n        {\n            field[i][len * j + k++] = interpolate(s, x, y);\n        }\n    }\n}",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData_02.c | Documentation - Code Example: for (int i...",
    "content": "for (int i = 0; i < nx; i++)\n{\n    double x = Deltax * (i + 0.5) + xmin;\n    for (int j = 0; j < ny; j++)\n    {\n        double y = Deltay * (j + 0.5) + ymin;\n        fprintf(fp, \"%g %g\", x, y);\n        int k = 0;\n        for (scalar s in list)\n        {\n            fprintf(fp, \" %g\", field[i][len * j + k++]);\n        }\n        fputc('\\n', fp);\n    }\n}\nfflush(fp);\nfclose(fp);\nmatrix_free(field);",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData_02.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2.c | Documentation",
    "content": "postProcess/getFacet2.c See raw file /* Title: Getting Facets # Author: Vatsal Sanjay # vatsalsanjay@gmail.com # Physics of Fluids #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d scalar f2[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); #if TREE f2.prolongation = fraction_refine; #endif boundary((scalar ){f2}); FILE * fp = ferr; output_facets(f2,fp); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getFacet2.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet_04.py See raw file # To get facets for bubbles in sheets || Add vectors in the velocity plot import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection import multiprocessing as mp from functools import partial from pathlib import Path import argparse from matplotlib.ticker import StrMethodFormatter import random matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, asy): exe = [ \"./getFacet\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() stderr_output = stderr.decode( \"utf-8\" ) points = stderr_output.split( \" \\n \" ) segments = [] if len (points) > 100 : for i in range ( len (points) - 1 ): current_point = points[i].split() if current_point: next_point = points[i + 1 ].split() if next_point: r1, z1 = float (current_point[ 1 ]), float (current_point[ 0 ]) r2, z2 = float (next_point[ 1 ]), float (next_point[ 0 ]) if asy: segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)) ] else : segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)), ((r1, - z1), (r2, - z2)), (( - r1, - z1), ( - r2, - z2)) ] segments.extend(segment_variants) return segments def gettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh): exe = [ \"./getData\" , filename, str (zmin), str (rmin), str (zmax), str (rmax), str (nr), str (Oh)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() lines = stderr.decode( \"utf-8\" ).split( \" \\n \" ) Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp = [],[],[],[],[],[] for i in range ( len (lines)): values = lines[i].split( \" \" ) if values == [ '' ]: pass else : Ztemp.append( float (values[ 0 ])) Rtemp.append( float (values[ 1 ])) D2temp.append( float (values[ 2 ])) veltemp.append( float (values[ 3 ])) Utemp.append( float (values[ 4 ])) Vtemp.append( float (values[ 5 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) U = np.asarray(Utemp) V = np.asarray(Vtemp) nz = int ( len (Z) / nr) # print(f\"nz is {nz}\") R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) U.resize((nz, nr)) V.resize((nz, nr)) return R, Z, D2, vel, U, V, nz def process_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain): t = 0.1*ti snapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\") output_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists(): print(f\"{snapshot_file} not found!\") return if output_file.exists(): print(f\"{output_file} already present!\") return segs = gettingFacets(snapshot_file, asy) if not segs: print(f\"Problem in the available file {snapshot_file}\") return R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh) # Part to plot AxesLabel, TickLabel = [50, 35] fig, ax = plt.subplots() fig.set_size_inches(19.20, 10.80) if not asy: rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2 ax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw) ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw) ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Drawing Facets line_segments = LineCollection(segs, linewidths=3.25, colors='green', linestyle='solid') ax.add_collection(line_segments) ax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.3f}', fontsize=TickLabel) ## Copied Lines ax.set_aspect('equal') ax.set_xlim(-rmax, rmax) ax.set_ylim(zmin, zmax) velmax, velmin = 0.05, 0.00 d2max, d2min = -1, -4 # print(f\"max D2 is {d2max} and min D2 is {d2min}\") # print(f\"max vel is {velmax} and min vel is {velmin}\") if asy: cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) else: rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min) l, b, w, h = ax.get_position().bounds cb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03]) c1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal') c1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25) c1.ax.tick_params(labelsize=TickLabel) c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.2f}')) c1.set_ticks([velmax, velmin]) cb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03]) c2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal') c2.ax.tick_params(labelsize=TickLabel) c2.set_label(r\"$\\log_{10}\\left(2\\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25) c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) c2.set_ticks([d2max, d2min]) n = 14 # Adjust this value to control the density R_reduced = R[::n, ::n] Z_reduced = Z[::n, ::n] U_reduced = U[::n, ::n] V_reduced = V[::n, ::n] magnitude = np.sqrt(U_reduced**2 + V_reduced**2) U_reduced = U_reduced/magnitude V_reduced = V_reduced/magnitude # Plot vectors # ax.quiver(-R_filtered, Z_filtered, -V_filtered, U_filtered, color='black', scale=20, headwidth=3, headlength=4, headaxislength=4, width=0.002) # ax.quiver(-R_filtered, Z_filtered, -V_filtered, U_filtered) ax.quiver(-R_reduced, Z_reduced, -V_reduced, U_reduced, color='black', scale=75, headwidth=3.5, headlength=4, headaxislength=3.8, width=0.0018) # ax.quiver(R_filtered, Z_filtered, V_filtered, U_filtered, color='#1F77B4', scale=10, headwidth=3, headlength=4, headaxislength=4, width=0.002) # ax.quiver(R, Z, ux, uy, color='black', scale=1000) ax.axis('off') # plt.show() plt.savefig(output_file, bbox_inches=\"tight\", dpi=250) plt.close() print(f\"{ti+1} is done\") def main(): parser = argparse.ArgumentParser(description=\u201cProcess facets for bubbles in sheets.\u201d) parser.add_argument(\u2018\u2013asy\u2019, action=\u2018store_true\u2019, help=\u201cIf set, use asymmetric variants.",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation: Context",
    "content": "Default is false.\u201d) parser.add_argument(\u2018\u2013Oh\u2019, type=float, default=0.01, help=\u201cOh value.\u201d) args = parser.parse_args() nGFS = 10000 Ldomain = 4 GridsPerR = 64 nr = int(GridsPerR*Ldomain) if args.asy: rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2 else: rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 lw = 2 folder = Path('Video') # output folder if not folder.is_dir(): os.makedirs(folder) # Prepare the partial function with fixed arguments # process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr) process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores num_processes = 6 #mp.cpu_count() nGFS_list = list(range(250, nGFS)) random.shuffle(nGFS_list) # Create a pool of worker processes with mp.Pool(processes=num_processes) as pool: # Map the process_func to all timesteps pool.map(process_func, nGFS_list) if name == \u201c main \u201d: main()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheets || Add vectors in the velocity plotimportnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionimportmultiprocessingasmpfromfunctoolsimportpartialfrompathlibimportPathimportargparsefrommatplotlib.tickerimportStrMethodFormatterimportrandommatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, asy):exe=[\"./getFacet\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()stderr_output=stderr.decode(\"utf-8\")points=stderr_output.split(\"\\n\")segments=[]iflen(points)>100:foriinrange(len(points)-1):current_point=points[i].split()ifcurrent_point:next_point=points[i+1].split()ifnext_point:r1, z1=float(current_point[1]),float(current_point[0])r2, z2=float(next_point[1]),float(next_point[0])ifasy:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2))]else:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2)),((r1,-z1), (r2,-z2)),((-r1,-z1), (-r2,-z2))]segments.extend(segment_variants)returnsegmentsdefgettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh):exe=[\"./getData\", filename,str(zmin),str(rmin),str(zmax),str(rmax),str(nr),str(Oh)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()lines=stderr.decode(\"utf-8\").split(\"\\n\")Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp=[],[],[],[],[],[]foriinrange(len(lines)):values=lines[i].split(\" \")ifvalues==['']:passelse:Ztemp.append(float(values[0]))Rtemp.append(float(values[1]))D2temp.append(float(values[2]))veltemp.append(float(values[3]))Utemp.append(float(values[4]))Vtemp.append(float(values[5]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)U=np.asarray(Utemp)V=np.asarray(Vtemp)nz=int(len(Z)/nr)# print(f\"nz is {nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))U.resize((nz, nr))V.resize((nz, nr))returnR, Z, D2, vel, U, V, nzdefprocess_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain):",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: Context",
    "content": "t = 0.1*ti\nsnapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\")\noutput_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists():\n    print(f\"{snapshot_file} not found!\")\n    return if output_file.exists():\n    print(f\"{output_file} already present!\")\n    return segs = gettingFacets(snapshot_file, asy) if not segs:\n    print(f\"Problem in the available file {snapshot_file}\")\n    return",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: R, Z, D2,...",
    "content": "R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh)\n# Part to plot\nAxesLabel, TickLabel = [50, 35]\nfig, ax = plt.subplots()\nfig.set_size_inches(19.20, 10.80) if not asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2\n    \nax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: Context",
    "content": "ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw)\nax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Drawing Facets\nline_segments = LineCollection(segs, linewidths=3.25, colors='green', linestyle='solid')\nax.add_collection(line_segments)\nax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.3f}', fontsize=TickLabel)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: ## Copied Lines...",
    "content": "## Copied Lines\nax.set_aspect('equal')\nax.set_xlim(-rmax, rmax)\nax.set_ylim(zmin, zmax) velmax, velmin = 0.05, 0.00\nd2max, d2min = -1, -4 \n# print(f\"max D2 is {d2max} and min D2 is {d2min}\")\n# print(f\"max vel is {velmax} and min vel is {velmin}\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: if asy: cntrl1...",
    "content": "if asy:\n    cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: else: rmin, rmax,...",
    "content": "else:   \n    rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\n    cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)\n    cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: l, b, w,...",
    "content": "l, b, w, h = ax.get_position().bounds\ncb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03])\nc1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal')\nc1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25)\nc1.ax.tick_params(labelsize=TickLabel)\nc1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.2f}'))\nc1.set_ticks([velmax, velmin])\ncb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03])\nc2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal')\nc2.ax.tick_params(labelsize=TickLabel)\nc2.set_label(r\"$\\log_{10}\\left(2\\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25)\nc2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) \nc2.set_ticks([d2max, d2min])",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: n = 14...",
    "content": "n = 14  # Adjust this value to control the density\nR_reduced = R[::n, ::n]\nZ_reduced = Z[::n, ::n]\nU_reduced = U[::n, ::n]\nV_reduced = V[::n, ::n] magnitude = np.sqrt(U_reduced**2 + V_reduced**2) U_reduced = U_reduced/magnitude\nV_reduced = V_reduced/magnitude",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: # Plot vectors...",
    "content": "# Plot vectors\n# ax.quiver(-R_filtered, Z_filtered, -V_filtered, U_filtered, color='black', scale=20, headwidth=3, headlength=4, headaxislength=4, width=0.002)\n# ax.quiver(-R_filtered, Z_filtered, -V_filtered, U_filtered)\nax.quiver(-R_reduced, Z_reduced, -V_reduced, U_reduced, color='black', scale=75, headwidth=3.5, headlength=4, headaxislength=3.8, width=0.0018)\n# ax.quiver(R_filtered, Z_filtered, V_filtered, U_filtered, color='#1F77B4', scale=10, headwidth=3, headlength=4, headaxislength=4, width=0.002)     \n# ax.quiver(R, Z, ux, uy, color='black', scale=1000)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: Context",
    "content": "ax.axis('off')\n# plt.show()\nplt.savefig(output_file, bbox_inches=\"tight\", dpi=250)\nplt.close()\nprint(f\"{ti+1} is done\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: nGFS = 10000...",
    "content": "nGFS = 10000\nLdomain = 4\nGridsPerR = 64\nnr = int(GridsPerR*Ldomain) if args.asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2\nelse:\n    rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\nlw = 2 folder = Path('Video')  # output folder if not folder.is_dir():\n    os.makedirs(folder)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: Function Definition",
    "content": "# Prepare the partial function with fixed arguments\n# process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr)\nprocess_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores\nnum_processes = 6 #mp.cpu_count() nGFS_list = list(range(250, nGFS))\nrandom.shuffle(nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_04.py | Documentation - Code Example: # Create a...",
    "content": "# Create a pool of worker processes\nwith mp.Pool(processes=num_processes) as pool:\n    # Map the process_func to all timesteps\n    pool.map(process_func, nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_04.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet_03.py See raw file # To get facets for bubbles in sheets import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection import multiprocessing as mp from functools import partial from pathlib import Path import argparse from matplotlib.ticker import StrMethodFormatter import random import matplotlib.colors as mcolors custom_colors = [ \"white\" , \"#8DCDF0\" ] custom_cmap = mcolors.LinearSegmentedColormap.from_list( \"custom_blue\" , custom_colors) matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, asy): exe = [ \"./getFacet\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() stderr_output = stderr.decode( \"utf-8\" ) points = stderr_output.split( \" \\n \" ) segments = [] if len (points) > 100 : for i in range ( len (points) - 1 ): current_point = points[i].split() if current_point: next_point = points[i + 1 ].split() if next_point: r1, z1 = float (current_point[ 1 ]), float (current_point[ 0 ]) r2, z2 = float (next_point[ 1 ]), float (next_point[ 0 ]) if asy: segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)) ] else : segment_variants = [ ((r1, z1), (r2, z2)), (( - r1, z1), ( - r2, z2)), ((r1, - z1), (r2, - z2)), (( - r1, - z1), ( - r2, - z2)) ] segments.extend(segment_variants) return segments def gettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh): exe = [ \"./getData_02\" , filename, str (zmin), str (rmin), str (zmax), str (rmax), str (nr), str (Oh)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() lines = stderr.decode( \"utf-8\" ).split( \" \\n \" ) Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp = [],[],[],[],[],[] for i in range ( len (lines)): values = lines[i].split( \" \" ) if values == [ '' ]: pass else : Ztemp.append( float (values[ 0 ])) Rtemp.append( float (values[ 1 ])) D2temp.append( float (values[ 2 ])) veltemp.append( float (values[ 3 ])) Utemp.append( float (values[ 4 ])) Vtemp.append( float (values[ 5 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) U = np.asarray(Utemp) V = np.asarray(Vtemp) nz = int ( len (Z) / nr) # print(f\"nz is {nz}\") R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) U.resize((nz, nr)) V.resize((nz, nr)) return R, Z, D2, vel, U, V, nz def process_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain): t = 0.01*ti snapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\") output_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists(): print(f\"{snapshot_file} not found!\") return if output_file.exists(): print(f\"{output_file} already present!\") return segs = gettingFacets(snapshot_file, asy) if not segs: print(f\"Problem in the available file {snapshot_file}\") return R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh) # Part to plot AxesLabel, TickLabel = [50, 35] fig, ax = plt.subplots() fig.set_size_inches(19.20, 10.80) if not asy: rmin, rmax, zmin, zmax = 0, Ldomain, -1.5, 1.5 ax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw) ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw) ax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw) ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Copied Lines ax.set_aspect('equal') ax.set_xlim(-rmax, rmax) ax.set_ylim(zmin, zmax) velmax, velmin = np.max(vel), np.min(vel) # velmax, velmin = 1.5, 1e-3 # d2max, d2min = np.max(D2), np.min(D2) d2max, d2min = np.max(vel), np.min(vel) # print(f\"max D2 is {d2max} and min D2 is {d2min}\") # print(f\"max vel is {velmax} and min vel is {velmin}\") if asy: cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) else: rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 cntrl1 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min) cntrl1 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin) cntrl2 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min) ## Drawing Facets line_segments = LineCollection(segs, linewidths=3.25, colors='black', linestyle='solid') ax.add_collection(line_segments) ax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.1f}', fontsize=TickLabel) # l, b, w, h = ax.get_position().bounds # cb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03]) # c1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal') # c1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25) # c1.ax.tick_params(labelsize=TickLabel) # c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.3f}')) # c1.set_ticks([velmax, velmin]) # cb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03]) # c2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal') # c2.ax.tick_params(labelsize=TickLabel) # c2.set_label(r\"$\\log_{10}\\left(2 Oh \\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25) # c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) # c2.set_ticks([d2max, d2min]) ax.axis('off') # plt.show() plt.savefig(output_file, bbox_inches=\"tight\", dpi=250) plt.close() print(f\"{ti+1} is done\") def main(): parser = argparse.ArgumentParser(description=\u201cProcess facets for bubbles in sheets.\u201d) parser.add_argument(\u2018\u2013asy\u2019, action=\u2018store_true\u2019, help=\u201cIf set, use asymmetric variants.",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation: Context",
    "content": "Default is false.\u201d) parser.add_argument(\u2018\u2013Oh\u2019, type=float, default=0.01, help=\u201cOh value.\u201d) args = parser.parse_args() nGFS = 10000 Ldomain = 4 GridsPerR = 64 nr = int(GridsPerR*Ldomain) if args.asy: rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2 else: rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2 lw = 2 folder = Path('Video_02') # output folder if not folder.is_dir(): os.makedirs(folder) # Prepare the partial function with fixed arguments # process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr) process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores num_processes = 3 #mp.cpu_count() nGFS_list = list(range(nGFS)) random.shuffle(nGFS_list) # Create a pool of worker processes with mp.Pool(processes=num_processes) as pool: # Map the process_func to all timesteps pool.map(process_func, nGFS_list) if name == \u201c main \u201d: main()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheetsimportnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionimportmultiprocessingasmpfromfunctoolsimportpartialfrompathlibimportPathimportargparsefrommatplotlib.tickerimportStrMethodFormatterimportrandomimportmatplotlib.colorsasmcolorscustom_colors=[\"white\",\"#8DCDF0\"]custom_cmap=mcolors.LinearSegmentedColormap.from_list(\"custom_blue\", custom_colors)matplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, asy):exe=[\"./getFacet\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()stderr_output=stderr.decode(\"utf-8\")points=stderr_output.split(\"\\n\")segments=[]iflen(points)>100:foriinrange(len(points)-1):current_point=points[i].split()ifcurrent_point:next_point=points[i+1].split()ifnext_point:r1, z1=float(current_point[1]),float(current_point[0])r2, z2=float(next_point[1]),float(next_point[0])ifasy:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2))]else:segment_variants=[((r1, z1), (r2, z2)),((-r1, z1), (-r2, z2)),((r1,-z1), (r2,-z2)),((-r1,-z1), (-r2,-z2))]segments.extend(segment_variants)returnsegmentsdefgettingfield(filename, zmin, rmin, zmax, rmax, nr, Oh):exe=[\"./getData_02\", filename,str(zmin),str(rmin),str(zmax),str(rmax),str(nr),str(Oh)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()lines=stderr.decode(\"utf-8\").split(\"\\n\")Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp=[],[],[],[],[],[]foriinrange(len(lines)):values=lines[i].split(\" \")ifvalues==['']:passelse:Ztemp.append(float(values[0]))Rtemp.append(float(values[1]))D2temp.append(float(values[2]))veltemp.append(float(values[3]))Utemp.append(float(values[4]))Vtemp.append(float(values[5]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)U=np.asarray(Utemp)V=np.asarray(Vtemp)nz=int(len(Z)/nr)# print(f\"nz is {nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))U.resize((nz, nr))V.resize((nz, nr))returnR, Z, D2, vel, U, V, nzdefprocess_timestep(ti, folder, rmin, rmax, zmin, zmax, lw, asy, Oh, nr, Ldomain):",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: Context",
    "content": "t = 0.01*ti\nsnapshot_file = Path(f\"intermediate/snapshot-{t:.4f}\")\noutput_file = folder / f\"{int(t * 1000):08d}.png\" if not snapshot_file.exists():\n    print(f\"{snapshot_file} not found!\")\n    return if output_file.exists():\n    print(f\"{output_file} already present!\")\n    return segs = gettingFacets(snapshot_file, asy) if not segs:\n    print(f\"Problem in the available file {snapshot_file}\")\n    return",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: R, Z, D2,...",
    "content": "R, Z, D2, vel, U, V, nz = gettingfield(snapshot_file, zmin, rmin, zmax, rmax, nr, Oh)\n# Part to plot\nAxesLabel, TickLabel = [50, 35]\nfig, ax = plt.subplots()\nfig.set_size_inches(19.20, 10.80) if not asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -1.5, 1.5\n    \nax.plot([0, 0], [zmin, zmax],'-.',color='grey',linewidth=lw)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: Context",
    "content": "ax.plot([-rmax, -rmax], [zmin, zmax],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmin, zmin],'-',color='black',linewidth=lw)\nax.plot([-rmax, rmax], [zmax, zmax],'-',color='black',linewidth=lw)\nax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw) ## Copied Lines\nax.set_aspect('equal')\nax.set_xlim(-rmax, rmax)\nax.set_ylim(zmin, zmax)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: velmax, velmin =...",
    "content": "velmax, velmin = np.max(vel), np.min(vel) \n# velmax, velmin = 1.5, 1e-3\n# d2max, d2min = np.max(D2), np.min(D2) \nd2max, d2min = np.max(vel), np.min(vel) \n# print(f\"max D2 is {d2max} and min D2 is {d2min}\")\n# print(f\"max vel is {velmax} and min vel is {velmin}\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: if asy: cntrl1...",
    "content": "if asy:\n    cntrl1 = ax.imshow(vel, cmap=\"Blues\", interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(D2, cmap=\"hot_r\", interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: else: rmin, rmax,...",
    "content": "else:   \n    rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\n    cntrl1 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, zmax], vmax=d2max, vmin=d2min)\n    cntrl1 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, -rmax, zmin, -zmax], vmax=velmax, vmin=velmin)\n    cntrl2 = ax.imshow(vel, cmap=custom_cmap, interpolation='Bilinear', origin='lower', extent=[rmin, rmax, zmin, -zmax], vmax=d2max, vmin=d2min)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: ## Drawing Facets...",
    "content": "## Drawing Facets\nline_segments = LineCollection(segs, linewidths=3.25, colors='black', linestyle='solid')\nax.add_collection(line_segments)\nax.set_title(f'$t/\\\\tau_\\gamma$ = {t:.1f}', fontsize=TickLabel)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: # l, b,...",
    "content": "# l, b, w, h = ax.get_position().bounds\n# cb1 = fig.add_axes([l+0.05*w, b-0.05, 0.40*w, 0.03])\n# c1 = plt.colorbar(cntrl1,cax=cb1,orientation='horizontal')\n# c1.set_label(r'$\\|\\mathbf{v}\\|/\\sqrt{\\gamma/\\rho R_0}$',fontsize=TickLabel, labelpad=-25)\n# c1.ax.tick_params(labelsize=TickLabel)\n# c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.3f}'))\n# c1.set_ticks([velmax, velmin])\n# cb2 = fig.add_axes([l+0.55*w, b-0.05, 0.40*w, 0.03])\n# c2 = plt.colorbar(cntrl2,cax=cb2,orientation='horizontal')\n# c2.ax.tick_params(labelsize=TickLabel)\n# c2.set_label(r\"$\\log_{10}\\left(2 Oh \\left( \\boldsymbol{\\mathcal {D} : \\mathcal {D}} \\right) \\right)$\",fontsize=TickLabel, labelpad=-25)\n# c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}')) \n# c2.set_ticks([d2max, d2min])",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: Context",
    "content": "ax.axis('off')\n# plt.show()\nplt.savefig(output_file, bbox_inches=\"tight\", dpi=250)\nplt.close()\nprint(f\"{ti+1} is done\")",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: nGFS = 10000...",
    "content": "nGFS = 10000\nLdomain = 4\nGridsPerR = 64\nnr = int(GridsPerR*Ldomain) if args.asy:\n    rmin, rmax, zmin, zmax = 0, Ldomain, -Ldomain/2, Ldomain/2\nelse:\n    rmin, rmax, zmin, zmax = 0, Ldomain, 0, Ldomain/2\nlw = 2 folder = Path('Video_02')  # output folder if not folder.is_dir():\n    os.makedirs(folder)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: Function Definition",
    "content": "# Prepare the partial function with fixed arguments\n# process_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, nr=nr)\nprocess_func = partial(process_timestep, folder=folder, rmin=rmin, rmax=rmax, zmin=zmin, zmax=zmax, lw=lw, asy=args.asy, Oh=args.Oh, nr=nr, Ldomain=Ldomain) # Use all available CPU cores\nnum_processes = 3 #mp.cpu_count() nGFS_list = list(range(nGFS))\nrandom.shuffle(nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_03.py | Documentation - Code Example: # Create a...",
    "content": "# Create a pool of worker processes\nwith mp.Pool(processes=num_processes) as pool:\n    # Map the process_func to all timesteps\n    pool.map(process_func, nGFS_list)",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_03.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/geth.c | Documentation",
    "content": "postProcess/geth.c See raw file // get film thickness h #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d char filename[80], nameTrack[80]; scalar * list = NULL; scalar f[]; int main(int a, char const *arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); boundary((scalar *){f, u.x, u.y}); double xmax = -HUGE; double y_xmax = 0; foreach(){ if (x > xmax && f[] > 1-1e-3 && y < 0.05) { xmax = x; y_xmax = y; } } FILE * fp = ferr; fprintf(ferr, \u201c%f %7.6e %7.6e\u201d, t, xmax, y_xmax); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/geth.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/out_h_time.py | Documentation: Python Function",
    "content": "postProcess/out_h_time.py See raw file # To out film thickness import numpy as np import os import subprocess as sp def getting_h(filename): exe = [ \"./geth\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) temp3 = temp2[ 0 ].split( \" \" ) return float (temp3[ 0 ]), float (temp3[ 1 ]), float (temp3[ 2 ]) # ---------------------------------------------------------------------------------------------------------------------- nGFS = 10000 tsnap = 0.1 for ti in range (nGFS): t = tsnap * ti place = \"intermediate/snapshot- %5.4f \" % t if not os.path.exists(place): print ( \" %s File not found!\" % place) else : tp, xmax, y_xmax = getting_h(place) print (tp) print ( \"Time: %4.3f , xmax: %4.3f , y_xmax: %4.3f \" % (tp, xmax, y_xmax)) f = open ( \"out_h_time.txt\" , \"a\" ) f.write( \" %4.6f \" % (tp)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (xmax)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (y_xmax)) f.write( \" \\t \" ) f.write( \" \\n \" ) f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_h_time.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/out_h_time.py | Documentation - Code Example: # To out...",
    "content": "# To out film thicknessimportnumpyasnpimportosimportsubprocessasspdefgetting_h(filename):exe=[\"./geth\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")temp3=temp2[0].split(\" \")returnfloat(temp3[0]),float(temp3[1]),float(temp3[2])# ----------------------------------------------------------------------------------------------------------------------nGFS=10000tsnap=0.1fortiinrange(nGFS):t=tsnap*tiplace=\"intermediate/snapshot-%5.4f\"%tifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:tp, xmax, y_xmax=getting_h(place)print(tp)print(\"Time:%4.3f, xmax:%4.3f, y_xmax:%4.3f\"%(tp, xmax, y_xmax))f=open(\"out_h_time.txt\",\"a\")f.write(\"%4.6f\"%(tp))f.write(\"\\t\")f.write(\"%4.6f\"%(xmax))f.write(\"\\t\")f.write(\"%4.6f\"%(y_xmax))f.write(\"\\t\")f.write(\"\\n\")f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_h_time.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/out_theta_time_01.py | Documentation: Python Function",
    "content": "postProcess/out_theta_time_01.py See raw file # To out theta over time import numpy as np import os import subprocess as sp from scipy.optimize import fsolve def getting_facet1(filename): exe = [ \"./getFacet1\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) lines = temp1.splitlines() x = [] y = [] for line in lines: values = line.split() if len (values) == 2 : try : x_val = float (values[ 0 ]) y_val = float (values[ 1 ]) x.append(x_val) y.append(y_val) except ValueError : continue # Convert lists to numpy arrays x = np.array(x) y = np.array(y) theta = np.arctan2(y, x) sorted_indices = np.argsort(theta) return np.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices] # ---------------------------------------------------------------------------------------------------------------------- def getting_facet2(filename): exe = [ \"./getFacet2\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) lines = temp1.splitlines() x = [] y = [] for line in lines: values = line.split() if len (values) == 2 : try : x_val = float (values[ 0 ]) y_val = float (values[ 1 ]) x.append(x_val) y.append(y_val) except ValueError : continue # Convert lists to numpy arrays x = np.array(x) y = np.array(y) theta = np.arctan2(y, x) sorted_indices = np.argsort(theta) return np.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices] # ---------------------------------------------------------------------------------------------------------------------- def func(theta): # Interpolate r_fit1 and r_fit2 at the given theta r1 = np.interp(theta, theta_fit, r_fit1) r2 = np.interp(theta, theta_fit, r_fit2) return r1 - r2 - 2e-2 def fitradius(r, theta, theta_fit): degree = 10 coefficients = np.polyfit(theta, r, degree) return np.polyval(coefficients, theta_fit) nGFS = 10000 tsnap = 0.1 for ti in range ( 1 ): t = tsnap * ti place = \"intermediate/snapshot- %5.4f \" % t if not os.path.exists(place): print ( \" %s File not found!\" % place) else : x1, y1, theta1 = getting_facet1(place) x2, y2, theta2 = getting_facet2(place) r1 = np.sqrt(x1 * x1 + y1 * y1) r2 = np.sqrt(x2 * x2 + y2 * y2) theta_fit = np.linspace( 0 , np.pi / 2 , 1000 ) r_fit1 = fitradius(r1, theta1, theta_fit) r_fit2 = fitradius(r2, theta2, theta_fit) theta_sol = fsolve(func, 1.3 ) print (theta_sol) # print(\"x: %4.3f\" % (x)) f = open ( \"out_theta_time.txt\" , \"a\" ) f.write( \" %4.6f \" % (t)) f.write( \" \\t \" ) f.write( \" %4.6f \" % (theta_sol)) f.write( \" \\t \" ) f.write( \" \\n \" ) f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_theta_time_01.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/out_theta_time_01.py | Documentation - Code Example: # To out...",
    "content": "# To out theta over timeimportnumpyasnpimportosimportsubprocessasspfromscipy.optimizeimportfsolvedefgetting_facet1(filename):exe=[\"./getFacet1\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")lines=temp1.splitlines()x=[]y=[]forlineinlines:values=line.split()iflen(values)==2:try:x_val=float(values[0])y_val=float(values[1])x.append(x_val)y.append(y_val)exceptValueError:continue# Convert lists to numpy arraysx=np.array(x)y=np.array(y)theta=np.arctan2(y, x)sorted_indices=np.argsort(theta)returnnp.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices]# ----------------------------------------------------------------------------------------------------------------------defgetting_facet2(filename):exe=[\"./getFacet2\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")lines=temp1.splitlines()x=[]y=[]forlineinlines:values=line.split()iflen(values)==2:try:x_val=float(values[0])y_val=float(values[1])x.append(x_val)y.append(y_val)exceptValueError:continue# Convert lists to numpy arraysx=np.array(x)y=np.array(y)theta=np.arctan2(y, x)sorted_indices=np.argsort(theta)returnnp.array(x)[sorted_indices], np.array(y)[sorted_indices], np.array(theta)[sorted_indices]# ----------------------------------------------------------------------------------------------------------------------deffunc(theta):# Interpolate r_fit1 and r_fit2 at the given thetar1=np.interp(theta, theta_fit, r_fit1)r2=np.interp(theta, theta_fit, r_fit2)returnr1-r2-2e-2deffitradius(r, theta, theta_fit):degree=10coefficients=np.polyfit(theta, r, degree)returnnp.polyval(coefficients, theta_fit)nGFS=10000tsnap=0.1fortiinrange(1):t=tsnap*tiplace=\"intermediate/snapshot-%5.4f\"%tifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:x1, y1, theta1=getting_facet1(place)x2, y2, theta2=getting_facet2(place)r1=np.sqrt(x1*x1+y1*y1)r2=np.sqrt(x2*x2+y2*y2)theta_fit=np.linspace(0, np.pi/2,1000)r_fit1=fitradius(r1, theta1, theta_fit)r_fit2=fitradius(r2, theta2, theta_fit)theta_sol=fsolve(func,1.3)print(theta_sol)# print(\"x: %4.3f\" % (x))f=open(\"out_theta_time.txt\",\"a\")f.write(\"%4.6f\"%(t))f.write(\"\\t\")f.write(\"%4.6f\"%(theta_sol))f.write(\"\\t\")f.write(\"\\n\")f.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/out_theta_time_01.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_02_tp.py | Documentation: Import Statements",
    "content": "postProcess/VideoBubbleinSheet_02_tp.py See raw file # To get facets for bubbles in sheets import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import sys matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True # matplotlib.rcParams['text.latex.preamble'] = [r''] def gettingFacets1(filename): exe = [ \"./getFacet1\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingFacets2(filename): exe = [ \"./getFacet2\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) ##segs.append((r1,z1)) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) segs.append(((r1, - z1),(r2, - z2))) segs.append((( - r1, - z1),( - r2, - z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr, Ohs, Ohp, Oha): exe = [ \"./getData\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr), str (Ohs), str (Ohp), str (Oha)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp, taupTemp = [],[],[],[],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) Utemp.append( float (temp3[ 4 ])) Vtemp.append( float (temp3[ 5 ])) taupTemp.append( float (temp3[ 6 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) U = np.asarray(Utemp) V = np.asarray(Vtemp) taup = np.asarray(taupTemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) U.resize((nz, nr)) V.resize((nz, nr)) taup.resize((nz, nr)) return R, Z, D2, vel, U, V, taup, nz def getting_ab(filename): exe = [ \"./getab\" , filename] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) temp3 = temp2[ 0 ].split( \" \" ) return float (temp3[ 0 ]), float (temp3[ 1 ]), float (temp3[ 2 ]), float (temp3[ 3 ]), float (temp3[ 4 ]) # ---------------------------------------------------------------------------------------------------------------------- nGFS = 5000 Ldomain = 4 GridsPerR = 64 nr = int (GridsPerR * Ldomain) Ohs, Ohp, Oha = 1e-2 , 1e-2 , 1e-4 rmin, rmax, zmin, zmax = [ - Ldomain, Ldomain, - Ldomain / 2 , Ldomain / 2 ] lw = 2 folder = 'Video' # output folder if not os.path.isdir(folder): os.makedirs(folder) for ti in range (nGFS): t = 0.1 * ti place = \"intermediate/snapshot- %5.4f \" % t name = \" %s / %8.8d .png\" % (folder, int (t * 1000 )) if not os.path.exists(place): print ( \" %s File not found!\" % place) else : if os.path.exists(name): print ( \" %s Image present!\" % name) else : segs1 = gettingFacets1(place) segs2 = gettingFacets2(place) if ( len (segs1) == 0 ): print ( \"Problem in the available file %s \" % place) else : # R, Z, taus, vel, U, V, taup, nz = gettingfield(place, zmin, zmax, rmax, nr, Ohs, Ohp, Oha) # zminp, zmaxp, rminp, rmaxp = Z.min(), Z.max(), R.min(), R.max() t, xmax, y_xmax, x_ymax, ymax = getting_ab(place) # Part to plot AxesLabel, TickLabel = [ 50 , 35 ] fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) ax.plot([ 0 , 0 ], [zmin, zmax], '-.' ,color = 'grey' ,linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' ,color = 'black' ,linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' ,color = 'black' ,linewidth = lw) ## Drawing Facets line_segments1 = LineCollection(segs1, linewidths = 3.25 , colors = 'green' , linestyle = 'solid' ) line_segments2 = LineCollection(segs2, linewidths = 3.25 , colors = 'purple' , linestyle = 'solid' ) ax.add_collection(line_segments1) ax.add_collection(line_segments2) ax.set_title( '$t/ \\\\ tau_ \\ gamma$ = %4.3f ' % t, fontsize = TickLabel) #plt.scatter(segs[0], segs[1]) #print(\"The line collection array: \",segs) # Plotting the points ax.plot(xmax, y_xmax, 'ro' , markersize = 10 ) ax.plot(x_ymax, ymax, 'bo' , markersize = 10 ) ## Copied Lines ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.axis( 'off' ) # plt.show() plt.savefig(name, bbox_inches = \"tight\" , dpi = 250 ) plt.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_02_tp.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoBubbleinSheet_02_tp.py | Documentation - Code Example: # To get...",
    "content": "# To get facets for bubbles in sheetsimportnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportsysmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=True# matplotlib.rcParams['text.latex.preamble'] = [r'']defgettingFacets1(filename):exe=[\"./getFacet1\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=TruereturnsegsdefgettingFacets2(filename):exe=[\"./getFacet2\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])##segs.append((r1,z1))segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))segs.append(((r1,-z1),(r2,-z2)))segs.append(((-r1,-z1),(-r2,-z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr, Ohs, Ohp, Oha):exe=[\"./getData\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr),str(Ohs),str(Ohp),str(Oha)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp, Utemp, Vtemp, taupTemp=[],[],[],[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))Utemp.append(float(temp3[4]))Vtemp.append(float(temp3[5]))taupTemp.append(float(temp3[6]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)U=np.asarray(Utemp)V=np.asarray(Vtemp)taup=np.asarray(taupTemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))U.resize((nz, nr))V.resize((nz, nr))taup.resize((nz, nr))returnR, Z, D2, vel, U, V, taup, nzdefgetting_ab(filename):exe=[\"./getab\", filename]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")temp3=temp2[0].split(\" \")returnfloat(temp3[0]),float(temp3[1]),float(temp3[2]),float(temp3[3]),float(temp3[4])# ----------------------------------------------------------------------------------------------------------------------nGFS=5000Ldomain=4GridsPerR=64nr=int(GridsPerR*Ldomain)Ohs, Ohp, Oha=1e-2,1e-2,1e-4rmin, rmax, zmin, zmax=[-Ldomain, Ldomain,-Ldomain/2, Ldomain/2]lw=2folder='Video'# output folderifnotos.path.isdir(folder):os.makedirs(folder)fortiinrange(nGFS):t=0.1*tiplace=\"intermediate/snapshot-%5.4f\"%tname=\"%s/%8.8d.png\"%(folder,int(t*1000))ifnotos.path.exists(place):print(\"%sFile not found!\"%place)else:ifos.path.exists(name):print(\"%sImage present!\"%name)else:segs1=gettingFacets1(place)segs2=gettingFacets2(place)if(len(segs1)==0):print(\"Problem in the available file%s\"%place)else:# R, Z, taus, vel, U, V, taup, nz = gettingfield(place, zmin, zmax, rmax, nr, Ohs, Ohp, Oha)# zminp, zmaxp, rminp, rmaxp = Z.min(), Z.max(), R.min(), R.max()t, xmax, y_xmax, x_ymax, ymax=getting_ab(place)# Part to plotAxesLabel, TickLabel=[50,35]fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)ax.plot([0,0], [zmin, zmax],'-.',color='grey',linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-',color='black',linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-',color='black',linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-',color='black',linewidth=lw)## Drawing Facetsline_segments1=LineCollection(segs1, linewidths=3.25, colors='green', linestyle='solid')line_segments2=LineCollection(segs2, linewidths=3.25, colors='purple', linestyle='solid')ax.add_collection(line_segments1)ax.add_collection(line_segments2)ax.set_title('$t/\\\\tau_\\gamma$ =%4.3f'%t, fontsize=TickLabel)#plt.scatter(segs[0], segs[1])#print(\"The line collection array: \",segs)# Plotting the pointsax.plot(xmax, y_xmax,'ro', markersize=10)ax.plot(x_ymax, ymax,'bo', markersize=10)## Copied Linesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.axis('off')# plt.show()plt.savefig(name, bbox_inches=\"tight\", dpi=250)plt.close()",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/VideoBubbleinSheet_02_tp.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet.c | Documentation",
    "content": "postProcess/getFacet.c See raw file // get facets #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d scalar f[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); #if TREE f.prolongation = fraction_refine; #endif boundary((scalar ){f}); FILE * fp = ferr; output_facets(f,fp); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getFacet.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet_02.c | Documentation",
    "content": "postProcess/getFacet_02.c See raw file // get facets #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d #include \u201ctag.h\u201d scalar f[]; char filename[80]; int main(int a, char const arguments[]) { sprintf (filename, \u201c%s\u201d, arguments[1]); restore (file = filename); #if TREE f.prolongation = fraction_refine; #endif boundary((scalar ){f}); remove_droplets(f, 200, 1e-1, true); FILE * fp = ferr; output_facets(f,fp); fflush (fp); fclose (fp); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getFacet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation: C/C++ Code",
    "content": "postProcess/getData.c See raw file // get data #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #include \u201cfractions.h\u201d char filename[80]; int nx, ny, len; double xmin, ymin, xmax, ymax, Deltax, Deltay, Oh = 0.; scalar f[], D2c[], vel[]; scalar *list = NULL; int main(int a, char const *arguments[]) { sprintf(filename, \u201c%s\u201d, arguments[1]); xmin = atof(arguments[2]); ymin = atof(arguments[3]); xmax = atof(arguments[4]); ymax = atof(arguments[5]); ny = atoi(arguments[6]); Oh = atof(arguments[7]); list = list_add(list, D2c); list = list_add(list, vel); list = list_add(list, u.x); list = list_add(list, u.y); // boundary conditions u.n[right] = neumann(0.); p[right] = dirichlet(0.); restore(file = filename); f.prolongation = fraction_refine; boundary((scalar *){f, u.x, u.y}); foreach () { double D11 = (u.y[0, 1] - u.y[0, -1]) / (2 * Delta); double D22 = (u.y[] / y); double D33 = (u.x[1, 0] - u.x[-1, 0]) / (2 * Delta); double D13 = 0.5 * ((u.y[1, 0] - u.y[-1, 0] + u.x[0, 1] - u.x[0, -1]) / (2 * Delta)); double D2 = (sq(D11) + sq(D22) + sq(D33) + 2.0 * sq(D13)); // D2c[] = 2 * (clamp(f[], 0., 1.) * (Oh - 2e-2 * Oh) + 2e-2 * Oh) * D2; D2c[] = 2 * clamp(f[], 0., 1.) * D2; D2c[] = (D2c[] > 0.) ? log(D2c[]) / log(10) : -10; vel[] = sqrt(sq(u.x[]) + sq(u.y[])); } boundary((scalar *){D2c, vel}); FILE *fp = ferr; Deltay = (double)(ymax - ymin) / (ny); nx = (int)(xmax - xmin) / Deltay; Deltax = (double)(xmax - xmin) / (nx); len = list_len(list); double **field = (double **)matrix_new(nx, ny + 1, len * sizeof(double)); for (int i = 0; i < nx; i++) { double x = Deltax * (i + 0.5) + xmin; for (int j = 0; j < ny; j++) { double y = Deltay * (j + 0.5) + ymin; int k = 0; for (scalar s in list) { field[i][len * j + k++] = interpolate(s, x, y); } } } for (int i = 0; i < nx; i++) { double x = Deltax * (i + 0.5) + xmin; for (int j = 0; j < ny; j++) { double y = Deltay * (j + 0.5) + ymin; fprintf(fp, \"%g %g\", x, y); int k = 0; for (scalar s in list) { fprintf(fp, \" %g\", field[i][len * j + k++]); } fputc('\\n', fp); } } fflush(fp); fclose(fp); matrix_free(field); }",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation - Code Example: list = list_add(list,...",
    "content": "list = list_add(list, D2c);\nlist = list_add(list, vel);\nlist = list_add(list, u.x);\nlist = list_add(list, u.y); // boundary conditions\nu.n[right] = neumann(0.);\np[right] = dirichlet(0.); restore(file = filename);\nf.prolongation = fraction_refine;\nboundary((scalar *){f, u.x, u.y});",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation - Code Example: foreach () {...",
    "content": "foreach ()\n{\n    double D11 = (u.y[0, 1] - u.y[0, -1]) / (2 * Delta);\n    double D22 = (u.y[] / y);\n    double D33 = (u.x[1, 0] - u.x[-1, 0]) / (2 * Delta);\n    double D13 = 0.5 * ((u.y[1, 0] - u.y[-1, 0] + u.x[0, 1] - u.x[0, -1]) / (2 * Delta));\n    double D2 = (sq(D11) + sq(D22) + sq(D33) + 2.0 * sq(D13));\n    // D2c[] = 2 * (clamp(f[], 0., 1.) * (Oh - 2e-2 * Oh) + 2e-2 * Oh) * D2;\n    D2c[] = 2 * clamp(f[], 0., 1.) * D2;\n    D2c[] = (D2c[] > 0.) ? log(D2c[]) / log(10) : -10;\n    vel[] = sqrt(sq(u.x[]) + sq(u.y[]));\n}\nboundary((scalar *){D2c, vel});",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation - Code Example: FILE *fp =...",
    "content": "FILE *fp = ferr;\nDeltay = (double)(ymax - ymin) / (ny);\nnx = (int)(xmax - xmin) / Deltay;\nDeltax = (double)(xmax - xmin) / (nx);\nlen = list_len(list);",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation - Code Example: double **field =...",
    "content": "double **field = (double **)matrix_new(nx, ny + 1, len * sizeof(double));\nfor (int i = 0; i < nx; i++)\n{\n    double x = Deltax * (i + 0.5) + xmin;\n    for (int j = 0; j < ny; j++)\n    {\n        double y = Deltay * (j + 0.5) + ymin;\n        int k = 0;\n        for (scalar s in list)\n        {\n            field[i][len * j + k++] = interpolate(s, x, y);\n        }\n    }\n}",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData.c | Documentation - Code Example: for (int i...",
    "content": "for (int i = 0; i < nx; i++)\n{\n    double x = Deltax * (i + 0.5) + xmin;\n    for (int j = 0; j < ny; j++)\n    {\n        double y = Deltay * (j + 0.5) + ymin;\n        fprintf(fp, \"%g %g\", x, y);\n        int k = 0;\n        for (scalar s in list)\n        {\n            fprintf(fp, \" %g\", field[i][len * j + k++]);\n        }\n        fputc('\\n', fp);\n    }\n}\nfflush(fp);\nfclose(fp);\nmatrix_free(field);",
    "url": "https://comphy-lab.org/HoleySheet/postProcess/getData.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_03.2.c See raw file // Bubbles inside a draining sheet. || Uses CLSVOF || Reduced film thickness || Viscocapillary time scale based formulation // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d // #include \u201ctwo-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d // #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * Oh * pow(Bo,0.5) * x); u.t[right] = dirichlet(Oh * pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(Oh * pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * Oh * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1./(Oh*Oh), rho2 = 1e-3/(Oh*Oh); mu1 = 1., mu2 = 2e-2; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { d[] = -(1 - x x - y y); d[] = fabs(x) > 1.07 ? -d[] : d[]; sigmaf[] = 1.; u.x[] = -2 * Bo * x; u.y[] = Bo * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation - Code Example: Context",
    "content": "rho1 = 1./(Oh*Oh), rho2 = 1e-3/(Oh*Oh);\nmu1 = 1., mu2 = 2e-2; // f.sigma = 1.0;\nd.sigmaf = sigmaf; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.2.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e3);\n\nif ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e3 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.2.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_03.c | Documentation: C/C++ Code",
    "content": "simulationCases/asyBubbleinSheet_03.c See raw file // Asymmetric Bubble inside a draining sheet. || Uses CLSVOF // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using height function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, offset, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[left] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[left] = dirichlet(pow(Bo,0.5) * y); p[left] = dirichlet(0.); pf[left] = dirichlet(0.); u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_03.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; X0 = -0.5 Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); offset = atof(argv[4]); tmax = atof(argv[5]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 6) { fprintf(ferr, \u201cLack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_03.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\u201d, 6 - argc); return 1; } fprintf(ferr, \u201cLevel %d, Oh %2.1e, Bo %2.1e, offset %4.3f\u201d, MAXlevel, Oh, Bo, offset); init_grid(1 << 8); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \u201cmkdir -p intermediate\u201d); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \u201cdump\u201d); rho1 = 1., rho2 = 1e-3; Oha = 2e-5; mu1 = Oh, mu2 = Oha; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(2.25 - x * x, 1 - (x - offset) * (x - offset) - y * y)); foreach () { d[] = -(1 - (x - offset) * (x - offset) - y * y); d[] = fabs(x) > 1.2 ? -d[] : d[]; sigmaf[] = 1.; u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %2.1e, offset %4.3f\u201d, MAXlevel, Oh, Bo, offset); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e4); if ((ke > 1e4 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e4 ? \u201cThe kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_03.c | Documentation: Stopping simulation\u201d :...",
    "content": "Stopping simulation\u201d : \u201ckinetic energy too small now! Stopping!\u201d; fprintf(ferr, \u201c%s\u201d, message); fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%s\u201d, message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_01.c | Documentation: C/C++ Code",
    "content": "simulationCases/asyBubbleinSheet_01.c See raw file // Asymmetric Bubble inside a draining sheet. // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase.h\u201d #include \u201cnavier-stokes/conserving.h\u201d #include \u201ctension.h\u201d #define tsnap (1e-2) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using height function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 8 int MAXlevel; // Oh -> liquid Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, offset, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[left] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[left] = dirichlet(pow(Bo,0.5) * y); p[left] = dirichlet(0.); pf[left] = dirichlet(0.); u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_01.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; X0 = -0.5 Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); offset = atof(argv[4]); tmax = atof(argv[5]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 6) { fprintf(ferr, \u201cLack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_01.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\u201d, 6 - argc); return 1; } fprintf(ferr, \u201cLevel %d, Oh %2.1e, Bo %2.1e, offset %4.3f\u201d, MAXlevel, Oh, Bo, offset); init_grid(1 << 8); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \u201cmkdir -p intermediate\u201d); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \u201cdump\u201d); rho1 = 1., rho2 = 1e-3; Oha = 2e-2 * Oh; mu1 = Oh, mu2 = Oha; f.sigma = 1.0; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { fraction(f, difference(2.25 - x * x, 1 - (x - offset) * (x - offset) - y * y)); foreach () { u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { scalar KAPPA[]; curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y, KAPPA}, (double[]){fErr, VelErr, VelErr, KErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %2.1e, offset %4.3f\u201d, MAXlevel, Oh, Bo, offset); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \u201cThe kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/asyBubbleinSheet_01.c | Documentation: Stopping simulation\u201d :...",
    "content": "Stopping simulation\u201d : \u201ckinetic energy too small now! Stopping!\u201d; fprintf(ferr, \u201c%s\u201d, message); fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%s\u201d, message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/asyBubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_03.3.c See raw file // Bubbles inside a draining sheet. || Uses CLSVOF || Oh_a fixed instead of viscosity ratio // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d // #include \u201ctwo-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d // #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { d[] = -(1 - x x - y y); d[] = fabs(x) > 1.25 ? -d[] : d[]; sigmaf[] = 1.; u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation - Code Example: Context",
    "content": "rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; // f.sigma = 1.0;\nd.sigmaf = sigmaf; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.3.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e3);\n\nif ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e3 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.3.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/makeDirs.sh | Documentation",
    "content": "simulationCases/makeDirs.sh See raw file makeDirs.sh #!/bin/bash start = \"1031\" end = \"1039\" for i in ` seq \\$ start \\$ end `; do echo \\$ i mkdir -p \\$ i cp bubbleinSheets_03 \\$ i done",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/makeDirs.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/makeDirs.sh | Documentation - Code Example",
    "content": "#!/bin/bashstart=\"1031\"end=\"1039\"foriin`seq\\$start\\$end`;doecho\\$imkdir-p\\$icpbubbleinSheets_03\\$idone",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/makeDirs.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runCodes_snellius_singleNode.sh | Documentation: Context",
    "content": "simulationCases/runCodes_snellius_singleNode.sh See raw file runCodes_snellius_singleNode.sh #!/bin/bash #SBATCH -N 1 #SBATCH --partition=genoa #SBATCH --ntasks-per-node=32 #SBATCH --job-name=1010 #SBATCH --time=24:00:00 #SBATCH --mail-type=ALL #SBATCH --mail-type=ALL #SBATCH --error=job.%J.err #SBATCH --output=job.%J.out #SBATCH --mail-user=a.k.dixit@utwente.nl source ~/.bash_shell MAXlevel = \"9\" Oh = ( \"1.00E-03\" \"3.00E-03\" \"6.00E-03\" \"1.00E-02\" \"3.00E-02\" \"6.00E-02\" \"1.00E-01\" ) Bo = \"0.001\" tmax = \"200\" start_data = 1010 start = 1015 end = 1016 for (( i = start ; i <= end ; i ++ )); do index = \\$ (( i - start_data )) dir = \\$ i cd \\$ dir || { echo \"Failed to change directory to \\$ dir\" ; exit 1 ; } srun -n 16 --gres = cpu:16 --exclusive bubbleinSheet_01 \\$ MAXlevel \\$ {Oh [ index ] } \\$ Bo \\$ tmax & cd ../ done wait #CC99='mpicc -std=c99' qcc -Wall -O2 -D_MPI=1 bubbleinSheet_01.c -o bubbleinSheet_01 -lm -disable-dimensions #CC99='mpicc -std=c99' qcc -Wall -O2 -D_MPI=1 asyBubbleinSheet_01.c -o asyBubbleinSheet_01 -lm -disable-dimensions #srun -n 96 asyBubbleinSheets_v1 \\$MAXlevel \\$Oh \\$offset \\$tmax",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/runCodes_snellius_singleNode.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCodes_snellius_singleNode.sh | Documentation - Code Example: #!/bin/bash#SBATCH -N 1#SBATCH...",
    "content": "#!/bin/bash#SBATCH -N 1#SBATCH --partition=genoa#SBATCH --ntasks-per-node=32#SBATCH --job-name=1010#SBATCH --time=24:00:00#SBATCH --mail-type=ALL#SBATCH --mail-type=ALL#SBATCH --error=job.%J.err#SBATCH --output=job.%J.out#SBATCH --mail-user=a.k.dixit@utwente.nlsource~/.bash_shellMAXlevel=\"9\"Oh=(\"1.00E-03\"\"3.00E-03\"\"6.00E-03\"\"1.00E-02\"\"3.00E-02\"\"6.00E-02\"\"1.00E-01\")Bo=\"0.001\"tmax=\"200\"start_data=1010start=1015end=1016for((i=start;i<=end;i++));doindex=\\$((i-start_data))dir=\\$icd\\$dir||{echo\"Failed to change directory to\\$dir\";exit1;}srun-n16--gres=cpu:16--exclusivebubbleinSheet_01\\$MAXlevel\\${Oh[index]}\\$Bo\\$tmax&cd../donewait#CC99='mpicc -std=c99' qcc -Wall -O2 -D_MPI=1 bubbleinSheet_01.c -o bubbleinSheet_01 -lm -disable-dimensions#CC99='mpicc -std=c99' qcc -Wall -O2 -D_MPI=1 asyBubbleinSheet_01.c -o asyBubbleinSheet_01 -lm -disable-dimensions#srun -n 96 asyBubbleinSheets_v1 \\$MAXlevel \\$Oh \\$offset \\$tmax",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/runCodes_snellius_singleNode.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation: Context",
    "content": "Simulation Cases asyBubbleinSheet_01.c int MAXlevel; // Oh -> liquid Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR^3w^2/gamma ... asyBubbleinSheet_03.c scalar sigmaf[]; bubbleinSheet_01.1.c int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR^3w^2/gamma... bubbleinSheet_01.c int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR^3w^2/gamma... bubbleinSheet_02.c int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR^3w^2/gamma... bubbleinSheet_03.1.c scalar sigmaf[]; bubbleinSheet_03.2.c scalar sigmaf[]; bubbleinSheet_03.3.c scalar sigmaf[]; bubbleinSheet_03.c scalar sigmaf[]; bubbleinSheet_04.c scalar sigmaf[]; bubbleinSheet_05.c int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR^3w^2/gamma... makeDirs.sh start='1031' end='1039' for i in seq \\$start \\$end; do echo \\$i mkdir -p \\$i cp bubbleinSheets03 \\$i done outEqshape_01.ipynb This notebook provides visualization and analysis related to outEqshape 01. runCodes_snellius_singleNode.sh source ~/.bashshell MAXlevel='9' Oh=('1.00E-03' '3.00E-03' '6.00E-03' '1.00E-02' '3.00E-02' '6.00E-02' '1.00E-01') Bo...",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_01.1.c See raw file // Bubbles inside a draining sheet.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation: C/C++ Code",
    "content": "Initialize with eq. shape // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase.h\u201d #include \u201cnavier-stokes/conserving.h\u201d #include \u201ctension.h\u201d #include \u201cdistance.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions // u.n[right] = dirichlet(-2 * Bo * x); // u.t[right] = dirichlet(Bo * y); // p[right] = dirichlet(0.); // pf[right] = dirichlet(0.); // u.n[top] = dirichlet(Bo * y); // u.t[top] = dirichlet(-2 * Bo * x); // p[top] = dirichlet(0.); // pf[top] = dirichlet(0.); u.n[right] = dirichlet(0.); u.t[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 10); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; f.sigma = 1.0; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { char filename[60]; sprintf(filename, \u201cf.txt\u201d); FILE fp = fopen(filename, \u201crb\u201d); if (fp == NULL) { fprintf(ferr, \u201cThere is no file named %s\u201d, filename); return 1; } coord InitialShape; InitialShape = input_xy(fp); fclose(fp); scalar d[]; distance(d, InitialShape); while (adapt_wavelet((scalar *){f, d}, (double[]){1e-8, 1e-8}, MAXlevel).nf) ; // The distance function is defined at the center of each cell, we have // to calculate the value of this function at each vertex. vertex scalar phi[]; foreach_vertex() { phi[] = -(d[] + d[-1] + d[0, -1] + d[-1, -1]) / 4.; } // We can now initialize the volume fraction of the domain. fractions(phi, f); } // return 1; } event adapt(i++) { scalar KAPPA[]; curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y, KAPPA}, (double[]){fErr, VelErr, VelErr, KErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e2); if ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e2 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation - Code Example: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 10);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; f.sigma = 1.0; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation - Code Example",
    "content": "while (adapt_wavelet((scalar *){f, d}, (double[]){1e-8, 1e-8}, MAXlevel).nf)\n        ;\n\n    // The distance function is defined at the center of each cell, we have\n    // to calculate the value of this function at each vertex.\n    vertex scalar phi[];\n    foreach_vertex()\n    {\n        phi[] = -(d[] + d[-1] + d[0, -1] + d[-1, -1]) / 4.;\n    }\n\n    // We can now initialize the volume fraction of the domain.\n    fractions(phi, f);\n}\n// return 1;",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.1.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e2);\n\nif ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e2 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_04.c See raw file // Bubbles inside a draining sheet. || Uses CLSVOF || Oh_a fixed instead of viscosity ratio || No bubble // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d // #include \u201ctwo-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d // #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { // d[] = -(1 - x x - y y); // d[] = fabs(x) > 1.25 ? -d[] : d[]; d[] = (1 - x); sigmaf[] = 1.; u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation - Code Example: Context",
    "content": "rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; // f.sigma = 1.0;\nd.sigmaf = sigmaf; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_04.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e3);\n\nif ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e3 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_04.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation: C/C++ Code",
    "content": "simulationCases/bubbleinSheet_03.1.c See raw file // Bubbles inside a draining sheet. || Uses CLSVOF || Reduced film thickness // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d // #include \u201ctwo-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d // #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { d[] = -(1 - x x - y y); d[] = fabs(x) > 1.1 ? -d[] : d[]; sigmaf[] = 1.; u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation - Code Example: Context",
    "content": "rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; // f.sigma = 1.0;\nd.sigmaf = sigmaf; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.1.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e3);\n\nif ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e3 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.1.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/outEqshape_01.ipynb | Documentation",
    "content": "simulationCases/outEqshape_01.ipynb See raw file outEqshape_01.ipynb Jupyter Notebook: outEqshape_01.ipynb Download Notebook View in nbviewer Open in Colab About this notebook This notebook provides visualization and analysis related to outEqshape 01. Key Features: Visualization of data and results Analysis of simulation outputs Interactive exploration of parameters Tip: For the best interactive experience, download the notebook or open it in Google Colab. Notebook Preview Notebook Preview Unavailable The notebook preview could not be loaded. This may be because: The notebook file is not yet available in the repository The nbviewer service is temporarily unavailable The repository is private or has access restrictions You can still download the notebook using the button above or view it directly through one of the external services.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/outEqshape_01.ipynb.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation: C/C++ Code",
    "content": "simulationCases/bubbleinSheet_01.c See raw file // Bubbles inside a draining sheet. // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase.h\u201d #include \u201cnavier-stokes/conserving.h\u201d #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; f.sigma = 1.0; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { scalar KAPPA[]; curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y, KAPPA}, (double[]){fErr, VelErr, VelErr, KErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e2); if ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e2 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation - Code Example: Context",
    "content": "rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; f.sigma = 1.0; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_01.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e2);\n\nif ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e2 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_01.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_05.c See raw file // Bubbles inside a draining sheet.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation: C/C++ Code",
    "content": "Initialize with eq. shape // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase.h\u201d #include \u201cnavier-stokes/conserving.h\u201d #include \u201ctension.h\u201d #include \u201cdistance.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, rh, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[top] = dirichlet(0.); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); rh = atof(argv[4]); tmax = atof(argv[5]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 6) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 6 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 10); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; f.sigma = 1.0; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { fraction(f, y < 2 rh + 1 ? 1 - x x - (y - 2 rh - 1) (y - 2 rh - 1) : 1 - x ); foreach () { u.x[] = -2 pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { scalar KAPPA[]; curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y, KAPPA}, (double[]){fErr, VelErr, VelErr, KErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e2); if ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e2 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\nrh = atof(argv[4]);\ntmax = atof(argv[5]); // Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 6)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation - Code Example: Need %d more...",
    "content": "Need %d more arguments\\n\", 6 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 10);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; f.sigma = 1.0; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_05.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e2);\n\nif ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e2 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_05.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_02.c | Documentation: Context",
    "content": "simulationCases/bubbleinSheet_02.c See raw file // Bubbles inside a draining sheet.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_02.c | Documentation: C/C++ Code",
    "content": "Three phase // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps // #include \u201ctwo-phase.h\u201d #include \u201cthree-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d #include \u201ctension.h\u201d #include \u201cdistance.h\u201d // #include \u201cadapt_wavelet_limited_v2.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J // Numbers! #define Ldomain 4 // Surface tensions #define SIGMA13 (1.0) #define SIGMA12 (1.0) int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // boundary conditions u.n[right] = dirichlet(-2 * pow(Bo, 0.5) * x); u.t[right] = dirichlet(pow(Bo, 0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0); u.n[top] = dirichlet(pow(Bo, 0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo, 0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_02.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 4) { fprintf(ferr, \u201cLack of command line arguments. Check! Need %d more arguments\u201d, 4 - argc); return 1; } fprintf(ferr, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); init_grid(1 << 7); // Create a folder named intermediate where all the simulation snapshots are stored. char comm[80]; sprintf(comm, \u201cmkdir -p intermediate\u201d); system(comm); // Name of the restart file.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_02.c | Documentation: Context",
    "content": "See writingFiles event. sprintf(dumpFile, \u201cdump\u201d); rho1 = 1., rho2 = 1e-3, rho3 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha, mu3 = Oha; // f.sigma = 1.0; f1.sigma = SIGMA13; f2.sigma = SIGMA12; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { fraction(f1, 1.2 - x * x); fraction(f2, 1 - x * x - y * y); foreach () { u.x[] = -2 * pow(Bo, 0.5) * x; u.y[] = pow(Bo, 0.5) * y; } // boundary ({f1,f2,u}); } // return 1; } event adapt(i++) { scalar KAPPA1[], KAPPA2[]; curvature(f1, KAPPA1); curvature(f2, KAPPA2); adapt_wavelet((scalar *){f1, f2, u.x, u.y, KAPPA1, KAPPA2}, (double[]){fErr, fErr, VelErr, VelErr, KErr, KErr}, MAXlevel, MAXlevel - 6); } event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } event end(t = end) {} // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f1[], f2[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e2); if ((ke > 1e2 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e2 ? \u201cThe kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_02.c | Documentation: Stopping simulation\u201d :...",
    "content": "Stopping simulation\u201d : \u201ckinetic energy too small now! Stopping!\u201d; fprintf(ferr, \u201c%s\u201d, message); fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%s\u201d, message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_02.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation: C/C++ Code",
    "content": "simulationCases/bubbleinSheet_03.c See raw file // Bubbles inside a draining sheet. || Uses CLSVOF // Id 1 is liquid pool, and Id 2 is Newtonian gas. #include \u201caxi.h\u201d #include \u201cnavier-stokes/centered.h\u201d #define FILTERED // Smear density and viscosity jumps #include \u201ctwo-phase-clsvof.h\u201d #include \u201cintegral.h\u201d scalar sigmaf[]; #include \u201cdistance.h\u201d // #include \u201ctwo-phase.h\u201d // #include \u201cnavier-stokes/conserving.h\u201d // #include \u201ctension.h\u201d #define tsnap (1e-1) // 0.001 only for some cases. // Error tolerancs #define fErr (1e-3) // error tolerance in f1 VOF #define KErr (1e-6) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr (1e-3) // error tolerances in velocity \u2013 Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define Ldomain 4 int MAXlevel; // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // Bo -> Bond number = rhoR 3w 2/gamma double Oh, Oha, Bo, tmax; char nameOut[80], dumpFile[80]; // Boundary conditions u.n[right] = dirichlet(-2 * pow(Bo,0.5) * x); u.t[right] = dirichlet(pow(Bo,0.5) * y); p[right] = dirichlet(0.); pf[right] = dirichlet(0.); u.n[top] = dirichlet(pow(Bo,0.5) * y); u.t[top] = dirichlet(-2 * pow(Bo,0.5) * x); p[top] = dirichlet(0.); pf[top] = dirichlet(0.); int main(int argc, char const *argv[]) { dtmax = 1e-5; // BEWARE of this for stability issues.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation: L0 = Ldomain;...",
    "content": "L0 = Ldomain; // Values taken from the terminal MAXlevel = atoi(argv[1]); Oh = atof(argv[2]); Bo = atof(argv[3]); tmax = atof(argv[4]); // Ensure that all the variables were transferred properly from the terminal or job script. if (argc < 5) { fprintf(ferr, \"Lack of command line arguments. Check!",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation: Need %d more...",
    "content": "Need %d more arguments\\n\", 5 - argc); return 1; } fprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo); init_grid(1 << 7); // Create intermediate for all snapshots. char comm[80]; sprintf(comm, \"mkdir -p intermediate\"); system(comm); // Name of the restart file, used in writingFiles event. sprintf(dumpFile, \"dump\"); rho1 = 1., rho2 = 1e-3; // Oha = 2e-2 * Oh; Oha = 2e-5; mu1 = Oh, mu2 = Oha; // f.sigma = 1.0; d.sigmaf = sigmaf; run(); } event init(t = 0) { if (!restore(file = dumpFile)) { // fraction(f, difference(1.5625 - x * x, 1 - x * x - y * y)); foreach () { d[] = -(1 - x x - y y); d[] = fabs(x) > 1.25 ? -d[] : d[]; sigmaf[] = 1.; u.x[] = -2 * pow(Bo,0.5) * x; u.y[] = pow(Bo,0.5) * y; } boundary({f, u}); } // return 1; } event adapt(i++) { // scalar KAPPA[]; // curvature(f, KAPPA); adapt_wavelet((scalar *){f, u.x, u.y}, (double[]){fErr, VelErr, VelErr}, MAXlevel, MAXlevel - 3); } // Dumping snapshots event writingFiles(t = 0; t += tsnap; t <= tmax) { dump(file = dumpFile); sprintf(nameOut, \u201cintermediate/snapshot-%5.4f\u201d, t); dump(file = nameOut); } // Ending Simulation event end(t = end) { } // Log writing event logWriting(i++) { double ke = 0.; foreach (reduction(+ : ke)) { ke += (2 * pi * y) * (0.5 * rho(f[]) * (sq(u.x[]) + sq(u.y[]))) * sq(Delta); } static FILE *fp; if (pid() == 0) { if (i == 0) { fprintf(ferr, \u201ci dt t ke\u201d); fp = fopen(\u201clog\u201d, \u201cw\u201d); fprintf(fp, \u201cLevel %d, Oh %2.1e, Bo %4.3f\u201d, MAXlevel, Oh, Bo); fprintf(fp, \u201ci dt t ke\u201d); } else { fp = fopen(\u201clog\u201d, \u201ca\u201d); fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); } fprintf(fp, \u201c%d %g %g %g\u201d, i, dt, t, ke); fclose(fp); fprintf(ferr, \u201c%d %g %g %g\u201d, i, dt, t, ke); } assert(ke > -1e-10); assert(ke < 1e3); if ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0) { const char *message = ke > 1e3 ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation: Stopping simulation\\n\" :...",
    "content": "Stopping simulation\\n\" : \"kinetic energy too small now! Stopping!\\n\"; fprintf(ferr, \"%s\", message); fp = fopen(\"log\", \"a\"); fprintf(fp, \"%s\", message); fclose(fp); dump(file = dumpFile); return 1; } }",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation - Code Example: // Values taken...",
    "content": "// Values taken from the terminal\nMAXlevel = atoi(argv[1]);\nOh = atof(argv[2]);\nBo = atof(argv[3]);\ntmax = atof(argv[4]);",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation - Code Example: // Ensure that...",
    "content": "// Ensure that all the variables were transferred properly from the terminal or job script.\nif (argc < 5)\n{\n    fprintf(ferr, \"Lack of command line arguments. Check! Need %d more arguments\\n\", 5 - argc);\n    return 1;\n}\nfprintf(ferr, \"Level %d, Oh %2.1e, Bo %4.3f\\n\", MAXlevel, Oh, Bo);\ninit_grid(1 << 7);\n// Create intermediate for all snapshots.\nchar comm[80];\nsprintf(comm, \"mkdir -p intermediate\");\nsystem(comm);\n// Name of the restart file, used in writingFiles event.\nsprintf(dumpFile, \"dump\");",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation - Code Example: Context",
    "content": "rho1 = 1., rho2 = 1e-3;\n// Oha = 2e-2 * Oh;\nOha = 2e-5;\nmu1 = Oh, mu2 = Oha; // f.sigma = 1.0;\nd.sigmaf = sigmaf; run();",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/bubbleinSheet_03.c | Documentation - Code Example",
    "content": "assert(ke > -1e-10);\nassert(ke < 1e3);\n\nif ((ke > 1e3 || ke < 1e-6) && i > 1e1 && pid() == 0)\n{\n    const char *message = ke > 1e3 ? \"The kinetic energy blew up. Stopping simulation\\n\"\n                                   : \"kinetic energy too small now! Stopping!\\n\";\n    fprintf(ferr, \"%s\", message);\n    fp = fopen(\"log\", \"a\");\n    fprintf(fp, \"%s\", message);\n    fclose(fp);\n    dump(file = dumpFile);\n    return 1;\n}",
    "url": "https://comphy-lab.org/HoleySheet/simulationCases/bubbleinSheet_03.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files three-phase.h This file helps setup simulations for flows of three fluids separated by corresponding interfaces (i.e. immiscible fl...",
    "url": "https://comphy-lab.org/HoleySheet/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation: Context",
    "content": "src-local/three-phase.h See raw file Three-phase interfacial flows This file helps setup simulations for flows of three fluids separated by corresponding interfaces (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid i is \\(f_i=1\\) and \\(f_i=0\\) everywhere else.",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1, 2 and 3 are rho1 , mu1 , rho2 , mu2 , and rho3 , mu3 respectively. #include \"vof.h\" scalar f1 [], f2 [], * interfaces = { f1 , f2 }; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. , rho3 = 1. , mu3 = 0. ; Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. if ( mu1 || mu2 ) mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho #define rho ( f1 , f2 ) ( clamp ( f1 *( 1 - f2 ), 0. , 1. ) * rho1 + clamp ( f1 * f2 , 0. , 1. ) * rho2 + clamp (( 1 - f1 ), 0. , 1. ) * rho3 ) 42 #endif #ifndef mu #define mu ( f1 , f2 ) ( clamp ( f1 *( 1 - f2 ), 0. , 1. ) * mu1 + clamp ( f1 * f2 , 0. , 1. ) * mu2 + clamp (( 1 - f1 ), 0. , 1. ) * mu3 ) 45 #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf1 [], sf2 [], * smearInterfaces = { sf1 , sf2 }; #else #define sf1 f1 55 #define sf2 f2 56 scalar * smearInterfaces = { sf1 , sf2 }; #endif event properties ( i ++) { if ( i > 1 ){ foreach (){ if (( f2 [] > 0.5 ) && ( f1 [] < 0.5 )){ f1 [] = f2 []; } } } When using smearing of the density jump, we initialise sfi with the vertex-average of fi . #ifdef FILTERED int counter1 = 0 ; for ( scalar sf in smearInterfaces ){ counter1 ++; int counter2 = 0 ; for ( scalar f in interfaces ){ counter2 ++; if ( counter1 == counter2 ){ // fprintf(ferr, \"%s %s\\n\", sf.name, f.name); #if dimension <= foreach (){ sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; } #else // dimension == foreach (){ sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; } #endif } } } #endif #if TREE for ( scalar sf in smearInterfaces ){ sf . prolongation = refine_bilinear ; boundary ({ sf }); } #endif foreach_face () { double ff1 = ( sf1 [] + sf1 [- 1 ])/ 2. ; double ff2 = ( sf2 [] + sf2 [- 1 ])/ 2. ; This is a bit of fine tuning here.",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation: We might get...",
    "content": "We might get places in the domain where density and viscosity go below those of air, we just make the properties at those locations equal to that of air // double rhoTemp = max(rho(ff1, ff2), rho3); // alphav.x[] = fm.x[]/rhoTemp; alphav . x [] = fm . x []/ rho ( ff1 , ff2 ); face vector muv = mu ; // double muTemp = max(mu(ff1, ff2), mu3); // muv.x[] = fm.x[]*muTemp; muv . x [] = fm . x []* mu ( ff1 , ff2 ); } foreach (){ // double rhoTemp = max(rho(sf1[], sf2[]), rho3); // rhov[] = cm[]*rhoTemp; rhov [] = cm []* rho ( sf1 [], sf2 []); } #if TREE for ( scalar sf in smearInterfaces ){ sf . prolongation = fraction_refine ; boundary ({ sf }); } #endif }",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - C/C++ Code",
    "content": "#include\"vof.h\"scalar f1[],f2[],*interfaces={f1,f2};doublerho1=1.,mu1=0.,rho2=1.,mu2=0.,rho3=1.,mu3=0.;",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - Code Example",
    "content": "face vector alphav[];scalar rhov[];event defaults(i=0){alpha=alphav;rho=rhov;",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - Function: rho",
    "content": "#ifndef rho#define rho(f1,f2)(clamp(f1*(1-f2),0.,1.)*rho1+clamp(f1*f2,0.,1.)*rho2+clamp((1-f1),0.,1.)*rho3)42#endif#ifndef mu#define mu(f1,f2)(clamp(f1*(1-f2),0.,1.)*mu1+clamp(f1*f2,0.,1.)*mu2+clamp((1-f1),0.,1.)*mu3)45#endif",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf1[],sf2[],*smearInterfaces={sf1,sf2};#else#define sf1 f155#define sf2 f256scalar*smearInterfaces={sf1,sf2};#endifevent properties(i++){if(i>1){foreach(){if((f2[]>0.5)&&(f1[]<0.5)){f1[]=f2[];}}}",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - Function: FILTEREDintcounter1",
    "content": "#ifdef FILTEREDintcounter1=0;for(scalar sf in smearInterfaces){counter1++;intcounter2=0;for(scalar f in interfaces){counter2++;if(counter1==counter2){// fprintf(ferr, \"%s %s\\n\", sf.name, f.name);#if dimension <=foreach(){sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;}#else// dimension ==foreach(){sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;}#endif}}}#endif#if TREEfor(scalar sf in smearInterfaces){sf.prolongation=refine_bilinear;boundary({sf});}#endifforeach_face(){doubleff1=(sf1[]+sf1[-1])/2.;doubleff2=(sf2[]+sf2[-1])/2.;",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/three-phase.h | Documentation - Code Example",
    "content": "// double rhoTemp = max(rho(ff1, ff2), rho3);// alphav.x[] = fm.x[]/rhoTemp;alphav.x[]=fm.x[]/rho(ff1,ff2);face vector muv=mu;// double muTemp = max(mu(ff1, ff2), mu3);// muv.x[] = fm.x[]*muTemp;muv.x[]=fm.x[]*mu(ff1,ff2);}foreach(){// double rhoTemp = max(rho(sf1[], sf2[]), rho3);// rhov[] = cm[]*rhoTemp;rhov[]=cm[]*rho(sf1[],sf2[]);}#if TREEfor(scalar sf in smearInterfaces){sf.prolongation=fraction_refine;boundary({sf});}#endif}",
    "url": "https://comphy-lab.org/HoleySheet/src-local/three-phase.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | FIBER: Flow-Induced Breakup of Elastic Rheology",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # MacOS only. modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk rm -rf basilisk rm -rf .project_config darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make -k make echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config",
    "url": "https://comphy-lab.org/fiber/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "#!/bin/zsh# MacOS only. modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basiliskrm-rfbasiliskrm-rf.project_configdarcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake-kmakeecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config",
    "url": "https://comphy-lab.org/fiber/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology: FIBER: Flow-Induced Breakup...",
    "content": "FIBER: Flow-Induced Breakup of Elastic Rheology \ud83d\ude80 Fiber is a state-of-the-art, open-source framework for simulating viscoelastic fluid flows in 2D and 3D, built as an extension to the Basilisk C CFD library.",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology: Methods",
    "content": "It implements the log-conformation method for robust, high-Weissenberg number simulations, with a focus on clarity, extensibility, and scientific rigor. \u2728 Key Features Full 3D Log-Conformation Method : Complete scalar implementation for 3D viscoelastic fluids ( log-conform-viscoelastic-scalar-3D.h ) Robust 2D/Axi Support : Scalar and tensor-based log-conformation for 2D and axisymmetric cases ( log-conform-viscoelastic-scalar-2D.h , log-conform-viscoelastic.h ) Optimized Matrix Algebra : Efficient, stable eigenvalue and tensor operations ( eigen_decomposition.h ) Advanced Initialization : Functions for pseudo vectors/tensors in 2D/3D Error Handling : Negative eigenvalue checks, eigenvalue clamping, and detailed diagnostics Performance : Simplified acceleration term calculations and optimized tensor operations Documentation : Extensive inline documentation, mathematical background, and verification notes Compatibility : GPLv3 license, fully compatible with Basilisk and previous versions \ud83d\udc1b Bug Fixes (v2.5/v2.6) Corrected matrix algebra in 3D Fixed rotation tensor and eigenvalue edge cases Improved error reporting and diagnostics Enhanced axisymmetric and 2D/3D compatibility \ud83d\uddc2\ufe0f Repository Structure basilisk/src/ - # Core Basilisk CFD library (reference only, do not modify) src-local/ - # Custom viscoelastic solvers and tensor utilities log-conform-viscoelastic-scalar-2D.h - # 2D/axi log-conformation (scalar) two-phaseVE.h - # Two-phase viscoelastic extension simulationCases/ - # Example/test cases and post-processing scripts filamentExt.c - # Pinch-off of viscoelastic jet (2D/axi) postProcess/ - # Project-specific post-processing tools and utilities getData-elastic-scalar2D.c - # Data extraction utility getFacet2D.c - # Facet extraction utility VideoAxi.py - # Python visualization script \ud83d\udcda Documentation Inline documentation in all major headers (see src-local/ ) Example simulation and post-processing scripts in simulationCases/ \ud83d\ude80 Quick Start 1.",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology: Prerequisites Basilisk C...",
    "content": "Prerequisites Basilisk C (included as submodule in basilisk/ ) C compiler (e.g., gcc) Python 3 (for post-processing) Optional: Jupyter for notebooks 2. Compiling & Running Simulations A. Vanilla Basilisk method: qcc -O2 -Wall -I. /src-local -disable-dimensions simulationCases/{CaseName}.c -o {CaseName} -lm ./{CaseName} B. Using the Makefile (with bview browser): CFLAGS = -DDISPLAY=-1 make simulationCases/{CaseName}.tst For interactive visualization, open the generated display.html in your browser (see Basilisk bview ). 3. Post-Processing & Analysis Python scripts and Jupyter notebooks for data extraction and visualization are in simulationCases/ (e.g., VideoAxi.py , verifyWtihPlots.ipynb ).",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology: Examples",
    "content": "Example utilities: getData-elastic-scalar2D.c , getFacet2D.c . \ud83d\udcdd Example: Running a 3D Drop Atomisation Simulation qcc -O2 -Wall -I. /src-local -disable-dimensions simulationCases/dropAtomisation.c -o dropAtomisation -lm ./dropAtomisation \ud83d\udd0d Technical Details Log-Conformation Method : See src-local/log-conform-viscoelastic-scalar-3D.h and src-local/log-conform-viscoelastic-scalar-2D.h for mathematical background and implementation notes. Eigenvalue Solver : src-local/eigen_decomposition.h provides robust 3x3 symmetric eigensystem routines. Two-Phase Flows : src-local/two-phaseVE.h extends Basilisk\u2019s two-phase solver for viscoelasticity. Axisymmetric/2D/3D : Use the appropriate header for your geometry (see comments in each header for guidance). \ud83e\uddd1\u200d\ud83d\udcbb Contributing See CLAUDE.md for code style and development guidelines. Issue templates and feature requests: GitHub Issue Templates Pull requests are welcome!",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology: Examples",
    "content": "Please document your changes and update relevant tests/examples. \ud83d\udccb License This project is licensed under the GNU GPLv3 , in line with the Basilisk codebase. \ud83d\ude4f Acknowledgments Thanks to all contributors and the Basilisk community \ud83d\udd17 References Fattal & Kupferman (2004, 2005): Log-conformation method Comminal et al. (2015): Constitutive model functions Hao & Pan (2007): Split scheme implementation Basilisk C For detailed documentation, see the docs/ folder or open docs/index.html in your browser. Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/VideoAxi.py postProcess/getData-elastic-scalar2D.c postProcess/getFacet2D.c simulationCases simulationCases/Makefile simulationCases/cleanup.sh simulationCases/filamentExt.c simulationCases/runCases.sh src-local src-local/log-conform-viscoelastic-scalar-2D.h src-local/two-phaseVE.h",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "qcc-O2-Wall-I./src-local-disable-dimensionssimulationCases/{CaseName}.c-o{CaseName}-lm./{CaseName}",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "CFLAGS=-DDISPLAY=-1makesimulationCases/{CaseName}.tst",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "FIBER: Flow-Induced Breakup of Elastic Rheology | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "qcc-O2-Wall-I./src-local-disable-dimensionssimulationCases/dropAtomisation.c-odropAtomisation-lm./dropAtomisation",
    "url": "https://comphy-lab.org/fiber/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData-elastic-scalar2D.c This program extracts and processes data from fluid dynamics simulation snapshots, specifically designed for viscoela... getFacet2D.c A utility for extracting interface facets from fluid simulation data. VideoAxi.py Viscoelastic Visualization Tool =========================================== This script processes and visualizes flui...",
    "url": "https://comphy-lab.org/fiber/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "postProcess/getData-elastic-scalar2D.c See raw file Simulation Data Extraction and Processing This program extracts and processes data from fluid dynamics simulation snapshots, specifically designed for viscoelastic fluid simulations with conformation tensor analysis. It computes important derived quantities including deformation rate tensor components, velocity magnitude, and conformation tensor trace. The program interpolates these quantities onto a regular grid and outputs the results for further analysis or visualization. Physics Background This code handles viscoelastic fluid simulation data where the fluid stress tensor includes both a viscous component (proportional to the deformation rate) and an elastic component (represented by the conformation tensor).",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology: C/C++ Code",
    "content": "The trace of the conformation tensor provides a measure of polymer stretching in the fluid. #include \"utils.h\" #include \"output.h\" scalar f []; // Volume fraction field vector u []; // Velocity field scalar A11 [], A12 [], A22 []; // Conformation tensor components scalar conform_qq []; // Additional conformation tensor component char filename [ 80 ]; // Input file name int nx , ny , len ; // Grid dimensions and field count double xmin , ymin , xmax , ymax , Deltax , Deltay ; // Domain boundaries and grid spacing Derived Fields D2c: Log10 of squared deformation rate tensor weighted by volume fraction vel: Magnitude of velocity trA: Log10 of excess trace of conformation tensor scalar D2c [], vel [], trA []; scalar * list = NULL ; // List to store output fields Main Function Processes simulation data and computes derived quantities Arguments: arguments[1]: Input filename arguments[2-5]: Domain boundaries (xmin, ymin, xmax, ymax) arguments[6]: Number of grid points in y-direction (ny) Returns: 0 on successful execution int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); xmin = atof ( arguments [ 2 ]); ymin = atof ( arguments [ 3 ]); xmax = atof ( arguments [ 4 ]); ymax = atof ( arguments [ 5 ]); ny = atoi ( arguments [ 6 ]); // Initialize list of fields to output list = list_add ( list , D2c ); list = list_add ( list , vel ); list = list_add ( list , trA ); Data Processing Workflow Restore simulation state from snapshot file Compute derived quantities at each grid point Interpolate fields onto regular grid Output data to file restore ( file = filename ); Field Computation For each cell, compute: - Components of the deformation rate tensor D - Squared magnitude of D weighted by volume fraction - Velocity magnitude - Excess trace of the conformation tensor foreach () { // Compute deformation rate tensor components double D11 = ( u . y [ 0 , 1 ] - u . y [ 0 , - 1 ]) / ( 2 * Delta ); double D22 = ( u . y [] / y ); double D33 = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ]) / ( 2 * Delta ); double D13 = 0.5 * (( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 , - 1 ]) / ( 2 * Delta )); double D2 = ( sq ( D11 ) + sq ( D22 ) + sq ( D33 ) + 2.0 * sq ( D13 )); D2c [] = f [] * D2 ; // Take log10 of D2c for better visualization if ( D2c [] > 0. ) { D2c [] = log ( D2c []) / log ( 10 ); } else { D2c [] = - 10 ; } // Compute velocity magnitude vel [] = sqrt ( sq ( u . x []) + sq ( u . y [])); // Compute excess trace of conformation tensor trA [] = ( A11 [] + A22 [] + conform_qq []) / 3.0 - 1.0 ; // Take log10 of trA for better visualization if ( trA [] > 0. ) { trA [] = log ( trA []) / log ( 10 ); } else { trA [] = - 10 ; } } Grid Interpolation and Output Calculate grid spacing based on domain size and ny Allocate memory for interpolated field values Interpolate field values onto regular grid Output grid coordinates and field values FILE * fp = ferr ; Deltay = ( double )(( ymax - ymin ) / ( ny )); nx = ( int )(( xmax - xmin ) / Deltay ); Deltax = ( double )(( xmax - xmin ) / ( nx )); len = list_len ( list ); // Allocate memory for field values double ** field = ( double **) matrix_new ( nx , ny + 1 , len * sizeof ( double )); // Interpolate field values onto regular grid for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , x , y ); } } } // Output grid coordinates and field values for ( int i = 0 ; i < nx ; i ++) { double x = Deltax * ( i + 1. / 2 ) + xmin ; for ( int j = 0 ; j < ny ; j ++) { double y = Deltay * ( j + 1. / 2 ) + ymin ; fprintf ( fp , \" %g %g \" , x , y ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } // Clean up fflush ( fp ); fclose ( fp ); matrix_free ( field ); return 0 ; }",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"scalar f[];// Volume fraction fieldvector u[];// Velocity fieldscalar A11[],A12[],A22[];// Conformation tensor componentsscalar conform_qq[];// Additional conformation tensor componentcharfilename[80];// Input file nameintnx,ny,len;// Grid dimensions and field countdoublexmin,ymin,xmax,ymax,Deltax,Deltay;// Domain boundaries and grid spacing",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "scalar D2c[],vel[],trA[];scalar*list=NULL;// List to store output fields",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);xmin=atof(arguments[2]);ymin=atof(arguments[3]);xmax=atof(arguments[4]);ymax=atof(arguments[5]);ny=atoi(arguments[6]);// Initialize list of fields to outputlist=list_add(list,D2c);list=list_add(list,vel);list=list_add(list,trA);",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: foreach(){// Compute deformation...",
    "content": "foreach(){// Compute deformation rate tensor componentsdoubleD11=(u.y[0,1]-u.y[0,-1])/(2*Delta);doubleD22=(u.y[]/y);doubleD33=(u.x[1,0]-u.x[-1,0])/(2*Delta);doubleD13=0.5*((u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(2*Delta));doubleD2=(sq(D11)+sq(D22)+sq(D33)+2.0*sq(D13));D2c[]=f[]*D2;// Take log10 of D2c for better visualizationif(D2c[]>0.){D2c[]=log(D2c[])/log(10);}else{D2c[]=-10;}// Compute velocity magnitudevel[]=sqrt(sq(u.x[])+sq(u.y[]));// Compute excess trace of conformation tensortrA[]=(A11[]+A22[]+conform_qq[])/3.0-1.0;// Take log10 of trA for better visualizationif(trA[]>0.){trA[]=log(trA[])/log(10);}else{trA[]=-10;}}",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getData-elastic-scalar2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "FILE*fp=ferr;Deltay=(double)((ymax-ymin)/(ny));nx=(int)((xmax-xmin)/Deltay);Deltax=(double)((xmax-xmin)/(nx));len=list_len(list);// Allocate memory for field valuesdouble**field=(double**)matrix_new(nx,ny+1,len*sizeof(double));// Interpolate field values onto regular gridfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,x,y);}}}// Output grid coordinates and field valuesfor(inti=0;i<nx;i++){doublex=Deltax*(i+1./2)+xmin;for(intj=0;j<ny;j++){doubley=Deltay*(j+1./2)+ymin;fprintf(fp,\"%g%g\",x,y);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}// Clean upfflush(fp);fclose(fp);matrix_free(field);return0;}",
    "url": "https://comphy-lab.org/fiber/postProcess/getData-elastic-scalar2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "postProcess/getFacet2D.c See raw file Getting Facets A utility for extracting interface facets from fluid simulation data. Description This program extracts and outputs the facets representing the interface between different phases in a multiphase flow simulation. The facets define the boundary between fluid phases, useful for geometric analysis and visualization of the interface morphology. Physics Background In multiphase fluid simulations, interfaces between different fluids are critical features that determine many physical phenomena like surface tension effects, droplet formation, and coalescence events. This utility identifies these interfaces by extracting facets from volume fraction data, allowing for quantitative analysis of interfacial dynamics.",
    "url": "https://comphy-lab.org/fiber/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology: C/C++ Code",
    "content": "Usage ./getFacets input_file Author: Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Department University of Twente #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" scalar f []; // Volume fraction field char filename [ 80 ]; Main Function Loads a simulation snapshot and extracts the interface facets. Input parameters: arguments[1] : Filename of the simulation snapshot to process Process: Restores the simulation state from the specified file Extracts interface facets from the volume fraction field Outputs facet data to standard error Return value: Returns 0 on successful completion Note: The facet extraction algorithm identifies where the volume fraction field crosses a threshold value (typically 0.5) between adjacent cells. int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); FILE * fp = ferr ; output_facets ( f , fp ); fflush ( fp ); fclose ( fp ); return 0 ; }",
    "url": "https://comphy-lab.org/fiber/postProcess/getFacet2D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"scalar f[];// Volume fraction fieldcharfilename[80];",
    "url": "https://comphy-lab.org/fiber/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacet2D.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);restore(file=filename);FILE*fp=ferr;output_facets(f,fp);fflush(fp);fclose(fp);return0;}",
    "url": "https://comphy-lab.org/fiber/postProcess/getFacet2D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "postProcess/VideoAxi.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Viscoelastic Visualization Tool This script processes and visualizes fluid dynamics simulation data, particularly focused on droplet impact and deformable soft matter like liquid drops, sheets, and bubbles. It extracts interface positions and scalar field data from simulation files and creates visualizations showing physical quantities like strain rates and stresses. The script is designed to process multiple simulation snapshots in parallel, extracting data using external executables and generating visualizations with proper colormaps, scales, and mathematical labels.",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology: Features: - Extracts...",
    "content": "Features: - Extracts fluid interfaces and scalar fields from simulation files - Generates visualizations with proper colormaps and mathematical labels - Processes multiple timesteps in parallel using multiprocessing - Configurable via command-line arguments for different simulation cases - Creates publication-quality figures with LaTeX-rendered mathematical expressions Usage: python fluid_vis.py [options] Command-line Arguments: \u2013CPUs Number of CPUs to use for parallel processing (default: all available) \u2013nGFS Number of restart files to process (default: 550) \u2013ZMAX Maximum Z coordinate for visualization (default: 4.0) \u2013RMAX Maximum R coordinate for visualization (default: 2.0) \u2013ZMIN Minimum Z coordinate for visualization (default: -4.0) \u2013caseToProcess Path to simulation case directory (default: \u2018../simulationCases/dropImpact\u2019) \u2013folderToSave Directory to save visualization images (default: \u2018dropImpact\u2019) Dependencies: External executables: getFacet2D, getData-elastic-scalar2D Python libraries: numpy, matplotlib, subprocess, multiprocessing Author: Vatsal Sanjay Email: vatsalsanjay@gmail.com Affiliation: Physics of Fluids Last updated: Jul 24, 2024 import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter import multiprocessing as mp from functools import partial import argparse import matplotlib.colors as mcolors custom_colors = [ \"white\" , \"#DA8A67\" , \"#A0522D\" , \"#400000\" ] custom_cmap = mcolors.LinearSegmentedColormap.from_list( \"custom_hot\" , custom_colors) # Configure matplotlib for publication-quality figures with LaTeX rendering matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r' \\ usepackage{amsmath}' def gettingFacets(filename, includeCoat = 'true' ): Extract interface positions (facets) from simulation files.",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file includeCoat (str, optional): Whether to include coating layer. Defaults to \u2018true\u2019. Returns: list: List of line segments defining fluid interfaces exe = [ \"./getFacet2D\" , filename, includeCoat] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) segs = [] skip = False if ( len (temp2) > 1e2 ): for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: skip = False pass else : if not skip: temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1),(r2, z2))) segs.append((( - r1, z1),( - r2, z2))) skip = True return segs def gettingfield(filename, zmin, zmax, rmax, nr): Extract scalar field data from simulation files.",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology: Args: filename (str):...",
    "content": "Args: filename (str): Path to simulation snapshot file zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate rmax (float): Maximum R coordinate nr (int): Number of grid points in R direction Returns: tuple: (R, Z, D2, vel, taup, nz) arrays of coordinates and field values exe = [ \"./getData-elastic-scalar2D\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr)] p = sp.Popen(exe, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() temp1 = stderr.decode( \"utf-8\" ) temp2 = temp1.split( \" \\n \" ) # print(temp2) #debugging Rtemp, Ztemp, D2temp, veltemp, taupTemp = [],[],[],[],[] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ '' ]: pass else : Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) taupTemp.append( float (temp3[ 4 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) taup = np.asarray(taupTemp) nz = int ( len (Z) / nr) # print(\"nr is %d %d\" % (nr, len(R))) # debugging print ( \"nz is %d \" % nz) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) taup.resize((nz, nr)) return R, Z, D2, vel, taup, nz # ---------------------------------------------------------------------------------------------------------------------- def process_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess): Process a single timestep from simulation data and generate visualization.",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology: Args: ti (int):...",
    "content": "Args: ti (int): Timestep index folder (str): Directory to save output images nGFS (int): Total number of timesteps GridsPerR (int): Grid points per unit length in R direction rmin (float): Minimum R coordinate rmax (float): Maximum R coordinate zmin (float): Minimum Z coordinate zmax (float): Maximum Z coordinate lw (float): Line width for plot elements caseToProcess (str): Path to simulation case directory t = 0.01 * ti place = f\" { caseToProcess } /intermediate/snapshot- { t :.4f} \" name = f\" { folder } / { int (t * 1000 ) :08d} .png\" if not os.path.exists(place): print ( f\" { place } File not found!\" ) return if os.path.exists(name): print ( f\" { name } Image present!\" ) return segs1 = gettingFacets(place) segs2 = gettingFacets(place, 'false' ) if not segs1 and not segs2: print ( f\"Problem in the available file { place } \" ) return nr = int (GridsPerR * rmax) R, Z, taus, vel, taup, nz = gettingfield(place, zmin, zmax, rmax, nr) zminp, zmaxp, rminp, rmaxp = Z. min (), Z. max (), R. min (), R. max () # Plotting AxesLabel, TickLabel = 50 , 20 fig, ax = plt.subplots() fig.set_size_inches( 19.20 , 10.80 ) # Draw domain boundaries ax.plot([ 0 , 0 ], [zmin, zmax], '-.' , color = 'grey' , linewidth = lw) ax.plot([rmin, rmin], [zmin, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmin, zmin], '-' , color = 'black' , linewidth = lw) ax.plot([rmin, rmax], [zmax, zmax], '-' , color = 'black' , linewidth = lw) ax.plot([rmax, rmax], [zmin, zmax], '-' , color = 'black' , linewidth = lw) # Add fluid interfaces line_segments = LineCollection(segs2, linewidths = 4 , colors = 'green' , linestyle = 'solid' ) ax.add_collection(line_segments) line_segments = LineCollection(segs1, linewidths = 4 , colors = 'blue' , linestyle = 'solid' ) ax.add_collection(line_segments) # Plot scalar fields with colormaps cntrl1 = ax.imshow(taus, cmap = \"hot_r\" , interpolation = 'Bilinear' , origin = 'lower' , extent = [ - rminp, - rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # TODO : fixme the colorbar bounds for taup must be set manually based on the simulated case. cntrl2 = ax.imshow(taup, interpolation = 'Bilinear' , cmap = custom_cmap, origin = 'lower' , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 3.0 ) # Set plot properties ax.set_aspect( 'equal' ) ax.set_xlim(rmin, rmax) ax.set_ylim(zmin, zmax) ax.set_title( f'$t/ \\\\ tau_ \\\\ gamma$ = { t :4.3f} ' , fontsize = TickLabel) # Add colorbars l, b, w, h = ax.get_position().bounds # Left colorbar cb1 = fig.add_axes([l - 0.04 , b, 0.03 , h]) c1 = plt.colorbar(cntrl1, cax = cb1, orientation = 'vertical' ) c1.set_label( r' $ \\ log_ {10} \\ left ( \\| \\m athcal{D} \\|\\r ight ) $ ' , fontsize = TickLabel, labelpad = 5 ) c1.ax.tick_params(labelsize = TickLabel) c1.ax.yaxis.set_ticks_position( 'left' ) c1.ax.yaxis.set_label_position( 'left' ) c1.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.1f} ' )) # Right colorbar cb2 = fig.add_axes([l + w + 0.01 , b, 0.03 , h]) c2 = plt.colorbar(cntrl2, cax = cb2, orientation = 'vertical' ) c2.ax.tick_params(labelsize = TickLabel) c2.set_label( r' $ \\ log_ {10} \\ left ( \\t ext{tr} \\ left ( \\m athcal{A} \\r ight ) -1 \\r ight ) $ ' , fontsize = TickLabel) c2.ax.yaxis.set_major_formatter(StrMethodFormatter( ' {x:,.2f} ' )) ax.axis( 'off' ) plt.savefig(name, bbox_inches = \"tight\" ) plt.close() def main(): Main function that parses command-line arguments and parallelizes processing of timesteps. # Set up command-line argument parsing parser = argparse.ArgumentParser(description = 'Process fluid dynamics simulation data and create visualizations' ) parser.add_argument( '--CPUs' , type = int , default = mp.cpu_count(), help = 'Number of CPUs to use (default: all available)' ) parser.add_argument( '--nGFS' , type = int , default = 550 , help = 'Number of restart files to process (default: 550)' ) parser.add_argument( '--ZMAX' , type = float , default = 4.0 , help = 'Maximum Z value (default: 4.0)' ) parser.add_argument( '--RMAX' , type = float , default = 2.0 , help = 'Maximum R value (default: 2.0)' ) parser.add_argument( '--ZMIN' , type = float , default =- 4.0 , help = 'Minimum Z value (default: -4.0)' ) parser.add_argument( '--caseToProcess' , type = str , default = '../simulationCases/dropImpact' , help = 'Case to process (default: ../simulationCases/dropImpact)' ) parser.add_argument( '--folderToSave' , type = str , default = 'dropImpact' , help = 'Folder to save output images (default: dropImpact)' ) args = parser.parse_args() # Extract arguments CPUStoUse = args.CPUs nGFS = args.nGFS ZMAX = args.ZMAX RMAX = args.RMAX ZMIN = args.ZMIN num_processes = CPUStoUse rmin, rmax, zmin, zmax = [ - RMAX, RMAX, ZMIN, ZMAX] GridsPerR = 128 # Grid resolution parameter lw = 2 # Line width for plot elements folder = args.folderToSave caseToProcess = args.caseToProcess # Create output directory if it doesn't exist if not os.path.isdir(folder): os.makedirs(folder) # Create a pool of worker processes for parallel processing with mp.Pool(processes = num_processes) as pool: # Create partial function with fixed arguments process_func = partial(process_timestep, folder = folder, nGFS = nGFS, GridsPerR = GridsPerR, rmin = rmin, rmax = rmax, zmin = zmin, zmax = zmax, lw = lw, caseToProcess = caseToProcess) # Map the process_func to all timesteps pool. map (process_func, range (nGFS)) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Methods",
    "content": "importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatterimportmultiprocessingasmpfromfunctoolsimportpartialimportargparseimportmatplotlib.colorsasmcolorscustom_colors=[\"white\",\"#DA8A67\",\"#A0522D\",\"#400000\"]custom_cmap=mcolors.LinearSegmentedColormap.from_list(\"custom_hot\", custom_colors)# Configure matplotlib for publication-quality figures with LaTeX renderingmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'defgettingFacets(filename, includeCoat='true'):",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "exe=[\"./getFacet2D\", filename, includeCoat]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")segs=[]skip=Falseif(len(temp2)>1e2):forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:skip=Falsepasselse:ifnotskip:temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1),(r2, z2)))segs.append(((-r1, z1),(-r2, z2)))skip=Truereturnsegsdefgettingfield(filename, zmin, zmax, rmax, nr):",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "exe=[\"./getData-elastic-scalar2D\", filename,str(zmin),str(0),str(zmax),str(rmax),str(nr)]p=sp.Popen(exe, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()temp1=stderr.decode(\"utf-8\")temp2=temp1.split(\"\\n\")# print(temp2) #debuggingRtemp, Ztemp, D2temp, veltemp, taupTemp=[],[],[],[],[]forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==['']:passelse:Ztemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))taupTemp.append(float(temp3[4]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)taup=np.asarray(taupTemp)nz=int(len(Z)/nr)# print(\"nr is %d %d\" % (nr, len(R))) # debuggingprint(\"nz is%d\"%nz)R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))taup.resize((nz, nr))returnR, Z, D2, vel, taup, nz# ----------------------------------------------------------------------------------------------------------------------defprocess_timestep(ti, folder, nGFS, GridsPerR, rmin, rmax, zmin, zmax, lw, caseToProcess):",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "t=0.01*tiplace=f\"{caseToProcess}/intermediate/snapshot-{t:.4f}\"name=f\"{folder}/{int(t*1000):08d}.png\"ifnotos.path.exists(place):print(f\"{place}File not found!\")returnifos.path.exists(name):print(f\"{name}Image present!\")returnsegs1=gettingFacets(place)segs2=gettingFacets(place,'false')ifnotsegs1andnotsegs2:print(f\"Problem in the available file{place}\")returnnr=int(GridsPerR*rmax)R, Z, taus, vel, taup, nz=gettingfield(place, zmin, zmax, rmax, nr)zminp, zmaxp, rminp, rmaxp=Z.min(), Z.max(), R.min(), R.max()# PlottingAxesLabel, TickLabel=50,20fig, ax=plt.subplots()fig.set_size_inches(19.20,10.80)# Draw domain boundariesax.plot([0,0], [zmin, zmax],'-.', color='grey', linewidth=lw)ax.plot([rmin, rmin], [zmin, zmax],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmin, zmin],'-', color='black', linewidth=lw)ax.plot([rmin, rmax], [zmax, zmax],'-', color='black', linewidth=lw)ax.plot([rmax, rmax], [zmin, zmax],'-', color='black', linewidth=lw)# Add fluid interfacesline_segments=LineCollection(segs2, linewidths=4, colors='green', linestyle='solid')ax.add_collection(line_segments)line_segments=LineCollection(segs1, linewidths=4, colors='blue', linestyle='solid')ax.add_collection(line_segments)# Plot scalar fields with colormapscntrl1=ax.imshow(taus, cmap=\"hot_r\", interpolation='Bilinear', origin='lower',extent=[-rminp,-rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)#TODO: fixme the colorbar bounds for taup must be set manually based on the simulated case.cntrl2=ax.imshow(taup, interpolation='Bilinear', cmap=custom_cmap, origin='lower',extent=[rminp, rmaxp, zminp, zmaxp], vmax=2.0, vmin=-3.0)# Set plot propertiesax.set_aspect('equal')ax.set_xlim(rmin, rmax)ax.set_ylim(zmin, zmax)ax.set_title(f'$t/\\\\tau_\\\\gamma$ ={t:4.3f}', fontsize=TickLabel)# Add colorbarsl, b, w, h=ax.get_position().bounds# Left colorbarcb1=fig.add_axes([l-0.04, b,0.03, h])c1=plt.colorbar(cntrl1, cax=cb1, orientation='vertical')c1.set_label(r'$\\log_{10}\\left(\\|\\mathcal{D}\\|\\right)$', fontsize=TickLabel, labelpad=5)c1.ax.tick_params(labelsize=TickLabel)c1.ax.yaxis.set_ticks_position('left')c1.ax.yaxis.set_label_position('left')c1.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}'))# Right colorbarcb2=fig.add_axes([l+w+0.01, b,0.03, h])c2=plt.colorbar(cntrl2, cax=cb2, orientation='vertical')c2.ax.tick_params(labelsize=TickLabel)c2.set_label(r'$\\log_{10}\\left(\\text{tr}\\left(\\mathcal{A}\\right)-1\\right)$', fontsize=TickLabel)c2.ax.yaxis.set_major_formatter(StrMethodFormatter('{x:,.2f}'))ax.axis('off')plt.savefig(name, bbox_inches=\"tight\")plt.close()defmain():",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/VideoAxi.py | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: # Set up...",
    "content": "# Set up command-line argument parsingparser=argparse.ArgumentParser(description='Process fluid dynamics simulation data and create visualizations')parser.add_argument('--CPUs',type=int, default=mp.cpu_count(),help='Number of CPUs to use (default: all available)')parser.add_argument('--nGFS',type=int, default=550,help='Number of restart files to process (default: 550)')parser.add_argument('--ZMAX',type=float, default=4.0,help='Maximum Z value (default: 4.0)')parser.add_argument('--RMAX',type=float, default=2.0,help='Maximum R value (default: 2.0)')parser.add_argument('--ZMIN',type=float, default=-4.0,help='Minimum Z value (default: -4.0)')parser.add_argument('--caseToProcess',type=str,default='../simulationCases/dropImpact',help='Case to process (default: ../simulationCases/dropImpact)')parser.add_argument('--folderToSave',type=str, default='dropImpact',help='Folder to save output images (default: dropImpact)')args=parser.parse_args()# Extract argumentsCPUStoUse=args.CPUsnGFS=args.nGFSZMAX=args.ZMAXRMAX=args.RMAXZMIN=args.ZMINnum_processes=CPUStoUsermin, rmax, zmin, zmax=[-RMAX, RMAX, ZMIN, ZMAX]GridsPerR=128# Grid resolution parameterlw=2# Line width for plot elementsfolder=args.folderToSavecaseToProcess=args.caseToProcess# Create output directory if it doesn't existifnotos.path.isdir(folder):os.makedirs(folder)# Create a pool of worker processes for parallel processingwithmp.Pool(processes=num_processes)aspool:# Create partial function with fixed argumentsprocess_func=partial(process_timestep,folder=folder, nGFS=nGFS,GridsPerR=GridsPerR, rmin=rmin, rmax=rmax,zmin=zmin, zmax=zmax, lw=lw, caseToProcess=caseToProcess)# Map the process_func to all timestepspool.map(process_func,range(nGFS))if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/fiber/postProcess/VideoAxi.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "simulationCases/filamentExt.c See raw file @file filamentExt.c @brief This code will give an initial condition where the filament is stretched out, to be used for filament_retraction_VE.c The relaxation time is taken as infinity here to ensure that the polymers undergo affine deformation while stretching. @author Vatsal Sanjay @version 1.1 @date 2025-05-09 #include \"axi.h\" #include \"navier-stokes/centered.h\" #include \"log-conform-viscoelastic-scalar-2D.h\" #define logFile \"logAxi-scalar.dat\" 14 #define FILTERED // Smear density and viscosity jumps #include \"two-phaseVE.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"reduced.h\" #define tsnap ( 5e-2 ) 23 // Error tolerancs #define fErr ( 1e-3 ) // error tolerance in f1 VOF #define KErr ( 1e-6 ) // error tolerance in VoF curvature calculated using heigh function method (see adapt event) #define VelErr ( 1e-2 ) // error tolerances in velocity -- Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J #define trAErr ( 1e-3 ) // error tolerance in trace of conformation tensor #define R2 ( x , y , z ) ( sqrt ( sq ( x ) + sq ( y ))) 31 // boundary conditions u . n [ top ] = neumann ( 0.0 ); p [ top ] = dirichlet ( 0.0 ); u . n [ right ] = neumann ( 0.0 ); p [ right ] = dirichlet ( 0.0 ); int MAXlevel ; // Bond number -> dimensionless driving... // Oh -> Solvent Ohnesorge number // Oha -> air Ohnesorge number // De -> Deborah number // Ec -> Elasto-capillary number // for now there is no viscoelasticity double Bo , Oh , Oha , De , Ec , tmax ; char nameOut [ 80 ], dumpFile [ 80 ]; static FILE * logFp = NULL ; int main ( int argc , char const * argv []) { L0 = 16. ; // Values taken from the terminal MAXlevel = 10 ; tmax = 10.0 ; Bo = 4e0 ; Oh = 1e-1 ; Oha = 1e-5 ; De = 1e30 ; // 1e-1; Ec = 1.0 ; // 1e-2; init_grid ( 1 << 6 ); // Create a folder named intermediate where all the simulation snapshots are stored. char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); // Name of the restart file.",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "See writingFiles event. sprintf ( dumpFile , \"restart\" ); rho1 = 1. , rho2 = 1e-3 ; mu1 = Oh , mu2 = Oha ; lambda1 = De , lambda2 = 0. ; G1 = Ec , G2 = 0. ; G . x = Bo ; f . sigma = 1.0 ; run (); } event init ( t = 0 ) { if (! restore ( file = dumpFile )){ refine ( R2 ( x , y , z ) < ( 1.1 ) && R2 ( x , y , z ) > ( 0.9 ) && level < MAXlevel ); fraction ( f , ( 1 - R2 ( x , y , z ))); } } Adaptive Mesh Refinement scalar KAPPA [], trA []; event adapt ( i ++){ curvature ( f , KAPPA ); foreach () { trA [] = ( A11 [] + A22 [] + AThTh []); } adapt_wavelet (( scalar *){ f , u . x , u . y , KAPPA , trA }, ( double []){ fErr , VelErr , VelErr , KErr , trAErr }, MAXlevel , 4 ); } Dumping snapshots event writingFiles ( t = 0 ; t += tsnap ; t <= tmax ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Ending Simulation event end ( t = end ) { if ( pid () == 0 ) { fprintf ( ferr , \"Level %d , Oh %2.1e\\n \" , MAXlevel , Oh ); // Close log file if ( logFp != NULL ) { fclose ( logFp ); logFp = NULL ; } } } Log file initialization event logInit ( i = 0 ) { if ( pid () == 0 ) { logFp = fopen ( logFile , \"w\" ); if ( logFp == NULL ) { fprintf ( ferr , \"Error opening log file \\n \" ); return 1 ; } fprintf ( ferr , \"Level %d , Bo %2.1e , Oh %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Bo , Oh , Oha , De , Ec ); fprintf ( ferr , \"i dt t ke \\n \" ); fprintf ( logFp , \"Level %d , Bo %2.1e , Oh %2.1e , Oha %2.1e , De %2.1e , Ec %2.1e\\n \" , MAXlevel , Bo , Oh , Oha , De , Ec ); fprintf ( logFp , \"i dt t ke \\n \" ); fflush ( logFp ); } } Log writing event logWriting ( i ++) { double ke = 0. ; foreach ( reduction (+: ke )){ ke += ( 2 * pi * y )*( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])+ sq ( u . z [])))* sq ( Delta ); } if ( pid () == 0 ) { fprintf ( logFp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); fflush ( logFp ); } assert ( ke > - 1e-10 ); if ( i > 1e4 && pid () == 0 ) { if ( ke > 1e2 || ke < 1e-8 ) { const char * message = ( ke > 1e2 ) ? \"The kinetic energy blew up.",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology: Stopping simulation \\n...",
    "content": "Stopping simulation \\n \" : \"kinetic energy too small now! Stopping! \\n \" ; fprintf ( ferr , \" %s \" , message ); FILE * fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %s \" , message ); fflush ( fp ); fclose ( fp ); dump ( file = dumpFile ); return 1 ; } } }",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code: C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"#include\"log-conform-viscoelastic-scalar-2D.h\"#define logFile\"logAxi-scalar.dat\"14#define FILTERED// Smear density and viscosity jumps#include\"two-phaseVE.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include\"reduced.h\"#define tsnap(5e-2)23// Error tolerancs#define fErr(1e-3)// error tolerance in f1 VOF#define KErr(1e-6)// error tolerance in VoF curvature calculated using heigh function method (see adapt event)#define VelErr(1e-2)// error tolerances in velocity -- Use 1e-2 for low Oh and 1e-3 to 5e-3 for high Oh/moderate to high J#define trAErr(1e-3)// error tolerance in trace of conformation tensor#define R2(x,y,z)(sqrt(sq(x)+sq(y)))31// boundary conditionsu.n[top]=neumann(0.0);p[top]=dirichlet(0.0);u.n[right]=neumann(0.0);p[right]=dirichlet(0.0);intMAXlevel;// Bond number -> dimensionless driving...// Oh -> Solvent Ohnesorge number// Oha -> air Ohnesorge number// De -> Deborah number// Ec -> Elasto-capillary number// for now there is no viscoelasticitydoubleBo,Oh,Oha,De,Ec,tmax;charnameOut[80],dumpFile[80];staticFILE*logFp=NULL;intmain(intargc,charconst*argv[]){L0=16.;// Values taken from the terminalMAXlevel=10;tmax=10.0;Bo=4e0;Oh=1e-1;Oha=1e-5;De=1e30;// 1e-1;Ec=1.0;// 1e-2;init_grid(1<<6);// Create a folder named intermediate where all the simulation snapshots are stored.charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);// Name of the restart file.",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code: Context",
    "content": "See writingFiles event.sprintf(dumpFile,\"restart\");rho1=1.,rho2=1e-3;mu1=Oh,mu2=Oha;lambda1=De,lambda2=0.;G1=Ec,G2=0.;G.x=Bo;f.sigma=1.0;run();}event init(t=0){if(!restore(file=dumpFile)){refine(R2(x,y,z)<(1.1)&&R2(x,y,z)>(0.9)&&level<MAXlevel);fraction(f,(1-R2(x,y,z)));}}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "scalar KAPPA[],trA[];event adapt(i++){curvature(f,KAPPA);foreach(){trA[]=(A11[]+A22[]+AThTh[]);}adapt_wavelet((scalar*){f,u.x,u.y,KAPPA,trA},(double[]){fErr,VelErr,VelErr,KErr,trAErr},MAXlevel,4);}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "event end(t=end){if(pid()==0){fprintf(ferr,\"Level%d, Oh%2.1e\\n\",MAXlevel,Oh);// Close log fileif(logFp!=NULL){fclose(logFp);logFp=NULL;}}}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "event logInit(i=0){if(pid()==0){logFp=fopen(logFile,\"w\");if(logFp==NULL){fprintf(ferr,\"Error opening log file\\n\");return1;}fprintf(ferr,\"Level%d, Bo%2.1e, Oh%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Bo,Oh,Oha,De,Ec);fprintf(ferr,\"i dt t ke\\n\");fprintf(logFp,\"Level%d, Bo%2.1e, Oh%2.1e, Oha%2.1e, De%2.1e, Ec%2.1e\\n\",MAXlevel,Bo,Oh,Oha,De,Ec);fprintf(logFp,\"i dt t ke\\n\");fflush(logFp);}}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "event logWriting(i++){doubleke=0.;foreach(reduction(+:ke)){ke+=(2*pi*y)*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])+sq(u.z[])))*sq(Delta);}if(pid()==0){fprintf(logFp,\"%d%g%g%g\\n\",i,dt,t,ke);fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);fflush(logFp);}assert(ke>-1e-10);if(i>1e4&&pid()==0){if(ke>1e2||ke<1e-8){constchar*message=(ke>1e2)?\"The kinetic energy blew up. Stopping simulation\\n\":\"kinetic energy too small now!",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/filamentExt.c | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "Stopping!\\n\";fprintf(ferr,\"%s\",message);FILE*fp=fopen(\"log\",\"a\");fprintf(fp,\"%s\",message);fflush(fp);fclose(fp);dump(file=dumpFile);return1;}}}",
    "url": "https://comphy-lab.org/fiber/simulationCases/filamentExt.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | FIBER: Flow-Induced Breakup of Elastic Rheology",
    "content": "simulationCases/Makefile See raw file Makefile # Check if .project_config exists ifeq ( \\$ ( wildcard ../.project_config ) , ) \\$ ( error \"../.project_config not found\" ) endif BASILISK := \\$ ( shell . ../.project_config && echo \\$\\$ BASILISK ) CFLAGS += -O2 -disable-dimensions CFLAGS += -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local # Fix permissions for runtest script fix-permissions: @chmod +x \\$ ( BASILISK ) /src/runtest # Make all test targets depend on fix-permissions %.tst: fix-permissions include \\$ ( BASILISK ) /Makefile.defs",
    "url": "https://comphy-lab.org/fiber/simulationCases/Makefile.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "# Check if .project_config existsifeq(\\$(wildcard../.project_config),)\\$(error\"../.project_config not found\")endifBASILISK:=\\$(shell. ../.project_config&&echo\\$\\$BASILISK)CFLAGS+=-O2-disable-dimensionsCFLAGS+=-I\\$(PWD)/src-local-I\\$(PWD)/../src-local# Fix permissions for runtest scriptfix-permissions:@chmod+x\\$(BASILISK)/src/runtest# Make all test targets depend on fix-permissions%.tst:fix-permissionsinclude\\$(BASILISK)/Makefile.defs",
    "url": "https://comphy-lab.org/fiber/simulationCases/Makefile.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/cleanup.sh | FIBER: Flow-Induced Breakup of Elastic Rheology",
    "content": "simulationCases/cleanup.sh See raw file cleanup.sh #!/bin/bash rm -rf \\$ 1",
    "url": "https://comphy-lab.org/fiber/simulationCases/cleanup.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases cleanup.sh rm -rf \\$1 filamentExt.c u.n[top] = neumann(0.0); 34 p[top] = dirichlet(0.0); 35 u.n[right] = neumann(0.0); 36 p[right] = dirichlet(0.0); 37 3... Makefile ifeq (\\$(wildcard ../.projectconfig),) \\$(error '../.projectconfig not found') endif BASILISK := \\$(shell . ../.proje... runCases.sh ORIGDIR=\\$(pwd) mkdir -p \\$1 cp \\$1.c \\$1/ cd \\$1 qcc -I\\${ORIGDIR}/src-local -I\\${ORIGDIR}/../src-local -O2 -Wall -d...",
    "url": "https://comphy-lab.org/fiber/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCases.sh | FIBER: Flow-Induced Breakup of Elastic Rheology",
    "content": "simulationCases/runCases.sh See raw file runCases.sh #!/bin/bash # Save the original directory ORIG_DIR = \\$ ( pwd ) mkdir -p \\$ 1 cp \\$ 1.c \\$ 1/ cd \\$ 1 qcc -I\\${ORIG_DIR} /src-local -I\\${ORIG_DIR} /../src-local -O2 -Wall -disable-dimensions \\$ 1.c -o \\$ 1 -lm ./\\$1",
    "url": "https://comphy-lab.org/fiber/simulationCases/runCases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCases.sh | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "#!/bin/bash# Save the original directoryORIG_DIR=\\$(pwd)mkdir-p\\$1cp\\$1.c\\$1/cd\\$1qcc-I\\${ORIG_DIR}/src-local-I\\${ORIG_DIR}/../src-local-O2-Wall-disable-dimensions\\$1.c-o\\$1-lm./\\$1",
    "url": "https://comphy-lab.org/fiber/simulationCases/runCases.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files log-conform-viscoelastic-scalar-2D.h Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation. Therefore these materia... two-phaseVE.h This is a modified version of [two-phase.h](http://basilisk.fr/src/two-phase.h). It contains the implementation of Vi...",
    "url": "https://comphy-lab.org/fiber/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "src-local/two-phaseVE.h See raw file Modification by Vatsal Sanjay Version 2.0, Oct 17, 2024 Changelog Oct 17, 2024: added support for VE simulations. Brief history v1.0 is the vanilla Basilisk code for two-phase flows: http://basilisk.fr/src/two-phase.h + http://basilisk.fr/src/two-phase-generic.h v2.0 is the modification for viscoelastic fluids using the log-conformation method. Two-phase interfacial flows This is a modified version of two-phase.h . It contains the implementation of Viscoplastic Fluid (Bingham Fluid). This file helps setup simulations for flows of two fluids separated by an interface (i.e. immiscible fluids). It is typically used in combination with a Navier\u2013Stokes solver . The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2.",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology: C/C++ Code",
    "content": "The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. #include \"vof.h\" scalar f [], * interfaces = { f }; double rho1 = 1. , mu1 = 0. , rho2 = 1. , mu2 = 0. ; double G1 = 0. , G2 = 0. ; // elastic moduli double lambda1 = 0. , lambda2 = 0. ; // relaxation times double TOLelastic = 1e-2 ; // tolerance for elastic modulus #TOFIX: this must always be a very small number. Auxilliary fields are necessary to define the (variable) specific volume \\(\\alpha=1/\\rho\\) as well as the cell-centered density. face vector alphav []; scalar rhov []; scalar Gpd []; scalar lambdapd []; event defaults ( i = 0 ) { alpha = alphav ; rho = rhov ; Gp = Gpd ; lambda = lambdapd ; If the viscosity is non-zero, we need to allocate the face-centered viscosity field. mu = new face vector ; } The density and viscosity are defined using arithmetic averages by default.",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Definitions - Python Function",
    "content": "The user can overload these definitions to use other types of averages (i.e. harmonic). #ifndef rho # define rho ( f ) ( clamp ( f , 0. , 1. )*( rho1 - rho2 ) + rho2 ) 62 #endif #ifndef mu // for Arithmetic mean, use this # define mu ( f ) ( clamp ( f , 0. , 1. )*( mu1 - mu2 ) + mu2 ) 66 #endif We have the option of using some \u201csmearing\u201d of the density/viscosity jump. #ifdef FILTERED scalar sf []; #else # define sf f 76 #endif event tracer_advection ( i ++) { When using smearing of the density jump, we initialise sf with the vertex-average of f . #ifndef sf #if dimension <= foreach () sf [] = ( 4. * f [] + 2. *( f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 1 , 0 ] + f [- 1 , 0 ]) + f [- 1 ,- 1 ] + f [ 1 ,- 1 ] + f [ 1 , 1 ] + f [- 1 , 1 ])/ 16. ; #else // dimension == foreach () sf [] = ( 8. * f [] + 4. *( f [- 1 ] + f [ 1 ] + f [ 0 , 1 ] + f [ 0 ,- 1 ] + f [ 0 , 0 , 1 ] + f [ 0 , 0 ,- 1 ]) + 2. *( f [- 1 , 1 ] + f [- 1 , 0 , 1 ] + f [- 1 , 0 ,- 1 ] + f [- 1 ,- 1 ] + f [ 0 , 1 , 1 ] + f [ 0 , 1 ,- 1 ] + f [ 0 ,- 1 , 1 ] + f [ 0 ,- 1 ,- 1 ] + f [ 1 , 1 ] + f [ 1 , 0 , 1 ] + f [ 1 ,- 1 ] + f [ 1 , 0 ,- 1 ]) + f [ 1 ,- 1 , 1 ] + f [- 1 , 1 , 1 ] + f [- 1 , 1 ,- 1 ] + f [ 1 , 1 , 1 ] + f [ 1 , 1 ,- 1 ] + f [- 1 ,- 1 ,- 1 ] + f [ 1 ,- 1 ,- 1 ] + f [- 1 ,- 1 , 1 ])/ 64. ; #endif #endif #if TREE sf . prolongation = refine_bilinear ; sf . dirty = true ; // boundary conditions need to be updated #endif } event properties ( i ++) { foreach_face () { double ff = ( sf [] + sf [- 1 ])/ 2. ; alphav . x [] = fm . x []/ rho ( ff ); face vector muv = mu ; muv . x [] = fm . x []* mu ( ff ); } foreach (){ rhov [] = cm []* rho ( sf []); Gpd [] = 0. ; lambdapd [] = 0. ; if ( clamp ( sf [], 0. , 1. ) > TOLelastic ){ Gpd [] += G1 * clamp ( sf [], 0. , 1. ); lambdapd [] += lambda1 * clamp ( sf [], 0. , 1. ); } if ( clamp (( 1 - sf []), 0. , 1. ) > TOLelastic ){ Gpd [] += G2 * clamp (( 1 - sf []), 0. , 1. ); lambdapd [] += lambda2 * clamp (( 1 - sf []), 0. , 1. ); } } #if TREE sf . prolongation = fraction_refine ; sf . dirty = true ; // boundary conditions need to be updated #endif }",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code",
    "content": "#include\"vof.h\"scalar f[],*interfaces={f};doublerho1=1.,mu1=0.,rho2=1.,mu2=0.;doubleG1=0.,G2=0.;// elastic modulidoublelambda1=0.,lambda2=0.;// relaxation timesdoubleTOLelastic=1e-2;// tolerance for elastic modulus #TOFIX: this must always be a very small number.",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "face vector alphav[];scalar rhov[];scalar Gpd[];scalar lambdapd[];event defaults(i=0){alpha=alphav;rho=rhov;Gp=Gpd;lambda=lambdapd;",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Function: rho",
    "content": "#ifndef rho# define rho(f)(clamp(f,0.,1.)*(rho1-rho2)+rho2)62#endif#ifndef mu// for Arithmetic mean, use this# define mu(f)(clamp(f,0.,1.)*(mu1-mu2)+mu2)66#endif",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Function: FILTEREDscalar",
    "content": "#ifdef FILTEREDscalar sf[];#else# define sf f76#endifevent tracer_advection(i++){",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phaseVE.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Function: sf",
    "content": "#ifndef sf#if dimension <=foreach()sf[]=(4.*f[]+2.*(f[0,1]+f[0,-1]+f[1,0]+f[-1,0])+f[-1,-1]+f[1,-1]+f[1,1]+f[-1,1])/16.;#else// dimension ==foreach()sf[]=(8.*f[]+4.*(f[-1]+f[1]+f[0,1]+f[0,-1]+f[0,0,1]+f[0,0,-1])+2.*(f[-1,1]+f[-1,0,1]+f[-1,0,-1]+f[-1,-1]+f[0,1,1]+f[0,1,-1]+f[0,-1,1]+f[0,-1,-1]+f[1,1]+f[1,0,1]+f[1,-1]+f[1,0,-1])+f[1,-1,1]+f[-1,1,1]+f[-1,1,-1]+f[1,1,1]+f[1,1,-1]+f[-1,-1,-1]+f[1,-1,-1]+f[-1,-1,1])/64.;#endif#endif#if TREEsf.prolongation=refine_bilinear;sf.dirty=true;// boundary conditions need to be updated#endif}event properties(i++){foreach_face(){doubleff=(sf[]+sf[-1])/2.;alphav.x[]=fm.x[]/rho(ff);face vector muv=mu;muv.x[]=fm.x[]*mu(ff);}foreach(){rhov[]=cm[]*rho(sf[]);Gpd[]=0.;lambdapd[]=0.;if(clamp(sf[],0.,1.)>TOLelastic){Gpd[]+=G1*clamp(sf[],0.,1.);lambdapd[]+=lambda1*clamp(sf[],0.,1.);}if(clamp((1-sf[]),0.,1.)>TOLelastic){Gpd[]+=G2*clamp((1-sf[]),0.,1.);lambdapd[]+=lambda2*clamp((1-sf[]),0.,1.);}}#if TREEsf.prolongation=fraction_refine;sf.dirty=true;// boundary conditions need to be updated#endif}",
    "url": "https://comphy-lab.org/fiber/src-local/two-phaseVE.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Methods",
    "content": "src-local/log-conform-viscoelastic-scalar-2D.h See raw file Log-Conformation Method for 2D Viscoelastic Fluids Overview Title : log-conform-viscoelastic-scalar-2D.h Version : 2.5 Description : 2D and axisymmetric scalar implementation of viscoelastic fluid dynamics using the log-conformation method Key Features Conformation tensor A exists across domain and relaxes according to \u03bb Stress acts according to elastic modulus G Supports both 2D and axisymmetric configurations Scalar implementation approach for better performance Compatible with log-conform-viscoelastic.h Author Information Name : Vatsal Sanjay Email : vatsalsanjay@gmail.com Institution : Physics of Fluids Last Updated : Nov 23, 2024 Implementation Notes Based on http://basilisk.fr/src/log-conform.h with key improvements: Uses G-\u03bb formulation for better physical interpretation Fixes surface tension coupling bug where [\u03c3_p] = 0 & [\u03c3_s] = \u03b3\u03ba Ensures [\u03c3_s+\u03c3_p] = \u03b3\u03ba for correct interface behavior Version History v1.0 (Oct 18, 2024) Initial implementation with 2D+axi support Scalar-based implementation for efficiency v2.0 (Nov 3, 2024) Major documentation improvements Made code an axisymmetric mirror of log-conform-viscoelastic-scalar-3D.h Added negative eigenvalue detection with location reporting Added initialization functions for pseudo_v and pseudo_t v2.1 (Nov 14, 2024) Added support for infinite Deborah number cases v2.5 (Nov 23, 2024) Enhanced documentation clarity and completeness Future Work Tensor Formulation Convert to consistent tensor formulation for: Improved readability and maintainability Better computational efficiency Reduced potential for bugs Prerequisites for axi compatibility in 3D version Related issues: https://github.com/comphy-lab/Viscoelastic3D/issues/11 https://github.com/comphy-lab/Viscoelastic3D/issues/5 Code Improvements Enforce tensor usage throughout codebase Implement foreach_dimension compatibility The log-conformation method for viscoelastic constitutive models Introduction Viscoelastic fluids exhibit both viscous and elastic behaviour when subjected to deformation.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Therefore these materials...",
    "content": "Therefore these materials are governed by the Navier\u2013Stokes equations enriched with an extra elastic stress \\(Tij\\) \\[ \\rho\\left[\\partial_t\\mathbf{u}+\\nabla\\cdot(\\mathbf{u}\\otimes\\mathbf{u})\\right] = - \\nabla p + \\nabla\\cdot(2\\mu_s\\mathbf{D}) + \\nabla\\cdot\\mathbf{T} + \\rho\\mathbf{a} \\] where \\(\\mathbf{D}=[\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T]/2\\) is the deformation tensor and \\(\\mu_s\\) is the solvent viscosity of the viscoelastic fluid. The polymeric stress \\(\\mathbf{T}\\) represents memory effects due to the polymers. Several constitutive rheological models are available in the literature where the polymeric stress \\(\\mathbf{T}\\) is typically a function \\(\\mathbf{f_s}(\\cdot)\\) of the conformation tensor \\(\\mathbf{A}\\) such as \\[ \\mathbf{T} = G_p \\mathbf{f_s}(\\mathbf{A}) \\] where \\(G_p\\) is the elastic modulus and \\(\\mathbf{f_s}(\\cdot)\\) is the relaxation function.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: The conformation tensor...",
    "content": "The conformation tensor \\(\\mathbf{A}\\) is related to the deformation of the polymer chains. \\(\\mathbf{A}\\) is governed by the equation \\[ D_t \\mathbf{A} - \\mathbf{A} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{A} = -\\frac{\\mathbf{f_r}(\\mathbf{A})}{\\lambda} \\] where \\(D_t\\) denotes the material derivative and \\(\\mathbf{f_r}(\\cdot)\\) is the relaxation function. Here, \\(\\lambda\\) is the relaxation time. In the case of an Oldroyd-B viscoelastic fluid, \\(\\mathbf{f}_s (\\mathbf{A}) = \\mathbf{f}_r (\\mathbf{A}) = \\mathbf{A} -\\mathbf{I}\\) , and the above equations can be combined to avoid the use of \\(\\mathbf{A}\\) \\[ \\mathbf{T} + \\lambda (D_t \\mathbf{T} - \\mathbf{T} \\cdot \\nabla \\mathbf{u} - \\nabla \\mathbf{u}^{T} \\cdot \\mathbf{T}) = 2 G_p\\lambda \\mathbf{D} \\] Comminal et al. (2015) gathered the functions \\(\\mathbf{f}_s (\\mathbf{A})\\) and \\(\\mathbf{f}_r (\\mathbf{A})\\) for different constitutive models.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Parameters The primary...",
    "content": "Parameters The primary parameters are the relaxation time \\(\\lambda\\) and the elastic modulus \\(G_p\\) . The solvent viscosity \\(\\mu_s\\) is defined in the Navier-Stokes solver . Gp and lambda are defined in two-phaseVE.h . The log conformation approach The numerical resolution of viscoelastic fluid problems often faces the High-Weissenberg Number Problem . This is a numerical instability appearing when strongly elastic flows create regions of high stress and fine features. This instability poses practical limits to the values of the relaxation time of the viscoelastic fluid, \\(\\lambda\\) . Fattal & Kupferman (2004, 2005) identified the exponential nature of the solution as the origin of the instability. They proposed to use the logarithm of the conformation tensor \\(\\Psi = \\log \\, \\mathbf{A}\\) rather than the viscoelastic stress tensor to circumvent the instability.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: The constitutive equation...",
    "content": "The constitutive equation for the log of the conformation tensor is \\[ D_t \\Psi = (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) + 2 \\mathbf{B} + \\frac{e^{-\\Psi} \\mathbf{f}_r (e^{\\Psi})}{\\lambda} \\] where \\(\\Omega\\) and \\(\\mathbf{B}\\) are tensors that result from the decomposition of the transpose of the tensor gradient of the velocity \\[ (\\nabla \\mathbf{u})^T = \\Omega + \\mathbf{B} + N \\mathbf{A}^{-1} \\] The antisymmetric tensor \\(\\Omega\\) requires only the memory of a scalar in 2D since, \\[ \\Omega = \\left( \\begin{array}{cc} 0 & \\Omega_{12} \\\\ -\\Omega_{12} & 0 \\end{array} \\right) \\] For 3D, \\(\\Omega\\) is a skew-symmetric tensor given by \\[ \\Omega = \\left( \\begin{array}{ccc} 0 & \\Omega_{12} & \\Omega_{13} \\\\ -\\Omega_{12} & 0 & \\Omega_{23} \\\\ -\\Omega_{13} & -\\Omega_{23} & 0 \\end{array} \\right) \\] The log-conformation tensor, \\(\\Psi\\) , is related to the polymeric stress tensor \\(\\mathbf{T}\\) , by the strain function \\(\\mathbf{f}_s (\\mathbf{A})\\) \\[ \\Psi = \\log \\, \\mathbf{A} \\quad \\mathrm{and} \\quad \\mathbf{T} = \\frac{G_p}{\\lambda} \\mathbf{f}_s (\\mathbf{A}) \\] where \\(Tr\\) denotes the trace of the tensor and \\(L\\) is an additional property of the viscoelastic fluid.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: We will use...",
    "content": "We will use the Bell\u2013Collela\u2013Glaz scheme to advect the log-conformation tensor \\(\\Psi\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: TODO: - Perhaps,...",
    "content": "TODO: - Perhaps, instead of the Bell\u2013Collela\u2013Glaz scheme, we can use the conservative form of the advection equation and transport the log-conformation tensor with the VoF color function, similar to http://basilisk.fr/src/navier-stokes/conserving.h #include \"bcg.h\" ( const ) scalar Gp = unity ; // elastic modulus ( const ) scalar lambda = unity ; // relaxation time scalar A11 [], A12 [], A22 []; // conformation tensor scalar T11 [], T12 [], T22 []; // stress tensor #if AXI scalar AThTh [], T_ThTh []; #endif event defaults ( i = 0 ) { if ( is_constant ( a . x )) a = new face vector ; /* initialize A and T */ for ( scalar s in { A11 , A22 }) { foreach () { s [] = 1. ; } } for ( scalar s in { T11 , T12 , T22 , A12 }) { foreach (){ s [] = 0. ; } } #if AXI foreach (){ T_ThTh [] = 0 ; AThTh [] = 1. ; } #endif for ( scalar s in { T11 , T12 , T22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } for ( scalar s in { A11 , A12 , A22 }) { if ( s . boundary [ left ] != periodic_bc ) { s [ left ] = neumann ( 0 ); s [ right ] = neumann ( 0 ); } } #if AXI T12 [ bottom ] = dirichlet ( 0. ); A12 [ bottom ] = dirichlet ( 0. ); #endif } Useful functions in 2D The first step is to implement a routine to calculate the eigenvalues and eigenvectors of the conformation tensor \\(\\mathbf{A}\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Python Function",
    "content": "These structs ressemble Basilisk vectors and tensors but are just arrays not related to the grid. typedef struct { double x , y ;} pseudo_v ; typedef struct { pseudo_v x , y ;} pseudo_t ; // Function to initialize pseudo_v static inline void init_pseudo_v ( pseudo_v * v , double value ) { v -> x = value ; v -> y = value ; } // Function to initialize pseudo_t static inline void init_pseudo_t ( pseudo_t * t , double value ) { init_pseudo_v (& t -> x , value ); init_pseudo_v (& t -> y , value ); } static void diagonalization_2D ( pseudo_v * Lambda , pseudo_t * R , pseudo_t * A ) { The eigenvalues are saved in vector \\(\\Lambda\\) computed from the trace and the determinant of the symmetric conformation tensor \\(\\mathbf{A}\\) . if ( sq ( A -> x . y ) < 1e-15 ) { R -> x . x = R -> y . y = 1. ; R -> y . x = R -> x . y = 0. ; Lambda -> x = A -> x . x ; Lambda -> y = A -> y . y ; return ; } double T = A -> x . x + A -> y . y ; // Trace of the tensor double D = A -> x . x * A -> y . y - sq ( A -> x . y ); // Determinant The eigenvectors, \\(\\mathbf{v}_i\\) are saved by columns in tensor \\(\\mathbf{R} = (\\mathbf{v}_1|\\mathbf{v}_2)\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Context",
    "content": "R -> x . x = R -> x . y = A -> x . y ; R -> y . x = R -> y . y = - A -> x . x ; double s = 1. ; for ( int i = 0 ; i < dimension ; i ++) { double * ev = ( double *) Lambda ; ev [ i ] = T / 2 + s * sqrt ( sq ( T )/ 4. - D ); s *= - 1 ; double * Rx = ( double *) & R -> x ; double * Ry = ( double *) & R -> y ; Ry [ i ] += ev [ i ]; double mod = sqrt ( sq ( Rx [ i ]) + sq ( Ry [ i ])); Rx [ i ] /= mod ; Ry [ i ] /= mod ; } } The stress tensor depends on previous instants and has to be integrated in time. In the log-conformation scheme the advection of the stress tensor is circumvented, instead the conformation tensor, \\(\\mathbf{A}\\) (or more precisely the related variable \\(\\Psi\\) ) is advanced in time. In what follows we will adopt a scheme similar to that of Hao & Pan (2007) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: We use a...",
    "content": "We use a split scheme, solving successively the upper convective term: \\[ \\partial_t \\Psi = 2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega) \\] the advection term: \\[ \\partial_t \\Psi + \\nabla \\cdot (\\Psi \\mathbf{u}) = 0 \\] the model term (but set in terms of the conformation tensor \\(\\mathbf{A}\\) ).",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: In an Oldroyd-B...",
    "content": "In an Oldroyd-B viscoelastic fluid, the model is \\[ \\partial_t \\mathbf{A} = -\\frac{\\mathbf{f}_r (\\mathbf{A})}{\\lambda} \\] event tracer_advection ( i ++) { scalar Psi11 = A11 ; scalar Psi12 = A12 ; scalar Psi22 = A22 ; #if AXI scalar Psiqq = AThTh ; #endif Computation of \\(\\Psi = \\log \\mathbf{A}\\) and upper convective term foreach () { We assume that the stress tensor \\(\\mathbf{\\tau}_p\\) depends on the conformation tensor \\(\\mathbf{A}\\) as follows \\[ \\mathbf{\\tau}_p = G_p (\\mathbf{A}) = G_p (\\mathbf{A} - I) \\] pseudo_t A ; A . x . x = A11 []; A . y . y = A22 []; A . x . y = A12 []; #if AXI double Aqq = AThTh []; Psiqq [] = log ( Aqq ); #endif The conformation tensor is diagonalized through the eigenvector tensor \\(\\mathbf{R}\\) and the eigenvalues diagonal tensor, \\(\\Lambda\\) . pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); pseudo_t R ; init_pseudo_t (& R , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); /* Check for negative eigenvalues -- this should never happen.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: If it does,...",
    "content": "If it does, print the location and value of the offending eigenvalue. Please report this bug by opening an issue on the GitHub repository. */ if ( Lambda . x <= 0. || Lambda . y <= 0. ) { fprintf ( ferr , \"Negative eigenvalue detected: Lambda.x = %g , Lambda.y = %g\\n \" , Lambda . x , Lambda . y ); fprintf ( ferr , \"x = %g , y = %g\\n \" , x , y ); exit ( 1 ); } \\(\\Psi = \\log \\mathbf{A}\\) is easily obtained after diagonalization, \\(\\Psi = R \\cdot \\log(\\Lambda) \\cdot R^T\\) . Psi12 [] = R . x . x * R . y . x * log ( Lambda . x ) + R . y . y * R . x . y * log ( Lambda . y ); Psi11 [] = sq ( R . x . x )* log ( Lambda . x ) + sq ( R . x . y )* log ( Lambda . y ); Psi22 [] = sq ( R . y . y )* log ( Lambda . y ) + sq ( R . y . x )* log ( Lambda . x ); We now compute the upper convective term \\(2 \\mathbf{B} + (\\Omega \\cdot \\Psi -\\Psi \\cdot \\Omega)\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: The diagonalization will...",
    "content": "The diagonalization will be applied to the velocity gradient \\((\\nabla u)^T\\) to obtain the antisymmetric tensor \\(\\Omega\\) and the traceless, symmetric tensor, \\(\\mathbf{B}\\) . If the conformation tensor is \\(\\mathbf{I}\\) , \\(\\Omega = 0\\) and \\(\\mathbf{B}= \\mathbf{D}\\) . Otherwise, compute M = R * (nablaU)^T * R^T, where nablaU is the velocity gradient tensor. Then, Calculate omega using the off-diagonal elements of M and eigenvalues: omega = (Lambda.y M.x.y + Lambda.x M.y.x)/(Lambda.y - Lambda.x) This represents the rotation rate in the eigenvector basis. Transform omega back to physical space to get OM: OM = (R.x.x R.y.y - R.x.y R.y.x)*omega This gives us the rotation tensor Omega in the original coordinate system.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Compute B tensor...",
    "content": "Compute B tensor components using M and R: B is related to M and R through: In 2D: \\[ B_{xx} = R_{xx}^2 M_{xx} + R_{xy}^2 M_{yy} \\\\ B_{xy} = R_{xx}R_{yx} M_{xx} + R_{xy}R_{yy} M_{yy} \\\\ B_{yx} = B_{xy} \\\\ B_{yy} = -B_{xx} \\] Where: R is the eigenvector matrix of the conformation tensor M is the velocity gradient tensor in the eigenvector basis The construction ensures B is symmetric and traceless pseudo_t B ; init_pseudo_t (& B , 0.0 ); double OM = 0. ; if ( fabs ( Lambda . x - Lambda . y ) <= 1e-20 ) { B . x . y = ( u . y [ 1 , 0 ] - u . y [- 1 , 0 ] + u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ])/( 4. * Delta ); foreach_dimension () B . x . x = ( u . x [ 1 , 0 ] - u . x [- 1 , 0 ])/( 2. * Delta ); } else { pseudo_t M ; init_pseudo_t (& M , 0.0 ); foreach_dimension () { M . x . x = ( sq ( R . x . x )*( u . x [ 1 ] - u . x [- 1 ]) + sq ( R . y . x )*( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]) + R . x . x * R . y . x *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ] + u . y [ 1 ] - u . y [- 1 ]))/( 2. * Delta ); M . x . y = ( R . x . x * R . x . y *( u . x [ 1 ] - u . x [- 1 ]) + R . x . y * R . y . x *( u . y [ 1 ] - u . y [- 1 ]) + R . x . x * R . y . y *( u . x [ 0 , 1 ] - u . x [ 0 ,- 1 ]) + R . y . x * R . y . y *( u . y [ 0 , 1 ] - u . y [ 0 ,- 1 ]))/( 2. * Delta ); } double omega = ( Lambda . y * M . x . y + Lambda . x * M . y . x )/( Lambda . y - Lambda . x ); OM = ( R . x . x * R . y . y - R . x . y * R . y . x )* omega ; B . x . y = M . x . x * R . x . x * R . y . x + M . y . y * R . y . y * R . x . y ; foreach_dimension () B . x . x = M . x . x * sq ( R . x . x )+ M . y . y * sq ( R . x . y ); } We now advance \\(\\Psi\\) in time, adding the upper convective contribution. double s = - Psi12 []; Psi12 [] += dt * ( 2. * B . x . y + OM * ( Psi22 [] - Psi11 [])); s *= - 1 ; Psi11 [] += dt * 2. * ( B . x . x + s * OM ); s *= - 1 ; Psi22 [] += dt * 2. * ( B . y . y + s * OM ); In the axisymmetric case, the governing equation for \\(\\Psi_{\\theta \\theta}\\) only involves that component, \\[ \\Psi_{\\theta \\theta}|_t - 2 L_{\\theta \\theta} = \\frac{\\mathbf{f}_r(e^{-\\Psi_{\\theta \\theta}})}{\\lambda} \\] with \\(L_{\\theta \\theta} = u_y/y\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Therefore step (a)...",
    "content": "Therefore step (a) for \\(\\Psi_{\\theta \\theta}\\) is #if AXI Psiqq [] += dt * 2. * u . y []/ max ( y , 1e-20 ); #endif } Advection of \\(\\Psi\\) We proceed with step (b), the advection of the log of the conformation tensor \\(\\Psi\\) . #if AXI advection ({ Psi11 , Psi12 , Psi22 , Psiqq }, uf , dt ); #else advection ({ Psi11 , Psi12 , Psi22 }, uf , dt ); #endif Convert back to Aij foreach () { It is time to undo the log-conformation, again by diagonalization, to recover the conformation tensor \\(\\mathbf{A}\\) and to perform step (c). pseudo_t A = {{ Psi11 [], Psi12 []}, { Psi12 [], Psi22 []}}, R ; init_pseudo_t (& R , 0.0 ); pseudo_v Lambda ; init_pseudo_v (& Lambda , 0.0 ); diagonalization_2D (& Lambda , & R , & A ); Lambda . x = exp ( Lambda . x ), Lambda . y = exp ( Lambda . y ); A . x . y = R . x . x * R . y . x * Lambda . x + R . y . y * R . x . y * Lambda . y ; foreach_dimension () A . x . x = sq ( R . x . x )* Lambda . x + sq ( R . x . y )* Lambda . y ; #if AXI double Aqq = exp ( Psiqq []); #endif We perform now step (c) by integrating \\(\\mathbf{A}_t = -\\mathbf{f}_r (\\mathbf{A})/\\lambda\\) to obtain \\(\\mathbf{A}^{n+1}\\) .",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: This step is...",
    "content": "This step is analytic, \\[ \\int_{t^n}^{t^{n+1}}\\frac{d \\mathbf{A}}{\\mathbf{I}- \\mathbf{A}} = \\frac{\\Delta t}{\\lambda} \\] double intFactor = ( lambda [] != 0. ? ( lambda [] == 1e30 ? 1 : exp (- dt / lambda [])): 0. ); #if AXI Aqq = ( 1. - intFactor ) + intFactor * exp ( Psiqq []); #endif A . x . y *= intFactor ; foreach_dimension () A . x . x = ( 1. - intFactor ) + A . x . x * intFactor ; Then the Conformation tensor \\(\\mathcal{A}_p^{n+1}\\) is restored from \\(\\mathbf{A}^{n+1}\\) . A12 [] = A . x . y ; T12 [] = Gp []* A . x . y ; #if AXI AThTh [] = Aqq ; T_ThTh [] = Gp []*( Aqq - 1. ); #endif A11 [] = A . x . x ; T11 [] = Gp []*( A . x . x - 1. ); A22 [] = A . y . y ; T22 [] = Gp []*( A . y . y - 1. ); } } Divergence of the viscoelastic stress tensor The viscoelastic stress tensor \\(\\mathbf{\\tau}_p\\) is defined at cell centers while the corresponding force (acceleration) will be defined at cell faces. Two terms contribute to each component of the momentum equation.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Examples",
    "content": "For example the \\(x\\) -component in Cartesian coordinates has the following terms: \\(\\partial_x \\mathbf{\\tau}_{p_{xx}} + \\partial_y \\mathbf{\\tau}_{p_{xy}}\\) . The first term is easy to compute since it can be calculated directly from center values of cells sharing the face. The other one is harder. It will be computed from vertex values. The vertex values are obtained by averaging centered values.",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology: Results",
    "content": "Note that as a result of the vertex averaging cells [] and [-1,0] are not involved in the computation of shear. event acceleration ( i ++) { face vector av = a ; foreach_face ( x ){ if ( fm . x [] > 1e-20 ) { double shearX = ( T12 [ 0 , 1 ]* cm [ 0 , 1 ] + T12 [- 1 , 1 ]* cm [- 1 , 1 ] - T12 [ 0 ,- 1 ]* cm [ 0 ,- 1 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . x [] += ( shearX + cm []* T11 [] - cm [- 1 ]* T11 [- 1 ])* alpha . x []/( sq ( fm . x [])* Delta ); } } foreach_face ( y ){ if ( fm . y [] > 1e-20 ) { double shearY = ( T12 [ 1 , 0 ]* cm [ 1 , 0 ] + T12 [ 1 ,- 1 ]* cm [ 1 ,- 1 ] - T12 [- 1 , 0 ]* cm [- 1 , 0 ] - T12 [- 1 ,- 1 ]* cm [- 1 ,- 1 ])/ 4. ; av . y [] += ( shearY + cm []* T22 [] - cm [ 0 ,- 1 ]* T22 [ 0 ,- 1 ])* alpha . y []/( sq ( fm . y [])* Delta ); } } #if AXI foreach_face ( y ) if ( y > 1e-20 ) av . y [] -= ( T_ThTh [] + T_ThTh [ 0 ,- 1 ])* alpha . y []/ sq ( y )/ 2. ; #endif }",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - C/C++ Code: C/C++ Code",
    "content": "#include\"bcg.h\"(const)scalar Gp=unity;// elastic modulus(const)scalar lambda=unity;// relaxation timescalar A11[],A12[],A22[];// conformation tensorscalar T11[],T12[],T22[];// stress tensor#if AXIscalar AThTh[],T_ThTh[];#endifevent defaults(i=0){if(is_constant(a.x))a=new face vector;/*initialize A and T*/for(scalar s in{A11,A22}){foreach(){s[]=1.;}}for(scalar s in{T11,T12,T22,A12}){foreach(){s[]=0.;}}#if AXIforeach(){T_ThTh[]=0;AThTh[]=1.;}#endiffor(scalar s in{T11,T12,T22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}for(scalar s in{A11,A12,A22}){if(s.boundary[left]!=periodic_bc){s[left]=neumann(0);s[right]=neumann(0);}}#if AXIT12[bottom]=dirichlet(0.);A12[bottom]=dirichlet(0.);#endif}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "typedefstruct{doublex,y;}pseudo_v;typedefstruct{pseudo_v x,y;}pseudo_t;// Function to initialize pseudo_vstaticinlinevoidinit_pseudo_v(pseudo_v*v,doublevalue){v->x=value;v->y=value;}// Function to initialize pseudo_tstaticinlinevoidinit_pseudo_t(pseudo_t*t,doublevalue){init_pseudo_v(&t->x,value);init_pseudo_v(&t->y,value);}staticvoiddiagonalization_2D(pseudo_v*Lambda,pseudo_t*R,pseudo_t*A){",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "if(sq(A->x.y)<1e-15){R->x.x=R->y.y=1.;R->y.x=R->x.y=0.;Lambda->x=A->x.x;Lambda->y=A->y.y;return;}doubleT=A->x.x+A->y.y;// Trace of the tensordoubleD=A->x.x*A->y.y-sq(A->x.y);// Determinant",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "R->x.x=R->x.y=A->x.y;R->y.x=R->y.y=-A->x.x;doubles=1.;for(inti=0;i<dimension;i++){double*ev=(double*)Lambda;ev[i]=T/2+s*sqrt(sq(T)/4.-D);s*=-1;double*Rx=(double*)&R->x;double*Ry=(double*)&R->y;Ry[i]+=ev[i];doublemod=sqrt(sq(Rx[i])+sq(Ry[i]));Rx[i]/=mod;Ry[i]/=mod;}}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "event tracer_advection(i++){scalar Psi11=A11;scalar Psi12=A12;scalar Psi22=A22;#if AXIscalar Psiqq=AThTh;#endif",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "pseudo_t A;A.x.x=A11[];A.y.y=A22[];A.x.y=A12[];#if AXIdoubleAqq=AThTh[];Psiqq[]=log(Aqq);#endif",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);pseudo_t R;init_pseudo_t(&R,0.0);diagonalization_2D(&Lambda,&R,&A);/*Check for negative eigenvalues -- this should never happen. If it does, print the location and value of the offending eigenvalue.Please report this bug by opening an issue on the GitHub repository.*/if(Lambda.x<=0.||Lambda.y<=0.){fprintf(ferr,\"Negative eigenvalue detected: Lambda.x =%g, Lambda.y =%g\\n\",Lambda.x,Lambda.y);fprintf(ferr,\"x =%g, y =%g\\n\",x,y);exit(1);}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "Psi12[]=R.x.x*R.y.x*log(Lambda.x)+R.y.y*R.x.y*log(Lambda.y);Psi11[]=sq(R.x.x)*log(Lambda.x)+sq(R.x.y)*log(Lambda.y);Psi22[]=sq(R.y.y)*log(Lambda.y)+sq(R.y.x)*log(Lambda.x);",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: Context",
    "content": "pseudo_t B;init_pseudo_t(&B,0.0);doubleOM=0.;if(fabs(Lambda.x-Lambda.y)<=1e-20){B.x.y=(u.y[1,0]-u.y[-1,0]+u.x[0,1]-u.x[0,-1])/(4.*Delta);foreach_dimension()B.x.x=(u.x[1,0]-u.x[-1,0])/(2.*Delta);}else{pseudo_t M;init_pseudo_t(&M,0.0);foreach_dimension(){M.x.x=(sq(R.x.x)*(u.x[1]-u.x[-1])+sq(R.y.x)*(u.y[0,1]-u.y[0,-1])+R.x.x*R.y.x*(u.x[0,1]-u.x[0,-1]+u.y[1]-u.y[-1]))/(2.*Delta);M.x.y=(R.x.x*R.x.y*(u.x[1]-u.x[-1])+R.x.y*R.y.x*(u.y[1]-u.y[-1])+R.x.x*R.y.y*(u.x[0,1]-u.x[0,-1])+R.y.x*R.y.y*(u.y[0,1]-u.y[0,-1]))/(2.*Delta);}doubleomega=(Lambda.y*M.x.y+Lambda.x*M.y.x)/(Lambda.y-Lambda.x);OM=(R.x.x*R.y.y-R.x.y*R.y.x)*omega;B.x.y=M.x.x*R.x.x*R.y.x+M.y.y*R.y.y*R.x.y;foreach_dimension()B.x.x=M.x.x*sq(R.x.x)+M.y.y*sq(R.x.y);}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "doubles=-Psi12[];Psi12[]+=dt*(2.*B.x.y+OM*(Psi22[]-Psi11[]));s*=-1;Psi11[]+=dt*2.*(B.x.x+s*OM);s*=-1;Psi22[]+=dt*2.*(B.y.y+s*OM);",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "#if AXIadvection({Psi11,Psi12,Psi22,Psiqq},uf,dt);#elseadvection({Psi11,Psi12,Psi22},uf,dt);#endif",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "pseudo_t A={{Psi11[],Psi12[]},{Psi12[],Psi22[]}},R;init_pseudo_t(&R,0.0);pseudo_v Lambda;init_pseudo_v(&Lambda,0.0);diagonalization_2D(&Lambda,&R,&A);Lambda.x=exp(Lambda.x),Lambda.y=exp(Lambda.y);A.x.y=R.x.x*R.y.x*Lambda.x+R.y.y*R.x.y*Lambda.y;foreach_dimension()A.x.x=sq(R.x.x)*Lambda.x+sq(R.x.y)*Lambda.y;#if AXIdoubleAqq=exp(Psiqq[]);#endif",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "doubleintFactor=(lambda[]!=0.?(lambda[]==1e30?1:exp(-dt/lambda[])):0.);#if AXIAqq=(1.-intFactor)+intFactor*exp(Psiqq[]);#endifA.x.y*=intFactor;foreach_dimension()A.x.x=(1.-intFactor)+A.x.x*intFactor;",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example",
    "content": "A12[]=A.x.y;T12[]=Gp[]*A.x.y;#if AXIAThTh[]=Aqq;T_ThTh[]=Gp[]*(Aqq-1.);#endifA11[]=A.x.x;T11[]=Gp[]*(A.x.x-1.);A22[]=A.y.y;T22[]=Gp[]*(A.y.y-1.);}}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/log-conform-viscoelastic-scalar-2D.h | FIBER: Flow-Induced Breakup of Elastic Rheology - Code Example: event acceleration(i++){face vector...",
    "content": "event acceleration(i++){face vector av=a;foreach_face(x){if(fm.x[]>1e-20){doubleshearX=(T12[0,1]*cm[0,1]+T12[-1,1]*cm[-1,1]-T12[0,-1]*cm[0,-1]-T12[-1,-1]*cm[-1,-1])/4.;av.x[]+=(shearX+cm[]*T11[]-cm[-1]*T11[-1])*alpha.x[]/(sq(fm.x[])*Delta);}}foreach_face(y){if(fm.y[]>1e-20){doubleshearY=(T12[1,0]*cm[1,0]+T12[1,-1]*cm[1,-1]-T12[-1,0]*cm[-1,0]-T12[-1,-1]*cm[-1,-1])/4.;av.y[]+=(shearY+cm[]*T22[]-cm[0,-1]*T22[0,-1])*alpha.y[]/(sq(fm.y[])*Delta);}}#if AXIforeach_face(y)if(y>1e-20)av.y[]-=(T_ThTh[]+T_ThTh[0,-1])*alpha.y[]/sq(y)/2.;#endif}",
    "url": "https://comphy-lab.org/fiber/src-local/log-conform-viscoelastic-scalar-2D.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Jumping Bubbles: Context",
    "content": "reset_install_requirements.sh See raw file reset_install_requirements.sh #!/bin/zsh # tested on MacOS only.",
    "url": "https://comphy-lab.org/JumpingBubbles/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Jumping Bubbles: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue. # modify using http://basilisk.fr/src/INSTALL # ensures that we are always using the latest version of basilisk # Check if --hard flag is passed HARD_RESET = \\f alse if [[ \" \\$ 1\" == \"--hard\" ]]; then HARD_RESET = \\t rue fi # Function to install basilisk install_basilisk() { darcs clone http://basilisk.fr/basilisk cd basilisk/src if [[ \" \\$ OSTYPE\" == \"darwin\" * ]]; then echo \"Using MacOS\" ln -s config.osx config else echo \"Using Linux\" ln -s config.gcc config fi make } # Remove project config always rm -rf .project_config # Check if basilisk needs to be installed if [[ \" \\$ HARD_RESET\" == true ]] || [[ ! -d \"basilisk\" ]]; then echo \"Installing basilisk...\" rm -rf basilisk install_basilisk else echo \"Using existing basilisk installation...\" cd basilisk/src fi # Setup environment variables echo \"export BASILISK= \\$ PWD\" >> ../../.project_config echo \"export PATH= \\\\ $PATH : \\\\ $BASILISK \" >> ../../.project_config source ../../.project_config # Check if qcc is working properly echo \"\\nChecking qcc installation...\" if ! qcc --version > /dev/null 2 >& 1 ; then echo \"\\033[0;31mError: qcc is not working properly.\\033[0m\" echo \"Please ensure you have Xcode Command Line Tools installed.\" echo \"You can install them by running: xcode-select --install\" echo \"For more details, visit: http://basilisk.fr/src/INSTALL\" exit 1 else echo \"\\033[0;32mqcc is properly installed.\\033[0m\" qcc --version fi",
    "url": "https://comphy-lab.org/JumpingBubbles/reset_install_requirements.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Jumping Bubbles - Code Example: #!/bin/zsh# tested on...",
    "content": "#!/bin/zsh# tested on MacOS only.",
    "url": "https://comphy-lab.org/JumpingBubbles/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "reset_install_requirements.sh | Jumping Bubbles - Code Example: Let us know...",
    "content": "Let us know if you find issues running with Linux by opening an issue.# modify using http://basilisk.fr/src/INSTALL# ensures that we are always using the latest version of basilisk# Check if --hard flag is passedHARD_RESET=\\falseif[[\"\\$1\"==\"--hard\"]];thenHARD_RESET=\\truefi# Function to install basiliskinstall_basilisk(){darcsclone http://basilisk.fr/basiliskcdbasilisk/srcif[[\"\\$OSTYPE\"==\"darwin\"*]];thenecho\"Using MacOS\"ln-sconfig.osx configelseecho\"Using Linux\"ln-sconfig.gcc configfimake}# Remove project config alwaysrm-rf.project_config# Check if basilisk needs to be installedif[[\"\\$HARD_RESET\"==true]]||[[!-d\"basilisk\"]];thenecho\"Installing basilisk...\"rm-rfbasiliskinstall_basiliskelseecho\"Using existing basilisk installation...\"cdbasilisk/srcfi# Setup environment variablesecho\"export BASILISK=\\$PWD\">>../../.project_configecho\"export PATH=\\\\$PATH:\\\\$BASILISK\">>../../.project_configsource../../.project_config# Check if qcc is working properlyecho\"\\nChecking qcc installation...\"if!qcc--version>/dev/null2>&1;thenecho\"\\033[0;31mError: qcc is not working properly.\\033[0m\"echo\"Please ensure you have Xcode Command Line Tools installed.\"echo\"You can install them by running: xcode-select --install\"echo\"For more details, visit: http://basilisk.fr/src/INSTALL\"exit1elseecho\"\\033[0;32mqcc is properly installed.\\033[0m\"qcc--versionfi",
    "url": "https://comphy-lab.org/JumpingBubbles/reset_install_requirements.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles: Jumping Bubbles A...",
    "content": "Jumping Bubbles A high-performance computational framework for studying bubble coalescence and jumping phenomena on substrates using Basilisk C . This repository provides a complete suite of simulation tools, post-processing utilities, and validated test cases for investigating two-phase free-surface flows with adaptive mesh refinement. Key Features Advanced Two-Phase Flow Modeling Volume of Fluid (VOF) method for sharp interface tracking Conservative momentum advection coupled with VOF field Accurate surface tension implementation using the Brackbill method Reduced gravity approach for specific physical scenarios. This keeps the system of equations well-balanced.",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles: High-Performance Computing Adaptive...",
    "content": "High-Performance Computing Adaptive octree mesh refinement based on multiple criteria: Interface fraction gradients Local curvature Velocity field variations Parallel computation support: OpenMP for shared-memory systems MPI for distributed computing (HPC clusters) Comprehensive Analysis Tools Real-time monitoring of physical quantities Advanced post-processing capabilities: 2D/3D visualization scripts Interface reconstruction Energy and momentum analysis Trajectory tracking Project Structure basilisk/src/ - # Core Basilisk C framework navier-stokes/ - # Flow solvers centered.h - # Main centered NS solver conserving.h - # Conservative form solver two-phase*.h - # Two-phase flow implementations vof.h - # Volume of Fluid method curvature.h - # Interface property calculations tension.h - # Surface tension (Brackbill) integral.h - # Surface tension integral form viscosity.h - # Implicit viscous stress solver axi.h - # Axisymmetric computations src-local/ - # Project-specific modifications postProcess/ - # Analysis and visualization Video2DSlice.py - # 2D slice animations Video3D.py - # 3D visualization Visualization3D.ipynb - # Interactive 3D notebook getFacets3D.c - # Interface extraction simulationCases/ - # Validation cases JumpingBubbles.c - # Standard test case JumpingBubbles-hydrophilic.c - # Hydrophilic substrate runCases*.sh - # Execution scripts Installation Prerequisites GCC compiler (version 7.0+) MPI implementation (OpenMPI or MPICH) Python 3.7+ (for post-processing) Required Python packages: numpy, matplotlib, scipy Xcode Command Line Tools (for MacOS users) Setting up Basilisk Clone this repository: git clone https://github.com/comphy-lab/JumpingBubbles.git cd JumpingBubbles Run the installation script: ./reset_install_requirements.sh This script will: Install Basilisk if not present (use --hard flag for fresh installation) Configure the environment automatically Create .project_config with required paths Verify the installation Verify installation: source .project_config qcc --version Usage Running Simulations Local Development (OpenMP) # Compile qcc -O2 -Wall -disable-dimensions -fopenmp -I $( PWD ) /src-local testCases/JumpingBubbles.c -o JumpingBubbles -lm # Run with 4 threads export OMP_NUM_THREADS = 4 ./JumpingBubbles HPC Deployment (MPI) Generate initial condition locally first Compile with MPI support: CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions \\ -I $( PWD ) /src-local testCases/JumpingBubbles.c -o JumpingBubbles -lm Use provided Slurm script: testCases/runSnellius.sbatch Post-Processing Visualization 2D Slice Videos: python postProcess/Video2DSlice.py < simulation_directory > 3D Visualization: python postProcess/Video3D.py < simulation_directory > Interactive Analysis: Open postProcess/Visualization3D.ipynb in Jupyter Data Analysis Use getFacets3D.c to extract interface geometry Various slice extraction tools available in postProcess/ Contributing We welcome contributions to improve Jumping Bubbles!",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles: Here\u2019s how you...",
    "content": "Here\u2019s how you can help: Reporting Issues Click on the \u201cIssues\u201d tab above or use these quick links: - Report a Bug - Request a Feature - Ask a Question - Open a Blank Issue Making Changes Fork the repository Create a feature branch ( git checkout -b feature/AmazingFeature ) Make your changes Run tests and ensure they pass Update documentation if needed Commit your changes ( git commit -m 'Add some AmazingFeature' ) Push to the branch ( git push origin feature/AmazingFeature ) Open a Pull Request Please ensure your PR: - Clearly describes the changes - Includes any relevant tests - Updates documentation as needed - References any related issues License This project is licensed under the GNU General Public License v3.0 - see the LICENSE file for details.",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles: Citation If you...",
    "content": "Citation If you use this code in your research, please cite: @software{jumping_bubbles_2024, author = {Sanjay, V. and Yang, R.}, title = {Jumping Bubbles: A Computational Framework for Studying Bubble Coalescence}, year = {2025}, publisher = {Zenodo}, version = {v2.0}, doi = {10.5281/zenodo.14602623}, url = {https://comphy-lab.org/JumpingBubbles/} } Acknowledgments Based on the Basilisk C framework. Generated Documentation Root Directory reset_install_requirements.sh postProcess postProcess/Video2DSlice.py postProcess/Video3D.py postProcess/Visulization3D.ipynb postProcess/getCells_bottomPlate.c postProcess/getDataXSlice.c postProcess/getDataZSlice.c postProcess/getFacets3D.c simulationCases simulationCases/DataFile/retrieveDataFile.sh simulationCases/JumpingBubbles-hydrophilic.c simulationCases/JumpingBubbles.c simulationCases/Makefile simulationCases/runCasesOpenMP.sh simulationCases/runCasesOpenMPI.sh src-local src-local/contact-fixed.h",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "gitclone https://github.com/comphy-lab/JumpingBubbles.gitcdJumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "# Compileqcc-O2-Wall-disable-dimensions-fopenmp-I$(PWD)/src-local testCases/JumpingBubbles.c-oJumpingBubbles-lm# Run with 4 threadsexportOMP_NUM_THREADS=4./JumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "CC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensions\\-I$(PWD)/src-local testCases/JumpingBubbles.c-oJumpingBubbles-lm",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "pythonpostProcess/Video2DSlice.py<simulation_directory>",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "pythonpostProcess/Video3D.py<simulation_directory>",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Jumping Bubbles | Jumping Bubbles - Code Example",
    "content": "@software{jumping_bubbles_2024,author       = {Sanjay, V. and Yang, R.},title        = {Jumping Bubbles: A Computational Framework for Studying Bubble Coalescence},year         = {2025},publisher    = {Zenodo},version      = {v2.0},doi          = {10.5281/zenodo.14602623},url          = {https://comphy-lab.org/JumpingBubbles/}}",
    "url": "https://comphy-lab.org/JumpingBubbles/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getCells_bottomPlate.c This program extracts and visualizes boundary data from Basilisk C simulation files, specifically designed for analyz... getDataXSlice.c This program extracts and interpolates flow field data from Basilisk/Gerris dump files, focusing on velocity fields a... getDataZSlice.c This program performs spatial interpolation of fluid dynamics simulation data from Basilisk dump files. It extracts v... getFacets3D.c This module provides functionality for extracting and outputting interface facets from volume fraction fields in comp... Video2DSlice.py Fluid Dynamics Visualization for Basilisk C Simulations This script processes Basilisk C simulation output data to ge... Video3D.py Basilisk C Snapshot Visualization Script This script processes Basilisk C simulation output files to generate 3D visu... Visulization3D.ipynb This notebook provides visualization and analysis related to Visulization3D.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles: Context",
    "content": "postProcess/getFacets3D.c See raw file Facet Output Visualization Tool This module provides functionality for extracting and outputting interface facets from volume fraction fields in computational fluid dynamics simulations. It is designed to work with the Basilisk C framework for solving partial differential equations on adaptive octree/quadtree grids. Overview The tool reads volume fraction data from saved simulation files and extracts the interface geometry using facet reconstruction algorithms. The extracted facets can be visualized or processed for further analysis of multiphase flow interfaces.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles: C/C++ Code",
    "content": "Authors Vatsal Sanjay (vatsalsanjay@gmail.com) Physics of Fluids Group Dependencies Basilisk C framework Octree grid implementation Navier-Stokes centered solver Volume fraction utilities #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" #include \"fractions.h\" scalar f []; char filename [ 80 ]; output_facets_v2 Extracts and outputs the facets (interface segments/polygons) from a volume fraction field. This function implements a marching squares/cubes-like algorithm to reconstruct interfaces from volume fraction data. The function iterates through all grid cells and identifies those containing an interface (where the volume fraction is between 0 and 1). For each interface cell, it: 1. Computes the interface normal using neighboring cell data 2. Calculates the plane constant \u03b1 for the linear interface approximation 3. Extracts the intersection points between the interface and cell edges 4.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles: Outputs the facet...",
    "content": "Outputs the facet vertices to the specified file Parameters c : Volume fraction scalar field containing the interface data fp : Output file pointer for writing facet coordinates (default: stdout) s : Face vector field for surface tension calculations (default: {{-1}}) Output Format The output format depends on the spatial dimension: - 1D : Single x-coordinate of the interface position - 2D : Line segments as pairs of (x,y) coordinates, blank line separated - 3D : Polygon vertices as (x,y,z) coordinates, blank line separated Implementation Notes Only processes cells with volume fraction in range (1e-6, 1-1e-6) to avoid numerical issues near pure phases Uses the PLIC (Piecewise Linear Interface Calculation) method for interface reconstruction Facet extraction tolerance is set to 1.1 for robust polygon generation in 3D cases trace void output_facets_v2 ( scalar c , FILE * fp = stdout , face vector s = {{- 1 }}) { foreach () if ( c [] > 1e-6 && c [] < 1. - 1e-6 ) { coord n = facet_normal ( point , c , s ); double alpha = plane_alpha ( c [], n ); #if dimension == fprintf ( fp , \" %g\\n \" , x + Delta * alpha / n . x ); #elif dimension == coord segment [ 2 ]; if ( facets ( n , alpha , segment ) == 2 ) fprintf ( fp , \" %g %g\\n%g %g\\n\\n \" , x + segment [ 0 ]. x * Delta , y + segment [ 0 ]. y * Delta , x + segment [ 1 ]. x * Delta , y + segment [ 1 ]. y * Delta ); #else // dimension == coord v [ 12 ]; int m = facets ( n , alpha , v , 1.1 ); for ( int i = 0 ; i < m ; i ++) fprintf ( fp , \" %g %g %g\\n \" , x + v [ i ]. x * Delta , y + v [ i ]. y * Delta , z + v [ i ]. z * Delta ); if ( m > 0 ) fputc ( ' \\n ' , fp ); #endif } fflush ( fp ); } main Entry point for the facet extraction tool.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles: Processes a saved...",
    "content": "Processes a saved simulation file specified as a command-line argument and outputs the extracted facets to standard error. Command Line Usage ./program_name simulation_file.dump Parameters a : Number of command line arguments arguments : Array of command line argument strings arguments[1] : Path to the input simulation file Processing Steps Reads the filename from command line arguments Sets boundary conditions for the volume fraction field Restores the simulation state from the saved file Ensures proper prolongation operators for adaptive mesh refinement Calls output_facets_v2 to extract and output interface facets Boundary Conditions Bottom boundary: Dirichlet condition with f = 1 (fully filled) Tree Grid Handling For adaptive (tree) grids, the function ensures that the volume fraction field uses the appropriate fraction_refine prolongation operator. This is crucial for maintaining conservation properties during mesh refinement and coarsening operations.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles: C/C++ Main",
    "content": "Output Interface facets are written to standard error (ferr) in a format suitable for visualization with tools like gnuplot or paraview. int main ( int a , char const * arguments []) { sprintf ( filename , \" %s \" , arguments [ 1 ]); f [ bottom ] = dirichlet ( 1. ); restore ( file = filename ); #if TREE // Ensure proper prolongation for volume fraction fields on adaptive grids void (* prolongation )( Point , scalar ) = f . prolongation ; if ( prolongation != fraction_refine ) { f . prolongation = fraction_refine ; f . dirty = true ; } #endif // TREE output_facets_v2 ( f , ferr ); }",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles - C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"#include\"fractions.h\"scalar f[];charfilename[80];",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles - Code Example: tracevoidoutput_facets_v2(scalar c,FILE*fp=stdout,face vector...",
    "content": "tracevoidoutput_facets_v2(scalar c,FILE*fp=stdout,face vector s={{-1}}){foreach()if(c[]>1e-6&&c[]<1.-1e-6){coord n=facet_normal(point,c,s);doublealpha=plane_alpha(c[],n);#if dimension ==fprintf(fp,\"%g\\n\",x+Delta*alpha/n.x);#elif dimension ==coord segment[2];if(facets(n,alpha,segment)==2)fprintf(fp,\"%g%g\\n%g%g\\n\\n\",x+segment[0].x*Delta,y+segment[0].y*Delta,x+segment[1].x*Delta,y+segment[1].y*Delta);#else// dimension ==coord v[12];intm=facets(n,alpha,v,1.1);for(inti=0;i<m;i++)fprintf(fp,\"%g%g%g\\n\",x+v[i].x*Delta,y+v[i].y*Delta,z+v[i].z*Delta);if(m>0)fputc('\\n',fp);#endif}fflush(fp);}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFacets3D.c | Jumping Bubbles - Code Example",
    "content": "intmain(inta,charconst*arguments[]){sprintf(filename,\"%s\",arguments[1]);f[bottom]=dirichlet(1.);restore(file=filename);#if TREE// Ensure proper prolongation for volume fraction fields on adaptive gridsvoid(*prolongation)(Point,scalar)=f.prolongation;if(prolongation!=fraction_refine){f.prolongation=fraction_refine;f.dirty=true;}#endif// TREEoutput_facets_v2(f,ferr);}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getFacets3D.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: Context",
    "content": "postProcess/getDataZSlice.c See raw file Data Interpolation from Dump Files This program performs spatial interpolation of fluid dynamics simulation data from Basilisk dump files. It extracts velocity fields, volume fractions, and viscous dissipation rates from octree-based adaptive mesh refinement (AMR) simulations and interpolates them onto regular grids for post-processing and visualization. Physics Background The code analyzes two-phase flow simulations where: - Phase 1 represents the primary fluid (e.g., a droplet) - Phase 2 represents the surrounding medium (e.g., air) The simulation employs the Volume-of-Fluid (VOF) method with the Navier-Stokes equations to track the interface between phases.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: Key physical parameters...",
    "content": "Key physical parameters include: - Density ratio: \u03c1\u2082/\u03c1\u2081 = 10\u207b\u00b3 - Viscosity ratio: \u03bc\u2082/\u03bc\u2081 = 10\u207b\u00b3 - Ohnesorge number: Oh = \u03bc\u2081/\u221a(\u03c1\u2081\u03c3R) controlling viscous-to-inertial forces Author Information Author: Vatsal Sanjay Email: vatsalsanjay@gmail.com Affiliation: Physics of Fluids #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" #define FILTERED 31 #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include <string.h> Global Variables filename : Path to the input dump file ny , nx : Grid dimensions for regular interpolation ymin , xmin , ymax , xmax : Spatial bounds for interpolation region zSlice : Z-coordinate for 2D slice extraction from 3D data Oh : Ohnesorge number for viscosity scaling linear : Flag for linear vs. adaptive interpolation list : List of scalar fields to interpolate char filename [ 80 ]; int ny , nx ; double ymin , xmin , ymax , xmax , zSlice , Oh ; bool linear ; scalar * list = NULL ; Field Variables vel[] : Velocity magnitude field |u| = \u221a(u\u00b2+v\u00b2+w\u00b2) D2c[] : Logarithm of viscous dissipation rate 2\u03bcD:D scalar vel [], D2c []; Physical Constants Define the density and viscosity ratios between phase 2 (surrounding medium) and phase 1 (primary fluid).",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: These values typical...",
    "content": "These values typical for air-water systems. #define MU21 ( 1.00e-3 ) 68 #define RHO21 ( 1.00e-3 ) 69 70 Main Function Processes command-line arguments and performs the interpolation workflow.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: Command-line Arguments arguments[1]...",
    "content": "Command-line Arguments arguments[1] : Input dump file path arguments[2] : Maximum y-coordinate (ymax) arguments[3] : Maximum x-coordinate (xmax) arguments[4] : Z-slice coordinate for 2D extraction arguments[5] : Number of grid points in x-direction (nx) arguments[6] : Ohnesorge number arguments[7] : Linear interpolation flag (true/false) Workflow Restore simulation state from dump file Set boundary conditions Compute derived fields (velocity magnitude, dissipation) Perform interpolation based on grid resolution Output results to stderr int main ( int a , char const * arguments []) { Boundary Conditions Apply no-slip boundary conditions at the bottom: - Zero tangential velocity: u.t = 0 - Zero radial velocity: u.r = 0 - Full wetting: f = 1 (volume fraction) u . t [ bottom ] = dirichlet ( 0. ); u . r [ bottom ] = dirichlet ( 0. ); f [ bottom ] = dirichlet ( 1. ); File Loading and Initialization Load the simulation state from the specified dump file and ensure proper prolongation operators for the volume fraction field to maintain sharp interfaces during interpolation. sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); f . prolongation = fraction_refine ; boundary ({ f , u . x , u . y , u . z }); Domain Bounds Determination Find the minimum y-coordinate from the back boundary to establish the lower bound of the interpolation domain. ymin = HUGE ; foreach_boundary ( back ) { if ( y < ymin ) ymin = y ; } Parameter Assignment Parse remaining command-line arguments to set interpolation parameters and physical properties. ymax = atof ( arguments [ 2 ]); xmin = 0.0 ; xmax = atof ( arguments [ 3 ]); zSlice = atof ( arguments [ 4 ]); nx = atoi ( arguments [ 5 ]); Oh = atof ( arguments [ 6 ]); linear = ( strcmp ( arguments [ 7 ], \"true\" ) == 0 ); Physical Properties Set density and viscosity values based on the Ohnesorge number and predefined ratios.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: This maintains the...",
    "content": "This maintains the correct non-dimensional groups for the simulation. rho1 = 1.0 ; mu1 = Oh ; rho2 = RHO21 ; mu2 = MU21 * Oh ; Field List Construction Build the list of scalar fields to interpolate: - Volume fraction (f) - Velocity magnitude (vel) - Viscous dissipation (D2c) list = list_add ( list , f ); list = list_add ( list , vel ); list = list_add ( list , D2c ); double delta_min = HUGE ; Derived Field Computation Calculate velocity magnitude and viscous dissipation rate at each grid point.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: The dissipation rate...",
    "content": "The dissipation rate D2c = 2\u03bcD:D represents energy loss due to viscosity, where D is the rate-of-deformation tensor. foreach () { vel [] = sqrt ( sq ( u . x []) + sq ( u . y []) + sq ( u . z [])); Calculate components of the rate-of-deformation tensor D using second-order central differences: - D_ii = \u2202u_i/\u2202x_i (diagonal terms) - D_ij = 0.5(\u2202u_i/\u2202x_j + \u2202u_j/\u2202x_i) (off-diagonal terms) Then compute D:D = \u03a3(D_ij)\u00b2 for viscous dissipation. double D2 = 0. ; foreach_dimension () { double DII = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ]) / ( 2 * Delta ); double DIJ = 0.5 * (( u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ] + u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ]) / ( 2 * Delta )); double DIK = 0.5 * (( u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ] + u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ]) / ( 2 * Delta )); D2 += sq ( DII ) + sq ( DIJ ) + sq ( DIK ); } Store log\u2081\u2080 of viscous dissipation for better visualization of the wide dynamic range. Use -10 as floor value for zero dissipation.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: D2c [] =...",
    "content": "D2c [] = 2 * ( mu ( f [])) * D2 ; if ( D2c [] > 0. ) { D2c [] = log ( D2c []) / log ( 10. ); } else { D2c [] = - 10. ; } delta_min = delta_min > Delta ? Delta : delta_min ; } Interpolation Mode Selection Switch to adaptive interpolation if the requested regular grid spacing exceeds 1/4 of the minimum AMR cell size to avoid undersampling. if (( linear == true ) && ( delta_min < 4 * (( double )(( xmax - xmin ) / ( nx ))))) { linear = false ; } if ( linear == false ) { Adaptive Interpolation Output data at native AMR resolution along the back boundary plane. This preserves the adaptive mesh structure and avoids interpolation artifacts in regions with fine features. FILE * fp = ferr ; foreach_boundary ( back ) { fprintf ( fp , \" %g %g %g %g %g\\n \" , y , x , f [], vel [], D2c []); } } else { Regular Grid Interpolation Interpolate fields onto a uniform Cartesian grid for compatibility with standard visualization tools. The grid spacing is determined by the requested nx points in the x-direction.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: FILE * fp...",
    "content": "FILE * fp = ferr ; double delta_x = ( double )(( xmax - xmin ) / ( nx )); int ny = ( int )(( ymax - ymin ) / delta_x ); double delta_y = ( double )(( ymax - ymin ) / ( ny )); int len = list_len ( list ); double ** field = ( double **) matrix_new ( ny , nx , len * sizeof ( double )); First pass: Interpolate all fields to regular grid points and store in memory to ensure consistent interpolation across all variables. for ( int i = 0 ; i < ny ; i ++) { double y = delta_y * i + ymin ; for ( int j = 0 ; j < nx ; j ++) { double x = delta_x * j + xmin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , x , y , zSlice ); } } } Second pass: Output interpolated data in column format suitable for plotting with gnuplot, matplotlib, or similar tools.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles: Format: y x...",
    "content": "Format: y x f vel D2c for ( int i = 0 ; i < ny ; i ++) { double y = delta_y * i + ymin ; for ( int j = 0 ; j < nx ; j ++) { double x = delta_x * j + xmin ; fprintf ( fp , \" %g %g \" , y , x ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } fflush ( fp ); matrix_free ( field ); } }",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"#define FILTERED31#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include<string.h>",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "charfilename[80];intny,nx;doubleymin,xmin,ymax,xmax,zSlice,Oh;boollinear;scalar*list=NULL;",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "u.t[bottom]=dirichlet(0.);u.r[bottom]=dirichlet(0.);f[bottom]=dirichlet(1.);",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "sprintf(filename,\"%s\",arguments[1]);restore(file=filename);f.prolongation=fraction_refine;boundary({f,u.x,u.y,u.z});",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "ymin=HUGE;foreach_boundary(back){if(y<ymin)ymin=y;}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "ymax=atof(arguments[2]);xmin=0.0;xmax=atof(arguments[3]);zSlice=atof(arguments[4]);nx=atoi(arguments[5]);Oh=atof(arguments[6]);linear=(strcmp(arguments[7],\"true\")==0);",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "list=list_add(list,f);list=list_add(list,vel);list=list_add(list,D2c);doubledelta_min=HUGE;",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "foreach(){vel[]=sqrt(sq(u.x[])+sq(u.y[])+sq(u.z[]));",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "doubleD2=0.;foreach_dimension(){doubleDII=(u.x[1,0,0]-u.x[-1,0,0])/(2*Delta);doubleDIJ=0.5*((u.x[0,1,0]-u.x[0,-1,0]+u.y[1,0,0]-u.y[-1,0,0])/(2*Delta));doubleDIK=0.5*((u.x[0,0,1]-u.x[0,0,-1]+u.z[1,0,0]-u.z[-1,0,0])/(2*Delta));D2+=sq(DII)+sq(DIJ)+sq(DIK);}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "D2c[]=2*(mu(f[]))*D2;if(D2c[]>0.){D2c[]=log(D2c[])/log(10.);}else{D2c[]=-10.;}delta_min=delta_min>Delta?Delta:delta_min;}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "if((linear==true)&&(delta_min<4*((double)((xmax-xmin)/(nx))))){linear=false;}if(linear==false){",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "FILE*fp=ferr;foreach_boundary(back){fprintf(fp,\"%g%g%g%g%g\\n\",y,x,f[],vel[],D2c[]);}}else{",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "FILE*fp=ferr;doubledelta_x=(double)((xmax-xmin)/(nx));intny=(int)((ymax-ymin)/delta_x);doubledelta_y=(double)((ymax-ymin)/(ny));intlen=list_len(list);double**field=(double**)matrix_new(ny,nx,len*sizeof(double));",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "for(inti=0;i<ny;i++){doubley=delta_y*i+ymin;for(intj=0;j<nx;j++){doublex=delta_x*j+xmin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,x,y,zSlice);}}}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataZSlice.c | Jumping Bubbles - Code Example",
    "content": "for(inti=0;i<ny;i++){doubley=delta_y*i+ymin;for(intj=0;j<nx;j++){doublex=delta_x*j+xmin;fprintf(fp,\"%g%g\",y,x);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}fflush(fp);matrix_free(field);}}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataZSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Context",
    "content": "postProcess/Video2DSlice.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Fluid Dynamics Visualization for Basilisk C Simulations This script processes Basilisk C simulation output data to generate high-quality visualizations of fluid dynamics phenomena. It creates contour plots showing velocity magnitude and viscous dissipation rate for both X and Z slices through the computational domain. The script is designed to work with snapshot data from Basilisk simulations, particularly for studying flows with specified Ohnesorge numbers. It uses multiprocessing to efficiently process multiple time steps in parallel.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Examples",
    "content": "Usage: python fluid_visualization.py [\u2013Oh OHNESORGE_NUMBER] Example: python fluid_visualization.py \u2013Oh 0.01 Dependencies: - numpy: For numerical operations - matplotlib: For visualization - concurrent.futures: For parallel execution - multiprocessing: For parallel processing of time steps import numpy as np import os import subprocess as sp import matplotlib import matplotlib.pyplot as plt import matplotlib.patches as patches from matplotlib.ticker import StrMethodFormatter import concurrent.futures import multiprocessing import argparse # =============================== # Matplotlib Configuration # =============================== matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'text.usetex' ] = True # Font sizes for publication-quality figures AXES_LABEL_SIZE = 50 TICK_LABEL_SIZE = 20 # =============================== # Data Processing Functions # =============================== def get_data(exe): Execute external program and parse its output data.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Runs a Basilisk...",
    "content": "Runs a Basilisk utility program (getDataXSlice or getDataZSlice) to extract simulation data along a specified plane. The utility outputs data to stderr in a space-separated format which is then parsed into a numpy array. Args: exe (list): Command and arguments to execute, e.g., [\u201c./getDataXSlice\u201d, filename, ymax, xmax, \u2026] Returns: numpy.ndarray: Transposed data array with shape (5, n_points) containing: [y_coords, x_coords, volume_fraction, velocity_magnitude, D2] Raises: sp.CalledProcessError: If the external program fails ValueError: If data cannot be parsed into expected shape Note: The external utilities must be compiled and available in the current directory.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Results",
    "content": "They output 5 columns: y, x, f, |u|, and log10(2 Oh D:D). result = sp.run(exe, capture_output = True , text = True , check = True ) try : if not result.stderr: raise ValueError ( f\"No output from { exe[ 0 ] } \" ) data = np.fromstring(result.stderr, sep = ' ' ).reshape(( - 1 , 5 )) return data.T except ( ValueError , AttributeError ) as e: raise ValueError ( f\"Failed to parse output from { exe[ 0 ] } : { e } \" ) # =============================== # Plotting Functions # =============================== def plot_subplot(ax, data, ymin, xmax, ymax): Create contour plots on a single subplot. Generates a composite visualization showing: 1. Interface contour (f=0.5) in green 2. Velocity magnitude field on the left half 3. Viscous dissipation rate on the right half The plot is symmetric about x=0, with different fields displayed on each side to efficiently show multiple quantities in a single view.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Context",
    "content": "Args: ax (matplotlib.axes.Axes): The axes object to plot on data (numpy.ndarray): Data array from get_data() containing [y, x, f, vel, D2] ymin (float): Minimum y-coordinate for plot bounds xmax (float): Maximum x-coordinate (plot extends from -xmax to xmax) ymax (float): Maximum y-coordinate for plot bounds Returns: tuple: (cntrl1, cntrl2) - Contour plot objects for velocity and dissipation rate, respectively. Used for colorbar creation.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Examples",
    "content": "Example: >>> fig, ax = plt.subplots() >>> data = get_data([\u201c./getDataXSlice\u201d, \u2026]) >>> vel_contour, diss_contour = plot_subplot(ax, data, -1, 2.5, 2.5) y, x, f, vel, D2 = data # Plot interface contour (f=0.5) on both sides ax.tricontour(x, y, f, levels = [ 0.5 ], colors = 'green' , linewidths = 5 ) ax.tricontour( - x, y, f, levels = [ 0.5 ], colors = 'green' , linewidths = 5 ) # Left side: velocity magnitude cntrl1 = ax.tricontourf( - x, y, vel, levels = np.linspace( 0 , 5 , 500 ), cmap = 'Purples' , extend = 'max' ) # Right side: viscous dissipation (log scale) cntrl2 = ax.tricontourf(x, y, D2, levels = np.linspace( - 2 , 2 , 400 ), cmap = 'hot_r' , extend = 'both' ) # Add centerline ax.plot([ 0 , 0 ], [ymin, ymax], '--' , color = 'grey' , linewidth = 4 ) # Add bounding box rect = patches.Rectangle(( - xmax, ymin), 2 * xmax, ymax - ymin, linewidth = 6 , edgecolor = 'k' , facecolor = 'none' ) ax.add_patch(rect) # Configure axes ax.set_aspect( 'equal' ) ax.set_xlim( - xmax, xmax) ax.set_ylim(ymin, ymax) ax.axis( 'off' ) return cntrl1, cntrl2 def plot_data(filename, image_name, ymin, xmax, ymax, n, Oh, linear, t): Generate complete visualization with X and Z slice views.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Creates a two-panel...",
    "content": "Creates a two-panel figure showing orthogonal slices through the simulation domain. Each panel displays velocity magnitude and viscous dissipation rate split across the vertical centerline. This provides a comprehensive view of the flow structure and energy dissipation patterns. Args: filename (str): Path to Basilisk snapshot file image_name (str): Output path for the generated PNG image ymin (float): Minimum y-coordinate for plot bounds xmax (float): Maximum x-coordinate for plot bounds ymax (float): Maximum y-coordinate for plot bounds n (int): Grid resolution for data extraction Oh (float): Ohnesorge number (Oh = \u03bc/\u221a(\u03c1\u03c3R)) linear (str): Interpolation mode (\u2018true\u2019 or \u2018false\u2019) t (float): Non-dimensional time t/\u221a(\u03c1R\u00b3/\u03c3) Note: The figure size is automatically adjusted to maintain proper aspect ratios for the domain. Colorbars are positioned below each subplot.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Performance: Uses ThreadPoolExecutor...",
    "content": "Performance: Uses ThreadPoolExecutor to parallelize data extraction for X and Z slices, reducing I/O wait time by approximately 40%. # Calculate figure dimensions to maintain aspect ratio fig_width = 24 # inches fig_height = fig_width * (ymax - ymin) / xmax fig = plt.figure(figsize = (fig_width, fig_height)) # Create subplots for X and Z slices ax1 = fig.add_subplot( 121 ) ax2 = fig.add_subplot( 122 ) # Prepare commands for data extraction utilities commands = [ [ \"./getDataXSlice\" , filename, str (ymax), str (xmax), str ( 0. ), str (n), str (Oh), linear], [ \"./getDataZSlice\" , filename, str (ymax), str (xmax), str ( 0. ), str (n), str (Oh), linear] ] # Execute data extraction in parallel with concurrent.futures.ThreadPoolExecutor() as executor: results = executor. map (get_data, commands) # Generate plots for each slice for ax, data in zip ([ax1, ax2], results): cntrl1, cntrl2 = plot_subplot(ax, data, ymin, xmax, ymax) ax.set_aspect( 'equal' ) # Manually position subplots for optimal layout ax1.set_position([ 0.095 , 0.1 , 0.4 , 0.8 ]) ax2.set_position([ 0.4975 , 0.1 , 0.4 , 0.8 ]) # Add colorbar for velocity magnitude (left subplot) l, b, w, h = ax1.get_position().bounds cb1 = fig.add_axes([l + 0.05 * w, b - 0.075 * h, 0.9 * w, 0.01 ]) c1 = plt.colorbar(cntrl1, cax = cb1, orientation = 'horizontal' ) c1.set_label( r' $ \\| u_i \\| / \\s qrt{ \\ gamma/ \\r ho_lR_0} $ ' , fontsize = TICK_LABEL_SIZE, labelpad = 5 ) c1.ax.tick_params(labelsize = TICK_LABEL_SIZE) c1.ax.xaxis.set_major_formatter(StrMethodFormatter( ' {x:,.1f} ' )) # Add colorbar for viscous dissipation (right subplot) l, b, w, h = ax2.get_position().bounds cb2 = fig.add_axes([l + 0.05 * w, b - 0.075 * h, 0.9 * w, 0.01 ]) c2 = plt.colorbar(cntrl2, cax = cb2, orientation = 'horizontal' ) c2.set_label( r' $ \\ log_ {10} \\ left ( 2Oh \\m athcal{D}_{ij} \\m athcal{D}_{ij} \\r ight ) $ ' , fontsize = TICK_LABEL_SIZE) c2.ax.tick_params(labelsize = TICK_LABEL_SIZE) c2.ax.xaxis.set_major_formatter(StrMethodFormatter( ' {x:,.1f} ' )) # Add title with current time ax1.set_title( r' $ t/ \\s qrt{ \\r ho_lR_0 ^ 3/ \\ gamma} = %3 . 2f $ ' % t, fontsize = TICK_LABEL_SIZE + 10 , pad = 10 ) # Save figure with tight bounding box plt.savefig(image_name, bbox_inches = 'tight' ) plt.close() # =============================== # Time Step Processing # =============================== def process_single_time_step(t, base_filename, image_folder, ymin, Oh): Process a single simulation time step to generate visualization.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Function Definition",
    "content": "Handles file existence checks, prevents redundant processing, and manages the complete visualization pipeline for one time step. This function is designed to be called in parallel by multiprocessing.Pool.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Args: t (float):...",
    "content": "Args: t (float): Time value for this snapshot base_filename (str): Format string for snapshot filenames, e.g., \u201cintermediate/snapshot-%5.4f\u201d image_folder (str): Directory to save output images ymin (float): Minimum y-coordinate for plot bounds Oh (float): Ohnesorge number for the simulation Returns: None Side Effects: - Creates PNG file in image_folder if processing succeeds - Prints status messages to stdout Example: >>> process_single_time_step(1.5, \u201csnapshot-%5.4f\u201d, \u201coutput/\u201d, -1.0, 0.01) Processing 1.5 filename = base_filename % t image_name = os.path.join(image_folder, f'snapshot- { t :.4f} .png' ) # Check if input file exists if not os.path.exists(filename): print ( f\"File { filename } does not exist\" ) return # Skip if output already exists (allows resuming interrupted runs) if os.path.exists(image_name): print ( f\"Image { image_name } already exists\" ) return print ( f\"Processing { t } \" ) # Visualization parameters xmax, ymax, n = 2.5 , 2.5 , 256 linear = 'false' # Generate visualization plot_data(filename, image_name, ymin, xmax, ymax, n, Oh, linear, t) # =============================== # Main Execution # =============================== def main(): Main function that drives the script execution.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Parses command-line arguments,...",
    "content": "Parses command-line arguments, sets up the processing environment, and orchestrates parallel processing of multiple time steps. The script uses multiprocessing to efficiently handle large numbers of snapshots. The workflow: 1. Parse command-line arguments for Ohnesorge number 2. Create output directory if needed 3. Generate list of time steps to process 4.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles: Use multiprocessing pool...",
    "content": "Use multiprocessing pool to process time steps in parallel Performance Considerations: - Uses 4 processes by default (adjust based on available cores) - Each process handles file I/O and plotting independently - Memory usage scales with number of parallel processes # Set up command-line argument parsing parser = argparse.ArgumentParser( description = \"Process Basilisk fluid dynamics simulation data to create visualizations.\" ) parser.add_argument( '--Oh' , type = float , default = 0.01 , help = 'Ohnesorge number (default: 0.01)' ) args = parser.parse_args() # Configuration base_filename = \"intermediate/snapshot- %5.4f \" image_folder = \"Video2DSlice\" ymin = - 1.025 Oh = args.Oh # Create output directory if it doesn't exist if not os.path.exists(image_folder): os.makedirs(image_folder) # Generate time steps time_step = 0.01 end_time = 8 time_steps = np.arange( 0 , end_time + time_step, time_step) # Process time steps in parallel # TODO : Make number of processes configurable via command line with multiprocessing.Pool(processes = 4 ) as pool: pool.starmap(process_single_time_step, [(t, base_filename, image_folder, ymin, Oh) for t in time_steps]) # Script entry point if __name__ == '__main__' : main()",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example: Methods",
    "content": "importnumpyasnpimportosimportsubprocessasspimportmatplotlibimportmatplotlib.pyplotaspltimportmatplotlib.patchesaspatchesfrommatplotlib.tickerimportStrMethodFormatterimportconcurrent.futuresimportmultiprocessingimportargparse# ===============================# Matplotlib Configuration# ===============================matplotlib.rcParams['font.family']='serif'matplotlib.rcParams['text.usetex']=True# Font sizes for publication-quality figuresAXES_LABEL_SIZE=50TICK_LABEL_SIZE=20# ===============================# Data Processing Functions# ===============================defget_data(exe):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example",
    "content": "result=sp.run(exe, capture_output=True, text=True, check=True)try:ifnotresult.stderr:raiseValueError(f\"No output from{exe[0]}\")data=np.fromstring(result.stderr, sep=' ').reshape((-1,5))returndata.Texcept(ValueError,AttributeError)ase:raiseValueError(f\"Failed to parse output from{exe[0]}:{e}\")# ===============================# Plotting Functions# ===============================defplot_subplot(ax, data, ymin, xmax, ymax):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example: y, x, f,...",
    "content": "y, x, f, vel, D2=data# Plot interface contour (f=0.5) on both sidesax.tricontour(x, y, f, levels=[0.5], colors='green', linewidths=5)ax.tricontour(-x, y, f, levels=[0.5], colors='green', linewidths=5)# Left side: velocity magnitudecntrl1=ax.tricontourf(-x, y, vel, levels=np.linspace(0,5,500),cmap='Purples', extend='max')# Right side: viscous dissipation (log scale)cntrl2=ax.tricontourf(x, y, D2, levels=np.linspace(-2,2,400),cmap='hot_r', extend='both')# Add centerlineax.plot([0,0], [ymin, ymax],'--', color='grey', linewidth=4)# Add bounding boxrect=patches.Rectangle((-xmax, ymin),2*xmax, ymax-ymin,linewidth=6, edgecolor='k', facecolor='none')ax.add_patch(rect)# Configure axesax.set_aspect('equal')ax.set_xlim(-xmax, xmax)ax.set_ylim(ymin, ymax)ax.axis('off')returncntrl1, cntrl2defplot_data(filename, image_name, ymin, xmax, ymax, n, Oh, linear, t):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example: # Calculate figure...",
    "content": "# Calculate figure dimensions to maintain aspect ratiofig_width=24# inchesfig_height=fig_width*(ymax-ymin)/xmaxfig=plt.figure(figsize=(fig_width, fig_height))# Create subplots for X and Z slicesax1=fig.add_subplot(121)ax2=fig.add_subplot(122)# Prepare commands for data extraction utilitiescommands=[[\"./getDataXSlice\", filename,str(ymax),str(xmax),str(0.),str(n),str(Oh), linear],[\"./getDataZSlice\", filename,str(ymax),str(xmax),str(0.),str(n),str(Oh), linear]]# Execute data extraction in parallelwithconcurrent.futures.ThreadPoolExecutor()asexecutor:results=executor.map(get_data, commands)# Generate plots for each sliceforax, datainzip([ax1, ax2], results):cntrl1, cntrl2=plot_subplot(ax, data, ymin, xmax, ymax)ax.set_aspect('equal')# Manually position subplots for optimal layoutax1.set_position([0.095,0.1,0.4,0.8])ax2.set_position([0.4975,0.1,0.4,0.8])# Add colorbar for velocity magnitude (left subplot)l, b, w, h=ax1.get_position().boundscb1=fig.add_axes([l+0.05*w, b-0.075*h,0.9*w,0.01])c1=plt.colorbar(cntrl1, cax=cb1, orientation='horizontal')c1.set_label(r'$\\|u_i\\|/\\sqrt{\\gamma/\\rho_lR_0}$',fontsize=TICK_LABEL_SIZE, labelpad=5)c1.ax.tick_params(labelsize=TICK_LABEL_SIZE)c1.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}'))# Add colorbar for viscous dissipation (right subplot)l, b, w, h=ax2.get_position().boundscb2=fig.add_axes([l+0.05*w, b-0.075*h,0.9*w,0.01])c2=plt.colorbar(cntrl2, cax=cb2, orientation='horizontal')c2.set_label(r'$\\log_{10}\\left(2Oh\\mathcal{D}_{ij}\\mathcal{D}_{ij}\\right)$',fontsize=TICK_LABEL_SIZE)c2.ax.tick_params(labelsize=TICK_LABEL_SIZE)c2.ax.xaxis.set_major_formatter(StrMethodFormatter('{x:,.1f}'))# Add title with current timeax1.set_title(r'$t/\\sqrt{\\rho_lR_0^3/\\gamma} = %3.2f$'%t,fontsize=TICK_LABEL_SIZE+10, pad=10)# Save figure with tight bounding boxplt.savefig(image_name, bbox_inches='tight')plt.close()# ===============================# Time Step Processing# ===============================defprocess_single_time_step(t, base_filename, image_folder, ymin, Oh):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example: Context",
    "content": "filename=base_filename%timage_name=os.path.join(image_folder,f'snapshot-{t:.4f}.png')# Check if input file existsifnotos.path.exists(filename):print(f\"File{filename}does not exist\")return# Skip if output already exists (allows resuming interrupted runs)ifos.path.exists(image_name):print(f\"Image{image_name}already exists\")returnprint(f\"Processing{t}\")# Visualization parametersxmax, ymax, n=2.5,2.5,256linear='false'# Generate visualizationplot_data(filename, image_name, ymin, xmax, ymax, n, Oh, linear, t)# ===============================# Main Execution# ===============================defmain():",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video2DSlice.py | Jumping Bubbles - Code Example: # Set up...",
    "content": "# Set up command-line argument parsingparser=argparse.ArgumentParser(description=\"Process Basilisk fluid dynamics simulation data to create visualizations.\")parser.add_argument('--Oh',type=float, default=0.01,help='Ohnesorge number (default: 0.01)')args=parser.parse_args()# Configurationbase_filename=\"intermediate/snapshot-%5.4f\"image_folder=\"Video2DSlice\"ymin=-1.025Oh=args.Oh# Create output directory if it doesn't existifnotos.path.exists(image_folder):os.makedirs(image_folder)# Generate time stepstime_step=0.01end_time=8time_steps=np.arange(0, end_time+time_step, time_step)# Process time steps in parallel#TODO: Make number of processes configurable via command linewithmultiprocessing.Pool(processes=4)aspool:pool.starmap(process_single_time_step,[(t, base_filename, image_folder, ymin, Oh)fortintime_steps])# Script entry pointif__name__=='__main__':main()",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video2DSlice.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles: Context",
    "content": "postProcess/getCells_bottomPlate.c See raw file Boundary Visualization Tool This program extracts and visualizes boundary data from Basilisk C simulation files, specifically designed for analyzing fluid dynamics simulations on adaptive octree grids. The tool outputs boundary cell coordinates in a format suitable for visualization software. Overview The program reads a Basilisk simulation snapshot file and iterates through all cells at the bottom boundary of the computational domain. For each boundary cell, it outputs the four corner coordinates of the cell face, creating a quadrilateral representation suitable for 3D visualization. Authors Vatsal Sanjay (vatsalsanjay@gmail.com) Youssef Physics of Fluids Group Usage ./bview <simulation_file> Output Format The program outputs to standard error (stderr) the coordinates of boundary cell faces as quadrilaterals. Each quadrilateral is defined by four corner points, with a blank line separating each cell.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles: C/C++ Code",
    "content": "Dependencies Basilisk C framework Octree grid module for adaptive mesh refinement Navier-Stokes solver (centered scheme) Volume fraction tracking module #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" #include \"fractions.h\" char filename [ 80 ]; Main Function Entry point for the boundary visualization tool. Processes command-line arguments and extracts boundary data from the specified simulation file.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles: Parameters a :...",
    "content": "Parameters a : Number of command-line arguments arguments : Array of command-line argument strings arguments[0] : Program name (unused) arguments[1] : Path to the Basilisk simulation file to process Process Flow Extracts the simulation filename from command-line arguments Restores the simulation state from the specified file Iterates through all cells at the bottom boundary Outputs quadrilateral coordinates for each boundary cell face Output Details For each boundary cell, the program outputs four corner coordinates in the following order: - Bottom-left corner: (x - \u0394/2, y, z - \u0394/2) - Top-left corner: (x - \u0394/2, y, z + \u0394/2) - Top-right corner: (x + \u0394/2, y, z + \u0394/2) - Bottom-right corner: (x + \u0394/2, y, z - \u0394/2) Where (x, y, z) represents the cell center and \u0394 (Delta) is the cell size.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles: Notes Output is...",
    "content": "Notes Output is directed to stderr to separate from standard output Each quadrilateral is followed by two newlines for separation The coordinate ordering creates counter-clockwise vertices when viewed from outside the domain (positive y direction) int main ( int a , char const * arguments []) { // Extract simulation filename from command-line arguments sprintf ( filename , \" %s \" , arguments [ 1 ]); // Restore simulation state from the specified file restore ( file = filename ); // Iterate through all cells at the bottom boundary foreach_boundary ( bottom ) { // Output quadrilateral coordinates for visualization // Format: four corner points of the boundary cell face fprintf ( ferr , \" %g %g %g\\n%g %g %g\\n%g %g %g\\n%g %g %g\\n\\n \" , x - Delta / 2. , y , z - Delta / 2. , // Bottom-left corner x - Delta / 2. , y , z + Delta / 2. , // Top-left corner x + Delta / 2. , y , z + Delta / 2. , // Top-right corner x + Delta / 2. , y , z - Delta / 2. ); // Bottom-right corner } return 0 ; }",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles - C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"#include\"fractions.h\"charfilename[80];",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getCells_bottomPlate.c | Jumping Bubbles - Code Example: intmain(inta,charconst*arguments[]){// Extract simulation...",
    "content": "intmain(inta,charconst*arguments[]){// Extract simulation filename from command-line argumentssprintf(filename,\"%s\",arguments[1]);// Restore simulation state from the specified filerestore(file=filename);// Iterate through all cells at the bottom boundaryforeach_boundary(bottom){// Output quadrilateral coordinates for visualization// Format: four corner points of the boundary cell facefprintf(ferr,\"%g%g%g\\n%g%g%g\\n%g%g%g\\n%g%g%g\\n\\n\",x-Delta/2.,y,z-Delta/2.,// Bottom-left cornerx-Delta/2.,y,z+Delta/2.,// Top-left cornerx+Delta/2.,y,z+Delta/2.,// Top-right cornerx+Delta/2.,y,z-Delta/2.);// Bottom-right corner}return0;}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getCells_bottomPlate.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Context",
    "content": "postProcess/Video3D.py See raw file #!/usr/bin/env python3 # -*- coding: utf-8 -*- Basilisk C Snapshot Visualization Script This script processes Basilisk C simulation output files to generate 3D visualizations of multiphase flow simulations. It reads cell and facet data from intermediate snapshot files, creates 3D meshes using PyVista, and saves rendered images for animation production. The script uses multiprocessing to handle large datasets efficiently and includes memory management strategies to prevent out-of-memory errors during batch processing.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Context",
    "content": "Usage: python visualize_snapshots.py Dependencies: - numpy: Array processing - pyvista: 3D visualization and mesh handling - multiprocessing: Parallel processing - Basilisk C executables: getCells_bottomPlate, getFacets3D import subprocess as sp import numpy as np import pyvista as pv import os import multiprocessing import gc # Garbage collection # =============================== # Configuration and Settings # =============================== # Camera configuration for consistent visualization CAMERA_CONFIG = { \"position\" : ( 7.75 , 3.50 , - 2.50 ), \"focal_point\" : ( 0.0 , 0.0 , 0.0 ), \"up_vector\" : ( - 0.30 , 0.95 , 0.025 ), \"parallel_scale\" : 2.2 } # Reflection planes for symmetry operations REFLECTION_NORMALS = { 'x' : [ 1 , 0 , 0 ], 'z' : [ 0 , 0 , 1 ] } # =============================== # Utility Functions # =============================== def parse_vertex(vertex_str): Parse a vertex string into a numpy array.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Converts space-separated string...",
    "content": "Converts space-separated string coordinates into a numpy array for 3D point representation. Args: vertex_str (str): Space-separated vertex coordinates (e.g., \u201c1.0 2.0 3.0\u201d) Returns: np.ndarray: 3D coordinate array Example: >>> parse_vertex(\u201c1.0 2.0 3.0\u201d) array([1., 2., 3.]) return np.fromstring(vertex_str, sep = ' ' ) def run_process(command): Execute a Basilisk C utility and capture its output. Runs external Basilisk processing tools and returns the stderr output, which contains the processed geometric data.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: command (list):...",
    "content": "Args: command (list): Command and arguments to execute Returns: str: Decoded stderr output containing geometric data Raises: subprocess.CalledProcessError: If the external command fails Note: Basilisk C utilities output data to stderr by convention p = sp.Popen(command, stdout = sp.PIPE, stderr = sp.PIPE) stdout, stderr = p.communicate() if p.returncode != 0 : error_msg = stdout.decode( \"utf-8\" ) if stdout else stderr.decode( \"utf-8\" ) raise sp.CalledProcessError(p.returncode, command[ 0 ], output = error_msg) return stderr.decode( \"utf-8\" ).strip() # =============================== # Mesh Creation Functions # =============================== def create_polydata(points, lines_array, faces_array): Create a PyVista PolyData object from points and connectivity arrays. Constructs a complete mesh representation with vertices, edges, and faces for visualization purposes.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: points (list):...",
    "content": "Args: points (list): List of 3D points defining vertices lines_array (np.ndarray): Connectivity array for line elements faces_array (np.ndarray): Connectivity array for face elements Returns: pv.PolyData: Complete mesh object ready for visualization polydata = pv.PolyData() polydata.points = np.array(points) polydata.lines = lines_array polydata.faces = faces_array return polydata def process_cells(cell_data): Process cell data from Basilisk output into PyVista meshes. Parses the cell structure data and creates individual cell meshes representing the computational grid elements.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: cell_data (str):...",
    "content": "Args: cell_data (str): Raw cell data from getCells_bottomPlate output Returns: list: List of PyVista PolyData objects representing cells Note: Assumes rectangular cells with standard connectivity pattern # Standard connectivity for rectangular cells lines_array = np.array([[ 2 , 0 , 1 ], [ 2 , 1 , 2 ], [ 2 , 2 , 3 ], [ 2 , 3 , 0 ]], dtype = np.int32) faces_array = np.array([[ 4 , 0 , 1 , 2 , 3 ]], dtype = np.int32) # Parse cell data blocks separated by double newlines cells = [[parse_vertex(point) for point in cell.split( ' \\n ' )] for cell in cell_data.split( ' \\n\\n ' )] return [create_polydata(cell, lines_array, faces_array) for cell in cells] def process_facets(facet_data): Process facet data into a single unified mesh. Converts facet vertex data into an indexed mesh representation, eliminating duplicate vertices for efficiency. This is typically used for interface reconstruction in multiphase flows.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: facet_data (str):...",
    "content": "Args: facet_data (str): Raw facet data from getFacets3D output Returns: pv.PolyData: Unified mesh containing all facets Performance: Uses dictionary-based vertex indexing to avoid duplicate points, reducing memory usage for large datasets. vertex_to_index = {} points, cells = [], [] for facet in facet_data.split( ' \\n\\n ' ): cell = [] for vertex_str in facet.split( ' \\n ' ): vertex = parse_vertex(vertex_str) vertex_tuple = tuple (vertex) # Convert to hashable type # Index unique vertices if vertex_tuple not in vertex_to_index: vertex_to_index[vertex_tuple] = len (points) points.append(vertex) cell.append(vertex_to_index[vertex_tuple]) # Build VTK-style connectivity array cells.extend([ len (cell)] + cell) return pv.PolyData(np.array(points, dtype = np.float64), faces = np.array(cells, dtype = np.int32)) def reflect_mesh(mesh, normals): Apply reflection symmetry operations to a mesh.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Creates reflected copies...",
    "content": "Creates reflected copies of the mesh across specified planes to reconstruct the full domain from symmetry-reduced simulations. Args: mesh (pv.PolyData): Original mesh to reflect normals (dict): Dictionary mapping labels to normal vectors Returns: pv.PolyData: Combined mesh including all reflections Note: Reflections are applied sequentially and merged with the original for normal in normals.values(): mesh = mesh.merge(mesh.reflect(normal)) return mesh # =============================== # Main Processing Functions # =============================== def get_grid(filename): Extract and process computational grid from Basilisk snapshot. Reads cell data from a snapshot file and constructs the visualization mesh for the computational grid, applying symmetry operations.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: filename (str):...",
    "content": "Args: filename (str): Path to Basilisk snapshot file Returns: pv.PolyData: Complete grid mesh with reflections applied Note: Requires getCells_bottomPlate executable in the working directory cell_data = run_process([ \"./getCells_bottomPlate\" , filename]) cells = process_cells(cell_data) mesh = pv.MultiBlock(cells).combine() return reflect_mesh(mesh, REFLECTION_NORMALS) def get_facets_3d(filename): Extract and process 3D interface facets from Basilisk snapshot. Reads facet data representing fluid interfaces and constructs the visualization mesh with symmetry operations applied.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Args: filename (str):...",
    "content": "Args: filename (str): Path to Basilisk snapshot file Returns: pv.PolyData: Complete interface mesh with reflections Note: Requires getFacets3D executable in the working directory facet_data = run_process([ \"./getFacets3D\" , filename]) mesh = process_facets(facet_data) return reflect_mesh(mesh, REFLECTION_NORMALS) def process_and_save_image(t, base_filename, image_folder): Process a single time step and generate visualization image. Reads simulation data for a specific time, creates 3D visualization with grid and interface meshes, and saves the rendered image. Args: t (float): Simulation time base_filename (str): Template filename with format specifier image_folder (str): Output directory for images Performance: Includes explicit garbage collection to manage memory usage during batch processing of large datasets. Note: Skips processing if output image already exists or input file is missing.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Uses off-screen rendering...",
    "content": "Uses off-screen rendering for headless operation. filename = base_filename % t image_filename = f\" { image_folder } / { int (t * 1e4 ) :06d} .png\" # Check file existence if not os.path.exists(filename): print ( f\"File { filename } does not exist\" ) return if os.path.exists(image_filename): print ( f\"Image { image_filename } already exists\" ) return print ( f\"Processing t = { t } \" ) # Process mesh data cells = get_grid(filename) poly_data = get_facets_3d(filename) # Configure off-screen renderer plotter = pv.Plotter(off_screen = True ) try : # Add mesh components with different styles plotter.add_mesh(cells, color = 'grey' ) # Solid grid plotter.add_mesh(cells, color = 'black' , style = 'wireframe' ) # Grid edges plotter.add_mesh(poly_data, color = 'orange' ) # Interface # Apply camera configuration plotter.camera.position = CAMERA_CONFIG[ \"position\" ] plotter.camera.focal_point = CAMERA_CONFIG[ \"focal_point\" ] plotter.camera.up = CAMERA_CONFIG[ \"up_vector\" ] plotter.camera.parallel_scale = CAMERA_CONFIG[ \"parallel_scale\" ] # Add timestamp annotation plotter.add_text( f\"t = { t :.2f} \" , position = 'upper_right' , font_size = 15 , color = 'black' , font_file = 'cmunrm.ttf' ) # Render and save plotter.screenshot(image_filename) plotter.close() except Exception as e: print ( f\"Error processing t = { t } : { str (e) } \" ) finally : # Explicit memory cleanup for large datasets del cells, poly_data, plotter gc.collect() def process_single_time_step(args): Wrapper function for multiprocessing pool.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Unpacks arguments and...",
    "content": "Unpacks arguments and calls the main processing function, ensuring proper garbage collection after each process. Args: args (tuple): Packed arguments for process_and_save_image Note: Additional garbage collection helps prevent memory accumulation in long-running batch processes. process_and_save_image( * args) gc.collect() # =============================== # Main Execution # =============================== def main(): Main function that drives the script execution. Sets up the processing pipeline for batch visualization of Basilisk snapshots, using multiprocessing to handle multiple time steps in parallel.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles: Creates output directory...",
    "content": "Creates output directory and manages the processing pool. # Configuration base_filename = \"intermediate/snapshot- %5.4f \" image_folder = \"Video\" # Time stepping parameters time_step = 0.01 end_time = 8 # Create output directory if not os.path.exists(image_folder): os.makedirs(image_folder) # Generate time steps time_steps = np.arange( 0 , end_time + time_step, time_step) args = [(t, base_filename, image_folder) for t in time_steps] # Process in parallel with limited pool size for memory management # TODO : Make number of processes configurable via command line with multiprocessing.Pool(processes = 2 ) as pool: pool. map (process_single_time_step, args) if __name__ == '__main__' : main()",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example: Context",
    "content": "importsubprocessasspimportnumpyasnpimportpyvistaaspvimportosimportmultiprocessingimportgc# Garbage collection# ===============================# Configuration and Settings# ===============================# Camera configuration for consistent visualizationCAMERA_CONFIG={\"position\": (7.75,3.50,-2.50),\"focal_point\": (0.0,0.0,0.0),\"up_vector\": (-0.30,0.95,0.025),\"parallel_scale\":2.2}# Reflection planes for symmetry operationsREFLECTION_NORMALS={'x': [1,0,0],'z': [0,0,1]}# ===============================# Utility Functions# ===============================defparse_vertex(vertex_str):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "returnnp.fromstring(vertex_str, sep=' ')defrun_process(command):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "p=sp.Popen(command, stdout=sp.PIPE, stderr=sp.PIPE)stdout, stderr=p.communicate()ifp.returncode!=0:error_msg=stdout.decode(\"utf-8\")ifstdoutelsestderr.decode(\"utf-8\")raisesp.CalledProcessError(p.returncode, command[0], output=error_msg)returnstderr.decode(\"utf-8\").strip()# ===============================# Mesh Creation Functions# ===============================defcreate_polydata(points, lines_array, faces_array):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "polydata=pv.PolyData()polydata.points=np.array(points)polydata.lines=lines_arraypolydata.faces=faces_arrayreturnpolydatadefprocess_cells(cell_data):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "# Standard connectivity for rectangular cellslines_array=np.array([[2,0,1], [2,1,2], [2,2,3], [2,3,0]], dtype=np.int32)faces_array=np.array([[4,0,1,2,3]], dtype=np.int32)# Parse cell data blocks separated by double newlinescells=[[parse_vertex(point)forpointincell.split('\\n')]forcellincell_data.split('\\n\\n')]return[create_polydata(cell, lines_array, faces_array)forcellincells]defprocess_facets(facet_data):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example: Context",
    "content": "vertex_to_index={}points, cells=[], []forfacetinfacet_data.split('\\n\\n'):cell=[]forvertex_strinfacet.split('\\n'):vertex=parse_vertex(vertex_str)vertex_tuple=tuple(vertex)# Convert to hashable type# Index unique verticesifvertex_tuplenotinvertex_to_index:vertex_to_index[vertex_tuple]=len(points)points.append(vertex)cell.append(vertex_to_index[vertex_tuple])# Build VTK-style connectivity arraycells.extend([len(cell)]+cell)returnpv.PolyData(np.array(points, dtype=np.float64),faces=np.array(cells, dtype=np.int32))defreflect_mesh(mesh, normals):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "fornormalinnormals.values():mesh=mesh.merge(mesh.reflect(normal))returnmesh# ===============================# Main Processing Functions# ===============================defget_grid(filename):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "cell_data=run_process([\"./getCells_bottomPlate\", filename])cells=process_cells(cell_data)mesh=pv.MultiBlock(cells).combine()returnreflect_mesh(mesh, REFLECTION_NORMALS)defget_facets_3d(filename):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "facet_data=run_process([\"./getFacets3D\", filename])mesh=process_facets(facet_data)returnreflect_mesh(mesh, REFLECTION_NORMALS)defprocess_and_save_image(t, base_filename, image_folder):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example: Context",
    "content": "filename=base_filename%timage_filename=f\"{image_folder}/{int(t*1e4):06d}.png\"# Check file existenceifnotos.path.exists(filename):print(f\"File{filename}does not exist\")returnifos.path.exists(image_filename):print(f\"Image{image_filename}already exists\")returnprint(f\"Processing t ={t}\")# Process mesh datacells=get_grid(filename)poly_data=get_facets_3d(filename)# Configure off-screen rendererplotter=pv.Plotter(off_screen=True)try:# Add mesh components with different stylesplotter.add_mesh(cells, color='grey')# Solid gridplotter.add_mesh(cells, color='black', style='wireframe')# Grid edgesplotter.add_mesh(poly_data, color='orange')# Interface# Apply camera configurationplotter.camera.position=CAMERA_CONFIG[\"position\"]plotter.camera.focal_point=CAMERA_CONFIG[\"focal_point\"]plotter.camera.up=CAMERA_CONFIG[\"up_vector\"]plotter.camera.parallel_scale=CAMERA_CONFIG[\"parallel_scale\"]# Add timestamp annotationplotter.add_text(f\"t ={t:.2f}\", position='upper_right',font_size=15, color='black', font_file='cmunrm.ttf')# Render and saveplotter.screenshot(image_filename)plotter.close()exceptExceptionase:print(f\"Error processing t ={t}:{str(e)}\")finally:# Explicit memory cleanup for large datasetsdelcells, poly_data, plottergc.collect()defprocess_single_time_step(args):",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example",
    "content": "process_and_save_image(*args)gc.collect()# ===============================# Main Execution# ===============================defmain():",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video3D.py | Jumping Bubbles - Code Example: Context",
    "content": "# Configurationbase_filename=\"intermediate/snapshot-%5.4f\"image_folder=\"Video\"# Time stepping parameterstime_step=0.01end_time=8# Create output directoryifnotos.path.exists(image_folder):os.makedirs(image_folder)# Generate time stepstime_steps=np.arange(0, end_time+time_step, time_step)args=[(t, base_filename, image_folder)fortintime_steps]# Process in parallel with limited pool size for memory management#TODO: Make number of processes configurable via command linewithmultiprocessing.Pool(processes=2)aspool:pool.map(process_single_time_step, args)if__name__=='__main__':main()",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Video3D.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: Context",
    "content": "postProcess/getDataXSlice.c See raw file Interpolating Data from Dump Files: gfs2oogl Style This program extracts and interpolates flow field data from Basilisk/Gerris dump files, focusing on velocity fields and viscous dissipation calculations. It provides two interpolation modes: structured grid interpolation and direct boundary point extraction.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: Author Vatsal Sanjay...",
    "content": "Author Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Group Overview The code processes simulation dump files to extract: - Volume fraction fields (f) - Velocity magnitude - Viscous dissipation rate (D2c) The extraction occurs on a specified x-plane slice, with output suitable for visualization or further analysis. #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" #define FILTERED 26 #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include <string.h> char filename [ 80 ]; int ny , nz ; double ymin , zmin , ymax , zmax , xSlice , Oh ; bool linear ; scalar * list = NULL ; scalar vel [], D2c []; Physical Parameters These define the property ratios between the two phases in the simulation.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: Mu21 : Viscosity...",
    "content": "Mu21 : Viscosity ratio (phase 2 / phase 1) = 1.00e-3 Rho21 : Density ratio (phase 2 / phase 1) = 1.00e-3 #define MU21 ( 1.00e-3 ) 48 #define RHO21 ( 1.00e-3 ) 49 50 Main Program Processes command-line arguments to extract and interpolate flow field data from a Basilisk dump file.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: Command Line Arguments...",
    "content": "Command Line Arguments arguments[1] : Input dump file name arguments[2] : Maximum y-coordinate for the extraction domain arguments[3] : Maximum z-coordinate for the extraction domain arguments[4] : x-coordinate of the slice plane arguments[5] : Number of grid points in z-direction (for linear mode) arguments[6] : Ohnesorge number (dimensionless viscosity) arguments[7] : Interpolation mode flag (linear or boundary points) Workflow Loads the dump file and applies boundary conditions Calculates derived quantities (velocity magnitude, dissipation) Outputs data either on a structured grid or at boundary points int main ( int a , char const * arguments []) { Boundary Conditions Apply no-slip conditions at the bottom boundary: - Tangential velocity component = 0 - Radial velocity component = 0 - Volume fraction = 1 (pure phase 1) u . t [ bottom ] = dirichlet ( 0. ); u . r [ bottom ] = dirichlet ( 0. ); f [ bottom ] = dirichlet ( 1. ); File Loading and Initialization Restore the simulation state from the dump file and ensure proper prolongation operators for the volume fraction field. sprintf ( filename , \" %s \" , arguments [ 1 ]); restore ( file = filename ); f . prolongation = fraction_refine ; boundary ({ f , u . x , u . y , u . z }); Domain Bounds Determination Find the minimum y-coordinate by scanning the left boundary.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: This ensures we...",
    "content": "This ensures we capture the full computational domain extent. ymin = HUGE ; foreach_boundary ( left ) { if ( y < ymin ) ymin = y ; } Parameter Initialization Extract command-line arguments and set up the extraction domain: - ymax : Upper bound in y-direction - zmin/zmax : Bounds in z-direction (0 to specified maximum) - xSlice : Location of the extraction plane - nz : Grid resolution for structured interpolation - Oh : Ohnesorge number for viscosity scaling ymax = atof ( arguments [ 2 ]); zmin = 0.0 ; zmax = atof ( arguments [ 3 ]); xSlice = atof ( arguments [ 4 ]); nz = atoi ( arguments [ 5 ]); Oh = atof ( arguments [ 6 ]); linear = ( strcmp ( arguments [ 7 ], \"true\" ) == 0 ); Physical Properties Setup Set the dimensional properties based on the Ohnesorge number: - Phase 1: \u03c1 = 1.0, \u03bc = Oh - Phase 2: \u03c1 = Rho21, \u03bc = Mu21 \u00d7 Oh This scaling ensures proper dimensionless groups in the simulation. rho1 = 1.0 ; mu1 = Oh ; rho2 = RHO21 ; mu2 = MU21 * Oh ; Output Variable List Define which scalar fields to extract: - Volume fraction (f) - Velocity magnitude (vel) - Log10 of viscous dissipation (D2c) list = list_add ( list , f ); list = list_add ( list , vel ); list = list_add ( list , D2c ); double delta_min = HUGE ; Calculate Derived Quantities For each cell in the domain, compute: 1.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: Velocity magnitude from...",
    "content": "Velocity magnitude from the three velocity components 2. Viscous dissipation rate using the strain rate tensor foreach () { vel [] = sqrt ( sq ( u . x []) + sq ( u . y []) + sq ( u . z [])); Strain Rate Tensor Calculation Compute D\u00b2 = D\u1d62\u2c7cD\u1d62\u2c7c where D\u1d62\u2c7c is the strain rate tensor: - Diagonal terms: \u2202u\u1d62/\u2202x\u1d62 - Off-diagonal terms: \u00bd(\u2202u\u1d62/\u2202x\u2c7c + \u2202u\u2c7c/\u2202x\u1d62) The dissipation is then 2\u03bcD\u00b2, where \u03bc is the local viscosity. double D2 = 0. ; foreach_dimension () { double DII = ( u . x [ 1 , 0 , 0 ] - u . x [- 1 , 0 , 0 ]) / ( 2 * Delta ); double DIJ = 0.5 * (( u . x [ 0 , 1 , 0 ] - u . x [ 0 ,- 1 , 0 ] + u . y [ 1 , 0 , 0 ] - u . y [- 1 , 0 , 0 ]) / ( 2 * Delta )); double DIK = 0.5 * (( u . x [ 0 , 0 , 1 ] - u . x [ 0 , 0 ,- 1 ] + u . z [ 1 , 0 , 0 ] - u . z [- 1 , 0 , 0 ]) / ( 2 * Delta )); D2 += sq ( DII ) + sq ( DIJ ) + sq ( DIK ); } Dissipation Scaling Convert the dissipation to log10 scale for better visualization range. Values \u2264 0 are mapped to -10 to avoid logarithm issues.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: D2c [] =...",
    "content": "D2c [] = 2 * ( mu ( f [])) * D2 ; if ( D2c [] > 0. ) { D2c [] = log ( D2c []) / log ( 10. ); } else { D2c [] = - 10. ; } delta_min = delta_min > Delta ? Delta : delta_min ; } Interpolation Mode Selection Choose between structured grid interpolation (linear = true) or direct boundary point extraction (linear = false). If the requested grid spacing exceeds 1/4 of the minimum cell size, force boundary point mode to avoid under-resolution. if (( linear == true ) && ( delta_min < 4 * (( double )(( zmax - zmin ) / ( nz ))))) { linear = false ; } if ( linear == false ) { Boundary Point Extraction Mode Output data directly at computational points on the left boundary. This preserves the adaptive mesh structure but may result in irregular point spacing. Output format: y z f vel D2c FILE * fp = ferr ; foreach_boundary ( left ) { fprintf ( fp , \" %g %g %g %g %g\\n \" , y , z , f [], vel [], D2c []); } } else { Structured Grid Interpolation Mode Interpolate field values onto a regular Cartesian grid.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: This provides uniform...",
    "content": "This provides uniform spacing suitable for standard visualization tools. FILE * fp = ferr ; Grid Setup Create a uniform grid with: - nz points in z-direction (user-specified) - ny points in y-direction (computed to maintain aspect ratio) - Equal spacing in both directions (DeltaZ = DetlaY) double delta_z = ( double )(( zmax - zmin ) / ( nz )); int ny = ( int )(( ymax - ymin ) / delta_z ); double delta_y = ( double )(( ymax - ymin ) / ( ny )); Memory Allocation Allocate a 2D array to store interpolated values for all fields. The array is structured as field[i][len*j + k] where: - i: y-index - j: z-index - k: field index in the scalar list int len = list_len ( list ); double ** field = ( double **) matrix_new ( ny , nz , len * sizeof ( double )); Interpolation Loop For each grid point, interpolate all scalar fields from the octree structure.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles: This uses trilinear...",
    "content": "This uses trilinear interpolation internally. for ( int i = 0 ; i < ny ; i ++) { double y = delta_y * i + ymin ; for ( int j = 0 ; j < nz ; j ++) { double z = delta_z * j + zmin ; int k = 0 ; for ( scalar s in list ) { field [ i ][ len * j + k ++] = interpolate ( s , xSlice , y , z ); } } } Data Output Write the interpolated data in a format suitable for visualization: - First two columns: y and z coordinates - Remaining columns: scalar field values in list order for ( int i = 0 ; i < ny ; i ++) { double y = delta_y * i + ymin ; for ( int j = 0 ; j < nz ; j ++) { double z = delta_z * j + zmin ; fprintf ( fp , \" %g %g \" , y , z ); int k = 0 ; for ( scalar s in list ) { fprintf ( fp , \" %g \" , field [ i ][ len * j + k ++]); } fputc ( ' \\n ' , fp ); } } fflush ( fp ); matrix_free ( field ); } }",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"#define FILTERED26#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include<string.h>charfilename[80];intny,nz;doubleymin,zmin,ymax,zmax,xSlice,Oh;boollinear;scalar*list=NULL;scalar vel[],D2c[];",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "u.t[bottom]=dirichlet(0.);u.r[bottom]=dirichlet(0.);f[bottom]=dirichlet(1.);",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "sprintf(filename,\"%s\",arguments[1]);restore(file=filename);f.prolongation=fraction_refine;boundary({f,u.x,u.y,u.z});",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "ymin=HUGE;foreach_boundary(left){if(y<ymin)ymin=y;}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "ymax=atof(arguments[2]);zmin=0.0;zmax=atof(arguments[3]);xSlice=atof(arguments[4]);nz=atoi(arguments[5]);Oh=atof(arguments[6]);linear=(strcmp(arguments[7],\"true\")==0);",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "list=list_add(list,f);list=list_add(list,vel);list=list_add(list,D2c);doubledelta_min=HUGE;",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "foreach(){vel[]=sqrt(sq(u.x[])+sq(u.y[])+sq(u.z[]));",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "doubleD2=0.;foreach_dimension(){doubleDII=(u.x[1,0,0]-u.x[-1,0,0])/(2*Delta);doubleDIJ=0.5*((u.x[0,1,0]-u.x[0,-1,0]+u.y[1,0,0]-u.y[-1,0,0])/(2*Delta));doubleDIK=0.5*((u.x[0,0,1]-u.x[0,0,-1]+u.z[1,0,0]-u.z[-1,0,0])/(2*Delta));D2+=sq(DII)+sq(DIJ)+sq(DIK);}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "D2c[]=2*(mu(f[]))*D2;if(D2c[]>0.){D2c[]=log(D2c[])/log(10.);}else{D2c[]=-10.;}delta_min=delta_min>Delta?Delta:delta_min;}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "if((linear==true)&&(delta_min<4*((double)((zmax-zmin)/(nz))))){linear=false;}if(linear==false){",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "FILE*fp=ferr;foreach_boundary(left){fprintf(fp,\"%g%g%g%g%g\\n\",y,z,f[],vel[],D2c[]);}}else{",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "doubledelta_z=(double)((zmax-zmin)/(nz));intny=(int)((ymax-ymin)/delta_z);doubledelta_y=(double)((ymax-ymin)/(ny));",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "intlen=list_len(list);double**field=(double**)matrix_new(ny,nz,len*sizeof(double));",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "for(inti=0;i<ny;i++){doubley=delta_y*i+ymin;for(intj=0;j<nz;j++){doublez=delta_z*j+zmin;intk=0;for(scalar s in list){field[i][len*j+k++]=interpolate(s,xSlice,y,z);}}}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getDataXSlice.c | Jumping Bubbles - Code Example",
    "content": "for(inti=0;i<ny;i++){doubley=delta_y*i+ymin;for(intj=0;j<nz;j++){doublez=delta_z*j+zmin;fprintf(fp,\"%g%g\",y,z);intk=0;for(scalar s in list){fprintf(fp,\"%g\",field[i][len*j+k++]);}fputc('\\n',fp);}}fflush(fp);matrix_free(field);}}",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/getDataXSlice.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Visulization3D.ipynb | Jumping Bubbles",
    "content": "postProcess/Visulization3D.ipynb See raw file Visulization3D.ipynb Jupyter Notebook: Visulization3D.ipynb Download Notebook View in nbviewer Open in Colab About this notebook This notebook provides visualization and analysis related to Visulization3D. Key Features: Visualization of data and results Analysis of simulation outputs Interactive exploration of parameters Tip: For the best interactive experience, download the notebook or open it in Google Colab. Notebook Preview Notebook Preview Unavailable The notebook preview could not be loaded. This may be because: The notebook file is not yet available in the repository The nbviewer service is temporarily unavailable The repository is private or has access restrictions You can still download the notebook using the button above or view it directly through one of the external services.",
    "url": "https://comphy-lab.org/JumpingBubbles/postProcess/Visulization3D.ipynb.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Jumping Bubbles",
    "content": "simulationCases/Makefile See raw file Makefile # Check if .project_config exists ifeq ( \\$ ( wildcard ../.project_config ) , ) \\$ ( error \"../.project_config not found\" ) endif BASILISK := \\$ ( shell . ../.project_config && echo \\$\\$ BASILISK ) CFLAGS += -O2 -disable-dimensions CFLAGS += -I\\$ ( PWD ) /src-local -I\\$ ( PWD ) /../src-local include \\$ ( BASILISK ) /Makefile.defs",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/Makefile.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/Makefile | Jumping Bubbles - Code Example",
    "content": "# Check if .project_config existsifeq(\\$(wildcard../.project_config),)\\$(error\"../.project_config not found\")endifBASILISK:=\\$(shell. ../.project_config&&echo\\$\\$BASILISK)CFLAGS+=-O2-disable-dimensionsCFLAGS+=-I\\$(PWD)/src-local-I\\$(PWD)/../src-localinclude\\$(BASILISK)/Makefile.defs",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/Makefile.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases JumpingBubbles-hydrophilic.c This code simulates the coalescence and subsequent jumping of two bubbles sitting on a hydrophilic substrate using th... JumpingBubbles.c A computational fluid dynamics simulation of two bubbles coalescing and jumping off a substrate using Basilisk C. Thi... Makefile ifeq (\\$(wildcard ../.projectconfig),) \\$(error '../.projectconfig not found') endif BASILISK := \\$(shell . ../.proje... runCasesOpenMP.sh qcc -O2 -Wall -disable-dimensions -fopenmp -I\\$(PWD)/src-local JumpingBubbles.c -o JumpingBubbles -lm export OMPNUMTH... runCasesOpenMPI.sh CC99='mpicc -std=c99' qcc -Wall -O2 -DMPI=1 -disable-dimensions -I\\$(PWD)/src-local JumpingBubbles.c -o JumpingBubble...",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Context",
    "content": "simulationCases/JumpingBubbles-hydrophilic.c See raw file Jumping Bubbles Simulation Overview This code simulates the coalescence and subsequent jumping of two bubbles sitting on a hydrophilic substrate using the Basilisk C framework. The simulation employs an adaptive octree grid for spatial discretization and models two-phase flow with surface tension effects. Physics Description The simulation captures the dynamics of bubble coalescence-induced jumping, a phenomenon where two bubbles merge and the resulting bubble jumps away from the substrate due to the conversion of surface energy into kinetic energy. The Volume-of-Fluid (VOF) method tracks the gas-liquid interface evolution throughout the process.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Key Features Adaptive...",
    "content": "Key Features Adaptive mesh refinement based on interface location and flow gradients Two-phase flow modeling with large density and viscosity contrasts Surface tension effects via the Continuum Surface Force (CSF) method STL file input for complex initial bubble geometries Simulation Parameters Dimensionless Numbers Oh : Ohnesorge number - ratio of viscous to inertial-capillary forces Controls the damping of interface oscillations Default: 0.01 Grid Parameters MAXlevel : Maximum refinement level Determines the finest grid resolution (2^MAXlevel cells) Default: 9 MINlevel : Minimum refinement level Controls the coarsest grid resolution Fixed at: 2 Temporal Parameters tmax : Maximum simulation time Default: 1e-2 (MPI disabled) or 2.0 (MPI enabled) tsnap : Time interval between solution snapshots Fixed at: 1e-2 tsnap2 : Time interval for log file outputs Fixed at: 1e-4 Physical Parameters Ldomain : Length of the cubic simulation domain Fixed at: 4 Rho21 : Density ratio (gas/liquid) Fixed at: 1e-3 Mu21 : Viscosity ratio (gas/liquid) Fixed at: 1e-3 Refinement Tolerances fErr : Interface (VOF) refinement tolerance Fixed at: 1e-3 KErr : Curvature refinement tolerance Fixed at: 1e-4 VelErr : Velocity field refinement tolerance Fixed at: 1e-4 Boundary Conditions Bottom Boundary (Substrate) No-slip condition: tangential and radial velocities set to zero Wetting condition: interface fraction f = 1 (liquid phase) Implementation Details Solver Configuration Base solver: navier-stokes/centered for momentum conservation Two-phase model: Handles density and viscosity jumps Surface tension: Implemented via tension.h module Conservation: Uses navier-stokes/conserving.h for mass conservation Geometric Processing distance() : Computes signed distance from STL geometry fractions() : Constructs VOF field from distance function Compilation and Execution Example Compilation qcc -O2 -Wall -disable-dimensions -fopenmp JumpingBubbles.c \\ -o JumpingBubbles -lm Execution ./JumpingBubbles Output Files dumpFile : Restart file for continuing simulations intermediate/snapshot-*.dump : Solution snapshots at regular intervals log : Kinetic energy evolution data Author Information Author: Vatsal Version: 1.0 Date: January 4, 2025 #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" #define FILTERED 1 105 #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #if !_MPI #include \"distance.h\" #endif #define MINlevel 2 114 #define tsnap ( 1e-2 ) 115 #define tsnap2 ( 1e-4 ) 116 #define fErr ( 1e-3 ) 117 #define KErr ( 1e-4 ) 118 #define VelErr ( 1e-4 ) 119 #define Mu21 ( 1.00e-3 ) 120 #define Rho21 ( 1.00e-3 ) 121 #define Ldomain 4 122 // Boundary conditions u . t [ bottom ] = dirichlet ( 0. ); u . r [ bottom ] = dirichlet ( 0. ); uf . t [ bottom ] = dirichlet ( 0. ); uf . r [ bottom ] = dirichlet ( 0. ); f [ bottom ] = dirichlet ( 1. ); double tmax , Oh ; int MAXlevel ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes simulation parameters and executes the run.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Function Definition",
    "content": "The function sets different maximum times based on whether MPI is enabled, configures the Ohnesorge number and grid parameters, and initializes the computational domain. Key Operations Sets simulation duration based on parallelization mode Configures physical parameters (Oh number, refinement levels) Initializes the grid with minimum refinement level Sets fluid properties based on dimensionless parameters Creates output directory structure int main () { #if !_MPI tmax = 1e-2 ; #else tmax = 2e0 ; #endif Oh = 0.01 ; MAXlevel = 9 ; init_grid ( 1 << MINlevel ); L0 = Ldomain ; fprintf ( ferr , \"tmax = %g .",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Oh = %g\\n...",
    "content": "Oh = %g\\n \" , tmax , Oh ); rho1 = 1.0 ; mu1 = Oh ; rho2 = Rho21 ; mu2 = Mu21 * Oh ; f . sigma = 1.0 ; char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); sprintf ( dumpFile , \"restartFile\" ); run (); } Initialization Event Sets up the initial bubble configuration either by restoring from a previous simulation or by reading an STL file containing the bubble geometry.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Function Definition",
    "content": "Workflow Attempts to restore from a dump file if available If restoration fails, reads bubble geometry from STL file Computes signed distance function from STL geometry Performs initial adaptive refinement based on distance field Converts distance function to VOF field using fractions() Initializes velocity field to zero STL Processing Details Reads \u201cInitialCondition.stl\u201d file Computes bounding box of geometry Centers domain around bubble configuration Applies small vertical offset (-0.025) for substrate contact Error Handling Reports if dump file restoration fails Exits with error if STL file is not found Logs bounding box coordinates for verification event init ( t = 0 ) { #if _MPI if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else if (! restore ( file = dumpFile )) { char filename [ 60 ]; sprintf ( filename , \"InitialCondition.stl\" ); FILE * fp = fopen ( filename , \"r\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); return 1 ; } coord * p = input_stl ( fp ); fclose ( fp ); coord min , max ; bounding_box ( p , & min , & max ); fprintf ( ferr , \"xmin %g xmax %g\\n ymin %g ymax %g\\n zmin %g zmax %g\\n \" , min . x , max . x , min . y , max . y , min . z , max . z ); fprintf ( ferr , \"x0 = %g , y0 = %g , z0 = %g\\n \" , 0. , - 1.0 , ( min . z + max . z ) / 2. ); origin ( 0. , - 1.0 - 0.025 , ( min . z + max . z ) / 2. ); scalar d []; distance ( d , p ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-6 , 1e-6 * L0 }, MAXlevel ). nf ); vertex scalar phi []; foreach_vertex () { phi [] = -( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ] + d [ 0 , 0 ,- 1 ] + d [- 1 , 0 ,- 1 ] + d [ 0 ,- 1 ,- 1 ] + d [- 1 ,- 1 ,- 1 ]) / 8. ; } fractions ( phi , f ); foreach () { foreach_dimension () { u . x [] = 0.0 ; } } dump ( file = \"dumpInit\" ); fprintf ( ferr , \"Done with initial condition! \\n \" ); } #endif } Adaptive Refinement Event Performs dynamic mesh refinement at each timestep based on solution gradients.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: This ensures computational...",
    "content": "This ensures computational resources are concentrated in regions of high activity while maintaining accuracy. Refinement Criteria Interface location (VOF field f) Interface curvature (computed from VOF field) Velocity components (all three directions) Implementation Computes local curvature using the curvature() function Applies wavelet-based error estimation Refines/coarsens cells based on error tolerances Maintains refinement between MINlevel and MAXlevel event adapt ( i ++) { scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , KAPPA , u . x , u . y , u . z }, ( double []){ fErr , KErr , VelErr , VelErr , VelErr }, MAXlevel , MINlevel ); } File Output Event Writes solution snapshots at regular intervals for post-processing and visualization. Creates both restart files and timestamped snapshots.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Output Schedule Triggers...",
    "content": "Output Schedule Triggers at t = 0 and every tsnap interval Continues until tmax + tsnap File Structure Overwrites main restart file at each output Creates timestamped snapshots in intermediate/ directory Uses 5.4f format for time in filenames event writingFiles ( t = 0 ; t += tsnap ; t <= tmax + tsnap ) { dump ( file = dumpFile ); char nameOut [ 80 ]; sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Logging Event Records integral quantities at high frequency for quantitative analysis. Specifically tracks the kinetic energy of the gas phase to monitor bubble dynamics.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles: Computed Quantities Kinetic...",
    "content": "Computed Quantities Kinetic energy of gas phase: KE = 0.5 * \u03c1 * (u\u00b2 + v\u00b2 + w\u00b2) * (1-f) * \u0394V Uses clamp() to ensure clean phase separation Output Format Headers: i (iteration), dt (timestep), t (time), ke (kinetic energy) Writes to both stderr and \u201clog\u201d file Appends to existing log file after initial write Parallel Considerations Uses reduction operation for parallel summation Only process 0 performs file I/O event logWriting ( t = 0 ; t += tsnap2 ; t <= tmax + tsnap ) { double ke = 0. ; foreach ( reduction (+: ke )) { ke += 0.5 * ( sq ( u . x []) + sq ( u . y []) + sq ( u . z [])) * clamp ( 1. - f [], 0. , 1. ) * cube ( Delta ); } if ( pid () == 0 ) { static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"i dt t ke \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); } }",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example",
    "content": "qcc-O2-Wall-disable-dimensions-fopenmpJumpingBubbles.c\\-oJumpingBubbles-lm",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - C/C++ Code: C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"#define FILTERED1105#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#if !_MPI#include\"distance.h\"#endif#define MINlevel2114#define tsnap(1e-2)115#define tsnap2(1e-4)116#define fErr(1e-3)117#define KErr(1e-4)118#define VelErr(1e-4)119#define Mu21(1.00e-3)120#define Rho21(1.00e-3)121#define Ldomain4122// Boundary conditionsu.t[bottom]=dirichlet(0.);u.r[bottom]=dirichlet(0.);uf.t[bottom]=dirichlet(0.);uf.r[bottom]=dirichlet(0.);f[bottom]=dirichlet(1.);doubletmax,Oh;intMAXlevel;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example",
    "content": "intmain(){#if !_MPItmax=1e-2;#elsetmax=2e0;#endifOh=0.01;MAXlevel=9;init_grid(1<<MINlevel);L0=Ldomain;fprintf(ferr,\"tmax =%g. Oh =%g\\n\",tmax,Oh);rho1=1.0;mu1=Oh;rho2=Rho21;mu2=Mu21*Oh;f.sigma=1.0;charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);sprintf(dumpFile,\"restartFile\");run();}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example: event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot...",
    "content": "event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#elseif(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"InitialCondition.stl\");FILE*fp=fopen(filename,\"r\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);return1;}coord*p=input_stl(fp);fclose(fp);coord min,max;bounding_box(p,&min,&max);fprintf(ferr,\"xmin%gxmax%g\\nymin%gymax%g\\nzmin%gzmax%g\\n\",min.x,max.x,min.y,max.y,min.z,max.z);fprintf(ferr,\"x0 =%g, y0 =%g, z0 =%g\\n\",0.,-1.0,(min.z+max.z)/2.);origin(0.,-1.0-0.025,(min.z+max.z)/2.);scalar d[];distance(d,p);while(adapt_wavelet((scalar*){f,d},(double[]){1e-6,1e-6*L0},MAXlevel).nf);vertex scalar phi[];foreach_vertex(){phi[]=-(d[]+d[-1]+d[0,-1]+d[-1,-1]+d[0,0,-1]+d[-1,0,-1]+d[0,-1,-1]+d[-1,-1,-1])/8.;}fractions(phi,f);foreach(){foreach_dimension(){u.x[]=0.0;}}dump(file=\"dumpInit\");fprintf(ferr,\"Done with initial condition!\\n\");}#endif}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example",
    "content": "event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,KAPPA,u.x,u.y,u.z},(double[]){fErr,KErr,VelErr,VelErr,VelErr},MAXlevel,MINlevel);}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax+tsnap){dump(file=dumpFile);charnameOut[80];sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles-hydrophilic.c | Jumping Bubbles - Code Example",
    "content": "event logWriting(t=0;t+=tsnap2;t<=tmax+tsnap){doubleke=0.;foreach(reduction(+:ke)){ke+=0.5*(sq(u.x[])+sq(u.y[])+sq(u.z[]))*clamp(1.-f[],0.,1.)*cube(Delta);}if(pid()==0){staticFILE*fp;if(i==0){fprintf(ferr,\"i dt t ke\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);}}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles-hydrophilic.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runCasesOpenMPI.sh | Jumping Bubbles",
    "content": "simulationCases/runCasesOpenMPI.sh See raw file runCasesOpenMPI.sh #!/bin/bash CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions -I\\$ ( PWD ) /src-local JumpingBubbles.c -o JumpingBubbles -lm ./JumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/runCasesOpenMPI.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCasesOpenMPI.sh | Jumping Bubbles - Code Example",
    "content": "#!/bin/bashCC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensions-I\\$(PWD)/src-localJumpingBubbles.c-oJumpingBubbles-lm./JumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/runCasesOpenMPI.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runCasesOpenMP.sh | Jumping Bubbles",
    "content": "simulationCases/runCasesOpenMP.sh See raw file runCasesOpenMP.sh #!/bin/bash qcc -O2 -Wall -disable-dimensions -fopenmp -I\\$ ( PWD ) /src-local JumpingBubbles.c -o JumpingBubbles -lm export OMP_NUM_THREADS = 4 ./JumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/runCasesOpenMP.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runCasesOpenMP.sh | Jumping Bubbles - Code Example",
    "content": "#!/bin/bashqcc-O2-Wall-disable-dimensions-fopenmp-I\\$(PWD)/src-localJumpingBubbles.c-oJumpingBubbles-lmexportOMP_NUM_THREADS=4./JumpingBubbles",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/runCasesOpenMP.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Context",
    "content": "simulationCases/JumpingBubbles.c See raw file Jumping Bubbles Simulation A computational fluid dynamics simulation of two bubbles coalescing and jumping off a substrate using Basilisk C. This simulation employs an adaptive octree grid for spatial discretization and models two-phase flow with surface tension effects. Overview The simulation captures the complex physics of bubble coalescence and subsequent jumping behavior. It reads bubble geometry from an STL file and tracks the gas-liquid interface evolution using the Volume-of-Fluid (VOF) method, providing high-fidelity results for studying bubble dynamics on surfaces.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Context",
    "content": "Changelog Version 1.5 (January 5, 2025) Extended support for arbitrary contact angle implementation Enhanced contact angle boundary condition handling Author Information Author : Vatsal Version : 1.5 Date : January 5, 2025 #include \"grid/octree.h\" #include \"navier-stokes/centered.h\" //#define FILTERED #include \"contact-fixed.h\" #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #if !_MPI #include \"distance.h\" #endif #include \"reduced.h\" Configuration Parameters Grid Resolution Control MINlevel : Minimum refinement level for the coarsest grid resolution MAXlevel : Maximum refinement level controlling the finest grid resolution Time Control Parameters tsnap : Time interval between solution snapshots (default: 1e-2) tsnap2 : Time interval for log file outputs (default: 1e-4) Error Tolerances fErr : Error tolerance for VOF field adaptation (default: 1e-3) KErr : Error tolerance for curvature field adaptation (default: 1e-4) VelErr : Error tolerance for velocity field adaptation (default: 1e-4) Physical Properties Mu21 : Viscosity ratio of gas phase to liquid phase (default: 1e-3) Rho21 : Density ratio of gas phase to liquid phase (default: 1e-3) Ldomain : Characteristic length of the simulation domain (default: 4) #define MINlevel 2 64 #define tsnap ( 1e-2 ) 65 #define tsnap2 ( 1e-4 ) 66 #define fErr ( 1e-3 ) 67 #define KErr ( 1e-4 ) 68 #define VelErr ( 1e-4 ) 69 #define hErr ( 1e-3 ) 70 #define Mu21 ( 1.00e-3 ) 71 #define Rho21 ( 1.00e-3 ) 72 #define Ldomain 4 73 74 Boundary Conditions The simulation implements specific boundary conditions at the substrate (bottom boundary): - Tangential velocity component: No-slip condition (u.t = 0) - Radial velocity component: No-penetration condition (u.r = 0) - Face velocities: Enforced to ensure mass conservation - Contact angle: Specified through the contact angle boundary condition u . t [ bottom ] = dirichlet ( 0. ); u . r [ bottom ] = dirichlet ( 0. ); uf . t [ bottom ] = dirichlet ( 0. ); uf . r [ bottom ] = dirichlet ( 0. ); Contact Angle Implementation The contact angle is imposed through a height function vector field that specifies the interface orientation at the substrate boundary. double theta0 , patchR ; vector h []; h . t [ bottom ] = contact_angle ( theta0 * pi / 180. ); h . r [ bottom ] = contact_angle ( theta0 * pi / 180. ); Global Variables Simulation Parameters tmax : Maximum simulation time Oh : Ohnesorge number (\u03b7_l/\u221a(\u03c1_l\u00b7\u03b3\u00b7R_equiv)) MAXlevel : Maximum refinement level theta0 : Contact angle in degrees patchR : Normalized contact patch radius (R_cont/R_equiv) Bo : Bond number (\u03c1_l\u00b7g\u00b7R_equiv\u00b2/\u03b3) double tmax , Oh , Bo ; int MAXlevel ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initializes the simulation parameters and computational domain.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Sets up the...",
    "content": "Sets up the two-phase flow properties including density and viscosity ratios, surface tension, and gravitational effects. Key Parameters Set: Oh : Ohnesorge number controlling viscous effects MAXlevel : Maximum grid refinement level theta0 : Contact angle at the substrate patchR : Size of the contact patch Bo : Bond number for gravitational effects int main () { #if !_MPI tmax = 1e-2 ; #else tmax = 2e0 ; #endif Oh = 0.0066 ; MAXlevel = 8 ; theta0 = 15 ; patchR = 0.184 ; Bo = 0.016 ; init_grid ( 1 << MINlevel ); L0 = Ldomain ; fprintf ( ferr , \"tmax = %g . Oh = %g\\n \" , tmax , Oh ); rho1 = 1.0 ; mu1 = Oh ; rho2 = Rho21 ; mu2 = Mu21 * Oh ; f . height = h ; f . sigma = 1.0 ; G . y = - Bo ; char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); sprintf ( dumpFile , \"restartFile\" ); run (); } Initialization Event Sets up the initial condition for the simulation. This event attempts to restore from a previous dump file if available.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: If no dump...",
    "content": "If no dump file exists, it reads the bubble geometry from an STL file and constructs the initial interface.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Function Definition",
    "content": "Process: First attempts to restore from restartFile If restoration fails, reads InitialCondition.stl Computes distance function from STL geometry Constructs VOF field using the distance function Performs initial mesh adaptation Saves initial condition for verification Notes: MPI version only supports restoration from dump files Non-MPI version can initialize from STL files using the distance function event init ( t = 0 ) { #if _MPI if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else if (! restore ( file = dumpFile )) { char filename [ 60 ]; sprintf ( filename , \"InitialCondition.stl\" ); FILE * fp = fopen ( filename , \"r\" ); if ( fp == NULL ) { fprintf ( ferr , \"There is no file named %s\\n \" , filename ); return 1 ; } coord * p = input_stl ( fp ); fclose ( fp ); coord min , max ; bounding_box ( p , & min , & max ); fprintf ( ferr , \"xmin %g xmax %g\\n ymin %g ymax %g\\n zmin %g zmax %g\\n \" , min . x , max . x , min . y , max . y , min . z , max . z ); fprintf ( ferr , \"x0 = %g , y0 = %g , z0 = %g\\n \" , 0. , - 1.0 , ( min . z + max . z ) / 2. ); origin ( 0. , - 1.0 - 0.025 , ( min . z + max . z ) / 2. ); scalar d []; distance ( d , p ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-6 , 1e-6 * L0 }, MAXlevel ). nf ); vertex scalar phi []; foreach_vertex () { phi [] = -( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ] + d [ 0 , 0 ,- 1 ] + d [- 1 , 0 ,- 1 ] + d [ 0 ,- 1 ,- 1 ] + d [- 1 ,- 1 ,- 1 ]) / 8. ; } fractions ( phi , f ); foreach () { foreach_dimension () { u . x [] = 0.0 ; } } dump ( file = \"dumpInit\" ); fprintf ( ferr , \"Done with initial condition! \\n \" ); } #endif } Adaptive Mesh Refinement Event Performs adaptive mesh refinement at each timestep based on error estimates in various fields.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Function Definition",
    "content": "This ensures computational efficiency while maintaining accuracy in regions of high gradients. Refined Fields: Volume fraction field (f) Velocity components (u.x, u.y, u.z) Height function components (h.x, h.y, h.z) Error Tolerances: Interface tracking: fErr Velocity field: VelErr Height function: hErr event adapt ( i ++) { adapt_wavelet (( scalar *){ f , u . x , u . y , u . z , h . x , h . y , h . z }, ( double []){ fErr , VelErr , VelErr , VelErr , hErr , hErr , hErr }, MAXlevel , MINlevel ); } File Output Event Writes simulation snapshots at regular intervals for post-processing and analysis. Creates both a restart file and timestamped snapshots.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Output Files: restartFile...",
    "content": "Output Files: restartFile : Continuously updated for simulation restart capability intermediate/snapshot-*.dump : Timestamped snapshots for analysis Timing: Triggered at t = 0 and every tsnap interval thereafter Continues until tmax + tsnap to ensure final state capture event writingFiles ( t = 0 ; t += tsnap ; t <= tmax + tsnap ) { dump ( file = dumpFile ); char nameOut [ 80 ]; sprintf ( nameOut , \"intermediate/snapshot- %5.4f \" , t ); dump ( file = nameOut ); } Diagnostic Logging Event Computes and logs diagnostic quantities at fine temporal intervals for monitoring simulation progress and analyzing bubble dynamics.",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles: Logged Quantities: Iteration...",
    "content": "Logged Quantities: Iteration number (i) Timestep size (dt) Simulation time (t) Kinetic energy in the gas phase (ke) Implementation Details: Kinetic energy computed only in gas phase using (1-f) weighting Volume integral performed using cube(Delta) for cell volumes Output written to both stderr and log file for monitoring event logWriting ( t = 0 ; t += tsnap2 ; t <= tmax + tsnap ) { double ke = 0. ; foreach ( reduction (+: ke )) { ke += 0.5 * ( sq ( u . x []) + sq ( u . y []) + sq ( u . z [])) * clamp ( 1. - f [], 0. , 1. ) * cube ( Delta ); } if ( pid () == 0 ) { static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"i dt t ke \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \" %d %g %g %g\\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \" %d %g %g %g\\n \" , i , dt , t , ke ); } }",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - C/C++ Code",
    "content": "#include\"grid/octree.h\"#include\"navier-stokes/centered.h\"//#define FILTERED#include\"contact-fixed.h\"#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#if !_MPI#include\"distance.h\"#endif#include\"reduced.h\"",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "#define MINlevel264#define tsnap(1e-2)65#define tsnap2(1e-4)66#define fErr(1e-3)67#define KErr(1e-4)68#define VelErr(1e-4)69#define hErr(1e-3)70#define Mu21(1.00e-3)71#define Rho21(1.00e-3)72#define Ldomain47374",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "u.t[bottom]=dirichlet(0.);u.r[bottom]=dirichlet(0.);uf.t[bottom]=dirichlet(0.);uf.r[bottom]=dirichlet(0.);",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "doubletheta0,patchR;vector h[];h.t[bottom]=contact_angle(theta0*pi/180.);h.r[bottom]=contact_angle(theta0*pi/180.);",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "doubletmax,Oh,Bo;intMAXlevel;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "intmain(){#if !_MPItmax=1e-2;#elsetmax=2e0;#endifOh=0.0066;MAXlevel=8;theta0=15;patchR=0.184;Bo=0.016;init_grid(1<<MINlevel);L0=Ldomain;fprintf(ferr,\"tmax =%g. Oh =%g\\n\",tmax,Oh);rho1=1.0;mu1=Oh;rho2=Rho21;mu2=Mu21*Oh;f.height=h;f.sigma=1.0;G.y=-Bo;charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);sprintf(dumpFile,\"restartFile\");run();}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example: event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot...",
    "content": "event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#elseif(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"InitialCondition.stl\");FILE*fp=fopen(filename,\"r\");if(fp==NULL){fprintf(ferr,\"There is no file named%s\\n\",filename);return1;}coord*p=input_stl(fp);fclose(fp);coord min,max;bounding_box(p,&min,&max);fprintf(ferr,\"xmin%gxmax%g\\nymin%gymax%g\\nzmin%gzmax%g\\n\",min.x,max.x,min.y,max.y,min.z,max.z);fprintf(ferr,\"x0 =%g, y0 =%g, z0 =%g\\n\",0.,-1.0,(min.z+max.z)/2.);origin(0.,-1.0-0.025,(min.z+max.z)/2.);scalar d[];distance(d,p);while(adapt_wavelet((scalar*){f,d},(double[]){1e-6,1e-6*L0},MAXlevel).nf);vertex scalar phi[];foreach_vertex(){phi[]=-(d[]+d[-1]+d[0,-1]+d[-1,-1]+d[0,0,-1]+d[-1,0,-1]+d[0,-1,-1]+d[-1,-1,-1])/8.;}fractions(phi,f);foreach(){foreach_dimension(){u.x[]=0.0;}}dump(file=\"dumpInit\");fprintf(ferr,\"Done with initial condition!\\n\");}#endif}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "event adapt(i++){adapt_wavelet((scalar*){f,u.x,u.y,u.z,h.x,h.y,h.z},(double[]){fErr,VelErr,VelErr,VelErr,hErr,hErr,hErr},MAXlevel,MINlevel);}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax+tsnap){dump(file=dumpFile);charnameOut[80];sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/JumpingBubbles.c | Jumping Bubbles - Code Example",
    "content": "event logWriting(t=0;t+=tsnap2;t<=tmax+tsnap){doubleke=0.;foreach(reduction(+:ke)){ke+=0.5*(sq(u.x[])+sq(u.y[])+sq(u.z[]))*clamp(1.-f[],0.,1.)*cube(Delta);}if(pid()==0){staticFILE*fp;if(i==0){fprintf(ferr,\"i dt t ke\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d%g%g%g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d%g%g%g\\n\",i,dt,t,ke);}}",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/JumpingBubbles.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/DataFile/retrieveDataFile.sh | Jumping Bubbles",
    "content": "simulationCases/DataFile/retrieveDataFile.sh See raw file retrieveDataFile.sh #!/bin/bash curl -L https://www.dropbox.com/s/b5bg8a4aaw20sm3/InitialCondition.stl ? dl=1 -o InitialCondition.stl",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/DataFile/retrieveDataFile.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/DataFile/retrieveDataFile.sh | Jumping Bubbles - Code Example",
    "content": "#!/bin/bashcurl-Lhttps://www.dropbox.com/s/b5bg8a4aaw20sm3/InitialCondition.stl?dl=1-oInitialCondition.stl",
    "url": "https://comphy-lab.org/JumpingBubbles/simulationCases/DataFile/retrieveDataFile.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files contact-fixed.h This file is used to impose contact angles on boundaries for interfaces described using a [VOF](vof.h) tracer and [he...",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles: Context",
    "content": "src-local/contact-fixed.h See raw file Contact angles This file is used to impose contact angles on boundaries for interfaces described using a VOF tracer and height functions . We first overload the default function used to compute the normal, defined in fractions.h . coord interface_normal ( Point point , scalar c ); #undef interface_normal #define interface_normal ( point , c ) interface_normal ( point , c ) 14 #include \"fractions.h\" #include \"curvature.h\" We will compute the normal using height-functions instead. If this is not possible (typically at low resolutions) we revert back to the Mixed-Youngs-Centered approximation. coord interface_normal ( Point point , scalar c ) { coord n ; if (! c . height . x . i || ( n = height_normal ( point , c , c . height )). x == nodata ) n = mycs ( point , c ); return n ; } The height functions are stored in the vector field associated with each VOF tracer. They need to be updated every time the VOF field changes.",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles: For the centered...",
    "content": "For the centered Navier-Stokes solver , this means after initialisation and after VOF advection. Note that strictly speaking this should be done for each sweep of the direction-split VOF advection, which we do not do here i.e. we use the normal at the beginning of the timestep and assume it is constant during each sweep. This seems to work fine. extern scalar * interfaces ; event init ( i = 0 ) { for ( scalar c in interfaces ) if ( c . height . x . i ) heights ( c , c . height ); } event tracer_advection ( i ++) { for ( scalar c in interfaces ) if ( c . height . x . i ) heights ( c , c . height ); } The macro below can be used to impose a contact angle on a boundary by setting the corresponding tangential component of the height function. Note that the equivalent function for the normal component of the height function is not defined yet.",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles: Function Definition",
    "content": "This limits the range of accessible contact angles, since values of the normal component of the height function will be required to compute curvature at shallow angles. #if dimension == #define contact_angle ( theta ) \\ 72 ( val ( _s ) == nodata ? nodata : val ( _s ) + \\ ( orientation ( val ( _s )) ? - 1. : 1. )/ tan ( theta )) Three-dimensional implementation While the 2D implementation is trivial, in 3D one must take into account the projection onto the boundary of the normal to the interface (see Afkhami & Bussmann, 2009 for details). This leads to the code below, where the only complication comes from taking into account the relative orientations of the boundary and height-function components.",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles: From a user...",
    "content": "From a user point-of-view, using the contact_angle() macro is as simple as in 2D. #else // dimension == #define contact_angle ( theta ) contact_angle_ ( point , neighbor , _s , theta ) 91 foreach_dimension () static double contact_z ( Point point , scalar h , double theta ) { if ( h . i == h . v . z . i ) { fprintf ( stderr , \"contact_angle() cannot be used for ' %s ' which is the normal \\n \" \" component of the height vector \\n \" , h . name ); exit ( 1 ); } if ( h [] == nodata ) return nodata ; foreach_dimension ( 2 ) if ( h . i == h . v . x . i ) foreach_dimension ( 2 ) { coord n = normal2_x ( point , h . v ); if ( n . x != nodata && n . y != nodata ) return h [] + 1. /( tan ( theta )* n . x / sqrt ( sq ( n . x ) + sq ( n . y ))); } return h []; // 90 degree contact angle if the normal is not defined } double contact_angle_ ( Point point , Point neighbor , scalar h , double theta ) { if ( neighbor . i != point . i ) return contact_x ( point , h , theta ); if ( neighbor . j != point . j ) return contact_y ( point , h , theta ); if ( neighbor . k != point . k ) return contact_z ( point , h , theta ); assert ( false ); // not reached return 0. ; } #endif // dimension == References",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles - Function: interface_normal",
    "content": "coord interface_normal(Point point,scalar c);#undef interface_normal#define interface_normal(point,c)interface_normal(point,c)14#include\"fractions.h\"#include\"curvature.h\"",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles - Code Example",
    "content": "coord interface_normal(Point point,scalar c){coord n;if(!c.height.x.i||(n=height_normal(point,c,c.height)).x==nodata)n=mycs(point,c);returnn;}",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles - Code Example",
    "content": "externscalar*interfaces;event init(i=0){for(scalar c in interfaces)if(c.height.x.i)heights(c,c.height);}event tracer_advection(i++){for(scalar c in interfaces)if(c.height.x.i)heights(c,c.height);}",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles - Code Example",
    "content": "#if dimension ==#define contact_angle(theta)\\72(val(_s)==nodata?nodata:val(_s)+\\(orientation(val(_s))?-1.:1.)/tan(theta))",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/contact-fixed.h | Jumping Bubbles - Code Example: #else// dimension ==#define...",
    "content": "#else// dimension ==#define contact_angle(theta)contact_angle_(point,neighbor,_s,theta)91foreach_dimension()staticdoublecontact_z(Point point,scalar h,doubletheta){if(h.i==h.v.z.i){fprintf(stderr,\"contact_angle() cannot be used for '%s' which is the normal\\n\"\"  component of the height vector\\n\",h.name);exit(1);}if(h[]==nodata)returnnodata;foreach_dimension(2)if(h.i==h.v.x.i)foreach_dimension(2){coord n=normal2_x(point,h.v);if(n.x!=nodata&&n.y!=nodata)returnh[]+1./(tan(theta)*n.x/sqrt(sq(n.x)+sq(n.y)));}returnh[];// 90 degree contact angle if the normal is not defined}doublecontact_angle_(Point point,Point neighbor,scalar h,doubletheta){if(neighbor.i!=point.i)returncontact_x(point,h,theta);if(neighbor.j!=point.j)returncontact_y(point,h,theta);if(neighbor.k!=point.k)returncontact_z(point,h,theta);assert(false);// not reachedreturn0.;}#endif// dimension ==",
    "url": "https://comphy-lab.org/JumpingBubbles/src-local/contact-fixed.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations: Context",
    "content": "runParameterSweep.sh See raw file runParameterSweep.sh #!/bin/bash # # runParameterSweep.sh # # Generate a parameter sweep from `sweep.params` (or a custom sweep file) and # run each case sequentially in `simulationCases/<CaseNo>/`. # # ## Usage # `./runParameterSweep.sh [options] [sweep_file]` # # ## Inputs # - `sweep_file`: sweep configuration (default: `sweep.params`) # - `BASE_CONFIG` inside the sweep file (starting parameter set) # # ## Outputs # - Case directories under `simulationCases/` # # ## Related # - `runSimulation.sh` # - `src-local/parse_params.sh` set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [sweep_file] Run parameter sweep with auto-incrementing CaseNo.",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations: Creates case folders...",
    "content": "Creates case folders in simulationCases/<CaseNo>/ for each parameter combination. Cases run sequentially (one at a time). Options: -n, --dry-run Show parameter combinations without running -v, --verbose Verbose output -c, --compile-only Compile only, don't run simulations -m, --mpi Enable MPI parallel execution for all cases --cores N Number of MPI cores (default: 4, requires --mpi) -h, --help Show this help message Parameter sweep file (default): \\$ 0 sweep.params If no sweep file specified, uses sweep.params from current directory. Sweep file format: BASE_CONFIG=default.params CASE_START=1000 CASE_END=1011 SWEEP_We=1.0,10.0,100.0 SWEEP_Ohd=1e-4,1e-3,1e-2 CaseNo auto-increments from CASE_START for each parameter combination.",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations: Examples",
    "content": "Examples: # Run sweep with default file (serial) \\$ 0 # Dry run to see parameter combinations \\$ 0 --dry-run # Run sweep with MPI parallel execution (4 cores per case) \\$ 0 --mpi # Run sweep with 8 cores per case \\$ 0 --mpi --cores 8 # Run custom sweep file \\$ 0 custom_sweep.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ DRY_RUN = 0 VERBOSE = 0 COMPILE_ONLY = 0 MPI_ENABLED = 0 MPI_CORES = 4 while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -c | --compile-only ) COMPILE_ONLY = 1 shift ;; -m | --mpi ) MPI_ENABLED = 1 shift ;; --cores ) MPI_CORES = \" \\$ 2\" if ! [[ \" \\$ MPI_CORES\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ MPI_CORES\" -lt 1 ] ; then echo \"ERROR: --cores requires a positive integer, got: \\$ MPI_CORES\" >& 2 exit 1 fi shift 2 ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Determine Sweep File # ============================================================ SWEEP_FILE = \" \\$ {1:-sweep.params}\" if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"=========================================\" echo \"Drop Impact - Parameter Sweep\" echo \"=========================================\" echo \"Sweep file: \\$ SWEEP_FILE\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: Dry run (no execution)\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ # Create temporary directory for generated parameter files TEMP_DIR = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i.bak \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i.bak \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done (( COMBINATION_COUNT ++ )) # Print summary if [ \\$ DRY_RUN -eq 1 ] || [ \\$ VERBOSE -eq 1 ] ; then echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" fi (( CASE_NUM ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # Exit if dry run if [ \\$ DRY_RUN -eq 1 ] ; then echo \"Dry run complete.",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations: Context",
    "content": "No simulations executed.\" exit 0 fi # ============================================================ # Run Simulations # ============================================================ echo \"=========================================\" echo \"Running Simulations\" echo \"=========================================\" # Build list of parameter files PARAM_FILES = () for case_file in \" \\$ TEMP_DIR\" /case_ * .params ; do PARAM_FILES += ( \" \\$ case_file\" ) done # Build flags to pass to runSimulation.sh RUN_FLAGS = \"\" if [ \\$ COMPILE_ONLY -eq 1 ] ; then RUN_FLAGS = \" \\$ RUN_FLAGS --compile-only\" fi if [ \\$ MPI_ENABLED -eq 1 ] ; then RUN_FLAGS = \" \\$ RUN_FLAGS --mpi --cores \\$ MPI_CORES\" fi # Run simulations sequentially (one at a time) echo \"Running \\$ COMBINATION_COUNT simulations sequentially\" if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Each case will use MPI with \\$ MPI_CORES cores\" fi echo \"\" for param_file in \" \\$ {PARAM_FILES[@]}\" ; do ./runSimulation.sh \\$ RUN_FLAGS \" \\$ param_file\" done echo \"\" echo \"=========================================\" echo \"Parameter Sweep Complete\" echo \"=========================================\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Case range: \\$ CASE_START to \\$ ((CASE_START + COMBINATION_COUNT - 1))\" echo \"Output location: simulationCases/\" echo \"\"",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations - Code Example: Context",
    "content": "#!/bin/bash# # runParameterSweep.sh## Generate a parameter sweep from `sweep.params` (or a custom sweep file) and# run each case sequentially in `simulationCases/<CaseNo>/`.## ## Usage# `./runParameterSweep.sh [options] [sweep_file]`## ## Inputs# - `sweep_file`: sweep configuration (default: `sweep.params`)# - `BASE_CONFIG` inside the sweep file (starting parameter set)## ## Outputs# - Case directories under `simulationCases/`## ## Related# - `runSimulation.sh`# - `src-local/parse_params.sh`set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [sweep_file]Run parameter sweep with auto-incrementing CaseNo.Creates case folders in simulationCases/<CaseNo>/ for each parameter combination.Cases run sequentially (one at a time).Options:-n, --dry-run        Show parameter combinations without running-v, --verbose        Verbose output-c, --compile-only   Compile only, don't run simulations-m, --mpi            Enable MPI parallel execution for all cases--cores N            Number of MPI cores (default: 4, requires --mpi)-h, --help          Show this help messageParameter sweep file (default):\\$0 sweep.paramsIf no sweep file specified, uses sweep.params from current directory.Sweep file format:BASE_CONFIG=default.paramsCASE_START=1000CASE_END=1011SWEEP_We=1.0,10.0,100.0SWEEP_Ohd=1e-4,1e-3,1e-2CaseNo auto-increments from CASE_START for each parameter combination.Examples:# Run sweep with default file (serial)\\$0# Dry run to see parameter combinations\\$0 --dry-run# Run sweep with MPI parallel execution (4 cores per case)\\$0 --mpi# Run sweep with 8 cores per case\\$0 --mpi --cores 8# Run custom sweep file\\$0 custom_sweep.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================DRY_RUN=0VERBOSE=0COMPILE_ONLY=0MPI_ENABLED=0MPI_CORES=4while[[\\$#-gt0]];docase\\$1in-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-c|--compile-only)COMPILE_ONLY=1shift;;-m|--mpi)MPI_ENABLED=1shift;;--cores)MPI_CORES=\"\\$2\"if![[\"\\$MPI_CORES\"=~^[0-9]+\\$]]||[\"\\$MPI_CORES\"-lt1];thenecho\"ERROR: --cores requires a positive integer, got:\\$MPI_CORES\">&2exit1fishift2;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Determine Sweep File# ============================================================SWEEP_FILE=\"\\${1:-sweep.params}\"if[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"=========================================\"echo\"Drop Impact - Parameter Sweep\"echo\"=========================================\"echo\"Sweep file:\\$SWEEP_FILE\"[\\$DRY_RUN-eq1]&&echo\"Mode: Dry run (no execution)\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================# Create temporary directory for generated parameter filesTEMP_DIR=\\$(mktemp-d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i.bak\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i.bak\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"done((COMBINATION_COUNT++))# Print summaryif[\\$DRY_RUN-eq1]||[\\$VERBOSE-eq1];thenecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"fi((CASE_NUM++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# Exit if dry runif[\\$DRY_RUN-eq1];thenecho\"Dry run complete.",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Drop Impact Simulations - Code Example: Context",
    "content": "No simulations executed.\"exit0fi# ============================================================# Run Simulations# ============================================================echo\"=========================================\"echo\"Running Simulations\"echo\"=========================================\"# Build list of parameter filesPARAM_FILES=()forcase_filein\"\\$TEMP_DIR\"/case_*.params;doPARAM_FILES+=(\"\\$case_file\")done# Build flags to pass to runSimulation.shRUN_FLAGS=\"\"if[\\$COMPILE_ONLY-eq1];thenRUN_FLAGS=\"\\$RUN_FLAGS --compile-only\"fiif[\\$MPI_ENABLED-eq1];thenRUN_FLAGS=\"\\$RUN_FLAGS --mpi --cores\\$MPI_CORES\"fi# Run simulations sequentially (one at a time)echo\"Running\\$COMBINATION_COUNT simulations sequentially\"if[\\$MPI_ENABLED-eq1];thenecho\"Each case will use MPI with\\$MPI_CORES cores\"fiecho\"\"forparam_filein\"\\${PARAM_FILES[@]}\";do./runSimulation.sh\\$RUN_FLAGS\"\\$param_file\"doneecho\"\"echo\"=========================================\"echo\"Parameter Sweep Complete\"echo\"=========================================\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Case range:\\$CASE_START to\\$((CASE_START + COMBINATION_COUNT - 1))\"echo\"Output location: simulationCases/\"echo\"\"",
    "url": "https://comphy-lab.org/Drop-Impact/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations: Context",
    "content": "runSweepSnellius.sbatch See raw file runSweepSnellius.sbatch #!/bin/bash #SBATCH --nodes=1 #SBATCH --ntasks=48 #SBATCH --cpus-per-task=1 #SBATCH --time=100:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=vatsal.sanjay@durham.ac.uk #SBATCH --output=slurm-%j.out #SBATCH --error=slurm-%j.err # # runSweepSnellius.sbatch # # Run a parameter sweep on the Snellius HPC system.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations: Each case is...",
    "content": "Each case is compiled # and executed sequentially with MPI using the SLURM allocation. # # ## Usage # `sbatch runSweepSnellius.sbatch` # # ## Inputs # - `sweep.params` (edited before submission) # - `simulationCases/dropImpact.c` # # ## Outputs # - Case directories under `simulationCases/` # - SLURM logs: `slurm-%j.out` and `slurm-%j.err` # # ============================================================ # Drop Impact - HPC Parameter Sweep Runner # ============================================================ # This script runs parameter sweeps on Snellius HPC. # Each case runs sequentially but uses MPI parallelization. # # BEFORE RUNNING: # 1. Edit sweep.params to set parameter ranges and case numbers # 2. Adjust SBATCH parameters above (especially --ntasks, --time) # 3.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepSnellius.sbatch # # SBATCH Parameters to Customize: # --ntasks: Number of MPI tasks per case (currently 192) # --time: Wall time for entire sweep (currently 100 hours) # --partition: Compute partition (currently genoa) # --mail-user: Email for job notifications # ============================================================ set -e # Exit on error (but we'll handle case failures gracefully) set -o pipefail # ============================================================ # Configuration # ============================================================ # Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project root SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Drop Impact - HPC Parameter Sweep\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID}\" echo \"Number of MPI tasks: \\$ {SLURM_NTASKS}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION}\" echo \"\" # ============================================================ # Load Required Modules # ============================================================ echo \"Loading modules...\" module purge module load 2024 module load OpenMPI/5.0.3-GCC-13.3.0 echo \"Modules loaded successfully\" echo \"\" cd \" \\$ SCRIPT_DIR\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" if ! command -v curl &> /dev/null ; then echo \"ERROR: curl not found (required for Basilisk install)\" >& 2 exit 1 fi echo \"Installing Basilisk (ref-locked: v2026-01-13)...\" BASILISK_REF = \"v2026-01-13\" BASILISK_INSTALL_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\" LOCK_FILE = \" \\$ {SCRIPT_DIR}/basilisk/.comphy-lock\" LOCK_REF = \"\" if [ -f \" \\$ LOCK_FILE\" ] ; then LOCK_REF = \" \\$ (awk -F= ' \\$ 1==\" ref \"{print \\$ 2; exit}' \" \\$ LOCK_FILE \" 2>/dev/null || true)\" fi if [ ! -f \" \\$ LOCK_FILE\" ] || [ \" \\$ LOCK_REF\" != \" \\$ BASILISK_REF\" ] ; then echo \"Lock mismatch or missing (found ref=' \\$ {LOCK_REF:-none}') - performing hard install...\" curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" --hard else curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" fi if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ BASILISK\" else echo \"ERROR: .project_config not found\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Check sweep file exists if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" echo \"DEBUG: SCRIPT_DIR = \\$ SCRIPT_DIR\" echo \"DEBUG: Creating temp directory...\" # Create temporary directory for generated parameter files # HPC note: Don't use /tmp - use local work directory instead TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" echo \"DEBUG: TEMP_DIR = \\$ TEMP_DIR\" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } echo \"DEBUG: Temp directory created successfully\" trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () # Recursive function to generate all combinations generate_combinations() { echo \"DEBUG: generate_combinations called with depth= \\$ 1\" >& 2 local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) echo \"DEBUG: depth= \\$ depth, SWEEP_VARS array size= \\$ {#SWEEP_VARS[@]}\" >& 2 if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then echo \"DEBUG: Base case reached, creating case file\" >& 2 # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" echo \"DEBUG: case_file= \\$ case_file\" >& 2 echo \"DEBUG: BASE_CONFIG= \\$ BASE_CONFIG\" >& 2 echo \"DEBUG: Checking if BASE_CONFIG exists...\" >& 2 ls -la \" \\$ BASE_CONFIG\" >& 2 || echo \"DEBUG: BASE_CONFIG file not found!\" >& 2 # Copy base config echo \"DEBUG: Copying base config...\" >& 2 cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" || { echo \"ERROR: Failed to copy \\$ BASE_CONFIG to \\$ case_file\" >& 2 exit 1 } echo \"DEBUG: Copy successful\" >& 2 # Override CaseNo echo \"DEBUG: Overriding CaseNo to \\$ {CASE_NUM}...\" >& 2 if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then echo \"DEBUG: CaseNo found, using sed to replace...\" >& 2 sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" || { echo \"ERROR: sed failed\" >& 2 exit 1 } echo \"DEBUG: sed completed\" >& 2 else echo \"DEBUG: CaseNo not found, appending...\" >& 2 echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi echo \"DEBUG: Removing backup file...\" >& 2 rm -f \" \\$ {case_file}.bak\" echo \"DEBUG: CaseNo override complete\" >& 2 # Override with sweep values echo \"DEBUG: Overriding sweep values...\" >& 2 for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" echo \"DEBUG: Processing var= \\$ var, val= \\$ val\" >& 2 if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then echo \"DEBUG: Found \\$ var in file, replacing with sed...\" >& 2 sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" || { echo \"ERROR: sed failed for \\$ var\" >& 2 exit 1 } echo \"DEBUG: sed completed for \\$ var\" >& 2 else echo \"DEBUG: \\$ var not found, appending...\" >& 2 echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi echo \"DEBUG: Removing backup file for \\$ var...\" >& 2 rm -f \" \\$ {case_file}.bak\" echo \"DEBUG: Completed \\$ var\" >& 2 done echo \"DEBUG: All sweep values overridden\" >& 2 CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true # Print summary echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion echo \"DEBUG: About to start recursion with CASE_START= \\$ CASE_START\" echo \"DEBUG: SWEEP_VARS=( \\$ {SWEEP_VARS[@]})\" echo \"DEBUG: SWEEP_VALUES=( \\$ {SWEEP_VALUES[@]})\" generate_combinations 0 echo \"DEBUG: Recursion completed\" echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Run Simulations # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Simulations\" echo \"=============================================\" echo \"Each case runs with \\$ {SLURM_NTASKS} MPI tasks\" echo \"\" # Counters for tracking SUCCESSFUL_CASES = 0 FAILED_CASES = 0 for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Parse parameter file to get CaseNo parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in \\$ param_file\" >& 2 (( FAILED_CASES ++ )) || true continue fi CASE_DIR = \" \\$ {SCRIPT_DIR}/simulationCases/ \\$ {CASE_NO}\" echo \"=========================================\" echo \"Case \\$ CASE_NO ( \\$ (date))\" echo \"=========================================\" # Create case directory if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"Creating case directory: \\$ CASE_DIR\" mkdir -p \" \\$ CASE_DIR\" else echo \"Case directory exists (will use restart if available)\" fi # Copy parameter file to case directory cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" echo \"Parameter file copied to case directory\" # Copy source file to case directory SRC_FILE_ORIG = \" \\$ {SCRIPT_DIR}/simulationCases/dropImpact.c\" SRC_FILE_LOCAL = \" \\$ CASE_DIR/dropImpact.c\" EXECUTABLE = \" \\$ CASE_DIR/dropImpact\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 (( FAILED_CASES ++ )) || true continue fi cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Source file copied to case directory\" # Change to case directory for compilation cd \" \\$ CASE_DIR\" # Compile with MPI echo \"Compiling with MPI...\" if CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ dropImpact.c -o dropImpact -lm 2 >& 1 ; then echo \"Compilation successful\" else echo \"ERROR: Compilation failed for case \\$ CASE_NO\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi # Check for restart file if [ -f \"restart\" ] ; then echo \"Restart file found - simulation will resume from checkpoint\" fi # Run simulation with srun echo \"Running simulation with \\$ {SLURM_NTASKS} MPI tasks...\" echo \"Command: srun -n \\$ {SLURM_NTASKS} ./dropImpact case.params\" echo \"\" if srun -n \\$ {SLURM_NTASKS} ./dropImpact case.params ; then echo \"\" echo \"Case \\$ CASE_NO completed successfully\" (( SUCCESSFUL_CASES ++ )) || true else EXIT_CODE = \\$ ? echo \"\" echo \"ERROR: Case \\$ CASE_NO failed with exit code \\$ EXIT_CODE\" >& 2 (( FAILED_CASES ++ )) || true fi # Return to root directory cd \" \\$ SCRIPT_DIR\" echo \"\" done # ============================================================ # Final Summary # ============================================================ echo \"=============================================\" echo \"Parameter Sweep Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"Output location: simulationCases/\" echo \"=============================================\" echo \"\" # Exit with error if any cases failed if [ \\$ FAILED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations: Check logs for...",
    "content": "Check logs for details.\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations - Code Example: #!/bin/bash#SBATCH --nodes=1#SBATCH --ntasks=48#SBATCH...",
    "content": "#!/bin/bash#SBATCH --nodes=1#SBATCH --ntasks=48#SBATCH --cpus-per-task=1#SBATCH --time=100:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=vatsal.sanjay@durham.ac.uk#SBATCH --output=slurm-%j.out#SBATCH --error=slurm-%j.err# # runSweepSnellius.sbatch## Run a parameter sweep on the Snellius HPC system.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations - Code Example: Each case is...",
    "content": "Each case is compiled# and executed sequentially with MPI using the SLURM allocation.## ## Usage# `sbatch runSweepSnellius.sbatch`## ## Inputs# - `sweep.params` (edited before submission)# - `simulationCases/dropImpact.c`## ## Outputs# - Case directories under `simulationCases/`# - SLURM logs: `slurm-%j.out` and `slurm-%j.err`## ============================================================# Drop Impact - HPC Parameter Sweep Runner# ============================================================# This script runs parameter sweeps on Snellius HPC.# Each case runs sequentially but uses MPI parallelization.## BEFORE RUNNING:# 1.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations - Code Example: Context",
    "content": "Edit sweep.params to set parameter ranges and case numbers# 2. Adjust SBATCH parameters above (especially --ntasks, --time)# 3.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations - Code Example: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepSnellius.sbatch## SBATCH Parameters to Customize:#   --ntasks: Number of MPI tasks per case (currently 192)#   --time: Wall time for entire sweep (currently 100 hours)#   --partition: Compute partition (currently genoa)#   --mail-user: Email for job notifications# ============================================================set-e# Exit on error (but we'll handle case failures gracefully)set-opipefail# ============================================================# Configuration# ============================================================# Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project rootSCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Drop Impact - HPC Parameter Sweep\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID}\"echo\"Number of MPI tasks:\\${SLURM_NTASKS}\"echo\"Partition:\\${SLURM_JOB_PARTITION}\"echo\"\"# ============================================================# Load Required Modules# ============================================================echo\"Loading modules...\"modulepurgemoduleload 2024moduleload OpenMPI/5.0.3-GCC-13.3.0echo\"Modules loaded successfully\"echo\"\"cd\"\\$SCRIPT_DIR\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"if!command-vcurl&>/dev/null;thenecho\"ERROR: curl not found (required for Basilisk install)\">&2exit1fiecho\"Installing Basilisk (ref-locked: v2026-01-13)...\"BASILISK_REF=\"v2026-01-13\"BASILISK_INSTALL_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\"LOCK_FILE=\"\\${SCRIPT_DIR}/basilisk/.comphy-lock\"LOCK_REF=\"\"if[-f\"\\$LOCK_FILE\"];thenLOCK_REF=\"\\$(awk -F= '\\$1==\"ref\"{print\\$2; exit}' \"\\$LOCK_FILE\" 2>/dev/null || true)\"fiif[!-f\"\\$LOCK_FILE\"]||[\"\\$LOCK_REF\"!=\"\\$BASILISK_REF\"];thenecho\"Lock mismatch or missing (found ref='\\${LOCK_REF:-none}') - performing hard install...\"curl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"--hardelsecurl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"fiif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\$BASILISK\"elseecho\"ERROR: .project_config not found\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Check sweep file existsif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"echo\"DEBUG: SCRIPT_DIR =\\$SCRIPT_DIR\"echo\"DEBUG: Creating temp directory...\"# Create temporary directory for generated parameter files# HPC note: Don't use /tmp - use local work directory insteadTEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"echo\"DEBUG: TEMP_DIR =\\$TEMP_DIR\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}echo\"DEBUG: Temp directory created successfully\"trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()# Recursive function to generate all combinationsgenerate_combinations(){echo\"DEBUG: generate_combinations called with depth=\\$1\">&2localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")echo\"DEBUG: depth=\\$depth, SWEEP_VARS array size=\\${#SWEEP_VARS[@]}\">&2if[\\$depth-eq\\${#SWEEP_VARS[@]}];thenecho\"DEBUG: Base case reached, creating case file\">&2# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"echo\"DEBUG: case_file=\\$case_file\">&2echo\"DEBUG: BASE_CONFIG=\\$BASE_CONFIG\">&2echo\"DEBUG: Checking if BASE_CONFIG exists...\">&2ls-la\"\\$BASE_CONFIG\">&2||echo\"DEBUG: BASE_CONFIG file not found!\">&2# Copy base configecho\"DEBUG: Copying base config...\">&2cp\"\\$BASE_CONFIG\"\"\\$case_file\"||{echo\"ERROR: Failed to copy\\$BASE_CONFIG to\\$case_file\">&2exit1}echo\"DEBUG: Copy successful\">&2# Override CaseNoecho\"DEBUG: Overriding CaseNo to\\${CASE_NUM}...\">&2ifgrep-q\"^CaseNo=\"\"\\$case_file\";thenecho\"DEBUG: CaseNo found, using sed to replace...\">&2sed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"||{echo\"ERROR: sed failed\">&2exit1}echo\"DEBUG: sed completed\">&2elseecho\"DEBUG: CaseNo not found, appending...\">&2echo\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"fiecho\"DEBUG: Removing backup file...\">&2rm-f\"\\${case_file}.bak\"echo\"DEBUG: CaseNo override complete\">&2# Override with sweep valuesecho\"DEBUG: Overriding sweep values...\">&2foriin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"echo\"DEBUG: Processing var=\\$var, val=\\$val\">&2ifgrep-q\"^\\${var}=\"\"\\$case_file\";thenecho\"DEBUG: Found\\$var in file, replacing with sed...\">&2sed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"||{echo\"ERROR: sed failed for\\$var\">&2exit1}echo\"DEBUG: sed completed for\\$var\">&2elseecho\"DEBUG:\\$var not found, appending...\">&2echo\"\\${var}=\\${val}\">>\"\\$case_file\"fiecho\"DEBUG: Removing backup file for\\$var...\">&2rm-f\"\\${case_file}.bak\"echo\"DEBUG: Completed\\$var\">&2doneecho\"DEBUG: All sweep values overridden\">&2CASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||true# Print summaryecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursionecho\"DEBUG: About to start recursion with CASE_START=\\$CASE_START\"echo\"DEBUG: SWEEP_VARS=(\\${SWEEP_VARS[@]})\"echo\"DEBUG: SWEEP_VALUES=(\\${SWEEP_VALUES[@]})\"generate_combinations0echo\"DEBUG: Recursion completed\"echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Run Simulations# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Simulations\"echo\"=============================================\"echo\"Each case runs with\\${SLURM_NTASKS} MPI tasks\"echo\"\"# Counters for trackingSUCCESSFUL_CASES=0FAILED_CASES=0forparam_filein\"\\${CASE_FILES[@]}\";do# Parse parameter file to get CaseNoparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in\\$param_file\">&2((FAILED_CASES++))||truecontinuefiCASE_DIR=\"\\${SCRIPT_DIR}/simulationCases/\\${CASE_NO}\"echo\"=========================================\"echo\"Case\\$CASE_NO (\\$(date))\"echo\"=========================================\"# Create case directoryif[!-d\"\\$CASE_DIR\"];thenecho\"Creating case directory:\\$CASE_DIR\"mkdir-p\"\\$CASE_DIR\"elseecho\"Case directory exists (will use restart if available)\"fi# Copy parameter file to case directorycp\"\\$param_file\"\"\\$CASE_DIR/case.params\"echo\"Parameter file copied to case directory\"# Copy source file to case directorySRC_FILE_ORIG=\"\\${SCRIPT_DIR}/simulationCases/dropImpact.c\"SRC_FILE_LOCAL=\"\\$CASE_DIR/dropImpact.c\"EXECUTABLE=\"\\$CASE_DIR/dropImpact\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2((FAILED_CASES++))||truecontinueficp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Source file copied to case directory\"# Change to case directory for compilationcd\"\\$CASE_DIR\"# Compile with MPIecho\"Compiling with MPI...\"ifCC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\dropImpact.c-odropImpact-lm2>&1;thenecho\"Compilation successful\"elseecho\"ERROR: Compilation failed for case\\$CASE_NO\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefi# Check for restart fileif[-f\"restart\"];thenecho\"Restart file found - simulation will resume from checkpoint\"fi# Run simulation with srunecho\"Running simulation with\\${SLURM_NTASKS} MPI tasks...\"echo\"Command: srun -n\\${SLURM_NTASKS} ./dropImpact case.params\"echo\"\"ifsrun-n\\${SLURM_NTASKS} ./dropImpact case.params;thenecho\"\"echo\"Case\\$CASE_NO completed successfully\"((SUCCESSFUL_CASES++))||trueelseEXIT_CODE=\\$?echo\"\"echo\"ERROR: Case\\$CASE_NO failed with exit code\\$EXIT_CODE\">&2((FAILED_CASES++))||truefi# Return to root directorycd\"\\$SCRIPT_DIR\"echo\"\"done# ============================================================# Final Summary# ============================================================echo\"=============================================\"echo\"Parameter Sweep Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"Output location: simulationCases/\"echo\"=============================================\"echo\"\"# Exit with error if any cases failedif[\\$FAILED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Drop Impact Simulations - Code Example: Check logs for...",
    "content": "Check logs for details.\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations: Drop Impact Simulations...",
    "content": "Drop Impact Simulations Computational fluid dynamics simulations for drop impact studies using the Basilisk C framework. Basilisk (Required) First-time install (or reinstall): curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref = v2026-01-13 --hard Subsequent runs (reuses existing basilisk/ if same ref): curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref = v2026-01-13 Note : Replace v2026-01-13 with the latest release tag . Overview This repository contains axisymmetric two-phase flow simulations with adaptive mesh refinement for studying drop impact phenomena. The simulations use the Volume-of-Fluid (VOF) method to track the interface between the drop and surrounding fluid, with automatic mesh refinement focused on regions of interest.",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations: Methods",
    "content": "Key Features Adaptive Mesh Refinement : Quad/octree-based grids with automatic refinement at interfaces and high-velocity regions Two-Phase Flow : Volume-of-Fluid (VOF) method with surface tension modeling Axisymmetric Formulation : Efficient 2D simulations with cylindrical symmetry Modular Architecture : Separated parameter management, geometry initialization, and diagnostics HPC Ready : MPI parallel execution support for large-scale simulations Case-Based Organization : Automatic folder management with unique case numbers Quick Start Single Simulation # Edit parameters vim default.params # Set CaseNo, We, Oh, etc. # Run simulation (serial) ./runSimulation.sh # Run with MPI (4 cores) ./runSimulation.sh --mpi Parameter Sweep # Configure sweep vim sweep.params # Set CASE_START, CASE_END, sweep variables # Run sweep (serial) ./runParameterSweep.sh # Run sweep with MPI (4 cores per case) ./runParameterSweep.sh --mpi Post-processing # Run post-processing on one or more cases ./runPostProcess-Ncases.sh 1000 1001 # Show available options ./runPostProcess-Ncases.sh --help Repository Structure src-local/ - Modular header files params.h - Parameter structures and parsing geometry.h - Drop geometry and initialization diagnostics.h - Statistics and output handling postProcess/ - Post-processing tools and visualization getData-generic.c - Field extraction on structured grids getFacet.c - Interface geometry extraction getFootPrint.c - Footprint height analysis getFootPrint.py - Multi-cutoff footprint time-series plotFootPrint.py - Publication-quality footprint plots Video-generic.py - Frame-by-frame visualization pipeline simulationCases/ - Case-based simulation outputs dropImpact.c - Main simulation case dropImpact_legacy.c - Legacy simulation source runSnellius_legacy.sbatch - Legacy batch script runSimulation.sh - Single case runner runParameterSweep.sh - Parameter sweep runner runPostProcess-Ncases.sh - Post-process multiple cases runSweepHamilton.sbatch - Hamilton batch script runSweepSnellius.sbatch - Snellius batch script default.params - Single-case configuration sweep.params - Sweep configuration Key Parameters Weber Number (We) : Ratio of inertial to surface tension forces Ohnesorge Numbers (Ohd, Ohs) : Viscous/surface tension ratios for drop and surrounding phases Reynolds Number : Re = \u221aWe/Oh Maximum Refinement Level : Controls mesh resolution (e.g., level 10 = 1024 cells) Domain Size : Computational domain size in drop radii Requirements Basilisk Framework : Install via the ref-locked script above (upstream docs: basilisk.fr ) MPI (optional): For parallel execution macOS: brew install open-mpi Linux: sudo apt-get install libopenmpi-dev References Key Publications Sanjay, V. & Lohse, D. (2025).",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations: Unifying theory of...",
    "content": "Unifying theory of scaling in drop impact: forces and maximum spreading diameter . Physical Review Letters, 134(10), 104003. DOI Comprehensive scaling theory for drop impact forces and maximum spreading Josserand, C. & Thoroddsen, S. T. (2016). Drop impact on a solid surface . Annual Review of Fluid Mechanics, 48, 365-391. DOI Comprehensive review of drop impact phenomena Yarin, A. L. (2006). Drop impact dynamics: Splashing, spreading, receding, bouncing\u2026 . Annual Review of Fluid Mechanics, 38, 159-192. DOI Classical review of drop impact dynamics Documentation This README provides the user-facing overview and usage. Additional details live in the runnable scripts ( runSimulation.sh , runParameterSweep.sh ) and in the simulation source ( simulationCases/dropImpact.c ) and headers in src-local/ . License See LICENSE file for details. Contributing Follow the existing code style and keep changes consistent with the repository\u2019s structure and scripts.",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations: Contact For questions...",
    "content": "Contact For questions or collaboration inquiries, please contact the CoMPhy Lab . Generated Documentation Root Directory default.params runParameterSweep.sh runPostProcess-Ncases.sh runSimulation.sh runSweepHamilton.sbatch runSweepSnellius.sbatch sweep.params postProcess postProcess/Video-generic.py postProcess/getData-generic.c postProcess/getFacet.c postProcess/getFootPrint.c postProcess/getFootPrint.py postProcess/plotFootPrint.py simulationCases simulationCases/dropImpact.c simulationCases/dropImpact_legacy.c simulationCases/runSnellius_legacy.sbatch src-local src-local/diagnostics.h src-local/geometry.h src-local/params.h src-local/parse_params.sh",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "curl-sLhttps://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh|bash-s----ref=v2026-01-13--hard",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "curl-sLhttps://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh|bash-s----ref=v2026-01-13",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "# Edit parametersvimdefault.params# Set CaseNo, We, Oh, etc.",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "# Configure sweepvimsweep.params# Set CASE_START, CASE_END, sweep variables",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "# Run sweep with MPI (4 cores per case)./runParameterSweep.sh--mpi",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "# Run post-processing on one or more cases./runPostProcess-Ncases.sh1000 1001",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Drop Impact Simulations | Drop Impact Simulations - Code Example",
    "content": "# Show available options./runPostProcess-Ncases.sh--help",
    "url": "https://comphy-lab.org/Drop-Impact/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "sweep.params | Drop Impact Simulations: Context",
    "content": "sweep.params See raw file sweep.params # # sweep.params # Parameter sweep configuration for batch simulations. # ============================================================ # Base Configuration # ============================================================ # Start from this parameter file and override sweep variables BASE_CONFIG = default.params # ============================================================ # Case Number Range # ============================================================ # Starting case number (4-digit: 1000-9999) # Each parameter combination gets auto-incremented CaseNo CASE_START = 1306 # Ending case number (inclusive) # Number of combinations should equal CASE_END - CASE_START + 1 # For this sweep: 16 We \u00d7 16 Oh = 256 combinations, so CASE_END = 1561 CASE_END = 1561 # ============================================================ # Sweep Variables # ============================================================ # Format: SWEEP_<variable>=value1,value2,value3,... # The sweep will generate all combinations (cartesian product) # Sweep Weber number (vary impact velocity / surface tension) SWEEP_We = 50,60,70,80,90,100,126,158,200,251,316,398,501,631,794,1000 # Sweep Ohnesorge number (vary viscosity) SWEEP_Ohd = 1e-3,3e-3,1e-2,1.7e-2,2.9e-2,4.9e-2,8.4e-2,1.43e-1,2.43e-1,4.13e-1,7.02e-1,1.19,2.03,3.45,5.87,1e1 # Optional: sweep other parameters # SWEEP_MAXlevel=9,10,11 # SWEEP_Ldomain=6.0,8.0,10.0 # ============================================================ # Output Configuration # ============================================================ # Output folders are created in simulationCases/<CaseNo>/ # CaseNo auto-increments from CASE_START for each parameter combination # Cases run sequentially (one at a time)",
    "url": "https://comphy-lab.org/Drop-Impact/sweep.params.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "sweep.params | Drop Impact Simulations - Code Example: Context",
    "content": "# # sweep.params# Parameter sweep configuration for batch simulations.# ============================================================# Base Configuration# ============================================================# Start from this parameter file and override sweep variablesBASE_CONFIG=default.params# ============================================================# Case Number Range# ============================================================# Starting case number (4-digit: 1000-9999)# Each parameter combination gets auto-incremented CaseNoCASE_START=1306# Ending case number (inclusive)# Number of combinations should equal CASE_END - CASE_START + 1# For this sweep: 16 We \u00d7 16 Oh = 256 combinations, so CASE_END = 1561CASE_END=1561# ============================================================# Sweep Variables# ============================================================# Format: SWEEP_<variable>=value1,value2,value3,...# The sweep will generate all combinations (cartesian product)# Sweep Weber number (vary impact velocity / surface tension)SWEEP_We=50,60,70,80,90,100,126,158,200,251,316,398,501,631,794,1000# Sweep Ohnesorge number (vary viscosity)SWEEP_Ohd=1e-3,3e-3,1e-2,1.7e-2,2.9e-2,4.9e-2,8.4e-2,1.43e-1,2.43e-1,4.13e-1,7.02e-1,1.19,2.03,3.45,5.87,1e1# Optional: sweep other parameters# SWEEP_MAXlevel=9,10,11# SWEEP_Ldomain=6.0,8.0,10.0# ============================================================# Output Configuration# ============================================================# Output folders are created in simulationCases/<CaseNo>/# CaseNo auto-increments from CASE_START for each parameter combination# Cases run sequentially (one at a time)",
    "url": "https://comphy-lab.org/Drop-Impact/sweep.params.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: Context",
    "content": "runSimulation.sh See raw file runSimulation.sh #!/bin/bash # # runSimulation.sh # # Run a single drop impact simulation from the repository root.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: The script #...",
    "content": "The script # creates `simulationCases/<CaseNo>/`, copies the parameter file and source, # compiles the case, and runs it (serial or MPI). # # ## Usage # `./runSimulation.sh [options] [params_file]` # # ## Inputs # - `params_file`: parameter file (default: `default.params`) # - `QCC_FLAGS`: extra `qcc` compiler flags # # ## Outputs # - `simulationCases/<CaseNo>/` containing `case.params`, compiled executable, # and simulation results # # ## Related # - `runParameterSweep.sh` # - `src-local/parse_params.sh` set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source project configuration if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" else echo \"ERROR: .project_config not found\" >& 2 exit 1 fi # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [params_file] Run single drop impact simulation from root directory.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: Creates case folder...",
    "content": "Creates case folder in simulationCases/<CaseNo>/ based on parameter file. Options: -c, --compile-only Compile but don't run simulation -d, --debug Compile with debug flags (-g -DTRASH=1) -m, --mpi Enable MPI parallel execution --cores N Number of MPI cores (default: 4, requires --mpi) -v, --verbose Verbose output -h, --help Show this help message Parameter file mode (default): \\$ 0 default.params If no parameter file specified, uses default.params from current directory.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: Examples",
    "content": "Environment variables: QCC_FLAGS Additional qcc compiler flags Examples: # Run with default parameters (serial) \\$ 0 # Run with MPI parallel execution (4 cores) \\$ 0 --mpi # Run with MPI using 8 cores \\$ 0 --mpi --cores 8 default.params # Compile only (check for errors) \\$ 0 --compile-only # Debug mode with memory checking \\$ 0 --debug default.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ COMPILE_ONLY = 0 DEBUG_FLAGS = \"\" QCC_FLAGS = \" \\$ {QCC_FLAGS:-}\" VERBOSE = 0 MPI_ENABLED = 0 MPI_CORES = 4 while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -c | --compile-only ) COMPILE_ONLY = 1 shift ;; -d | --debug ) DEBUG_FLAGS = \"-g -DTRASH=1\" shift ;; -m | --mpi ) MPI_ENABLED = 1 shift ;; --cores ) MPI_CORES = \" \\$ 2\" if ! [[ \" \\$ MPI_CORES\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ MPI_CORES\" -lt 1 ] ; then echo \"ERROR: --cores requires a positive integer, got: \\$ MPI_CORES\" >& 2 exit 1 fi shift 2 ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Detect OS and Verify MPI # ============================================================ OS_TYPE = \\$ ( uname -s ) # Verify MPI tools if MPI is enabled if [ \\$ MPI_ENABLED -eq 1 ] ; then if ! command -v mpicc &> /dev/null ; then echo \"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi if ! command -v mpirun &> /dev/null ; then echo \"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi fi # ============================================================ # Determine Parameter File # ============================================================ PARAM_FILE = \" \\$ {1:-default.params}\" if [ ! -f \" \\$ PARAM_FILE\" ] ; then echo \"ERROR: Parameter file not found: \\$ PARAM_FILE\" >& 2 exit 1 fi [ \\$ VERBOSE -eq 1 ] && echo \"Parameter file: \\$ PARAM_FILE\" # ============================================================ # Parse Parameters to Get CaseNo # ============================================================ parse_param_file \" \\$ PARAM_FILE\" CASE_NO = \\$ ( get_param \"CaseNo\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in parameter file\" >& 2 exit 1 fi # Validate CaseNo is 4 digits if ! [[ \" \\$ CASE_NO\" =~ ^ [ 0 - 9 ] { 4 } \\$ ]] || [ \" \\$ CASE_NO\" -lt 1000 ] || [ \" \\$ CASE_NO\" -gt 9999 ] ; then echo \"ERROR: CaseNo must be 4-digit (1000-9999), got: \\$ CASE_NO\" >& 2 exit 1 fi CASE_DIR = \"simulationCases/ \\$ {CASE_NO}\" echo \"=========================================\" echo \"Drop Impact Simulation - Single Case\" echo \"=========================================\" echo \"Case Number: \\$ CASE_NO\" echo \"Case Directory: \\$ CASE_DIR\" echo \"Parameter File: \\$ PARAM_FILE\" if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Execution Mode: MPI Parallel ( \\$ MPI_CORES cores)\" else echo \"Execution Mode: Serial\" fi echo \"\" # ============================================================ # Create Case Directory # ============================================================ if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"Creating case directory: \\$ CASE_DIR\" mkdir -p \" \\$ CASE_DIR\" else echo \"Case directory exists (will use restart if available)\" fi # Copy parameter file to case directory for record keeping cp \" \\$ PARAM_FILE\" \" \\$ CASE_DIR/case.params\" # Change to case directory cd \" \\$ CASE_DIR\" [ \\$ VERBOSE -eq 1 ] && echo \"Working directory: \\$ (pwd)\" # ============================================================ # Compilation # ============================================================ SRC_FILE_ORIG = \"../dropImpact.c\" SRC_FILE_LOCAL = \"dropImpact.c\" EXECUTABLE = \"dropImpact\" echo \"\" echo \"=========================================\" echo \"Compilation\" echo \"=========================================\" # Check if source file exists if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 exit 1 fi # Copy source file to case directory for compilation # This avoids qcc issues with relative paths and keeps a record cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Copied source file to case directory\" # Compile echo \"Compiling \\$ SRC_FILE_LOCAL...\" if [ \\$ MPI_ENABLED -eq 1 ] ; then # MPI parallel compilation if [ \" \\$ OS_TYPE\" = \"Darwin\" ] ; then # macOS [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else # Linux [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi else # Serial compilation [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -O2 -Wall -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -O2 -Wall -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi if [ \\$ ? -ne 0 ] ; then echo \"ERROR: Compilation failed\" >& 2 exit 1 fi echo \"Compilation successful: \\$ EXECUTABLE\" # Exit if compile-only mode if [ \\$ COMPILE_ONLY -eq 1 ] ; then echo \"\" echo \"Compile-only mode: Stopping here\" cd ../.. exit 0 fi # ============================================================ # Execution # ============================================================ echo \"\" echo \"=========================================\" echo \"Execution\" echo \"=========================================\" # Use the copied parameter file echo \"Running simulation with case.params\" if [ -f \"restart\" ] ; then echo \"Restart file found - simulation will resume from checkpoint\" fi echo \"\" echo \"Starting simulation...\" echo \"=========================================\" # Run simulation if [ \\$ MPI_ENABLED -eq 1 ] ; then [ \\$ VERBOSE -eq 1 ] && echo \"Command: mpirun -np \\$ MPI_CORES ./dropImpact case.params\" mpirun -np \\$ MPI_CORES ./dropImpact case.params else [ \\$ VERBOSE -eq 1 ] && echo \"Command: ./dropImpact case.params\" ./dropImpact case.params fi EXIT_CODE = \\$ ? echo \"=========================================\" if [ \\$ EXIT_CODE -eq 0 ] ; then echo \"Simulation completed successfully\" echo \"Output location: \\$ CASE_DIR\" else echo \"Simulation failed with exit code \\$ EXIT_CODE\" fi echo \"=========================================\" # Return to root directory cd ../.. exit \\$ EXIT_CODE",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations - Code Example: Context",
    "content": "#!/bin/bash# # runSimulation.sh## Run a single drop impact simulation from the repository root.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations - Code Example: The script# creates...",
    "content": "The script# creates `simulationCases/<CaseNo>/`, copies the parameter file and source,# compiles the case, and runs it (serial or MPI).## ## Usage# `./runSimulation.sh [options] [params_file]`## ## Inputs# - `params_file`: parameter file (default: `default.params`)# - `QCC_FLAGS`: extra `qcc` compiler flags## ## Outputs# - `simulationCases/<CaseNo>/` containing `case.params`, compiled executable,#   and simulation results## ## Related# - `runParameterSweep.sh`# - `src-local/parse_params.sh`set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source project configurationif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"elseecho\"ERROR: .project_config not found\">&2exit1fi# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [params_file]Run single drop impact simulation from root directory.Creates case folder in simulationCases/<CaseNo>/ based on parameter file.Options:-c, --compile-only    Compile but don't run simulation-d, --debug           Compile with debug flags (-g -DTRASH=1)-m, --mpi             Enable MPI parallel execution--cores N             Number of MPI cores (default: 4, requires --mpi)-v, --verbose         Verbose output-h, --help           Show this help messageParameter file mode (default):\\$0 default.paramsIf no parameter file specified, uses default.params from current directory.Environment variables:QCC_FLAGS     Additional qcc compiler flagsExamples:# Run with default parameters (serial)\\$0# Run with MPI parallel execution (4 cores)\\$0 --mpi# Run with MPI using 8 cores\\$0 --mpi --cores 8 default.params# Compile only (check for errors)\\$0 --compile-only# Debug mode with memory checking\\$0 --debug default.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================COMPILE_ONLY=0DEBUG_FLAGS=\"\"QCC_FLAGS=\"\\${QCC_FLAGS:-}\"VERBOSE=0MPI_ENABLED=0MPI_CORES=4while[[\\$#-gt0]];docase\\$1in-c|--compile-only)COMPILE_ONLY=1shift;;-d|--debug)DEBUG_FLAGS=\"-g -DTRASH=1\"shift;;-m|--mpi)MPI_ENABLED=1shift;;--cores)MPI_CORES=\"\\$2\"if![[\"\\$MPI_CORES\"=~^[0-9]+\\$]]||[\"\\$MPI_CORES\"-lt1];thenecho\"ERROR: --cores requires a positive integer, got:\\$MPI_CORES\">&2exit1fishift2;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Detect OS and Verify MPI# ============================================================OS_TYPE=\\$(uname-s)# Verify MPI tools if MPI is enabledif[\\$MPI_ENABLED-eq1];thenif!command-vmpicc&>/dev/null;thenecho\"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations - Code Example: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fiif!command-vmpirun&>/dev/null;thenecho\"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Drop Impact Simulations - Code Example: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fifi# ============================================================# Determine Parameter File# ============================================================PARAM_FILE=\"\\${1:-default.params}\"if[!-f\"\\$PARAM_FILE\"];thenecho\"ERROR: Parameter file not found:\\$PARAM_FILE\">&2exit1fi[\\$VERBOSE-eq1]&&echo\"Parameter file:\\$PARAM_FILE\"# ============================================================# Parse Parameters to Get CaseNo# ============================================================parse_param_file\"\\$PARAM_FILE\"CASE_NO=\\$(get_param\"CaseNo\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in parameter file\">&2exit1fi# Validate CaseNo is 4 digitsif![[\"\\$CASE_NO\"=~^[0-9]{4}\\$]]||[\"\\$CASE_NO\"-lt1000]||[\"\\$CASE_NO\"-gt9999];thenecho\"ERROR: CaseNo must be 4-digit (1000-9999), got:\\$CASE_NO\">&2exit1fiCASE_DIR=\"simulationCases/\\${CASE_NO}\"echo\"=========================================\"echo\"Drop Impact Simulation - Single Case\"echo\"=========================================\"echo\"Case Number:\\$CASE_NO\"echo\"Case Directory:\\$CASE_DIR\"echo\"Parameter File:\\$PARAM_FILE\"if[\\$MPI_ENABLED-eq1];thenecho\"Execution Mode: MPI Parallel (\\$MPI_CORES cores)\"elseecho\"Execution Mode: Serial\"fiecho\"\"# ============================================================# Create Case Directory# ============================================================if[!-d\"\\$CASE_DIR\"];thenecho\"Creating case directory:\\$CASE_DIR\"mkdir-p\"\\$CASE_DIR\"elseecho\"Case directory exists (will use restart if available)\"fi# Copy parameter file to case directory for record keepingcp\"\\$PARAM_FILE\"\"\\$CASE_DIR/case.params\"# Change to case directorycd\"\\$CASE_DIR\"[\\$VERBOSE-eq1]&&echo\"Working directory:\\$(pwd)\"# ============================================================# Compilation# ============================================================SRC_FILE_ORIG=\"../dropImpact.c\"SRC_FILE_LOCAL=\"dropImpact.c\"EXECUTABLE=\"dropImpact\"echo\"\"echo\"=========================================\"echo\"Compilation\"echo\"=========================================\"# Check if source file existsif[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2exit1fi# Copy source file to case directory for compilation# This avoids qcc issues with relative paths and keeps a recordcp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Copied source file to case directory\"# Compileecho\"Compiling\\$SRC_FILE_LOCAL...\"if[\\$MPI_ENABLED-eq1];then# MPI parallel compilationif[\"\\$OS_TYPE\"=\"Darwin\"];then# macOS[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelse# Linux[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfielse# Serial compilation[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -O2 -Wall -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-O2-Wall-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfiif[\\$?-ne0];thenecho\"ERROR: Compilation failed\">&2exit1fiecho\"Compilation successful:\\$EXECUTABLE\"# Exit if compile-only modeif[\\$COMPILE_ONLY-eq1];thenecho\"\"echo\"Compile-only mode: Stopping here\"cd../..exit0fi# ============================================================# Execution# ============================================================echo\"\"echo\"=========================================\"echo\"Execution\"echo\"=========================================\"# Use the copied parameter fileecho\"Running simulation with case.params\"if[-f\"restart\"];thenecho\"Restart file found - simulation will resume from checkpoint\"fiecho\"\"echo\"Starting simulation...\"echo\"=========================================\"# Run simulationif[\\$MPI_ENABLED-eq1];then[\\$VERBOSE-eq1]&&echo\"Command: mpirun -np\\$MPI_CORES ./dropImpact case.params\"mpirun-np\\$MPI_CORES ./dropImpact case.paramselse[\\$VERBOSE-eq1]&&echo\"Command: ./dropImpact case.params\"./dropImpactcase.paramsfiEXIT_CODE=\\$?echo\"=========================================\"if[\\$EXIT_CODE-eq0];thenecho\"Simulation completed successfully\"echo\"Output location:\\$CASE_DIR\"elseecho\"Simulation failed with exit code\\$EXIT_CODE\"fiecho\"=========================================\"# Return to root directorycd../..exit\\$EXIT_CODE",
    "url": "https://comphy-lab.org/Drop-Impact/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations: Context",
    "content": "runSweepHamilton.sbatch See raw file runSweepHamilton.sbatch #!/bin/bash #SBATCH --job-name=dropImpactSweep #SBATCH -N 1 #SBATCH -n 128 #SBATCH -c 1 #SBATCH --mem=240G #SBATCH --time=3-00:00:00 #SBATCH --gres=tmp:100G #SBATCH -p multi #SBATCH --mail-type= END ,FAIL #SBATCH --mail-user=your.email@durham.ac.uk #SBATCH --output=slurm-%j.out #SBATCH --error=slurm-%j.err # # runSweepHamilton.sbatch # # Run a parameter sweep on Durham University's Hamilton HPC system. # Each case is compiled and executed sequentially with MPI. # # ## Usage # `sbatch runSweepHamilton.sbatch` # # ## Inputs # - `sweep.params` (edited before submission) # - `simulationCases/dropImpact.c` # # ## Outputs # - Case directories under `simulationCases/` # - SLURM logs: `slurm-%j.out` and `slurm-%j.err` # # ============================================================ # Drop Impact - HPC Parameter Sweep Runner (Hamilton) # ============================================================ # This script runs Drop Impact parameter sweeps on Durham University's Hamilton HPC. # Each case runs sequentially but uses MPI parallelization. # # BEFORE RUNNING: # 1.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations: Clone repo to...",
    "content": "Clone repo to /nobackup/\\$USER/ (NOT home directory) # 2. Basilisk is installed/verified automatically (ref-locked): # curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref=v2026-01-13 # 3. Edit sweep.params to set parameter ranges and case numbers # 4. Update --mail-user above with your Durham email # 5.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepHamilton.sbatch # # SBATCH Parameters (Hamilton-specific): # -n 128: Number of MPI tasks (whole node = 128 cores) # --mem=240G: Memory per node (max 250G on standard nodes) # --time=3-00:00:00: Max wall time (3 days for multi partition) # --gres=tmp:100G: Temporary disk space (\\$TMPDIR) # -p multi: Partition for whole-node jobs # ============================================================ set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ # Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project root SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR:- \\$ (pwd)}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # Source file to compile inside each case directory SOURCE_FILE_NAME = \"dropImpact.c\" EXECUTABLE_NAME = \" \\$ {SOURCE_FILE_NAME%.c}\" # Number of MPI tasks per case MPI_TASKS = \" \\$ {SLURM_NTASKS:-128}\" # ============================================================ # Validate Working Directory # ============================================================ if [[ ! \" \\$ SCRIPT_DIR\" =~ ^ /nobackup/ ]]; then echo \"WARNING: Running from \\$ SCRIPT_DIR\" echo \" Consider using /nobackup/ \\\\ $USER / for better performance\" echo \" Home directory has only 10GB quota and is slower\" echo \"\" fi cd \" \\$ SCRIPT_DIR\" # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Drop Impact - HPC Parameter Sweep\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID:-unknown}\" echo \"Number of MPI tasks: \\$ {MPI_TASKS}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION:-unknown}\" echo \"Memory allocated: \\$ {SLURM_MEM_PER_NODE:-unknown}MB\" echo \"TMPDIR: \\$ {TMPDIR:-not set}\" echo \"\" # ============================================================ # Load Required Modules # ============================================================ echo \"Loading modules...\" module purge module load gcc module load openmpi echo \"Modules loaded successfully\" echo \"\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" if ! command -v curl &> /dev/null ; then echo \"ERROR: curl not found (required for Basilisk install)\" >& 2 exit 1 fi echo \"Installing Basilisk (ref-locked: v2026-01-13)...\" BASILISK_REF = \"v2026-01-13\" BASILISK_INSTALL_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\" LOCK_FILE = \" \\$ {SCRIPT_DIR}/basilisk/.comphy-lock\" LOCK_REF = \"\" if [ -f \" \\$ LOCK_FILE\" ] ; then LOCK_REF = \" \\$ (awk -F= ' \\$ 1==\" ref \"{print \\$ 2; exit}' \" \\$ LOCK_FILE \" 2>/dev/null || true)\" fi if [ ! -f \" \\$ LOCK_FILE\" ] || [ \" \\$ LOCK_REF\" != \" \\$ BASILISK_REF\" ] ; then echo \"Lock mismatch or missing (found ref=' \\$ {LOCK_REF:-none}') - performing hard install...\" curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" --hard else curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" fi if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ {BASILISK:-unset}\" else echo \"ERROR: .project_config not found after Basilisk install\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Check sweep file exists if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ {BASE_CONFIG:-}\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ {CASE_START:-}\" ] || [ -z \" \\$ {CASE_END:-}\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" # Create temporary directory for generated parameter files # Use work directory, not /tmp (node-local on Hamilton) TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } trap 'rm -rf \"\\$TEMP_DIR\"' EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \" \\$ depth\" -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \" \\$ CASE_NUM \").params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true # Print summary echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Run Simulations # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Simulations\" echo \"=============================================\" echo \"Each case runs with \\$ {MPI_TASKS} MPI tasks\" echo \"\" # Counters for tracking SUCCESSFUL_CASES = 0 FAILED_CASES = 0 for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Parse parameter file to get CaseNo if compgen -v PARAM_ > /dev/null ; then unset \" \\$ {!PARAM_@}\" fi parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in \\$ param_file\" >& 2 (( FAILED_CASES ++ )) || true continue fi CASE_DIR = \" \\$ {SCRIPT_DIR}/simulationCases/ \\$ {CASE_NO}\" echo \"=========================================\" echo \"Case \\$ CASE_NO ( \\$ (date))\" echo \"=========================================\" # Create case directory if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"Creating case directory: \\$ CASE_DIR\" mkdir -p \" \\$ CASE_DIR\" else echo \"Case directory exists (will use restart if available)\" fi # Copy parameter file to case directory cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" echo \"Parameter file copied to case directory\" # Copy source file to case directory if needed SRC_FILE_ORIG = \" \\$ {SCRIPT_DIR}/simulationCases/ \\$ {SOURCE_FILE_NAME}\" SRC_FILE_LOCAL = \" \\$ CASE_DIR/ \\$ SOURCE_FILE_NAME\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 (( FAILED_CASES ++ )) || true continue fi cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Source file copied to case directory\" # Change to case directory cd \" \\$ CASE_DIR\" # ============================================================ # Compile + Run (MPI) # ============================================================ echo \"Compiling with MPI...\" if CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \" \\$ SOURCE_FILE_NAME\" -o \" \\$ EXECUTABLE_NAME\" -lm 2 >& 1 ; then echo \"Compilation successful\" else echo \"ERROR: Compilation failed for case \\$ CASE_NO\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi if [ -f \"restart\" ] ; then echo \"Restart file found - simulation will resume from checkpoint\" fi # Run simulation with mpirun (Hamilton uses mpirun, not srun) echo \"Running simulation with \\$ {MPI_TASKS} MPI tasks...\" echo \"Command: mpirun -np \\$ {MPI_TASKS} ./ \\$ EXECUTABLE_NAME case.params\" echo \"\" if mpirun -np \" \\$ {MPI_TASKS}\" ./ \" \\$ EXECUTABLE_NAME\" case.params ; then echo \"\" echo \"Case \\$ CASE_NO completed successfully\" (( SUCCESSFUL_CASES ++ )) || true else EXIT_CODE = \\$ ? echo \"\" echo \"ERROR: Case \\$ CASE_NO failed with exit code \\$ EXIT_CODE\" >& 2 (( FAILED_CASES ++ )) || true fi # Return to root directory cd \" \\$ SCRIPT_DIR\" echo \"\" done # ============================================================ # Final Summary # ============================================================ echo \"=============================================\" echo \"Parameter Sweep Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"Output location: simulationCases/\" echo \"=============================================\" echo \"\" # Exit with error if any cases failed if [ \\$ FAILED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations: Check logs for...",
    "content": "Check logs for details.\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations - Code Example: #!/bin/bash#SBATCH --job-name=dropImpactSweep#SBATCH -N...",
    "content": "#!/bin/bash#SBATCH --job-name=dropImpactSweep#SBATCH -N 1#SBATCH -n 128#SBATCH -c 1#SBATCH --mem=240G#SBATCH --time=3-00:00:00#SBATCH --gres=tmp:100G#SBATCH -p multi#SBATCH --mail-type=END,FAIL#SBATCH --mail-user=your.email@durham.ac.uk#SBATCH --output=slurm-%j.out#SBATCH --error=slurm-%j.err# # runSweepHamilton.sbatch## Run a parameter sweep on Durham University's Hamilton HPC system.# Each case is compiled and executed sequentially with MPI.## ## Usage# `sbatch runSweepHamilton.sbatch`## ## Inputs# - `sweep.params` (edited before submission)# - `simulationCases/dropImpact.c`## ## Outputs# - Case directories under `simulationCases/`# - SLURM logs: `slurm-%j.out` and `slurm-%j.err`## ============================================================# Drop Impact - HPC Parameter Sweep Runner (Hamilton)# ============================================================# This script runs Drop Impact parameter sweeps on Durham University's Hamilton HPC.# Each case runs sequentially but uses MPI parallelization.## BEFORE RUNNING:# 1.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations - Code Example: Clone repo to...",
    "content": "Clone repo to /nobackup/\\$USER/ (NOT home directory)# 2. Basilisk is installed/verified automatically (ref-locked):#    curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref=v2026-01-13# 3. Edit sweep.params to set parameter ranges and case numbers# 4. Update --mail-user above with your Durham email# 5.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations - Code Example: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepHamilton.sbatch## SBATCH Parameters (Hamilton-specific):#   -n 128: Number of MPI tasks (whole node = 128 cores)#   --mem=240G: Memory per node (max 250G on standard nodes)#   --time=3-00:00:00: Max wall time (3 days for multi partition)#   --gres=tmp:100G: Temporary disk space (\\$TMPDIR)#   -p multi: Partition for whole-node jobs# ============================================================set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================# Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project rootSCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR:-\\$(pwd)}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# Source file to compile inside each case directorySOURCE_FILE_NAME=\"dropImpact.c\"EXECUTABLE_NAME=\"\\${SOURCE_FILE_NAME%.c}\"# Number of MPI tasks per caseMPI_TASKS=\"\\${SLURM_NTASKS:-128}\"# ============================================================# Validate Working Directory# ============================================================if[[!\"\\$SCRIPT_DIR\"=~^/nobackup/]];thenecho\"WARNING: Running from\\$SCRIPT_DIR\"echo\"         Consider using /nobackup/\\\\$USER/ for better performance\"echo\"         Home directory has only 10GB quota and is slower\"echo\"\"ficd\"\\$SCRIPT_DIR\"# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Drop Impact - HPC Parameter Sweep\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID:-unknown}\"echo\"Number of MPI tasks:\\${MPI_TASKS}\"echo\"Partition:\\${SLURM_JOB_PARTITION:-unknown}\"echo\"Memory allocated:\\${SLURM_MEM_PER_NODE:-unknown}MB\"echo\"TMPDIR:\\${TMPDIR:-not set}\"echo\"\"# ============================================================# Load Required Modules# ============================================================echo\"Loading modules...\"modulepurgemoduleload gccmoduleload openmpiecho\"Modules loaded successfully\"echo\"\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"if!command-vcurl&>/dev/null;thenecho\"ERROR: curl not found (required for Basilisk install)\">&2exit1fiecho\"Installing Basilisk (ref-locked: v2026-01-13)...\"BASILISK_REF=\"v2026-01-13\"BASILISK_INSTALL_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\"LOCK_FILE=\"\\${SCRIPT_DIR}/basilisk/.comphy-lock\"LOCK_REF=\"\"if[-f\"\\$LOCK_FILE\"];thenLOCK_REF=\"\\$(awk -F= '\\$1==\"ref\"{print\\$2; exit}' \"\\$LOCK_FILE\" 2>/dev/null || true)\"fiif[!-f\"\\$LOCK_FILE\"]||[\"\\$LOCK_REF\"!=\"\\$BASILISK_REF\"];thenecho\"Lock mismatch or missing (found ref='\\${LOCK_REF:-none}') - performing hard install...\"curl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"--hardelsecurl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"fiif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\${BASILISK:-unset}\"elseecho\"ERROR: .project_config not found after Basilisk install\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Check sweep file existsif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\${BASE_CONFIG:-}\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\${CASE_START:-}\"]||[-z\"\\${CASE_END:-}\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"# Create temporary directory for generated parameter files# Use work directory, not /tmp (node-local on Hamilton)TEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}trap'rm -rf \"\\$TEMP_DIR\"'EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\"\\$depth\"-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\" \"\\$CASE_NUM\").params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneCASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||true# Print summaryecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Run Simulations# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Simulations\"echo\"=============================================\"echo\"Each case runs with\\${MPI_TASKS} MPI tasks\"echo\"\"# Counters for trackingSUCCESSFUL_CASES=0FAILED_CASES=0forparam_filein\"\\${CASE_FILES[@]}\";do# Parse parameter file to get CaseNoifcompgen-vPARAM_>/dev/null;thenunset\"\\${!PARAM_@}\"fiparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in\\$param_file\">&2((FAILED_CASES++))||truecontinuefiCASE_DIR=\"\\${SCRIPT_DIR}/simulationCases/\\${CASE_NO}\"echo\"=========================================\"echo\"Case\\$CASE_NO (\\$(date))\"echo\"=========================================\"# Create case directoryif[!-d\"\\$CASE_DIR\"];thenecho\"Creating case directory:\\$CASE_DIR\"mkdir-p\"\\$CASE_DIR\"elseecho\"Case directory exists (will use restart if available)\"fi# Copy parameter file to case directorycp\"\\$param_file\"\"\\$CASE_DIR/case.params\"echo\"Parameter file copied to case directory\"# Copy source file to case directory if neededSRC_FILE_ORIG=\"\\${SCRIPT_DIR}/simulationCases/\\${SOURCE_FILE_NAME}\"SRC_FILE_LOCAL=\"\\$CASE_DIR/\\$SOURCE_FILE_NAME\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2((FAILED_CASES++))||truecontinueficp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Source file copied to case directory\"# Change to case directorycd\"\\$CASE_DIR\"# ============================================================# Compile + Run (MPI)# ============================================================echo\"Compiling with MPI...\"ifCC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\"\\$SOURCE_FILE_NAME\"-o\"\\$EXECUTABLE_NAME\"-lm2>&1;thenecho\"Compilation successful\"elseecho\"ERROR: Compilation failed for case\\$CASE_NO\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefiif[-f\"restart\"];thenecho\"Restart file found - simulation will resume from checkpoint\"fi# Run simulation with mpirun (Hamilton uses mpirun, not srun)echo\"Running simulation with\\${MPI_TASKS} MPI tasks...\"echo\"Command: mpirun -np\\${MPI_TASKS} ./\\$EXECUTABLE_NAME case.params\"echo\"\"ifmpirun-np\"\\${MPI_TASKS}\"./\"\\$EXECUTABLE_NAME\"case.params;thenecho\"\"echo\"Case\\$CASE_NO completed successfully\"((SUCCESSFUL_CASES++))||trueelseEXIT_CODE=\\$?echo\"\"echo\"ERROR: Case\\$CASE_NO failed with exit code\\$EXIT_CODE\">&2((FAILED_CASES++))||truefi# Return to root directorycd\"\\$SCRIPT_DIR\"echo\"\"done# ============================================================# Final Summary# ============================================================echo\"=============================================\"echo\"Parameter Sweep Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"Output location: simulationCases/\"echo\"=============================================\"echo\"\"# Exit with error if any cases failedif[\\$FAILED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Drop Impact Simulations - Code Example: Check logs for...",
    "content": "Check logs for details.\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Drop-Impact/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "default.params | Drop Impact Simulations: Context",
    "content": "default.params See raw file default.params # # default.params # Default parameter set for drop impact simulations. # Format: key=value (one per line, # for comments). # This file provides a typical water-air drop impact configuration. # ============================================================ # Case Identification # ============================================================ # Case number for folder naming (4-digit: 1000-9999) # Output will be created in simulationCases/<CaseNo>/ CaseNo = 1000 # ============================================================ # Physical Parameters (Dimensionless Numbers) # ============================================================ # Weber number: We = \u03c1U\u00b2R/\u03c3 (inertia vs surface tension) We = 10.0 # Ohnesorge number (drop): Oh = \u03bc/\u221a(\u03c1\u03c3R) (viscous vs surface tension) Ohd = 1.0e-2 # Ohnesorge number (surrounding gas) Ohs = 1.0e-5 # Density ratio: \u03c1_gas/\u03c1_drop (air-water \u2248 1e-3) rho_ratio = 1.0e-3 # Computed Reynolds number: Re = \u221aWe/Oh \u2248 100 # ============================================================ # Geometry Configuration # ============================================================ # Domain size in drop radii (must be >> drop radius to avoid boundary effects) Ldomain = 8.0 # Initial drop center position (radial coordinate, in drop radii) # Should be > 0 to avoid axis, and > drop_radius to avoid overlap with surface drop_x = 1.05 # Initial drop center position (axial coordinate, height above surface) # Set to drop_radius for drop just touching surface at t=0 drop_y = 0.0 # Drop radius (normalized, typically 1.0) drop_radius = 1.0 # Initial impact velocity (negative = downward toward surface) # Magnitude of 1.0 corresponds to unit Weber number scaling impact_velocity = - 1.0 # ============================================================ # Numerical Parameters (Mesh Adaptation) # ============================================================ # Maximum refinement level (2^MAXlevel cells at finest resolution) # Level 10 \u2192 1024 cells, Level 11 \u2192 2048 cells, etc. # Higher = more accurate but slower MAXlevel = 14 # Minimum refinement level (coarsest allowed) # Typically 4-5 for axisymmetric simulations MINlevel = 6 # Initial grid level (before adaptation) # Start coarse, adaptation will refine where needed init_grid_level = 6 # VOF field error tolerance # Controls interface resolution (smaller = finer mesh at interface) fErr = 1.0e-3 # Curvature error tolerance # Important for surface tension accuracy KErr = 1.0e-4 # Velocity error tolerance # Controls resolution of flow features VelErr = 1.0e-2 # ============================================================ # Time Control # ============================================================ # Maximum simulation time in CONVECTIVE TIME UNITS # Actual simulation: tmax_sim = tmax * sqrt(We) # # Physical basis: Convective timescale \u03c4_c = R/U ~ sqrt(We) in normalized units # Example: tmax=1, We=10 \u2192 simulation runs until t \u2248 3.16 # tmax = 1e0 # Snapshot interval for dump files # Balance between temporal resolution and storage tsnap = 0.01 # ============================================================ # Output Configuration # ============================================================ # Output directory name # Will be created if it doesn't exist output_dir = results # Statistics logging interval (iterations) # Write log entry every N timesteps (1 = every step) log_interval = 1 # ============================================================ # Advanced: Outflow Boundary Control # ============================================================ # Unrefine mesh if x > outflow_x_max (in drop radii) # Prevents wasted resolution far from drop outflow_x_max = 4.0 # Unrefine mesh if y > outflow_y_max (in drop radii) # Far-field boundary where solution should be simple outflow_y_max = 8.0",
    "url": "https://comphy-lab.org/Drop-Impact/default.params.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "default.params | Drop Impact Simulations - Code Example: Context",
    "content": "# # default.params# Default parameter set for drop impact simulations.# Format: key=value (one per line, # for comments).# This file provides a typical water-air drop impact configuration.# ============================================================# Case Identification# ============================================================# Case number for folder naming (4-digit: 1000-9999)# Output will be created in simulationCases/<CaseNo>/CaseNo=1000# ============================================================# Physical Parameters (Dimensionless Numbers)# ============================================================# Weber number: We = \u03c1U\u00b2R/\u03c3 (inertia vs surface tension)We=10.0# Ohnesorge number (drop): Oh = \u03bc/\u221a(\u03c1\u03c3R) (viscous vs surface tension)Ohd=1.0e-2# Ohnesorge number (surrounding gas)Ohs=1.0e-5# Density ratio: \u03c1_gas/\u03c1_drop (air-water \u2248 1e-3)rho_ratio=1.0e-3# Computed Reynolds number: Re = \u221aWe/Oh \u2248 100# ============================================================# Geometry Configuration# ============================================================# Domain size in drop radii (must be >> drop radius to avoid boundary effects)Ldomain=8.0# Initial drop center position (radial coordinate, in drop radii)# Should be > 0 to avoid axis, and > drop_radius to avoid overlap with surfacedrop_x=1.05# Initial drop center position (axial coordinate, height above surface)# Set to drop_radius for drop just touching surface at t=0drop_y=0.0# Drop radius (normalized, typically 1.0)drop_radius=1.0# Initial impact velocity (negative = downward toward surface)# Magnitude of 1.0 corresponds to unit Weber number scalingimpact_velocity=-1.0# ============================================================# Numerical Parameters (Mesh Adaptation)# ============================================================# Maximum refinement level (2^MAXlevel cells at finest resolution)# Level 10 \u2192 1024 cells, Level 11 \u2192 2048 cells, etc.# Higher = more accurate but slowerMAXlevel=14# Minimum refinement level (coarsest allowed)# Typically 4-5 for axisymmetric simulationsMINlevel=6# Initial grid level (before adaptation)# Start coarse, adaptation will refine where neededinit_grid_level=6# VOF field error tolerance# Controls interface resolution (smaller = finer mesh at interface)fErr=1.0e-3# Curvature error tolerance# Important for surface tension accuracyKErr=1.0e-4# Velocity error tolerance# Controls resolution of flow featuresVelErr=1.0e-2# ============================================================# Time Control# ============================================================# Maximum simulation time in CONVECTIVE TIME UNITS# Actual simulation: tmax_sim = tmax * sqrt(We)## Physical basis: Convective timescale \u03c4_c = R/U ~ sqrt(We) in normalized units# Example: tmax=1, We=10 \u2192 simulation runs until t \u2248 3.16#tmax=1e0# Snapshot interval for dump files# Balance between temporal resolution and storagetsnap=0.01# ============================================================# Output Configuration# ============================================================# Output directory name# Will be created if it doesn't existoutput_dir=results# Statistics logging interval (iterations)# Write log entry every N timesteps (1 = every step)log_interval=1# ============================================================# Advanced: Outflow Boundary Control# ============================================================# Unrefine mesh if x > outflow_x_max (in drop radii)# Prevents wasted resolution far from dropoutflow_x_max=4.0# Unrefine mesh if y > outflow_y_max (in drop radii)# Far-field boundary where solution should be simpleoutflow_y_max=8.0",
    "url": "https://comphy-lab.org/Drop-Impact/default.params.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Drop Impact Simulations: Context",
    "content": "runPostProcess-Ncases.sh See raw file runPostProcess-Ncases.sh #!/bin/bash # # runPostProcess-Ncases.sh # # Run the post-processing pipeline on multiple simulation cases: # `Video-generic.py` -> `getFootPrint.py` -> `plotFootPrint.py`. # # ## Usage # `./runPostProcess-Ncases.sh [options] CASE_NO [CASE_NO ...]` # # ## Inputs # - Case directories under `simulationCases/<CaseNo>/results` # - Compiled helpers: `postProcess/getFacet`, `postProcess/getData-generic`, # `postProcess/getFootPrint` (depending on which steps are enabled) # # ## Outputs # - `results/Video/` frames # - `results/rFootvsTime_*.csv` footprint data # - `results/footprint_evolution.pdf` plot # # ## Author # Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) # CoMPhy Lab, Durham University # Last updated: Dec 2025 set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Post-processing script paths VIDEO_SCRIPT = \" \\$ {SCRIPT_DIR}/postProcess/Video-generic.py\" FOOTPRINT_SCRIPT = \" \\$ {SCRIPT_DIR}/postProcess/getFootPrint.py\" PLOT_SCRIPT = \" \\$ {SCRIPT_DIR}/postProcess/plotFootPrint.py\" # C helper executables HELPER_GETFACET = \" \\$ {SCRIPT_DIR}/postProcess/getFacet\" HELPER_GETDATA = \" \\$ {SCRIPT_DIR}/postProcess/getData-generic\" HELPER_GETFOOTPRINT = \" \\$ {SCRIPT_DIR}/postProcess/getFootPrint\" # Case directory root CASES_DIR = \" \\$ {SCRIPT_DIR}/simulationCases\" # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] CASE_NO [CASE_NO ...] Run post-processing pipeline on multiple simulation cases.",
    "url": "https://comphy-lab.org/Drop-Impact/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Drop Impact Simulations: For each case,...",
    "content": "For each case, executes: Video-generic.py \u2192 getFootPrint.py \u2192 plotFootPrint.py Options: --CPUs N Number of parallel workers (default: 4) --nGFS N Number of snapshots to process (default: 4000) --tsnap F Time interval between snapshots (default: 0.01) --GridsPerR N Radial grid resolution for video (default: 256) --ZMAX F Maximum Z value for video (default: 4.0) --RMAX F Maximum R value for video (default: 4.0) --ZMIN F Minimum Z value for video (default: 0.0) --skip-video Skip Video-generic.py (frame generation) --skip-footprint Skip getFootPrint.py (footprint extraction) --skip-plot Skip plotFootPrint.py (PDF generation) -n, --dry-run Show what would run without executing -v, --verbose Verbose output -h, --help Show this help message Arguments: CASE_NO 4-digit case numbers (1000-9999) Examples: # Process multiple cases with default settings \\$ 0 1000 1001 1002 1003 1004 1005 1006 # Process with more CPUs and fewer snapshots \\$ 0 --CPUs 8 --nGFS 500 1000 1001 # Skip video generation (faster processing) \\$ 0 --skip-video 1000 1001 1002 # Only generate footprint plots (skip video and extraction) \\$ 0 --skip-video --skip-footprint 1000 1001 # Dry run to preview commands \\$ 0 --dry-run 1000 1001 Output locations: simulationCases/<CaseNo>/results/Video/ # PNG frames simulationCases/<CaseNo>/results/rFootvsTime_*.csv # Footprint data simulationCases/<CaseNo>/results/footprint_evolution.pdf # Plot For more information, see CLAUDE.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ CPUS = 4 NGFS = 4000 TSNAP = 0.01 GRIDS_PER_R = 256 ZMAX = 4.0 RMAX = 4.0 ZMIN = 0.0 SKIP_VIDEO = 0 SKIP_FOOTPRINT = 0 SKIP_PLOT = 0 DRY_RUN = 0 VERBOSE = 0 CASE_NUMBERS = () while [[ \\$ # -gt 0 ]]; do case \\$ 1 in --CPUs ) CPUS = \" \\$ 2\" if ! [[ \" \\$ CPUS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ CPUS\" -lt 1 ] ; then echo \"ERROR: --CPUs requires a positive integer, got: \\$ CPUS\" >& 2 exit 1 fi shift 2 ;; --nGFS ) NGFS = \" \\$ 2\" if ! [[ \" \\$ NGFS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ NGFS\" -lt 1 ] ; then echo \"ERROR: --nGFS requires a positive integer, got: \\$ NGFS\" >& 2 exit 1 fi shift 2 ;; --tsnap ) TSNAP = \" \\$ 2\" shift 2 ;; --GridsPerR ) GRIDS_PER_R = \" \\$ 2\" if ! [[ \" \\$ GRIDS_PER_R\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ GRIDS_PER_R\" -lt 1 ] ; then echo \"ERROR: --GridsPerR requires a positive integer, got: \\$ GRIDS_PER_R\" >& 2 exit 1 fi shift 2 ;; --ZMAX ) ZMAX = \" \\$ 2\" shift 2 ;; --RMAX ) RMAX = \" \\$ 2\" shift 2 ;; --ZMIN ) ZMIN = \" \\$ 2\" shift 2 ;; --skip-video ) SKIP_VIDEO = 1 shift ;; --skip-footprint ) SKIP_FOOTPRINT = 1 shift ;; --skip-plot ) SKIP_PLOT = 1 shift ;; -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) # Collect case numbers CASE_NUMBERS += ( \" \\$ 1\" ) shift ;; esac done # ============================================================ # Validation # ============================================================ # Check at least one case number provided if [ \\$ {#CASE_NUMBERS[@]} -eq 0 ] ; then echo \"ERROR: No case numbers provided\" >& 2 usage exit 1 fi # Validate case numbers are 4-digit for case_no in \" \\$ {CASE_NUMBERS[@]}\" ; do if ! [[ \" \\$ case_no\" =~ ^ [ 0 - 9 ] { 4 } \\$ ]]; then echo \"ERROR: Case number must be 4 digits (1000-9999), got: \\$ case_no\" >& 2 exit 1 fi if [ \" \\$ case_no\" -lt 1000 ] || [ \" \\$ case_no\" -gt 9999 ] ; then echo \"ERROR: Case number out of range (1000-9999), got: \\$ case_no\" >& 2 exit 1 fi done # Check if all processing steps are skipped if [ \\$ SKIP_VIDEO -eq 1 ] && [ \\$ SKIP_FOOTPRINT -eq 1 ] && [ \\$ SKIP_PLOT -eq 1 ] ; then echo \"ERROR: All processing steps are skipped (--skip-video, --skip-footprint, --skip-plot)\" >& 2 echo \" At least one processing step must be enabled.\" >& 2 exit 1 fi # Check Python availability if ! command -v python &> /dev/null ; then echo \"ERROR: python not found in PATH\" >& 2 exit 1 fi # Check Python scripts exist for script in \" \\$ VIDEO_SCRIPT\" \" \\$ FOOTPRINT_SCRIPT\" \" \\$ PLOT_SCRIPT\" ; do if [ ! -f \" \\$ script\" ] ; then echo \"ERROR: Python script not found: \\$ script\" >& 2 exit 1 fi done # Check C helpers exist (only if needed) if [ \\$ SKIP_VIDEO -eq 0 ] ; then if [ ! -x \" \\$ HELPER_GETFACET\" ] ; then echo \"ERROR: Compiled helper not found or not executable: \\$ HELPER_GETFACET\" >& 2 echo \" Compile with: qcc -autolink postProcess/getFacet.c -o postProcess/getFacet -lm\" >& 2 exit 1 fi if [ ! -x \" \\$ HELPER_GETDATA\" ] ; then echo \"ERROR: Compiled helper not found or not executable: \\$ HELPER_GETDATA\" >& 2 echo \" Compile with: qcc -autolink postProcess/getData-generic.c -o postProcess/getData-generic -lm\" >& 2 exit 1 fi fi if [ \\$ SKIP_FOOTPRINT -eq 0 ] ; then if [ ! -x \" \\$ HELPER_GETFOOTPRINT\" ] ; then echo \"ERROR: Compiled helper not found or not executable: \\$ HELPER_GETFOOTPRINT\" >& 2 echo \" Compile with: qcc -autolink postProcess/getFootPrint.c -o postProcess/getFootPrint -lm\" >& 2 exit 1 fi fi # ============================================================ # Display Configuration # ============================================================ echo \"=========================================\" echo \"Drop Impact - Post-Processing Pipeline\" echo \"=========================================\" echo \"Cases to process: \\$ {CASE_NUMBERS[*]}\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"\" echo \"Settings:\" echo \" CPUs: \\$ CPUS\" echo \" nGFS: \\$ NGFS\" echo \" tsnap: \\$ TSNAP\" echo \" GridsPerR: \\$ GRIDS_PER_R\" echo \" Domain: R=[0, \\$ RMAX], Z=[ \\$ ZMIN, \\$ ZMAX]\" echo \"\" echo \"Steps to run:\" [ \\$ SKIP_VIDEO -eq 0 ] && echo \" [1] Video-generic.py (frame generation)\" || echo \" [1] Video-generic.py (SKIPPED)\" [ \\$ SKIP_FOOTPRINT -eq 0 ] && echo \" [2] getFootPrint.py (footprint extraction)\" || echo \" [2] getFootPrint.py (SKIPPED)\" [ \\$ SKIP_PLOT -eq 0 ] && echo \" [3] plotFootPrint.py (PDF generation)\" || echo \" [3] plotFootPrint.py (SKIPPED)\" echo \"\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: DRY RUN (no execution)\" echo \"\" # ============================================================ # Processing Functions # ============================================================ run_video() { local case_no = \" \\$ 1\" local results_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}/results\" local video_dir = \" \\$ {results_dir}/Video\" if [ \\$ VERBOSE -eq 1 ] || [ \\$ DRY_RUN -eq 1 ] ; then echo \" CMD: python \\$ {VIDEO_SCRIPT} --caseToProcess \\$ {results_dir} --folderToSave \\$ {video_dir} --CPUs \\$ {CPUS} --nGFS \\$ {NGFS} --tsnap \\$ {TSNAP} --GridsPerR \\$ {GRIDS_PER_R} --ZMAX \\$ {ZMAX} --RMAX \\$ {RMAX} --ZMIN \\$ {ZMIN}\" fi if [ \\$ DRY_RUN -eq 0 ] ; then python \" \\$ {VIDEO_SCRIPT}\" \\ --caseToProcess \" \\$ {results_dir}\" \\ --folderToSave \" \\$ {video_dir}\" \\ --CPUs \" \\$ {CPUS}\" \\ --nGFS \" \\$ {NGFS}\" \\ --tsnap \" \\$ {TSNAP}\" \\ --GridsPerR \" \\$ {GRIDS_PER_R}\" \\ --ZMAX \" \\$ {ZMAX}\" \\ --RMAX \" \\$ {RMAX}\" \\ --ZMIN \" \\$ {ZMIN}\" fi } run_footprint() { local case_no = \" \\$ 1\" local results_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}/results\" if [ \\$ VERBOSE -eq 1 ] || [ \\$ DRY_RUN -eq 1 ] ; then echo \" CMD: python \\$ {FOOTPRINT_SCRIPT} --caseToProcess \\$ {results_dir} --CPUs \\$ {CPUS} --nGFS \\$ {NGFS} --tsnap \\$ {TSNAP}\" fi if [ \\$ DRY_RUN -eq 0 ] ; then python \" \\$ {FOOTPRINT_SCRIPT}\" \\ --caseToProcess \" \\$ {results_dir}\" \\ --CPUs \" \\$ {CPUS}\" \\ --nGFS \" \\$ {NGFS}\" \\ --tsnap \" \\$ {TSNAP}\" fi } run_plot() { local case_no = \" \\$ 1\" local results_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}/results\" if [ \\$ VERBOSE -eq 1 ] || [ \\$ DRY_RUN -eq 1 ] ; then echo \" CMD: python \\$ {PLOT_SCRIPT} --resultsDir \\$ {results_dir}\" fi if [ \\$ DRY_RUN -eq 0 ] ; then python \" \\$ {PLOT_SCRIPT}\" --resultsDir \" \\$ {results_dir}\" fi } # ============================================================ # Main Processing Loop # ============================================================ echo \"=========================================\" echo \"Processing Cases\" echo \"=========================================\" SUCCESSFUL_CASES = () FAILED_CASES = () FAILURE_REASONS = () for case_no in \" \\$ {CASE_NUMBERS[@]}\" ; do echo \"\" echo \"-----------------------------------------\" echo \"Case \\$ case_no\" echo \"-----------------------------------------\" case_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}\" results_dir = \" \\$ {case_dir}/results\" intermediate_dir = \" \\$ {results_dir}/intermediate\" # Validate case directory exists if [ ! -d \" \\$ case_dir\" ] ; then echo \" ERROR: Case directory not found: \\$ case_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Case directory not found\" ) continue fi if [ ! -d \" \\$ results_dir\" ] ; then echo \" ERROR: Results directory not found: \\$ results_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Results directory not found\" ) continue fi if [ ! -d \" \\$ intermediate_dir\" ] ; then echo \" ERROR: Intermediate directory not found: \\$ intermediate_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No intermediate/ snapshots\" ) continue fi # Count snapshots snapshot_count = \\$ ( find \" \\$ intermediate_dir\" -name \"snapshot-*\" 2 > /dev/null | wc -l | tr -d ' ' ) echo \" Found \\$ snapshot_count snapshots in intermediate/\" if [ \" \\$ snapshot_count\" -eq 0 ] ; then echo \" ERROR: No snapshots found\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No snapshots in intermediate/\" ) continue fi # Track step failures step_failed = 0 # Step 1: Video generation if [ \\$ SKIP_VIDEO -eq 0 ] ; then echo \"\" echo \" [1/3] Running Video-generic.py...\" if ! run_video \" \\$ case_no\" ; then echo \" ERROR: Video generation failed\" step_failed = 1 else [ \\$ DRY_RUN -eq 0 ] && echo \" [1/3] Video generation complete\" fi else echo \" [1/3] Video generation (skipped)\" fi # Step 2: Footprint extraction if [ \\$ SKIP_FOOTPRINT -eq 0 ] && [ \\$ step_failed -eq 0 ] ; then echo \"\" echo \" [2/3] Running getFootPrint.py...\" if ! run_footprint \" \\$ case_no\" ; then echo \" ERROR: Footprint extraction failed\" step_failed = 1 else [ \\$ DRY_RUN -eq 0 ] && echo \" [2/3] Footprint extraction complete\" fi elif [ \\$ SKIP_FOOTPRINT -eq 1 ] ; then echo \" [2/3] Footprint extraction (skipped)\" fi # Step 3: Plot generation if [ \\$ SKIP_PLOT -eq 0 ] && [ \\$ step_failed -eq 0 ] ; then echo \"\" echo \" [3/3] Running plotFootPrint.py...\" if ! run_plot \" \\$ case_no\" ; then echo \" ERROR: Plot generation failed\" step_failed = 1 else [ \\$ DRY_RUN -eq 0 ] && echo \" [3/3] Plot generation complete\" fi elif [ \\$ SKIP_PLOT -eq 1 ] ; then echo \" [3/3] Plot generation (skipped)\" fi # Record result if [ \\$ step_failed -eq 0 ] ; then SUCCESSFUL_CASES += ( \" \\$ case_no\" ) echo \"\" echo \" Case \\$ case_no: SUCCESS\" else FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Processing step failed\" ) echo \"\" echo \" Case \\$ case_no: FAILED\" fi done # ============================================================ # Summary # ============================================================ echo \"\" echo \"=========================================\" echo \"Post-Processing Complete\" echo \"=========================================\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"Successful: \\$ {#SUCCESSFUL_CASES[@]}\" echo \"Failed: \\$ {#FAILED_CASES[@]}\" if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Failed cases:\" for i in \" \\$ {!FAILED_CASES[@]}\" ; do echo \" - Case \\$ {FAILED_CASES[ \\$ i]}: \\$ {FAILURE_REASONS[ \\$ i]}\" done fi if [ \\$ {#SUCCESSFUL_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Output locations:\" for case_no in \" \\$ {SUCCESSFUL_CASES[@]}\" ; do echo \" \\$ {CASES_DIR}/ \\$ {case_no}/results/\" done fi echo \"\" # Exit with error if any cases failed if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Drop-Impact/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Drop Impact Simulations - Code Example: Context",
    "content": "#!/bin/bash# # runPostProcess-Ncases.sh## Run the post-processing pipeline on multiple simulation cases:# `Video-generic.py` -> `getFootPrint.py` -> `plotFootPrint.py`.## ## Usage# `./runPostProcess-Ncases.sh [options] CASE_NO [CASE_NO ...]`## ## Inputs# - Case directories under `simulationCases/<CaseNo>/results`# - Compiled helpers: `postProcess/getFacet`, `postProcess/getData-generic`,#   `postProcess/getFootPrint` (depending on which steps are enabled)## ## Outputs# - `results/Video/` frames# - `results/rFootvsTime_*.csv` footprint data# - `results/footprint_evolution.pdf` plot## ## Author# Vatsal Sanjay (vatsal.sanjay@comphy-lab.org)# CoMPhy Lab, Durham University# Last updated: Dec 2025set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Post-processing script pathsVIDEO_SCRIPT=\"\\${SCRIPT_DIR}/postProcess/Video-generic.py\"FOOTPRINT_SCRIPT=\"\\${SCRIPT_DIR}/postProcess/getFootPrint.py\"PLOT_SCRIPT=\"\\${SCRIPT_DIR}/postProcess/plotFootPrint.py\"# C helper executablesHELPER_GETFACET=\"\\${SCRIPT_DIR}/postProcess/getFacet\"HELPER_GETDATA=\"\\${SCRIPT_DIR}/postProcess/getData-generic\"HELPER_GETFOOTPRINT=\"\\${SCRIPT_DIR}/postProcess/getFootPrint\"# Case directory rootCASES_DIR=\"\\${SCRIPT_DIR}/simulationCases\"# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] CASE_NO [CASE_NO ...]Run post-processing pipeline on multiple simulation cases.For each case, executes: Video-generic.py \u2192 getFootPrint.py \u2192 plotFootPrint.pyOptions:--CPUs N            Number of parallel workers (default: 4)--nGFS N            Number of snapshots to process (default: 4000)--tsnap F           Time interval between snapshots (default: 0.01)--GridsPerR N       Radial grid resolution for video (default: 256)--ZMAX F            Maximum Z value for video (default: 4.0)--RMAX F            Maximum R value for video (default: 4.0)--ZMIN F            Minimum Z value for video (default: 0.0)--skip-video        Skip Video-generic.py (frame generation)--skip-footprint    Skip getFootPrint.py (footprint extraction)--skip-plot         Skip plotFootPrint.py (PDF generation)-n, --dry-run       Show what would run without executing-v, --verbose       Verbose output-h, --help          Show this help messageArguments:CASE_NO             4-digit case numbers (1000-9999)Examples:# Process multiple cases with default settings\\$0 1000 1001 1002 1003 1004 1005 1006# Process with more CPUs and fewer snapshots\\$0 --CPUs 8 --nGFS 500 1000 1001# Skip video generation (faster processing)\\$0 --skip-video 1000 1001 1002# Only generate footprint plots (skip video and extraction)\\$0 --skip-video --skip-footprint 1000 1001# Dry run to preview commands\\$0 --dry-run 1000 1001Output locations:simulationCases/<CaseNo>/results/Video/              # PNG framessimulationCases/<CaseNo>/results/rFootvsTime_*.csv   # Footprint datasimulationCases/<CaseNo>/results/footprint_evolution.pdf  # PlotFor more information, see CLAUDE.mdEOF}# ============================================================# Parse Command Line Options# ============================================================CPUS=4NGFS=4000TSNAP=0.01GRIDS_PER_R=256ZMAX=4.0RMAX=4.0ZMIN=0.0SKIP_VIDEO=0SKIP_FOOTPRINT=0SKIP_PLOT=0DRY_RUN=0VERBOSE=0CASE_NUMBERS=()while[[\\$#-gt0]];docase\\$1in--CPUs)CPUS=\"\\$2\"if![[\"\\$CPUS\"=~^[0-9]+\\$]]||[\"\\$CPUS\"-lt1];thenecho\"ERROR: --CPUs requires a positive integer, got:\\$CPUS\">&2exit1fishift2;;--nGFS)NGFS=\"\\$2\"if![[\"\\$NGFS\"=~^[0-9]+\\$]]||[\"\\$NGFS\"-lt1];thenecho\"ERROR: --nGFS requires a positive integer, got:\\$NGFS\">&2exit1fishift2;;--tsnap)TSNAP=\"\\$2\"shift2;;--GridsPerR)GRIDS_PER_R=\"\\$2\"if![[\"\\$GRIDS_PER_R\"=~^[0-9]+\\$]]||[\"\\$GRIDS_PER_R\"-lt1];thenecho\"ERROR: --GridsPerR requires a positive integer, got:\\$GRIDS_PER_R\">&2exit1fishift2;;--ZMAX)ZMAX=\"\\$2\"shift2;;--RMAX)RMAX=\"\\$2\"shift2;;--ZMIN)ZMIN=\"\\$2\"shift2;;--skip-video)SKIP_VIDEO=1shift;;--skip-footprint)SKIP_FOOTPRINT=1shift;;--skip-plot)SKIP_PLOT=1shift;;-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)# Collect case numbersCASE_NUMBERS+=(\"\\$1\")shift;;esacdone# ============================================================# Validation# ============================================================# Check at least one case number providedif[\\${#CASE_NUMBERS[@]}-eq0];thenecho\"ERROR: No case numbers provided\">&2usageexit1fi# Validate case numbers are 4-digitforcase_noin\"\\${CASE_NUMBERS[@]}\";doif![[\"\\$case_no\"=~^[0-9]{4}\\$]];thenecho\"ERROR: Case number must be 4 digits (1000-9999), got:\\$case_no\">&2exit1fiif[\"\\$case_no\"-lt1000]||[\"\\$case_no\"-gt9999];thenecho\"ERROR: Case number out of range (1000-9999), got:\\$case_no\">&2exit1fidone# Check if all processing steps are skippedif[\\$SKIP_VIDEO-eq1]&&[\\$SKIP_FOOTPRINT-eq1]&&[\\$SKIP_PLOT-eq1];thenecho\"ERROR: All processing steps are skipped (--skip-video, --skip-footprint, --skip-plot)\">&2echo\"       At least one processing step must be enabled.\">&2exit1fi# Check Python availabilityif!command-vpython&>/dev/null;thenecho\"ERROR: python not found in PATH\">&2exit1fi# Check Python scripts existforscriptin\"\\$VIDEO_SCRIPT\"\"\\$FOOTPRINT_SCRIPT\"\"\\$PLOT_SCRIPT\";doif[!-f\"\\$script\"];thenecho\"ERROR: Python script not found:\\$script\">&2exit1fidone# Check C helpers exist (only if needed)if[\\$SKIP_VIDEO-eq0];thenif[!-x\"\\$HELPER_GETFACET\"];thenecho\"ERROR: Compiled helper not found or not executable:\\$HELPER_GETFACET\">&2echo\"       Compile with: qcc -autolink postProcess/getFacet.c -o postProcess/getFacet -lm\">&2exit1fiif[!-x\"\\$HELPER_GETDATA\"];thenecho\"ERROR: Compiled helper not found or not executable:\\$HELPER_GETDATA\">&2echo\"       Compile with: qcc -autolink postProcess/getData-generic.c -o postProcess/getData-generic -lm\">&2exit1fifiif[\\$SKIP_FOOTPRINT-eq0];thenif[!-x\"\\$HELPER_GETFOOTPRINT\"];thenecho\"ERROR: Compiled helper not found or not executable:\\$HELPER_GETFOOTPRINT\">&2echo\"       Compile with: qcc -autolink postProcess/getFootPrint.c -o postProcess/getFootPrint -lm\">&2exit1fifi# ============================================================# Display Configuration# ============================================================echo\"=========================================\"echo\"Drop Impact - Post-Processing Pipeline\"echo\"=========================================\"echo\"Cases to process:\\${CASE_NUMBERS[*]}\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"\"echo\"Settings:\"echo\"  CPUs:\\$CPUS\"echo\"  nGFS:\\$NGFS\"echo\"  tsnap:\\$TSNAP\"echo\"  GridsPerR:\\$GRIDS_PER_R\"echo\"  Domain:     R=[0,\\$RMAX], Z=[\\$ZMIN,\\$ZMAX]\"echo\"\"echo\"Steps to run:\"[\\$SKIP_VIDEO-eq0]&&echo\"  [1] Video-generic.py (frame generation)\"||echo\"  [1] Video-generic.py (SKIPPED)\"[\\$SKIP_FOOTPRINT-eq0]&&echo\"  [2] getFootPrint.py (footprint extraction)\"||echo\"  [2] getFootPrint.py (SKIPPED)\"[\\$SKIP_PLOT-eq0]&&echo\"  [3] plotFootPrint.py (PDF generation)\"||echo\"  [3] plotFootPrint.py (SKIPPED)\"echo\"\"[\\$DRY_RUN-eq1]&&echo\"Mode: DRY RUN (no execution)\"echo\"\"# ============================================================# Processing Functions# ============================================================run_video(){localcase_no=\"\\$1\"localresults_dir=\"\\${CASES_DIR}/\\${case_no}/results\"localvideo_dir=\"\\${results_dir}/Video\"if[\\$VERBOSE-eq1]||[\\$DRY_RUN-eq1];thenecho\"  CMD: python\\${VIDEO_SCRIPT} --caseToProcess\\${results_dir} --folderToSave\\${video_dir} --CPUs\\${CPUS} --nGFS\\${NGFS} --tsnap\\${TSNAP} --GridsPerR\\${GRIDS_PER_R} --ZMAX\\${ZMAX} --RMAX\\${RMAX} --ZMIN\\${ZMIN}\"fiif[\\$DRY_RUN-eq0];thenpython\"\\${VIDEO_SCRIPT}\"\\--caseToProcess\"\\${results_dir}\"\\--folderToSave\"\\${video_dir}\"\\--CPUs\"\\${CPUS}\"\\--nGFS\"\\${NGFS}\"\\--tsnap\"\\${TSNAP}\"\\--GridsPerR\"\\${GRIDS_PER_R}\"\\--ZMAX\"\\${ZMAX}\"\\--RMAX\"\\${RMAX}\"\\--ZMIN\"\\${ZMIN}\"fi}run_footprint(){localcase_no=\"\\$1\"localresults_dir=\"\\${CASES_DIR}/\\${case_no}/results\"if[\\$VERBOSE-eq1]||[\\$DRY_RUN-eq1];thenecho\"  CMD: python\\${FOOTPRINT_SCRIPT} --caseToProcess\\${results_dir} --CPUs\\${CPUS} --nGFS\\${NGFS} --tsnap\\${TSNAP}\"fiif[\\$DRY_RUN-eq0];thenpython\"\\${FOOTPRINT_SCRIPT}\"\\--caseToProcess\"\\${results_dir}\"\\--CPUs\"\\${CPUS}\"\\--nGFS\"\\${NGFS}\"\\--tsnap\"\\${TSNAP}\"fi}run_plot(){localcase_no=\"\\$1\"localresults_dir=\"\\${CASES_DIR}/\\${case_no}/results\"if[\\$VERBOSE-eq1]||[\\$DRY_RUN-eq1];thenecho\"  CMD: python\\${PLOT_SCRIPT} --resultsDir\\${results_dir}\"fiif[\\$DRY_RUN-eq0];thenpython\"\\${PLOT_SCRIPT}\"--resultsDir\"\\${results_dir}\"fi}# ============================================================# Main Processing Loop# ============================================================echo\"=========================================\"echo\"Processing Cases\"echo\"=========================================\"SUCCESSFUL_CASES=()FAILED_CASES=()FAILURE_REASONS=()forcase_noin\"\\${CASE_NUMBERS[@]}\";doecho\"\"echo\"-----------------------------------------\"echo\"Case\\$case_no\"echo\"-----------------------------------------\"case_dir=\"\\${CASES_DIR}/\\${case_no}\"results_dir=\"\\${case_dir}/results\"intermediate_dir=\"\\${results_dir}/intermediate\"# Validate case directory existsif[!-d\"\\$case_dir\"];thenecho\"  ERROR: Case directory not found:\\$case_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Case directory not found\")continuefiif[!-d\"\\$results_dir\"];thenecho\"  ERROR: Results directory not found:\\$results_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Results directory not found\")continuefiif[!-d\"\\$intermediate_dir\"];thenecho\"  ERROR: Intermediate directory not found:\\$intermediate_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No intermediate/ snapshots\")continuefi# Count snapshotssnapshot_count=\\$(find\"\\$intermediate_dir\"-name\"snapshot-*\"2>/dev/null|wc-l|tr-d' ')echo\"  Found\\$snapshot_count snapshots in intermediate/\"if[\"\\$snapshot_count\"-eq0];thenecho\"  ERROR: No snapshots found\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No snapshots in intermediate/\")continuefi# Track step failuresstep_failed=0# Step 1: Video generationif[\\$SKIP_VIDEO-eq0];thenecho\"\"echo\"  [1/3] Running Video-generic.py...\"if!run_video\"\\$case_no\";thenecho\"  ERROR: Video generation failed\"step_failed=1else[\\$DRY_RUN-eq0]&&echo\"  [1/3] Video generation complete\"fielseecho\"  [1/3] Video generation (skipped)\"fi# Step 2: Footprint extractionif[\\$SKIP_FOOTPRINT-eq0]&&[\\$step_failed-eq0];thenecho\"\"echo\"  [2/3] Running getFootPrint.py...\"if!run_footprint\"\\$case_no\";thenecho\"  ERROR: Footprint extraction failed\"step_failed=1else[\\$DRY_RUN-eq0]&&echo\"  [2/3] Footprint extraction complete\"fielif[\\$SKIP_FOOTPRINT-eq1];thenecho\"  [2/3] Footprint extraction (skipped)\"fi# Step 3: Plot generationif[\\$SKIP_PLOT-eq0]&&[\\$step_failed-eq0];thenecho\"\"echo\"  [3/3] Running plotFootPrint.py...\"if!run_plot\"\\$case_no\";thenecho\"  ERROR: Plot generation failed\"step_failed=1else[\\$DRY_RUN-eq0]&&echo\"  [3/3] Plot generation complete\"fielif[\\$SKIP_PLOT-eq1];thenecho\"  [3/3] Plot generation (skipped)\"fi# Record resultif[\\$step_failed-eq0];thenSUCCESSFUL_CASES+=(\"\\$case_no\")echo\"\"echo\"  Case\\$case_no: SUCCESS\"elseFAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Processing step failed\")echo\"\"echo\"  Case\\$case_no: FAILED\"fidone# ============================================================# Summary# ============================================================echo\"\"echo\"=========================================\"echo\"Post-Processing Complete\"echo\"=========================================\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"Successful:\\${#SUCCESSFUL_CASES[@]}\"echo\"Failed:\\${#FAILED_CASES[@]}\"if[\\${#FAILED_CASES[@]}-gt0];thenecho\"\"echo\"Failed cases:\"foriin\"\\${!FAILED_CASES[@]}\";doecho\"  - Case\\${FAILED_CASES[\\$i]}:\\${FAILURE_REASONS[\\$i]}\"donefiif[\\${#SUCCESSFUL_CASES[@]}-gt0];thenecho\"\"echo\"Output locations:\"forcase_noin\"\\${SUCCESSFUL_CASES[@]}\";doecho\"\\${CASES_DIR}/\\${case_no}/results/\"donefiecho\"\"# Exit with error if any cases failedif[\\${#FAILED_CASES[@]}-gt0];thenexit1fiexit0",
    "url": "https://comphy-lab.org/Drop-Impact/runPostProcess-Ncases.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations: Context",
    "content": "postProcess/getFootPrint.py See raw file # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab \u2014 Durham University # Last updated: Nov 17, 2025 Radial footprint extractor built on top of the getFootPrint Basilisk helper. The compiled helper already implements the heavy lifting (PLIC interface search). This Python wrapper coordinates multiple cutoff radii, loops through all snapshots inside caseToProcess , and writes sorted CSV files of time,rf columns. By default the script evaluates five windows [1e-3, 2.5e-3, 5e-3, 1e-2, 5e-2] but the list can be overridden via CLI.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations: Results",
    "content": "Typical usage from the repository root: python3 postProcess/getFootPrint.py --caseToProcess simulationCases/1000/results Each cutoff produces rFootvsTime_<cutoff>.csv in the case directory. from __future__ import annotations import argparse import multiprocessing as mp import os import subprocess as sp from dataclasses import dataclass from functools import partial from typing import Iterable, List, Optional, Sequence, Tuple import pandas as pd DEFAULT_CUTOFFS = ( 1e-3 , 2.5e-3 , 5e-3 , 1e-2 , 5e-2 ) SNAPSHOT_SUBDIR = \"intermediate\" @dataclass (frozen = True ) class SnapshotTask: Metadata for a single restart snapshot. index: int time: float path: str @dataclass (frozen = True ) class RuntimeConfig: CLI options gathered into a single structure. cpus: int n_snapshots: int tsnap: float case_dir: str binary: str def snapshots( self ) -> List[SnapshotTask]: Pre-compute snapshot paths for downstream multiprocessing workers. tasks: List[SnapshotTask] = [] for idx in range ( self .n_snapshots): time = self .tsnap * idx path = os.path.join( self .case_dir, SNAPSHOT_SUBDIR, f\"snapshot- { time :.4f} \" ) tasks.append(SnapshotTask(index = idx, time = time, path = path)) return tasks def parse_arguments() -> Tuple[RuntimeConfig, Tuple[ float , ...]]: Translate CLI flags into runtime configuration and cutoff list. parser = argparse.ArgumentParser( description = \"Extract radial footprint (rf) vs time for multiple cutoffs.\" ) parser.add_argument( \"--CPUs\" , type = int , default = 4 , help = \"Number of worker processes to spawn.\" ) parser.add_argument( \"--nGFS\" , type = int , default = 4000 , help = \"Number of snapshot files to check inside intermediate/.\" , ) parser.add_argument( \"--tsnap\" , type = float , default = 0.01 , help = \"Physical time interval between snapshots.\" , ) parser.add_argument( \"--caseToProcess\" , type = str , default = \"simulationCases/1000/results\" , help = \"Path to the simulation results folder housing intermediate/.\" , ) parser.add_argument( \"--binary\" , type = str , default = \"postProcess/getFootPrint\" , help = \"Path to the compiled getFootPrint helper executable.\" , ) parser.add_argument( \"--xCutoffs\" , type = float , nargs = \"*\" , default = DEFAULT_CUTOFFS, help = ( \"Radial window(s) for footprint detection. \" \"Provide one or more floats (default: 1e-3 2.5e-3 5e-3 1e-2 5e-2).\" ), ) args = parser.parse_args() if args.CPUs < 1 : parser.error( \"--CPUs must be >= 1\" ) if args.nGFS < 1 : parser.error( \"--nGFS must be >= 1\" ) if args.tsnap <= 0.0 : parser.error( \"--tsnap must be positive.\" ) case_dir = os.path.abspath(args.caseToProcess) binary = os.path.abspath(args.binary) config = RuntimeConfig( cpus = args.CPUs, n_snapshots = args.nGFS, tsnap = args.tsnap, case_dir = case_dir, binary = binary, ) if not os.path.isdir(case_dir): raise FileNotFoundError ( f\"Case directory ' { case_dir } ' not found. \" \"Pass --caseToProcess pointing to results/.\" ) if not os.path.isfile(binary): raise FileNotFoundError ( f\"Helper binary ' { binary } ' not found.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations: Python Function",
    "content": "Compile getFootPrint.c first.\" ) cutoffs = tuple (args.xCutoffs) if args.xCutoffs else DEFAULT_CUTOFFS return config, cutoffs def run_helper(command: Sequence[ str ]) -> Sequence[ str ]: Execute helper binary and return decoded stderr lines. result = sp.run( command, stdout = sp.PIPE, stderr = sp.PIPE, check = False , text = True , ) if result.returncode != 0 : raise RuntimeError ( f\"Command { ' ' . join(command) } failed (exit { result . returncode } ): \\n \" f\" { result . stderr } \" ) return [line.strip() for line in result.stderr.splitlines() if line.strip()] def parse_rf_line(line: str ) -> Tuple[ float , float ]: Split helper CSV line (\u2018t,ymax\u2019) into floats. chunks = line.split( \",\" ) if len (chunks) != 2 : raise ValueError ( f\"Unexpected helper output: ' { line } '\" ) time_str, rf_str = chunks return float (time_str), float (rf_str) def process_snapshot( task: SnapshotTask, * , binary: str , x_cutoff: float , ) -> Optional[Tuple[ float , float ]]: Worker that invokes the helper for a single snapshot. if not os.path.exists(task.path): print ( f\"Skipping missing snapshot: { task . path } \" ) return None try : lines = run_helper( [binary, task.path, f\" { x_cutoff :.10g} \" ] ) except RuntimeError as err: print (err) return None if not lines: print ( f\"No output from helper for { task . path } @ cutoff { x_cutoff } \" ) return None helper_time, rf_val = parse_rf_line(lines[ - 1 ]) print ( f\"x_cutoff= { x_cutoff :.4g} :: t= { helper_time :.6f} , rf= { rf_val :.6g} \" , flush = True , ) return helper_time, rf_val def evaluate_cutoff_series( tasks: Iterable[SnapshotTask], config: RuntimeConfig, cutoff: float , ) -> List[Tuple[ float , float ]]: Compute rf(time) pairs for every snapshot at the provided cutoff. worker = partial(process_snapshot, binary = config.binary, x_cutoff = cutoff) if config.cpus == 1 : rows = [worker(task) for task in tasks] else : with mp.Pool(processes = config.cpus) as pool: rows = pool. map (worker, tasks) return [row for row in rows if row is not None ] def cutoff_label(value: float ) -> str : Format cutoff for filenames, keeping readable scientific notation. if value < 1 : return f\" { value :.4f} \" label = f\" { value :.4f} \" return label.rstrip( \"0\" ).rstrip( \".\" ) def write_series( rows: Sequence[Tuple[ float , float ]], * , cutoff: float , case_dir: str , ) -> str : Persist time-rf series to CSV with deterministic ordering. df = pd.DataFrame(rows, columns = [ \"time\" , \"rf\" ]) df.sort_values( \"time\" , inplace = True ) filename = f\"rFootvsTime_ { cutoff_label(cutoff) } .csv\" output_path = os.path.join(case_dir, filename) df.to_csv(output_path, index = False ) print ( f\"Wrote { len (df) } rows to { output_path } \" ) return output_path def main() -> None : config, cutoffs = parse_arguments() tasks = config.snapshots() for cutoff in cutoffs: print ( f\" \\n Processing cutoff r <= { cutoff } m\" ) rows = evaluate_cutoff_series(tasks, config, cutoff) write_series(rows, cutoff = cutoff, case_dir = config.case_dir) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab \u2014 Durham University# Last updated: Nov 17, 2025",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "python3 postProcess/getFootPrint.py --caseToProcess simulationCases/1000/results",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "from__future__importannotationsimportargparseimportmultiprocessingasmpimportosimportsubprocessasspfromdataclassesimportdataclassfromfunctoolsimportpartialfromtypingimportIterable, List, Optional, Sequence, TupleimportpandasaspdDEFAULT_CUTOFFS=(1e-3,2.5e-3,5e-3,1e-2,5e-2)SNAPSHOT_SUBDIR=\"intermediate\"@dataclass(frozen=True)classSnapshotTask:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "index:inttime:floatpath:str@dataclass(frozen=True)classRuntimeConfig:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "cpus:intn_snapshots:inttsnap:floatcase_dir:strbinary:strdefsnapshots(self)->List[SnapshotTask]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "tasks: List[SnapshotTask]=[]foridxinrange(self.n_snapshots):time=self.tsnap*idxpath=os.path.join(self.case_dir, SNAPSHOT_SUBDIR,f\"snapshot-{time:.4f}\")tasks.append(SnapshotTask(index=idx, time=time, path=path))returntasksdefparse_arguments()->Tuple[RuntimeConfig, Tuple[float, ...]]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "parser=argparse.ArgumentParser(description=\"Extract radial footprint (rf) vs time for multiple cutoffs.\")parser.add_argument(\"--CPUs\",type=int, default=4,help=\"Number of worker processes to spawn.\")parser.add_argument(\"--nGFS\",type=int,default=4000,help=\"Number of snapshot files to check inside intermediate/.\",)parser.add_argument(\"--tsnap\",type=float,default=0.01,help=\"Physical time interval between snapshots.\",)parser.add_argument(\"--caseToProcess\",type=str,default=\"simulationCases/1000/results\",help=\"Path to the simulation results folder housing intermediate/.\",)parser.add_argument(\"--binary\",type=str,default=\"postProcess/getFootPrint\",help=\"Path to the compiled getFootPrint helper executable.\",)parser.add_argument(\"--xCutoffs\",type=float,nargs=\"*\",default=DEFAULT_CUTOFFS,help=(\"Radial window(s) for footprint detection. \"\"Provide one or more floats (default: 1e-3 2.5e-3 5e-3 1e-2 5e-2).\"),)args=parser.parse_args()ifargs.CPUs<1:parser.error(\"--CPUs must be >= 1\")ifargs.nGFS<1:parser.error(\"--nGFS must be >= 1\")ifargs.tsnap<=0.0:parser.error(\"--tsnap must be positive.\")case_dir=os.path.abspath(args.caseToProcess)binary=os.path.abspath(args.binary)config=RuntimeConfig(cpus=args.CPUs,n_snapshots=args.nGFS,tsnap=args.tsnap,case_dir=case_dir,binary=binary,)ifnotos.path.isdir(case_dir):raiseFileNotFoundError(f\"Case directory '{case_dir}' not found. \"\"Pass --caseToProcess pointing to results/.\")ifnotos.path.isfile(binary):raiseFileNotFoundError(f\"Helper binary '{binary}' not found.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "Compile getFootPrint.c first.\")cutoffs=tuple(args.xCutoffs)ifargs.xCutoffselseDEFAULT_CUTOFFSreturnconfig, cutoffsdefrun_helper(command: Sequence[str])->Sequence[str]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "result=sp.run(command,stdout=sp.PIPE,stderr=sp.PIPE,check=False,text=True,)ifresult.returncode!=0:raiseRuntimeError(f\"Command{' '.join(command)}failed (exit{result.returncode}):\\n\"f\"{result.stderr}\")return[line.strip()forlineinresult.stderr.splitlines()ifline.strip()]defparse_rf_line(line:str)->Tuple[float,float]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "chunks=line.split(\",\")iflen(chunks)!=2:raiseValueError(f\"Unexpected helper output: '{line}'\")time_str, rf_str=chunksreturnfloat(time_str),float(rf_str)defprocess_snapshot(task: SnapshotTask,*,binary:str,x_cutoff:float,)->Optional[Tuple[float,float]]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "ifnotos.path.exists(task.path):print(f\"Skipping missing snapshot:{task.path}\")returnNonetry:lines=run_helper([binary, task.path,f\"{x_cutoff:.10g}\"])exceptRuntimeErroraserr:print(err)returnNoneifnotlines:print(f\"No output from helper for{task.path}@ cutoff{x_cutoff}\")returnNonehelper_time, rf_val=parse_rf_line(lines[-1])print(f\"x_cutoff={x_cutoff:.4g}:: t={helper_time:.6f}, rf={rf_val:.6g}\",flush=True,)returnhelper_time, rf_valdefevaluate_cutoff_series(tasks: Iterable[SnapshotTask],config: RuntimeConfig,cutoff:float,)->List[Tuple[float,float]]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "worker=partial(process_snapshot, binary=config.binary, x_cutoff=cutoff)ifconfig.cpus==1:rows=[worker(task)fortaskintasks]else:withmp.Pool(processes=config.cpus)aspool:rows=pool.map(worker, tasks)return[rowforrowinrowsifrowisnotNone]defcutoff_label(value:float)->str:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "ifvalue<1:returnf\"{value:.4f}\"label=f\"{value:.4f}\"returnlabel.rstrip(\"0\").rstrip(\".\")defwrite_series(rows: Sequence[Tuple[float,float]],*,cutoff:float,case_dir:str,)->str:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "df=pd.DataFrame(rows, columns=[\"time\",\"rf\"])df.sort_values(\"time\", inplace=True)filename=f\"rFootvsTime_{cutoff_label(cutoff)}.csv\"output_path=os.path.join(case_dir, filename)df.to_csv(output_path, index=False)print(f\"Wrote{len(df)}rows to{output_path}\")returnoutput_pathdefmain()->None:config, cutoffs=parse_arguments()tasks=config.snapshots()forcutoffincutoffs:print(f\"\\nProcessing cutoff r <={cutoff}m\")rows=evaluate_cutoff_series(tasks, config, cutoff)write_series(rows, cutoff=cutoff, case_dir=config.case_dir)if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Context",
    "content": "postProcess/Video-generic.py See raw file # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab # Durham University # Last updated: Nov 17, 2025 Generic video post-processing pipeline for Basilisk drop-impact runs. Overview The helper executables postProcess/getFacet and postProcess/getData-generic are compiled as part of the Basilisk workflow. This Python wrapper shells out to those binaries for every snapshot, reshapes the returned grids, and renders angularly mirrored visualisations. Keeping everything in a mono-file but with concrete building blocks mirrors the literate C/H style described in CLAUDE.md and keeps the documentation tooling ( .github/scripts/build.sh ) happy. Usage Typical invocation from the repository root:: python3 postProcess/Video-generic.py --caseToProcess simulationCases/1234/results Command-line switches expose all relevant knobs (grid density, domain limits, time stride, CPU count).",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Import Statements",
    "content": "The output directory is created on-demand and filled with zero-padded PNG files compatible with downstream stitching utilities. import argparse import multiprocessing as mp import os import subprocess as sp from dataclasses import dataclass from functools import partial from datetime import datetime from typing import Sequence, Tuple import matplotlib import matplotlib.pyplot as plt import numpy as np from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter # Configure matplotlib with mathtext (parallel-safe, no external LaTeX) matplotlib.rcParams[ \"font.family\" ] = \"serif\" matplotlib.rcParams[ \"mathtext.fontset\" ] = \"cm\" # Computer Modern style @dataclass (frozen = True ) class DomainBounds: Symmetry-aware domain description in cylindrical coordinates. The code expects r in [rmin, rmax] with rmin <= 0 to leverage the axis of symmetry; z spans freely between zmin and zmax.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Class Definition",
    "content": "Packaging these values avoids argument soup when plotting or generating overlays. rmin: float rmax: float zmin: float zmax: float @dataclass (frozen = True ) class RuntimeConfig: Run-time knobs collected from CLI arguments. Multiprocessing workers only need a single instance of this struct, making later CLI additions painless. The accessors keep mirror operations (e.g., computing rmin) in one place. cpus: int n_snapshots: int grids_per_r: int tsnap: float zmin: float zmax: float rmax: float case_dir: str output_dir: str skip_video_encode: bool framerate: int output_fps: int @property def rmin( self ) -> float : return - self .rmax @property def bounds( self ) -> DomainBounds: return DomainBounds( self .rmin, self .rmax, self .zmin, self .zmax) @dataclass (frozen = True ) class PlotStyle: Single source of truth for plot-level choices.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Matplotlib tweaks become...",
    "content": "Matplotlib tweaks become traceable: alter colours, fonts, or geometry here and every rendered frame will stay consistent without touching plotting logic. figure_size: Tuple[ float , float ] = ( 19.20 , 10.80 ) tick_label_size: int = 20 zero_axis_color: str = \"grey\" axis_color: str = \"black\" line_width: float = 2.0 interface_color: str = \"#00B2FF\" colorbar_width: float = 0.03 left_colorbar_offset: float = 0.04 right_colorbar_offset: float = 0.01 @dataclass (frozen = True ) class SnapshotInfo: Metadata for an input snapshot and its output image. Storing paths and the physical time together simplifies filename logic and ensures logging statements stay informative. index: int time: float source: str target: str @dataclass class FieldData: Structured holder around the grids returned by getData-generic. Attributes provide convenient min/max queries so the plotting routine does not need to recalculate extents or worry about array shapes.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Python Function",
    "content": "R: np.ndarray Z: np.ndarray strain_rate: np.ndarray velocity: np.ndarray nz: int @property def radial_extent( self ) -> Tuple[ float , float ]: return self .R. min (), self .R. max () @property def axial_extent( self ) -> Tuple[ float , float ]: return self .Z. min (), self .Z. max () PLOT_STYLE = PlotStyle() def log_status(message: str , * , level: str = \"INFO\" ) -> None : Print timestamped status messages for long-running CLI workflows. timestamp = datetime.now().strftime( \"%H:%M:%S\" ) print ( f\"[ { timestamp } ] [ { level } ] { message } \" , flush = True ) def parse_arguments() -> RuntimeConfig: Parse command-line arguments and construct runtime configuration. The returned dataclass is immutable and can be safely shared across multiprocessing workers without coordination overhead. This design makes future CLI additions trivial.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Returns: RuntimeConfig: Configuration...",
    "content": "Returns: RuntimeConfig: Configuration object containing: - cpus: Number of parallel workers (default: 4) - n_snapshots: Total frames to process (default: 4000) - grids_per_r: Radial mesh resolution (default: 64) - tsnap: Time interval between snapshots (default: 0.01) - Domain bounds (zmin, zmax, rmax) - I/O paths (case_dir, output_dir) Examples: >>> config = parse_arguments() >>> config.cpus 4 >>> config.bounds DomainBounds(rmin=-4.0, rmax=4.0, zmin=0.0, zmax=4.0) See Also: RuntimeConfig: Full specification of configuration fields DomainBounds: Domain geometry description parser = argparse.ArgumentParser(description = \"Generate snapshot videos.\" ) parser.add_argument( \"--CPUs\" , type = int , default = 4 , help = \"Number of CPUs to use\" ) parser.add_argument( \"--nGFS\" , type = int , default = 4000 , help = \"Number of restart files to process\" ) parser.add_argument( \"--GridsPerR\" , type = int , default = 256 , help = \"Number of grids per R\" ) parser.add_argument( \"--ZMAX\" , type = float , default = 4.0 , help = \"Maximum Z value\" ) parser.add_argument( \"--RMAX\" , type = float , default = 4.0 , help = \"Maximum R value\" ) parser.add_argument( \"--ZMIN\" , type = float , default = 0.0 , help = \"Minimum Z value\" ) parser.add_argument( \"--tsnap\" , type = float , default = 0.01 , help = \"Time snap\" ) parser.add_argument( \"--caseToProcess\" , type = str , default = \"simulationCases/1000/results\" , help = \"Case to process\" , ) parser.add_argument( \"--folderToSave\" , type = str , default = \"simulationCases/1000/results/Video\" , help = \"Folder to save\" ) parser.add_argument( \"--skip-video-encode\" , action = \"store_true\" , help = \"Skip ffmpeg video encoding after frame generation\" ) parser.add_argument( \"--framerate\" , type = int , default = 90 , help = \"Input framerate for ffmpeg (default: 90)\" ) parser.add_argument( \"--output-fps\" , type = int , default = 30 , help = \"Output video framerate (default: 30)\" ) args = parser.parse_args() return RuntimeConfig( cpus = args.CPUs, n_snapshots = args.nGFS, grids_per_r = args.GridsPerR, tsnap = args.tsnap, zmin = args.ZMIN, zmax = args.ZMAX, rmax = args.RMAX, case_dir = args.caseToProcess, output_dir = args.folderToSave, skip_video_encode = args.skip_video_encode, framerate = args.framerate, output_fps = args.output_fps, ) def ensure_directory(path: str ) -> None : Create an output directory if it does not exist.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Python Function",
    "content": "Parameters: path: Directory to create (including parents). if not os.path.isdir(path): os.makedirs(path, exist_ok = True ) def run_helper(command: Sequence[ str ]) -> Sequence[ str ]: Run a helper executable and return its stderr as decoded lines. The compiled helpers deliberately emit their payload to stderr, so stdout is ignored (it is typically empty) and we bubble up informative stderr content. Parameters: command: Command list passed to subprocess. Returns: list[str]: Decoded stderr lines produced by the helper. process = sp.Popen(command, stdout = sp.PIPE, stderr = sp.PIPE) _, stderr = process.communicate() if process.returncode != 0 : raise RuntimeError ( f\"Command { ' ' . join(command) } failed with code { process . returncode } : \\n \" f\" { stderr . decode( 'utf-8' ) } \" ) return stderr.decode( \"utf-8\" ).split( \" \\n \" ) def get_facets(filename: str ): Collect interface facets from getFacet helper with axisymmetric mirroring.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Shells out to...",
    "content": "Shells out to the compiled getFacet executable, which extracts the volume-of-fluid (VOF) interface as a sequence of line segments. Since the Basilisk simulation uses axisymmetric coordinates, only the r \u2265 0 half is computed. This function mirrors each segment about r=0 to create the full visualization. Args: filename: Path to Basilisk snapshot file (e.g., \u2018snapshot-0.0100\u2019) Returns: list[tuple]: Sequence of line segments, each as ((r1, z1), (r2, z2)). Each physical segment appears twice: once at +r and once at -r for the mirrored visualization. Empty list if fewer than 100 output lines (likely indicates no interface present). Note: The getFacet helper outputs space-separated (z, r) pairs. This function swaps to (r, z) convention for matplotlib plotting.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: See Also: plot_snapshot:...",
    "content": "See Also: plot_snapshot: Uses returned segments for LineCollection rendering temp2 = run_helper([ \"postProcess/getFacet\" , filename]) segs = [] skip = False if len (temp2) > 1e2 : for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: skip = False continue if not skip and n1 + 1 < len (temp2): temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1), (r2, z2))) segs.append((( - r1, z1), ( - r2, z2))) skip = True return segs def get_field(filename: str , zmin: float , zmax: float , rmax: float , nr: int ) -> FieldData: Read field arrays for a single snapshot from getData-generic helper. Shells out to the compiled getData-generic executable, which samples the velocity and strain-rate fields on a structured grid. Returns a FieldData struct with reshaped 2D arrays, abstracting away the flattening scheme used by the helper.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Args: filename: Path...",
    "content": "Args: filename: Path to Basilisk snapshot file (e.g., \u2018snapshot-0.0100\u2019) zmin: Minimum axial coordinate for sampling domain zmax: Maximum axial coordinate for sampling domain rmax: Maximum radial coordinate (positive branch only) nr: Number of grid points in radial direction Returns: FieldData: Structured container with reshaped 2D arrays: - R, Z: Meshgrid coordinates (nz \u00d7 nr) - strain_rate: Second invariant of rate-of-strain tensor - velocity: Velocity magnitude field - nz: Number of grid points in axial direction (computed) Note: The helper samples r \u2208 [0, rmax], but plotting mirrors about r=0 to create the full axisymmetric visualization.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Definitions",
    "content": "See Also: FieldData: Structure definition with extent properties plot_snapshot: Uses the returned FieldData for visualization temp2 = run_helper( [ \"postProcess/getData-generic\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr), ] ) Rtemp, Ztemp, D2temp, veltemp = [], [], [], [] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: continue Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) nz = int ( len (Z) / nr) log_status( f\" { os . path . basename(filename) } : nz = { nz } \" ) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) return FieldData(R = R, Z = Z, strain_rate = D2, velocity = vel, nz = nz) def build_snapshot_info(index: int , config: RuntimeConfig) -> SnapshotInfo: Construct file paths for a given timestep index.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Parameters: index: Integer...",
    "content": "Parameters: index: Integer index used with tsnap to recover time. config: RuntimeConfig providing directories and stride. Returns: SnapshotInfo: Pre-computed metadata for the worker. time = config.tsnap * index source = os.path.join(config.case_dir, \"intermediate\" , f\"snapshot- { time :.4f} \" ) target = os.path.join(config.output_dir, f\" { int (time * 1000 ) :08d} .png\" ) return SnapshotInfo(index = index, time = time, source = source, target = target) def draw_domain_outline(ax, bounds: DomainBounds, style: PlotStyle) -> None : Outline computational domain and symmetry line.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Parameters: ax: Matplotlib...",
    "content": "Parameters: ax: Matplotlib axis used for plotting. bounds: Domain extents in both directions. style: Colour/width styling information. ax.plot( [ 0 , 0 ], [bounds.zmin, bounds.zmax], \"-.\" , color = style.zero_axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmin], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmin, bounds.zmin], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmax, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmax, bounds.rmax], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) def add_colorbar(fig, ax, mappable, * , align: str , label: str , style: PlotStyle): Attach a vertical colorbar on the requested side of the axis.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Using manual axes...",
    "content": "Using manual axes lets us keep the main axis square while still showing two distinct colour scales. Parameters: fig: Figure hosting the axes. ax: Primary axes sharing its bounding box. mappable: The image/artist the colorbar describes. align: \u2018left\u2019 or \u2018right\u2019 relative to the plotting axis. label: Axis label to display. style: PlotStyle values for spacing and typography.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Context",
    "content": "Returns: matplotlib.colorbar.Colorbar: The constructed colorbar. l, b, w, h = ax.get_position().bounds if align == \"left\" : position = [l - style.left_colorbar_offset, b, style.colorbar_width, h] else : position = [l + w + style.right_colorbar_offset, b, style.colorbar_width, h] cb_ax = fig.add_axes(position) colorbar = plt.colorbar(mappable, cax = cb_ax, orientation = \"vertical\" ) colorbar.set_label(label, fontsize = style.tick_label_size, labelpad = 5 ) colorbar.ax.tick_params(labelsize = style.tick_label_size) colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter( \"{x:,.2f}\" )) if align == \"left\" : colorbar.ax.yaxis.set_ticks_position( \"left\" ) colorbar.ax.yaxis.set_label_position( \"left\" ) return colorbar def plot_snapshot( field_data: FieldData, facets, bounds: DomainBounds, snapshot: SnapshotInfo, style: PlotStyle, ) -> None : Render and persist a single snapshot figure.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: All artist construction...",
    "content": "All artist construction lives here so multiprocessing workers only need to fetch data and call this function.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Parameters: field_data: Structured...",
    "content": "Parameters: field_data: Structured arrays for strain-rate and velocity. facets: Line segments representing the interface. bounds: Domain extents that keep axes square. snapshot: Metadata describing time and output file. style: Plotting choices centralised in PlotStyle. fig, ax = plt.subplots() fig.set_size_inches( * style.figure_size) draw_domain_outline(ax, bounds, style) line_segments = LineCollection( facets, linewidths = 4 , colors = style.interface_color, linestyle = \"solid\" ) ax.add_collection(line_segments) rminp, rmaxp = field_data.radial_extent zminp, zmaxp = field_data.axial_extent cntrl1 = ax.imshow( field_data.strain_rate, cmap = \"hot_r\" , interpolation = \"Bilinear\" , origin = \"lower\" , extent = [ - rminp, - rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 2.0 , ) cntrl2 = ax.imshow( field_data.velocity, interpolation = \"Bilinear\" , cmap = \"Purples\" , origin = \"lower\" , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 1.0 , vmin = 0.0 , ) ax.set_aspect( \"equal\" ) ax.set_xlim(bounds.rmin, bounds.rmax) ax.set_ylim(bounds.zmin, bounds.zmax) ax.set_title( f\"$t/ \\\\ tau_0$ = { snapshot . time :4.3f} \" , fontsize = style.tick_label_size) ax.axis( \"off\" ) add_colorbar( fig, ax, cntrl1, align = \"left\" , label = r\"$\\left(\\boldsymbol{\\mathcal {D} :\\mathcal {D} }\\right)$\" , style = style, ) add_colorbar( fig, ax, cntrl2, align = \"right\" , label = r\"$\\|\\boldsymbol {u} \\|$\" , style = style, ) plt.savefig(snapshot.target, bbox_inches = \"tight\" ) plt.close(fig) def process_timestep(index: int , config: RuntimeConfig, style: PlotStyle) -> None : Worker executed for every timestep index.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Performs availability checks,...",
    "content": "Performs availability checks, loads helper outputs, and calls plot_snapshot.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Parameters: index: Integer...",
    "content": "Parameters: index: Integer timestep index relative to tsnap. config: Runtime configuration shared across workers. style: Plotting style shared by all frames. snapshot = build_snapshot_info(index, config) if not os.path.exists(snapshot.source): log_status( f\"Missing: { os . path . basename(snapshot.source) } \" , level = \"WARN\" ) return if os.path.exists(snapshot.target): log_status( f\"Exists, skipping: { os . path . basename(snapshot.target) } \" ) return # Show relative path: CaseNo/results/intermediate/filename src_parts = snapshot.source.split(os.sep) src_rel = os.sep.join(src_parts[ - 4 :]) if len (src_parts) >= 4 else snapshot.source log_status( f\"Processing { src_rel } \" ) try : facets = get_facets(snapshot.source) nr = int (config.grids_per_r * config.rmax) field_data = get_field( snapshot.source, config.zmin, config.zmax, config.rmax, nr ) plot_snapshot(field_data, facets, config.bounds, snapshot, style) except Exception as err: log_status( f\"Error at { src_rel } (t= { snapshot . time :.4f} ): { err } \" , level = \"ERROR\" ) raise # Show relative path: CaseNo/results/Video/filename tgt_parts = snapshot.target.split(os.sep) tgt_rel = os.sep.join(tgt_parts[ - 4 :]) if len (tgt_parts) >= 4 else snapshot.target log_status( f\"Saved: { tgt_rel } \" ) def encode_video(config: RuntimeConfig) -> None : Run ffmpeg to stitch PNG frames into an MP4 video.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Results",
    "content": "The output video is saved in the results directory (parent of Video folder) with the case number as filename (e.g., results/1006.mp4). Parameters: config: Runtime configuration containing paths and encoding settings.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations: Results",
    "content": "Raises: RuntimeError: If ffmpeg fails to encode the video. # Extract case number from path (e.g., simulationCases/1006/results -> 1006) case_no = os.path.basename(os.path.dirname(config.case_dir)) # Output path: results/1006.mp4 (parent of Video folder) output_path = os.path.join(config.case_dir, f\" { case_no } .mp4\" ) input_pattern = os.path.join(config.output_dir, \"*.png\" ) cmd = [ \"ffmpeg\" , \"-y\" , \"-framerate\" , str (config.framerate), \"-pattern_type\" , \"glob\" , \"-i\" , input_pattern, \"-vf\" , \"pad=ceil(iw/2)*2:ceil(ih/2)*2\" , \"-c:v\" , \"libx264\" , \"-r\" , str (config.output_fps), \"-pix_fmt\" , \"yuv420p\" , output_path ] log_status( f\"Encoding video: { output_path } \" ) result = sp.run(cmd, capture_output = True , text = True ) if result.returncode != 0 : log_status( f\"ffmpeg error: { result . stderr } \" , level = \"ERROR\" ) raise RuntimeError ( f\"ffmpeg failed with code { result . returncode } \" ) log_status( f\"Video saved: { output_path } \" ) def main(): Entry point used by the documentation tooling and CLI. config = parse_arguments() ensure_directory(config.output_dir) with mp.Pool(processes = config.cpus) as pool: worker = partial(process_timestep, config = config, style = PLOT_STYLE) pool. map (worker, range (config.n_snapshots)) # Encode video unless skipped if not config.skip_video_encode: encode_video(config) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab# Durham University# Last updated: Nov 17, 2025",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "python3 postProcess/Video-generic.py --caseToProcess simulationCases/1234/results",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "importargparseimportmultiprocessingasmpimportosimportsubprocessasspfromdataclassesimportdataclassfromfunctoolsimportpartialfromdatetimeimportdatetimefromtypingimportSequence, Tupleimportmatplotlibimportmatplotlib.pyplotaspltimportnumpyasnpfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatter# Configure matplotlib with mathtext (parallel-safe, no external LaTeX)matplotlib.rcParams[\"font.family\"]=\"serif\"matplotlib.rcParams[\"mathtext.fontset\"]=\"cm\"# Computer Modern style@dataclass(frozen=True)classDomainBounds:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "rmin:floatrmax:floatzmin:floatzmax:float@dataclass(frozen=True)classRuntimeConfig:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "cpus:intn_snapshots:intgrids_per_r:inttsnap:floatzmin:floatzmax:floatrmax:floatcase_dir:stroutput_dir:strskip_video_encode:boolframerate:intoutput_fps:int@propertydefrmin(self)->float:return-self.rmax@propertydefbounds(self)->DomainBounds:returnDomainBounds(self.rmin,self.rmax,self.zmin,self.zmax)@dataclass(frozen=True)classPlotStyle:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "figure_size: Tuple[float,float]=(19.20,10.80)tick_label_size:int=20zero_axis_color:str=\"grey\"axis_color:str=\"black\"line_width:float=2.0interface_color:str=\"#00B2FF\"colorbar_width:float=0.03left_colorbar_offset:float=0.04right_colorbar_offset:float=0.01@dataclass(frozen=True)classSnapshotInfo:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "index:inttime:floatsource:strtarget:str@dataclassclassFieldData:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "R: np.ndarrayZ: np.ndarraystrain_rate: np.ndarrayvelocity: np.ndarraynz:int@propertydefradial_extent(self)->Tuple[float,float]:returnself.R.min(),self.R.max()@propertydefaxial_extent(self)->Tuple[float,float]:returnself.Z.min(),self.Z.max()PLOT_STYLE=PlotStyle()deflog_status(message:str,*, level:str=\"INFO\")->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "timestamp=datetime.now().strftime(\"%H:%M:%S\")print(f\"[{timestamp}] [{level}]{message}\", flush=True)defparse_arguments()->RuntimeConfig:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "parser=argparse.ArgumentParser(description=\"Generate snapshot videos.\")parser.add_argument(\"--CPUs\",type=int, default=4,help=\"Number of CPUs to use\")parser.add_argument(\"--nGFS\",type=int, default=4000,help=\"Number of restart files to process\")parser.add_argument(\"--GridsPerR\",type=int, default=256,help=\"Number of grids per R\")parser.add_argument(\"--ZMAX\",type=float, default=4.0,help=\"Maximum Z value\")parser.add_argument(\"--RMAX\",type=float, default=4.0,help=\"Maximum R value\")parser.add_argument(\"--ZMIN\",type=float, default=0.0,help=\"Minimum Z value\")parser.add_argument(\"--tsnap\",type=float, default=0.01,help=\"Time snap\")parser.add_argument(\"--caseToProcess\",type=str,default=\"simulationCases/1000/results\",help=\"Case to process\",)parser.add_argument(\"--folderToSave\",type=str, default=\"simulationCases/1000/results/Video\",help=\"Folder to save\")parser.add_argument(\"--skip-video-encode\", action=\"store_true\",help=\"Skip ffmpeg video encoding after frame generation\")parser.add_argument(\"--framerate\",type=int, default=90,help=\"Input framerate for ffmpeg (default: 90)\")parser.add_argument(\"--output-fps\",type=int, default=30,help=\"Output video framerate (default: 30)\")args=parser.parse_args()returnRuntimeConfig(cpus=args.CPUs,n_snapshots=args.nGFS,grids_per_r=args.GridsPerR,tsnap=args.tsnap,zmin=args.ZMIN,zmax=args.ZMAX,rmax=args.RMAX,case_dir=args.caseToProcess,output_dir=args.folderToSave,skip_video_encode=args.skip_video_encode,framerate=args.framerate,output_fps=args.output_fps,)defensure_directory(path:str)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "ifnotos.path.isdir(path):os.makedirs(path, exist_ok=True)defrun_helper(command: Sequence[str])->Sequence[str]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "process=sp.Popen(command, stdout=sp.PIPE, stderr=sp.PIPE)_, stderr=process.communicate()ifprocess.returncode!=0:raiseRuntimeError(f\"Command{' '.join(command)}failed with code{process.returncode}:\\n\"f\"{stderr.decode('utf-8')}\")returnstderr.decode(\"utf-8\").split(\"\\n\")defget_facets(filename:str):",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "temp2=run_helper([\"postProcess/getFacet\", filename])segs=[]skip=Falseiflen(temp2)>1e2:forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:skip=Falsecontinueifnotskipandn1+1<len(temp2):temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1), (r2, z2)))segs.append(((-r1, z1), (-r2, z2)))skip=Truereturnsegsdefget_field(filename:str, zmin:float, zmax:float, rmax:float, nr:int)->FieldData:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "temp2=run_helper([\"postProcess/getData-generic\",filename,str(zmin),str(0),str(zmax),str(rmax),str(nr),])Rtemp, Ztemp, D2temp, veltemp=[], [], [], []forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:continueZtemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)nz=int(len(Z)/nr)log_status(f\"{os.path.basename(filename)}: nz ={nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))returnFieldData(R=R, Z=Z, strain_rate=D2, velocity=vel, nz=nz)defbuild_snapshot_info(index:int, config: RuntimeConfig)->SnapshotInfo:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "time=config.tsnap*indexsource=os.path.join(config.case_dir,\"intermediate\",f\"snapshot-{time:.4f}\")target=os.path.join(config.output_dir,f\"{int(time*1000):08d}.png\")returnSnapshotInfo(index=index, time=time, source=source, target=target)defdraw_domain_outline(ax, bounds: DomainBounds, style: PlotStyle)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "ax.plot([0,0],[bounds.zmin, bounds.zmax],\"-.\",color=style.zero_axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmin],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmin, bounds.zmin],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmax, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmax, bounds.rmax],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)defadd_colorbar(fig, ax, mappable,*, align:str, label:str, style: PlotStyle):",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: l, b, w,...",
    "content": "l, b, w, h=ax.get_position().boundsifalign==\"left\":position=[l-style.left_colorbar_offset, b, style.colorbar_width, h]else:position=[l+w+style.right_colorbar_offset, b, style.colorbar_width, h]cb_ax=fig.add_axes(position)colorbar=plt.colorbar(mappable, cax=cb_ax, orientation=\"vertical\")colorbar.set_label(label, fontsize=style.tick_label_size, labelpad=5)colorbar.ax.tick_params(labelsize=style.tick_label_size)colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter(\"{x:,.2f}\"))ifalign==\"left\":colorbar.ax.yaxis.set_ticks_position(\"left\")colorbar.ax.yaxis.set_label_position(\"left\")returncolorbardefplot_snapshot(field_data: FieldData,facets,bounds: DomainBounds,snapshot: SnapshotInfo,style: PlotStyle,)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "fig, ax=plt.subplots()fig.set_size_inches(*style.figure_size)draw_domain_outline(ax, bounds, style)line_segments=LineCollection(facets, linewidths=4, colors=style.interface_color, linestyle=\"solid\")ax.add_collection(line_segments)rminp, rmaxp=field_data.radial_extentzminp, zmaxp=field_data.axial_extentcntrl1=ax.imshow(field_data.strain_rate,cmap=\"hot_r\",interpolation=\"Bilinear\",origin=\"lower\",extent=[-rminp,-rmaxp, zminp, zmaxp],vmax=2.0,vmin=-2.0,)cntrl2=ax.imshow(field_data.velocity,interpolation=\"Bilinear\",cmap=\"Purples\",origin=\"lower\",extent=[rminp, rmaxp, zminp, zmaxp],vmax=1.0,vmin=0.0,)ax.set_aspect(\"equal\")ax.set_xlim(bounds.rmin, bounds.rmax)ax.set_ylim(bounds.zmin, bounds.zmax)ax.set_title(f\"$t/\\\\tau_0$ ={snapshot.time:4.3f}\", fontsize=style.tick_label_size)ax.axis(\"off\")add_colorbar(fig,ax,cntrl1,align=\"left\",label=r\"$\\left(\\boldsymbol{\\mathcal{D}:\\mathcal{D}}\\right)$\",style=style,)add_colorbar(fig,ax,cntrl2,align=\"right\",label=r\"$\\|\\boldsymbol{u}\\|$\",style=style,)plt.savefig(snapshot.target, bbox_inches=\"tight\")plt.close(fig)defprocess_timestep(index:int, config: RuntimeConfig, style: PlotStyle)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Context",
    "content": "snapshot=build_snapshot_info(index, config)ifnotos.path.exists(snapshot.source):log_status(f\"Missing:{os.path.basename(snapshot.source)}\", level=\"WARN\")returnifos.path.exists(snapshot.target):log_status(f\"Exists, skipping:{os.path.basename(snapshot.target)}\")return# Show relative path: CaseNo/results/intermediate/filenamesrc_parts=snapshot.source.split(os.sep)src_rel=os.sep.join(src_parts[-4:])iflen(src_parts)>=4elsesnapshot.sourcelog_status(f\"Processing{src_rel}\")try:facets=get_facets(snapshot.source)nr=int(config.grids_per_r*config.rmax)field_data=get_field(snapshot.source, config.zmin, config.zmax, config.rmax, nr)plot_snapshot(field_data, facets, config.bounds, snapshot, style)exceptExceptionaserr:log_status(f\"Error at{src_rel}(t={snapshot.time:.4f}):{err}\", level=\"ERROR\")raise# Show relative path: CaseNo/results/Video/filenametgt_parts=snapshot.target.split(os.sep)tgt_rel=os.sep.join(tgt_parts[-4:])iflen(tgt_parts)>=4elsesnapshot.targetlog_status(f\"Saved:{tgt_rel}\")defencode_video(config: RuntimeConfig)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example: Results",
    "content": "# Extract case number from path (e.g., simulationCases/1006/results -> 1006)case_no=os.path.basename(os.path.dirname(config.case_dir))# Output path: results/1006.mp4 (parent of Video folder)output_path=os.path.join(config.case_dir,f\"{case_no}.mp4\")input_pattern=os.path.join(config.output_dir,\"*.png\")cmd=[\"ffmpeg\",\"-y\",\"-framerate\",str(config.framerate),\"-pattern_type\",\"glob\",\"-i\", input_pattern,\"-vf\",\"pad=ceil(iw/2)*2:ceil(ih/2)*2\",\"-c:v\",\"libx264\",\"-r\",str(config.output_fps),\"-pix_fmt\",\"yuv420p\",output_path]log_status(f\"Encoding video:{output_path}\")result=sp.run(cmd, capture_output=True, text=True)ifresult.returncode!=0:log_status(f\"ffmpeg error:{result.stderr}\", level=\"ERROR\")raiseRuntimeError(f\"ffmpeg failed with code{result.returncode}\")log_status(f\"Video saved:{output_path}\")defmain():",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Drop Impact Simulations - Code Example",
    "content": "config=parse_arguments()ensure_directory(config.output_dir)withmp.Pool(processes=config.cpus)aspool:worker=partial(process_timestep, config=config, style=PLOT_STYLE)pool.map(worker,range(config.n_snapshots))# Encode video unless skippedifnotconfig.skip_video_encode:encode_video(config)if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations: Context",
    "content": "postProcess/plotFootPrint.py See raw file # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab \u2014 Durham University # Last updated: Nov 17, 2025 Publication-quality footprint evolution plotter. Reads CSV files generated by getFootPrint.py and creates professional plots of radial footprint evolution for different cutoff radii. Outputs a vector PDF file suitable for scientific publications. Typical usage from the repository root: python3 postProcess/plotFootPrint.py # Save PDF only python3 postProcess/plotFootPrint.py --gui # Save PDF and show GUI The script automatically discovers all rFootvsTime_*.csv files in the specified directory and generates a combined plot with different cutoff values shown as separate curves.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations: Results - Class Definition",
    "content": "Output is saved as footprint_evolution.pdf in the results directory. from __future__ import annotations import argparse import glob import os import re import shutil from dataclasses import dataclass from typing import List, Optional, Tuple import matplotlib import matplotlib.pyplot as plt import numpy as np import pandas as pd # Configure matplotlib for publication-quality output with LaTeX fallback matplotlib.rcParams[ 'font.family' ] = 'serif' matplotlib.rcParams[ 'font.serif' ] = [ 'Computer Modern Roman' ] if shutil.which( 'latex' ): try : matplotlib.rcParams[ 'text.usetex' ] = True matplotlib.rcParams[ 'text.latex.preamble' ] = r'\\usepackage {amsmath} ' except Exception : matplotlib.rcParams[ 'text.usetex' ] = False else : matplotlib.rcParams[ 'text.usetex' ] = False # Font settings for 6x4 inch figure (smaller than default 12x9) PLT_SETTINGS = { 'LabelFont' : 28 , # Axis labels 'AxesFont' : 20 , # Tick labels 'LegendFont' : 18 , # Legend entries } @dataclass (frozen = True ) class FootprintData: Container for footprint time series at a specific cutoff. cutoff: float time: np.ndarray radius: np.ndarray def __repr__ ( self ) -> str : return f\"FootprintData(cutoff= { self . cutoff :.4g} , n_points= { len ( self .time) } )\" def parse_arguments() -> argparse.Namespace: Parse command-line arguments. parser = argparse.ArgumentParser( description = \"Create publication-quality footprint evolution plots.\" ) parser.add_argument( \"--resultsDir\" , type = str , default = \"simulationCases/1000/results\" , help = \"Path to the directory containing rFootvsTime_*.csv files.\" , ) parser.add_argument( \"--figsize\" , type = float , nargs = 2 , default = [ 6.0 , 4.5 ], help = \"Figure size in inches (width height).",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations: Results - Python Function",
    "content": "Default: 6.0 4.5\" , ) parser.add_argument( \"--gui\" , action = \"store_true\" , help = \"Enable interactive GUI display after saving.\" , ) return parser.parse_args() def discover_csv_files(results_dir: str ) -> List[ str ]: Find all footprint CSV files in the results directory. pattern = os.path.join(results_dir, \"rFootvsTime_*.csv\" ) files = glob.glob(pattern) if not files: raise FileNotFoundError ( f\"No rFootvsTime_*.csv files found in { results_dir } \" ) return sorted (files) def extract_cutoff_from_filename(filename: str ) -> Optional[ float ]: Extract cutoff value from filename like rFootvsTime_0.0100.csv. basename = os.path.basename(filename) match = re.search( r\"rFootvsTime_([0-9.]+)\\.csv\" , basename) if match: return float (match.group( 1 )) return None def load_footprint_data(filepath: str ) -> FootprintData: Load footprint time series from CSV file. cutoff = extract_cutoff_from_filename(filepath) if cutoff is None : raise ValueError ( f\"Could not extract cutoff from filename: { filepath } \" ) try : df = pd.read_csv(filepath) except Exception as err: raise IOError ( f\"Failed to read { filepath } : { err } \" ) if \"time\" not in df.columns or \"rf\" not in df.columns: raise ValueError ( f\"CSV file { filepath } must contain 'time' and 'rf' columns. \" f\"Found: { df . columns . tolist() } \" ) # Remove rows where rf is exactly zero (no footprint detected) df_filtered = df[df[ \"rf\" ] > 0 ].copy() if len (df_filtered) == 0 : print ( f\"Warning: No non-zero footprint data in { filepath } \" ) return FootprintData( cutoff = cutoff, time = np.array([]), radius = np.array([]) ) return FootprintData( cutoff = cutoff, time = df_filtered[ \"time\" ].values, radius = df_filtered[ \"rf\" ].values, ) def setup_axes(ax: plt.Axes) -> None : Apply publication-quality styling to axes. # Thick axis spines for spine in ax.spines.values(): spine.set_linewidth( 2.5 ) # Major ticks ax.tick_params( axis = 'both' , which = 'major' , labelsize = PLT_SETTINGS[ 'AxesFont' ], width = 2.5 , length = 8 , direction = 'out' , pad = 6 ) # Minor ticks ax.tick_params( which = 'minor' , width = 1.5 , length = 4 , direction = 'out' ) ax.minorticks_on() def create_footprint_plot( datasets: List[FootprintData], figsize: Tuple[ float , float ] = ( 6.0 , 4.5 ), ) -> Tuple[plt.Figure, plt.Axes]: Create publication-quality footprint evolution plot. fig, ax = plt.subplots(figsize = figsize) fig.set_facecolor( 'white' ) # Use viridis colormap for different cutoffs n_datasets = len (datasets) colors = plt.cm.viridis(np.linspace( 0.1 , 0.9 , n_datasets)) # Plot each cutoff as a separate line for data, color in zip (datasets, colors): if len (data.time) == 0 : continue # Format cutoff for legend (scientific notation) if data.cutoff < 0.01 : label = rf\"$x_ {{ \\text {{ cutoff }}}} = { data . cutoff :.1e} $ m\" else : label = rf\"$x_ {{ \\text {{ cutoff }}}} = { data . cutoff :.4f} $ m\" ax.plot( data.time, data.radius, linewidth = 2.5 , color = color, label = label, marker = 'o' , markersize = 4 , markevery = max ( 1 , len (data.time) // 20 ), # ~20 markers per line zorder = 2 ) # Axis labels (R_0 = 1, tau_0 = 1) ax.set_xlabel( r'$t/\\tau_0$' , fontsize = PLT_SETTINGS[ 'LabelFont' ], labelpad = 8 ) ax.set_ylabel( r'$r_{\\text {foot} }/R_0$' , fontsize = PLT_SETTINGS[ 'LabelFont' ], labelpad = 8 ) # Legend ax.legend( loc = 'best' , frameon = True , fontsize = PLT_SETTINGS[ 'LegendFont' ], framealpha = 0.9 , edgecolor = 'gray' , fancybox = False , ) # Light grid for readability ax.grid( True , which = 'major' , alpha = 0.3 , linestyle = '-' , linewidth = 0.5 ) ax.grid( True , which = 'minor' , alpha = 0.15 , linestyle = '-' , linewidth = 0.3 ) # Apply publication styling setup_axes(ax) plt.tight_layout() return fig, ax def save_figure( fig: plt.Figure, output_path: str , dpi: int = 300 , ) -> None : Save figure as PDF (vector format). pdf_path = output_path if output_path.endswith( '.pdf' ) else output_path + \".pdf\" fig.savefig(pdf_path, bbox_inches = 'tight' , dpi = dpi, format = 'pdf' ) print ( f\"Saved figure: { pdf_path } \" ) def main() -> None : args = parse_arguments() # Resolve and validate results directory results_dir = os.path.abspath(args.resultsDir) if not os.path.isdir(results_dir): raise FileNotFoundError ( f\"Results directory not found: { results_dir } \" ) print ( f\"Searching for CSV files in: { results_dir } \" ) # Discover and load all footprint data files csv_files = discover_csv_files(results_dir) print ( f\"Found { len (csv_files) } CSV files\" ) datasets: List[FootprintData] = [] for csv_file in csv_files: try : data = load_footprint_data(csv_file) datasets.append(data) print ( f\"Loaded: { data } \" ) except Exception as err: print ( f\"Warning: Skipping { csv_file } : { err } \" ) if not datasets: raise ValueError ( \"No valid footprint data loaded\" ) # Sort by cutoff value for consistent legend ordering datasets.sort(key = lambda d: d.cutoff) # Create plot print ( f\" \\n Creating plot with { len (datasets) } cutoff values...\" ) fig, ax = create_footprint_plot(datasets, figsize = tuple (args.figsize)) # Set output path to footprint_evolution.pdf in results directory output_path = os.path.join(results_dir, \"footprint_evolution.pdf\" ) # Save figure save_figure(fig, output_path) # Display GUI only if --gui flag is passed if args.gui: print ( \" \\n Displaying figure (close window to exit)...\" ) plt.show() else : plt.close(fig) print ( \" \\n Done!\" ) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab \u2014 Durham University# Last updated: Nov 17, 2025",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "python3 postProcess/plotFootPrint.py                    # Save PDF only\npython3 postProcess/plotFootPrint.py --gui              # Save PDF and show GUI",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "from__future__importannotationsimportargparseimportglobimportosimportreimportshutilfromdataclassesimportdataclassfromtypingimportList, Optional, Tupleimportmatplotlibimportmatplotlib.pyplotaspltimportnumpyasnpimportpandasaspd# Configure matplotlib for publication-quality output with LaTeX fallbackmatplotlib.rcParams['font.family']='serif'matplotlib.rcParams['font.serif']=['Computer Modern Roman']ifshutil.which('latex'):try:matplotlib.rcParams['text.usetex']=Truematplotlib.rcParams['text.latex.preamble']=r'\\usepackage{amsmath}'exceptException:matplotlib.rcParams['text.usetex']=Falseelse:matplotlib.rcParams['text.usetex']=False# Font settings for 6x4 inch figure (smaller than default 12x9)PLT_SETTINGS={'LabelFont':28,# Axis labels'AxesFont':20,# Tick labels'LegendFont':18,# Legend entries}@dataclass(frozen=True)classFootprintData:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "cutoff:floattime: np.ndarrayradius: np.ndarraydef__repr__(self)->str:returnf\"FootprintData(cutoff={self.cutoff:.4g}, n_points={len(self.time)})\"defparse_arguments()->argparse.Namespace:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: Results",
    "content": "parser=argparse.ArgumentParser(description=\"Create publication-quality footprint evolution plots.\")parser.add_argument(\"--resultsDir\",type=str,default=\"simulationCases/1000/results\",help=\"Path to the directory containing rFootvsTime_*.csv files.\",)parser.add_argument(\"--figsize\",type=float,nargs=2,default=[6.0,4.5],help=\"Figure size in inches (width height).",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: Results",
    "content": "Default: 6.0 4.5\",)parser.add_argument(\"--gui\",action=\"store_true\",help=\"Enable interactive GUI display after saving.\",)returnparser.parse_args()defdiscover_csv_files(results_dir:str)->List[str]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "pattern=os.path.join(results_dir,\"rFootvsTime_*.csv\")files=glob.glob(pattern)ifnotfiles:raiseFileNotFoundError(f\"No rFootvsTime_*.csv files found in{results_dir}\")returnsorted(files)defextract_cutoff_from_filename(filename:str)->Optional[float]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "basename=os.path.basename(filename)match=re.search(r\"rFootvsTime_([0-9.]+)\\.csv\", basename)ifmatch:returnfloat(match.group(1))returnNonedefload_footprint_data(filepath:str)->FootprintData:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: cutoff=extract_cutoff_from_filename(filepath)ifcutoffisNone:raiseValueError(f\"Could not extract...",
    "content": "cutoff=extract_cutoff_from_filename(filepath)ifcutoffisNone:raiseValueError(f\"Could not extract cutoff from filename:{filepath}\")try:df=pd.read_csv(filepath)exceptExceptionaserr:raiseIOError(f\"Failed to read{filepath}:{err}\")if\"time\"notindf.columnsor\"rf\"notindf.columns:raiseValueError(f\"CSV file{filepath}must contain 'time' and 'rf' columns. \"f\"Found:{df.columns.tolist()}\")# Remove rows where rf is exactly zero (no footprint detected)df_filtered=df[df[\"rf\"]>0].copy()iflen(df_filtered)==0:print(f\"Warning: No non-zero footprint data in{filepath}\")returnFootprintData(cutoff=cutoff,time=np.array([]),radius=np.array([]))returnFootprintData(cutoff=cutoff,time=df_filtered[\"time\"].values,radius=df_filtered[\"rf\"].values,)defsetup_axes(ax: plt.Axes)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example",
    "content": "# Thick axis spinesforspineinax.spines.values():spine.set_linewidth(2.5)# Major ticksax.tick_params(axis='both',which='major',labelsize=PLT_SETTINGS['AxesFont'],width=2.5,length=8,direction='out',pad=6)# Minor ticksax.tick_params(which='minor',width=1.5,length=4,direction='out')ax.minorticks_on()defcreate_footprint_plot(datasets: List[FootprintData],figsize: Tuple[float,float]=(6.0,4.5),)->Tuple[plt.Figure, plt.Axes]:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "fig, ax=plt.subplots(figsize=figsize)fig.set_facecolor('white')# Use viridis colormap for different cutoffsn_datasets=len(datasets)colors=plt.cm.viridis(np.linspace(0.1,0.9, n_datasets))# Plot each cutoff as a separate linefordata, colorinzip(datasets, colors):iflen(data.time)==0:continue# Format cutoff for legend (scientific notation)ifdata.cutoff<0.01:label=rf\"$x_{{\\text{{cutoff}}}}={data.cutoff:.1e}$ m\"else:label=rf\"$x_{{\\text{{cutoff}}}}={data.cutoff:.4f}$ m\"ax.plot(data.time,data.radius,linewidth=2.5,color=color,label=label,marker='o',markersize=4,markevery=max(1,len(data.time)//20),# ~20 markers per linezorder=2)# Axis labels (R_0 = 1, tau_0 = 1)ax.set_xlabel(r'$t/\\tau_0$',fontsize=PLT_SETTINGS['LabelFont'],labelpad=8)ax.set_ylabel(r'$r_{\\text{foot}}/R_0$',fontsize=PLT_SETTINGS['LabelFont'],labelpad=8)# Legendax.legend(loc='best',frameon=True,fontsize=PLT_SETTINGS['LegendFont'],framealpha=0.9,edgecolor='gray',fancybox=False,)# Light grid for readabilityax.grid(True, which='major', alpha=0.3, linestyle='-', linewidth=0.5)ax.grid(True, which='minor', alpha=0.15, linestyle='-', linewidth=0.3)# Apply publication stylingsetup_axes(ax)plt.tight_layout()returnfig, axdefsave_figure(fig: plt.Figure,output_path:str,dpi:int=300,)->None:",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/plotFootPrint.py | Drop Impact Simulations - Code Example: Context",
    "content": "pdf_path=output_pathifoutput_path.endswith('.pdf')elseoutput_path+\".pdf\"fig.savefig(pdf_path, bbox_inches='tight', dpi=dpi,format='pdf')print(f\"Saved figure:{pdf_path}\")defmain()->None:args=parse_arguments()# Resolve and validate results directoryresults_dir=os.path.abspath(args.resultsDir)ifnotos.path.isdir(results_dir):raiseFileNotFoundError(f\"Results directory not found:{results_dir}\")print(f\"Searching for CSV files in:{results_dir}\")# Discover and load all footprint data filescsv_files=discover_csv_files(results_dir)print(f\"Found{len(csv_files)}CSV files\")datasets: List[FootprintData]=[]forcsv_fileincsv_files:try:data=load_footprint_data(csv_file)datasets.append(data)print(f\"Loaded:{data}\")exceptExceptionaserr:print(f\"Warning: Skipping{csv_file}:{err}\")ifnotdatasets:raiseValueError(\"No valid footprint data loaded\")# Sort by cutoff value for consistent legend orderingdatasets.sort(key=lambdad: d.cutoff)# Create plotprint(f\"\\nCreating plot with{len(datasets)}cutoff values...\")fig, ax=create_footprint_plot(datasets, figsize=tuple(args.figsize))# Set output path to footprint_evolution.pdf in results directoryoutput_path=os.path.join(results_dir,\"footprint_evolution.pdf\")# Save figuresave_figure(fig, output_path)# Display GUI only if --gui flag is passedifargs.gui:print(\"\\nDisplaying figure (close window to exit)...\")plt.show()else:plt.close(fig)print(\"\\nDone!\")if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/plotFootPrint.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Post-Processing Tools | Documentation",
    "content": "Post-Processing Tools getData-generic.c Sample Basilisk snapshot fields onto a uniform grid and stream columns to stderr for post-processing (gnuplot, pandas... getFacet.c Extract interface facets from Basilisk VOF snapshots using PLIC/MYC reconstruction and stream line segments to stderr. getFootPrint.c Extract the maximum interface height along the substrate from a Basilisk VOF snapshot by scanning reconstructed facet... getFootPrint.py Radial footprint extractor built on top of the getFootPrint Basilisk helper. The compiled helper already implements t... plotFootPrint.py Publication-quality footprint evolution plotter. Reads CSV files generated by getFootPrint.py and creates professiona... Video-generic.py Generic video post-processing pipeline for Basilisk drop-impact runs. Overview -------- The helper executables postPr...",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations: Context",
    "content": "postProcess/getFootPrint.c See raw file getFootPrint Extract the maximum interface height along the substrate from a Basilisk VOF snapshot by scanning reconstructed facets within an x cutoff. Output CSV streamed to stderr: t,y_max Usage ./getFootPrint <snapshot-file> <xCutoff> Notes Uses PLIC/MYC facet reconstruction to locate the interface. Searches only for cells with 0 < f < 1 and x < xCutoff .",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations: C/C++ Code",
    "content": "Author Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University Last updated: Nov 17, 2025 #include \"utils.h\" #include \"output.h\" #include \"fractions.h\" #include <stdbool.h> scalar f []; typedef struct { char snapshot [ 256 ]; double x_cutoff ; } footprint_config ; static int parse_arguments ( int argc , char const * argv [], footprint_config * cfg ); static void restore_snapshot ( const footprint_config * cfg ); static void configure_vof_boundary ( void ); static double compute_maximum_interface_height ( double x_cutoff ); static inline bool interface_cell ( double vof_value ); static inline double segment_midpoint ( double cell_center , double delta , double end0 , double end1 ); static void emit_footprint ( double timestamp , double y_max ); int main ( int argc , char const * argv []) { footprint_config cfg ; if (! parse_arguments ( argc , argv , & cfg )) return 1 ; restore_snapshot (& cfg ); configure_vof_boundary (); double y_max = compute_maximum_interface_height ( cfg . x_cutoff ); emit_footprint ( t , y_max ); return 0 ; } static int parse_arguments ( int argc , char const * argv [], footprint_config * cfg ) { Validate CLI input and capture the snapshot filename and search window. if ( argc != 3 ) { fprintf ( stderr , \"Error: Expected 2 arguments \\n \" ); fprintf ( stderr , \"Usage: %s <snapshot-file> <xCutoff> \\n \" , argv [ 0 ]); return 0 ; } snprintf ( cfg -> snapshot , sizeof ( cfg -> snapshot ), \"%s\" , argv [ 1 ]); cfg -> x_cutoff = atof ( argv [ 2 ]); if ( cfg -> x_cutoff <= 0. ) { fprintf ( stderr , \"Error: xCutoff must be positive. \\n \" ); return 0 ; } return 1 ; } static void restore_snapshot ( const footprint_config * cfg ) { Each invocation handles a single snapshot; restoring is a one-liner. restore ( file = cfg -> snapshot ); } static void configure_vof_boundary ( void ) { Boundary: no fluid at the axis (left) with proper VOF prolongation.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations: JavaScript",
    "content": "Keeping it in one routine avoids repeated f[...] ceremony. f [ left ] = dirichlet ( 0. ); f . prolongation = fraction_refine ; f . dirty = true ; } static inline bool interface_cell ( double vof_value ) { const double eps = 1e-6 ; return ( vof_value > eps ) && ( vof_value < 1. - eps ); } static inline double segment_midpoint ( double cell_center , double delta , double end0 , double end1 ) { return cell_center + 0.5 * delta *( end0 + end1 ); } static double compute_maximum_interface_height ( double x_cutoff ) { Search x<x_cutoff for the highest facet midpoint. facets returns up to two points per cell, which we immediately collapse to a midpoint. double y_max = 0. ; face vector s = {{- 1 }}; foreach ( reduction ( max : y_max )) { if ( x >= x_cutoff || ! interface_cell ( f [])) continue ; coord n = facet_normal ( point , f , s ); double alpha = plane_alpha ( f [], n ); coord segment [ 2 ]; if ( facets ( n , alpha , segment ) != 2 ) continue ; double y_mid = segment_midpoint ( y , Delta , segment [ 0 ]. y , segment [ 1 ]. y ); if ( y_mid > y_max ) y_max = y_mid ; } return y_max ; } static void emit_footprint ( double timestamp , double y_max ) { Stream CSV to stderr; consumer scripts read via pipes.",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations: FILE * fp...",
    "content": "FILE * fp = ferr ; fprintf ( fp , \"%g,%g \\n \" , timestamp , y_max ); fflush ( fp ); fclose ( fp ); }",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - C/C++ Code: C/C++ Code",
    "content": "#include\"utils.h\"#include\"output.h\"#include\"fractions.h\"#include<stdbool.h>scalar f[];typedefstruct{charsnapshot[256];doublex_cutoff;}footprint_config;staticintparse_arguments(intargc,charconst*argv[],footprint_config*cfg);staticvoidrestore_snapshot(constfootprint_config*cfg);staticvoidconfigure_vof_boundary(void);staticdoublecompute_maximum_interface_height(doublex_cutoff);staticinlineboolinterface_cell(doublevof_value);staticinlinedoublesegment_midpoint(doublecell_center,doubledelta,doubleend0,doubleend1);staticvoidemit_footprint(doubletimestamp,doubley_max);intmain(intargc,charconst*argv[]){footprint_config cfg;if(!parse_arguments(argc,argv,&cfg))return1;restore_snapshot(&cfg);configure_vof_boundary();doubley_max=compute_maximum_interface_height(cfg.x_cutoff);emit_footprint(t,y_max);return0;}staticintparse_arguments(intargc,charconst*argv[],footprint_config*cfg){",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - Code Example",
    "content": "if(argc!=3){fprintf(stderr,\"Error: Expected 2 arguments\\n\");fprintf(stderr,\"Usage: %s <snapshot-file> <xCutoff>\\n\",argv[0]);return0;}snprintf(cfg->snapshot,sizeof(cfg->snapshot),\"%s\",argv[1]);cfg->x_cutoff=atof(argv[2]);if(cfg->x_cutoff<=0.){fprintf(stderr,\"Error: xCutoff must be positive.\\n\");return0;}return1;}staticvoidrestore_snapshot(constfootprint_config*cfg){",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - Code Example",
    "content": "restore(file=cfg->snapshot);}staticvoidconfigure_vof_boundary(void){",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - Code Example",
    "content": "f[left]=dirichlet(0.);f.prolongation=fraction_refine;f.dirty=true;}staticinlineboolinterface_cell(doublevof_value){constdoubleeps=1e-6;return(vof_value>eps)&&(vof_value<1.-eps);}staticinlinedoublesegment_midpoint(doublecell_center,doubledelta,doubleend0,doubleend1){returncell_center+0.5*delta*(end0+end1);}staticdoublecompute_maximum_interface_height(doublex_cutoff){",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - Code Example",
    "content": "doubley_max=0.;face vector s={{-1}};foreach(reduction(max:y_max)){if(x>=x_cutoff||!interface_cell(f[]))continue;coord n=facet_normal(point,f,s);doublealpha=plane_alpha(f[],n);coord segment[2];if(facets(n,alpha,segment)!=2)continue;doubley_mid=segment_midpoint(y,Delta,segment[0].y,segment[1].y);if(y_mid>y_max)y_max=y_mid;}returny_max;}staticvoidemit_footprint(doubletimestamp,doubley_max){",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/getFootPrint.c | Drop Impact Simulations - Code Example",
    "content": "FILE*fp=ferr;fprintf(fp,\"%g,%g\\n\",timestamp,y_max);fflush(fp);fclose(fp);}",
    "url": "https://comphy-lab.org/Drop-Impact/postProcess/getFootPrint.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases dropImpact.c Axisymmetric simulation of a liquid drop impacting a solid surface using the Volume-of-Fluid (VOF) method with adapti... dropImpact_legacy.c Legacy axisymmetric drop-impact simulation in a single Basilisk file. runSnellius_legacy.sbatch set -euo pipefail",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Methods",
    "content": "simulationCases/dropImpact.c See raw file Drop Impact on Solid Surface Axisymmetric simulation of a liquid drop impacting a solid surface using the Volume-of-Fluid (VOF) method with adaptive mesh refinement. Physical Problem A spherical drop of radius \\(R\\) impacts a solid surface with velocity \\(U\\) .",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: The simulation captures:...",
    "content": "The simulation captures: Two-phase flow (liquid drop in surrounding gas) Surface tension effects at the liquid-gas interface Viscous dissipation in both phases Dynamic contact line motion Drop spreading and potential splashing Coordinate System Axisymmetric cylindrical coordinates: - \\(x\\) : radial coordinate (distance from axis of symmetry) - \\(y\\) : axial coordinate (height above surface) - Azimuthal symmetry assumed (no \\(\\theta\\) dependence) Governing Equations Incompressible Navier-Stokes equations for two-phase flow: \\[\\nabla \\cdot \\mathbf{u} = 0\\] \\[\\rho \\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u}\\right) = -\\nabla p + \\nabla \\cdot (2\\mu \\mathbf{D}) + \\sigma \\kappa \\mathbf{n} \\delta_s\\] where: - \\(\\mathbf{u}\\) : velocity field - \\(p\\) : pressure - \\(\\rho\\) , \\(\\mu\\) : density and viscosity (phase-dependent) - \\(\\mathbf{D}\\) : deformation tensor - \\(\\sigma\\) : surface tension coefficient - \\(\\kappa\\) : interface curvature - \\(\\mathbf{n}\\) : interface normal - \\(\\delta_s\\) : interface delta function Dimensionless Numbers Variables are normalized by drop radius \\(R\\) , impact velocity \\(U\\) , liquid density \\(\\rho_\\ell\\) , and surface tension \\(\\sigma\\) : Weber number : \\(We = \\frac{\\rho_\\ell U^2 R}{\\sigma}\\) (inertia vs surface tension) Ohnesorge number : \\(Oh = \\frac{\\mu}{\\sqrt{\\rho_\\ell \\sigma R}}\\) (viscous vs surface tension) Reynolds number : \\(Re = \\frac{\\rho_\\ell U R}{\\mu} = \\frac{\\sqrt{We}}{Oh}\\) (inertia vs viscous) Bond number : \\(Bo = \\frac{\\rho_\\ell g R^2}{\\sigma}\\) (gravity vs surface tension, often negligible) Numerical Method Spatial discretization : Adaptive quadtree grid (Basilisk framework) VOF method : Interface tracking using volume fraction field Projection method : Incompressibility constraint enforcement Adaptive refinement : Error-based mesh adaptation for interface and flow features Time integration : CFL-limited explicit time stepping Usage From parameter file: qcc -I.. /src-local -O2 -Wall -disable-dimensions dropImpact.c -o dropImpact -lm ./dropImpact examples/default.params From command line (legacy mode): ./dropImpact < MAXlevel > < tmax > < We > < Ohd > < Ohs > < Ldomain > [drop_x] [drop_y] [impact_vel] References Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University Date: 2022-02-08 (original), 2025 (refactored) See Also Basilisk: https://basilisk.fr Sanjay & Lohse (2025) - Unifying theory of scaling in drop impact Josserand & Thoroddsen (2016) - Drop impact review Yarin (2006) - Drop impact dynamics // Basilisk includes #include \"axi.h\" // Axisymmetric coordinates #include \"navier-stokes/centered.h\" // Centered NS solver #define FILTERED // Filtered interface for stability #include \"two-phase.h\" // Two-phase flow (VOF method) #include \"navier-stokes/conserving.h\" // Momentum conservation #include \"tension.h\" // Surface tension forces // Local modular headers #include \"params.h\" // Parameter management #include \"geometry.h\" // Geometry and initialization #include \"diagnostics.h\" // Statistics and output Compile-Time Constants Basilisk\u2019s event system requires compile-time constants for time intervals.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: These cannot be...",
    "content": "These cannot be runtime variables from parameter files. #define TSNAP (0.01) // Snapshot interval (fixed at compile time) Geometry Helper Macros These must be defined here for Basilisk\u2019s qcc preprocessor to see them. #ifndef drop_distance_squared #define drop_distance_squared(x, y, p) \\ (( x - ( p )-> drop_x ) * ( x - ( p )-> drop_x ) + ( y - ( p )-> drop_y ) * ( y - ( p )-> drop_y )) #endif Global Configuration All simulation parameters are stored in a single structure for: - Easy parameter passing - Clear organization - Extensibility struct SimulationParams params ; Boundary Conditions Axisymmetric flow requires special treatment at axis and appropriate outflow conditions: // Left boundary (axis of symmetry, x=0) u . t [ left ] = dirichlet ( 0.0 ); // No tangential velocity (azimuthal component) f [ left ] = dirichlet ( 0.0 ); // No fluid crosses axis (ensures symmetry) // Right boundary (outflow, x=Ldomain) u . n [ right ] = neumann ( 0. ); // Stress-free outflow (du/dn = 0) p [ right ] = dirichlet ( 0.0 ); // Zero reference pressure // Top boundary (outflow, y=Ldomain) u . n [ top ] = neumann ( 0. ); // Stress-free outflow p [ top ] = dirichlet ( 0.0 ); // Zero reference pressure // Bottom boundary (y=0, solid surface) // Uses default no-slip condition from centered solver Main Function Handles parameter parsing, validation, domain setup, and simulation launch. int main ( int argc , char const * argv []) { Parameter Parsing Supports two modes: 1.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Context",
    "content": "Parameter file: ./dropImpact config.params 2.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Context",
    "content": "Command line: ./dropImpact <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> ... if ( argc == 2 && access ( argv [ 1 ], F_OK ) == 0 ) { // Parameter file mode if ( parse_params_from_file ( argv [ 1 ], & params ) != 0 ) { fprintf ( stderr , \"ERROR: Failed to parse parameter file \\n \" ); return 1 ; } } else if ( argc >= 7 ) { // Command line mode (legacy compatibility) if ( parse_params_from_cli ( argc , ( char **) argv , & params ) != 0 ) { return 1 ; } } else { // Print usage and exit fprintf ( stderr , \"Usage: \\n \" ); fprintf ( stderr , \" %s <params_file> \\n \" , argv [ 0 ]); fprintf ( stderr , \" %s <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> [drop_x] [drop_y] [impact_vel] \\n \" , argv [ 0 ]); fprintf ( stderr , \" \\n Parameter file format: key=value (one per line) \\n \" ); fprintf ( stderr , \"See examples/default.params for template \\n \" ); return 1 ; } Physics-Based Parameter Scaling Convert tmax from convective time units to simulation time: tmax_sim = tmax * sqrt(We) apply_physics_scaling (& params ); Parameter Validation Check physical constraints and consistency before starting simulation. if (! validate_params (& params )) { fprintf ( stderr , \"ERROR: Parameter validation failed.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Context",
    "content": "Exiting. \\n \" ); return 1 ; } Domain Setup Initialize computational domain with specified size and initial grid. L0 = params . Ldomain ; // Domain size X0 = 0. ; // Origin at axis Y0 = 0. ; // Origin at surface init_grid ( 1 << params . init_grid_level ); // Initial grid: 2^init_grid_level Material Properties Set phase properties from dimensionless numbers: - Phase 1 (f=1): Drop (liquid, typically water) - Phase 2 (f=0): Surrounding (gas, typically air) rho1 = 1.0 ; // Drop density (normalized) mu1 = params . Ohd / sqrt ( params . We ); // Drop viscosity from Oh and We rho2 = params . rho_ratio ; // Gas density mu2 = params . Ohs / sqrt ( params . We ); // Gas viscosity f . sigma = 1.0 / params . We ; // Surface tension from We Output Setup Create output directory and open log files.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Summary",
    "content": "File handles remain open for performance (avoids repeated open/close). create_output_directory ( params . output_dir ); open_log_files (& params ); Print Configuration Write complete parameter summary to stderr for verification. print_params (& params , stderr ); Launch Simulation Start time-stepping loop (controlled by Basilisk event system). run (); return 0 ; } Event: Initialization Sets up initial conditions: drop shape, velocity field, and refined mesh. Attempts to restore from restart file if available; otherwise initializes from scratch. event init ( t = 0 ) { char restart_path [ 512 ]; snprintf ( restart_path , sizeof ( restart_path ), \"%s/restart\" , params . output_dir ); if (! restore ( file = restart_path )) { // No restart file found - initialize from scratch fprintf ( stderr , \" \\n Initializing simulation from initial conditions... \\n \" ); Grid Refinement Refine grid around drop for accurate interface resolution.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: JavaScript",
    "content": "Uses 5% margin beyond drop radius. const double refine_margin = 1.05 ; const double refine_r_sq = refine_margin * refine_margin * params . drop_radius * params . drop_radius ; refine ( drop_distance_squared ( x , y , & params ) < refine_r_sq && level < params . MAXlevel ); fprintf ( stderr , \"Initial grid refinement complete (MAXlevel = %d) \\n \" , params .",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: MAXlevel ); Drop...",
    "content": "MAXlevel ); Drop Initialization Initialize VOF field and velocity field. fraction ( f , params . drop_radius * params . drop_radius - drop_distance_squared ( x , y , & params )); foreach () { u . x [] = params . impact_velocity * f []; u . y [] = 0.0 ; } fprintf ( stderr , \"Initial drop setup complete: \\n \" ); fprintf ( stderr , \" Drop center: (%g, %g) \\n \" , params . drop_x , params . drop_y ); fprintf ( stderr , \" Drop radius: %g \\n \" , params . drop_radius ); fprintf ( stderr , \" Impact velocity: %g \\n \" , params . impact_velocity ); fprintf ( stderr , \"Initialization complete. \\n\\n \" ); } else { fprintf ( stderr , \" \\n Simulation restored from restart file. \\n\\n \" ); } } Event: Adaptive Mesh Refinement Dynamically adapts the mesh based on interface position and flow features.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Refinement criteria: -...",
    "content": "Refinement criteria: - VOF field (interface tracking) - Curvature (surface tension resolution) - Velocity gradients (flow features) Un-refinement near outflow boundaries prevents unnecessary resolution in far-field regions. event adapt ( i ++) { Curvature Calculation Interface curvature needed for surface tension and adaptation criterion. scalar KAPPA []; curvature ( f , KAPPA ); Wavelet-based Adaptation Adapt mesh based on multi-scale wavelet decomposition of fields. adapt_wavelet (( scalar *){ f , KAPPA , u . x , u . y }, ( double []){ params . fErr , params . KErr , params . VelErr , params . VelErr }, params . MAXlevel , params . MINlevel ); Outflow Region Un-refinement Prevent spurious refinement near outflow boundaries where solution should be smooth (no drop, low velocities). unrefine ( x > params . outflow_x_max || y > params . outflow_y_max ); } Event: Statistics Output Calculates and logs flow statistics at regular intervals.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations: Avoids file I/O...",
    "content": "Avoids file I/O performance penalty by: - Keeping log file open throughout simulation - Writing buffered output - Flushing periodically event statistics ( i ++) { // Write statistics at specified interval if ( i % params . log_interval == 0 ) { write_statistics ( i , t , dt , & params ); } } Event: Snapshot Output Saves complete simulation state for: - Restart capability - Post-processing and visualization - Long-term archival Note: The time interval (TSNAP) must be a compile-time constant for Basilisk. The end time (params.tmax) can be a runtime variable. event snapshots ( t = 0 ; t += TSNAP ; t <= params . tmax ) { save_snapshot ( t , & params ); } Event: Cleanup Properly close all files at simulation end. event cleanup ( t = end ) { close_log_files (); fprintf ( stderr , \" \\n Simulation completed successfully. \\n \" ); }",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "qcc-I../src-local-O2-Wall-disable-dimensionsdropImpact.c-odropImpact-lm./dropImpactexamples/default.params",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "./dropImpact<MAXlevel><tmax><We><Ohd><Ohs><Ldomain>[drop_x] [drop_y] [impact_vel]",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - C/C++ Code",
    "content": "// Basilisk includes#include\"axi.h\"// Axisymmetric coordinates#include\"navier-stokes/centered.h\"// Centered NS solver#define FILTERED// Filtered interface for stability#include\"two-phase.h\"// Two-phase flow (VOF method)#include\"navier-stokes/conserving.h\"// Momentum conservation#include\"tension.h\"// Surface tension forces// Local modular headers#include\"params.h\"// Parameter management#include\"geometry.h\"// Geometry and initialization#include\"diagnostics.h\"// Statistics and output",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "#define TSNAP (0.01)// Snapshot interval (fixed at compile time)",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Function: drop_distance_squared",
    "content": "#ifndef drop_distance_squared#define drop_distance_squared(x, y, p) \\((x-(p)->drop_x)*(x-(p)->drop_x)+(y-(p)->drop_y)*(y-(p)->drop_y))#endif",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example: // Left boundary...",
    "content": "// Left boundary (axis of symmetry, x=0)u.t[left]=dirichlet(0.0);// No tangential velocity (azimuthal component)f[left]=dirichlet(0.0);// No fluid crosses axis (ensures symmetry)// Right boundary (outflow, x=Ldomain)u.n[right]=neumann(0.);// Stress-free outflow (du/dn = 0)p[right]=dirichlet(0.0);// Zero reference pressure// Top boundary (outflow, y=Ldomain)u.n[top]=neumann(0.);// Stress-free outflowp[top]=dirichlet(0.0);// Zero reference pressure// Bottom boundary (y=0, solid surface)// Uses default no-slip condition from centered solver",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "./dropImpact <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> ...",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example: if(argc==2&&access(argv[1],F_OK)==0){// Parameter file...",
    "content": "if(argc==2&&access(argv[1],F_OK)==0){// Parameter file modeif(parse_params_from_file(argv[1],&params)!=0){fprintf(stderr,\"ERROR: Failed to parse parameter file\\n\");return1;}}elseif(argc>=7){// Command line mode (legacy compatibility)if(parse_params_from_cli(argc,(char**)argv,&params)!=0){return1;}}else{// Print usage and exitfprintf(stderr,\"Usage:\\n\");fprintf(stderr,\"  %s <params_file>\\n\",argv[0]);fprintf(stderr,\"  %s <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> [drop_x] [drop_y] [impact_vel]\\n\",argv[0]);fprintf(stderr,\"\\nParameter file format: key=value (one per line)\\n\");fprintf(stderr,\"See examples/default.params for template\\n\");return1;}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "if(!validate_params(&params)){fprintf(stderr,\"ERROR: Parameter validation failed. Exiting.\\n\");return1;}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "L0=params.Ldomain;// Domain sizeX0=0.;// Origin at axisY0=0.;// Origin at surfaceinit_grid(1<<params.init_grid_level);// Initial grid: 2^init_grid_level",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "rho1=1.0;// Drop density (normalized)mu1=params.Ohd/sqrt(params.We);// Drop viscosity from Oh and Werho2=params.rho_ratio;// Gas densitymu2=params.Ohs/sqrt(params.We);// Gas viscosityf.sigma=1.0/params.We;// Surface tension from We",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "create_output_directory(params.output_dir);open_log_files(&params);",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "event init(t=0){charrestart_path[512];snprintf(restart_path,sizeof(restart_path),\"%s/restart\",params.output_dir);if(!restore(file=restart_path)){// No restart file found - initialize from scratchfprintf(stderr,\"\\nInitializing simulation from initial conditions...\\n\");",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "constdoublerefine_margin=1.05;constdoublerefine_r_sq=refine_margin*refine_margin*params.drop_radius*params.drop_radius;refine(drop_distance_squared(x,y,&params)<refine_r_sq&&level<params.MAXlevel);fprintf(stderr,\"Initial grid refinement complete (MAXlevel = %d)\\n\",params.MAXlevel);",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "fraction(f,params.drop_radius*params.drop_radius-drop_distance_squared(x,y,&params));foreach(){u.x[]=params.impact_velocity*f[];u.y[]=0.0;}fprintf(stderr,\"Initial drop setup complete:\\n\");fprintf(stderr,\"  Drop center: (%g, %g)\\n\",params.drop_x,params.drop_y);fprintf(stderr,\"  Drop radius: %g\\n\",params.drop_radius);fprintf(stderr,\"  Impact velocity: %g\\n\",params.impact_velocity);fprintf(stderr,\"Initialization complete.\\n\\n\");}else{fprintf(stderr,\"\\nSimulation restored from restart file.\\n\\n\");}}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "adapt_wavelet((scalar*){f,KAPPA,u.x,u.y},(double[]){params.fErr,params.KErr,params.VelErr,params.VelErr},params.MAXlevel,params.MINlevel);",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "unrefine(x>params.outflow_x_max||y>params.outflow_y_max);}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "event statistics(i++){// Write statistics at specified intervalif(i%params.log_interval==0){write_statistics(i,t,dt,&params);}}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "event snapshots(t=0;t+=TSNAP;t<=params.tmax){save_snapshot(t,&params);}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact.c | Drop Impact Simulations - Code Example",
    "content": "event cleanup(t=end){close_log_files();fprintf(stderr,\"\\nSimulation completed successfully.\\n\");}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runSnellius_legacy.sbatch | Drop Impact Simulations: Context",
    "content": "simulationCases/runSnellius_legacy.sbatch See raw file runSnellius_legacy.sbatch #!/bin/bash #SBATCH --job-name=jumpingDrops #SBATCH --nodes=1 #SBATCH --ntasks=48 #SBATCH --cpus-per-task=1 #SBATCH --time=1:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=vatsal.sanjay@comphy-lab.org #SBATCH --output=slurm-%j.out #SBATCH --error=slurm-%j.err # # runSnellius_legacy.sbatch # # Legacy SLURM submission script for Snellius.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/runSnellius_legacy.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runSnellius_legacy.sbatch | Drop Impact Simulations: Compiles and runs...",
    "content": "Compiles and runs # `dropImpact_legacy.c` with fixed parameters. # # ## Usage # `sbatch runSnellius_legacy.sbatch` # # ## Outputs # - SLURM logs: `slurm-%j.out` and `slurm-%j.err` # set -euo pipefail # ============================================================ # Paths # ============================================================ SCRIPT_FILE_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" PROJECT_ROOT = \" \\$ (cd \" \\$ {SCRIPT_FILE_DIR}/.. \" && pwd)\" # Load required modules module purge module load 2024 module load OpenMPI/5.0.3-GCC-13.3.0 # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" cd \" \\$ PROJECT_ROOT\" if ! command -v curl &> /dev/null ; then echo \"ERROR: curl not found (required for Basilisk install)\" >& 2 exit 1 fi BASILISK_REF = \"v2026-01-13\" BASILISK_INSTALL_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\" LOCK_FILE = \" \\$ {PROJECT_ROOT}/basilisk/.comphy-lock\" LOCK_REF = \"\" if [ -f \" \\$ LOCK_FILE\" ] ; then LOCK_REF = \" \\$ (awk -F= ' \\$ 1==\" ref \"{print \\$ 2; exit}' \" \\$ LOCK_FILE \" 2>/dev/null || true)\" fi if [ ! -f \" \\$ LOCK_FILE\" ] || [ \" \\$ LOCK_REF\" != \" \\$ BASILISK_REF\" ] ; then echo \"Lock mismatch or missing (found ref=' \\$ {LOCK_REF:-none}') - performing hard install...\" curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" --hard else curl -fsSL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" fi if [ -f \" \\$ {PROJECT_ROOT}/.project_config\" ] ; then source \" \\$ {PROJECT_ROOT}/.project_config\" else echo \"ERROR: .project_config not found after Basilisk install\" >& 2 exit 1 fi # Print diagnostic information echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Number of MPI tasks: \\$ {SLURM_NTASKS}\" LEVEL = \"10\" tmax = \"8e0\" We = \"1e1\" Ohd = \"4e-3\" Ohs = \"1e-5\" Ldomain = \"4\" cd \" \\$ SCRIPT_FILE_DIR\" CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions dropImpact_legacy.c -o dropImpact_legacy -lm # Run the simulation srun JumpingDrops_Snellius \\$ LEVEL \\$ tmax \\$ We \\$ Ohd \\$ Ohs \\$ Ldomain echo \"Job completed at: \\$ (date)\"",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/runSnellius_legacy.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/runSnellius_legacy.sbatch | Drop Impact Simulations - Code Example: #!/bin/bash#SBATCH --job-name=jumpingDrops#SBATCH --nodes=1#SBATCH...",
    "content": "#!/bin/bash#SBATCH --job-name=jumpingDrops#SBATCH --nodes=1#SBATCH --ntasks=48#SBATCH --cpus-per-task=1#SBATCH --time=1:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=vatsal.sanjay@comphy-lab.org#SBATCH --output=slurm-%j.out#SBATCH --error=slurm-%j.err# # runSnellius_legacy.sbatch## Legacy SLURM submission script for Snellius.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/runSnellius_legacy.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/runSnellius_legacy.sbatch | Drop Impact Simulations - Code Example: Compiles and runs#...",
    "content": "Compiles and runs# `dropImpact_legacy.c` with fixed parameters.## ## Usage# `sbatch runSnellius_legacy.sbatch`## ## Outputs# - SLURM logs: `slurm-%j.out` and `slurm-%j.err`#set-euopipefail# ============================================================# Paths# ============================================================SCRIPT_FILE_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"PROJECT_ROOT=\"\\$(cd \"\\${SCRIPT_FILE_DIR}/..\" && pwd)\"# Load required modulesmodulepurgemoduleload 2024moduleload OpenMPI/5.0.3-GCC-13.3.0# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"cd\"\\$PROJECT_ROOT\"if!command-vcurl&>/dev/null;thenecho\"ERROR: curl not found (required for Basilisk install)\">&2exit1fiBASILISK_REF=\"v2026-01-13\"BASILISK_INSTALL_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\"LOCK_FILE=\"\\${PROJECT_ROOT}/basilisk/.comphy-lock\"LOCK_REF=\"\"if[-f\"\\$LOCK_FILE\"];thenLOCK_REF=\"\\$(awk -F= '\\$1==\"ref\"{print\\$2; exit}' \"\\$LOCK_FILE\" 2>/dev/null || true)\"fiif[!-f\"\\$LOCK_FILE\"]||[\"\\$LOCK_REF\"!=\"\\$BASILISK_REF\"];thenecho\"Lock mismatch or missing (found ref='\\${LOCK_REF:-none}') - performing hard install...\"curl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"--hardelsecurl-fsSL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"fiif[-f\"\\${PROJECT_ROOT}/.project_config\"];thensource\"\\${PROJECT_ROOT}/.project_config\"elseecho\"ERROR: .project_config not found after Basilisk install\">&2exit1fi# Print diagnostic informationecho\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Number of MPI tasks:\\${SLURM_NTASKS}\"LEVEL=\"10\"tmax=\"8e0\"We=\"1e1\"Ohd=\"4e-3\"Ohs=\"1e-5\"Ldomain=\"4\"cd\"\\$SCRIPT_FILE_DIR\"CC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-Wall-O2-D_MPI=1-disable-dimensionsdropImpact_legacy.c-odropImpact_legacy-lm# Run the simulationsrunJumpingDrops_Snellius\\$LEVEL\\$tmax\\$We\\$Ohd\\$Ohs\\$Ldomainecho\"Job completed at:\\$(date)\"",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/runSnellius_legacy.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations: Context",
    "content": "simulationCases/dropImpact_legacy.c See raw file dropImpact_legacy.c Legacy axisymmetric drop-impact simulation in a single Basilisk file. Usage (legacy CLI) ./dropImpact_legacy <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> Notes Uses fixed error tolerances and a hard-coded initial drop location. Writes snapshots to intermediate/ and logs to log .",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations: C/C++ Code",
    "content": "Author Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University Original date: 2022-02-08 // 1 is drop #include \"axi.h\" #include \"navier-stokes/centered.h\" #define FILTERED #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" // Error tolerances #define fErr (1e-3) // error tolerance in VOF #define KErr (1e-6) // error tolerance in KAPPA #define VelErr (1e-2) // error tolerances in velocity // air-water #define Rho21 (1e-3) // Calculations! #define Xdist (1.02) #define R2Drop(x,y) (sq(x - Xdist) + sq(y)) // boundary conditions u . t [ left ] = dirichlet ( 0.0 ); f [ left ] = dirichlet ( 0.0 ); u . n [ right ] = neumann ( 0. ); p [ right ] = dirichlet ( 0.0 ); u . n [ top ] = neumann ( 0. ); p [ top ] = dirichlet ( 0.0 ); int MAXlevel ; double tmax , We , Ohd , Ohs , Bo , Ldomain ; #define MINlevel // maximum level #define tsnap (0.01) int main ( int argc , char const * argv []) { if ( argc < 7 ){ fprintf ( ferr , \"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations: Check! Need %d...",
    "content": "Check! Need %d more arguments \\n \" , 8 - argc ); return 1 ; } MAXlevel = atoi ( argv [ 1 ]); tmax = atof ( argv [ 2 ]); We = atof ( argv [ 3 ]); // We is 1 for 0.22 m/s <1250*0.22^2*0.001/0.06> Ohd = atof ( argv [ 4 ]); // <\\mu/sqrt(1250*0.060*0.001)> Ohs = atof ( argv [ 5 ]); //\\mu_r * Ohd Ldomain = atof ( argv [ 6 ]); // size of domain. must keep Ldomain \\gg fprintf ( ferr , \"Level %d tmax %g.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations: We %g, Ohd...",
    "content": "We %g, Ohd %3.2e, Ohs %3.2e, Bo %g, Lo %g \\n \" , MAXlevel , tmax , We , Ohd , Ohs , Bo , Ldomain ); L0 = Ldomain ; X0 = 0. ; Y0 = 0. ; init_grid ( 1 << ( 6 )); char comm [ 4096 ]; snprintf ( comm , sizeof ( comm ), \"mkdir -p intermediate\" ); system ( comm ); rho1 = 1.0 ; mu1 = Ohd / sqrt ( We ); rho2 = Rho21 ; mu2 = Ohs / sqrt ( We ); f . sigma = 1.0 / We ; run (); } event init ( t = 0 ){ if (! restore ( file = \"restart\" )){ refine (( R2Drop ( x , y ) < 1.05 ) && ( level < MAXlevel )); fraction ( f , 1. - R2Drop ( x , y )); foreach () { u . x [] = - 1.0 * f []; u . y [] = 0.0 ; } } } event adapt ( i ++){ scalar KAPPA []; curvature ( f , KAPPA ); adapt_wavelet (( scalar *){ f , KAPPA , u . x , u . y }, ( double []){ fErr , KErr , VelErr , VelErr }, MAXlevel , MINlevel ); unrefine ( x > 0.95 * Ldomain || y > 4e0 ); // ensure there is no backflow from the outflow walls! } // Outputs // static event writingFiles ( t = 0 , t += tsnap ; t <= tmax ) { dump ( file = \"restart\" ); char nameOut [ 4096 ]; snprintf ( nameOut , sizeof ( nameOut ), \"intermediate/snapshot-%5.4f\" , t ); dump ( file = nameOut ); } event logWriting ( i ++) { double ke = 0. ; foreach ( reduction (+: ke )){ ke += 2 * pi * y *( 0.5 * rho ( f [])*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); } static FILE * fp ; if ( i == 0 ) { fprintf ( ferr , \"i dt t ke p \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d tmax %g.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations: We %g, Ohd...",
    "content": "We %g, Ohd %3.2e, Ohs %3.2e \\n \" , MAXlevel , tmax , We , Ohd , Ohs ); fprintf ( fp , \"i dt t ke \\n \" ); fprintf ( fp , \"%d %g %g %g \\n \" , i , dt , t , ke ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"%d %g %g %g \\n \" , i , dt , t , ke ); fclose ( fp ); } fprintf ( ferr , \"%d %g %g %g \\n \" , i , dt , t , ke ); }",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations - Code Example",
    "content": "./dropImpact_legacy <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain>",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations - C/C++ Code: C/C++ Code",
    "content": "// 1 is drop#include\"axi.h\"#include\"navier-stokes/centered.h\"#define FILTERED#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"// Error tolerances#define fErr (1e-3)// error tolerance in VOF#define KErr (1e-6)// error tolerance in KAPPA#define VelErr (1e-2)// error tolerances in velocity// air-water#define Rho21 (1e-3)// Calculations!#define Xdist (1.02)#define R2Drop(x,y) (sq(x - Xdist) + sq(y))// boundary conditionsu.t[left]=dirichlet(0.0);f[left]=dirichlet(0.0);u.n[right]=neumann(0.);p[right]=dirichlet(0.0);u.n[top]=neumann(0.);p[top]=dirichlet(0.0);intMAXlevel;doubletmax,We,Ohd,Ohs,Bo,Ldomain;#define MINlevel// maximum level#define tsnap (0.01)intmain(intargc,charconst*argv[]){if(argc<7){fprintf(ferr,\"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations - C/C++ Code: Check! Need %d...",
    "content": "Check! Need %d more arguments\\n\",8-argc);return1;}MAXlevel=atoi(argv[1]);tmax=atof(argv[2]);We=atof(argv[3]);// We is 1 for 0.22 m/s <1250*0.22^2*0.001/0.06>Ohd=atof(argv[4]);// <\\mu/sqrt(1250*0.060*0.001)>Ohs=atof(argv[5]);//\\mu_r * OhdLdomain=atof(argv[6]);// size of domain. must keep Ldomain \\ggfprintf(ferr,\"Level %d tmax %g.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations - C/C++ Code: We %g, Ohd...",
    "content": "We %g, Ohd %3.2e, Ohs %3.2e, Bo %g, Lo %g\\n\",MAXlevel,tmax,We,Ohd,Ohs,Bo,Ldomain);L0=Ldomain;X0=0.;Y0=0.;init_grid(1<<(6));charcomm[4096];snprintf(comm,sizeof(comm),\"mkdir -p intermediate\");system(comm);rho1=1.0;mu1=Ohd/sqrt(We);rho2=Rho21;mu2=Ohs/sqrt(We);f.sigma=1.0/We;run();}event init(t=0){if(!restore(file=\"restart\")){refine((R2Drop(x,y)<1.05)&&(level<MAXlevel));fraction(f,1.-R2Drop(x,y));foreach(){u.x[]=-1.0*f[];u.y[]=0.0;}}}event adapt(i++){scalar KAPPA[];curvature(f,KAPPA);adapt_wavelet((scalar*){f,KAPPA,u.x,u.y},(double[]){fErr,KErr,VelErr,VelErr},MAXlevel,MINlevel);unrefine(x>0.95*Ldomain||y>4e0);// ensure there is no backflow from the outflow walls!}// Outputs// staticevent writingFiles(t=0,t+=tsnap;t<=tmax){dump(file=\"restart\");charnameOut[4096];snprintf(nameOut,sizeof(nameOut),\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}event logWriting(i++){doubleke=0.;foreach(reduction(+:ke)){ke+=2*pi*y*(0.5*rho(f[])*(sq(u.x[])+sq(u.y[])))*sq(Delta);}staticFILE*fp;if(i==0){fprintf(ferr,\"i dt t ke p\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level %d tmax %g.",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/dropImpact_legacy.c | Drop Impact Simulations - C/C++ Code: We %g, Ohd...",
    "content": "We %g, Ohd %3.2e, Ohs %3.2e\\n\",MAXlevel,tmax,We,Ohd,Ohs);fprintf(fp,\"i dt t ke\\n\");fprintf(fp,\"%d %g %g %g\\n\",i,dt,t,ke);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d %g %g %g\\n\",i,dt,t,ke);fclose(fp);}fprintf(ferr,\"%d %g %g %g\\n\",i,dt,t,ke);}",
    "url": "https://comphy-lab.org/Drop-Impact/simulationCases/dropImpact_legacy.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files diagnostics.h Statistics and output helpers for drop impact simulations. geometry.h Geometry helpers and initialization macros for drop impact simulations. params.h Parameter management for drop impact simulations. Defines the configuration structure plus helpers to parse, validate... parse_params.sh parseparamfile() { local paramfile=\\$1 if [ ! -f '\\$paramfile' ]; then echo 'ERROR: Parameter file \\$paramfile not fo...",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: Context",
    "content": "src-local/params.h See raw file params.h Parameter management for drop impact simulations. Defines the configuration structure plus helpers to parse, validate, scale, and print parameters.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: Python Function",
    "content": "Author Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University #ifndef PARAMS_H #define PARAMS_H // Minimal includes needed for this header // Most standard library functions are available through Basilisk includes #include <ctype.h> // For isspace() #include <sys/stat.h> // For mkdir() #include <errno.h> // For errno SimulationParams Consolidates all simulation parameters in one structure for: - Easy parameter passing - Configuration file I/O - Parameter validation - Self-documenting code struct SimulationParams { // Case identification int CaseNo ; < Case number for folder naming (4-digit: 1000-9999) // Physical parameters (dimensionless numbers) double We ; < Weber number: \u03c1U\u00b2R/\u03c3 (inertia vs surface tension) double Ohd ; < Ohnesorge number (drop): \u03bc/\u221a(\u03c1\u03c3R) double Ohs ; < Ohnesorge number (surrounding fluid) double rho_ratio ; < Density ratio: \u03c1_surrounding/\u03c1_drop // Geometry parameters double Ldomain ; < Domain size in drop radii double drop_x ; < Initial drop center x-position (radii) double drop_y ; < Initial drop center y-position (radii) double drop_radius ; < Drop radius (normalized, typically 1.0) double impact_velocity ; < Initial impact velocity (negative = downward) // Numerical parameters (mesh adaptation) int MAXlevel ; < Maximum refinement level (2^MAXlevel cells) int MINlevel ; < Minimum refinement level int init_grid_level ; < Initial grid level: 2^init_grid_level double fErr ; < VOF error tolerance for adaptation double KErr ; < Curvature error tolerance double VelErr ; < Velocity error tolerance // Time control double tmax ; < Maximum simulation time double tsnap ; < Snapshot interval for dump files // Output configuration char output_dir [ 256 ]; < Output directory path int log_interval ; < Write statistics every N iterations // Outflow boundary control double outflow_x_max ; < Unrefine if x > this value (in drop radii) double outflow_y_max ; < Unrefine if y > this value (in drop radii) }; set_default_params() Populate the parameter structure with default values representative of a water drop impacting a solid surface in air. static inline void set_default_params ( struct SimulationParams * p ) { // Case identification p -> CaseNo = 1000 ; // Default case number // Physical parameters (water-air system) p -> We = 10.0 ; p -> Ohd = 5.0e-3 ; p -> Ohs = 1.0e-5 ; p -> rho_ratio = 1.0e-3 ; // Air/water density ratio // Geometry p -> Ldomain = 8.0 ; p -> drop_x = 1.5 ; p -> drop_y = 1.0 ; p -> drop_radius = 1.0 ; p -> impact_velocity = - 1.0 ; // Unit velocity downward // Numerical parameters p -> MAXlevel = 10 ; p -> MINlevel = 4 ; p -> init_grid_level = 6 ; p -> fErr = 1.0e-3 ; p -> KErr = 1.0e-6 ; p -> VelErr = 1.0e-2 ; // Time control p -> tmax = 4.0 ; p -> tsnap = 0.01 ; // Output strcpy ( p -> output_dir , \"results\" ); p -> log_interval = 1 ; // Outflow boundaries p -> outflow_x_max = 11.0 ; p -> outflow_y_max = 4.0 ; } parse_params_from_file() Parse parameters from a key=value configuration file.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters filename : path to parameter file p : parameter structure to populate Returns 0 on success -1 on error static inline int parse_params_from_file ( const char * filename , struct SimulationParams * p ) { FILE * fp = fopen ( filename , \"r\" ); if (! fp ) { fprintf ( stderr , \"ERROR: Cannot open parameter file: %s \\n \" , filename ); return - 1 ; } // Start with defaults set_default_params ( p ); char line [ 512 ]; int line_num = 0 ; while ( fgets ( line , sizeof ( line ), fp )) { line_num ++; // Skip comments and empty lines char * hash = strchr ( line , '#' ); if ( hash ) * hash = '\\0' ; // Trim whitespace char * start = line ; while (* start && isspace (* start )) start ++; if (* start == '\\0' ) continue ; // Parse key=value char * eq = strchr ( start , '=' ); if (! eq ) continue ; * eq = '\\0' ; char * key = start ; char * value = eq + 1 ; // Trim trailing whitespace from key char * end = key + strlen ( key ) - 1 ; while ( end > key && isspace (* end )) * end -- = '\\0' ; // Trim whitespace from value while (* value && isspace (* value )) value ++; end = value + strlen ( value ) - 1 ; while ( end > value && isspace (* end )) * end -- = '\\0' ; // Parse based on key if ( strcmp ( key , \"CaseNo\" ) == 0 ) p -> CaseNo = atoi ( value ); else if ( strcmp ( key , \"We\" ) == 0 ) p -> We = atof ( value ); else if ( strcmp ( key , \"Ohd\" ) == 0 ) p -> Ohd = atof ( value ); else if ( strcmp ( key , \"Ohs\" ) == 0 ) p -> Ohs = atof ( value ); else if ( strcmp ( key , \"rho_ratio\" ) == 0 ) p -> rho_ratio = atof ( value ); else if ( strcmp ( key , \"Ldomain\" ) == 0 ) p -> Ldomain = atof ( value ); else if ( strcmp ( key , \"drop_x\" ) == 0 ) p -> drop_x = atof ( value ); else if ( strcmp ( key , \"drop_y\" ) == 0 ) p -> drop_y = atof ( value ); else if ( strcmp ( key , \"drop_radius\" ) == 0 ) p -> drop_radius = atof ( value ); else if ( strcmp ( key , \"impact_velocity\" ) == 0 ) p -> impact_velocity = atof ( value ); else if ( strcmp ( key , \"MAXlevel\" ) == 0 ) p -> MAXlevel = atoi ( value ); else if ( strcmp ( key , \"MINlevel\" ) == 0 ) p -> MINlevel = atoi ( value ); else if ( strcmp ( key , \"init_grid_level\" ) == 0 ) p -> init_grid_level = atoi ( value ); else if ( strcmp ( key , \"fErr\" ) == 0 ) p -> fErr = atof ( value ); else if ( strcmp ( key , \"KErr\" ) == 0 ) p -> KErr = atof ( value ); else if ( strcmp ( key , \"VelErr\" ) == 0 ) p -> VelErr = atof ( value ); else if ( strcmp ( key , \"tmax\" ) == 0 ) p -> tmax = atof ( value ); else if ( strcmp ( key , \"tsnap\" ) == 0 ) p -> tsnap = atof ( value ); else if ( strcmp ( key , \"output_dir\" ) == 0 ) strncpy ( p -> output_dir , value , sizeof ( p -> output_dir )- 1 ); else if ( strcmp ( key , \"log_interval\" ) == 0 ) p -> log_interval = atoi ( value ); else if ( strcmp ( key , \"outflow_x_max\" ) == 0 ) p -> outflow_x_max = atof ( value ); else if ( strcmp ( key , \"outflow_y_max\" ) == 0 ) p -> outflow_y_max = atof ( value ); else { fprintf ( stderr , \"WARNING: Unknown parameter '%s' at line %d \\n \" , key , line_num ); } } fclose ( fp ); return 0 ; } parse_params_from_cli() Parse parameters from legacy CLI arguments.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: Parameters argc :...",
    "content": "Parameters argc : argument count argv : argument values p : parameter structure to populate Returns 0 on success -1 on error Legacy format: MAXlevel tmax We Ohd Ohs Ldomain [drop_x] [drop_y] [impact_vel] static inline int parse_params_from_cli ( int argc , char ** argv , struct SimulationParams * p ) { // Start with defaults set_default_params ( p ); if ( argc < 7 ) { fprintf ( stderr , \"ERROR: Insufficient command line arguments \\n \" ); fprintf ( stderr , \"Required: <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain> \\n \" ); fprintf ( stderr , \"Optional: [drop_x] [drop_y] [impact_velocity] \\n \" ); return - 1 ; } // Required parameters p -> MAXlevel = atoi ( argv [ 1 ]); p -> tmax = atof ( argv [ 2 ]); p -> We = atof ( argv [ 3 ]); p -> Ohd = atof ( argv [ 4 ]); p -> Ohs = atof ( argv [ 5 ]); p -> Ldomain = atof ( argv [ 6 ]); // Optional parameters if ( argc > 7 ) p -> drop_x = atof ( argv [ 7 ]); if ( argc > 8 ) p -> drop_y = atof ( argv [ 8 ]); if ( argc > 9 ) p -> impact_velocity = atof ( argv [ 9 ]); return 0 ; } validate_params() Check physical constraints and consistency.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters p : parameter structure Returns 1 if valid 0 if invalid static inline int validate_params ( const struct SimulationParams * p ) { int valid = 1 ; // Case number must be in valid range if ( p -> CaseNo < 1000 || p -> CaseNo > 9999 ) { fprintf ( stderr , \"ERROR: CaseNo must be 4-digit (1000-9999), got %d \\n \" , p -> CaseNo ); valid = 0 ; } // Physical parameters must be positive if ( p -> We <= 0 ) { fprintf ( stderr , \"ERROR: Weber number must be positive (We = %g) \\n \" , p -> We ); valid = 0 ; } if ( p -> Ohd <= 0 ) { fprintf ( stderr , \"ERROR: Ohnesorge (drop) must be positive (Ohd = %g) \\n \" , p -> Ohd ); valid = 0 ; } if ( p -> Ohs <= 0 ) { fprintf ( stderr , \"ERROR: Ohnesorge (surrounding) must be positive (Ohs = %g) \\n \" , p -> Ohs ); valid = 0 ; } if ( p -> rho_ratio <= 0 ) { fprintf ( stderr , \"ERROR: Density ratio must be positive (rho_ratio = %g) \\n \" , p -> rho_ratio ); valid = 0 ; } // Geometry constraints if ( p -> Ldomain <= 2.0 * p -> drop_radius ) { fprintf ( stderr , \"ERROR: Domain too small (Ldomain = %g, need > 2*drop_radius) \\n \" , p -> Ldomain ); valid = 0 ; } if ( p -> drop_radius <= 0 ) { fprintf ( stderr , \"ERROR: Drop radius must be positive (drop_radius = %g) \\n \" , p -> drop_radius ); valid = 0 ; } // Numerical parameters if ( p -> MAXlevel < p -> MINlevel ) { fprintf ( stderr , \"ERROR: MAXlevel (%d) must be >= MINlevel (%d) \\n \" , p -> MAXlevel , p -> MINlevel ); valid = 0 ; } if ( p -> MAXlevel > 15 ) { fprintf ( stderr , \"WARNING: Very high MAXlevel (%d) may cause memory issues \\n \" , p -> MAXlevel ); } if ( p -> MINlevel < 2 ) { fprintf ( stderr , \"ERROR: MINlevel (%d) must be >= \\n \" , p -> MINlevel ); valid = 0 ; } // Error tolerances if ( p -> fErr <= 0 || p -> KErr <= 0 || p -> VelErr <= 0 ) { fprintf ( stderr , \"ERROR: Error tolerances must be positive \\n \" ); valid = 0 ; } // Time parameters if ( p -> tmax <= 0 ) { fprintf ( stderr , \"ERROR: tmax must be positive (tmax = %g) \\n \" , p -> tmax ); valid = 0 ; } if ( p -> tsnap <= 0 || p -> tsnap > p -> tmax ) { fprintf ( stderr , \"ERROR: Invalid tsnap (tsnap = %g, tmax = %g) \\n \" , p -> tsnap , p -> tmax ); valid = 0 ; } return valid ; } apply_physics_scaling() Scale tmax by sqrt(We) to convert from convective time units to the simulation time units.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: Physical basis: the...",
    "content": "Physical basis: the convective timescale is tau_c = R/U , which corresponds to sqrt(We) in the normalized units used here. static inline void apply_physics_scaling ( struct SimulationParams * p ) { double tmax_input = p -> tmax ; p -> tmax = tmax_input * sqrt ( p -> We ); fprintf ( stderr , \"INFO: tmax scaled: %.4g * sqrt(We=%.3g) = %.4g \\n \" , tmax_input , p -> We , p -> tmax ); } print_params() Print a formatted parameter summary for logging and verification.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters p : parameter structure fp : file pointer for output (stderr or log file) static inline void print_params ( const struct SimulationParams * p , FILE * fp ) { fprintf ( fp , \" \\n \" ); fprintf ( fp , \"======================================== \\n \" ); fprintf ( fp , \"Drop Impact Simulation Configuration \\n \" ); fprintf ( fp , \"======================================== \\n \" ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Case Identification: \\n \" ); fprintf ( fp , \" Case Number: %04d \\n \" , p -> CaseNo ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Physical Parameters: \\n \" ); fprintf ( fp , \" Weber number (We): %g \\n \" , p -> We ); fprintf ( fp , \" Ohnesorge (drop): %g \\n \" , p -> Ohd ); fprintf ( fp , \" Ohnesorge (surround): %g \\n \" , p -> Ohs ); fprintf ( fp , \" Density ratio: %g \\n \" , p -> rho_ratio ); fprintf ( fp , \" Reynolds (drop): %g \\n \" , sqrt ( p -> We ) / p -> Ohd ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Geometry: \\n \" ); fprintf ( fp , \" Domain size (Ldomain): %g \\n \" , p -> Ldomain ); fprintf ( fp , \" Drop position (x, y): (%g, %g) \\n \" , p -> drop_x , p -> drop_y ); fprintf ( fp , \" Drop radius: %g \\n \" , p -> drop_radius ); fprintf ( fp , \" Impact velocity: %g \\n \" , p -> impact_velocity ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Numerical Settings: \\n \" ); fprintf ( fp , \" Grid levels (min/max): %d / %d \\n \" , p -> MINlevel , p -> MAXlevel ); fprintf ( fp , \" Initial grid level: %d (2^%d = %d cells) \\n \" , p -> init_grid_level , p -> init_grid_level , 1 << p -> init_grid_level ); fprintf ( fp , \" Error tolerances: \\n \" ); fprintf ( fp , \" VOF (fErr): %g \\n \" , p -> fErr ); fprintf ( fp , \" Curvature (KErr): %g \\n \" , p -> KErr ); fprintf ( fp , \" Velocity (VelErr): %g \\n \" , p -> VelErr ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Time Control: \\n \" ); fprintf ( fp , \" Maximum time (tmax): %g \\n \" , p -> tmax ); fprintf ( fp , \" Snapshot interval: %g \\n \" , p -> tsnap ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"Output: \\n \" ); fprintf ( fp , \" Output directory: %s \\n \" , p -> output_dir ); fprintf ( fp , \" Log interval: %d iterations \\n \" , p -> log_interval ); fprintf ( fp , \" \\n \" ); fprintf ( fp , \"======================================== \\n \" ); fprintf ( fp , \" \\n \" ); fflush ( fp ); } create_output_directory() Create an output directory if it does not exist.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters dirname : directory path Returns 0 on success -1 on error static inline int create_output_directory ( const char * dirname ) { struct stat st = { 0 }; if ( stat ( dirname , & st ) == - 1 ) { if ( mkdir ( dirname , 0755 ) == - 1 ) { fprintf ( stderr , \"WARNING: Could not create directory '%s': %s \\n \" , dirname , strerror ( errno )); return - 1 ; } fprintf ( stderr , \"Created output directory: %s \\n \" , dirname ); } return 0 ; } #endif // PARAMS_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Function: PARAMS_H",
    "content": "#ifndef PARAMS_H#define PARAMS_H// Minimal includes needed for this header// Most standard library functions are available through Basilisk includes#include<ctype.h>// For isspace()#include<sys/stat.h>// For mkdir()#include<errno.h>// For errno",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "structSimulationParams{// Case identificationintCaseNo;",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "// Physical parameters (dimensionless numbers)doubleWe;",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "// Numerical parameters (mesh adaptation)intMAXlevel;",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example: Context",
    "content": "staticinlinevoidset_default_params(structSimulationParams*p){// Case identificationp->CaseNo=1000;// Default case number// Physical parameters (water-air system)p->We=10.0;p->Ohd=5.0e-3;p->Ohs=1.0e-5;p->rho_ratio=1.0e-3;// Air/water density ratio// Geometryp->Ldomain=8.0;p->drop_x=1.5;p->drop_y=1.0;p->drop_radius=1.0;p->impact_velocity=-1.0;// Unit velocity downward// Numerical parametersp->MAXlevel=10;p->MINlevel=4;p->init_grid_level=6;p->fErr=1.0e-3;p->KErr=1.0e-6;p->VelErr=1.0e-2;// Time controlp->tmax=4.0;p->tsnap=0.01;// Outputstrcpy(p->output_dir,\"results\");p->log_interval=1;// Outflow boundariesp->outflow_x_max=11.0;p->outflow_y_max=4.0;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example: Context",
    "content": "staticinlineintparse_params_from_file(constchar*filename,structSimulationParams*p){FILE*fp=fopen(filename,\"r\");if(!fp){fprintf(stderr,\"ERROR: Cannot open parameter file: %s\\n\",filename);return-1;}// Start with defaultsset_default_params(p);charline[512];intline_num=0;while(fgets(line,sizeof(line),fp)){line_num++;// Skip comments and empty lineschar*hash=strchr(line,'#');if(hash)*hash='\\0';// Trim whitespacechar*start=line;while(*start&&isspace(*start))start++;if(*start=='\\0')continue;// Parse key=valuechar*eq=strchr(start,'=');if(!eq)continue;*eq='\\0';char*key=start;char*value=eq+1;// Trim trailing whitespace from keychar*end=key+strlen(key)-1;while(end>key&&isspace(*end))*end--='\\0';// Trim whitespace from valuewhile(*value&&isspace(*value))value++;end=value+strlen(value)-1;while(end>value&&isspace(*end))*end--='\\0';// Parse based on keyif(strcmp(key,\"CaseNo\")==0)p->CaseNo=atoi(value);elseif(strcmp(key,\"We\")==0)p->We=atof(value);elseif(strcmp(key,\"Ohd\")==0)p->Ohd=atof(value);elseif(strcmp(key,\"Ohs\")==0)p->Ohs=atof(value);elseif(strcmp(key,\"rho_ratio\")==0)p->rho_ratio=atof(value);elseif(strcmp(key,\"Ldomain\")==0)p->Ldomain=atof(value);elseif(strcmp(key,\"drop_x\")==0)p->drop_x=atof(value);elseif(strcmp(key,\"drop_y\")==0)p->drop_y=atof(value);elseif(strcmp(key,\"drop_radius\")==0)p->drop_radius=atof(value);elseif(strcmp(key,\"impact_velocity\")==0)p->impact_velocity=atof(value);elseif(strcmp(key,\"MAXlevel\")==0)p->MAXlevel=atoi(value);elseif(strcmp(key,\"MINlevel\")==0)p->MINlevel=atoi(value);elseif(strcmp(key,\"init_grid_level\")==0)p->init_grid_level=atoi(value);elseif(strcmp(key,\"fErr\")==0)p->fErr=atof(value);elseif(strcmp(key,\"KErr\")==0)p->KErr=atof(value);elseif(strcmp(key,\"VelErr\")==0)p->VelErr=atof(value);elseif(strcmp(key,\"tmax\")==0)p->tmax=atof(value);elseif(strcmp(key,\"tsnap\")==0)p->tsnap=atof(value);elseif(strcmp(key,\"output_dir\")==0)strncpy(p->output_dir,value,sizeof(p->output_dir)-1);elseif(strcmp(key,\"log_interval\")==0)p->log_interval=atoi(value);elseif(strcmp(key,\"outflow_x_max\")==0)p->outflow_x_max=atof(value);elseif(strcmp(key,\"outflow_y_max\")==0)p->outflow_y_max=atof(value);else{fprintf(stderr,\"WARNING: Unknown parameter '%s' at line %d\\n\",key,line_num);}}fclose(fp);return0;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "MAXlevel tmax We Ohd Ohs Ldomain [drop_x] [drop_y] [impact_vel]",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example: staticinlineintparse_params_from_cli(intargc,char**argv,structSimulationParams*p){// Start with...",
    "content": "staticinlineintparse_params_from_cli(intargc,char**argv,structSimulationParams*p){// Start with defaultsset_default_params(p);if(argc<7){fprintf(stderr,\"ERROR: Insufficient command line arguments\\n\");fprintf(stderr,\"Required: <MAXlevel> <tmax> <We> <Ohd> <Ohs> <Ldomain>\\n\");fprintf(stderr,\"Optional: [drop_x] [drop_y] [impact_velocity]\\n\");return-1;}// Required parametersp->MAXlevel=atoi(argv[1]);p->tmax=atof(argv[2]);p->We=atof(argv[3]);p->Ohd=atof(argv[4]);p->Ohs=atof(argv[5]);p->Ldomain=atof(argv[6]);// Optional parametersif(argc>7)p->drop_x=atof(argv[7]);if(argc>8)p->drop_y=atof(argv[8]);if(argc>9)p->impact_velocity=atof(argv[9]);return0;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example: staticinlineintvalidate_params(conststructSimulationParams*p){intvalid=1;// Case number...",
    "content": "staticinlineintvalidate_params(conststructSimulationParams*p){intvalid=1;// Case number must be in valid rangeif(p->CaseNo<1000||p->CaseNo>9999){fprintf(stderr,\"ERROR: CaseNo must be 4-digit (1000-9999), got %d\\n\",p->CaseNo);valid=0;}// Physical parameters must be positiveif(p->We<=0){fprintf(stderr,\"ERROR: Weber number must be positive (We = %g)\\n\",p->We);valid=0;}if(p->Ohd<=0){fprintf(stderr,\"ERROR: Ohnesorge (drop) must be positive (Ohd = %g)\\n\",p->Ohd);valid=0;}if(p->Ohs<=0){fprintf(stderr,\"ERROR: Ohnesorge (surrounding) must be positive (Ohs = %g)\\n\",p->Ohs);valid=0;}if(p->rho_ratio<=0){fprintf(stderr,\"ERROR: Density ratio must be positive (rho_ratio = %g)\\n\",p->rho_ratio);valid=0;}// Geometry constraintsif(p->Ldomain<=2.0*p->drop_radius){fprintf(stderr,\"ERROR: Domain too small (Ldomain = %g, need > 2*drop_radius)\\n\",p->Ldomain);valid=0;}if(p->drop_radius<=0){fprintf(stderr,\"ERROR: Drop radius must be positive (drop_radius = %g)\\n\",p->drop_radius);valid=0;}// Numerical parametersif(p->MAXlevel<p->MINlevel){fprintf(stderr,\"ERROR: MAXlevel (%d) must be >= MINlevel (%d)\\n\",p->MAXlevel,p->MINlevel);valid=0;}if(p->MAXlevel>15){fprintf(stderr,\"WARNING: Very high MAXlevel (%d) may cause memory issues\\n\",p->MAXlevel);}if(p->MINlevel<2){fprintf(stderr,\"ERROR: MINlevel (%d) must be >=\\n\",p->MINlevel);valid=0;}// Error tolerancesif(p->fErr<=0||p->KErr<=0||p->VelErr<=0){fprintf(stderr,\"ERROR: Error tolerances must be positive\\n\");valid=0;}// Time parametersif(p->tmax<=0){fprintf(stderr,\"ERROR: tmax must be positive (tmax = %g)\\n\",p->tmax);valid=0;}if(p->tsnap<=0||p->tsnap>p->tmax){fprintf(stderr,\"ERROR: Invalid tsnap (tsnap = %g, tmax = %g)\\n\",p->tsnap,p->tmax);valid=0;}returnvalid;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinevoidapply_physics_scaling(structSimulationParams*p){doubletmax_input=p->tmax;p->tmax=tmax_input*sqrt(p->We);fprintf(stderr,\"INFO: tmax scaled: %.4g * sqrt(We=%.3g) = %.4g\\n\",tmax_input,p->We,p->tmax);}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example: Context",
    "content": "staticinlinevoidprint_params(conststructSimulationParams*p,FILE*fp){fprintf(fp,\"\\n\");fprintf(fp,\"========================================\\n\");fprintf(fp,\"Drop Impact Simulation Configuration\\n\");fprintf(fp,\"========================================\\n\");fprintf(fp,\"\\n\");fprintf(fp,\"Case Identification:\\n\");fprintf(fp,\"  Case Number:              %04d\\n\",p->CaseNo);fprintf(fp,\"\\n\");fprintf(fp,\"Physical Parameters:\\n\");fprintf(fp,\"  Weber number (We):        %g\\n\",p->We);fprintf(fp,\"  Ohnesorge (drop):         %g\\n\",p->Ohd);fprintf(fp,\"  Ohnesorge (surround):     %g\\n\",p->Ohs);fprintf(fp,\"  Density ratio:            %g\\n\",p->rho_ratio);fprintf(fp,\"  Reynolds (drop):          %g\\n\",sqrt(p->We)/p->Ohd);fprintf(fp,\"\\n\");fprintf(fp,\"Geometry:\\n\");fprintf(fp,\"  Domain size (Ldomain):    %g\\n\",p->Ldomain);fprintf(fp,\"  Drop position (x, y):     (%g, %g)\\n\",p->drop_x,p->drop_y);fprintf(fp,\"  Drop radius:              %g\\n\",p->drop_radius);fprintf(fp,\"  Impact velocity:          %g\\n\",p->impact_velocity);fprintf(fp,\"\\n\");fprintf(fp,\"Numerical Settings:\\n\");fprintf(fp,\"  Grid levels (min/max):    %d / %d\\n\",p->MINlevel,p->MAXlevel);fprintf(fp,\"  Initial grid level:       %d (2^%d = %d cells)\\n\",p->init_grid_level,p->init_grid_level,1<<p->init_grid_level);fprintf(fp,\"  Error tolerances:\\n\");fprintf(fp,\"    VOF (fErr):             %g\\n\",p->fErr);fprintf(fp,\"    Curvature (KErr):       %g\\n\",p->KErr);fprintf(fp,\"    Velocity (VelErr):      %g\\n\",p->VelErr);fprintf(fp,\"\\n\");fprintf(fp,\"Time Control:\\n\");fprintf(fp,\"  Maximum time (tmax):      %g\\n\",p->tmax);fprintf(fp,\"  Snapshot interval:        %g\\n\",p->tsnap);fprintf(fp,\"\\n\");fprintf(fp,\"Output:\\n\");fprintf(fp,\"  Output directory:         %s\\n\",p->output_dir);fprintf(fp,\"  Log interval:             %d iterations\\n\",p->log_interval);fprintf(fp,\"\\n\");fprintf(fp,\"========================================\\n\");fprintf(fp,\"\\n\");fflush(fp);}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/params.h | Drop Impact Simulations - Code Example",
    "content": "staticinlineintcreate_output_directory(constchar*dirname){structstat st={0};if(stat(dirname,&st)==-1){if(mkdir(dirname,0755)==-1){fprintf(stderr,\"WARNING: Could not create directory '%s': %s\\n\",dirname,strerror(errno));return-1;}fprintf(stderr,\"Created output directory: %s\\n\",dirname);}return0;}#endif// PARAMS_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/params.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Drop Impact Simulations: Context",
    "content": "src-local/parse_params.sh See raw file parse_params.sh #!/bin/bash # # parse_params.sh # # Shell library for parsing key=value parameter files and generating sweep # case files.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Drop Impact Simulations: Source this file...",
    "content": "Source this file in scripts that need `parse_param_file()` and # related helpers. # # ## Usage # `source src-local/parse_params.sh` # # ## Provides # - `parse_param_file`: load parameters into `PARAM_*` variables # - `get_param`: query a parameter with a default # - `generate_sweep_cases`: build a temp directory of sweep cases # - `validate_required_params`: ensure required keys exist # Parse a parameter file and export all parameters as environment variables # Usage: parse_param_file <file> parse_param_file() { local param_file = \\$ 1 if [ ! -f \" \\$ param_file\" ] ; then echo \"ERROR: Parameter file \\$ param_file not found\" >& 2 return 1 fi # Read parameters (skip comments and empty lines) while IFS = '=' read -r key value || [ -n \" \\$ key\" ] ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) key = \\$ ( echo \" \\$ key\" | xargs ) # Skip if key or value is empty [ -z \" \\$ key\" ] && continue [ -z \" \\$ value\" ] && continue # Export as environment variable with PARAM_ prefix export \"PARAM_ \\$ {key}= \\$ {value}\" done < \" \\$ param_file\" return 0 } # Get a parameter value with optional default # Usage: get_param <key> [default] get_param() { local key = \\$ 1 local default = \\$ {2:-} local var_name = \"PARAM_ \\$ {key}\" echo \" \\$ {!var_name:- \\$ default}\" } # Generate sweep combinations and create parameter files # Usage: generate_sweep_cases <sweep_file> # Returns: directory containing generated parameter files generate_sweep_cases() { local sweep_file = \\$ 1 if [ ! -f \" \\$ sweep_file\" ] ; then echo \"ERROR: Sweep file \\$ sweep_file not found\" >& 2 return 1 fi # Source the sweep file to get variables source \" \\$ sweep_file\" # Check if BASE_CONFIG is defined if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 return 1 fi # Parse base configuration parse_param_file \" \\$ BASE_CONFIG\" # Create temporary directory for generated cases local temp_dir = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) # Extract sweep variables local sweep_vars = () local sweep_values = () while IFS = '=' read -r line ; do # Remove comments line = \\$ ( echo \" \\$ line\" | sed 's/#.*//' ) [ -z \" \\$ line\" ] && continue # Match SWEEP_* variables if [[ \" \\$ line\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) = ( .+ ) \\$ ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" var_values = \" \\$ {BASH_REMATCH[2]}\" sweep_vars += ( \" \\$ var_name\" ) sweep_values += ( \" \\$ var_values\" ) fi done < \" \\$ sweep_file\" if [ \\$ {#sweep_vars[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ sweep_file\" >& 2 rm -rf \" \\$ temp_dir\" return 1 fi # Generate cartesian product of sweep values local case_num = 0 # Recursive function to generate all combinations generate_recursive() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#sweep_vars[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {temp_dir}/case_ \\$ (printf \" %04d \" \\$ case_num).params\" local output_dir = \" \\$ OUTPUT_TEMPLATE\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override with sweep values for i in \" \\$ {!sweep_vars[@]}\" ; do local var = \" \\$ {sweep_vars[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" # Replace in parameter file if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i.bak \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Replace in output template output_dir = \" \\$ {output_dir//\\{ \\$ {var}\\}/ \\$ {val}}\" done # Set output directory if grep -q \"^output_dir=\" \" \\$ case_file\" ; then sed -i.bak \"s|^output_dir=.*|output_dir= \\$ {output_dir}|\" \" \\$ case_file\" else echo \"output_dir= \\$ {output_dir}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" (( case_num ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {sweep_values[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_recursive \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion generate_recursive 0 echo \" \\$ temp_dir\" return 0 } # Validate that required variables are set in parameter file # Usage: validate_required_params <param1> <param2> ... validate_required_params() { local missing = 0 for param in \" \\$ @\" ; do local var_name = \"PARAM_ \\$ {param}\" if [ -z \" \\$ {!var_name}\" ] ; then echo \"ERROR: Required parameter ' \\$ param' not found\" >& 2 missing = 1 fi done return \\$missing } # Print all loaded parameters (for debugging) print_params() { echo \"Loaded parameters:\" env | grep \"^PARAM_\" | sort | while IFS = '=' read -r key value ; do key = \" \\$ {key#PARAM_}\" echo \" \\$ key = \\$ value\" done }",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Drop Impact Simulations - Code Example: Context",
    "content": "#!/bin/bash# # parse_params.sh## Shell library for parsing key=value parameter files and generating sweep# case files.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Drop Impact Simulations - Code Example: Source this file...",
    "content": "Source this file in scripts that need `parse_param_file()` and# related helpers.## ## Usage# `source src-local/parse_params.sh`## ## Provides# - `parse_param_file`: load parameters into `PARAM_*` variables# - `get_param`: query a parameter with a default# - `generate_sweep_cases`: build a temp directory of sweep cases# - `validate_required_params`: ensure required keys exist# Parse a parameter file and export all parameters as environment variables# Usage: parse_param_file <file>parse_param_file(){localparam_file=\\$1if[!-f\"\\$param_file\"];thenecho\"ERROR: Parameter file\\$param_file not found\">&2return1fi# Read parameters (skip comments and empty lines)whileIFS='='read-rkeyvalue||[-n\"\\$key\"];do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)key=\\$(echo\"\\$key\"|xargs)# Skip if key or value is empty[-z\"\\$key\"]&&continue[-z\"\\$value\"]&&continue# Export as environment variable with PARAM_ prefixexport\"PARAM_\\${key}=\\${value}\"done<\"\\$param_file\"return0}# Get a parameter value with optional default# Usage: get_param <key> [default]get_param(){localkey=\\$1localdefault=\\${2:-}localvar_name=\"PARAM_\\${key}\"echo\"\\${!var_name:-\\$default}\"}# Generate sweep combinations and create parameter files# Usage: generate_sweep_cases <sweep_file># Returns: directory containing generated parameter filesgenerate_sweep_cases(){localsweep_file=\\$1if[!-f\"\\$sweep_file\"];thenecho\"ERROR: Sweep file\\$sweep_file not found\">&2return1fi# Source the sweep file to get variablessource\"\\$sweep_file\"# Check if BASE_CONFIG is definedif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2return1fi# Parse base configurationparse_param_file\"\\$BASE_CONFIG\"# Create temporary directory for generated caseslocaltemp_dir=\\$(mktemp -d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")# Extract sweep variableslocalsweep_vars=()localsweep_values=()whileIFS='='read-rline;do# Remove commentsline=\\$(echo\"\\$line\"|sed's/#.*//')[-z\"\\$line\"]&&continue# Match SWEEP_* variablesif[[\"\\$line\"=~^[[:space:]]*SWEEP_([^=]+)=(.+)\\$]];thenvar_name=\"\\${BASH_REMATCH[1]}\"var_values=\"\\${BASH_REMATCH[2]}\"sweep_vars+=(\"\\$var_name\")sweep_values+=(\"\\$var_values\")fidone<\"\\$sweep_file\"if[\\${#sweep_vars[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$sweep_file\">&2rm-rf\"\\$temp_dir\"return1fi# Generate cartesian product of sweep valueslocalcase_num=0# Recursive function to generate all combinationsgenerate_recursive(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#sweep_vars[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${temp_dir}/case_\\$(printf \"%04d\"\\$case_num).params\"localoutput_dir=\"\\$OUTPUT_TEMPLATE\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override with sweep valuesforiin\"\\${!sweep_vars[@]}\";dolocalvar=\"\\${sweep_vars[\\$i]}\"localval=\"\\${current_values[\\$i]}\"# Replace in parameter fileifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i.bak\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Replace in output templateoutput_dir=\"\\${output_dir//\\{\\${var}\\}/\\${val}}\"done# Set output directoryifgrep-q\"^output_dir=\"\"\\$case_file\";thensed-i.bak\"s|^output_dir=.*|output_dir=\\${output_dir}|\"\"\\$case_file\"elseecho\"output_dir=\\${output_dir}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"((case_num++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${sweep_values[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_recursive\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursiongenerate_recursive0echo\"\\$temp_dir\"return0}# Validate that required variables are set in parameter file# Usage: validate_required_params <param1> <param2> ...validate_required_params(){localmissing=0forparamin\"\\$@\";dolocalvar_name=\"PARAM_\\${param}\"if[-z\"\\${!var_name}\"];thenecho\"ERROR: Required parameter '\\$param' not found\">&2missing=1fidonereturn\\$missing}# Print all loaded parameters (for debugging)print_params(){echo\"Loaded parameters:\"env|grep\"^PARAM_\"|sort|whileIFS='='read-rkeyvalue;dokey=\"\\${key#PARAM_}\"echo\"\\$key =\\$value\"done}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations: Context",
    "content": "src-local/geometry.h See raw file geometry.h Geometry helpers and initialization macros for drop impact simulations. Provides Drop geometry calculations Initial grid refinement Initial condition setup Hooks for custom shapes Author Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University #ifndef GEOMETRY_H #define GEOMETRY_H #include \"params.h\" drop_distance_squared() Squared distance from the drop center in axisymmetric coordinates. Parameters x : radial coordinate y : axial coordinate p : parameter structure containing drop_x , drop_y Returns Squared distance from the drop center. Implemented as a macro for compatibility with Basilisk\u2019s qcc preprocessor. #define drop_distance_squared(x, y, p) \\ (( x - ( p )-> drop_x ) * ( x - ( p )-> drop_x ) + ( y - ( p )-> drop_y ) * ( y - ( p )-> drop_y )) is_inside_drop() Return 1 if a point is inside the drop, 0 otherwise.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters x : radial coordinate y : axial coordinate p : parameter structure static inline int is_inside_drop ( double x , double y , const struct SimulationParams * p ) { double r_sq = drop_distance_squared ( x , y , p ); double radius_sq = p -> drop_radius * p -> drop_radius ; return ( r_sq < radius_sq ) ? 1 : 0 ; } Initialization Macros These are macros rather than functions because they use Basilisk grid traversal constructs ( refine , fraction , foreach ) that must be expanded in the calling context. REFINE_INITIAL_GRID() Refine the initial grid around the drop interface. The refinement region extends slightly beyond the drop radius for a smoother interface.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations: JavaScript",
    "content": "Usage REFINE_INITIAL_GRID(params); #define REFINE_INITIAL_GRID(p) do { \\ const double _margin = 1.05 ; \\ const double _refine_r_sq = _margin * _margin * ( p )-> drop_radius * ( p )-> drop_radius ; \\ refine ( drop_distance_squared ( x , y , ( p )) < _refine_r_sq && level < ( p )-> MAXlevel ); \\ fprintf ( stderr , \"Initial grid refinement complete (MAXlevel = %d) \\n \" , ( p )-> MAXlevel ); \\ } while ( 0 ) SETUP_INITIAL_DROP() Initialize the VOF field and velocity field for the drop: - f = 1 inside the drop, 0 outside - u.x set to the impact velocity inside the drop - u.y set to zero everywhere Usage SETUP_INITIAL_DROP(params); #define SETUP_INITIAL_DROP(p) do { \\ fraction ( f , ( p )-> drop_radius * ( p )-> drop_radius - drop_distance_squared ( x , y , ( p ))); \\ foreach () { \\ u . x [] = ( p )-> impact_velocity * f []; \\ u . y [] = 0.0 ; \\ } \\ fprintf ( stderr , \"Initial drop setup complete: \\n \" ); \\ fprintf ( stderr , \" Drop center: (%g, %g) \\n \" , ( p )-> drop_x , ( p )-> drop_y ); \\ fprintf ( stderr , \" Drop radius: %g \\n \" , ( p )-> drop_radius ); \\ fprintf ( stderr , \" Impact velocity: %g \\n \" , ( p )-> impact_velocity ); \\ } while ( 0 ) Custom Shapes (optional) Enable ENABLE_CUSTOM_SHAPES to supply a custom shape function for the drop.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations: Python Function",
    "content": "Potential extensions include ellipsoids, deformed drops, or multiple drops. #ifdef ENABLE_CUSTOM_SHAPES typedef double (* ShapeFunction )( double x , double y , const struct SimulationParams * p ); static inline void setup_custom_drop ( ShapeFunction shape_func , const struct SimulationParams * p ) { fraction ( f , shape_func ( x , y , p )); foreach () { u . x [] = p -> impact_velocity * f []; u . y [] = 0.0 ; } } #endif #endif // GEOMETRY_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Function: GEOMETRY_H",
    "content": "#ifndef GEOMETRY_H#define GEOMETRY_H#include\"params.h\"",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Code Example",
    "content": "#define drop_distance_squared(x, y, p) \\((x-(p)->drop_x)*(x-(p)->drop_x)+(y-(p)->drop_y)*(y-(p)->drop_y))",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Code Example",
    "content": "staticinlineintis_inside_drop(doublex,doubley,conststructSimulationParams*p){doubler_sq=drop_distance_squared(x,y,p);doubleradius_sq=p->drop_radius*p->drop_radius;return(r_sq<radius_sq)?1:0;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Code Example",
    "content": "#define REFINE_INITIAL_GRID(p) do { \\constdouble_margin=1.05;\\constdouble_refine_r_sq=_margin*_margin*(p)->drop_radius*(p)->drop_radius;\\refine(drop_distance_squared(x,y,(p))<_refine_r_sq&&level<(p)->MAXlevel);\\fprintf(stderr,\"Initial grid refinement complete (MAXlevel = %d)\\n\",(p)->MAXlevel);\\}while(0)",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Code Example",
    "content": "#define SETUP_INITIAL_DROP(p) do { \\fraction(f,(p)->drop_radius*(p)->drop_radius-drop_distance_squared(x,y,(p)));\\foreach(){\\u.x[]=(p)->impact_velocity*f[];\\u.y[]=0.0;\\}\\fprintf(stderr,\"Initial drop setup complete:\\n\");\\fprintf(stderr,\"  Drop center: (%g, %g)\\n\",(p)->drop_x,(p)->drop_y);\\fprintf(stderr,\"  Drop radius: %g\\n\",(p)->drop_radius);\\fprintf(stderr,\"  Impact velocity: %g\\n\",(p)->impact_velocity);\\}while(0)",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/geometry.h | Drop Impact Simulations - Function: ENABLE_CUSTOM_SHAPEStypedefdouble",
    "content": "#ifdef ENABLE_CUSTOM_SHAPEStypedefdouble(*ShapeFunction)(doublex,doubley,conststructSimulationParams*p);staticinlinevoidsetup_custom_drop(ShapeFunction shape_func,conststructSimulationParams*p){fraction(f,shape_func(x,y,p));foreach(){u.x[]=p->impact_velocity*f[];u.y[]=0.0;}}#endif#endif// GEOMETRY_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/geometry.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations: Context",
    "content": "src-local/diagnostics.h See raw file diagnostics.h Statistics and output helpers for drop impact simulations. Provides File handle management (open once, write many) Statistics calculations (kinetic energy, etc.) Snapshot management Extension hooks for additional diagnostics Author Vatsal Sanjay (vatsal.sanjay@comphy-lab.org) CoMPhy Lab, Durham University #ifndef DIAGNOSTICS_H #define DIAGNOSTICS_H #include \"params.h\" // Global file handles (kept open for performance) static FILE * log_fp = NULL ; open_log_files() Open log files and write headers. The log file stays open for the entire simulation to avoid repeated open/close overhead.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters p : parameter structure Returns 0 on success -1 on error static inline int open_log_files ( const struct SimulationParams * p ) { // Create intermediate directory for snapshots char intermediate_dir [ 512 ]; snprintf ( intermediate_dir , sizeof ( intermediate_dir ), \"%s/intermediate\" , p -> output_dir ); create_output_directory ( intermediate_dir ); // Open main log file char log_path [ 512 ]; snprintf ( log_path , sizeof ( log_path ), \"%s/log\" , p -> output_dir ); log_fp = fopen ( log_path , \"w\" ); if (! log_fp ) { fprintf ( stderr , \"ERROR: Cannot open log file: %s \\n \" , log_path ); return - 1 ; } // Write header with full parameter information fprintf ( log_fp , \"# Drop Impact Simulation Log \\n \" ); fprintf ( log_fp , \"# Parameters: \\n \" ); fprintf ( log_fp , \"# We = %g, Ohd = %g, Ohs = %g \\n \" , p -> We , p -> Ohd , p -> Ohs ); fprintf ( log_fp , \"# rho_ratio = %g, Re = %g \\n \" , p -> rho_ratio , sqrt ( p -> We ) / p -> Ohd ); fprintf ( log_fp , \"# Ldomain = %g, MAXlevel = %d, MINlevel = %d \\n \" , p -> Ldomain , p -> MAXlevel , p -> MINlevel ); fprintf ( log_fp , \"# drop_position = (%g, %g), radius = %g \\n \" , p -> drop_x , p -> drop_y , p -> drop_radius ); fprintf ( log_fp , \"# impact_velocity = %g, tmax = %g \\n \" , p -> impact_velocity , p -> tmax ); fprintf ( log_fp , \"# Columns: iteration dt time kinetic_energy \\n \" ); fflush ( log_fp ); fprintf ( stderr , \"Log file opened: %s \\n \" , log_path ); return 0 ; } calculate_kinetic_energy() Return total kinetic energy integrated over the domain.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations: For axisymmetric flow:...",
    "content": "For axisymmetric flow: KE = \u222b 2\u03c0y * 0.5 \u03c1 (u_x^2 + u_y^2) dV static inline double calculate_kinetic_energy ( void ) { double ke = 0.0 ; foreach ( reduction (+: ke )) { // Axisymmetric volume element: 2\u03c0y * \u0394x * \u0394y // Density from VOF field f double rho_local = rho ( f []); double u_mag_sq = sq ( u . x []) + sq ( u . y []); ke += 2.0 * M_PI * y * ( 0.5 * rho_local * u_mag_sq ) * sq ( Delta ); } return ke ; } write_statistics() Write iteration, timestep, time, and kinetic energy to the log file. The file handle stays open for performance.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations: Parameters iter :...",
    "content": "Parameters iter : current iteration number time : current simulation time timestep : current timestep size p : parameter structure static inline void write_statistics ( int iter , double time , double timestep , const struct SimulationParams * p ) { if (! log_fp ) { fprintf ( stderr , \"ERROR: Log file not open \\n \" ); return ; } // Calculate statistics double ke = calculate_kinetic_energy (); // Write to log file fprintf ( log_fp , \"%d %g %g %g \\n \" , iter , timestep , time , ke ); fflush ( log_fp ); // Ensure data is written // Also write to stderr for monitoring if ( iter == 0 || iter % 100 == 0 ) { fprintf ( stderr , \"i=%d t=%g dt=%g KE=%g \\n \" , iter , time , timestep , ke ); } } save_snapshot() Save simulation snapshots for restart and post-processing.",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations: JavaScript",
    "content": "Parameters time : current simulation time p : parameter structure static inline void save_snapshot ( double time , const struct SimulationParams * p ) { char filename [ 512 ]; // Save restart file in output directory snprintf ( filename , sizeof ( filename ), \"%s/restart\" , p -> output_dir ); dump ( file = filename ); // Save numbered snapshot in intermediate directory snprintf ( filename , sizeof ( filename ), \"%s/intermediate/snapshot-%5.4f\" , p -> output_dir , time ); dump ( file = filename ); fprintf ( stderr , \"Snapshot saved at t = %g \\n \" , time ); } close_log_files() Close any open log files at the end of the simulation. static inline void close_log_files ( void ) { if ( log_fp ) { fclose ( log_fp ); log_fp = NULL ; fprintf ( stderr , \"Log file closed \\n \" ); } } Optional Diagnostics (ENABLE_ADVANCED_DIAGNOSTICS) Placeholder routines for future extensions: - Drop spreading radius - Contact line position - Interface area - Pressure forces - Energy dissipation #ifdef ENABLE_ADVANCED_DIAGNOSTICS calculate_spreading_radius() Return the maximum radial extent of the drop. static inline double calculate_spreading_radius ( void ) { double r_max = 0.0 ; foreach ( reduction ( max : r_max )) { if ( f [] > 0.5 ) { // Inside drop if ( x > r_max ) r_max = x ; } } return r_max ; } calculate_contact_line_y() Return the contact line y-position (placeholder implementation). static inline double calculate_contact_line_y ( void ) { double y_contact = 0.0 ; // Implementation depends on surface definition // Placeholder for future development return y_contact ; } calculate_interface_area() Return total interface area (2D: length, 3D: area). static inline double calculate_interface_area ( void ) { double area = 0.0 ; foreach ( reduction (+: area )) { // Interface area proportional to |\u2207f| double grad_f_mag = sqrt ( sq (( f [ 1 , 0 ] - f [- 1 , 0 ])/( 2.0 * Delta )) + sq (( f [ 0 , 1 ] - f [ 0 ,- 1 ])/( 2.0 * Delta ))); if ( grad_f_mag > 0.1 ) { // Near interface area += 2.0 * M_PI * y * grad_f_mag * sq ( Delta ); } } return area ; } #endif // ENABLE_ADVANCED_DIAGNOSTICS #endif // DIAGNOSTICS_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Function: DIAGNOSTICS_H",
    "content": "#ifndef DIAGNOSTICS_H#define DIAGNOSTICS_H#include\"params.h\"// Global file handles (kept open for performance)staticFILE*log_fp=NULL;",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example: staticinlineintopen_log_files(conststructSimulationParams*p){// Create intermediate...",
    "content": "staticinlineintopen_log_files(conststructSimulationParams*p){// Create intermediate directory for snapshotscharintermediate_dir[512];snprintf(intermediate_dir,sizeof(intermediate_dir),\"%s/intermediate\",p->output_dir);create_output_directory(intermediate_dir);// Open main log filecharlog_path[512];snprintf(log_path,sizeof(log_path),\"%s/log\",p->output_dir);log_fp=fopen(log_path,\"w\");if(!log_fp){fprintf(stderr,\"ERROR: Cannot open log file: %s\\n\",log_path);return-1;}// Write header with full parameter informationfprintf(log_fp,\"# Drop Impact Simulation Log\\n\");fprintf(log_fp,\"# Parameters:\\n\");fprintf(log_fp,\"#   We = %g, Ohd = %g, Ohs = %g\\n\",p->We,p->Ohd,p->Ohs);fprintf(log_fp,\"#   rho_ratio = %g, Re = %g\\n\",p->rho_ratio,sqrt(p->We)/p->Ohd);fprintf(log_fp,\"#   Ldomain = %g, MAXlevel = %d, MINlevel = %d\\n\",p->Ldomain,p->MAXlevel,p->MINlevel);fprintf(log_fp,\"#   drop_position = (%g, %g), radius = %g\\n\",p->drop_x,p->drop_y,p->drop_radius);fprintf(log_fp,\"#   impact_velocity = %g, tmax = %g\\n\",p->impact_velocity,p->tmax);fprintf(log_fp,\"# Columns: iteration  dt  time  kinetic_energy\\n\");fflush(log_fp);fprintf(stderr,\"Log file opened: %s\\n\",log_path);return0;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinedoublecalculate_kinetic_energy(void){doubleke=0.0;foreach(reduction(+:ke)){// Axisymmetric volume element: 2\u03c0y * \u0394x * \u0394y// Density from VOF field fdoublerho_local=rho(f[]);doubleu_mag_sq=sq(u.x[])+sq(u.y[]);ke+=2.0*M_PI*y*(0.5*rho_local*u_mag_sq)*sq(Delta);}returnke;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinevoidwrite_statistics(intiter,doubletime,doubletimestep,conststructSimulationParams*p){if(!log_fp){fprintf(stderr,\"ERROR: Log file not open\\n\");return;}// Calculate statisticsdoubleke=calculate_kinetic_energy();// Write to log filefprintf(log_fp,\"%d %g %g %g\\n\",iter,timestep,time,ke);fflush(log_fp);// Ensure data is written// Also write to stderr for monitoringif(iter==0||iter%100==0){fprintf(stderr,\"i=%d  t=%g  dt=%g  KE=%g\\n\",iter,time,timestep,ke);}}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinevoidsave_snapshot(doubletime,conststructSimulationParams*p){charfilename[512];// Save restart file in output directorysnprintf(filename,sizeof(filename),\"%s/restart\",p->output_dir);dump(file=filename);// Save numbered snapshot in intermediate directorysnprintf(filename,sizeof(filename),\"%s/intermediate/snapshot-%5.4f\",p->output_dir,time);dump(file=filename);fprintf(stderr,\"Snapshot saved at t = %g\\n\",time);}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinevoidclose_log_files(void){if(log_fp){fclose(log_fp);log_fp=NULL;fprintf(stderr,\"Log file closed\\n\");}}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinedoublecalculate_spreading_radius(void){doubler_max=0.0;foreach(reduction(max:r_max)){if(f[]>0.5){// Inside dropif(x>r_max)r_max=x;}}returnr_max;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinedoublecalculate_contact_line_y(void){doubley_contact=0.0;// Implementation depends on surface definition// Placeholder for future developmentreturny_contact;}",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/diagnostics.h | Drop Impact Simulations - Code Example",
    "content": "staticinlinedoublecalculate_interface_area(void){doublearea=0.0;foreach(reduction(+:area)){// Interface area proportional to |\u2207f|doublegrad_f_mag=sqrt(sq((f[1,0]-f[-1,0])/(2.0*Delta))+sq((f[0,1]-f[0,-1])/(2.0*Delta)));if(grad_f_mag>0.1){// Near interfacearea+=2.0*M_PI*y*grad_f_mag*sq(Delta);}}returnarea;}#endif// ENABLE_ADVANCED_DIAGNOSTICS#endif// DIAGNOSTICS_H",
    "url": "https://comphy-lab.org/Drop-Impact/src-local/diagnostics.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence: Context",
    "content": "runParameterSweep.sh See raw file runParameterSweep.sh #!/bin/bash # runParameterSweep.sh - Run parameter sweep with auto-incrementing CaseNo # Generates parameter combinations and runs simulations in simulationCases/<CaseNo>/ set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [sweep_file] Run parameter sweep with auto-incrementing CaseNo.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence: Creates case folders...",
    "content": "Creates case folders in simulationCases/<CaseNo>/ for each parameter combination. Cases run sequentially (one at a time). By default, runs Stage 1 (generate restart) then Stage 2 (full simulation) for each case. Stage Selection: --stage1-only Run Stage 1 only for all cases (generate restart files) --stage2-only Run Stage 2 only for all cases (requires existing restart files) (default) Run Stage 1 then Stage 2 for each case Parallelization (for Stage 2, or Stage 1 on Linux): --fopenmp [N] Enable OpenMP with N threads (default: 8, Linux only) --mpi [N] Enable MPI with N cores (default: 2, Stage 2 only) Other Options: -n, --dry-run Show parameter combinations without running -v, --verbose Verbose output -c, --compile-only Compile only, don't run simulations -h, --help Show this help message Parameter sweep file (default): \\$ 0 sweep.params If no sweep file specified, uses sweep.params from current directory.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence: Sweep file format:...",
    "content": "Sweep file format: BASE_CONFIG=default.params CASE_START=1000 CASE_END=1004 SWEEP_Rr=1.00,1.50,2.00,4.00,8.00 CaseNo auto-increments from CASE_START for each parameter combination.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence: Examples",
    "content": "Examples: # Run sweep (Stage 1 + Stage 2 per case, serial) \\$ 0 # Dry run to see parameter combinations \\$ 0 --dry-run # Run only Stage 1 for all cases (generate restart files) \\$ 0 --stage1-only # Run only Stage 2 with MPI (assumes restart files exist) \\$ 0 --stage2-only --mpi 8 # Run full sweep with OpenMP (Linux) \\$ 0 --fopenmp 4 # Run custom sweep file \\$ 0 custom_sweep.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ DRY_RUN = 0 VERBOSE = 0 COMPILE_ONLY = 0 STAGE1_ONLY = 0 STAGE2_ONLY = 0 FOPENMP_ENABLED = 0 FOPENMP_THREADS = 8 MPI_ENABLED = 0 MPI_CORES = 2 while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -c | --compile-only ) COMPILE_ONLY = 1 shift ;; --stage1-only ) STAGE1_ONLY = 1 shift ;; --stage2-only ) STAGE2_ONLY = 1 shift ;; --fopenmp ) FOPENMP_ENABLED = 1 # Check if next arg is a number (optional thread count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then FOPENMP_THREADS = \" \\$ 2\" shift fi shift ;; --mpi ) MPI_ENABLED = 1 # Check if next arg is a number (optional core count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then MPI_CORES = \" \\$ 2\" shift fi shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Validation # ============================================================ # Check mutually exclusive stage flags if [ \\$ STAGE1_ONLY -eq 1 ] && [ \\$ STAGE2_ONLY -eq 1 ] ; then echo \"ERROR: Cannot use both --stage1-only and --stage2-only\" >& 2 exit 1 fi # Check --mpi only with stage2 if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE1_ONLY -eq 1 ] ; then echo \"ERROR: --mpi is only valid for Stage 2 (use --stage2-only or default both-stages mode)\" >& 2 exit 1 fi # Check --mpi and --fopenmp are mutually exclusive if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"ERROR: --mpi and --fopenmp are mutually exclusive\" >& 2 exit 1 fi # ============================================================ # Determine Sweep File # ============================================================ SWEEP_FILE = \" \\$ {1:-sweep.params}\" if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"=========================================\" echo \"Bubble Coalescence - Parameter Sweep\" echo \"=========================================\" echo \"Sweep file: \\$ SWEEP_FILE\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: Dry run (no execution)\" if [ \\$ STAGE1_ONLY -eq 1 ] ; then echo \"Stages: Stage 1 only (generate restart files)\" elif [ \\$ STAGE2_ONLY -eq 1 ] ; then echo \"Stages: Stage 2 only (full simulation)\" else echo \"Stages: Stage 1 + Stage 2 per case\" fi if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Parallelization: MPI ( \\$ MPI_CORES cores)\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Parallelization: OpenMP ( \\$ FOPENMP_THREADS threads)\" else echo \"Parallelization: Serial\" fi echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ # Create temporary directory for generated parameter files TEMP_DIR = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done (( ++ COMBINATION_COUNT )) # Print summary if [ \\$ DRY_RUN -eq 1 ] || [ \\$ VERBOSE -eq 1 ] ; then echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" fi (( CASE_NUM ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+ \" \\$ {current_values[@]}\" } \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # Exit if dry run if [ \\$ DRY_RUN -eq 1 ] ; then echo \"Dry run complete.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence: Context",
    "content": "No simulations executed.\" exit 0 fi # ============================================================ # Run Simulations # ============================================================ echo \"=========================================\" echo \"Running Simulations\" echo \"=========================================\" # Build list of parameter files PARAM_FILES = () for case_file in \" \\$ TEMP_DIR\" /case_ * .params ; do PARAM_FILES += ( \" \\$ case_file\" ) done # Build common flags COMMON_FLAGS = \"\" if [ \\$ COMPILE_ONLY -eq 1 ] ; then COMMON_FLAGS = \" \\$ COMMON_FLAGS --compile-only\" fi if [ \\$ VERBOSE -eq 1 ] ; then COMMON_FLAGS = \" \\$ COMMON_FLAGS --verbose\" fi # Build parallelization flags PARALLEL_FLAGS = \"\" if [ \\$ MPI_ENABLED -eq 1 ] ; then PARALLEL_FLAGS = \"--mpi \\$ MPI_CORES\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then PARALLEL_FLAGS = \"--fopenmp \\$ FOPENMP_THREADS\" fi # Run simulations echo \"Running \\$ COMBINATION_COUNT simulations sequentially\" echo \"\" for param_file in \" \\$ {PARAM_FILES[@]}\" ; do case_no = \\$ ( grep \"^CaseNo=\" \" \\$ param_file\" | cut -d '=' -f2 ) echo \"-----------------------------------------\" echo \"Processing Case \\$ case_no\" echo \"-----------------------------------------\" if [ \\$ STAGE1_ONLY -eq 1 ] ; then # Stage 1 only echo \"Running Stage 1...\" ./runSimulation.sh --stage1 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" elif [ \\$ STAGE2_ONLY -eq 1 ] ; then # Stage 2 only echo \"Running Stage 2...\" ./runSimulation.sh --stage2 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" else # Both stages: Stage 1 then Stage 2 echo \"Running Stage 1...\" ./runSimulation.sh --stage1 \\$ COMMON_FLAGS \" \\$ param_file\" echo \"\" echo \"Running Stage 2...\" ./runSimulation.sh --stage2 \\$ COMMON_FLAGS \\$ PARALLEL_FLAGS \" \\$ param_file\" fi echo \"\" done echo \"=========================================\" echo \"Parameter Sweep Complete\" echo \"=========================================\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Case range: \\$ CASE_START to \\$ ((CASE_START + COMBINATION_COUNT - 1))\" echo \"Output location: simulationCases/\" echo \"\"",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "#!/bin/bash# runParameterSweep.sh - Run parameter sweep with auto-incrementing CaseNo# Generates parameter combinations and runs simulations in simulationCases/<CaseNo>/set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [sweep_file]Run parameter sweep with auto-incrementing CaseNo.Creates case folders in simulationCases/<CaseNo>/ for each parameter combination.Cases run sequentially (one at a time).By default, runs Stage 1 (generate restart) then Stage 2 (full simulation) for each case.Stage Selection:--stage1-only        Run Stage 1 only for all cases (generate restart files)--stage2-only        Run Stage 2 only for all cases (requires existing restart files)(default)            Run Stage 1 then Stage 2 for each caseParallelization (for Stage 2, or Stage 1 on Linux):--fopenmp [N]        Enable OpenMP with N threads (default: 8, Linux only)--mpi [N]            Enable MPI with N cores (default: 2, Stage 2 only)Other Options:-n, --dry-run        Show parameter combinations without running-v, --verbose        Verbose output-c, --compile-only   Compile only, don't run simulations-h, --help           Show this help messageParameter sweep file (default):\\$0 sweep.paramsIf no sweep file specified, uses sweep.params from current directory.Sweep file format:BASE_CONFIG=default.paramsCASE_START=1000CASE_END=1004SWEEP_Rr=1.00,1.50,2.00,4.00,8.00CaseNo auto-increments from CASE_START for each parameter combination.Examples:# Run sweep (Stage 1 + Stage 2 per case, serial)\\$0# Dry run to see parameter combinations\\$0 --dry-run# Run only Stage 1 for all cases (generate restart files)\\$0 --stage1-only# Run only Stage 2 with MPI (assumes restart files exist)\\$0 --stage2-only --mpi 8# Run full sweep with OpenMP (Linux)\\$0 --fopenmp 4# Run custom sweep file\\$0 custom_sweep.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================DRY_RUN=0VERBOSE=0COMPILE_ONLY=0STAGE1_ONLY=0STAGE2_ONLY=0FOPENMP_ENABLED=0FOPENMP_THREADS=8MPI_ENABLED=0MPI_CORES=2while[[\\$#-gt0]];docase\\$1in-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-c|--compile-only)COMPILE_ONLY=1shift;;--stage1-only)STAGE1_ONLY=1shift;;--stage2-only)STAGE2_ONLY=1shift;;--fopenmp)FOPENMP_ENABLED=1# Check if next arg is a number (optional thread count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenFOPENMP_THREADS=\"\\$2\"shiftfishift;;--mpi)MPI_ENABLED=1# Check if next arg is a number (optional core count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenMPI_CORES=\"\\$2\"shiftfishift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Validation# ============================================================# Check mutually exclusive stage flagsif[\\$STAGE1_ONLY-eq1]&&[\\$STAGE2_ONLY-eq1];thenecho\"ERROR: Cannot use both --stage1-only and --stage2-only\">&2exit1fi# Check --mpi only with stage2if[\\$MPI_ENABLED-eq1]&&[\\$STAGE1_ONLY-eq1];thenecho\"ERROR: --mpi is only valid for Stage 2 (use --stage2-only or default both-stages mode)\">&2exit1fi# Check --mpi and --fopenmp are mutually exclusiveif[\\$MPI_ENABLED-eq1]&&[\\$FOPENMP_ENABLED-eq1];thenecho\"ERROR: --mpi and --fopenmp are mutually exclusive\">&2exit1fi# ============================================================# Determine Sweep File# ============================================================SWEEP_FILE=\"\\${1:-sweep.params}\"if[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"=========================================\"echo\"Bubble Coalescence - Parameter Sweep\"echo\"=========================================\"echo\"Sweep file:\\$SWEEP_FILE\"[\\$DRY_RUN-eq1]&&echo\"Mode: Dry run (no execution)\"if[\\$STAGE1_ONLY-eq1];thenecho\"Stages: Stage 1 only (generate restart files)\"elif[\\$STAGE2_ONLY-eq1];thenecho\"Stages: Stage 2 only (full simulation)\"elseecho\"Stages: Stage 1 + Stage 2 per case\"fiif[\\$MPI_ENABLED-eq1];thenecho\"Parallelization: MPI (\\$MPI_CORES cores)\"elif[\\$FOPENMP_ENABLED-eq1];thenecho\"Parallelization: OpenMP (\\$FOPENMP_THREADS threads)\"elseecho\"Parallelization: Serial\"fiecho\"\"# ============================================================# Parse Sweep Configuration# ============================================================# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================# Create temporary directory for generated parameter filesTEMP_DIR=\\$(mktemp-d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"done((++COMBINATION_COUNT))# Print summaryif[\\$DRY_RUN-eq1]||[\\$VERBOSE-eq1];thenecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"fi((CASE_NUM++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\\${current_values[@]+\"\\${current_values[@]}\"}\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# Exit if dry runif[\\$DRY_RUN-eq1];thenecho\"Dry run complete.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runParameterSweep.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "No simulations executed.\"exit0fi# ============================================================# Run Simulations# ============================================================echo\"=========================================\"echo\"Running Simulations\"echo\"=========================================\"# Build list of parameter filesPARAM_FILES=()forcase_filein\"\\$TEMP_DIR\"/case_*.params;doPARAM_FILES+=(\"\\$case_file\")done# Build common flagsCOMMON_FLAGS=\"\"if[\\$COMPILE_ONLY-eq1];thenCOMMON_FLAGS=\"\\$COMMON_FLAGS --compile-only\"fiif[\\$VERBOSE-eq1];thenCOMMON_FLAGS=\"\\$COMMON_FLAGS --verbose\"fi# Build parallelization flagsPARALLEL_FLAGS=\"\"if[\\$MPI_ENABLED-eq1];thenPARALLEL_FLAGS=\"--mpi\\$MPI_CORES\"elif[\\$FOPENMP_ENABLED-eq1];thenPARALLEL_FLAGS=\"--fopenmp\\$FOPENMP_THREADS\"fi# Run simulationsecho\"Running\\$COMBINATION_COUNT simulations sequentially\"echo\"\"forparam_filein\"\\${PARAM_FILES[@]}\";docase_no=\\$(grep\"^CaseNo=\"\"\\$param_file\"|cut-d'='-f2)echo\"-----------------------------------------\"echo\"Processing Case\\$case_no\"echo\"-----------------------------------------\"if[\\$STAGE1_ONLY-eq1];then# Stage 1 onlyecho\"Running Stage 1...\"./runSimulation.sh--stage1\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"elif[\\$STAGE2_ONLY-eq1];then# Stage 2 onlyecho\"Running Stage 2...\"./runSimulation.sh--stage2\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"else# Both stages: Stage 1 then Stage 2echo\"Running Stage 1...\"./runSimulation.sh--stage1\\$COMMON_FLAGS\"\\$param_file\"echo\"\"echo\"Running Stage 2...\"./runSimulation.sh--stage2\\$COMMON_FLAGS\\$PARALLEL_FLAGS\"\\$param_file\"fiecho\"\"doneecho\"=========================================\"echo\"Parameter Sweep Complete\"echo\"=========================================\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Case range:\\$CASE_START to\\$((CASE_START + COMBINATION_COUNT - 1))\"echo\"Output location: simulationCases/\"echo\"\"",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runParameterSweep.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Asymmetries-in-coalescence: Context",
    "content": "runSweepSnellius.sbatch See raw file runSweepSnellius.sbatch #!/bin/bash #SBATCH --job-name=bubbleCoalescence #SBATCH --nodes=1 #SBATCH --ntasks=48 #SBATCH --cpus-per-task=1 #SBATCH --time=100:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=vatsal.sanjay@comphy-lab.org #SBATCH --output=slurm-%j.out #SBATCH --error=slurm-%j.err # ============================================================ # Bubble Coalescence - HPC Parameter Sweep Runner (Snellius) # ============================================================ # This script runs Stage 2 (MPI simulation) on Snellius HPC. # # PREREQUISITE: Restart files must already exist for each case. # Run Stage 1 locally before submitting: # ./runParameterSweep.sh --stage1-only sweep.params # # BEFORE RUNNING: # 1. Run Stage 1 locally to generate restart files for all cases # 2. Edit sweep.params to set parameter ranges and case numbers # 3. Adjust SBATCH parameters above (especially --ntasks, --time) # 4.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Asymmetries-in-coalescence: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepSnellius.sbatch # # SBATCH Parameters to Customize: # --ntasks: Number of MPI tasks per case (currently 48) # --time: Wall time for entire sweep (currently 100 hours) # --partition: Compute partition (currently genoa) # --mail-user: Email for job notifications # ============================================================ set -e # Exit on error (but we'll handle case failures gracefully) # ============================================================ # Configuration # ============================================================ # Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project root SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Bubble Coalescence - HPC Parameter Sweep\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID}\" echo \"Number of MPI tasks: \\$ {SLURM_NTASKS}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION}\" echo \"\" echo \"Mode: Stage 2 only (MPI simulation)\" echo \" Restart files must exist for each case\" echo \"\" # ============================================================ # Load Required Modules # ============================================================ echo \"Loading modules...\" module purge module load 2024 module load OpenMPI/5.0.3-GCC-13.3.0 echo \"Modules loaded successfully\" echo \"\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" # Source version configuration if [ -f \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" else echo \"ERROR: src-local/basilisk_version.sh not found\" >& 2 exit 1 fi echo \"Installing Basilisk (ref: \\$ {BASILISK_REF})...\" install_basilisk --hard if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ BASILISK\" else echo \"ERROR: .project_config not found\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Check sweep file exists if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" # Create temporary directory for generated parameter files # HPC note: Don't use /tmp - use local work directory instead TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true # Print summary echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+ \" \\$ {current_values[@]}\" } \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Run Simulations (Stage 2 Only - MPI) # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Simulations\" echo \"=============================================\" echo \"Stage 2 only: MPI simulation ( \\$ {SLURM_NTASKS} tasks)\" echo \"Requires existing restart files in each case directory\" echo \"\" # Counters for tracking SUCCESSFUL_CASES = 0 FAILED_CASES = 0 SKIPPED_CASES = 0 for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Parse parameter file to get values parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in \\$ param_file\" >& 2 (( FAILED_CASES ++ )) || true continue fi CASE_DIR = \" \\$ {SCRIPT_DIR}/simulationCases/ \\$ {CASE_NO}\" echo \"=========================================\" echo \"Case \\$ CASE_NO ( \\$ (date))\" echo \"=========================================\" echo \"Parameters: OhOut= \\$ OhOut, RhoIn= \\$ RhoIn, Rr= \\$ Rr\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ tmax, zWall= \\$ zWall\" # Check if case directory exists if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"ERROR: Case directory not found: \\$ CASE_DIR\" >& 2 echo \" Run Stage 1 locally first\" >& 2 (( SKIPPED_CASES ++ )) || true continue fi # Change to case directory cd \" \\$ CASE_DIR\" # Check for restart file (CRITICAL) if [ ! -f \"restart\" ] ; then echo \"ERROR: restart file not found for case \\$ CASE_NO\" >& 2 echo \" Run Stage 1 locally first:\" >& 2 echo \" ./runSimulation.sh --stage1 <params_file>\" >& 2 (( SKIPPED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi echo \"Found restart file\" # Use existing case.params if present (allows manual parameter edits) if [ ! -f \" \\$ CASE_DIR/case.params\" ] ; then cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" else echo \"Using existing case.params (manual edits preserved)\" fi # Re-parse from case.params (source of truth) parse_param_file \" \\$ CASE_DIR/case.params\" OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) # Copy source file to case directory if needed SRC_FILE_ORIG = \" \\$ {SCRIPT_DIR}/simulationCases/coalescenceBubble.c\" SRC_FILE_LOCAL = \" \\$ CASE_DIR/coalescenceBubble.c\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi # Use existing source file if present (allows local code edits for reruns) if [ ! -f \" \\$ SRC_FILE_LOCAL\" ] ; then cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" else echo \"Using existing coalescenceBubble.c (local edits preserved)\" fi # Create symlink to DataFiles if needed if [ ! -e \"DataFiles\" ] ; then ln -s ../DataFiles DataFiles fi # ============================================================ # Stage 2: Full Simulation with MPI # ============================================================ echo \"\" echo \"Running Stage 2: Full simulation (MPI)...\" # Compile with MPI if CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ coalescenceBubble.c -o coalescenceBubble -lm 2 >& 1 ; then echo \"MPI compilation successful\" else echo \"ERROR: MPI compilation failed for case \\$ CASE_NO\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi # Run simulation with srun echo \"Running full simulation with \\$ {SLURM_NTASKS} MPI tasks...\" echo \"Command: srun -n \\$ {SLURM_NTASKS} ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" echo \"\" if srun -n \\$ {SLURM_NTASKS} ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall ; then echo \"\" echo \"Case \\$ CASE_NO completed successfully\" (( SUCCESSFUL_CASES ++ )) || true else EXIT_CODE = \\$ ? echo \"\" echo \"ERROR: Case \\$ CASE_NO failed with exit code \\$ EXIT_CODE\" >& 2 (( FAILED_CASES ++ )) || true fi # Return to root directory cd \" \\$ SCRIPT_DIR\" echo \"\" done # ============================================================ # Final Summary # ============================================================ echo \"=============================================\" echo \"Parameter Sweep Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"Skipped (no restart file): \\$ SKIPPED_CASES\" echo \"Output location: simulationCases/\" echo \"=============================================\" echo \"\" # Exit with error if any cases failed or were skipped if [ \\$ FAILED_CASES -gt 0 ] || [ \\$ SKIPPED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed, \\$ SKIPPED_CASES case(s) skipped.\" >& 2 echo \" Check logs for details.\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Asymmetries-in-coalescence - Code Example: #!/bin/bash#SBATCH --job-name=bubbleCoalescence#SBATCH --nodes=1#SBATCH...",
    "content": "#!/bin/bash#SBATCH --job-name=bubbleCoalescence#SBATCH --nodes=1#SBATCH --ntasks=48#SBATCH --cpus-per-task=1#SBATCH --time=100:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=vatsal.sanjay@comphy-lab.org#SBATCH --output=slurm-%j.out#SBATCH --error=slurm-%j.err# ============================================================# Bubble Coalescence - HPC Parameter Sweep Runner (Snellius)# ============================================================# This script runs Stage 2 (MPI simulation) on Snellius HPC.## PREREQUISITE: Restart files must already exist for each case.# Run Stage 1 locally before submitting:#   ./runParameterSweep.sh --stage1-only sweep.params## BEFORE RUNNING:# 1.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Asymmetries-in-coalescence - Code Example: Run Stage 1...",
    "content": "Run Stage 1 locally to generate restart files for all cases# 2. Edit sweep.params to set parameter ranges and case numbers# 3. Adjust SBATCH parameters above (especially --ntasks, --time)# 4.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius.sbatch | Asymmetries-in-coalescence - Code Example: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepSnellius.sbatch## SBATCH Parameters to Customize:#   --ntasks: Number of MPI tasks per case (currently 48)#   --time: Wall time for entire sweep (currently 100 hours)#   --partition: Compute partition (currently genoa)#   --mail-user: Email for job notifications# ============================================================set-e# Exit on error (but we'll handle case failures gracefully)# ============================================================# Configuration# ============================================================# Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project rootSCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Bubble Coalescence - HPC Parameter Sweep\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID}\"echo\"Number of MPI tasks:\\${SLURM_NTASKS}\"echo\"Partition:\\${SLURM_JOB_PARTITION}\"echo\"\"echo\"Mode: Stage 2 only (MPI simulation)\"echo\"      Restart files must exist for each case\"echo\"\"# ============================================================# Load Required Modules# ============================================================echo\"Loading modules...\"modulepurgemoduleload 2024moduleload OpenMPI/5.0.3-GCC-13.3.0echo\"Modules loaded successfully\"echo\"\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"# Source version configurationif[-f\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"elseecho\"ERROR: src-local/basilisk_version.sh not found\">&2exit1fiecho\"Installing Basilisk (ref:\\${BASILISK_REF})...\"install_basilisk--hardif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\$BASILISK\"elseecho\"ERROR: .project_config not found\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Check sweep file existsif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"# Create temporary directory for generated parameter files# HPC note: Don't use /tmp - use local work directory insteadTEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneCASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||true# Print summaryecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\\${current_values[@]+\"\\${current_values[@]}\"}\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Run Simulations (Stage 2 Only - MPI)# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Simulations\"echo\"=============================================\"echo\"Stage 2 only: MPI simulation (\\${SLURM_NTASKS} tasks)\"echo\"Requires existing restart files in each case directory\"echo\"\"# Counters for trackingSUCCESSFUL_CASES=0FAILED_CASES=0SKIPPED_CASES=0forparam_filein\"\\${CASE_FILES[@]}\";do# Parse parameter file to get valuesparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in\\$param_file\">&2((FAILED_CASES++))||truecontinuefiCASE_DIR=\"\\${SCRIPT_DIR}/simulationCases/\\${CASE_NO}\"echo\"=========================================\"echo\"Case\\$CASE_NO (\\$(date))\"echo\"=========================================\"echo\"Parameters: OhOut=\\$OhOut, RhoIn=\\$RhoIn, Rr=\\$Rr\"echo\"            MAXlevel=\\$MAXlevel, tmax=\\$tmax, zWall=\\$zWall\"# Check if case directory existsif[!-d\"\\$CASE_DIR\"];thenecho\"ERROR: Case directory not found:\\$CASE_DIR\">&2echo\"       Run Stage 1 locally first\">&2((SKIPPED_CASES++))||truecontinuefi# Change to case directorycd\"\\$CASE_DIR\"# Check for restart file (CRITICAL)if[!-f\"restart\"];thenecho\"ERROR: restart file not found for case\\$CASE_NO\">&2echo\"       Run Stage 1 locally first:\">&2echo\"       ./runSimulation.sh --stage1 <params_file>\">&2((SKIPPED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefiecho\"Found restart file\"# Use existing case.params if present (allows manual parameter edits)if[!-f\"\\$CASE_DIR/case.params\"];thencp\"\\$param_file\"\"\\$CASE_DIR/case.params\"elseecho\"Using existing case.params (manual edits preserved)\"fi# Re-parse from case.params (source of truth)parse_param_file\"\\$CASE_DIR/case.params\"OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")# Copy source file to case directory if neededSRC_FILE_ORIG=\"\\${SCRIPT_DIR}/simulationCases/coalescenceBubble.c\"SRC_FILE_LOCAL=\"\\$CASE_DIR/coalescenceBubble.c\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefi# Use existing source file if present (allows local code edits for reruns)if[!-f\"\\$SRC_FILE_LOCAL\"];thencp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"elseecho\"Using existing coalescenceBubble.c (local edits preserved)\"fi# Create symlink to DataFiles if neededif[!-e\"DataFiles\"];thenln-s../DataFiles DataFilesfi# ============================================================# Stage 2: Full Simulation with MPI# ============================================================echo\"\"echo\"Running Stage 2: Full simulation (MPI)...\"# Compile with MPIifCC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\coalescenceBubble.c-ocoalescenceBubble-lm2>&1;thenecho\"MPI compilation successful\"elseecho\"ERROR: MPI compilation failed for case\\$CASE_NO\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefi# Run simulation with srunecho\"Running full simulation with\\${SLURM_NTASKS} MPI tasks...\"echo\"Command: srun -n\\${SLURM_NTASKS} ./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"echo\"\"ifsrun-n\\${SLURM_NTASKS} ./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall;thenecho\"\"echo\"Case\\$CASE_NO completed successfully\"((SUCCESSFUL_CASES++))||trueelseEXIT_CODE=\\$?echo\"\"echo\"ERROR: Case\\$CASE_NO failed with exit code\\$EXIT_CODE\">&2((FAILED_CASES++))||truefi# Return to root directorycd\"\\$SCRIPT_DIR\"echo\"\"done# ============================================================# Final Summary# ============================================================echo\"=============================================\"echo\"Parameter Sweep Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"Skipped (no restart file):\\$SKIPPED_CASES\"echo\"Output location: simulationCases/\"echo\"=============================================\"echo\"\"# Exit with error if any cases failed or were skippedif[\\$FAILED_CASES-gt0]||[\\$SKIPPED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed,\\$SKIPPED_CASES case(s) skipped.\">&2echo\"         Check logs for details.\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Asymmetries-in-coalescence Asymmetries in...",
    "content": "Asymmetries-in-coalescence Asymmetries in coalescence: size asymmetry. Still axially symmetric. Basilisk (Required) First-time install (or reinstall): curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref = v2026-01-13 --hard Subsequent runs (reuses existing basilisk/ if same ref): curl -sL https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh | bash -s -- --ref = v2026-01-13 Note : Replace v2026-01-13 with the latest release tag .",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Repository Structure simulationCases/...",
    "content": "Repository Structure simulationCases/ - Main simulation code coalescenceBubble.c - Primary simulation (production runs) coalescenceBubble-tag.c - Extended version with shape tracking src-local/ - Custom Basilisk headers two-phase-tag.h - Two-phase flow with interface tagging parse_params.sh - Parameter file parsing library postProcess/ - Post-processing tools getData-generic.c - Field extraction on structured grids getFacet.c - Interface geometry extraction getCOM.c - Center of mass extraction Video-generic.py - Frame-by-frame visualization pipeline runSimulation.sh - Single case runner (OpenMP/MPI) runParameterSweep.sh - Parameter sweep runner runPostProcess-Ncases.sh - Batch post-processing runner default.params - Single-case configuration sweep.params - Sweep configuration template runSweepSnellius.sbatch - SLURM script for Snellius HPC runSweepHamilton.sbatch - SLURM script for Hamilton HPC Simulation Files This project contains two simulation files: coalescenceBubble.c (Primary) The main simulation file used for all production runs.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Outputs: - i...",
    "content": "Outputs: - i dt t ke Xc Vcm (6 columns) coalescenceBubble-tag.c (Optional) An extended version with interface tagging for detailed shape tracking. Uses tag.h to identify and track only the largest connected bubble region (filters out satellite droplets). Outputs additional geometric measurements: - i dt t ke Xc Vcm Re ZNp ZSp (9 columns) - Re : Equatorial radius at center of mass - ZNp : North pole position (positive x on axis) - ZSp : South pole position (negative x on axis) Note: All cases in this project are run with coalescenceBubble.c . The -tag.c variant is provided as an optional alternative for cases requiring detailed shape tracking.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Context",
    "content": "Why coalescenceBubble.c (not coalescenceBubble-tag.c) The running scripts use coalescenceBubble.c because: distance.h is incompatible with MPI - The distance.h header (used for computing initial conditions from shape files) cannot be compiled with -D_MPI=1 OpenMP is compatible - distance.h works fine with OpenMP ( -fopenmp ) Two-stage execution - We first run briefly with OpenMP to generate the restart file with initial conditions, then run the full simulation with MPI (which restores from the restart file, bypassing distance.h ) The coalescenceBubble-tag.c file additionally uses tag.h for tracking shape metrics, which adds complexity not needed for basic coalescence studies.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Running with Scripts...",
    "content": "Running with Scripts (Recommended) Single Case # Serial execution (both stages: OpenMP for restart, then serial) ./runSimulation.sh default.params # MPI execution (Stage 1: OpenMP, Stage 2: MPI) ./runSimulation.sh --mpi --cores 8 default.params # Compile only (check for errors) ./runSimulation.sh --compile-only default.params Parameter Sweep # Dry run (see parameter combinations) ./runParameterSweep.sh --dry-run # Run all combinations (serial) ./runParameterSweep.sh sweep.params # Run with MPI (8 cores per case) ./runParameterSweep.sh --mpi --cores 8 sweep.params HPC (Snellius) # Submit parameter sweep to SLURM sbatch runSweepSnellius.sbatch Post-Processing # Process multiple cases with default settings ./runPostProcess-Ncases.sh 3000 3001 3002 # Process a range of cases ./runPostProcess-Ncases.sh 3000-3010 # Process with 8 CPUs and custom snapshot count ./runPostProcess-Ncases.sh --CPUs 8 --nGFS 100 3000 # Skip video encoding (only generate frames) ./runPostProcess-Ncases.sh --skip-video-encode 3000 # Dry run to preview commands ./runPostProcess-Ncases.sh --dry-run 3000 C Helper Tools (must be compiled before running): qcc -O2 -Wall postProcess/getFacet.c -o postProcess/getFacet -lm qcc -O2 -Wall postProcess/getData-generic.c -o postProcess/getData-generic -lm qcc -O2 -Wall postProcess/getCOM.c -o postProcess/getCOM -lm getFacet : Extracts interface facets using PLIC reconstruction getData-generic : Samples velocity/strain-rate fields on structured grids getCOM : Computes center of mass position and velocity Output locations: - simulationCases/<CaseNo>/Video/ - PNG frames - simulationCases/<CaseNo>/<CaseNo>_COMData.csv - COM time series - simulationCases/<CaseNo>/<CaseNo>.mp4 - Encoded video Command Line Parameters The simulation takes 6 arguments: OhOut RhoIn Rr MAXlevel tmax zWall - OhOut : Ohnesorge number for outer fluid (e.g., 1e-2) - RhoIn : Density ratio inner/outer (e.g., 1e-3) - Rr : Radius ratio - available values: 1.00, 1.50, 2.00, 4.00, 8.00 (matching DataFiles) - MAXlevel : Maximum refinement level (e.g., 10) - tmax : Maximum simulation time (e.g., 40.0) - zWall : Wall position (e.g., 0.01) Running Manually (Legacy) There are two ways to run the codes: Using the vanilla basilisk method: qcc -O2 -Wall -disable-dimensions coalescenceBubble.c -o coalescenceBubble -lm ./coalescenceBubble Using the makefile (can be interactively run using bview browser): CFLAGS = -DDISPLAY=-1 make coalescenceBubble.tst Check the localhost on coalescenceBubble/display.html. something like: https://basilisk.fr/three.js/editor/index.html?ws://localhost:7100 and run interactively.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: To run using...",
    "content": "To run using openMP, please use the flag -fopenmp qcc -O2 -Wall -disable-dimensions coalescenceBubble.c -o coalescenceBubble -lm -fopenmp export OMP_NUM_THREADS = 8 ./coalescenceBubble Note: The code will not directly work with openmpi (with -D_MPI flag and mpirun). To do that, please follow the procedure we use: Run the following for a few timesteps (stop using tmax=1e-2 or so) qcc -O2 -Wall -disable-dimensions coalescenceBubble.c -o coalescenceBubble -lm -fopenmp export OMP_NUM_THREADS = 8 ./coalescenceBubble This will generate a \u201crestart\u201d file Do not delete the restart file.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence: Now you can...",
    "content": "Now you can use mpirun, like: CC99 = 'mpicc -std=c99' qcc -Wall -O2 -D_MPI = 1 -disable-dimensions coalescenceBubble.c -o coalescenceBubble -lm mpirun -np 8 coalescenceBubble Generated Documentation Root Directory default.params runParameterSweep.sh runPostProcess-Ncases.sh runSimulation.sh runSweepHamilton-serial.sbatch runSweepHamilton.sbatch runSweepSnellius-serial.sbatch runSweepSnellius.sbatch sweep.params postProcess postProcess/Video-generic.py postProcess/getCOM.c postProcess/getData-generic.c postProcess/getFacet.c simulationCases simulationCases/coalescenceBubble-tag.c simulationCases/coalescenceBubble.c src-local src-local/basilisk_version.sh src-local/parse_params.sh src-local/sweep_utils.sh src-local/two-phase-tag.h",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "curl-sLhttps://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh|bash-s----ref=v2026-01-13--hard",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "curl-sLhttps://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh|bash-s----ref=v2026-01-13",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Serial execution (both stages: OpenMP for restart, then serial)./runSimulation.shdefault.params",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# MPI execution (Stage 1: OpenMP, Stage 2: MPI)./runSimulation.sh--mpi--cores8 default.params",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Compile only (check for errors)./runSimulation.sh--compile-onlydefault.params",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Dry run (see parameter combinations)./runParameterSweep.sh--dry-run",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Run all combinations (serial)./runParameterSweep.shsweep.params",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Run with MPI (8 cores per case)./runParameterSweep.sh--mpi--cores8 sweep.params",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Submit parameter sweep to SLURMsbatchrunSweepSnellius.sbatch",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Process multiple cases with default settings./runPostProcess-Ncases.sh3000 3001 3002",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Process a range of cases./runPostProcess-Ncases.sh3000-3010",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Process with 8 CPUs and custom snapshot count./runPostProcess-Ncases.sh--CPUs8--nGFS100 3000",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Skip video encoding (only generate frames)./runPostProcess-Ncases.sh--skip-video-encode3000",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "# Dry run to preview commands./runPostProcess-Ncases.sh--dry-run3000",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "qcc-O2-WallpostProcess/getFacet.c-opostProcess/getFacet-lmqcc-O2-WallpostProcess/getData-generic.c-opostProcess/getData-generic-lmqcc-O2-WallpostProcess/getCOM.c-opostProcess/getCOM-lm",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "qcc-O2-Wall-disable-dimensionscoalescenceBubble.c-ocoalescenceBubble-lm./coalescenceBubble",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "qcc-O2-Wall-disable-dimensionscoalescenceBubble.c-ocoalescenceBubble-lm-fopenmpexportOMP_NUM_THREADS=8./coalescenceBubble",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Asymmetries-in-coalescence | Asymmetries-in-coalescence - Code Example",
    "content": "CC99='mpicc -std=c99'qcc-Wall-O2-D_MPI=1-disable-dimensionscoalescenceBubble.c-ocoalescenceBubble-lmmpirun-np8 coalescenceBubble",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/index.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius-serial.sbatch | Asymmetries-in-coalescence: Context",
    "content": "runSweepSnellius-serial.sbatch See raw file runSweepSnellius-serial.sbatch #!/bin/bash #SBATCH --job-name=bubbleCoal-S1 #SBATCH --nodes=1 #SBATCH --ntasks=48 #SBATCH --cpus-per-task=1 #SBATCH --time=12:00:00 #SBATCH --partition=genoa #SBATCH --mail-type=ALL #SBATCH --mail-user=vatsal.sanjay@comphy-lab.org #SBATCH --output=slurm-stage1-%j.out #SBATCH --error=slurm-stage1-%j.err # ============================================================ # Bubble Coalescence - Stage 1 Serial Runner (Snellius) # ============================================================ # This script runs Stage 1 (initialization) for all cases in parallel. # Each case runs on 1 core (serial, no OpenMP/MPI). # Up to 48 cases run simultaneously. # # Stage 1 generates restart files needed for Stage 2 (MPI simulation). # # AFTER RUNNING: # Submit Stage 2 with: sbatch runSweepSnellius.sbatch # # SBATCH Parameters to Customize: # --ntasks: Number of concurrent cases (currently 48) # --time: Wall time for all Stage 1 runs (currently 12 hours) # --partition: Compute partition (currently genoa) # --mail-user: Email for job notifications # ============================================================ set -e # Exit on error (but we'll handle case failures gracefully) # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # Maximum concurrent jobs (matches SLURM allocation) MAX_CONCURRENT = \\$ {SLURM_NTASKS:-48} # Stage 1 tmax - short run to generate restart file STAGE1_TMAX = \"5e-2\" # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Bubble Coalescence - Stage 1 (Serial)\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID}\" echo \"Max concurrent cases: \\$ {MAX_CONCURRENT}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION}\" echo \"\" echo \"Mode: Stage 1 only (serial initialization)\" echo \" Generates restart files for Stage 2\" echo \" Each case runs on 1 core (no OpenMP/MPI)\" echo \"\" # ============================================================ # Load Required Modules (minimal for serial) # ============================================================ echo \"Loading modules...\" module purge module load 2024 # No MPI needed for serial execution echo \"Modules loaded (serial mode - no MPI)\" echo \"\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" # Source version configuration if [ -f \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" else echo \"ERROR: src-local/basilisk_version.sh not found\" >& 2 exit 1 fi echo \"Installing Basilisk (ref: \\$ {BASILISK_REF})...\" install_basilisk --hard if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ BASILISK\" else echo \"ERROR: .project_config not found\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" source \" \\$ SWEEP_FILE\" if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () while IFS = '=' read -r key value ; do [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+ \" \\$ {current_values[@]}\" } \" \\$ val\" done } generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Prepare Status Tracking # ============================================================ STATUS_DIR = \" \\$ {TEMP_DIR}/status\" mkdir -p \" \\$ STATUS_DIR\" # ============================================================ # Function to Run Single Case (Stage 1) # ============================================================ run_stage1_case() { local param_file = \\$ 1 local status_dir = \\$ 2 local script_dir = \\$ 3 local stage1_tmax = \\$ 4 # Source parameter parsing in subshell source \" \\$ {script_dir}/src-local/parse_params.sh\" parse_param_file \" \\$ param_file\" local CASE_NO = \\$ ( get_param \"CaseNo\" ) local OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) local RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) local Rr = \\$ ( get_param \"Rr\" \"1.0\" ) local MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) local zWall = \\$ ( get_param \"zWall\" \"0.01\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO:-unknown}\" return 1 fi local CASE_DIR = \" \\$ {script_dir}/simulationCases/ \\$ {CASE_NO}\" local LOG_FILE = \" \\$ {CASE_DIR}/stage1.log\" # Create case directory BEFORE redirecting to log file mkdir -p \" \\$ CASE_DIR\" # Use existing case.params if present (allows manual parameter edits for reruns) # Otherwise, create from sweep-generated params if [ ! -f \" \\$ CASE_DIR/case.params\" ] ; then cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" fi # Re-parse from case.params (source of truth for this case) parse_param_file \" \\$ CASE_DIR/case.params\" OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) { echo \"=========================================\" echo \"Case \\$ CASE_NO - Stage 1 ( \\$ (date))\" echo \"=========================================\" echo \"Parameters: OhOut= \\$ OhOut, RhoIn= \\$ RhoIn, Rr= \\$ Rr\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ stage1_tmax, zWall= \\$ zWall\" cd \" \\$ CASE_DIR\" # Copy source file local SRC_FILE_ORIG = \" \\$ {script_dir}/simulationCases/coalescenceBubble.c\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file not found\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi # Use existing source file if present (allows local code edits for reruns) if [ ! -f \"coalescenceBubble.c\" ] ; then cp \" \\$ SRC_FILE_ORIG\" \"coalescenceBubble.c\" fi # Create symlink to DataFiles if [ ! -e \"DataFiles\" ] ; then ln -s ../DataFiles DataFiles fi # Compile SERIAL (no OpenMP, no MPI) echo \"Compiling (serial)...\" if ! qcc -I.. /../src-local -Wall -O2 -disable-dimensions \\ coalescenceBubble.c -o coalescenceBubble -lm 2 >& 1 ; then echo \"ERROR: Compilation failed\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi echo \"Compilation successful\" # Run Stage 1 with small tmax echo \"Running Stage 1 (tmax= \\$ stage1_tmax)...\" if ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ stage1_tmax \\$ zWall ; then echo \"Stage 1 completed\" # Verify restart file was created if [ -f \"restart\" ] ; then echo \"Restart file created successfully\" echo \"SUCCESS\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" else echo \"WARNING: restart file not found after Stage 1\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi else echo \"ERROR: Stage 1 failed\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi echo \"Case \\$ CASE_NO Stage 1 complete\" } > \" \\$ LOG_FILE\" 2 >& 1 return 0 } export -f run_stage1_case # ============================================================ # Run All Cases in Parallel (Stage 1) # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Cases (Stage 1)\" echo \"=============================================\" echo \"Max concurrent: \\$ {MAX_CONCURRENT}\" echo \"Each case: serial execution, tmax= \\$ {STAGE1_TMAX}\" echo \"\" RUNNING_JOBS = 0 PIDS = () for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Wait if we've hit the concurrency limit while [ \\$ RUNNING_JOBS -ge \\$ MAX_CONCURRENT ] ; do # Wait for any background job to finish wait -n 2 > /dev/null || true (( RUNNING_JOBS -- )) || true done # Launch case in background run_stage1_case \" \\$ param_file\" \" \\$ STATUS_DIR\" \" \\$ SCRIPT_DIR\" \" \\$ STAGE1_TMAX\" & PIDS += ( \\$ ! ) (( RUNNING_JOBS ++ )) || true # Extract case number for logging parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) echo \"Launched case \\$ CASE_NO (PID: \\$ {PIDS[-1]}, running: \\$ RUNNING_JOBS)\" done echo \"\" echo \"All cases launched, waiting for completion...\" echo \"\" # Wait for all remaining jobs wait # ============================================================ # Collect Results # ============================================================ SUCCESSFUL_CASES = 0 FAILED_CASES = 0 for status_file in \" \\$ {STATUS_DIR}\" / * ; do if [ -f \" \\$ status_file\" ] ; then status = \\$ ( cat \" \\$ status_file\" ) case_no = \\$ ( basename \" \\$ status_file\" ) if [ \" \\$ status\" = \"SUCCESS\" ] ; then (( SUCCESSFUL_CASES ++ )) || true else (( FAILED_CASES ++ )) || true echo \"FAILED: Case \\$ case_no\" fi fi done # ============================================================ # Final Summary # ============================================================ echo \"\" echo \"=============================================\" echo \"Stage 1 Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"\" echo \"Restart files location: simulationCases/*/restart\" echo \"\" if [ \\$ SUCCESSFUL_CASES -gt 0 ] ; then echo \"Next step: Submit Stage 2 with:\" echo \" sbatch runSweepSnellius.sbatch\" fi echo \"=============================================\" if [ \\$ FAILED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius-serial.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius-serial.sbatch | Asymmetries-in-coalescence: Check logs in...",
    "content": "Check logs in simulationCases/*/stage1.log\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius-serial.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepSnellius-serial.sbatch | Asymmetries-in-coalescence - Code Example: #!/bin/bash#SBATCH --job-name=bubbleCoal-S1#SBATCH --nodes=1#SBATCH...",
    "content": "#!/bin/bash#SBATCH --job-name=bubbleCoal-S1#SBATCH --nodes=1#SBATCH --ntasks=48#SBATCH --cpus-per-task=1#SBATCH --time=12:00:00#SBATCH --partition=genoa#SBATCH --mail-type=ALL#SBATCH --mail-user=vatsal.sanjay@comphy-lab.org#SBATCH --output=slurm-stage1-%j.out#SBATCH --error=slurm-stage1-%j.err# ============================================================# Bubble Coalescence - Stage 1 Serial Runner (Snellius)# ============================================================# This script runs Stage 1 (initialization) for all cases in parallel.# Each case runs on 1 core (serial, no OpenMP/MPI).# Up to 48 cases run simultaneously.## Stage 1 generates restart files needed for Stage 2 (MPI simulation).## AFTER RUNNING:# Submit Stage 2 with: sbatch runSweepSnellius.sbatch## SBATCH Parameters to Customize:#   --ntasks: Number of concurrent cases (currently 48)#   --time: Wall time for all Stage 1 runs (currently 12 hours)#   --partition: Compute partition (currently genoa)#   --mail-user: Email for job notifications# ============================================================set-e# Exit on error (but we'll handle case failures gracefully)# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# Maximum concurrent jobs (matches SLURM allocation)MAX_CONCURRENT=\\${SLURM_NTASKS:-48}# Stage 1 tmax - short run to generate restart fileSTAGE1_TMAX=\"5e-2\"# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Bubble Coalescence - Stage 1 (Serial)\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID}\"echo\"Max concurrent cases:\\${MAX_CONCURRENT}\"echo\"Partition:\\${SLURM_JOB_PARTITION}\"echo\"\"echo\"Mode: Stage 1 only (serial initialization)\"echo\"      Generates restart files for Stage 2\"echo\"      Each case runs on 1 core (no OpenMP/MPI)\"echo\"\"# ============================================================# Load Required Modules (minimal for serial)# ============================================================echo\"Loading modules...\"modulepurgemoduleload 2024# No MPI needed for serial executionecho\"Modules loaded (serial mode - no MPI)\"echo\"\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"# Source version configurationif[-f\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"elseecho\"ERROR: src-local/basilisk_version.sh not found\">&2exit1fiecho\"Installing Basilisk (ref:\\${BASILISK_REF})...\"install_basilisk--hardif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\$BASILISK\"elseecho\"ERROR: .project_config not found\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================if[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fiif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"source\"\\$SWEEP_FILE\"if[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fiif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()whileIFS='='read-rkeyvalue;do[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continueif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"value=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"TEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()generate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];thenlocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"cp\"\\$BASE_CONFIG\"\"\\$case_file\"ifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"foriin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneCASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||trueecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfilocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)generate_combinations\\$((depth+ 1))\\${current_values[@]+\"\\${current_values[@]}\"}\"\\$val\"done}generate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"EXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Prepare Status Tracking# ============================================================STATUS_DIR=\"\\${TEMP_DIR}/status\"mkdir-p\"\\$STATUS_DIR\"# ============================================================# Function to Run Single Case (Stage 1)# ============================================================run_stage1_case(){localparam_file=\\$1localstatus_dir=\\$2localscript_dir=\\$3localstage1_tmax=\\$4# Source parameter parsing in subshellsource\"\\${script_dir}/src-local/parse_params.sh\"parse_param_file\"\\$param_file\"localCASE_NO=\\$(get_param\"CaseNo\")localOhOut=\\$(get_param\"OhOut\"\"1e-2\")localRhoIn=\\$(get_param\"RhoIn\"\"1e-3\")localRr=\\$(get_param\"Rr\"\"1.0\")localMAXlevel=\\$(get_param\"MAXlevel\"\"10\")localzWall=\\$(get_param\"zWall\"\"0.01\")if[-z\"\\$CASE_NO\"];thenecho\"FAILED\">\"\\${status_dir}/\\${CASE_NO:-unknown}\"return1filocalCASE_DIR=\"\\${script_dir}/simulationCases/\\${CASE_NO}\"localLOG_FILE=\"\\${CASE_DIR}/stage1.log\"# Create case directory BEFORE redirecting to log filemkdir-p\"\\$CASE_DIR\"# Use existing case.params if present (allows manual parameter edits for reruns)# Otherwise, create from sweep-generated paramsif[!-f\"\\$CASE_DIR/case.params\"];thencp\"\\$param_file\"\"\\$CASE_DIR/case.params\"fi# Re-parse from case.params (source of truth for this case)parse_param_file\"\\$CASE_DIR/case.params\"OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")zWall=\\$(get_param\"zWall\"\"0.01\"){echo\"=========================================\"echo\"Case\\$CASE_NO - Stage 1 (\\$(date))\"echo\"=========================================\"echo\"Parameters: OhOut=\\$OhOut, RhoIn=\\$RhoIn, Rr=\\$Rr\"echo\"            MAXlevel=\\$MAXlevel, tmax=\\$stage1_tmax, zWall=\\$zWall\"cd\"\\$CASE_DIR\"# Copy source filelocalSRC_FILE_ORIG=\"\\${script_dir}/simulationCases/coalescenceBubble.c\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file not found\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fi# Use existing source file if present (allows local code edits for reruns)if[!-f\"coalescenceBubble.c\"];thencp\"\\$SRC_FILE_ORIG\"\"coalescenceBubble.c\"fi# Create symlink to DataFilesif[!-e\"DataFiles\"];thenln-s../DataFiles DataFilesfi# Compile SERIAL (no OpenMP, no MPI)echo\"Compiling (serial)...\"if!qcc-I../../src-local-Wall-O2-disable-dimensions\\coalescenceBubble.c-ocoalescenceBubble-lm2>&1;thenecho\"ERROR: Compilation failed\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fiecho\"Compilation successful\"# Run Stage 1 with small tmaxecho\"Running Stage 1 (tmax=\\$stage1_tmax)...\"if./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$stage1_tmax\\$zWall;thenecho\"Stage 1 completed\"# Verify restart file was createdif[-f\"restart\"];thenecho\"Restart file created successfully\"echo\"SUCCESS\">\"\\${status_dir}/\\${CASE_NO}\"elseecho\"WARNING: restart file not found after Stage 1\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fielseecho\"ERROR: Stage 1 failed\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fiecho\"Case\\$CASE_NO Stage 1 complete\"}>\"\\$LOG_FILE\"2>&1return0}export-frun_stage1_case# ============================================================# Run All Cases in Parallel (Stage 1)# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Cases (Stage 1)\"echo\"=============================================\"echo\"Max concurrent:\\${MAX_CONCURRENT}\"echo\"Each case: serial execution, tmax=\\${STAGE1_TMAX}\"echo\"\"RUNNING_JOBS=0PIDS=()forparam_filein\"\\${CASE_FILES[@]}\";do# Wait if we've hit the concurrency limitwhile[\\$RUNNING_JOBS-ge\\$MAX_CONCURRENT];do# Wait for any background job to finishwait-n2>/dev/null||true((RUNNING_JOBS--))||truedone# Launch case in backgroundrun_stage1_case\"\\$param_file\"\"\\$STATUS_DIR\"\"\\$SCRIPT_DIR\"\"\\$STAGE1_TMAX\"&PIDS+=(\\$!)((RUNNING_JOBS++))||true# Extract case number for loggingparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")echo\"Launched case\\$CASE_NO (PID:\\${PIDS[-1]}, running:\\$RUNNING_JOBS)\"doneecho\"\"echo\"All cases launched, waiting for completion...\"echo\"\"# Wait for all remaining jobswait# ============================================================# Collect Results# ============================================================SUCCESSFUL_CASES=0FAILED_CASES=0forstatus_filein\"\\${STATUS_DIR}\"/*;doif[-f\"\\$status_file\"];thenstatus=\\$(cat\"\\$status_file\")case_no=\\$(basename\"\\$status_file\")if[\"\\$status\"=\"SUCCESS\"];then((SUCCESSFUL_CASES++))||trueelse((FAILED_CASES++))||trueecho\"FAILED: Case\\$case_no\"fifidone# ============================================================# Final Summary# ============================================================echo\"\"echo\"=============================================\"echo\"Stage 1 Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"\"echo\"Restart files location: simulationCases/*/restart\"echo\"\"if[\\$SUCCESSFUL_CASES-gt0];thenecho\"Next step: Submit Stage 2 with:\"echo\"  sbatch runSweepSnellius.sbatch\"fiecho\"=============================================\"if[\\$FAILED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius-serial.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepSnellius-serial.sbatch | Asymmetries-in-coalescence - Code Example: Check logs in...",
    "content": "Check logs in simulationCases/*/stage1.log\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepSnellius-serial.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "sweep.params | Asymmetries-in-coalescence: Context",
    "content": "sweep.params See raw file sweep.params # Parameter Sweep Configuration # This file defines a parameter sweep for batch simulations # ============================================================ # Base Configuration # ============================================================ # Start from this parameter file and override sweep variables BASE_CONFIG = default.params # ============================================================ # Case Number Range # ============================================================ # Starting case number (4-digit: 1000-9999) # Each parameter combination gets auto-incremented CaseNo CASE_START = 4000 # Ending case number (inclusive) # Number of combinations should equal CASE_END - CASE_START + 1 # For this sweep: 4 Rr \u00d7 4 OhOut = 16 combinations, so CASE_END = 2015 CASE_END = 4015 # ============================================================ # Sweep Variables # ============================================================ # Format: SWEEP_<variable>=value1,value2,value3,... # The sweep will generate all combinations (cartesian product) # Sweep radius ratio # Available values (matching DataFiles): 1.00, 1.50, 2.00, 4.00, 8.00 SWEEP_Rr = 1.00,2.00 # Sweep Ohnesorge number (outer fluid) SWEEP_OhOut = 0.01,0.015,0.025,0.04,0.05,0.057,0.066,0.075 # Sweep wall position SWEEP_zWall = 0.05 # Optional: sweep other parameters (uncomment as needed) # SWEEP_MAXlevel=9,10,11 # ============================================================ # Output Configuration # ============================================================ # Output folders are created in simulationCases/<CaseNo>/ # CaseNo auto-increments from CASE_START for each parameter combination # Cases run sequentially (one at a time)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/sweep.params.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "sweep.params | Asymmetries-in-coalescence - Code Example: # Parameter Sweep...",
    "content": "# Parameter Sweep Configuration# This file defines a parameter sweep for batch simulations# ============================================================# Base Configuration# ============================================================# Start from this parameter file and override sweep variablesBASE_CONFIG=default.params# ============================================================# Case Number Range# ============================================================# Starting case number (4-digit: 1000-9999)# Each parameter combination gets auto-incremented CaseNoCASE_START=4000# Ending case number (inclusive)# Number of combinations should equal CASE_END - CASE_START + 1# For this sweep: 4 Rr \u00d7 4 OhOut = 16 combinations, so CASE_END = 2015CASE_END=4015# ============================================================# Sweep Variables# ============================================================# Format: SWEEP_<variable>=value1,value2,value3,...# The sweep will generate all combinations (cartesian product)# Sweep radius ratio# Available values (matching DataFiles): 1.00, 1.50, 2.00, 4.00, 8.00SWEEP_Rr=1.00,2.00# Sweep Ohnesorge number (outer fluid)SWEEP_OhOut=0.01,0.015,0.025,0.04,0.05,0.057,0.066,0.075# Sweep wall positionSWEEP_zWall=0.05# Optional: sweep other parameters (uncomment as needed)# SWEEP_MAXlevel=9,10,11# ============================================================# Output Configuration# ============================================================# Output folders are created in simulationCases/<CaseNo>/# CaseNo auto-increments from CASE_START for each parameter combination# Cases run sequentially (one at a time)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/sweep.params.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: Context",
    "content": "runSimulation.sh See raw file runSimulation.sh #!/bin/bash # runSimulation.sh - Run single bubble coalescence simulation from root directory # Creates case folder in simulationCases/<CaseNo>/ and runs simulation there # # IMPORTANT: This script uses TWO-STAGE EXECUTION because distance.h is # incompatible with MPI.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: Run Stage 1...",
    "content": "Run Stage 1 first to generate the restart file, # then run Stage 2 for the full simulation. set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Stage 1 tmax - short run to generate restart file STAGE1_TMAX = \"5e-2\" # Source version configuration for install instructions if [ -f \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" ] ; then # shellcheck disable=SC1091 source \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" fi # Source project configuration if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then # shellcheck disable=SC1090 source \" \\$ {SCRIPT_DIR}/.project_config\" else echo \"WARNING: .project_config not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: BASILISK path may...",
    "content": "BASILISK path may not be set.\" >& 2 echo \" Install Basilisk first (creates .project_config):\" >& 2 echo \" curl -sL \\$ {BASILISK_INSTALL_URL:-https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh} | bash -s -- --ref= \\$ {BASILISK_REF:-v2026-01-13}\" >& 2 fi # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] [params_file] Run single bubble coalescence simulation from root directory. Creates case folder in simulationCases/<CaseNo>/ based on parameter file.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: This script uses...",
    "content": "This script uses TWO-STAGE EXECUTION: Stage 1: Generate restart file (distance.h incompatible with MPI) Stage 2: Full simulation from restart file Stage Selection (mutually exclusive): (default) Run both Stage 1 + Stage 2 --stage1 Run Stage 1 only (generate restart file) --stage2 Run Stage 2 only (full simulation from restart) Parallelization: --fopenmp [N] Enable OpenMP with N threads (default: 8) Stage 1: Linux only (macOS always serial) Stage 2: Linux only (macOS runs serial with warning) --mpi [N] Enable MPI with N cores (default: 2, Stage 2 only) Other Options: -c, --compile-only Compile but don't run simulation -d, --debug Compile with debug flags (-g -DTRASH=1) -f, --force Force overwrite of case.params and source file (by default, existing files are preserved for reruns) -v, --verbose Verbose output -h, --help Show this help message Parameter file mode (default): \\$ 0 default.params If no parameter file specified, uses default.params from current directory.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: Examples",
    "content": "Environment variables: QCC_FLAGS Additional qcc compiler flags Examples: # Run both stages (default) \\$ 0 default.params # Serial, Stage 1 + 2 \\$ 0 --mpi 8 default.params # Stage 1 serial, Stage 2 MPI # Stage 1 only: Generate restart file \\$ 0 --stage1 default.params # Serial \\$ 0 --stage1 --fopenmp default.params # OpenMP (Linux only) # Stage 2 only: Full simulation (requires existing restart) \\$ 0 --stage2 default.params # Serial \\$ 0 --stage2 --mpi 8 default.params # MPI, 8 cores # Compile only (check for errors) \\$ 0 --compile-only default.params For more information, see README.md EOF } # ============================================================ # Parse Command Line Options # ============================================================ COMPILE_ONLY = 0 DEBUG_FLAGS = \"\" VERBOSE = 0 FORCE_OVERWRITE = 0 STAGE = 0 # Default to both stages (0 = both, 1 = stage1, 2 = stage2) FOPENMP_ENABLED = 0 FOPENMP_THREADS = 8 # Default thread count MPI_ENABLED = 0 MPI_CORES = 2 # Default core count STAGE_EXPLICITLY_SET = 0 QCC_FLAGS = \" \\$ {QCC_FLAGS:-}\" while [[ \\$ # -gt 0 ]]; do case \\$ 1 in -c | --compile-only ) COMPILE_ONLY = 1 shift ;; -d | --debug ) DEBUG_FLAGS = \"-g -DTRASH=1\" shift ;; -f | --force ) FORCE_OVERWRITE = 1 shift ;; --stage1 ) if [ \\$ STAGE_EXPLICITLY_SET -eq 1 ] && [ \\$ STAGE -eq 2 ] ; then echo \"ERROR: Cannot use both --stage1 and --stage2\" >& 2 exit 1 fi STAGE = 1 STAGE_EXPLICITLY_SET = 1 shift ;; --stage2 ) if [ \\$ STAGE_EXPLICITLY_SET -eq 1 ] && [ \\$ STAGE -eq 1 ] ; then echo \"ERROR: Cannot use both --stage1 and --stage2\" >& 2 exit 1 fi STAGE = 2 STAGE_EXPLICITLY_SET = 1 shift ;; --fopenmp ) FOPENMP_ENABLED = 1 # Check if next arg is a number (optional thread count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then FOPENMP_THREADS = \" \\$ 2\" shift fi shift ;; --mpi ) MPI_ENABLED = 1 # Check if next arg is a number (optional core count) if [[ \" \\$ {2:-}\" =~ ^ [ 0 - 9 ] + \\$ ]]; then MPI_CORES = \" \\$ 2\" shift fi shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) break ;; esac done # ============================================================ # Detect OS # ============================================================ OS_TYPE = \\$ ( uname -s ) # ============================================================ # Validation # ============================================================ # Check --mpi only valid with stage2 (not stage1-only) if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE -eq 1 ] ; then echo \"ERROR: --mpi is only valid with --stage2 (Stage 1 cannot use MPI due to distance.h)\" >& 2 exit 1 fi # For both-stages mode with MPI, MPI only applies to Stage 2 if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ STAGE -eq 0 ] ; then echo \"Note: MPI will be used for Stage 2 only (Stage 1 runs serial)\" fi # Check --mpi and --fopenmp are mutually exclusive if [ \\$ MPI_ENABLED -eq 1 ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"ERROR: --mpi and --fopenmp are mutually exclusive\" >& 2 exit 1 fi # Check --fopenmp on macOS if [ \" \\$ OS_TYPE\" = \"Darwin\" ] && [ \\$ FOPENMP_ENABLED -eq 1 ] ; then if [ \\$ STAGE -eq 1 ] ; then echo \"ERROR: --fopenmp not supported on macOS for Stage 1 (always runs serial)\" >& 2 exit 1 else echo \"WARNING: OpenMP not available on macOS, Stage 2 will run serial\" >& 2 FOPENMP_ENABLED = 0 fi fi # Verify MPI tools if MPI is enabled if [ \\$ MPI_ENABLED -eq 1 ] ; then if ! command -v mpicc &> /dev/null ; then echo \"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi if ! command -v mpirun &> /dev/null ; then echo \"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\" >& 2 echo \" Install MPI tools or run without --mpi flag for serial execution.\" >& 2 exit 1 fi fi # ============================================================ # Determine Parameter File # ============================================================ PARAM_FILE = \" \\$ {1:-default.params}\" if [ ! -f \" \\$ PARAM_FILE\" ] ; then echo \"ERROR: Parameter file not found: \\$ PARAM_FILE\" >& 2 exit 1 fi [ \\$ VERBOSE -eq 1 ] && echo \"Parameter file: \\$ PARAM_FILE\" # ============================================================ # Parse Parameters # ============================================================ parse_param_file \" \\$ PARAM_FILE\" CASE_NO = \\$ ( get_param \"CaseNo\" ) OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in parameter file\" >& 2 exit 1 fi # Validate CaseNo is 4 digits if ! [[ \" \\$ CASE_NO\" =~ ^ [ 0 - 9 ] { 4 } \\$ ]] || [ \" \\$ CASE_NO\" -lt 1000 ] || [ \" \\$ CASE_NO\" -gt 9999 ] ; then echo \"ERROR: CaseNo must be 4-digit (1000-9999), got: \\$ CASE_NO\" >& 2 exit 1 fi CASE_DIR = \"simulationCases/ \\$ {CASE_NO}\" # ============================================================ # Create Case Directory # ============================================================ if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"Creating case directory: \\$ CASE_DIR\" mkdir -p \" \\$ CASE_DIR\" else echo \"Case directory exists\" fi # Copy or preserve case.params if [ \\$ FORCE_OVERWRITE -eq 1 ] ; then cp \" \\$ PARAM_FILE\" \" \\$ CASE_DIR/case.params\" echo \"Copied case.params (--force: overwriting existing)\" elif [ ! -f \" \\$ CASE_DIR/case.params\" ] ; then cp \" \\$ PARAM_FILE\" \" \\$ CASE_DIR/case.params\" else echo \"Using existing case.params (manual edits preserved; use --force to overwrite)\" # Re-parse from case.params to get potentially modified values parse_param_file \" \\$ CASE_DIR/case.params\" OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) fi # ============================================================ # Display Configuration # ============================================================ # NOTE : Display AFTER preservation logic so values reflect what will actually be used echo \"\" echo \"=========================================\" echo \"Bubble Coalescence Simulation\" echo \"=========================================\" echo \"Case Number: \\$ CASE_NO\" echo \"Case Directory: \\$ CASE_DIR\" echo \"Parameter File: \\$ PARAM_FILE\" echo \"\" echo \"Physical Parameters:\" echo \" OhOut= \\$ OhOut, RhoIn= \\$ RhoIn, Rr= \\$ Rr\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ tmax, zWall= \\$ zWall\" echo \"\" if [ \\$ STAGE -eq 0 ] ; then echo \"Stage: Both (Stage 1 + Stage 2)\" elif [ \\$ STAGE -eq 1 ] ; then echo \"Stage: 1 only (generate restart)\" else echo \"Stage: 2 only (full simulation)\" fi if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Parallelization: MPI ( \\$ MPI_CORES cores)\" elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Parallelization: OpenMP ( \\$ FOPENMP_THREADS threads)\" else echo \"Parallelization: Serial\" fi echo \"\" # Change to case directory cd \" \\$ CASE_DIR\" [ \\$ VERBOSE -eq 1 ] && echo \"Working directory: \\$ (pwd)\" # ============================================================ # Source File Setup # ============================================================ SRC_FILE_ORIG = \"../coalescenceBubble.c\" SRC_FILE_LOCAL = \"coalescenceBubble.c\" EXECUTABLE = \"coalescenceBubble\" # Check if source file exists if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 exit 1 fi # Copy or preserve source file if [ \\$ FORCE_OVERWRITE -eq 1 ] ; then cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Copied source file (--force: overwriting existing)\" elif [ ! -f \" \\$ SRC_FILE_LOCAL\" ] ; then cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" echo \"Copied source file to case directory\" else echo \"Using existing coalescenceBubble.c (local edits preserved; use --force to overwrite)\" fi # Create symlink to DataFiles (required for initial condition loading) if [ ! -e \"DataFiles\" ] ; then ln -s ../DataFiles DataFiles echo \"Created symlink to DataFiles\" fi # ============================================================ # Stage 1: Generate Restart File # ============================================================ if [ \\$ STAGE -eq 1 ] || [ \\$ STAGE -eq 0 ] ; then echo \"\" echo \"=========================================\" echo \"Stage 1: Generate Initial Condition\" echo \"=========================================\" # Compilation if [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Compiling with OpenMP...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -disable-dimensions -fopenmp \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -Wall -O2 -disable-dimensions -fopenmp \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else echo \"Compiling for serial execution...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -Wall -O2 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi if [ \\$ ? -ne 0 ] ; then echo \"ERROR: Stage 1 compilation failed\" >& 2 exit 1 fi echo \"Compilation successful: \\$ EXECUTABLE\" # Exit if compile-only mode if [ \\$ COMPILE_ONLY -eq 1 ] ; then echo \"\" echo \"Compile-only mode: Stopping here\" cd ../.. exit 0 fi # Execution echo \"\" echo \"Running briefly to generate restart file...\" if [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \" OMP_NUM_THREADS= \\$ FOPENMP_THREADS\" export OMP_NUM_THREADS = \\$ FOPENMP_THREADS else echo \" Running single-threaded\" fi echo \" Command: ./ \\$ {EXECUTABLE} \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ STAGE1_TMAX \\$ zWall\" ./\\${EXECUTABLE} \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ STAGE1_TMAX \\$ zWall # Validate the restart file was created successfully if ! validate_restart_file \"restart\" ; then echo \"ERROR: Stage 1 failed - restart file validation failed\" >& 2 exit 1 fi echo \"\" echo \"=========================================\" echo \"Stage 1 complete: restart file created\" echo \"Restart file location: \\$ CASE_DIR/restart\" if [ \\$ STAGE -eq 1 ] ; then echo \"\" echo \"To run Stage 2:\" echo \" \\$ 0 --stage2 \\$ PARAM_FILE\" echo \" \\$ 0 --stage2 --mpi \\$ PARAM_FILE\" fi echo \"=========================================\" fi # ============================================================ # Stage 2: Full Simulation # ============================================================ if [ \\$ STAGE -eq 2 ] || [ \\$ STAGE -eq 0 ] ; then # Validate restart file (exists, non-empty, readable) if ! validate_restart_file \"restart\" ; then echo \" Run Stage 1 first: \\$ 0 --stage1 \\$ PARAM_FILE\" >& 2 exit 1 fi echo \"\" echo \"=========================================\" echo \"Stage 2: Full Simulation\" echo \"=========================================\" # Compilation if [ \\$ MPI_ENABLED -eq 1 ] ; then echo \"Compiling with MPI...\" if [ \" \\$ OS_TYPE\" = \"Darwin\" ] ; then # macOS [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else # Linux [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then echo \"Compiling with OpenMP...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -disable-dimensions -fopenmp \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -Wall -O2 -disable-dimensions -fopenmp \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm else echo \"Compiling for serial execution...\" [ \\$ VERBOSE -eq 1 ] && echo \"Compiler: qcc\" [ \\$ VERBOSE -eq 1 ] && echo \"Include paths: -I../../src-local\" [ \\$ VERBOSE -eq 1 ] && echo \"Flags: -Wall -O2 -disable-dimensions \\$ DEBUG_FLAGS \\$ QCC_FLAGS\" qcc -I.. /../src-local \\ -Wall -O2 -disable-dimensions \\ \\$ DEBUG_FLAGS \\$ QCC_FLAGS \\ \" \\$ SRC_FILE_LOCAL\" -o \" \\$ EXECUTABLE\" -lm fi if [ \\$ ? -ne 0 ] ; then echo \"ERROR: Stage 2 compilation failed\" >& 2 exit 1 fi echo \"Compilation successful: \\$ EXECUTABLE\" # Exit if compile-only mode if [ \\$ COMPILE_ONLY -eq 1 ] ; then echo \"\" echo \"Compile-only mode: Stopping here\" cd ../.. exit 0 fi # Execution echo \"\" echo \"Starting full simulation...\" echo \" Command args: \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" echo \"=========================================\" if [ \\$ MPI_ENABLED -eq 1 ] ; then [ \\$ VERBOSE -eq 1 ] && echo \"Command: mpirun -np \\$ MPI_CORES ./ \\$ EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" mpirun -np \\$ MPI_CORES ./\\$EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall elif [ \\$ FOPENMP_ENABLED -eq 1 ] ; then export OMP_NUM_THREADS = \\$ FOPENMP_THREADS [ \\$ VERBOSE -eq 1 ] && echo \"OMP_NUM_THREADS= \\$ FOPENMP_THREADS\" [ \\$ VERBOSE -eq 1 ] && echo \"Command: ./ \\$ EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" ./\\$EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall else [ \\$ VERBOSE -eq 1 ] && echo \"Command: ./ \\$ EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" ./\\$EXECUTABLE \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall fi EXIT_CODE = \\$ ? echo \"=========================================\" if [ \\$ EXIT_CODE -eq 0 ] ; then echo \"Simulation completed successfully\" echo \"Output location: \\$ CASE_DIR\" else echo \"Simulation failed with exit code \\$ EXIT_CODE\" fi echo \"=========================================\" # Return to root directory cd ../.. exit \\$ EXIT_CODE fi # Return to root directory cd ../.. exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "#!/bin/bash# runSimulation.sh - Run single bubble coalescence simulation from root directory# Creates case folder in simulationCases/<CaseNo>/ and runs simulation there## IMPORTANT: This script uses TWO-STAGE EXECUTION because distance.h is# incompatible with MPI.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence - Code Example: Run Stage 1...",
    "content": "Run Stage 1 first to generate the restart file,# then run Stage 2 for the full simulation.set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Stage 1 tmax - short run to generate restart fileSTAGE1_TMAX=\"5e-2\"# Source version configuration for install instructionsif[-f\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"];then# shellcheck disable=SC1091source\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"fi# Source project configurationif[-f\"\\${SCRIPT_DIR}/.project_config\"];then# shellcheck disable=SC1090source\"\\${SCRIPT_DIR}/.project_config\"elseecho\"WARNING: .project_config not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence - Code Example: BASILISK path may...",
    "content": "BASILISK path may not be set.\">&2echo\"         Install Basilisk first (creates .project_config):\">&2echo\"         curl -sL\\${BASILISK_INSTALL_URL:-https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh} | bash -s -- --ref=\\${BASILISK_REF:-v2026-01-13}\">&2fi# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] [params_file]Run single bubble coalescence simulation from root directory.Creates case folder in simulationCases/<CaseNo>/ based on parameter file.This script uses TWO-STAGE EXECUTION:Stage 1: Generate restart file (distance.h incompatible with MPI)Stage 2: Full simulation from restart fileStage Selection (mutually exclusive):(default)           Run both Stage 1 + Stage 2--stage1            Run Stage 1 only (generate restart file)--stage2            Run Stage 2 only (full simulation from restart)Parallelization:--fopenmp [N]       Enable OpenMP with N threads (default: 8)Stage 1: Linux only (macOS always serial)Stage 2: Linux only (macOS runs serial with warning)--mpi [N]           Enable MPI with N cores (default: 2, Stage 2 only)Other Options:-c, --compile-only  Compile but don't run simulation-d, --debug         Compile with debug flags (-g -DTRASH=1)-f, --force         Force overwrite of case.params and source file(by default, existing files are preserved for reruns)-v, --verbose       Verbose output-h, --help          Show this help messageParameter file mode (default):\\$0 default.paramsIf no parameter file specified, uses default.params from current directory.Environment variables:QCC_FLAGS     Additional qcc compiler flagsExamples:# Run both stages (default)\\$0 default.params                         # Serial, Stage 1 + 2\\$0 --mpi 8 default.params                 # Stage 1 serial, Stage 2 MPI# Stage 1 only: Generate restart file\\$0 --stage1 default.params                # Serial\\$0 --stage1 --fopenmp default.params      # OpenMP (Linux only)# Stage 2 only: Full simulation (requires existing restart)\\$0 --stage2 default.params                # Serial\\$0 --stage2 --mpi 8 default.params        # MPI, 8 cores# Compile only (check for errors)\\$0 --compile-only default.paramsFor more information, see README.mdEOF}# ============================================================# Parse Command Line Options# ============================================================COMPILE_ONLY=0DEBUG_FLAGS=\"\"VERBOSE=0FORCE_OVERWRITE=0STAGE=0# Default to both stages (0 = both, 1 = stage1, 2 = stage2)FOPENMP_ENABLED=0FOPENMP_THREADS=8# Default thread countMPI_ENABLED=0MPI_CORES=2# Default core countSTAGE_EXPLICITLY_SET=0QCC_FLAGS=\"\\${QCC_FLAGS:-}\"while[[\\$#-gt0]];docase\\$1in-c|--compile-only)COMPILE_ONLY=1shift;;-d|--debug)DEBUG_FLAGS=\"-g -DTRASH=1\"shift;;-f|--force)FORCE_OVERWRITE=1shift;;--stage1)if[\\$STAGE_EXPLICITLY_SET-eq1]&&[\\$STAGE-eq2];thenecho\"ERROR: Cannot use both --stage1 and --stage2\">&2exit1fiSTAGE=1STAGE_EXPLICITLY_SET=1shift;;--stage2)if[\\$STAGE_EXPLICITLY_SET-eq1]&&[\\$STAGE-eq1];thenecho\"ERROR: Cannot use both --stage1 and --stage2\">&2exit1fiSTAGE=2STAGE_EXPLICITLY_SET=1shift;;--fopenmp)FOPENMP_ENABLED=1# Check if next arg is a number (optional thread count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenFOPENMP_THREADS=\"\\$2\"shiftfishift;;--mpi)MPI_ENABLED=1# Check if next arg is a number (optional core count)if[[\"\\${2:-}\"=~^[0-9]+\\$]];thenMPI_CORES=\"\\$2\"shiftfishift;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)break;;esacdone# ============================================================# Detect OS# ============================================================OS_TYPE=\\$(uname-s)# ============================================================# Validation# ============================================================# Check --mpi only valid with stage2 (not stage1-only)if[\\$MPI_ENABLED-eq1]&&[\\$STAGE-eq1];thenecho\"ERROR: --mpi is only valid with --stage2 (Stage 1 cannot use MPI due to distance.h)\">&2exit1fi# For both-stages mode with MPI, MPI only applies to Stage 2if[\\$MPI_ENABLED-eq1]&&[\\$STAGE-eq0];thenecho\"Note: MPI will be used for Stage 2 only (Stage 1 runs serial)\"fi# Check --mpi and --fopenmp are mutually exclusiveif[\\$MPI_ENABLED-eq1]&&[\\$FOPENMP_ENABLED-eq1];thenecho\"ERROR: --mpi and --fopenmp are mutually exclusive\">&2exit1fi# Check --fopenmp on macOSif[\"\\$OS_TYPE\"=\"Darwin\"]&&[\\$FOPENMP_ENABLED-eq1];thenif[\\$STAGE-eq1];thenecho\"ERROR: --fopenmp not supported on macOS for Stage 1 (always runs serial)\">&2exit1elseecho\"WARNING: OpenMP not available on macOS, Stage 2 will run serial\">&2FOPENMP_ENABLED=0fifi# Verify MPI tools if MPI is enabledif[\\$MPI_ENABLED-eq1];thenif!command-vmpicc&>/dev/null;thenecho\"ERROR: mpicc not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence - Code Example: MPI compilation requires...",
    "content": "MPI compilation requires mpicc (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fiif!command-vmpirun&>/dev/null;thenecho\"ERROR: mpirun not found.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSimulation.sh | Asymmetries-in-coalescence - Code Example: MPI execution requires...",
    "content": "MPI execution requires mpirun (OpenMPI or MPICH).\">&2echo\"       Install MPI tools or run without --mpi flag for serial execution.\">&2exit1fifi# ============================================================# Determine Parameter File# ============================================================PARAM_FILE=\"\\${1:-default.params}\"if[!-f\"\\$PARAM_FILE\"];thenecho\"ERROR: Parameter file not found:\\$PARAM_FILE\">&2exit1fi[\\$VERBOSE-eq1]&&echo\"Parameter file:\\$PARAM_FILE\"# ============================================================# Parse Parameters# ============================================================parse_param_file\"\\$PARAM_FILE\"CASE_NO=\\$(get_param\"CaseNo\")OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in parameter file\">&2exit1fi# Validate CaseNo is 4 digitsif![[\"\\$CASE_NO\"=~^[0-9]{4}\\$]]||[\"\\$CASE_NO\"-lt1000]||[\"\\$CASE_NO\"-gt9999];thenecho\"ERROR: CaseNo must be 4-digit (1000-9999), got:\\$CASE_NO\">&2exit1fiCASE_DIR=\"simulationCases/\\${CASE_NO}\"# ============================================================# Create Case Directory# ============================================================if[!-d\"\\$CASE_DIR\"];thenecho\"Creating case directory:\\$CASE_DIR\"mkdir-p\"\\$CASE_DIR\"elseecho\"Case directory exists\"fi# Copy or preserve case.paramsif[\\$FORCE_OVERWRITE-eq1];thencp\"\\$PARAM_FILE\"\"\\$CASE_DIR/case.params\"echo\"Copied case.params (--force: overwriting existing)\"elif[!-f\"\\$CASE_DIR/case.params\"];thencp\"\\$PARAM_FILE\"\"\\$CASE_DIR/case.params\"elseecho\"Using existing case.params (manual edits preserved; use --force to overwrite)\"# Re-parse from case.params to get potentially modified valuesparse_param_file\"\\$CASE_DIR/case.params\"OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")fi# ============================================================# Display Configuration# ============================================================#NOTE: Display AFTER preservation logic so values reflect what will actually be usedecho\"\"echo\"=========================================\"echo\"Bubble Coalescence Simulation\"echo\"=========================================\"echo\"Case Number:\\$CASE_NO\"echo\"Case Directory:\\$CASE_DIR\"echo\"Parameter File:\\$PARAM_FILE\"echo\"\"echo\"Physical Parameters:\"echo\"  OhOut=\\$OhOut, RhoIn=\\$RhoIn, Rr=\\$Rr\"echo\"  MAXlevel=\\$MAXlevel, tmax=\\$tmax, zWall=\\$zWall\"echo\"\"if[\\$STAGE-eq0];thenecho\"Stage: Both (Stage 1 + Stage 2)\"elif[\\$STAGE-eq1];thenecho\"Stage: 1 only (generate restart)\"elseecho\"Stage: 2 only (full simulation)\"fiif[\\$MPI_ENABLED-eq1];thenecho\"Parallelization: MPI (\\$MPI_CORES cores)\"elif[\\$FOPENMP_ENABLED-eq1];thenecho\"Parallelization: OpenMP (\\$FOPENMP_THREADS threads)\"elseecho\"Parallelization: Serial\"fiecho\"\"# Change to case directorycd\"\\$CASE_DIR\"[\\$VERBOSE-eq1]&&echo\"Working directory:\\$(pwd)\"# ============================================================# Source File Setup# ============================================================SRC_FILE_ORIG=\"../coalescenceBubble.c\"SRC_FILE_LOCAL=\"coalescenceBubble.c\"EXECUTABLE=\"coalescenceBubble\"# Check if source file existsif[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2exit1fi# Copy or preserve source fileif[\\$FORCE_OVERWRITE-eq1];thencp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Copied source file (--force: overwriting existing)\"elif[!-f\"\\$SRC_FILE_LOCAL\"];thencp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"echo\"Copied source file to case directory\"elseecho\"Using existing coalescenceBubble.c (local edits preserved; use --force to overwrite)\"fi# Create symlink to DataFiles (required for initial condition loading)if[!-e\"DataFiles\"];thenln-s../DataFiles DataFilesecho\"Created symlink to DataFiles\"fi# ============================================================# Stage 1: Generate Restart File# ============================================================if[\\$STAGE-eq1]||[\\$STAGE-eq0];thenecho\"\"echo\"=========================================\"echo\"Stage 1: Generate Initial Condition\"echo\"=========================================\"# Compilationif[\\$FOPENMP_ENABLED-eq1];thenecho\"Compiling with OpenMP...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -disable-dimensions -fopenmp\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-Wall-O2-disable-dimensions-fopenmp\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelseecho\"Compiling for serial execution...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-Wall-O2-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfiif[\\$?-ne0];thenecho\"ERROR: Stage 1 compilation failed\">&2exit1fiecho\"Compilation successful:\\$EXECUTABLE\"# Exit if compile-only modeif[\\$COMPILE_ONLY-eq1];thenecho\"\"echo\"Compile-only mode: Stopping here\"cd../..exit0fi# Executionecho\"\"echo\"Running briefly to generate restart file...\"if[\\$FOPENMP_ENABLED-eq1];thenecho\"  OMP_NUM_THREADS=\\$FOPENMP_THREADS\"exportOMP_NUM_THREADS=\\$FOPENMP_THREADSelseecho\"  Running single-threaded\"fiecho\"  Command: ./\\${EXECUTABLE}\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$STAGE1_TMAX\\$zWall\"./\\${EXECUTABLE}\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$STAGE1_TMAX\\$zWall# Validate the restart file was created successfullyif!validate_restart_file\"restart\";thenecho\"ERROR: Stage 1 failed - restart file validation failed\">&2exit1fiecho\"\"echo\"=========================================\"echo\"Stage 1 complete: restart file created\"echo\"Restart file location:\\$CASE_DIR/restart\"if[\\$STAGE-eq1];thenecho\"\"echo\"To run Stage 2:\"echo\"\\$0 --stage2\\$PARAM_FILE\"echo\"\\$0 --stage2 --mpi\\$PARAM_FILE\"fiecho\"=========================================\"fi# ============================================================# Stage 2: Full Simulation# ============================================================if[\\$STAGE-eq2]||[\\$STAGE-eq0];then# Validate restart file (exists, non-empty, readable)if!validate_restart_file\"restart\";thenecho\"       Run Stage 1 first:\\$0 --stage1\\$PARAM_FILE\">&2exit1fiecho\"\"echo\"=========================================\"echo\"Stage 2: Full Simulation\"echo\"=========================================\"# Compilationif[\\$MPI_ENABLED-eq1];thenecho\"Compiling with MPI...\"if[\"\\$OS_TYPE\"=\"Darwin\"];then# macOS[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelse# Linux[\\$VERBOSE-eq1]&&echo\"Compiler: CC99='mpicc -std=c99 -D_GNU_SOURCE=1' qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -D_MPI=1 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"CC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfielif[\\$FOPENMP_ENABLED-eq1];thenecho\"Compiling with OpenMP...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -disable-dimensions -fopenmp\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-Wall-O2-disable-dimensions-fopenmp\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmelseecho\"Compiling for serial execution...\"[\\$VERBOSE-eq1]&&echo\"Compiler: qcc\"[\\$VERBOSE-eq1]&&echo\"Include paths: -I../../src-local\"[\\$VERBOSE-eq1]&&echo\"Flags: -Wall -O2 -disable-dimensions\\$DEBUG_FLAGS\\$QCC_FLAGS\"qcc-I../../src-local\\-Wall-O2-disable-dimensions\\\\$DEBUG_FLAGS\\$QCC_FLAGS\\\"\\$SRC_FILE_LOCAL\"-o\"\\$EXECUTABLE\"-lmfiif[\\$?-ne0];thenecho\"ERROR: Stage 2 compilation failed\">&2exit1fiecho\"Compilation successful:\\$EXECUTABLE\"# Exit if compile-only modeif[\\$COMPILE_ONLY-eq1];thenecho\"\"echo\"Compile-only mode: Stopping here\"cd../..exit0fi# Executionecho\"\"echo\"Starting full simulation...\"echo\"  Command args:\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"echo\"=========================================\"if[\\$MPI_ENABLED-eq1];then[\\$VERBOSE-eq1]&&echo\"Command: mpirun -np\\$MPI_CORES ./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"mpirun-np\\$MPI_CORES ./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWallelif[\\$FOPENMP_ENABLED-eq1];thenexportOMP_NUM_THREADS=\\$FOPENMP_THREADS[\\$VERBOSE-eq1]&&echo\"OMP_NUM_THREADS=\\$FOPENMP_THREADS\"[\\$VERBOSE-eq1]&&echo\"Command: ./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWallelse[\\$VERBOSE-eq1]&&echo\"Command: ./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"./\\$EXECUTABLE\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWallfiEXIT_CODE=\\$?echo\"=========================================\"if[\\$EXIT_CODE-eq0];thenecho\"Simulation completed successfully\"echo\"Output location:\\$CASE_DIR\"elseecho\"Simulation failed with exit code\\$EXIT_CODE\"fiecho\"=========================================\"# Return to root directorycd../..exit\\$EXIT_CODEfi# Return to root directorycd../..exit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSimulation.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence: Context",
    "content": "runSweepHamilton.sbatch See raw file runSweepHamilton.sbatch #!/bin/bash #SBATCH --job-name=bubbleCoalescence #SBATCH -N 1 #SBATCH -n 128 #SBATCH -c 1 #SBATCH --mem=240G #SBATCH --time=3-00:00:00 #SBATCH --gres=tmp:100G #SBATCH -p multi #SBATCH --mail-type= END ,FAIL #SBATCH --mail-user=vatsal.sanjay@durham.ac.uk #SBATCH --output=slurm-%j.out #SBATCH --error=slurm-%j.err # ============================================================ # Bubble Coalescence - HPC Parameter Sweep Runner (Hamilton) # ============================================================ # This script runs Stage 2 (MPI simulation) on Durham University's Hamilton HPC. # # PREREQUISITE: Restart files must already exist for each case. # Run Stage 1 locally before submitting: # ./runParameterSweep.sh --stage1-only sweep.params # # BEFORE RUNNING: # 1. Run Stage 1 locally to generate restart files for all cases # 2. Clone repo to /nobackup/\\$USER/ (NOT home directory) # 3.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence: Context",
    "content": "Edit sweep.params to set parameter ranges and case numbers # 4. Update --mail-user above with your Durham email # 5.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepHamilton.sbatch # Note: Basilisk is installed automatically via curl during job execution # # SBATCH Parameters (Hamilton-specific): # -n 128: Number of MPI tasks (whole node = 128 cores) # --mem=240G: Memory per node (max 250G on standard nodes) # --time=3-00:00:00: Max wall time (3 days for multi partition) # --gres=tmp:100G: Temporary disk space (\\$TMPDIR) # -p multi: Partition for whole-node jobs # ============================================================ set -e # Exit on error (but we'll handle case failures gracefully) # ============================================================ # Configuration # ============================================================ # Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project root SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # Number of MPI tasks for Stage 2 MPI_TASKS = \\$ {SLURM_NTASKS:-128} # ============================================================ # Validate Working Directory # ============================================================ if [[ ! \" \\$ SCRIPT_DIR\" =~ ^ /nobackup/ ]]; then echo \"WARNING: Running from \\$ SCRIPT_DIR\" echo \" Consider using /nobackup/ \\$ USER/ for better performance\" echo \" Home directory has only 10GB quota and is slower\" echo \"\" fi # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Bubble Coalescence - HPC Parameter Sweep\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID}\" echo \"Number of MPI tasks: \\$ {MPI_TASKS}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION}\" echo \"Memory allocated: \\$ {SLURM_MEM_PER_NODE}MB\" echo \"\" echo \"Mode: Stage 2 only (MPI simulation)\" echo \" Restart files must exist for each case\" echo \"\" # ============================================================ # Load Required Modules # ============================================================ echo \"Loading modules...\" module purge module load openmpi echo \"Modules loaded successfully\" echo \"\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" # Source version configuration if [ -f \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" else echo \"ERROR: src-local/basilisk_version.sh not found\" >& 2 exit 1 fi echo \"Installing Basilisk (ref: \\$ {BASILISK_REF})...\" install_basilisk --hard if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ BASILISK\" else echo \"ERROR: .project_config not found after installation\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Check sweep file exists if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" # Source the sweep file to get variables source \" \\$ SWEEP_FILE\" # Validate required variables if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi # Validate CaseNo range if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" # Create temporary directory for generated parameter files # Use work directory, not /tmp (node-local on Hamilton) TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () # Recursive function to generate all combinations generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true # Print summary echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+\\\"\\${current_values[@]}\\\"} \" \\$ val\" done } # Start recursion generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" # Check if number of combinations matches the range EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Run Simulations (Stage 2 Only - MPI) # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Simulations\" echo \"=============================================\" echo \"Stage 2 only: MPI simulation ( \\$ {MPI_TASKS} tasks)\" echo \"Requires existing restart files in each case directory\" echo \"\" # Counters for tracking SUCCESSFUL_CASES = 0 FAILED_CASES = 0 SKIPPED_CASES = 0 for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Parse parameter file to get values parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"ERROR: CaseNo not found in \\$ param_file\" >& 2 (( FAILED_CASES ++ )) || true continue fi CASE_DIR = \" \\$ {SCRIPT_DIR}/simulationCases/ \\$ {CASE_NO}\" echo \"=========================================\" echo \"Case \\$ CASE_NO ( \\$ (date))\" echo \"=========================================\" echo \"Parameters: OhOut= \\$ OhOut, RhoIn= \\$ RhoIn, Rr= \\$ Rr\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ tmax, zWall= \\$ zWall\" # Check if case directory exists if [ ! -d \" \\$ CASE_DIR\" ] ; then echo \"ERROR: Case directory not found: \\$ CASE_DIR\" >& 2 echo \" Run Stage 1 locally first\" >& 2 (( SKIPPED_CASES ++ )) || true continue fi # Change to case directory cd \" \\$ CASE_DIR\" # Check for restart file (CRITICAL) if [ ! -f \"restart\" ] ; then echo \"ERROR: restart file not found for case \\$ CASE_NO\" >& 2 echo \" Run Stage 1 locally first:\" >& 2 echo \" ./runSimulation.sh --stage1 <params_file>\" >& 2 (( SKIPPED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi echo \"Found restart file\" # Use existing case.params if present (allows manual parameter edits) if [ ! -f \" \\$ CASE_DIR/case.params\" ] ; then cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" else echo \"Using existing case.params (manual edits preserved)\" fi # Re-parse from case.params (source of truth) parse_param_file \" \\$ CASE_DIR/case.params\" OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) tmax = \\$ ( get_param \"tmax\" \"40.0\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) # Copy source file to case directory if needed SRC_FILE_ORIG = \" \\$ {SCRIPT_DIR}/simulationCases/coalescenceBubble.c\" SRC_FILE_LOCAL = \" \\$ CASE_DIR/coalescenceBubble.c\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file \\$ SRC_FILE_ORIG not found\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi # Use existing source file if present (allows local code edits for reruns) if [ ! -f \" \\$ SRC_FILE_LOCAL\" ] ; then cp \" \\$ SRC_FILE_ORIG\" \" \\$ SRC_FILE_LOCAL\" else echo \"Using existing coalescenceBubble.c (local edits preserved)\" fi # Create symlink to DataFiles if needed if [ ! -e \"DataFiles\" ] ; then ln -s ../DataFiles DataFiles fi # ============================================================ # Stage 2: Full Simulation with MPI # ============================================================ echo \"\" echo \"Stage 2: Full simulation (MPI)...\" # Compile with MPI if CC99 = 'mpicc -std=c99 -D_GNU_SOURCE=1' qcc -I.. /../src-local \\ -Wall -O2 -D_MPI = 1 -disable-dimensions \\ coalescenceBubble.c -o coalescenceBubble -lm 2 >& 1 ; then echo \"MPI compilation successful\" else echo \"ERROR: MPI compilation failed for case \\$ CASE_NO\" >& 2 (( FAILED_CASES ++ )) || true cd \" \\$ SCRIPT_DIR\" continue fi # Run simulation with mpirun (Hamilton uses mpirun, not srun) echo \"Running full simulation with \\$ {MPI_TASKS} MPI tasks...\" echo \"Command: mpirun -np \\$ {MPI_TASKS} ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall\" echo \"\" if mpirun -np \\$ {MPI_TASKS} ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ tmax \\$ zWall ; then echo \"\" echo \"Case \\$ CASE_NO completed successfully\" (( SUCCESSFUL_CASES ++ )) || true else EXIT_CODE = \\$ ? echo \"\" echo \"ERROR: Case \\$ CASE_NO failed with exit code \\$ EXIT_CODE\" >& 2 (( FAILED_CASES ++ )) || true fi # Return to root directory cd \" \\$ SCRIPT_DIR\" echo \"\" done # ============================================================ # Final Summary # ============================================================ echo \"=============================================\" echo \"Parameter Sweep Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"Skipped (no restart file): \\$ SKIPPED_CASES\" echo \"Output location: simulationCases/\" echo \"=============================================\" echo \"\" # Exit with error if any cases failed or were skipped if [ \\$ FAILED_CASES -gt 0 ] || [ \\$ SKIPPED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed, \\$ SKIPPED_CASES case(s) skipped.\" >& 2 echo \" Check logs for details.\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence - Code Example: #!/bin/bash#SBATCH --job-name=bubbleCoalescence#SBATCH -N...",
    "content": "#!/bin/bash#SBATCH --job-name=bubbleCoalescence#SBATCH -N 1#SBATCH -n 128#SBATCH -c 1#SBATCH --mem=240G#SBATCH --time=3-00:00:00#SBATCH --gres=tmp:100G#SBATCH -p multi#SBATCH --mail-type=END,FAIL#SBATCH --mail-user=vatsal.sanjay@durham.ac.uk#SBATCH --output=slurm-%j.out#SBATCH --error=slurm-%j.err# ============================================================# Bubble Coalescence - HPC Parameter Sweep Runner (Hamilton)# ============================================================# This script runs Stage 2 (MPI simulation) on Durham University's Hamilton HPC.## PREREQUISITE: Restart files must already exist for each case.# Run Stage 1 locally before submitting:#   ./runParameterSweep.sh --stage1-only sweep.params## BEFORE RUNNING:# 1.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence - Code Example: Run Stage 1...",
    "content": "Run Stage 1 locally to generate restart files for all cases# 2. Clone repo to /nobackup/\\$USER/ (NOT home directory)# 3. Edit sweep.params to set parameter ranges and case numbers# 4. Update --mail-user above with your Durham email# 5.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton.sbatch | Asymmetries-in-coalescence - Code Example: Submit with: sbatch...",
    "content": "Submit with: sbatch runSweepHamilton.sbatch# Note: Basilisk is installed automatically via curl during job execution## SBATCH Parameters (Hamilton-specific):#   -n 128: Number of MPI tasks (whole node = 128 cores)#   --mem=240G: Memory per node (max 250G on standard nodes)#   --time=3-00:00:00: Max wall time (3 days for multi partition)#   --gres=tmp:100G: Temporary disk space (\\$TMPDIR)#   -p multi: Partition for whole-node jobs# ============================================================set-e# Exit on error (but we'll handle case failures gracefully)# ============================================================# Configuration# ============================================================# Use SLURM_SUBMIT_DIR (directory where sbatch was called) as the project rootSCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# Number of MPI tasks for Stage 2MPI_TASKS=\\${SLURM_NTASKS:-128}# ============================================================# Validate Working Directory# ============================================================if[[!\"\\$SCRIPT_DIR\"=~^/nobackup/]];thenecho\"WARNING: Running from\\$SCRIPT_DIR\"echo\"         Consider using /nobackup/\\$USER/ for better performance\"echo\"         Home directory has only 10GB quota and is slower\"echo\"\"fi# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Bubble Coalescence - HPC Parameter Sweep\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID}\"echo\"Number of MPI tasks:\\${MPI_TASKS}\"echo\"Partition:\\${SLURM_JOB_PARTITION}\"echo\"Memory allocated:\\${SLURM_MEM_PER_NODE}MB\"echo\"\"echo\"Mode: Stage 2 only (MPI simulation)\"echo\"      Restart files must exist for each case\"echo\"\"# ============================================================# Load Required Modules# ============================================================echo\"Loading modules...\"modulepurgemoduleload openmpiecho\"Modules loaded successfully\"echo\"\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"# Source version configurationif[-f\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"elseecho\"ERROR: src-local/basilisk_version.sh not found\">&2exit1fiecho\"Installing Basilisk (ref:\\${BASILISK_REF})...\"install_basilisk--hardif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\$BASILISK\"elseecho\"ERROR: .project_config not found after installation\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Check sweep file existsif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"# Source the sweep file to get variablessource\"\\$SWEEP_FILE\"# Validate required variablesif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fi# Validate CaseNo rangeif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"# Create temporary directory for generated parameter files# Use work directory, not /tmp (node-local on Hamilton)TEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()# Recursive function to generate all combinationsgenerate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneCASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||true# Print summaryecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_combinations\\$((depth+ 1))\\${current_values[@]+\\\"\\${current_values[@]}\\\"}\"\\$val\"done}# Start recursiongenerate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"# Check if number of combinations matches the rangeEXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Run Simulations (Stage 2 Only - MPI)# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Simulations\"echo\"=============================================\"echo\"Stage 2 only: MPI simulation (\\${MPI_TASKS} tasks)\"echo\"Requires existing restart files in each case directory\"echo\"\"# Counters for trackingSUCCESSFUL_CASES=0FAILED_CASES=0SKIPPED_CASES=0forparam_filein\"\\${CASE_FILES[@]}\";do# Parse parameter file to get valuesparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")if[-z\"\\$CASE_NO\"];thenecho\"ERROR: CaseNo not found in\\$param_file\">&2((FAILED_CASES++))||truecontinuefiCASE_DIR=\"\\${SCRIPT_DIR}/simulationCases/\\${CASE_NO}\"echo\"=========================================\"echo\"Case\\$CASE_NO (\\$(date))\"echo\"=========================================\"echo\"Parameters: OhOut=\\$OhOut, RhoIn=\\$RhoIn, Rr=\\$Rr\"echo\"            MAXlevel=\\$MAXlevel, tmax=\\$tmax, zWall=\\$zWall\"# Check if case directory existsif[!-d\"\\$CASE_DIR\"];thenecho\"ERROR: Case directory not found:\\$CASE_DIR\">&2echo\"       Run Stage 1 locally first\">&2((SKIPPED_CASES++))||truecontinuefi# Change to case directorycd\"\\$CASE_DIR\"# Check for restart file (CRITICAL)if[!-f\"restart\"];thenecho\"ERROR: restart file not found for case\\$CASE_NO\">&2echo\"       Run Stage 1 locally first:\">&2echo\"       ./runSimulation.sh --stage1 <params_file>\">&2((SKIPPED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefiecho\"Found restart file\"# Use existing case.params if present (allows manual parameter edits)if[!-f\"\\$CASE_DIR/case.params\"];thencp\"\\$param_file\"\"\\$CASE_DIR/case.params\"elseecho\"Using existing case.params (manual edits preserved)\"fi# Re-parse from case.params (source of truth)parse_param_file\"\\$CASE_DIR/case.params\"OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")tmax=\\$(get_param\"tmax\"\"40.0\")zWall=\\$(get_param\"zWall\"\"0.01\")# Copy source file to case directory if neededSRC_FILE_ORIG=\"\\${SCRIPT_DIR}/simulationCases/coalescenceBubble.c\"SRC_FILE_LOCAL=\"\\$CASE_DIR/coalescenceBubble.c\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file\\$SRC_FILE_ORIG not found\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefi# Use existing source file if present (allows local code edits for reruns)if[!-f\"\\$SRC_FILE_LOCAL\"];thencp\"\\$SRC_FILE_ORIG\"\"\\$SRC_FILE_LOCAL\"elseecho\"Using existing coalescenceBubble.c (local edits preserved)\"fi# Create symlink to DataFiles if neededif[!-e\"DataFiles\"];thenln-s../DataFiles DataFilesfi# ============================================================# Stage 2: Full Simulation with MPI# ============================================================echo\"\"echo\"Stage 2: Full simulation (MPI)...\"# Compile with MPIifCC99='mpicc -std=c99 -D_GNU_SOURCE=1'qcc-I../../src-local\\-Wall-O2-D_MPI=1-disable-dimensions\\coalescenceBubble.c-ocoalescenceBubble-lm2>&1;thenecho\"MPI compilation successful\"elseecho\"ERROR: MPI compilation failed for case\\$CASE_NO\">&2((FAILED_CASES++))||truecd\"\\$SCRIPT_DIR\"continuefi# Run simulation with mpirun (Hamilton uses mpirun, not srun)echo\"Running full simulation with\\${MPI_TASKS} MPI tasks...\"echo\"Command: mpirun -np\\${MPI_TASKS} ./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall\"echo\"\"ifmpirun-np\\${MPI_TASKS} ./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$tmax\\$zWall;thenecho\"\"echo\"Case\\$CASE_NO completed successfully\"((SUCCESSFUL_CASES++))||trueelseEXIT_CODE=\\$?echo\"\"echo\"ERROR: Case\\$CASE_NO failed with exit code\\$EXIT_CODE\">&2((FAILED_CASES++))||truefi# Return to root directorycd\"\\$SCRIPT_DIR\"echo\"\"done# ============================================================# Final Summary# ============================================================echo\"=============================================\"echo\"Parameter Sweep Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"Skipped (no restart file):\\$SKIPPED_CASES\"echo\"Output location: simulationCases/\"echo\"=============================================\"echo\"\"# Exit with error if any cases failed or were skippedif[\\$FAILED_CASES-gt0]||[\\$SKIPPED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed,\\$SKIPPED_CASES case(s) skipped.\">&2echo\"         Check logs for details.\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton-serial.sbatch | Asymmetries-in-coalescence: Context",
    "content": "runSweepHamilton-serial.sbatch See raw file runSweepHamilton-serial.sbatch #!/bin/bash #SBATCH --job-name=bubbleCoal-S1 #SBATCH -N 1 #SBATCH -n 48 #SBATCH -c 1 #SBATCH --mem=64G #SBATCH --time=12:00:00 #SBATCH -p multi #SBATCH --mail-type= END ,FAIL #SBATCH --mail-user=vatsal.sanjay@durham.ac.uk #SBATCH --output=slurm-stage1-%j.out #SBATCH --error=slurm-stage1-%j.err # ============================================================ # Bubble Coalescence - Stage 1 Serial Runner (Hamilton) # ============================================================ # This script runs Stage 1 (initialization) for all cases in parallel. # Each case runs on 1 core (serial, no OpenMP/MPI). # Up to 48 cases run simultaneously. # # Stage 1 generates restart files needed for Stage 2 (MPI simulation). # # AFTER RUNNING: # Submit Stage 2 with: sbatch runSweepHamilton.sbatch # # SBATCH Parameters (Hamilton-specific): # -n 48: Number of tasks (one per case, max 48 concurrent) # --mem=64G: Memory (Stage 1 is less memory-intensive) # --time=12:00:00: Wall time (Stage 1 is quick per case) # -p multi: Partition for whole-node jobs # ============================================================ set -e # Exit on error (but we'll handle case failures gracefully) # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ {SLURM_SUBMIT_DIR}\" SWEEP_FILE = \" \\$ {SCRIPT_DIR}/sweep.params\" # Maximum concurrent jobs (matches SLURM allocation) MAX_CONCURRENT = \\$ {SLURM_NTASKS:-48} # Stage 1 tmax - short run to generate restart file STAGE1_TMAX = \"5e-2\" # ============================================================ # Validate Working Directory # ============================================================ if [[ ! \" \\$ SCRIPT_DIR\" =~ ^ /nobackup/ ]]; then echo \"WARNING: Running from \\$ SCRIPT_DIR\" echo \" Consider using /nobackup/ \\$ USER/ for better performance\" echo \" Home directory has only 10GB quota and is slower\" echo \"\" fi # ============================================================ # Print Job Information # ============================================================ echo \"=============================================\" echo \"Bubble Coalescence - Stage 1 (Serial)\" echo \"=============================================\" echo \"Job started at: \\$ (date)\" echo \"Running on node: \\$ (hostname)\" echo \"Working directory: \\$ (pwd)\" echo \"Job ID: \\$ {SLURM_JOB_ID}\" echo \"Max concurrent cases: \\$ {MAX_CONCURRENT}\" echo \"Partition: \\$ {SLURM_JOB_PARTITION}\" echo \"\" echo \"Mode: Stage 1 only (serial initialization)\" echo \" Generates restart files for Stage 2\" echo \" Each case runs on 1 core (no OpenMP/MPI)\" echo \"\" # ============================================================ # Load Required Modules (minimal for serial) # ============================================================ echo \"Loading modules...\" module purge # No MPI needed for serial execution echo \"Modules loaded (serial mode - no MPI)\" echo \"\" # ============================================================ # Setup Basilisk Environment # ============================================================ echo \"Setting up Basilisk environment...\" # Source version configuration if [ -f \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/basilisk_version.sh\" else echo \"ERROR: src-local/basilisk_version.sh not found\" >& 2 exit 1 fi echo \"Installing Basilisk (ref: \\$ {BASILISK_REF})...\" install_basilisk --hard if [ -f \" \\$ {SCRIPT_DIR}/.project_config\" ] ; then source \" \\$ {SCRIPT_DIR}/.project_config\" echo \"Basilisk environment loaded from .project_config\" echo \"BASILISK: \\$ BASILISK\" else echo \"ERROR: .project_config not found after installation\" >& 2 exit 1 fi echo \"\" # ============================================================ # Validate Environment # ============================================================ if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi if [ ! -f \" \\$ SWEEP_FILE\" ] ; then echo \"ERROR: Sweep file not found: \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep file: \\$ SWEEP_FILE\" echo \"\" # ============================================================ # Parse Sweep Configuration # ============================================================ echo \"Parsing sweep configuration...\" source \" \\$ SWEEP_FILE\" if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 exit 1 fi if [ -z \" \\$ CASE_START\" ] || [ -z \" \\$ CASE_END\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined in sweep file\" >& 2 exit 1 fi if [ \" \\$ CASE_START\" -lt 1000 ] || [ \" \\$ CASE_START\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ CASE_START\" >& 2 exit 1 fi if [ \" \\$ CASE_END\" -lt \" \\$ CASE_START\" ] || [ \" \\$ CASE_END\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ CASE_END\" >& 2 exit 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 exit 1 fi echo \"Base configuration: \\$ BASE_CONFIG\" echo \"Case number range: \\$ CASE_START to \\$ CASE_END\" echo \"\" # ============================================================ # Extract Sweep Variables # ============================================================ SWEEP_VARS = () SWEEP_VALUES = () while IFS = '=' read -r key value ; do [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ SWEEP_FILE\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ SWEEP_FILE\" >& 2 exit 1 fi echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done echo \"\" # ============================================================ # Generate Parameter Combinations # ============================================================ echo \"Generating parameter combinations...\" TEMP_DIR = \" \\$ {SCRIPT_DIR}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ TEMP_DIR\" >& 2 exit 1 } trap \"rm -rf \\$ TEMP_DIR\" EXIT CASE_NUM = \\$ CASE_START COMBINATION_COUNT = 0 CASE_FILES = () generate_combinations() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then local case_file = \" \\$ {TEMP_DIR}/case_ \\$ (printf \" %04d \" \\$ CASE_NUM).params\" cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done CASE_FILES += ( \" \\$ case_file\" ) (( COMBINATION_COUNT ++ )) || true echo \"Case \\$ CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" (( CASE_NUM ++ )) || true return fi local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) generate_combinations \\$ ( ( depth + 1 )) \\${current_values[@]+ \" \\$ {current_values[@]}\" } \" \\$ val\" done } generate_combinations 0 echo \"Generated \\$ COMBINATION_COUNT parameter combinations\" EXPECTED_COUNT = \\$ (( CASE_END - CASE_START + 1 )) if [ \\$ COMBINATION_COUNT -ne \\$ EXPECTED_COUNT ] ; then echo \"WARNING: Generated \\$ COMBINATION_COUNT combinations, but CASE_END suggests \\$ EXPECTED_COUNT\" >& 2 fi if [ \\$ COMBINATION_COUNT -gt \\$ EXPECTED_COUNT ] ; then echo \"ERROR: Too many combinations ( \\$ COMBINATION_COUNT) for range \\$ CASE_START- \\$ CASE_END\" >& 2 exit 1 fi echo \"\" # ============================================================ # Prepare Status Tracking # ============================================================ STATUS_DIR = \" \\$ {TEMP_DIR}/status\" mkdir -p \" \\$ STATUS_DIR\" # ============================================================ # Function to Run Single Case (Stage 1) # ============================================================ run_stage1_case() { local param_file = \\$ 1 local status_dir = \\$ 2 local script_dir = \\$ 3 local stage1_tmax = \\$ 4 # Source parameter parsing in subshell source \" \\$ {script_dir}/src-local/parse_params.sh\" parse_param_file \" \\$ param_file\" local CASE_NO = \\$ ( get_param \"CaseNo\" ) local OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) local RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) local Rr = \\$ ( get_param \"Rr\" \"1.0\" ) local MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) local zWall = \\$ ( get_param \"zWall\" \"0.01\" ) if [ -z \" \\$ CASE_NO\" ] ; then echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO:-unknown}\" return 1 fi local CASE_DIR = \" \\$ {script_dir}/simulationCases/ \\$ {CASE_NO}\" local LOG_FILE = \" \\$ {CASE_DIR}/stage1.log\" # Create case directory BEFORE redirecting to log file mkdir -p \" \\$ CASE_DIR\" # Use existing case.params if present (allows manual parameter edits for reruns) # Otherwise, create from sweep-generated params if [ ! -f \" \\$ CASE_DIR/case.params\" ] ; then cp \" \\$ param_file\" \" \\$ CASE_DIR/case.params\" fi # Re-parse from case.params (source of truth for this case) parse_param_file \" \\$ CASE_DIR/case.params\" OhOut = \\$ ( get_param \"OhOut\" \"1e-2\" ) RhoIn = \\$ ( get_param \"RhoIn\" \"1e-3\" ) Rr = \\$ ( get_param \"Rr\" \"1.0\" ) MAXlevel = \\$ ( get_param \"MAXlevel\" \"10\" ) zWall = \\$ ( get_param \"zWall\" \"0.01\" ) { echo \"=========================================\" echo \"Case \\$ CASE_NO - Stage 1 ( \\$ (date))\" echo \"=========================================\" echo \"Parameters: OhOut= \\$ OhOut, RhoIn= \\$ RhoIn, Rr= \\$ Rr\" echo \" MAXlevel= \\$ MAXlevel, tmax= \\$ stage1_tmax, zWall= \\$ zWall\" cd \" \\$ CASE_DIR\" # Copy source file local SRC_FILE_ORIG = \" \\$ {script_dir}/simulationCases/coalescenceBubble.c\" if [ ! -f \" \\$ SRC_FILE_ORIG\" ] ; then echo \"ERROR: Source file not found\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi # Use existing source file if present (allows local code edits for reruns) if [ ! -f \"coalescenceBubble.c\" ] ; then cp \" \\$ SRC_FILE_ORIG\" \"coalescenceBubble.c\" fi # Create symlink to DataFiles if [ ! -e \"DataFiles\" ] ; then ln -s ../DataFiles DataFiles fi # Compile SERIAL (no OpenMP, no MPI) echo \"Compiling (serial)...\" if ! qcc -I.. /../src-local -Wall -O2 -disable-dimensions \\ coalescenceBubble.c -o coalescenceBubble -lm 2 >& 1 ; then echo \"ERROR: Compilation failed\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi echo \"Compilation successful\" # Run Stage 1 with small tmax echo \"Running Stage 1 (tmax= \\$ stage1_tmax)...\" if ./coalescenceBubble \\$ OhOut \\$ RhoIn \\$ Rr \\$ MAXlevel \\$ stage1_tmax \\$ zWall ; then echo \"Stage 1 completed\" # Verify restart file was created if [ -f \"restart\" ] ; then echo \"Restart file created successfully\" echo \"SUCCESS\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" else echo \"WARNING: restart file not found after Stage 1\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi else echo \"ERROR: Stage 1 failed\" echo \"FAILED\" > \" \\$ {status_dir}/ \\$ {CASE_NO}\" return 1 fi echo \"Case \\$ CASE_NO Stage 1 complete\" } > \" \\$ LOG_FILE\" 2 >& 1 return 0 } export -f run_stage1_case # ============================================================ # Run All Cases in Parallel (Stage 1) # ============================================================ echo \"=============================================\" echo \"Running \\$ COMBINATION_COUNT Cases (Stage 1)\" echo \"=============================================\" echo \"Max concurrent: \\$ {MAX_CONCURRENT}\" echo \"Each case: serial execution, tmax= \\$ {STAGE1_TMAX}\" echo \"\" RUNNING_JOBS = 0 PIDS = () for param_file in \" \\$ {CASE_FILES[@]}\" ; do # Wait if we've hit the concurrency limit while [ \\$ RUNNING_JOBS -ge \\$ MAX_CONCURRENT ] ; do # Wait for any background job to finish wait -n 2 > /dev/null || true (( RUNNING_JOBS -- )) || true done # Launch case in background run_stage1_case \" \\$ param_file\" \" \\$ STATUS_DIR\" \" \\$ SCRIPT_DIR\" \" \\$ STAGE1_TMAX\" & PIDS += ( \\$ ! ) (( RUNNING_JOBS ++ )) || true # Extract case number for logging parse_param_file \" \\$ param_file\" CASE_NO = \\$ ( get_param \"CaseNo\" ) echo \"Launched case \\$ CASE_NO (PID: \\$ {PIDS[-1]}, running: \\$ RUNNING_JOBS)\" done echo \"\" echo \"All cases launched, waiting for completion...\" echo \"\" # Wait for all remaining jobs wait # ============================================================ # Collect Results # ============================================================ SUCCESSFUL_CASES = 0 FAILED_CASES = 0 for status_file in \" \\$ {STATUS_DIR}\" / * ; do if [ -f \" \\$ status_file\" ] ; then status = \\$ ( cat \" \\$ status_file\" ) case_no = \\$ ( basename \" \\$ status_file\" ) if [ \" \\$ status\" = \"SUCCESS\" ] ; then (( SUCCESSFUL_CASES ++ )) || true else (( FAILED_CASES ++ )) || true echo \"FAILED: Case \\$ case_no\" fi fi done # ============================================================ # Final Summary # ============================================================ echo \"\" echo \"=============================================\" echo \"Stage 1 Complete\" echo \"=============================================\" echo \"Job completed at: \\$ (date)\" echo \"Total cases: \\$ COMBINATION_COUNT\" echo \"Successful: \\$ SUCCESSFUL_CASES\" echo \"Failed: \\$ FAILED_CASES\" echo \"\" echo \"Restart files location: simulationCases/*/restart\" echo \"\" if [ \\$ SUCCESSFUL_CASES -gt 0 ] ; then echo \"Next step: Submit Stage 2 with:\" echo \" sbatch runSweepHamilton.sbatch\" fi echo \"=============================================\" if [ \\$ FAILED_CASES -gt 0 ] ; then echo \"WARNING: \\$ FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton-serial.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton-serial.sbatch | Asymmetries-in-coalescence: Check logs in...",
    "content": "Check logs in simulationCases/*/stage1.log\" >& 2 exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton-serial.sbatch.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runSweepHamilton-serial.sbatch | Asymmetries-in-coalescence - Code Example: #!/bin/bash#SBATCH --job-name=bubbleCoal-S1#SBATCH -N...",
    "content": "#!/bin/bash#SBATCH --job-name=bubbleCoal-S1#SBATCH -N 1#SBATCH -n 48#SBATCH -c 1#SBATCH --mem=64G#SBATCH --time=12:00:00#SBATCH -p multi#SBATCH --mail-type=END,FAIL#SBATCH --mail-user=vatsal.sanjay@durham.ac.uk#SBATCH --output=slurm-stage1-%j.out#SBATCH --error=slurm-stage1-%j.err# ============================================================# Bubble Coalescence - Stage 1 Serial Runner (Hamilton)# ============================================================# This script runs Stage 1 (initialization) for all cases in parallel.# Each case runs on 1 core (serial, no OpenMP/MPI).# Up to 48 cases run simultaneously.## Stage 1 generates restart files needed for Stage 2 (MPI simulation).## AFTER RUNNING:# Submit Stage 2 with: sbatch runSweepHamilton.sbatch## SBATCH Parameters (Hamilton-specific):#   -n 48: Number of tasks (one per case, max 48 concurrent)#   --mem=64G: Memory (Stage 1 is less memory-intensive)#   --time=12:00:00: Wall time (Stage 1 is quick per case)#   -p multi: Partition for whole-node jobs# ============================================================set-e# Exit on error (but we'll handle case failures gracefully)# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\${SLURM_SUBMIT_DIR}\"SWEEP_FILE=\"\\${SCRIPT_DIR}/sweep.params\"# Maximum concurrent jobs (matches SLURM allocation)MAX_CONCURRENT=\\${SLURM_NTASKS:-48}# Stage 1 tmax - short run to generate restart fileSTAGE1_TMAX=\"5e-2\"# ============================================================# Validate Working Directory# ============================================================if[[!\"\\$SCRIPT_DIR\"=~^/nobackup/]];thenecho\"WARNING: Running from\\$SCRIPT_DIR\"echo\"         Consider using /nobackup/\\$USER/ for better performance\"echo\"         Home directory has only 10GB quota and is slower\"echo\"\"fi# ============================================================# Print Job Information# ============================================================echo\"=============================================\"echo\"Bubble Coalescence - Stage 1 (Serial)\"echo\"=============================================\"echo\"Job started at:\\$(date)\"echo\"Running on node:\\$(hostname)\"echo\"Working directory:\\$(pwd)\"echo\"Job ID:\\${SLURM_JOB_ID}\"echo\"Max concurrent cases:\\${MAX_CONCURRENT}\"echo\"Partition:\\${SLURM_JOB_PARTITION}\"echo\"\"echo\"Mode: Stage 1 only (serial initialization)\"echo\"      Generates restart files for Stage 2\"echo\"      Each case runs on 1 core (no OpenMP/MPI)\"echo\"\"# ============================================================# Load Required Modules (minimal for serial)# ============================================================echo\"Loading modules...\"modulepurge# No MPI needed for serial executionecho\"Modules loaded (serial mode - no MPI)\"echo\"\"# ============================================================# Setup Basilisk Environment# ============================================================echo\"Setting up Basilisk environment...\"# Source version configurationif[-f\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/basilisk_version.sh\"elseecho\"ERROR: src-local/basilisk_version.sh not found\">&2exit1fiecho\"Installing Basilisk (ref:\\${BASILISK_REF})...\"install_basilisk--hardif[-f\"\\${SCRIPT_DIR}/.project_config\"];thensource\"\\${SCRIPT_DIR}/.project_config\"echo\"Basilisk environment loaded from .project_config\"echo\"BASILISK:\\$BASILISK\"elseecho\"ERROR: .project_config not found after installation\">&2exit1fiecho\"\"# ============================================================# Validate Environment# ============================================================if[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fiif[!-f\"\\$SWEEP_FILE\"];thenecho\"ERROR: Sweep file not found:\\$SWEEP_FILE\">&2exit1fiecho\"Sweep file:\\$SWEEP_FILE\"echo\"\"# ============================================================# Parse Sweep Configuration# ============================================================echo\"Parsing sweep configuration...\"source\"\\$SWEEP_FILE\"if[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2exit1fiif[-z\"\\$CASE_START\"]||[-z\"\\$CASE_END\"];thenecho\"ERROR: CASE_START and CASE_END must be defined in sweep file\">&2exit1fiif[\"\\$CASE_START\"-lt1000]||[\"\\$CASE_START\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$CASE_START\">&2exit1fiif[\"\\$CASE_END\"-lt\"\\$CASE_START\"]||[\"\\$CASE_END\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$CASE_END\">&2exit1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2exit1fiecho\"Base configuration:\\$BASE_CONFIG\"echo\"Case number range:\\$CASE_START to\\$CASE_END\"echo\"\"# ============================================================# Extract Sweep Variables# ============================================================SWEEP_VARS=()SWEEP_VALUES=()whileIFS='='read-rkeyvalue;do[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continueif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenvar_name=\"\\${BASH_REMATCH[1]}\"value=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$SWEEP_FILE\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$SWEEP_FILE\">&2exit1fiecho\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"doneecho\"\"# ============================================================# Generate Parameter Combinations# ============================================================echo\"Generating parameter combinations...\"TEMP_DIR=\"\\${SCRIPT_DIR}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$TEMP_DIR\">&2exit1}trap\"rm -rf\\$TEMP_DIR\"EXITCASE_NUM=\\$CASE_STARTCOMBINATION_COUNT=0CASE_FILES=()generate_combinations(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];thenlocalcase_file=\"\\${TEMP_DIR}/case_\\$(printf \"%04d\"\\$CASE_NUM).params\"cp\"\\$BASE_CONFIG\"\"\\$case_file\"ifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"foriin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneCASE_FILES+=(\"\\$case_file\")((COMBINATION_COUNT++))||trueecho\"Case\\$CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"((CASE_NUM++))||truereturnfilocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)generate_combinations\\$((depth+ 1))\\${current_values[@]+\"\\${current_values[@]}\"}\"\\$val\"done}generate_combinations0echo\"Generated\\$COMBINATION_COUNT parameter combinations\"EXPECTED_COUNT=\\$((CASE_END-CASE_START+1))if[\\$COMBINATION_COUNT-ne\\$EXPECTED_COUNT];thenecho\"WARNING: Generated\\$COMBINATION_COUNT combinations, but CASE_END suggests\\$EXPECTED_COUNT\">&2fiif[\\$COMBINATION_COUNT-gt\\$EXPECTED_COUNT];thenecho\"ERROR: Too many combinations (\\$COMBINATION_COUNT) for range\\$CASE_START-\\$CASE_END\">&2exit1fiecho\"\"# ============================================================# Prepare Status Tracking# ============================================================STATUS_DIR=\"\\${TEMP_DIR}/status\"mkdir-p\"\\$STATUS_DIR\"# ============================================================# Function to Run Single Case (Stage 1)# ============================================================run_stage1_case(){localparam_file=\\$1localstatus_dir=\\$2localscript_dir=\\$3localstage1_tmax=\\$4# Source parameter parsing in subshellsource\"\\${script_dir}/src-local/parse_params.sh\"parse_param_file\"\\$param_file\"localCASE_NO=\\$(get_param\"CaseNo\")localOhOut=\\$(get_param\"OhOut\"\"1e-2\")localRhoIn=\\$(get_param\"RhoIn\"\"1e-3\")localRr=\\$(get_param\"Rr\"\"1.0\")localMAXlevel=\\$(get_param\"MAXlevel\"\"10\")localzWall=\\$(get_param\"zWall\"\"0.01\")if[-z\"\\$CASE_NO\"];thenecho\"FAILED\">\"\\${status_dir}/\\${CASE_NO:-unknown}\"return1filocalCASE_DIR=\"\\${script_dir}/simulationCases/\\${CASE_NO}\"localLOG_FILE=\"\\${CASE_DIR}/stage1.log\"# Create case directory BEFORE redirecting to log filemkdir-p\"\\$CASE_DIR\"# Use existing case.params if present (allows manual parameter edits for reruns)# Otherwise, create from sweep-generated paramsif[!-f\"\\$CASE_DIR/case.params\"];thencp\"\\$param_file\"\"\\$CASE_DIR/case.params\"fi# Re-parse from case.params (source of truth for this case)parse_param_file\"\\$CASE_DIR/case.params\"OhOut=\\$(get_param\"OhOut\"\"1e-2\")RhoIn=\\$(get_param\"RhoIn\"\"1e-3\")Rr=\\$(get_param\"Rr\"\"1.0\")MAXlevel=\\$(get_param\"MAXlevel\"\"10\")zWall=\\$(get_param\"zWall\"\"0.01\"){echo\"=========================================\"echo\"Case\\$CASE_NO - Stage 1 (\\$(date))\"echo\"=========================================\"echo\"Parameters: OhOut=\\$OhOut, RhoIn=\\$RhoIn, Rr=\\$Rr\"echo\"            MAXlevel=\\$MAXlevel, tmax=\\$stage1_tmax, zWall=\\$zWall\"cd\"\\$CASE_DIR\"# Copy source filelocalSRC_FILE_ORIG=\"\\${script_dir}/simulationCases/coalescenceBubble.c\"if[!-f\"\\$SRC_FILE_ORIG\"];thenecho\"ERROR: Source file not found\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fi# Use existing source file if present (allows local code edits for reruns)if[!-f\"coalescenceBubble.c\"];thencp\"\\$SRC_FILE_ORIG\"\"coalescenceBubble.c\"fi# Create symlink to DataFilesif[!-e\"DataFiles\"];thenln-s../DataFiles DataFilesfi# Compile SERIAL (no OpenMP, no MPI)echo\"Compiling (serial)...\"if!qcc-I../../src-local-Wall-O2-disable-dimensions\\coalescenceBubble.c-ocoalescenceBubble-lm2>&1;thenecho\"ERROR: Compilation failed\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fiecho\"Compilation successful\"# Run Stage 1 with small tmaxecho\"Running Stage 1 (tmax=\\$stage1_tmax)...\"if./coalescenceBubble\\$OhOut\\$RhoIn\\$Rr\\$MAXlevel\\$stage1_tmax\\$zWall;thenecho\"Stage 1 completed\"# Verify restart file was createdif[-f\"restart\"];thenecho\"Restart file created successfully\"echo\"SUCCESS\">\"\\${status_dir}/\\${CASE_NO}\"elseecho\"WARNING: restart file not found after Stage 1\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fielseecho\"ERROR: Stage 1 failed\"echo\"FAILED\">\"\\${status_dir}/\\${CASE_NO}\"return1fiecho\"Case\\$CASE_NO Stage 1 complete\"}>\"\\$LOG_FILE\"2>&1return0}export-frun_stage1_case# ============================================================# Run All Cases in Parallel (Stage 1)# ============================================================echo\"=============================================\"echo\"Running\\$COMBINATION_COUNT Cases (Stage 1)\"echo\"=============================================\"echo\"Max concurrent:\\${MAX_CONCURRENT}\"echo\"Each case: serial execution, tmax=\\${STAGE1_TMAX}\"echo\"\"RUNNING_JOBS=0PIDS=()forparam_filein\"\\${CASE_FILES[@]}\";do# Wait if we've hit the concurrency limitwhile[\\$RUNNING_JOBS-ge\\$MAX_CONCURRENT];do# Wait for any background job to finishwait-n2>/dev/null||true((RUNNING_JOBS--))||truedone# Launch case in backgroundrun_stage1_case\"\\$param_file\"\"\\$STATUS_DIR\"\"\\$SCRIPT_DIR\"\"\\$STAGE1_TMAX\"&PIDS+=(\\$!)((RUNNING_JOBS++))||true# Extract case number for loggingparse_param_file\"\\$param_file\"CASE_NO=\\$(get_param\"CaseNo\")echo\"Launched case\\$CASE_NO (PID:\\${PIDS[-1]}, running:\\$RUNNING_JOBS)\"doneecho\"\"echo\"All cases launched, waiting for completion...\"echo\"\"# Wait for all remaining jobswait# ============================================================# Collect Results# ============================================================SUCCESSFUL_CASES=0FAILED_CASES=0forstatus_filein\"\\${STATUS_DIR}\"/*;doif[-f\"\\$status_file\"];thenstatus=\\$(cat\"\\$status_file\")case_no=\\$(basename\"\\$status_file\")if[\"\\$status\"=\"SUCCESS\"];then((SUCCESSFUL_CASES++))||trueelse((FAILED_CASES++))||trueecho\"FAILED: Case\\$case_no\"fifidone# ============================================================# Final Summary# ============================================================echo\"\"echo\"=============================================\"echo\"Stage 1 Complete\"echo\"=============================================\"echo\"Job completed at:\\$(date)\"echo\"Total cases:\\$COMBINATION_COUNT\"echo\"Successful:\\$SUCCESSFUL_CASES\"echo\"Failed:\\$FAILED_CASES\"echo\"\"echo\"Restart files location: simulationCases/*/restart\"echo\"\"if[\\$SUCCESSFUL_CASES-gt0];thenecho\"Next step: Submit Stage 2 with:\"echo\"  sbatch runSweepHamilton.sbatch\"fiecho\"=============================================\"if[\\$FAILED_CASES-gt0];thenecho\"WARNING:\\$FAILED_CASES case(s) failed.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton-serial.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runSweepHamilton-serial.sbatch | Asymmetries-in-coalescence - Code Example: Check logs in...",
    "content": "Check logs in simulationCases/*/stage1.log\">&2exit1fiexit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runSweepHamilton-serial.sbatch.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "default.params | Asymmetries-in-coalescence: Context",
    "content": "default.params See raw file default.params # Bubble Coalescence Simulation - Default Parameters # Format: key=value (one per line, # for comments) # This file provides a typical bubble coalescence configuration # ============================================================ # Case Identification # ============================================================ # Case number for folder naming (4-digit: 1000-9999) # Output will be created in simulationCases/<CaseNo>/ CaseNo = 2000 # ============================================================ # Physical Parameters (Dimensionless Numbers) # ============================================================ # Ohnesorge number (outer fluid): Oh = mu/sqrt(rho*sigma*R) # Controls viscous vs surface tension effects OhOut = 1e-2 # Density ratio: rho_inner/rho_outer (bubble in liquid ~ 1e-3) RhoIn = 1e-3 # Radius ratio: R_small/R_large # Available values (matching DataFiles): 1.00, 1.50, 2.00, 4.00, 8.00 Rr = 1.00 # Note: MuRin (viscosity ratio inner/outer) is hardcoded as 1e-2 in the source # ============================================================ # Numerical Parameters (Mesh Adaptation) # ============================================================ # Maximum refinement level (2^MAXlevel cells at finest resolution) # Level 10 -> 1024 cells, Level 12 -> 4096 cells MAXlevel = 12 # ============================================================ # Time Control # ============================================================ # Maximum simulation time (dimensionless, based on capillary time scale) tmax = 1.5 # ============================================================ # Geometry Configuration # ============================================================ # Wall position (distance from origin to wall) # Domain size is computed as: Ldomain = zWall + 2 + 2*Rr + 4.0 zWall = 0.05 # ============================================================ # Output Configuration # ============================================================ # Output directory name (created inside case folder) output_dir = results # Snapshot interval (defined in source code as tsnap = 1e-2) # Log interval (defined in source code as tsnap2 = 1e-4)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/default.params.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "default.params | Asymmetries-in-coalescence - Code Example: # Bubble Coalescence...",
    "content": "# Bubble Coalescence Simulation - Default Parameters# Format: key=value (one per line, # for comments)# This file provides a typical bubble coalescence configuration# ============================================================# Case Identification# ============================================================# Case number for folder naming (4-digit: 1000-9999)# Output will be created in simulationCases/<CaseNo>/CaseNo=2000# ============================================================# Physical Parameters (Dimensionless Numbers)# ============================================================# Ohnesorge number (outer fluid): Oh = mu/sqrt(rho*sigma*R)# Controls viscous vs surface tension effectsOhOut=1e-2# Density ratio: rho_inner/rho_outer (bubble in liquid ~ 1e-3)RhoIn=1e-3# Radius ratio: R_small/R_large# Available values (matching DataFiles): 1.00, 1.50, 2.00, 4.00, 8.00Rr=1.00# Note: MuRin (viscosity ratio inner/outer) is hardcoded as 1e-2 in the source# ============================================================# Numerical Parameters (Mesh Adaptation)# ============================================================# Maximum refinement level (2^MAXlevel cells at finest resolution)# Level 10 -> 1024 cells, Level 12 -> 4096 cellsMAXlevel=12# ============================================================# Time Control# ============================================================# Maximum simulation time (dimensionless, based on capillary time scale)tmax=1.5# ============================================================# Geometry Configuration# ============================================================# Wall position (distance from origin to wall)# Domain size is computed as: Ldomain = zWall + 2 + 2*Rr + 4.0zWall=0.05# ============================================================# Output Configuration# ============================================================# Output directory name (created inside case folder)output_dir=results# Snapshot interval (defined in source code as tsnap = 1e-2)# Log interval (defined in source code as tsnap2 = 1e-4)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/default.params.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Asymmetries-in-coalescence: Context",
    "content": "runPostProcess-Ncases.sh See raw file runPostProcess-Ncases.sh #!/bin/bash # runPostProcess-Ncases.sh - Run post-processing pipeline on multiple simulation cases # Author: Vatsal Sanjay # vatsal.sanjay@comphy-lab.org # CoMPhy Lab - Durham University # Last updated: Jan 2026 set -euo pipefail # Exit on error, unset variables, pipeline failures # ============================================================ # Configuration # ============================================================ SCRIPT_DIR = \" \\$ (cd \" \\$ ( dirname \" \\$ {BASH_SOURCE[0]}\" ) \" && pwd)\" # Source parameter parsing library if [ -f \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" ] ; then source \" \\$ {SCRIPT_DIR}/src-local/parse_params.sh\" else echo \"ERROR: src-local/parse_params.sh not found\" >& 2 exit 1 fi # Post-processing script paths VIDEO_SCRIPT = \" \\$ {SCRIPT_DIR}/postProcess/Video-generic.py\" # C helper executables HELPER_GETFACET = \" \\$ {SCRIPT_DIR}/postProcess/getFacet\" HELPER_GETDATA = \" \\$ {SCRIPT_DIR}/postProcess/getData-generic\" HELPER_GETCOM = \" \\$ {SCRIPT_DIR}/postProcess/getCOM\" # Case directory root CASES_DIR = \" \\$ {SCRIPT_DIR}/simulationCases\" # ============================================================ # Usage Information # ============================================================ usage() { cat <<EOF Usage: \\$ 0 [OPTIONS] CASE_NO [CASE_NO ...] Run post-processing pipeline on multiple bubble coalescence simulation cases.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Asymmetries-in-coalescence: For each case,...",
    "content": "For each case, generates video frames with strain-rate/velocity fields, interface facets, and center of mass tracking. Options: --CPUs N Number of parallel workers (default: 4) --nGFS N Number of snapshots to process (default: 4000) --tsnap F Time interval between snapshots (default: 0.01) --GridsPerR N Radial grid resolution for video (default: 256) --ZMIN F Override minimum Z (auto: max(-2-zWall, -3.0)) --ZMAX F Override maximum Z (auto: 5*Rr-2.0) --RMAX F Override maximum R (auto: 2.5*Rr) Note: Rr and zWall are auto-extracted from each case's case.params file.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Asymmetries-in-coalescence: Domain bounds are...",
    "content": "Domain bounds are calculated per-case unless overridden above. --skip-video-encode Skip ffmpeg video encoding after frame generation -n, --dry-run Show what would run without executing -v, --verbose Verbose output -h, --help Show this help message Arguments: CASE_NO 4-digit case numbers (1000-9999) or ranges (e.g., 3000-3010) Examples: # Process multiple cases with default settings \\$ 0 3000 3001 3002 # Process a range of cases \\$ 0 3000-3010 # Mix individual cases and ranges \\$ 0 3000 3005-3007 3010 # Process with 8 CPUs \\$ 0 --CPUs 8 3000 3001 # Process first 100 snapshots only (for testing) \\$ 0 --nGFS 100 3000 # Skip video encoding (only generate frames) \\$ 0 --skip-video-encode 3000 3001 # Dry run to preview commands \\$ 0 --dry-run 3000 Output locations: simulationCases/<CaseNo>/Video/ # PNG frames simulationCases/<CaseNo>/<CaseNo>_COMData.csv # COM time series simulationCases/<CaseNo>/<CaseNo>.mp4 # Encoded video For more information, see README.md EOF } # ============================================================ # Helper: Expand Case Argument (single number or range) # ============================================================ expand_case_arg() { local arg = \" \\$ 1\" # Check if it's a range (contains hyphen between two 4-digit numbers) if [[ \" \\$ arg\" =~ ^ ([ 0 - 9 ] { 4 } ) - ([ 0 - 9 ] { 4 } ) \\$ ]]; then local start = \" \\$ {BASH_REMATCH[1]}\" local end = \" \\$ {BASH_REMATCH[2]}\" if [ \" \\$ start\" -gt \" \\$ end\" ] ; then echo \"ERROR: Invalid range \\$ arg (start > end)\" >& 2 return 1 fi seq \" \\$ start\" \" \\$ end\" return 0 fi # Single case number echo \" \\$ arg\" return 0 } # ============================================================ # Parse Command Line Options # ============================================================ CPUS = 4 NGFS = 4000 TSNAP = 0.01 GRIDS_PER_R = 256 ZMIN = \"\" ZMAX = \"\" RMAX = \"\" SKIP_VIDEO_ENCODE = 0 DRY_RUN = 0 VERBOSE = 0 CASE_NUMBERS = () while [[ \\$ # -gt 0 ]]; do case \\$ 1 in --CPUs ) CPUS = \" \\$ 2\" if ! [[ \" \\$ CPUS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ CPUS\" -lt 1 ] ; then echo \"ERROR: --CPUs requires a positive integer, got: \\$ CPUS\" >& 2 exit 1 fi shift 2 ;; --nGFS ) NGFS = \" \\$ 2\" if ! [[ \" \\$ NGFS\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ NGFS\" -lt 1 ] ; then echo \"ERROR: --nGFS requires a positive integer, got: \\$ NGFS\" >& 2 exit 1 fi shift 2 ;; --tsnap ) TSNAP = \" \\$ 2\" shift 2 ;; --GridsPerR ) GRIDS_PER_R = \" \\$ 2\" if ! [[ \" \\$ GRIDS_PER_R\" =~ ^ [ 0 - 9 ] + \\$ ]] || [ \" \\$ GRIDS_PER_R\" -lt 1 ] ; then echo \"ERROR: --GridsPerR requires a positive integer, got: \\$ GRIDS_PER_R\" >& 2 exit 1 fi shift 2 ;; --ZMIN ) ZMIN = \" \\$ 2\" shift 2 ;; --ZMAX ) ZMAX = \" \\$ 2\" shift 2 ;; --RMAX ) RMAX = \" \\$ 2\" shift 2 ;; --skip-video-encode ) SKIP_VIDEO_ENCODE = 1 shift ;; -n | --dry-run ) DRY_RUN = 1 shift ;; -v | --verbose ) VERBOSE = 1 shift ;; -h | --help ) usage exit 0 ;; - * ) echo \"ERROR: Unknown option: \\$ 1\" >& 2 usage exit 1 ;; * ) # Expand ranges and collect case numbers # Capture output and check exit status before appending if ! expanded_cases = \\$ ( expand_case_arg \" \\$ 1\" ); then # expand_case_arg already printed error to stderr exit 1 fi while IFS = read -r case_no ; do CASE_NUMBERS += ( \" \\$ case_no\" ) done <<< \" \\$ expanded_cases\" shift ;; esac done # ============================================================ # Validation # ============================================================ # Check at least one case number provided if [ \\$ {#CASE_NUMBERS[@]} -eq 0 ] ; then echo \"ERROR: No case numbers provided\" >& 2 usage exit 1 fi # Check Python availability if ! command -v python &> /dev/null ; then echo \"ERROR: python not found in PATH\" >& 2 exit 1 fi # Check qcc availability (needed to compile helpers) if ! command -v qcc &> /dev/null ; then echo \"ERROR: qcc not found in PATH\" >& 2 exit 1 fi # Check Python script exists if [ ! -f \" \\$ VIDEO_SCRIPT\" ] ; then echo \"ERROR: Python script not found: \\$ VIDEO_SCRIPT\" >& 2 exit 1 fi # Compile C helpers (always recompile to ensure consistency) echo \"Compiling C helpers...\" pushd \" \\$ {SCRIPT_DIR}/postProcess\" > /dev/null if ! qcc -O2 -Wall -disable-dimensions getFacet.c -o getFacet -lm ; then echo \"ERROR: Failed to compile getFacet.c\" >& 2 popd > /dev/null exit 1 fi if ! qcc -O2 -Wall -disable-dimensions getData-generic.c -o getData-generic -lm ; then echo \"ERROR: Failed to compile getData-generic.c\" >& 2 popd > /dev/null exit 1 fi if ! qcc -O2 -Wall -disable-dimensions getCOM.c -o getCOM -lm ; then echo \"ERROR: Failed to compile getCOM.c\" >& 2 popd > /dev/null exit 1 fi popd > /dev/null echo \"C helpers compiled successfully\" # Validate helpers are executable (sanity check after compilation) for helper in \" \\$ HELPER_GETFACET\" \" \\$ HELPER_GETDATA\" \" \\$ HELPER_GETCOM\" ; do if [ ! -x \" \\$ helper\" ] ; then echo \"ERROR: Compiled helper not executable: \\$ helper\" >& 2 exit 1 fi done # ============================================================ # Display Configuration # ============================================================ echo \"=========================================\" echo \"Bubble Coalescence - Post-Processing Pipeline\" echo \"=========================================\" echo \"Cases to process: \\$ {CASE_NUMBERS[*]}\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"\" echo \"Settings:\" echo \" CPUs: \\$ CPUS\" echo \" nGFS: \\$ NGFS\" echo \" tsnap: \\$ TSNAP\" echo \" GridsPerR: \\$ GRIDS_PER_R\" echo \" Domain bounds: auto-calculated from case.params (Rr, zWall)\" if [ -n \" \\$ ZMIN\" ] ; then echo \" ZMIN: \\$ ZMIN (override)\" ; fi if [ -n \" \\$ ZMAX\" ] ; then echo \" ZMAX: \\$ ZMAX (override)\" ; fi if [ -n \" \\$ RMAX\" ] ; then echo \" RMAX: \\$ RMAX (override)\" ; fi echo \"\" echo \"Pipeline:\" [ \\$ SKIP_VIDEO_ENCODE -eq 0 ] && echo \" [1] Video-generic.py (frames + video)\" || echo \" [1] Video-generic.py (frames only, video SKIPPED)\" echo \"\" [ \\$ DRY_RUN -eq 1 ] && echo \"Mode: DRY RUN (no execution)\" echo \"\" # ============================================================ # Processing Functions # ============================================================ run_video() { local case_no = \" \\$ 1\" local case_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}\" local video_dir = \" \\$ {case_dir}/Video\" # Read Rr and zWall from case.params local case_params = \" \\$ {case_dir}/case.params\" local case_rr = \"1.0\" local case_zwall = \"4.0\" # default from default.params if [ -f \" \\$ case_params\" ] ; then parse_param_file \" \\$ case_params\" case_rr = \\$ ( get_param \"Rr\" \"1.0\" ) case_zwall = \\$ ( get_param \"zWall\" \"4.0\" ) else echo \" WARNING: case.params not found, using defaults (Rr=1.0, zWall=4.0)\" fi # Calculate domain bounds local calc_zmin = \\$ ( echo \"-2 - \\$ case_zwall\" | bc -l ) local calc_zmax = \\$ ( echo \"5 * \\$ case_rr - 2.0\" | bc -l ) local calc_rmax = \\$ ( echo \"2.5 * \\$ case_rr\" | bc -l ) # Apply ZMIN clamp: max(-2-zWall, -3.0) if (( \\$ ( echo \" \\$ calc_zmin < -3.0\" | bc - l ) )); then calc_zmin = \"-3.0\" fi # Use command-line overrides if provided, otherwise use calculated values local use_zmin = \" \\$ {ZMIN:- \\$ calc_zmin}\" local use_zmax = \" \\$ {ZMAX:- \\$ calc_zmax}\" local use_rmax = \" \\$ {RMAX:- \\$ calc_rmax}\" if [ \\$ VERBOSE -eq 1 ] ; then echo \" Extracted: Rr= \\$ case_rr, zWall= \\$ case_zwall\" echo \" Calculated: ZMIN= \\$ use_zmin, ZMAX= \\$ use_zmax, RMAX= \\$ use_rmax\" fi # Build command with calculated/override values local cmd_args = ( \"--caseToProcess\" \" \\$ {case_dir}\" \"--folderToSave\" \" \\$ {video_dir}\" \"--CPUs\" \" \\$ {CPUS}\" \"--nGFS\" \" \\$ {NGFS}\" \"--tsnap\" \" \\$ {TSNAP}\" \"--GridsPerR\" \" \\$ {GRIDS_PER_R}\" \"--Rr\" \" \\$ {case_rr}\" \"--ZMIN\" \" \\$ {use_zmin}\" \"--ZMAX\" \" \\$ {use_zmax}\" \"--RMAX\" \" \\$ {use_rmax}\" ) # Add skip flag if needed [ \\$ SKIP_VIDEO_ENCODE -eq 1 ] && cmd_args += ( \"--skip-video-encode\" ) if [ \\$ VERBOSE -eq 1 ] || [ \\$ DRY_RUN -eq 1 ] ; then echo \" CMD: python \\$ {VIDEO_SCRIPT} \\$ {cmd_args[*]}\" fi if [ \\$ DRY_RUN -eq 0 ] ; then python \" \\$ {VIDEO_SCRIPT}\" \" \\$ {cmd_args[@]}\" fi } # ============================================================ # Main Processing Loop # ============================================================ echo \"=========================================\" echo \"Processing Cases\" echo \"=========================================\" SUCCESSFUL_CASES = () FAILED_CASES = () FAILURE_REASONS = () for case_no in \" \\$ {CASE_NUMBERS[@]}\" ; do echo \"\" echo \"-----------------------------------------\" echo \"Case \\$ case_no\" echo \"-----------------------------------------\" case_dir = \" \\$ {CASES_DIR}/ \\$ {case_no}\" intermediate_dir = \" \\$ {case_dir}/intermediate\" # Validate case directory exists if [ ! -d \" \\$ case_dir\" ] ; then echo \" ERROR: Case directory not found: \\$ case_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Case directory not found\" ) continue fi if [ ! -d \" \\$ intermediate_dir\" ] ; then echo \" ERROR: Intermediate directory not found: \\$ intermediate_dir\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No intermediate/ snapshots\" ) continue fi # Count snapshots snapshot_count = \\$ ( find \" \\$ intermediate_dir\" -name \"snapshot-*\" 2 > /dev/null | wc -l | tr -d ' ' ) echo \" Found \\$ snapshot_count snapshots in intermediate/\" # Display case parameters if case.params exists case_params = \" \\$ {case_dir}/case.params\" if [ -f \" \\$ case_params\" ] && [ \\$ VERBOSE -eq 1 ] ; then parse_param_file \" \\$ case_params\" echo \" Parameters: OhOut= \\$ (get_param \" OhOut \" \" ? \"), Rr= \\$ (get_param \" Rr \" \" ? \"), MAXlevel= \\$ (get_param \" MAXlevel \" \" ? \")\" fi if [ \" \\$ snapshot_count\" -eq 0 ] ; then echo \" ERROR: No snapshots found\" FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"No snapshots in intermediate/\" ) continue fi # Track step failures step_failed = 0 # Run video generation echo \"\" echo \" [1/1] Running Video-generic.py...\" if ! run_video \" \\$ case_no\" ; then echo \" ERROR: Video generation failed\" step_failed = 1 else [ \\$ DRY_RUN -eq 0 ] && echo \" [1/1] Video generation complete\" fi # Record result if [ \\$ step_failed -eq 0 ] ; then SUCCESSFUL_CASES += ( \" \\$ case_no\" ) echo \"\" echo \" Case \\$ case_no: SUCCESS\" else FAILED_CASES += ( \" \\$ case_no\" ) FAILURE_REASONS += ( \"Processing step failed\" ) echo \"\" echo \" Case \\$ case_no: FAILED\" fi done # ============================================================ # Summary # ============================================================ echo \"\" echo \"=========================================\" echo \"Post-Processing Complete\" echo \"=========================================\" echo \"Total cases: \\$ {#CASE_NUMBERS[@]}\" echo \"Successful: \\$ {#SUCCESSFUL_CASES[@]}\" echo \"Failed: \\$ {#FAILED_CASES[@]}\" if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Failed cases:\" for i in \" \\$ {!FAILED_CASES[@]}\" ; do echo \" - Case \\$ {FAILED_CASES[ \\$ i]}: \\$ {FAILURE_REASONS[ \\$ i]}\" done fi if [ \\$ {#SUCCESSFUL_CASES[@]} -gt 0 ] ; then echo \"\" echo \"Output locations:\" for case_no in \" \\$ {SUCCESSFUL_CASES[@]}\" ; do echo \" \\$ {CASES_DIR}/ \\$ {case_no}/\" done fi echo \"\" # Exit with error if any cases failed if [ \\$ {#FAILED_CASES[@]} -gt 0 ] ; then exit 1 fi exit 0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runPostProcess-Ncases.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "runPostProcess-Ncases.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "#!/bin/bash# runPostProcess-Ncases.sh - Run post-processing pipeline on multiple simulation cases# Author: Vatsal Sanjay# vatsal.sanjay@comphy-lab.org# CoMPhy Lab - Durham University# Last updated: Jan 2026set-euopipefail# Exit on error, unset variables, pipeline failures# ============================================================# Configuration# ============================================================SCRIPT_DIR=\"\\$(cd \"\\$(dirname\"\\${BASH_SOURCE[0]}\")\" && pwd)\"# Source parameter parsing libraryif[-f\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"];thensource\"\\${SCRIPT_DIR}/src-local/parse_params.sh\"elseecho\"ERROR: src-local/parse_params.sh not found\">&2exit1fi# Post-processing script pathsVIDEO_SCRIPT=\"\\${SCRIPT_DIR}/postProcess/Video-generic.py\"# C helper executablesHELPER_GETFACET=\"\\${SCRIPT_DIR}/postProcess/getFacet\"HELPER_GETDATA=\"\\${SCRIPT_DIR}/postProcess/getData-generic\"HELPER_GETCOM=\"\\${SCRIPT_DIR}/postProcess/getCOM\"# Case directory rootCASES_DIR=\"\\${SCRIPT_DIR}/simulationCases\"# ============================================================# Usage Information# ============================================================usage(){cat<<EOFUsage:\\$0 [OPTIONS] CASE_NO [CASE_NO ...]Run post-processing pipeline on multiple bubble coalescence simulation cases.For each case, generates video frames with strain-rate/velocity fields,interface facets, and center of mass tracking.Options:--CPUs N            Number of parallel workers (default: 4)--nGFS N            Number of snapshots to process (default: 4000)--tsnap F           Time interval between snapshots (default: 0.01)--GridsPerR N       Radial grid resolution for video (default: 256)--ZMIN F            Override minimum Z (auto: max(-2-zWall, -3.0))--ZMAX F            Override maximum Z (auto: 5*Rr-2.0)--RMAX F            Override maximum R (auto: 2.5*Rr)Note: Rr and zWall are auto-extracted from each case's case.params file.Domain bounds are calculated per-case unless overridden above.--skip-video-encode Skip ffmpeg video encoding after frame generation-n, --dry-run       Show what would run without executing-v, --verbose       Verbose output-h, --help          Show this help messageArguments:CASE_NO             4-digit case numbers (1000-9999) or ranges (e.g., 3000-3010)Examples:# Process multiple cases with default settings\\$0 3000 3001 3002# Process a range of cases\\$0 3000-3010# Mix individual cases and ranges\\$0 3000 3005-3007 3010# Process with 8 CPUs\\$0 --CPUs 8 3000 3001# Process first 100 snapshots only (for testing)\\$0 --nGFS 100 3000# Skip video encoding (only generate frames)\\$0 --skip-video-encode 3000 3001# Dry run to preview commands\\$0 --dry-run 3000Output locations:simulationCases/<CaseNo>/Video/              # PNG framessimulationCases/<CaseNo>/<CaseNo>_COMData.csv # COM time seriessimulationCases/<CaseNo>/<CaseNo>.mp4        # Encoded videoFor more information, see README.mdEOF}# ============================================================# Helper: Expand Case Argument (single number or range)# ============================================================expand_case_arg(){localarg=\"\\$1\"# Check if it's a range (contains hyphen between two 4-digit numbers)if[[\"\\$arg\"=~^([0-9]{4})-([0-9]{4})\\$]];thenlocalstart=\"\\${BASH_REMATCH[1]}\"localend=\"\\${BASH_REMATCH[2]}\"if[\"\\$start\"-gt\"\\$end\"];thenecho\"ERROR: Invalid range\\$arg (start > end)\">&2return1fiseq\"\\$start\"\"\\$end\"return0fi# Single case numberecho\"\\$arg\"return0}# ============================================================# Parse Command Line Options# ============================================================CPUS=4NGFS=4000TSNAP=0.01GRIDS_PER_R=256ZMIN=\"\"ZMAX=\"\"RMAX=\"\"SKIP_VIDEO_ENCODE=0DRY_RUN=0VERBOSE=0CASE_NUMBERS=()while[[\\$#-gt0]];docase\\$1in--CPUs)CPUS=\"\\$2\"if![[\"\\$CPUS\"=~^[0-9]+\\$]]||[\"\\$CPUS\"-lt1];thenecho\"ERROR: --CPUs requires a positive integer, got:\\$CPUS\">&2exit1fishift2;;--nGFS)NGFS=\"\\$2\"if![[\"\\$NGFS\"=~^[0-9]+\\$]]||[\"\\$NGFS\"-lt1];thenecho\"ERROR: --nGFS requires a positive integer, got:\\$NGFS\">&2exit1fishift2;;--tsnap)TSNAP=\"\\$2\"shift2;;--GridsPerR)GRIDS_PER_R=\"\\$2\"if![[\"\\$GRIDS_PER_R\"=~^[0-9]+\\$]]||[\"\\$GRIDS_PER_R\"-lt1];thenecho\"ERROR: --GridsPerR requires a positive integer, got:\\$GRIDS_PER_R\">&2exit1fishift2;;--ZMIN)ZMIN=\"\\$2\"shift2;;--ZMAX)ZMAX=\"\\$2\"shift2;;--RMAX)RMAX=\"\\$2\"shift2;;--skip-video-encode)SKIP_VIDEO_ENCODE=1shift;;-n|--dry-run)DRY_RUN=1shift;;-v|--verbose)VERBOSE=1shift;;-h|--help)usageexit0;;-*)echo\"ERROR: Unknown option:\\$1\">&2usageexit1;;*)# Expand ranges and collect case numbers# Capture output and check exit status before appendingif!expanded_cases=\\$(expand_case_arg\"\\$1\");then# expand_case_arg already printed error to stderrexit1fiwhileIFS=read-rcase_no;doCASE_NUMBERS+=(\"\\$case_no\")done<<<\"\\$expanded_cases\"shift;;esacdone# ============================================================# Validation# ============================================================# Check at least one case number providedif[\\${#CASE_NUMBERS[@]}-eq0];thenecho\"ERROR: No case numbers provided\">&2usageexit1fi# Check Python availabilityif!command-vpython&>/dev/null;thenecho\"ERROR: python not found in PATH\">&2exit1fi# Check qcc availability (needed to compile helpers)if!command-vqcc&>/dev/null;thenecho\"ERROR: qcc not found in PATH\">&2exit1fi# Check Python script existsif[!-f\"\\$VIDEO_SCRIPT\"];thenecho\"ERROR: Python script not found:\\$VIDEO_SCRIPT\">&2exit1fi# Compile C helpers (always recompile to ensure consistency)echo\"Compiling C helpers...\"pushd\"\\${SCRIPT_DIR}/postProcess\">/dev/nullif!qcc-O2-Wall-disable-dimensionsgetFacet.c-ogetFacet-lm;thenecho\"ERROR: Failed to compile getFacet.c\">&2popd>/dev/nullexit1fiif!qcc-O2-Wall-disable-dimensionsgetData-generic.c-ogetData-generic-lm;thenecho\"ERROR: Failed to compile getData-generic.c\">&2popd>/dev/nullexit1fiif!qcc-O2-Wall-disable-dimensionsgetCOM.c-ogetCOM-lm;thenecho\"ERROR: Failed to compile getCOM.c\">&2popd>/dev/nullexit1fipopd>/dev/nullecho\"C helpers compiled successfully\"# Validate helpers are executable (sanity check after compilation)forhelperin\"\\$HELPER_GETFACET\"\"\\$HELPER_GETDATA\"\"\\$HELPER_GETCOM\";doif[!-x\"\\$helper\"];thenecho\"ERROR: Compiled helper not executable:\\$helper\">&2exit1fidone# ============================================================# Display Configuration# ============================================================echo\"=========================================\"echo\"Bubble Coalescence - Post-Processing Pipeline\"echo\"=========================================\"echo\"Cases to process:\\${CASE_NUMBERS[*]}\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"\"echo\"Settings:\"echo\"  CPUs:\\$CPUS\"echo\"  nGFS:\\$NGFS\"echo\"  tsnap:\\$TSNAP\"echo\"  GridsPerR:\\$GRIDS_PER_R\"echo\"  Domain bounds: auto-calculated from case.params (Rr, zWall)\"if[-n\"\\$ZMIN\"];thenecho\"  ZMIN:\\$ZMIN (override)\";fiif[-n\"\\$ZMAX\"];thenecho\"  ZMAX:\\$ZMAX (override)\";fiif[-n\"\\$RMAX\"];thenecho\"  RMAX:\\$RMAX (override)\";fiecho\"\"echo\"Pipeline:\"[\\$SKIP_VIDEO_ENCODE-eq0]&&echo\"  [1] Video-generic.py (frames + video)\"||echo\"  [1] Video-generic.py (frames only, video SKIPPED)\"echo\"\"[\\$DRY_RUN-eq1]&&echo\"Mode: DRY RUN (no execution)\"echo\"\"# ============================================================# Processing Functions# ============================================================run_video(){localcase_no=\"\\$1\"localcase_dir=\"\\${CASES_DIR}/\\${case_no}\"localvideo_dir=\"\\${case_dir}/Video\"# Read Rr and zWall from case.paramslocalcase_params=\"\\${case_dir}/case.params\"localcase_rr=\"1.0\"localcase_zwall=\"4.0\"# default from default.paramsif[-f\"\\$case_params\"];thenparse_param_file\"\\$case_params\"case_rr=\\$(get_param\"Rr\"\"1.0\")case_zwall=\\$(get_param\"zWall\"\"4.0\")elseecho\"  WARNING: case.params not found, using defaults (Rr=1.0, zWall=4.0)\"fi# Calculate domain boundslocalcalc_zmin=\\$(echo\"-2 -\\$case_zwall\"|bc -l)localcalc_zmax=\\$(echo\"5 *\\$case_rr - 2.0\"|bc -l)localcalc_rmax=\\$(echo\"2.5 *\\$case_rr\"|bc -l)# Apply ZMIN clamp: max(-2-zWall, -3.0)if((\\$(echo\"\\$calc_zmin < -3.0\"|bc-l)));thencalc_zmin=\"-3.0\"fi# Use command-line overrides if provided, otherwise use calculated valueslocaluse_zmin=\"\\${ZMIN:-\\$calc_zmin}\"localuse_zmax=\"\\${ZMAX:-\\$calc_zmax}\"localuse_rmax=\"\\${RMAX:-\\$calc_rmax}\"if[\\$VERBOSE-eq1];thenecho\"  Extracted: Rr=\\$case_rr, zWall=\\$case_zwall\"echo\"  Calculated: ZMIN=\\$use_zmin, ZMAX=\\$use_zmax, RMAX=\\$use_rmax\"fi# Build command with calculated/override valueslocalcmd_args=(\"--caseToProcess\"\"\\${case_dir}\"\"--folderToSave\"\"\\${video_dir}\"\"--CPUs\"\"\\${CPUS}\"\"--nGFS\"\"\\${NGFS}\"\"--tsnap\"\"\\${TSNAP}\"\"--GridsPerR\"\"\\${GRIDS_PER_R}\"\"--Rr\"\"\\${case_rr}\"\"--ZMIN\"\"\\${use_zmin}\"\"--ZMAX\"\"\\${use_zmax}\"\"--RMAX\"\"\\${use_rmax}\")# Add skip flag if needed[\\$SKIP_VIDEO_ENCODE-eq1]&&cmd_args+=(\"--skip-video-encode\")if[\\$VERBOSE-eq1]||[\\$DRY_RUN-eq1];thenecho\"  CMD: python\\${VIDEO_SCRIPT}\\${cmd_args[*]}\"fiif[\\$DRY_RUN-eq0];thenpython\"\\${VIDEO_SCRIPT}\"\"\\${cmd_args[@]}\"fi}# ============================================================# Main Processing Loop# ============================================================echo\"=========================================\"echo\"Processing Cases\"echo\"=========================================\"SUCCESSFUL_CASES=()FAILED_CASES=()FAILURE_REASONS=()forcase_noin\"\\${CASE_NUMBERS[@]}\";doecho\"\"echo\"-----------------------------------------\"echo\"Case\\$case_no\"echo\"-----------------------------------------\"case_dir=\"\\${CASES_DIR}/\\${case_no}\"intermediate_dir=\"\\${case_dir}/intermediate\"# Validate case directory existsif[!-d\"\\$case_dir\"];thenecho\"  ERROR: Case directory not found:\\$case_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Case directory not found\")continuefiif[!-d\"\\$intermediate_dir\"];thenecho\"  ERROR: Intermediate directory not found:\\$intermediate_dir\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No intermediate/ snapshots\")continuefi# Count snapshotssnapshot_count=\\$(find\"\\$intermediate_dir\"-name\"snapshot-*\"2>/dev/null|wc-l|tr-d' ')echo\"  Found\\$snapshot_count snapshots in intermediate/\"# Display case parameters if case.params existscase_params=\"\\${case_dir}/case.params\"if[-f\"\\$case_params\"]&&[\\$VERBOSE-eq1];thenparse_param_file\"\\$case_params\"echo\"  Parameters: OhOut=\\$(get_param \"OhOut\" \"?\"), Rr=\\$(get_param \"Rr\" \"?\"), MAXlevel=\\$(get_param \"MAXlevel\" \"?\")\"fiif[\"\\$snapshot_count\"-eq0];thenecho\"  ERROR: No snapshots found\"FAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"No snapshots in intermediate/\")continuefi# Track step failuresstep_failed=0# Run video generationecho\"\"echo\"  [1/1] Running Video-generic.py...\"if!run_video\"\\$case_no\";thenecho\"  ERROR: Video generation failed\"step_failed=1else[\\$DRY_RUN-eq0]&&echo\"  [1/1] Video generation complete\"fi# Record resultif[\\$step_failed-eq0];thenSUCCESSFUL_CASES+=(\"\\$case_no\")echo\"\"echo\"  Case\\$case_no: SUCCESS\"elseFAILED_CASES+=(\"\\$case_no\")FAILURE_REASONS+=(\"Processing step failed\")echo\"\"echo\"  Case\\$case_no: FAILED\"fidone# ============================================================# Summary# ============================================================echo\"\"echo\"=========================================\"echo\"Post-Processing Complete\"echo\"=========================================\"echo\"Total cases:\\${#CASE_NUMBERS[@]}\"echo\"Successful:\\${#SUCCESSFUL_CASES[@]}\"echo\"Failed:\\${#FAILED_CASES[@]}\"if[\\${#FAILED_CASES[@]}-gt0];thenecho\"\"echo\"Failed cases:\"foriin\"\\${!FAILED_CASES[@]}\";doecho\"  - Case\\${FAILED_CASES[\\$i]}:\\${FAILURE_REASONS[\\$i]}\"donefiif[\\${#SUCCESSFUL_CASES[@]}-gt0];thenecho\"\"echo\"Output locations:\"forcase_noin\"\\${SUCCESSFUL_CASES[@]}\";doecho\"\\${CASES_DIR}/\\${case_no}/\"donefiecho\"\"# Exit with error if any cases failedif[\\${#FAILED_CASES[@]}-gt0];thenexit1fiexit0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/runPostProcess-Ncases.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Context",
    "content": "postProcess/Video-generic.py See raw file Video Post-Processing for Bubble Coalescence Render interface geometry, strain-rate invariant, and velocity magnitude from Basilisk snapshots of asymmetric bubble coalescence. These visualizations support analysis of capillary-wave focusing, jetting, and droplet pinch-off by tracking interface evolution alongside a dissipation proxy and flow speed.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Workflow postProcess/getFacet :...",
    "content": "Workflow postProcess/getFacet : extract PLIC interface segments postProcess/getData-generic : sample \\(\\log_{10}(D^2)\\) and \\(|u|\\) on a grid postProcess/getCOM : compute axial center-of-mass position and velocity Usage python3 postProcess/Video-generic.py --caseToProcess simulationCases/3000 --Rr 1.0 Outputs simulationCases/<case>/Video/*.png : rendered frames simulationCases/<case>/<case>_COMData.csv : COM time series simulationCases/<case>/<case>.mp4 : encoded movie (if enabled) Author Vatsal Sanjay vatsal.sanjay@comphy-lab.org CoMPhy Lab, Durham University Last updated: Jan 2026 import argparse import csv import multiprocessing as mp import os import subprocess as sp from dataclasses import dataclass from functools import partial from datetime import datetime from typing import Sequence, Tuple, Optional import matplotlib import matplotlib.pyplot as plt import numpy as np from matplotlib.collections import LineCollection from matplotlib.ticker import StrMethodFormatter # Use mathtext (parallel-safe, no external LaTeX subprocess) matplotlib.rcParams[ \"font.family\" ] = \"serif\" matplotlib.rcParams[ \"mathtext.fontset\" ] = \"cm\" # Computer Modern style @dataclass (frozen = True ) class DomainBounds: Symmetry-aware domain description in cylindrical coordinates.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: The code expects...",
    "content": "The code expects r in [rmin, rmax] with rmin <= 0 to leverage the axis of symmetry; z spans freely between zmin and zmax. Packaging these values avoids argument soup when plotting or generating overlays. rmin: float rmax: float zmin: float zmax: float @dataclass (frozen = True ) class RuntimeConfig: Run-time knobs collected from CLI arguments. Multiprocessing workers only need a single instance of this struct, making later CLI additions painless.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: The accessors keep...",
    "content": "The accessors keep mirror operations (e.g., computing rmin) in one place. cpus: int n_snapshots: int grids_per_r: int tsnap: float zmin: float zmax: float rmax: float rr: float # Radius ratio for coalescence case_dir: str output_dir: str skip_video_encode: bool framerate: int output_fps: int @property def rmin( self ) -> float : return - self .rmax @property def bounds( self ) -> DomainBounds: return DomainBounds( self .rmin, self .rmax, self .zmin, self .zmax) @dataclass (frozen = True ) class PlotStyle: Single source of truth for plot-level choices.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Matplotlib tweaks become...",
    "content": "Matplotlib tweaks become traceable: alter colours, fonts, or geometry here and every rendered frame will stay consistent without touching plotting logic. figure_size: Tuple[ float , float ] = ( 19.20 , 10.80 ) tick_label_size: int = 20 zero_axis_color: str = \"grey\" axis_color: str = \"black\" line_width: float = 2.0 interface_color: str = \"#00B2FF\" com_color: str = \"red\" com_marker_size: float = 15.0 colorbar_width: float = 0.03 left_colorbar_offset: float = 0.04 right_colorbar_offset: float = 0.01 @dataclass (frozen = True ) class SnapshotInfo: Metadata for an input snapshot and its output image. Storing paths and the physical time together simplifies filename logic and ensures logging statements stay informative. index: int time: float source: str target: str @dataclass class FieldData: Structured holder around the grids returned by getData-generic. Attributes provide convenient min/max queries so the plotting routine does not need to recalculate extents or worry about array shapes.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Python Function",
    "content": "R: np.ndarray Z: np.ndarray strain_rate: np.ndarray velocity: np.ndarray nz: int @property def radial_extent( self ) -> Tuple[ float , float ]: return self .R. min (), self .R. max () @property def axial_extent( self ) -> Tuple[ float , float ]: return self .Z. min (), self .Z. max () @dataclass (frozen = True ) class COMData: Center of mass position and velocity at a given time. time: float z_com: float u_com: float PLOT_STYLE = PlotStyle() def log_status(message: str , * , level: str = \"INFO\" ) -> None : Print timestamped status messages for long-running CLI workflows. timestamp = datetime.now().strftime( \"%H:%M:%S\" ) print ( f\"[ { timestamp } ] [ { level } ] { message } \" , flush = True ) def parse_arguments() -> RuntimeConfig: Parse command-line arguments and construct runtime configuration. The returned dataclass is immutable and can be safely shared across multiprocessing workers without coordination overhead. This design makes future CLI additions trivial.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Returns: RuntimeConfig: Configuration...",
    "content": "Returns: RuntimeConfig: Configuration object containing: - cpus: Number of parallel workers (default: 4) - n_snapshots: Total frames to process (default: 4000) - grids_per_r: Radial mesh resolution (default: 64) - tsnap: Time interval between snapshots (default: 0.01) - Domain bounds (zmin, zmax, rmax) - auto-calculated from Rr - I/O paths (case_dir, output_dir) - rr: Radius ratio for domain calculation Examples: >>> config = parse_arguments() >>> config.cpus 4 >>> config.bounds DomainBounds(rmin=-2.5, rmax=2.5, zmin=-2.0, zmax=3.0) parser = argparse.ArgumentParser(description = \"Generate snapshot videos for coalescence.\" ) parser.add_argument( \"--CPUs\" , type = int , default = 4 , help = \"Number of CPUs to use\" ) parser.add_argument( \"--nGFS\" , type = int , default = 4000 , help = \"Number of restart files to process\" ) parser.add_argument( \"--GridsPerR\" , type = int , default = 256 , help = \"Number of grids per R\" ) parser.add_argument( \"--Rr\" , type = float , default = 1.0 , help = \"Radius ratio (affects domain bounds)\" ) parser.add_argument( \"--ZMIN\" , type = float , default = None , help = \"Minimum Z value (default: -2.0)\" ) parser.add_argument( \"--ZMAX\" , type = float , default = None , help = \"Maximum Z value (default: 5*Rr-2.0)\" ) parser.add_argument( \"--RMAX\" , type = float , default = None , help = \"Maximum R value (default: 2.5*Rr)\" ) parser.add_argument( \"--tsnap\" , type = float , default = 0.01 , help = \"Time snap\" ) parser.add_argument( \"--caseToProcess\" , type = str , default = \"simulationCases/3000\" , help = \"Case to process\" , ) parser.add_argument( \"--folderToSave\" , type = str , default = None , help = \"Folder to save (default: <case>/Video)\" ) parser.add_argument( \"--skip-video-encode\" , action = \"store_true\" , help = \"Skip ffmpeg video encoding after frame generation\" ) parser.add_argument( \"--framerate\" , type = int , default = 90 , help = \"Input framerate for ffmpeg (default: 90)\" ) parser.add_argument( \"--output-fps\" , type = int , default = 30 , help = \"Output video framerate (default: 30)\" ) args = parser.parse_args() # Calculate domain bounds based on Rr if not explicitly provided rr = args.Rr zmin = args.ZMIN if args.ZMIN is not None else - 2.0 zmax = args.ZMAX if args.ZMAX is not None else 5.0 * rr - 2.0 rmax = args.RMAX if args.RMAX is not None else 2.5 * rr # Default output directory output_dir = args.folderToSave if args.folderToSave else os.path.join(args.caseToProcess, \"Video\" ) return RuntimeConfig( cpus = args.CPUs, n_snapshots = args.nGFS, grids_per_r = args.GridsPerR, tsnap = args.tsnap, zmin = zmin, zmax = zmax, rmax = rmax, rr = rr, case_dir = args.caseToProcess, output_dir = output_dir, skip_video_encode = args.skip_video_encode, framerate = args.framerate, output_fps = args.output_fps, ) def ensure_directory(path: str ) -> None : Create an output directory if it does not exist.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Python Function",
    "content": "Parameters: path: Directory to create (including parents). if not os.path.isdir(path): os.makedirs(path, exist_ok = True ) def run_helper(command: Sequence[ str ]) -> Sequence[ str ]: Run a helper executable and return its stderr as decoded lines. The compiled helpers deliberately emit their payload to stderr, so stdout is ignored (it is typically empty) and we bubble up informative stderr content. Parameters: command: Command list passed to subprocess. Returns: list[str]: Decoded stderr lines produced by the helper. process = sp.Popen(command, stdout = sp.PIPE, stderr = sp.PIPE) _, stderr = process.communicate() if process.returncode != 0 : raise RuntimeError ( f\"Command { ' ' . join(command) } failed with code { process . returncode } : \\n \" f\" { stderr . decode( 'utf-8' ) } \" ) return stderr.decode( \"utf-8\" ).split( \" \\n \" ) def get_facets(filename: str ): Collect interface facets from getFacet helper with axisymmetric mirroring.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Shells out to...",
    "content": "Shells out to the compiled getFacet executable, which extracts the volume-of-fluid (VOF) interface as a sequence of line segments. Since the Basilisk simulation uses axisymmetric coordinates, only the r >= 0 half is computed. This function mirrors each segment about r=0 to create the full visualization. Args: filename: Path to Basilisk snapshot file (e.g., \u2018snapshot-0.0100\u2019) Returns: list[tuple]: Sequence of line segments, each as ((r1, z1), (r2, z2)). Each physical segment appears twice: once at +r and once at -r for the mirrored visualization. Empty list if fewer than 100 output lines (likely indicates no interface present). Note: The getFacet helper outputs space-separated (z, r) pairs.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Function Definition",
    "content": "This function swaps to (r, z) convention for matplotlib plotting. temp2 = run_helper([ \"postProcess/getFacet\" , filename]) segs = [] skip = False if len (temp2) > 1e2 : for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: skip = False continue if not skip and n1 + 1 < len (temp2): temp4 = temp2[n1 + 1 ].split( \" \" ) r1, z1 = np.array([ float (temp3[ 1 ]), float (temp3[ 0 ])]) r2, z2 = np.array([ float (temp4[ 1 ]), float (temp4[ 0 ])]) segs.append(((r1, z1), (r2, z2))) segs.append((( - r1, z1), ( - r2, z2))) skip = True return segs def get_com(filename: str ) -> Optional[COMData]: Extract center of mass data from getCOM helper. Shells out to the compiled getCOM executable, which computes the volume-weighted center of mass position and velocity.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Args: filename: Path...",
    "content": "Args: filename: Path to Basilisk snapshot file (e.g., \u2018snapshot-0.0100\u2019) Returns: COMData: Contains time, z_com (position), u_com (velocity) None: If extraction fails try : temp2 = run_helper([ \"postProcess/getCOM\" , filename]) if len (temp2) > 0 and temp2[ 0 ]: parts = temp2[ 0 ].split() if len (parts) >= 3 : return COMData( time = float (parts[ 0 ]), z_com = float (parts[ 1 ]), u_com = float (parts[ 2 ]) ) except Exception as e: log_status( f\"getCOM failed for { filename } : { e } \" , level = \"WARN\" ) return None def get_field(filename: str , zmin: float , zmax: float , rmax: float , nr: int ) -> FieldData: Read field arrays for a single snapshot from getData-generic helper. Shells out to the compiled getData-generic executable, which samples the velocity and strain-rate fields on a structured grid. Returns a FieldData struct with reshaped 2D arrays, abstracting away the flattening scheme used by the helper.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Args: filename: Path...",
    "content": "Args: filename: Path to Basilisk snapshot file (e.g., \u2018snapshot-0.0100\u2019) zmin: Minimum axial coordinate for sampling domain zmax: Maximum axial coordinate for sampling domain rmax: Maximum radial coordinate (positive branch only) nr: Number of grid points in radial direction Returns: FieldData: Structured container with reshaped 2D arrays: - R, Z: Meshgrid coordinates (nz x nr) - strain_rate: Second invariant of rate-of-strain tensor - velocity: Velocity magnitude field - nz: Number of grid points in axial direction (computed) temp2 = run_helper( [ \"postProcess/getData-generic\" , filename, str (zmin), str ( 0 ), str (zmax), str (rmax), str (nr), ] ) Rtemp, Ztemp, D2temp, veltemp = [], [], [], [] for n1 in range ( len (temp2)): temp3 = temp2[n1].split( \" \" ) if temp3 == [ \"\" ]: continue Ztemp.append( float (temp3[ 0 ])) Rtemp.append( float (temp3[ 1 ])) D2temp.append( float (temp3[ 2 ])) veltemp.append( float (temp3[ 3 ])) R = np.asarray(Rtemp) Z = np.asarray(Ztemp) D2 = np.asarray(D2temp) vel = np.asarray(veltemp) nz = int ( len (Z) / nr) log_status( f\" { os . path . basename(filename) } : nz = { nz } \" ) R.resize((nz, nr)) Z.resize((nz, nr)) D2.resize((nz, nr)) vel.resize((nz, nr)) return FieldData(R = R, Z = Z, strain_rate = D2, velocity = vel, nz = nz) def build_snapshot_info(index: int , config: RuntimeConfig) -> SnapshotInfo: Construct file paths for a given timestep index.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Parameters: index: Integer...",
    "content": "Parameters: index: Integer index used with tsnap to recover time. config: RuntimeConfig providing directories and stride. Returns: SnapshotInfo: Pre-computed metadata for the worker. time = config.tsnap * index # Note: coalescence uses intermediate/ directly (no results/ subdir) source = os.path.join(config.case_dir, \"intermediate\" , f\"snapshot- { time :.4f} \" ) target = os.path.join(config.output_dir, f\" { int (time * 1000 ) :08d} .png\" ) return SnapshotInfo(index = index, time = time, source = source, target = target) def draw_domain_outline(ax, bounds: DomainBounds, style: PlotStyle) -> None : Outline computational domain and symmetry line.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Parameters: ax: Matplotlib...",
    "content": "Parameters: ax: Matplotlib axis used for plotting. bounds: Domain extents in both directions. style: Colour/width styling information. ax.plot( [ 0 , 0 ], [bounds.zmin, bounds.zmax], \"-.\" , color = style.zero_axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmin], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmin, bounds.zmin], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmin, bounds.rmax], [bounds.zmax, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) ax.plot( [bounds.rmax, bounds.rmax], [bounds.zmin, bounds.zmax], \"-\" , color = style.axis_color, linewidth = style.line_width, ) def add_colorbar(fig, ax, mappable, * , align: str , label: str , style: PlotStyle): Attach a vertical colorbar on the requested side of the axis.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Using manual axes...",
    "content": "Using manual axes lets us keep the main axis square while still showing two distinct colour scales. Parameters: fig: Figure hosting the axes. ax: Primary axes sharing its bounding box. mappable: The image/artist the colorbar describes. align: \u2018left\u2019 or \u2018right\u2019 relative to the plotting axis. label: Axis label to display. style: PlotStyle values for spacing and typography.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Context",
    "content": "Returns: matplotlib.colorbar.Colorbar: The constructed colorbar. l, b, w, h = ax.get_position().bounds if align == \"left\" : position = [l - style.left_colorbar_offset, b, style.colorbar_width, h] else : position = [l + w + style.right_colorbar_offset, b, style.colorbar_width, h] cb_ax = fig.add_axes(position) colorbar = plt.colorbar(mappable, cax = cb_ax, orientation = \"vertical\" ) colorbar.set_label(label, fontsize = style.tick_label_size, labelpad = 5 ) colorbar.ax.tick_params(labelsize = style.tick_label_size) colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter( \"{x:,.2f}\" )) if align == \"left\" : colorbar.ax.yaxis.set_ticks_position( \"left\" ) colorbar.ax.yaxis.set_label_position( \"left\" ) return colorbar def plot_snapshot( field_data: FieldData, facets, com_data: Optional[COMData], bounds: DomainBounds, snapshot: SnapshotInfo, style: PlotStyle, ) -> None : Render and persist a single snapshot figure.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: All artist construction...",
    "content": "All artist construction lives here so multiprocessing workers only need to fetch data and call this function.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Parameters: field_data: Structured...",
    "content": "Parameters: field_data: Structured arrays for strain-rate and velocity. facets: Line segments representing the interface. com_data: Center of mass position and velocity (optional). bounds: Domain extents that keep axes square. snapshot: Metadata describing time and output file. style: Plotting choices centralised in PlotStyle. fig, ax = plt.subplots() fig.set_size_inches( * style.figure_size) draw_domain_outline(ax, bounds, style) line_segments = LineCollection( facets, linewidths = 4 , colors = style.interface_color, linestyle = \"solid\" ) ax.add_collection(line_segments) rminp, rmaxp = field_data.radial_extent zminp, zmaxp = field_data.axial_extent cntrl1 = ax.imshow( field_data.strain_rate, cmap = \"hot_r\" , interpolation = \"Bilinear\" , origin = \"lower\" , extent = [ - rminp, - rmaxp, zminp, zmaxp], vmax = 2.0 , vmin =- 2.0 , ) cntrl2 = ax.imshow( field_data.velocity, interpolation = \"Bilinear\" , cmap = \"Purples\" , origin = \"lower\" , extent = [rminp, rmaxp, zminp, zmaxp], vmax = 1.0 , vmin = 0.0 , ) # Add COM marker if available if com_data is not None : ax.plot( 0 , com_data.z_com, 'o' , color = style.com_color, markersize = style.com_marker_size, zorder = 10 ) ax.set_aspect( \"equal\" ) ax.set_xlim(bounds.rmin, bounds.rmax) ax.set_ylim(bounds.zmin, bounds.zmax) ax.set_title( f\"$t/ \\\\ tau_0$ = { snapshot . time :4.3f} \" , fontsize = style.tick_label_size) ax.axis( \"off\" ) add_colorbar( fig, ax, cntrl1, align = \"left\" , label = r\"$\\log_ {10} \\left(\\boldsymbol{\\mathcal {D} :\\mathcal {D} }\\right)$\" , style = style, ) add_colorbar( fig, ax, cntrl2, align = \"right\" , label = r\"$\\|\\boldsymbol {u} \\|$\" , style = style, ) plt.savefig(snapshot.target, bbox_inches = \"tight\" ) plt.close(fig) def process_timestep(index: int , config: RuntimeConfig, style: PlotStyle) -> Optional[COMData]: Worker executed for every timestep index.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Performs availability checks,...",
    "content": "Performs availability checks, loads helper outputs, and calls plot_snapshot. Parameters: index: Integer timestep index relative to tsnap. config: Runtime configuration shared across workers. style: Plotting style shared by all frames.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Returns: COMData if...",
    "content": "Returns: COMData if successfully extracted, None otherwise. snapshot = build_snapshot_info(index, config) if not os.path.exists(snapshot.source): log_status( f\"Missing: { os . path . basename(snapshot.source) } \" , level = \"WARN\" ) return None if os.path.exists(snapshot.target): log_status( f\"Exists, skipping: { os . path . basename(snapshot.target) } \" ) # Still extract COM data for existing frames return get_com(snapshot.source) # Show relative path: CaseNo/intermediate/filename src_parts = snapshot.source.split(os.sep) src_rel = os.sep.join(src_parts[ - 3 :]) if len (src_parts) >= 3 else snapshot.source log_status( f\"Processing { src_rel } \" ) try : facets = get_facets(snapshot.source) com_data = get_com(snapshot.source) nr = int (config.grids_per_r * config.rmax) field_data = get_field( snapshot.source, config.zmin, config.zmax, config.rmax, nr ) plot_snapshot(field_data, facets, com_data, config.bounds, snapshot, style) # Show relative path: CaseNo/Video/filename tgt_parts = snapshot.target.split(os.sep) tgt_rel = os.sep.join(tgt_parts[ - 3 :]) if len (tgt_parts) >= 3 else snapshot.target log_status( f\"Saved: { tgt_rel } \" ) return com_data except Exception as err: log_status( f\"Error at { src_rel } (t= { snapshot . time :.4f} ): { err } \" , level = \"ERROR\" ) raise def write_com_data(com_data_list: list , config: RuntimeConfig) -> None : Write collected COM data to CSV file.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Parameters: com_data_list: List...",
    "content": "Parameters: com_data_list: List of COMData objects (may contain None entries). config: Runtime configuration for path information. # Extract case number from path case_no = os.path.basename(config.case_dir) output_path = os.path.join(config.case_dir, f\" { case_no } _COMData.csv\" ) # Filter out None entries and sort by time valid_data = [d for d in com_data_list if d is not None ] valid_data.sort(key = lambda x: x.time) with open (output_path, 'w' , newline = '' ) as f: writer = csv.writer(f) writer.writerow([ 'time' , 'zCOM' , 'uCOM' ]) for data in valid_data: writer.writerow([ f\" { data . time :.4f} \" , f\" { data . z_com :.6g} \" , f\" { data . u_com :.6g} \" ]) log_status( f\"COM data saved: { output_path } ( { len (valid_data) } entries)\" ) def encode_video(config: RuntimeConfig) -> None : Run ffmpeg to stitch PNG frames into an MP4 video. The output video is saved in the case directory with the case number as filename (e.g., simulationCases/3000/3000.mp4).",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Parameters: config: Runtime...",
    "content": "Parameters: config: Runtime configuration containing paths and encoding settings.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence: Raises: RuntimeError: If...",
    "content": "Raises: RuntimeError: If ffmpeg fails to encode the video. # Extract case number from path case_no = os.path.basename(config.case_dir) # Output path: <case_dir>/3000.mp4 output_path = os.path.join(config.case_dir, f\" { case_no } .mp4\" ) input_pattern = os.path.join(config.output_dir, \"*.png\" ) cmd = [ \"ffmpeg\" , \"-y\" , \"-framerate\" , str (config.framerate), \"-pattern_type\" , \"glob\" , \"-i\" , input_pattern, \"-vf\" , \"pad=ceil(iw/2)*2:ceil(ih/2)*2\" , \"-c:v\" , \"libx264\" , \"-r\" , str (config.output_fps), \"-pix_fmt\" , \"yuv420p\" , output_path ] log_status( f\"Encoding video: { output_path } \" ) result = sp.run(cmd, capture_output = True , text = True ) if result.returncode != 0 : log_status( f\"ffmpeg error: { result . stderr } \" , level = \"ERROR\" ) raise RuntimeError ( f\"ffmpeg failed with code { result . returncode } \" ) log_status( f\"Video saved: { output_path } \" ) def main(): Entry point used by the documentation tooling and CLI. config = parse_arguments() ensure_directory(config.output_dir) log_status( f\"Processing case: { config . case_dir } \" ) log_status( f\"Domain: R=[ { config . rmin :.2f} , { config . rmax :.2f} ], Z=[ { config . zmin :.2f} , { config . zmax :.2f} ]\" ) log_status( f\"Radius ratio (Rr): { config . rr } \" ) with mp.Pool(processes = config.cpus) as pool: worker = partial(process_timestep, config = config, style = PLOT_STYLE) com_data_list = pool. map (worker, range (config.n_snapshots)) # Write COM data to CSV write_com_data(com_data_list, config) # Encode video unless skipped if not config.skip_video_encode: encode_video(config) if __name__ == \"__main__\" : main()",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "python3postProcess/Video-generic.py--caseToProcesssimulationCases/3000--Rr1.0",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "importargparseimportcsvimportmultiprocessingasmpimportosimportsubprocessasspfromdataclassesimportdataclassfromfunctoolsimportpartialfromdatetimeimportdatetimefromtypingimportSequence, Tuple, Optionalimportmatplotlibimportmatplotlib.pyplotaspltimportnumpyasnpfrommatplotlib.collectionsimportLineCollectionfrommatplotlib.tickerimportStrMethodFormatter# Use mathtext (parallel-safe, no external LaTeX subprocess)matplotlib.rcParams[\"font.family\"]=\"serif\"matplotlib.rcParams[\"mathtext.fontset\"]=\"cm\"# Computer Modern style@dataclass(frozen=True)classDomainBounds:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "rmin:floatrmax:floatzmin:floatzmax:float@dataclass(frozen=True)classRuntimeConfig:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "cpus:intn_snapshots:intgrids_per_r:inttsnap:floatzmin:floatzmax:floatrmax:floatrr:float# Radius ratio for coalescencecase_dir:stroutput_dir:strskip_video_encode:boolframerate:intoutput_fps:int@propertydefrmin(self)->float:return-self.rmax@propertydefbounds(self)->DomainBounds:returnDomainBounds(self.rmin,self.rmax,self.zmin,self.zmax)@dataclass(frozen=True)classPlotStyle:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "figure_size: Tuple[float,float]=(19.20,10.80)tick_label_size:int=20zero_axis_color:str=\"grey\"axis_color:str=\"black\"line_width:float=2.0interface_color:str=\"#00B2FF\"com_color:str=\"red\"com_marker_size:float=15.0colorbar_width:float=0.03left_colorbar_offset:float=0.04right_colorbar_offset:float=0.01@dataclass(frozen=True)classSnapshotInfo:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "index:inttime:floatsource:strtarget:str@dataclassclassFieldData:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "R: np.ndarrayZ: np.ndarraystrain_rate: np.ndarrayvelocity: np.ndarraynz:int@propertydefradial_extent(self)->Tuple[float,float]:returnself.R.min(),self.R.max()@propertydefaxial_extent(self)->Tuple[float,float]:returnself.Z.min(),self.Z.max()@dataclass(frozen=True)classCOMData:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "time:floatz_com:floatu_com:floatPLOT_STYLE=PlotStyle()deflog_status(message:str,*, level:str=\"INFO\")->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "timestamp=datetime.now().strftime(\"%H:%M:%S\")print(f\"[{timestamp}] [{level}]{message}\", flush=True)defparse_arguments()->RuntimeConfig:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "parser=argparse.ArgumentParser(description=\"Generate snapshot videos for coalescence.\")parser.add_argument(\"--CPUs\",type=int, default=4,help=\"Number of CPUs to use\")parser.add_argument(\"--nGFS\",type=int, default=4000,help=\"Number of restart files to process\")parser.add_argument(\"--GridsPerR\",type=int, default=256,help=\"Number of grids per R\")parser.add_argument(\"--Rr\",type=float, default=1.0,help=\"Radius ratio (affects domain bounds)\")parser.add_argument(\"--ZMIN\",type=float, default=None,help=\"Minimum Z value (default: -2.0)\")parser.add_argument(\"--ZMAX\",type=float, default=None,help=\"Maximum Z value (default: 5*Rr-2.0)\")parser.add_argument(\"--RMAX\",type=float, default=None,help=\"Maximum R value (default: 2.5*Rr)\")parser.add_argument(\"--tsnap\",type=float, default=0.01,help=\"Time snap\")parser.add_argument(\"--caseToProcess\",type=str,default=\"simulationCases/3000\",help=\"Case to process\",)parser.add_argument(\"--folderToSave\",type=str, default=None,help=\"Folder to save (default: <case>/Video)\")parser.add_argument(\"--skip-video-encode\", action=\"store_true\",help=\"Skip ffmpeg video encoding after frame generation\")parser.add_argument(\"--framerate\",type=int, default=90,help=\"Input framerate for ffmpeg (default: 90)\")parser.add_argument(\"--output-fps\",type=int, default=30,help=\"Output video framerate (default: 30)\")args=parser.parse_args()# Calculate domain bounds based on Rr if not explicitly providedrr=args.Rrzmin=args.ZMINifargs.ZMINisnotNoneelse-2.0zmax=args.ZMAXifargs.ZMAXisnotNoneelse5.0*rr-2.0rmax=args.RMAXifargs.RMAXisnotNoneelse2.5*rr# Default output directoryoutput_dir=args.folderToSaveifargs.folderToSaveelseos.path.join(args.caseToProcess,\"Video\")returnRuntimeConfig(cpus=args.CPUs,n_snapshots=args.nGFS,grids_per_r=args.GridsPerR,tsnap=args.tsnap,zmin=zmin,zmax=zmax,rmax=rmax,rr=rr,case_dir=args.caseToProcess,output_dir=output_dir,skip_video_encode=args.skip_video_encode,framerate=args.framerate,output_fps=args.output_fps,)defensure_directory(path:str)->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "ifnotos.path.isdir(path):os.makedirs(path, exist_ok=True)defrun_helper(command: Sequence[str])->Sequence[str]:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "process=sp.Popen(command, stdout=sp.PIPE, stderr=sp.PIPE)_, stderr=process.communicate()ifprocess.returncode!=0:raiseRuntimeError(f\"Command{' '.join(command)}failed with code{process.returncode}:\\n\"f\"{stderr.decode('utf-8')}\")returnstderr.decode(\"utf-8\").split(\"\\n\")defget_facets(filename:str):",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "temp2=run_helper([\"postProcess/getFacet\", filename])segs=[]skip=Falseiflen(temp2)>1e2:forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:skip=Falsecontinueifnotskipandn1+1<len(temp2):temp4=temp2[n1+1].split(\" \")r1, z1=np.array([float(temp3[1]),float(temp3[0])])r2, z2=np.array([float(temp4[1]),float(temp4[0])])segs.append(((r1, z1), (r2, z2)))segs.append(((-r1, z1), (-r2, z2)))skip=Truereturnsegsdefget_com(filename:str)->Optional[COMData]:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "try:temp2=run_helper([\"postProcess/getCOM\", filename])iflen(temp2)>0andtemp2[0]:parts=temp2[0].split()iflen(parts)>=3:returnCOMData(time=float(parts[0]),z_com=float(parts[1]),u_com=float(parts[2]))exceptExceptionase:log_status(f\"getCOM failed for{filename}:{e}\", level=\"WARN\")returnNonedefget_field(filename:str, zmin:float, zmax:float, rmax:float, nr:int)->FieldData:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "temp2=run_helper([\"postProcess/getData-generic\",filename,str(zmin),str(0),str(zmax),str(rmax),str(nr),])Rtemp, Ztemp, D2temp, veltemp=[], [], [], []forn1inrange(len(temp2)):temp3=temp2[n1].split(\" \")iftemp3==[\"\"]:continueZtemp.append(float(temp3[0]))Rtemp.append(float(temp3[1]))D2temp.append(float(temp3[2]))veltemp.append(float(temp3[3]))R=np.asarray(Rtemp)Z=np.asarray(Ztemp)D2=np.asarray(D2temp)vel=np.asarray(veltemp)nz=int(len(Z)/nr)log_status(f\"{os.path.basename(filename)}: nz ={nz}\")R.resize((nz, nr))Z.resize((nz, nr))D2.resize((nz, nr))vel.resize((nz, nr))returnFieldData(R=R, Z=Z, strain_rate=D2, velocity=vel, nz=nz)defbuild_snapshot_info(index:int, config: RuntimeConfig)->SnapshotInfo:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example",
    "content": "time=config.tsnap*index# Note: coalescence uses intermediate/ directly (no results/ subdir)source=os.path.join(config.case_dir,\"intermediate\",f\"snapshot-{time:.4f}\")target=os.path.join(config.output_dir,f\"{int(time*1000):08d}.png\")returnSnapshotInfo(index=index, time=time, source=source, target=target)defdraw_domain_outline(ax, bounds: DomainBounds, style: PlotStyle)->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "ax.plot([0,0],[bounds.zmin, bounds.zmax],\"-.\",color=style.zero_axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmin],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmin, bounds.zmin],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmin, bounds.rmax],[bounds.zmax, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)ax.plot([bounds.rmax, bounds.rmax],[bounds.zmin, bounds.zmax],\"-\",color=style.axis_color,linewidth=style.line_width,)defadd_colorbar(fig, ax, mappable,*, align:str, label:str, style: PlotStyle):",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: l, b, w,...",
    "content": "l, b, w, h=ax.get_position().boundsifalign==\"left\":position=[l-style.left_colorbar_offset, b, style.colorbar_width, h]else:position=[l+w+style.right_colorbar_offset, b, style.colorbar_width, h]cb_ax=fig.add_axes(position)colorbar=plt.colorbar(mappable, cax=cb_ax, orientation=\"vertical\")colorbar.set_label(label, fontsize=style.tick_label_size, labelpad=5)colorbar.ax.tick_params(labelsize=style.tick_label_size)colorbar.ax.yaxis.set_major_formatter(StrMethodFormatter(\"{x:,.2f}\"))ifalign==\"left\":colorbar.ax.yaxis.set_ticks_position(\"left\")colorbar.ax.yaxis.set_label_position(\"left\")returncolorbardefplot_snapshot(field_data: FieldData,facets,com_data: Optional[COMData],bounds: DomainBounds,snapshot: SnapshotInfo,style: PlotStyle,)->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "fig, ax=plt.subplots()fig.set_size_inches(*style.figure_size)draw_domain_outline(ax, bounds, style)line_segments=LineCollection(facets, linewidths=4, colors=style.interface_color, linestyle=\"solid\")ax.add_collection(line_segments)rminp, rmaxp=field_data.radial_extentzminp, zmaxp=field_data.axial_extentcntrl1=ax.imshow(field_data.strain_rate,cmap=\"hot_r\",interpolation=\"Bilinear\",origin=\"lower\",extent=[-rminp,-rmaxp, zminp, zmaxp],vmax=2.0,vmin=-2.0,)cntrl2=ax.imshow(field_data.velocity,interpolation=\"Bilinear\",cmap=\"Purples\",origin=\"lower\",extent=[rminp, rmaxp, zminp, zmaxp],vmax=1.0,vmin=0.0,)# Add COM marker if availableifcom_dataisnotNone:ax.plot(0, com_data.z_com,'o', color=style.com_color,markersize=style.com_marker_size, zorder=10)ax.set_aspect(\"equal\")ax.set_xlim(bounds.rmin, bounds.rmax)ax.set_ylim(bounds.zmin, bounds.zmax)ax.set_title(f\"$t/\\\\tau_0$ ={snapshot.time:4.3f}\", fontsize=style.tick_label_size)ax.axis(\"off\")add_colorbar(fig,ax,cntrl1,align=\"left\",label=r\"$\\log_{10}\\left(\\boldsymbol{\\mathcal{D}:\\mathcal{D}}\\right)$\",style=style,)add_colorbar(fig,ax,cntrl2,align=\"right\",label=r\"$\\|\\boldsymbol{u}\\|$\",style=style,)plt.savefig(snapshot.target, bbox_inches=\"tight\")plt.close(fig)defprocess_timestep(index:int, config: RuntimeConfig, style: PlotStyle)->Optional[COMData]:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "snapshot=build_snapshot_info(index, config)ifnotos.path.exists(snapshot.source):log_status(f\"Missing:{os.path.basename(snapshot.source)}\", level=\"WARN\")returnNoneifos.path.exists(snapshot.target):log_status(f\"Exists, skipping:{os.path.basename(snapshot.target)}\")# Still extract COM data for existing framesreturnget_com(snapshot.source)# Show relative path: CaseNo/intermediate/filenamesrc_parts=snapshot.source.split(os.sep)src_rel=os.sep.join(src_parts[-3:])iflen(src_parts)>=3elsesnapshot.sourcelog_status(f\"Processing{src_rel}\")try:facets=get_facets(snapshot.source)com_data=get_com(snapshot.source)nr=int(config.grids_per_r*config.rmax)field_data=get_field(snapshot.source, config.zmin, config.zmax, config.rmax, nr)plot_snapshot(field_data, facets, com_data, config.bounds, snapshot, style)# Show relative path: CaseNo/Video/filenametgt_parts=snapshot.target.split(os.sep)tgt_rel=os.sep.join(tgt_parts[-3:])iflen(tgt_parts)>=3elsesnapshot.targetlog_status(f\"Saved:{tgt_rel}\")returncom_dataexceptExceptionaserr:log_status(f\"Error at{src_rel}(t={snapshot.time:.4f}):{err}\", level=\"ERROR\")raisedefwrite_com_data(com_data_list:list, config: RuntimeConfig)->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: # Extract case...",
    "content": "# Extract case number from pathcase_no=os.path.basename(config.case_dir)output_path=os.path.join(config.case_dir,f\"{case_no}_COMData.csv\")# Filter out None entries and sort by timevalid_data=[dfordincom_data_listifdisnotNone]valid_data.sort(key=lambdax: x.time)withopen(output_path,'w', newline='')asf:writer=csv.writer(f)writer.writerow(['time','zCOM','uCOM'])fordatainvalid_data:writer.writerow([f\"{data.time:.4f}\",f\"{data.z_com:.6g}\",f\"{data.u_com:.6g}\"])log_status(f\"COM data saved:{output_path}({len(valid_data)}entries)\")defencode_video(config: RuntimeConfig)->None:",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: # Extract case...",
    "content": "# Extract case number from pathcase_no=os.path.basename(config.case_dir)# Output path: <case_dir>/3000.mp4output_path=os.path.join(config.case_dir,f\"{case_no}.mp4\")input_pattern=os.path.join(config.output_dir,\"*.png\")cmd=[\"ffmpeg\",\"-y\",\"-framerate\",str(config.framerate),\"-pattern_type\",\"glob\",\"-i\", input_pattern,\"-vf\",\"pad=ceil(iw/2)*2:ceil(ih/2)*2\",\"-c:v\",\"libx264\",\"-r\",str(config.output_fps),\"-pix_fmt\",\"yuv420p\",output_path]log_status(f\"Encoding video:{output_path}\")result=sp.run(cmd, capture_output=True, text=True)ifresult.returncode!=0:log_status(f\"ffmpeg error:{result.stderr}\", level=\"ERROR\")raiseRuntimeError(f\"ffmpeg failed with code{result.returncode}\")log_status(f\"Video saved:{output_path}\")defmain():",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "postProcess/Video-generic.py | Asymmetries-in-coalescence - Code Example: Context",
    "content": "config=parse_arguments()ensure_directory(config.output_dir)log_status(f\"Processing case:{config.case_dir}\")log_status(f\"Domain: R=[{config.rmin:.2f},{config.rmax:.2f}], Z=[{config.zmin:.2f},{config.zmax:.2f}]\")log_status(f\"Radius ratio (Rr):{config.rr}\")withmp.Pool(processes=config.cpus)aspool:worker=partial(process_timestep, config=config, style=PLOT_STYLE)com_data_list=pool.map(worker,range(config.n_snapshots))# Write COM data to CSVwrite_com_data(com_data_list, config)# Encode video unless skippedifnotconfig.skip_video_encode:encode_video(config)if__name__==\"__main__\":main()",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/postProcess/Video-generic.py.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Simulation Cases | Documentation",
    "content": "Simulation Cases coalescenceBubble-tag.c This is an optional extended version of coalescenceBubble.c that provides additional interface tracking using Basilis... coalescenceBubble.c Axisymmetric simulation of two-bubble coalescence with size asymmetry using the Volume-of-Fluid (VOF) method. The sim...",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Context",
    "content": "simulationCases/coalescenceBubble-tag.c See raw file Coalescence of Bubbles (Extended Version with Interface Tagging) This is an optional extended version of coalescenceBubble.c that provides additional interface tracking using Basilisk\u2019s tag.h functionality. Scientific Context The simulations target coalescence-driven droplet injection into a parent bubble (Worthington jetting after capillary-wave focusing). This tagged version helps quantify geometry (poles, equatorial radius) while filtering out small satellite droplets that can otherwise bias diagnostics.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Key Differences from...",
    "content": "Key Differences from coalescenceBubble.c Uses two-phase-tag.h instead of two-phase.h (adds ftag[] field) Uses tag.h to identify and track only the largest connected bubble region (filters out satellite droplets that may form during coalescence) Outputs additional geometric measurements: Re : Equatorial radius at center of mass ZNp : North pole position (positive x on axis) ZSp : South pole position (negative x on axis) Log Output Format Extended log columns: i dt t ke Xc Vcm Re ZNp ZSp (vs coalescenceBubble.c : i dt t ke Xc Vcm ) Important Notes All production runs in this project use coalescenceBubble.c , not this file This file is provided for cases requiring detailed shape tracking Same MPI limitation as coalescenceBubble.c due to distance.h incompatibility Usage ./coalescenceBubble-tag <OhOut> <RhoIn> <Rr> <MAXlevel> <tmax> <zWall> Author Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Last updated: Jan 2026 #include \"axi.h\" #include \"navier-stokes/centered.h\" #define FILTERED #include \"two-phase-tag.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #include \"distance.h\" #include \"tag.h\" Simulation Parameters MAXlevel : Maximum refinement level (set via command line) tsnap : Time interval for saving full snapshots (0.01) tsnap2 : Time interval for logging diagnostics (0.0001) int MAXlevel ; #define tsnap (1e-2) #define tsnap2 (1e-4) Error Tolerances Adaptive mesh refinement is controlled by these error thresholds: fErr : VOF volume fraction tolerance (determines interface resolution) VelErr : Velocity field tolerance (captures flow gradients) TOL : Position tolerance for geometric measurements #define fErr (1e-3) #define VelErr (1e-2) #define TOL (1e-2) Boundary Conditions Left boundary (axis of symmetry): - f[left] : No fluid at left boundary (Dirichlet \\(f=0\\) ) - u.t[left] : No tangential velocity (no-slip for azimuthal component) f [ left ] = dirichlet ( 0.0 ); u . t [ left ] = dirichlet ( 0.0 ); Global Variables Physical parameters and output configuration: double tmax , MuRin , OhOut , RhoIn ; double Rr , zWall ; double Ldomain ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initialize simulation parameters from command line and configure the domain. int main ( int argc , char const * argv []) { if ( argc < 7 ){ fprintf ( ferr , \"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Check! Need %d...",
    "content": "Check! Need %d more arguments \\n \" , 7 - argc ); return 1 ; } Parse command-line arguments: MuRin = 1e-2 ; OhOut = atof ( argv [ 1 ]); RhoIn = atof ( argv [ 2 ]); Rr = atof ( argv [ 3 ]); MAXlevel = atoi ( argv [ 4 ]); tmax = atof ( argv [ 5 ]); zWall = atof ( argv [ 6 ]); Domain size is calculated to fit both bubbles with sufficient margin. Ldomain = fmin ( zWall + 2. + 2. * Rr + 4.0 , 16. ); fprintf ( ferr , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); Configure domain and fluid properties: L0 = Ldomain ; origin (- 2.0 - zWall , 0.0 ); init_grid ( 1 << ( 6 )); Set fluid properties.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Context",
    "content": "Note: ftag.sigma = 0 because ftag is only used for tracking, not for surface tension calculations. rho1 = RhoIn ; mu1 = MuRin * OhOut ; rho2 = 1e0 ; mu2 = OhOut ; f . sigma = 1.0 ; ftag . sigma = 0.0 ; char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); sprintf ( dumpFile , \"restart\" ); run (); } Initialization Event Load initial bubble shapes from pre-computed data files.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Both f and...",
    "content": "Both f and ftag are initialized with the same interface shape. event init ( t = 0 ){ if (! restore ( file = dumpFile )){ char filename [ 60 ]; sprintf ( filename , \"InitialConditionRr-%3.2f.dat\" , Rr ); char comm [ 160 ]; sprintf ( comm , \"scp -r DataFiles/%s .\" , filename ); system ( comm ); FILE * fp = fopen ( filename , \"rb\" ); if ( fp == NULL ){ fprintf ( ferr , \"There is no file named %s \\n \" , filename ); return 1 ; } coord * InitialShape ; InitialShape = input_xy ( fp ); fclose ( fp ); scalar d []; distance ( d , InitialShape ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-8 , 1e-8 }, MAXlevel ). nf ); The distance function is defined at the center of each cell, we have to calculate the value of this function at each vertex. vertex scalar phi []; foreach_vertex (){ phi [] = ( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ])/ 4. ; } We can now initialize the volume fraction of the domain.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Both f and...",
    "content": "Both f and ftag start with the same interface. fractions ( phi , f ); fractions ( phi , ftag ); foreach (){ u . x [] = 0.0 ; u . y [] = 0.0 ; } dump ( file = dumpFile ); static FILE * fp2 ; fp2 = fopen ( \"InitialConditionStatus.dat\" , \"w\" ); fprintf ( fp2 , \"Initial condition is written to %s \\n \" , dumpFile ); fclose ( fp2 ); } } Adaptive Mesh Refinement Refine the mesh based on interface position and velocity gradients. event adapt ( i ++){ adapt_wavelet (( scalar *){ f , u . x , u . y }, ( double []){ fErr , VelErr , VelErr }, MAXlevel , MAXlevel - 6 ); } Output Files Save simulation snapshots at regular intervals. event writingFiles ( t = 0 ; t += tsnap ; t <= tmax + tsnap ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot-%5.4f\" , t ); dump ( file = nameOut ); } event end ( t = end ) { fprintf ( ferr , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, Oh2 %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); } Auxiliary Fields for Geometric Measurements posEq : Stores equatorial positions for radius calculation posPoles : Stores pole positions along the axis scalar posEq [], posPoles []; Logging Event with Interface Tagging This extended logging event performs connected component analysis to track only the main bubble, filtering out any satellite droplets that may form.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Interface Tagging Algorithm...",
    "content": "Interface Tagging Algorithm Copy f to ftag at each timestep Threshold ftag to create binary field ( \\(f > 10^{-4}\\) ) Use tag() to identify connected components Find the largest component (main bubble) Zero out ftag everywhere except the main component This ensures that geometric measurements (Re, ZNp, ZSp) only track the primary coalescing bubble, not small satellite droplets.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Geometric Measurements Equatorial...",
    "content": "Geometric Measurements Equatorial radius ( Re ): Interface position at \\(y = y_{COM}\\) (radial extent at the center of mass height) North pole ( ZNp ): Maximum \\(x\\) position where interface crosses axis (top of the bubble) South pole ( ZSp ): Minimum \\(x\\) position where interface crosses axis (bottom of the bubble) event logWriting ( t = 0 ; t += tsnap2 ; t <= tmax + tsnap ) { Copy current VOF field to tagging field: foreach (){ ftag [] = f []; } Connected Component Analysis Tag all liquid regions with a threshold to avoid noise: scalar d []; double threshold = 1e-4 ; foreach (){ d [] = ( ftag [] > threshold ); } int n = tag ( d ), size [ n ]; for ( int i = 0 ; i < n ; i ++){ size [ i ] = 0 ; } Count cells in each tagged region: foreach_leaf (){ if ( d [] > 0 ){ size [(( int ) d []) - 1 ]++; } } #if _MPI MPI_Allreduce ( MPI_IN_PLACE , size , n , MPI_INT , MPI_SUM , MPI_COMM_WORLD ); #endif Identify the largest connected component (main bubble): int MaxSize = 0 ; int MainPhase = 0 ; for ( int i = 0 ; i < n ; i ++){ if ( size [ i ] > MaxSize ){ MaxSize = size [ i ]; MainPhase = i + 1 ; } } Zero out satellite droplets, keeping only the main bubble: foreach (){ if ( d [] != MainPhase ){ ftag [] = 0.0 ; } } Compute Diagnostics Calculate kinetic energy and center of mass using tagged field: double ke = 0. , wt = 0. , xCOM = 0. , Vcm = 0. ; foreach ( reduction (+: ke ) reduction (+: wt ) reduction (+: xCOM ) reduction (+: Vcm )){ ke += 2 * pi * y *( 0.5 * clamp ( ftag [], 0. , 1. )*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); xCOM += 2 * pi * y * x * clamp ( ftag [], 0.0 , 1.0 )* sq ( Delta ); Vcm += 2 * pi * y * u . x []* clamp ( ftag [], 0.0 , 1.0 )* sq ( Delta ); wt += 2 * pi * y * clamp ( ftag [], 0.0 , 1.0 )* sq ( Delta ); } xCOM /= wt ; Equatorial Radius Calculation Find interface position at height \\(x = x_{COM}\\) (within tolerance TOL ): int nEq = 0 ; double Req = 0.0 ; position ( ftag , posEq , { 0 , 1 }); foreach ( reduction (+: Req ) reduction (+: nEq )){ if ( x < xCOM + TOL && x > xCOM - TOL && posEq [] != nodata ){ Req += posEq []; nEq ++; } } if ( nEq != 0 ){ Req /= nEq ; } else { Req = 0.0 ; } Pole Position Calculation Find interface positions along the axis ( \\(y < TOL\\) ): - North pole: positive \\(x\\) intersection - South pole: negative \\(x\\) intersection double zNP = 0.0 , zSP = 0.0 ; int nNP = 0 , nSP = 0 ; position ( ftag , posPoles , { 1 , 0 }); foreach ( reduction (+: zNP ) reduction (+: nNP ) reduction (+: zSP ) reduction (+: nSP )){ if ( y < TOL && posPoles [] != nodata ){ if ( posPoles [] > 0 ){ zNP += posPoles []; nNP ++; } else { zSP += posPoles []; nSP ++; } } } if ( nNP != 0 ){ zNP /= nNP ; } else { zNP = 0.0 ; } if ( nSP != 0 ){ zSP /= nSP ; } else { zSP = 0.0 ; } Write Log Output static FILE * fp ; if ( pid () == 0 ) { if ( i == 0 ) { fprintf ( ferr , \"i dt t ke Xc Vcm Re ZNp ZSp \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); fprintf ( fp , \"i dt t ke Xc Vcm Re ZNp ZSp \\n \" ); fprintf ( fp , \"%d %g %g %g %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt , Req , zNP , zSP ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"%d %g %g %g %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt , Req , zNP , zSP ); fclose ( fp ); } fprintf ( ferr , \"%d %g %g %g %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt , Req , zNP , zSP ); } Early Termination Stop simulation when kinetic energy becomes negligible: assert ( ke > - 1e-10 ); if ( ke < 1e-5 && i > 1000 ){ if ( pid () == 0 ){ fprintf ( ferr , \"kinetic energy too small now!",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence: Stopping! \\n \"...",
    "content": "Stopping! \\n \" ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"kinetic energy too small now! Stopping! \\n \" ); fclose ( fp ); } return 1 ; } }",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "./coalescenceBubble-tag <OhOut> <RhoIn> <Rr> <MAXlevel> <tmax> <zWall>",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"#define FILTERED#include\"two-phase-tag.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#include\"distance.h\"#include\"tag.h\"",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "intMAXlevel;#define tsnap (1e-2)#define tsnap2 (1e-4)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "#define fErr (1e-3)#define VelErr (1e-2)#define TOL (1e-2)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "doubletmax,MuRin,OhOut,RhoIn;doubleRr,zWall;doubleLdomain;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "intmain(intargc,charconst*argv[]){if(argc<7){fprintf(ferr,\"Lack of command line arguments. Check! Need %d more arguments\\n\",7-argc);return1;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "MuRin=1e-2;OhOut=atof(argv[1]);RhoIn=atof(argv[2]);Rr=atof(argv[3]);MAXlevel=atoi(argv[4]);tmax=atof(argv[5]);zWall=atof(argv[6]);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "Ldomain=fmin(zWall+2.+2.*Rr+4.0,16.);fprintf(ferr,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "L0=Ldomain;origin(-2.0-zWall,0.0);init_grid(1<<(6));",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "rho1=RhoIn;mu1=MuRin*OhOut;rho2=1e0;mu2=OhOut;f.sigma=1.0;ftag.sigma=0.0;charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);sprintf(dumpFile,\"restart\");run();}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "event init(t=0){if(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"InitialConditionRr-%3.2f.dat\",Rr);charcomm[160];sprintf(comm,\"scp -r DataFiles/%s .\",filename);system(comm);FILE*fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named %s\\n\",filename);return1;}coord*InitialShape;InitialShape=input_xy(fp);fclose(fp);scalar d[];distance(d,InitialShape);while(adapt_wavelet((scalar*){f,d},(double[]){1e-8,1e-8},MAXlevel).nf);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "vertex scalar phi[];foreach_vertex(){phi[]=(d[]+d[-1]+d[0,-1]+d[-1,-1])/4.;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "fractions(phi,f);fractions(phi,ftag);foreach(){u.x[]=0.0;u.y[]=0.0;}dump(file=dumpFile);staticFILE*fp2;fp2=fopen(\"InitialConditionStatus.dat\",\"w\");fprintf(fp2,\"Initial condition is written to %s\\n\",dumpFile);fclose(fp2);}}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "event adapt(i++){adapt_wavelet((scalar*){f,u.x,u.y},(double[]){fErr,VelErr,VelErr},MAXlevel,MAXlevel-6);}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax+tsnap){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}event end(t=end){fprintf(ferr,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, Oh2 %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "scalar d[];doublethreshold=1e-4;foreach(){d[]=(ftag[]>threshold);}intn=tag(d),size[n];for(inti=0;i<n;i++){size[i]=0;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "foreach_leaf(){if(d[]>0){size[((int)d[])-1]++;}}#if _MPIMPI_Allreduce(MPI_IN_PLACE,size,n,MPI_INT,MPI_SUM,MPI_COMM_WORLD);#endif",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "intMaxSize=0;intMainPhase=0;for(inti=0;i<n;i++){if(size[i]>MaxSize){MaxSize=size[i];MainPhase=i+1;}}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "doubleke=0.,wt=0.,xCOM=0.,Vcm=0.;foreach(reduction(+:ke)reduction(+:wt)reduction(+:xCOM)reduction(+:Vcm)){ke+=2*pi*y*(0.5*clamp(ftag[],0.,1.)*(sq(u.x[])+sq(u.y[])))*sq(Delta);xCOM+=2*pi*y*x*clamp(ftag[],0.0,1.0)*sq(Delta);Vcm+=2*pi*y*u.x[]*clamp(ftag[],0.0,1.0)*sq(Delta);wt+=2*pi*y*clamp(ftag[],0.0,1.0)*sq(Delta);}xCOM/=wt;",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "intnEq=0;doubleReq=0.0;position(ftag,posEq,{0,1});foreach(reduction(+:Req)reduction(+:nEq)){if(x<xCOM+TOL&&x>xCOM-TOL&&posEq[]!=nodata){Req+=posEq[];nEq++;}}if(nEq!=0){Req/=nEq;}else{Req=0.0;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "doublezNP=0.0,zSP=0.0;intnNP=0,nSP=0;position(ftag,posPoles,{1,0});foreach(reduction(+:zNP)reduction(+:nNP)reduction(+:zSP)reduction(+:nSP)){if(y<TOL&&posPoles[]!=nodata){if(posPoles[]>0){zNP+=posPoles[];nNP++;}else{zSP+=posPoles[];nSP++;}}}if(nNP!=0){zNP/=nNP;}else{zNP=0.0;}if(nSP!=0){zSP/=nSP;}else{zSP=0.0;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example: staticFILE*fp;if(pid()==0){if(i==0){fprintf(ferr,\"i dt t...",
    "content": "staticFILE*fp;if(pid()==0){if(i==0){fprintf(ferr,\"i dt t ke Xc Vcm Re ZNp ZSp\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);fprintf(fp,\"i dt t ke Xc Vcm Re ZNp ZSp\\n\");fprintf(fp,\"%d %g %g %g %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt,Req,zNP,zSP);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d %g %g %g %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt,Req,zNP,zSP);fclose(fp);}fprintf(ferr,\"%d %g %g %g %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt,Req,zNP,zSP);}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble-tag.c | Asymmetries-in-coalescence - Code Example",
    "content": "assert(ke>-1e-10);if(ke<1e-5&&i>1000){if(pid()==0){fprintf(ferr,\"kinetic energy too small now! Stopping!\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"kinetic energy too small now! Stopping!\\n\");fclose(fp);}return1;}}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble-tag.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Methods",
    "content": "simulationCases/coalescenceBubble.c See raw file Coalescence of Bubbles Axisymmetric simulation of two-bubble coalescence with size asymmetry using the Volume-of-Fluid (VOF) method. The simulation tracks the interface between gas (inside bubble, \\(f=1\\) ) and liquid (outside, \\(f=0\\) ) phases. Scientific Context This model isolates the hydrodynamic event responsible for electrolyte entrainment in gas-evolving electrochemical systems: coalescence between a large \u201cparent\u201d bubble and a smaller bubble. The key physical pathway is capillary-wave focusing on the smaller bubble that generates a Worthington jet and droplet pinch-off into the parent bubble. Hydrodynamic Pathway (Captured Here) First contact creates a neck that expands rapidly. The neck launches capillary waves over the small bubble. Waves focus at the small bubble\u2019s south pole. A Worthington jet forms and breaks up, injecting droplets into the gas.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Physical Setup Two...",
    "content": "Physical Setup Two initially spherical bubbles of different sizes are placed along the axis of symmetry. The larger bubble has radius 1 (reference scale), while the smaller bubble has radius Rr (the radius ratio parameter). Surface tension drives the coalescence dynamics. Governing Equations The incompressible Navier-Stokes equations with surface tension: \\[\\nabla \\cdot \\mathbf{u} = 0\\] \\[\\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u} \\cdot \\nabla \\mathbf{u}\\right) = -\\nabla p + \\nabla \\cdot (2\\mu \\mathbf{D}) + \\sigma \\kappa \\delta_s \\mathbf{n}\\] where \\(\\mathbf{D}\\) is the strain-rate tensor, \\(\\sigma\\) is surface tension, \\(\\kappa\\) is interface curvature, and \\(\\delta_s\\) is the interface delta function.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Context",
    "content": "Usage ./coalescenceBubble <OhOut> <RhoIn> <Rr> <MAXlevel> <tmax> <zWall> Command-line Parameters OhOut : Solvent Ohnesorge number based on the small bubble radius, \\(Oh_s = \\mu_{out}/\\sqrt{\\rho_{out} \\sigma r}\\) RhoIn : Density ratio \\(\\rho_{b}/\\rho_{s}\\) (typically \\(10^{-3}\\) for air-water) Rr : Radius ratio \\(r/R\\) (small to large bubble). Note that some literature reports the inverse ( \\(R/r\\) ); this code uses \\(r/R\\) . MAXlevel : Maximum adaptive mesh refinement level tmax : Maximum simulation time zWall : Wall position (distance from origin to left boundary) Nondimensional Mapping Used in This Code The large-bubble radius is the reference length ( \\(R=1\\) ). The small-bubble radius is r = Rr . The bubble viscosity ratio is fixed as MuRin = 1e-2 , so \\(Oh_b/Oh_s = 0.01\\) with \\(Oh_b = \\mu_b/\\sqrt{\\rho_s \\sigma r}\\) . Confinement is controlled via zWall : smaller zWall places the small bubble closer to the wall, corresponding to smaller \\(\\chi = d/r\\) .",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: JavaScript",
    "content": "Parameter Sweeps Typical sweeps vary OhOut and Rr (bulk) or zWall (confined) to build droplet/no-droplet regime maps and to quantify the first injected droplet size.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: C/C++ Code",
    "content": "Author Vatsal Sanjay vatsalsanjay@gmail.com Physics of Fluids Last updated: Jan 2026 #include \"axi.h\" #include \"navier-stokes/centered.h\" #define FILTERED #include \"two-phase.h\" #include \"navier-stokes/conserving.h\" #include \"tension.h\" #if !_MPI #include \"distance.h\" #endif Simulation Parameters MAXlevel : Maximum refinement level (set via command line) tsnap : Time interval for saving full snapshots (0.01) tsnap2 : Time interval for logging diagnostics (0.0001) int MAXlevel ; #define tsnap (1e-2) #define tsnap2 (1e-4) Error Tolerances Adaptive mesh refinement is controlled by these error thresholds: fErr : VOF volume fraction tolerance (determines interface resolution) VelErr : Velocity field tolerance (captures flow gradients) #define fErr (1e-3) #define VelErr (1e-2) Boundary Conditions Left boundary (axis of symmetry): - f[left] : No fluid at left boundary (Dirichlet \\(f=0\\) ) - u.t[left] : No tangential velocity (no-slip for azimuthal component) f [ left ] = dirichlet ( 0.0 ); u . t [ left ] = dirichlet ( 0.0 ); Global Variables Physical parameters and output configuration: double tmax , MuRin , OhOut , RhoIn ; double Rr , zWall ; double Ldomain ; char nameOut [ 80 ], dumpFile [ 80 ]; Main Function Initialize simulation parameters from command line and configure the domain. int main ( int argc , char const * argv []) { if ( argc < 7 ){ fprintf ( ferr , \"Lack of command line arguments.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Check! Need %d...",
    "content": "Check! Need %d more arguments \\n \" , 7 - argc ); return 1 ; } Parse command-line arguments: MuRin = 1e-2 ; OhOut = atof ( argv [ 1 ]); RhoIn = atof ( argv [ 2 ]); Rr = atof ( argv [ 3 ]); MAXlevel = atoi ( argv [ 4 ]); tmax = atof ( argv [ 5 ]); zWall = atof ( argv [ 6 ]); Domain size is calculated to fit both bubbles with sufficient margin. The formula ensures adequate space: wall + larger bubble (R=1) + gap + smaller bubble (R=Rr) + buffer.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Ldomain = fmin...",
    "content": "Ldomain = fmin ( zWall + 2. + 2. * Rr + 4.0 , 16. ); fprintf ( ferr , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); Configure domain and fluid properties: L0 = Ldomain ; origin (- 2.0 - zWall , 0.0 ); init_grid ( 1 << ( 6 )); Set fluid properties: - Phase 1 (bubble interior): low density, low viscosity - Phase 2 (surrounding liquid): reference density and viscosity - Surface tension coefficient normalized to 1 rho1 = RhoIn ; mu1 = MuRin * OhOut ; rho2 = 1e0 ; mu2 = OhOut ; f . sigma = 1.0 ; char comm [ 80 ]; sprintf ( comm , \"mkdir -p intermediate\" ); system ( comm ); sprintf ( dumpFile , \"restart\" ); TOLERANCE = 1e-4 ; CFL = 1e-1 ; run (); } Initialization Event Load initial bubble shapes from pre-computed data files. The initial condition files contain the interface coordinates for different radius ratios.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: For MPI runs,...",
    "content": "For MPI runs, the simulation must be restarted from a dump file created by a prior serial/OpenMP run (due to distance.h incompatibility with MPI). event init ( t = 0 ){ #if _MPI if (! restore ( file = dumpFile )) { fprintf ( ferr , \"Cannot restored from a dump file! \\n \" ); } #else if (! restore ( file = dumpFile )){ char filename [ 60 ]; sprintf ( filename , \"InitialConditionRr-%3.2f.dat\" , Rr ); char comm [ 160 ]; sprintf ( comm , \"scp -r DataFiles/%s .\" , filename ); system ( comm ); FILE * fp = fopen ( filename , \"rb\" ); if ( fp == NULL ){ fprintf ( ferr , \"There is no file named %s \\n \" , filename ); return 1 ; } coord * InitialShape ; InitialShape = input_xy ( fp ); fclose ( fp ); scalar d []; distance ( d , InitialShape ); while ( adapt_wavelet (( scalar *){ f , d }, ( double []){ 1e-8 , 1e-8 }, MAXlevel ). nf ); The distance function is defined at the center of each cell, we have to calculate the value of this function at each vertex. vertex scalar phi []; foreach_vertex (){ phi [] = ( d [] + d [- 1 ] + d [ 0 ,- 1 ] + d [- 1 ,- 1 ])/ 4. ; } We can now initialize the volume fraction of the domain. fractions ( phi , f ); foreach (){ u . x [] = 0.0 ; u . y [] = 0.0 ; } dump ( file = dumpFile ); static FILE * fp2 ; fp2 = fopen ( \"InitialConditionStatus.dat\" , \"w\" ); fprintf ( fp2 , \"Initial condition is written to %s \\n \" , dumpFile ); fclose ( fp2 ); } #endif } Adaptive Mesh Refinement Refine the mesh based on: - Interface position (VOF field f ) - Velocity gradients ( u.x , u.y ) Refinement ranges from MAXlevel-6 (coarse, far from interface) to MAXlevel (fine, near interface and in high-gradient regions). event adapt ( i ++){ adapt_wavelet (( scalar *){ f , u . x , u . y }, ( double []){ fErr , VelErr , VelErr }, MAXlevel , MAXlevel - 6 ); } Output Files Save simulation snapshots at regular intervals: - restart : Current state for checkpoint/restart - intermediate/snapshot-<time> : Time series for post-processing event writingFiles ( t = 0 ; t += tsnap ; t <= tmax + tsnap ) { dump ( file = dumpFile ); sprintf ( nameOut , \"intermediate/snapshot-%5.4f\" , t ); dump ( file = nameOut ); } event end ( t = end ) { fprintf ( ferr , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, Oh2 %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); } Logging Event Track simulation diagnostics at fine time intervals.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Computed quantities: ke...",
    "content": "Computed quantities: ke : Total kinetic energy in the bubble phase \\[KE = \\int_V \\frac{1}{2} f \\rho |\\mathbf{u}|^2 \\, dV\\] xCOM : Axial position of center of mass \\[x_{COM} = \\frac{\\int_V f \\cdot x \\, dV}{\\int_V f \\, dV}\\] Vcm : Axial velocity of center of mass \\[V_{cm} = \\frac{\\int_V f \\cdot u_x \\, dV}{\\int_V f \\, dV}\\] The simulation automatically stops when kinetic energy drops below \\(10^{-5}\\) (indicating the system has reached equilibrium). event logWriting ( t = 0 ; t += tsnap2 ; t <= tmax + tsnap ) { double ke = 0. , wt = 0. , xCOM = 0. , Vcm = 0. ; foreach ( reduction (+: ke ) reduction (+: wt ) reduction (+: xCOM ) reduction (+: Vcm )){ ke += 2 * pi * y *( 0.5 * clamp ( f [], 0. , 1. )*( sq ( u . x []) + sq ( u . y [])))* sq ( Delta ); xCOM += 2 * pi * y * x * clamp ( f [], 0.0 , 1.0 )* sq ( Delta ); Vcm += 2 * pi * y * u . x []* clamp ( f [], 0.0 , 1.0 )* sq ( Delta ); wt += 2 * pi * y * clamp ( f [], 0.0 , 1.0 )* sq ( Delta ); } xCOM /= wt ; static FILE * fp ; if ( pid () == 0 ) { if ( i == 0 ) { fprintf ( ferr , \"i dt t ke Xc Vcm \\n \" ); fp = fopen ( \"log\" , \"w\" ); fprintf ( fp , \"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f \\n \" , MAXlevel , Ldomain , tmax , MuRin , OhOut , RhoIn , Rr ); fprintf ( fp , \"i dt t ke Xc Vcm \\n \" ); fprintf ( fp , \"%d %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt ); fclose ( fp ); } else { fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"%d %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt ); fclose ( fp ); } fprintf ( ferr , \"%d %g %g %g %g %g \\n \" , i , dt , t , ke , xCOM , Vcm / wt ); } assert ( ke > - 1e-10 ); if ( ke < 1e-5 && i > 1000 ){ if ( pid () == 0 ){ fprintf ( ferr , \"kinetic energy too small now!",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence: Stopping! \\n \"...",
    "content": "Stopping! \\n \" ); fp = fopen ( \"log\" , \"a\" ); fprintf ( fp , \"kinetic energy too small now! Stopping! \\n \" ); fclose ( fp ); } return 1 ; } }",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "./coalescenceBubble <OhOut> <RhoIn> <Rr> <MAXlevel> <tmax> <zWall>",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - C/C++ Code",
    "content": "#include\"axi.h\"#include\"navier-stokes/centered.h\"#define FILTERED#include\"two-phase.h\"#include\"navier-stokes/conserving.h\"#include\"tension.h\"#if !_MPI#include\"distance.h\"#endif",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "intMAXlevel;#define tsnap (1e-2)#define tsnap2 (1e-4)",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "doubletmax,MuRin,OhOut,RhoIn;doubleRr,zWall;doubleLdomain;charnameOut[80],dumpFile[80];",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "intmain(intargc,charconst*argv[]){if(argc<7){fprintf(ferr,\"Lack of command line arguments. Check! Need %d more arguments\\n\",7-argc);return1;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "MuRin=1e-2;OhOut=atof(argv[1]);RhoIn=atof(argv[2]);Rr=atof(argv[3]);MAXlevel=atoi(argv[4]);tmax=atof(argv[5]);zWall=atof(argv[6]);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "Ldomain=fmin(zWall+2.+2.*Rr+4.0,16.);fprintf(ferr,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "L0=Ldomain;origin(-2.0-zWall,0.0);init_grid(1<<(6));",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "rho1=RhoIn;mu1=MuRin*OhOut;rho2=1e0;mu2=OhOut;f.sigma=1.0;charcomm[80];sprintf(comm,\"mkdir -p intermediate\");system(comm);sprintf(dumpFile,\"restart\");TOLERANCE=1e-4;CFL=1e-1;run();}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example: event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot...",
    "content": "event init(t=0){#if _MPIif(!restore(file=dumpFile)){fprintf(ferr,\"Cannot restored from a dump file!\\n\");}#elseif(!restore(file=dumpFile)){charfilename[60];sprintf(filename,\"InitialConditionRr-%3.2f.dat\",Rr);charcomm[160];sprintf(comm,\"scp -r DataFiles/%s .\",filename);system(comm);FILE*fp=fopen(filename,\"rb\");if(fp==NULL){fprintf(ferr,\"There is no file named %s\\n\",filename);return1;}coord*InitialShape;InitialShape=input_xy(fp);fclose(fp);scalar d[];distance(d,InitialShape);while(adapt_wavelet((scalar*){f,d},(double[]){1e-8,1e-8},MAXlevel).nf);",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "vertex scalar phi[];foreach_vertex(){phi[]=(d[]+d[-1]+d[0,-1]+d[-1,-1])/4.;}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "fractions(phi,f);foreach(){u.x[]=0.0;u.y[]=0.0;}dump(file=dumpFile);staticFILE*fp2;fp2=fopen(\"InitialConditionStatus.dat\",\"w\");fprintf(fp2,\"Initial condition is written to %s\\n\",dumpFile);fclose(fp2);}#endif}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "event adapt(i++){adapt_wavelet((scalar*){f,u.x,u.y},(double[]){fErr,VelErr,VelErr},MAXlevel,MAXlevel-6);}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example",
    "content": "event writingFiles(t=0;t+=tsnap;t<=tmax+tsnap){dump(file=dumpFile);sprintf(nameOut,\"intermediate/snapshot-%5.4f\",t);dump(file=nameOut);}event end(t=end){fprintf(ferr,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, Oh2 %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example: Context",
    "content": "event logWriting(t=0;t+=tsnap2;t<=tmax+tsnap){doubleke=0.,wt=0.,xCOM=0.,Vcm=0.;foreach(reduction(+:ke)reduction(+:wt)reduction(+:xCOM)reduction(+:Vcm)){ke+=2*pi*y*(0.5*clamp(f[],0.,1.)*(sq(u.x[])+sq(u.y[])))*sq(Delta);xCOM+=2*pi*y*x*clamp(f[],0.0,1.0)*sq(Delta);Vcm+=2*pi*y*u.x[]*clamp(f[],0.0,1.0)*sq(Delta);wt+=2*pi*y*clamp(f[],0.0,1.0)*sq(Delta);}xCOM/=wt;staticFILE*fp;if(pid()==0){if(i==0){fprintf(ferr,\"i dt t ke Xc Vcm\\n\");fp=fopen(\"log\",\"w\");fprintf(fp,\"Level %d, Ldomain %g, tmax %3.2f, MuRin %3.2e, OhOut %3.2e, Rho21 %4.3f, Rr %f\\n\",MAXlevel,Ldomain,tmax,MuRin,OhOut,RhoIn,Rr);fprintf(fp,\"i dt t ke Xc Vcm\\n\");fprintf(fp,\"%d %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt);fclose(fp);}else{fp=fopen(\"log\",\"a\");fprintf(fp,\"%d %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt);fclose(fp);}fprintf(ferr,\"%d %g %g %g %g %g\\n\",i,dt,t,ke,xCOM,Vcm/wt);}assert(ke>-1e-10);if(ke<1e-5&&i>1000){if(pid()==0){fprintf(ferr,\"kinetic energy too small now!",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "simulationCases/coalescenceBubble.c | Asymmetries-in-coalescence - Code Example: Stopping!\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"kinetic energy too...",
    "content": "Stopping!\\n\");fp=fopen(\"log\",\"a\");fprintf(fp,\"kinetic energy too small now! Stopping!\\n\");fclose(fp);}return1;}}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/simulationCases/coalescenceBubble.c.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phase-tag.h | Asymmetries-in-coalescence: Context",
    "content": "src-local/two-phase-tag.h See raw file Two-phase Interfacial Flows with Interface Tagging This file extends the standard two-phase.h setup for flows of two fluids separated by an interface. It is typically used in combination with a Navier-Stokes solver . Overview The interface between the fluids is tracked with a Volume-Of-Fluid method. The volume fraction in fluid 1 is \\(f=1\\) and \\(f=0\\) in fluid 2. The densities and dynamic viscosities for fluid 1 and 2 are rho1 , mu1 , rho2 , mu2 , respectively. Interface Fields This header declares two VOF fields: f[] : The primary VOF field used for all physical calculations (density, viscosity, surface tension). This is the field that appears in the Navier-Stokes equations. ftag[] : A secondary VOF field used only for tracking purposes . This field can be manipulated (e.g., filtered with tag.h to remove satellite droplets) without affecting the physical simulation.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/two-phase-tag.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phase-tag.h | Asymmetries-in-coalescence: Typical Usage In...",
    "content": "Typical Usage In coalescenceBubble-tag.c , the ftag field is used with connected component analysis ( tag.h ) to identify and track only the main bubble, filtering out small satellite droplets that may form during coalescence. // In main(): f . sigma = 1.0 ; // Physical surface tension ftag . sigma = 0.0 ; // No surface tension (tracking only) // In logging event: foreach () ftag [] = f []; // Copy current interface // ... apply tag() filtering to ftag ... // ... compute diagnostics using ftag (filtered) ... When to Use This vs Standard two-phase.h Use two-phase.h for most simulations where you only need to track a single interface and don\u2019t need satellite droplet filtering.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/two-phase-tag.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phase-tag.h | Asymmetries-in-coalescence: Context",
    "content": "Use two-phase-tag.h when you need to: Filter out satellite droplets for cleaner diagnostics Track multiple disconnected regions separately Compute geometric measurements on only the main fluid body See also Two-phase interfacial flows Two-phase interfacial flows with coupled VOF and levelset Two-phase interfacial flows with levelset Connected component analysis #include \"vof.h\" VOF Field Declarations Both fields are added to the interfaces list for proper advection and refinement handling by the VOF solver. scalar f [], ftag [], * interfaces = { f , ftag }; #include \"two-phase-generic.h\"",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/two-phase-tag.h.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/two-phase-tag.h | Asymmetries-in-coalescence - Code Example",
    "content": "// In main():f.sigma=1.0;// Physical surface tensionftag.sigma=0.0;// No surface tension (tracking only)// In logging event:foreach()ftag[]=f[];// Copy current interface// ... apply tag() filtering to ftag ...// ... compute diagnostics using ftag (filtered) ...",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/two-phase-tag.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/two-phase-tag.h | Asymmetries-in-coalescence - C/C++ Code",
    "content": "scalar f[],ftag[],*interfaces={f,ftag};#include\"two-phase-generic.h\"",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/two-phase-tag.h.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Local Source Files | Documentation",
    "content": "Local Source Files basilisk_version.sh BASILISKREF='v2026-01-13' parse_params.sh parseparamfile() { local paramfile=\\$1 if [ ! -f '\\$paramfile' ]; then echo 'ERROR: Parameter file \\$paramfile not fo... sweep_utils.sh SWEEPVARS=() SWEEPVALUES=() two-phase-tag.h This file extends the standard [two-phase.h](two-phase.h) setup for flows of two fluids separated by an interface. It...",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/index.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence: Context",
    "content": "src-local/parse_params.sh See raw file parse_params.sh #!/bin/bash # ============================================================================== # parse_params.sh - Shell Library for Parameter File Parsing # # A reusable shell library for parsing parameter files and generating parameter # sweep combinations. Designed for use with simulation workflows that need # configurable parameters. # # Usage: # source src-local/parse_params.sh # # After sourcing, the following functions are available: # - parse_param_file <file> Parse a parameter file # - get_param <key> [default] Get a parameter value # - generate_sweep_cases <file> Generate sweep case files # - validate_required_params ...",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence: Examples",
    "content": "Check required parameters exist # - print_params Print all loaded parameters # # Parameter File Format: # key=value # # Comments start with # # key2=value2 # Inline comments are supported # # Example parameter file (default.params): # # Simulation parameters # OhOut=1e-2 # RhoIn=1e-3 # MAXlevel=12 # tmax=40.0 # # Author: Vatsal Sanjay # Last updated: Jan 2026 # ============================================================================== # ============================================================================== # Function: parse_param_file # # Description: # Parse a parameter file and export all key=value pairs as environment # variables with a PARAM_ prefix.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence: Comments and empty...",
    "content": "Comments and empty lines are skipped. # # Parameters: # \\$1 - Path to the parameter file # # Returns: # 0 on success, 1 if file not found # # Side Effects: # Exports environment variables named PARAM_<key> for each parameter # # Example: # parse_param_file \"default.params\" # echo \\$PARAM_OhOut # Prints: 1e-2 # ============================================================================== parse_param_file() { local param_file = \\$ 1 if [ ! -f \" \\$ param_file\" ] ; then echo \"ERROR: Parameter file \\$ param_file not found\" >& 2 return 1 fi # Read parameters (skip comments and empty lines) while IFS = '=' read -r key value || [ -n \" \\$ key\" ] ; do # Skip comments and empty lines [[ \" \\$ key\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ key\" ]] && continue # Remove inline comments and whitespace using sed and xargs value = \\$ ( echo \" \\$ value\" | sed 's/#.*//' | xargs ) key = \\$ ( echo \" \\$ key\" | xargs ) # Skip if key or value is empty [ -z \" \\$ key\" ] && continue [ -z \" \\$ value\" ] && continue # Export as environment variable with PARAM_ prefix export \"PARAM_ \\$ {key}= \\$ {value}\" done < \" \\$ param_file\" return 0 } # ============================================================================== # Function: get_param # # Description: # Retrieve a parameter value by key.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence: Returns default value...",
    "content": "Returns default value if not set. # # Parameters: # \\$1 - Parameter key (without PARAM_ prefix) # \\$2 - Default value (optional, defaults to empty string) # # Returns: # Prints the parameter value to stdout # # Example: # OhOut=\\$(get_param \"OhOut\" \"1e-2\") # MAXlevel=\\$(get_param \"MAXlevel\" \"10\") # ============================================================================== get_param() { local key = \\$ 1 local default = \\$ {2:-} local var_name = \"PARAM_ \\$ {key}\" echo \" \\$ {!var_name:- \\$ default}\" } # ============================================================================== # Function: generate_sweep_cases # # Description: # Generate parameter files for all combinations in a parameter sweep. # Creates a Cartesian product of all SWEEP_* variables defined in the # sweep file. # # Parameters: # \\$1 - Path to the sweep configuration file # # Returns: # Prints path to temporary directory containing generated case files # Returns 1 on error # # Sweep File Format: # BASE_CONFIG=path/to/base.params # Required: base parameter file # OUTPUT_TEMPLATE=output/{Rr}/{Oh} # Output directory template # SWEEP_Rr=0.5,0.7,1.0 # Sweep variable (comma-separated) # SWEEP_Oh=1e-2,1e-3 # Another sweep variable # # Generated Files: # Creates case_0000.params, case_0001.params, etc. in a temporary directory. # Each file contains the base configuration with sweep values overridden. # # Example: # cases_dir=\\$(generate_sweep_cases \"sweep.params\") # for case_file in \"\\$cases_dir\"/*.params; do # parse_param_file \"\\$case_file\" # # Run simulation with these parameters... # done # ============================================================================== generate_sweep_cases() { local sweep_file = \\$ 1 if [ ! -f \" \\$ sweep_file\" ] ; then echo \"ERROR: Sweep file \\$ sweep_file not found\" >& 2 return 1 fi # Source the sweep file to get variables source \" \\$ sweep_file\" # Check if BASE_CONFIG is defined if [ -z \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: BASE_CONFIG not defined in sweep file\" >& 2 return 1 fi # Parse base configuration parse_param_file \" \\$ BASE_CONFIG\" # Create temporary directory for generated cases local temp_dir = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) # Extract sweep variables from the sweep file # Match lines like: SWEEP_varname=value1,value2,value3 local sweep_vars = () local sweep_values = () while IFS = '=' read -r line ; do # Remove comments line = \\$ ( echo \" \\$ line\" | sed 's/#.*//' ) [ -z \" \\$ line\" ] && continue # Match SWEEP_* variables using regex if [[ \" \\$ line\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) = ( .+ ) \\$ ]]; then var_name = \" \\$ {BASH_REMATCH[1]}\" var_values = \" \\$ {BASH_REMATCH[2]}\" sweep_vars += ( \" \\$ var_name\" ) sweep_values += ( \" \\$ var_values\" ) fi done < \" \\$ sweep_file\" if [ \\$ {#sweep_vars[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ sweep_file\" >& 2 rm -rf \" \\$ temp_dir\" return 1 fi # Generate cartesian product of sweep values local case_num = 0 # -------------------------------------------------------------------------- # Recursive function: generate_recursive # # Recursively generates all combinations of sweep variable values. # At each level of recursion, iterates through values for one variable. # When all variables are assigned, creates a parameter file. # # Parameters: # \\$1 - Current recursion depth (0 to num_sweep_vars-1) # \\$2... - Accumulated values for variables 0 to depth-1 # -------------------------------------------------------------------------- generate_recursive() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#sweep_vars[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {temp_dir}/case_ \\$ (printf \" %04d \" \\$ case_num).params\" local output_dir = \" \\$ OUTPUT_TEMPLATE\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override with sweep values and build output directory path for i in \" \\$ {!sweep_vars[@]}\" ; do local var = \" \\$ {sweep_vars[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" # Replace in parameter file (or append if not present) if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Replace placeholder in output template: {varname} -> value output_dir = \" \\$ {output_dir//\\{ \\$ {var}\\}/ \\$ {val}}\" done # Set output directory in the case file if grep -q \"^output_dir=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^output_dir=.*|output_dir= \\$ {output_dir}|\" \" \\$ case_file\" else echo \"output_dir= \\$ {output_dir}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" (( case_num ++ )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {sweep_values[ \\$ depth]}\" IFS = ',' read -ra value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace generate_recursive \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion with depth 0 and no accumulated values generate_recursive 0 echo \" \\$ temp_dir\" return 0 } # ============================================================================== # Function: validate_required_params # # Description: # Check that all required parameters have been loaded.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence: Prints error messages...",
    "content": "Prints error messages # for any missing parameters. # # Parameters: # \\$@ - List of required parameter names (without PARAM_ prefix) # # Returns: # 0 if all parameters are present, 1 if any are missing # # Example: # if ! validate_required_params OhOut RhoIn MAXlevel tmax; then # echo \"Missing required parameters, exiting\" # exit 1 # fi # ============================================================================== validate_required_params() { local missing = 0 for param in \" \\$ @\" ; do local var_name = \"PARAM_ \\$ {param}\" if [ -z \" \\$ {!var_name}\" ] ; then echo \"ERROR: Required parameter ' \\$ param' not found\" >& 2 missing = 1 fi done return \\$missing } # ============================================================================== # Function: print_params # # Description: # Print all currently loaded parameters for debugging purposes. # Lists all environment variables with the PARAM_ prefix. # # Parameters: # None # # Returns: # Prints formatted parameter list to stdout # # Example: # parse_param_file \"default.params\" # print_params # # Output: # # Loaded parameters: # # MAXlevel = 12 # # OhOut = 1e-2 # # ... # ============================================================================== print_params() { echo \"Loaded parameters:\" env | grep \"^PARAM_\" | sort | while IFS = '=' read -r key value ; do key = \" \\$ {key#PARAM_}\" echo \" \\$ key = \\$ value\" done } # ============================================================================== # Function: validate_restart_file # # Description: # Validate a restart file exists, is non-empty, and is readable. # Provides clear error messages for each failure case. # # Parameters: # \\$1 - Path to restart file (optional, defaults to \"restart\") # # Returns: # 0 if valid, 1 if invalid # # Example: # if ! validate_restart_file \"restart\"; then # echo \"Cannot proceed without valid restart file\" # exit 1 # fi # ============================================================================== validate_restart_file() { local restart_file = \" \\$ {1:-restart}\" if [ ! -f \" \\$ restart_file\" ] ; then echo \"ERROR: Restart file not found: \\$ restart_file\" >& 2 return 1 fi if [ ! -s \" \\$ restart_file\" ] ; then echo \"ERROR: Restart file is empty: \\$ restart_file\" >& 2 return 1 fi if [ ! -r \" \\$ restart_file\" ] ; then echo \"ERROR: Restart file not readable: \\$ restart_file\" >& 2 return 1 fi return 0 }",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "#!/bin/bash# ==============================================================================# parse_params.sh - Shell Library for Parameter File Parsing## A reusable shell library for parsing parameter files and generating parameter# sweep combinations.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Designed for use...",
    "content": "Designed for use with simulation workflows that need# configurable parameters.## Usage:#   source src-local/parse_params.sh## After sourcing, the following functions are available:#   - parse_param_file <file>        Parse a parameter file#   - get_param <key> [default]      Get a parameter value#   - generate_sweep_cases <file>    Generate sweep case files#   - validate_required_params ...",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Check required parameters...",
    "content": "Check required parameters exist#   - print_params                   Print all loaded parameters## Parameter File Format:#   key=value#   # Comments start with ##   key2=value2  # Inline comments are supported## Example parameter file (default.params):#   # Simulation parameters#   OhOut=1e-2#   RhoIn=1e-3#   MAXlevel=12#   tmax=40.0## Author: Vatsal Sanjay# Last updated: Jan 2026# ==============================================================================# ==============================================================================# Function: parse_param_file## Description:#   Parse a parameter file and export all key=value pairs as environment#   variables with a PARAM_ prefix.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Comments and empty...",
    "content": "Comments and empty lines are skipped.## Parameters:#   \\$1 - Path to the parameter file## Returns:#   0 on success, 1 if file not found## Side Effects:#   Exports environment variables named PARAM_<key> for each parameter## Example:#   parse_param_file \"default.params\"#   echo \\$PARAM_OhOut  # Prints: 1e-2# ==============================================================================parse_param_file(){localparam_file=\\$1if[!-f\"\\$param_file\"];thenecho\"ERROR: Parameter file\\$param_file not found\">&2return1fi# Read parameters (skip comments and empty lines)whileIFS='='read-rkeyvalue||[-n\"\\$key\"];do# Skip comments and empty lines[[\"\\$key\"=~^[[:space:]]*#]]&&continue[[-z\"\\$key\"]]&&continue# Remove inline comments and whitespace using sed and xargsvalue=\\$(echo\"\\$value\"|sed's/#.*//'|xargs)key=\\$(echo\"\\$key\"|xargs)# Skip if key or value is empty[-z\"\\$key\"]&&continue[-z\"\\$value\"]&&continue# Export as environment variable with PARAM_ prefixexport\"PARAM_\\${key}=\\${value}\"done<\"\\$param_file\"return0}# ==============================================================================# Function: get_param## Description:#   Retrieve a parameter value by key.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Returns default value...",
    "content": "Returns default value if not set.## Parameters:#   \\$1 - Parameter key (without PARAM_ prefix)#   \\$2 - Default value (optional, defaults to empty string)## Returns:#   Prints the parameter value to stdout## Example:#   OhOut=\\$(get_param \"OhOut\" \"1e-2\")#   MAXlevel=\\$(get_param \"MAXlevel\" \"10\")# ==============================================================================get_param(){localkey=\\$1localdefault=\\${2:-}localvar_name=\"PARAM_\\${key}\"echo\"\\${!var_name:-\\$default}\"}# ==============================================================================# Function: generate_sweep_cases## Description:#   Generate parameter files for all combinations in a parameter sweep.#   Creates a Cartesian product of all SWEEP_* variables defined in the#   sweep file.## Parameters:#   \\$1 - Path to the sweep configuration file## Returns:#   Prints path to temporary directory containing generated case files#   Returns 1 on error## Sweep File Format:#   BASE_CONFIG=path/to/base.params    # Required: base parameter file#   OUTPUT_TEMPLATE=output/{Rr}/{Oh}   # Output directory template#   SWEEP_Rr=0.5,0.7,1.0               # Sweep variable (comma-separated)#   SWEEP_Oh=1e-2,1e-3                 # Another sweep variable## Generated Files:#   Creates case_0000.params, case_0001.params, etc. in a temporary directory.#   Each file contains the base configuration with sweep values overridden.## Example:#   cases_dir=\\$(generate_sweep_cases \"sweep.params\")#   for case_file in \"\\$cases_dir\"/*.params; do#       parse_param_file \"\\$case_file\"#       # Run simulation with these parameters...#   done# ==============================================================================generate_sweep_cases(){localsweep_file=\\$1if[!-f\"\\$sweep_file\"];thenecho\"ERROR: Sweep file\\$sweep_file not found\">&2return1fi# Source the sweep file to get variablessource\"\\$sweep_file\"# Check if BASE_CONFIG is definedif[-z\"\\$BASE_CONFIG\"];thenecho\"ERROR: BASE_CONFIG not defined in sweep file\">&2return1fi# Parse base configurationparse_param_file\"\\$BASE_CONFIG\"# Create temporary directory for generated caseslocaltemp_dir=\\$(mktemp -d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")# Extract sweep variables from the sweep file# Match lines like: SWEEP_varname=value1,value2,value3localsweep_vars=()localsweep_values=()whileIFS='='read-rline;do# Remove commentsline=\\$(echo\"\\$line\"|sed's/#.*//')[-z\"\\$line\"]&&continue# Match SWEEP_* variables using regexif[[\"\\$line\"=~^[[:space:]]*SWEEP_([^=]+)=(.+)\\$]];thenvar_name=\"\\${BASH_REMATCH[1]}\"var_values=\"\\${BASH_REMATCH[2]}\"sweep_vars+=(\"\\$var_name\")sweep_values+=(\"\\$var_values\")fidone<\"\\$sweep_file\"if[\\${#sweep_vars[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$sweep_file\">&2rm-rf\"\\$temp_dir\"return1fi# Generate cartesian product of sweep valueslocalcase_num=0# --------------------------------------------------------------------------# Recursive function: generate_recursive## Recursively generates all combinations of sweep variable values.# At each level of recursion, iterates through values for one variable.# When all variables are assigned, creates a parameter file.## Parameters:#   \\$1      - Current recursion depth (0 to num_sweep_vars-1)#   \\$2...   - Accumulated values for variables 0 to depth-1# --------------------------------------------------------------------------generate_recursive(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#sweep_vars[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${temp_dir}/case_\\$(printf \"%04d\"\\$case_num).params\"localoutput_dir=\"\\$OUTPUT_TEMPLATE\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override with sweep values and build output directory pathforiin\"\\${!sweep_vars[@]}\";dolocalvar=\"\\${sweep_vars[\\$i]}\"localval=\"\\${current_values[\\$i]}\"# Replace in parameter file (or append if not present)ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Replace placeholder in output template: {varname} -> valueoutput_dir=\"\\${output_dir//\\{\\${var}\\}/\\${val}}\"done# Set output directory in the case fileifgrep-q\"^output_dir=\"\"\\$case_file\";thensed-i'.bak'\"s|^output_dir=.*|output_dir=\\${output_dir}|\"\"\\$case_file\"elseecho\"output_dir=\\${output_dir}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"((case_num++))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${sweep_values[\\$depth]}\"IFS=','read-ravalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespacegenerate_recursive\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursion with depth 0 and no accumulated valuesgenerate_recursive0echo\"\\$temp_dir\"return0}# ==============================================================================# Function: validate_required_params## Description:#   Check that all required parameters have been loaded.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/parse_params.sh | Asymmetries-in-coalescence - Code Example: Prints error messages#...",
    "content": "Prints error messages#   for any missing parameters.## Parameters:#   \\$@ - List of required parameter names (without PARAM_ prefix)## Returns:#   0 if all parameters are present, 1 if any are missing## Example:#   if ! validate_required_params OhOut RhoIn MAXlevel tmax; then#       echo \"Missing required parameters, exiting\"#       exit 1#   fi# ==============================================================================validate_required_params(){localmissing=0forparamin\"\\$@\";dolocalvar_name=\"PARAM_\\${param}\"if[-z\"\\${!var_name}\"];thenecho\"ERROR: Required parameter '\\$param' not found\">&2missing=1fidonereturn\\$missing}# ==============================================================================# Function: print_params## Description:#   Print all currently loaded parameters for debugging purposes.#   Lists all environment variables with the PARAM_ prefix.## Parameters:#   None## Returns:#   Prints formatted parameter list to stdout## Example:#   parse_param_file \"default.params\"#   print_params#   # Output:#   # Loaded parameters:#   #   MAXlevel = 12#   #   OhOut = 1e-2#   #   ...# ==============================================================================print_params(){echo\"Loaded parameters:\"env|grep\"^PARAM_\"|sort|whileIFS='='read-rkeyvalue;dokey=\"\\${key#PARAM_}\"echo\"\\$key =\\$value\"done}# ==============================================================================# Function: validate_restart_file## Description:#   Validate a restart file exists, is non-empty, and is readable.#   Provides clear error messages for each failure case.## Parameters:#   \\$1 - Path to restart file (optional, defaults to \"restart\")## Returns:#   0 if valid, 1 if invalid## Example:#   if ! validate_restart_file \"restart\"; then#       echo \"Cannot proceed without valid restart file\"#       exit 1#   fi# ==============================================================================validate_restart_file(){localrestart_file=\"\\${1:-restart}\"if[!-f\"\\$restart_file\"];thenecho\"ERROR: Restart file not found:\\$restart_file\">&2return1fiif[!-s\"\\$restart_file\"];thenecho\"ERROR: Restart file is empty:\\$restart_file\">&2return1fiif[!-r\"\\$restart_file\"];thenecho\"ERROR: Restart file not readable:\\$restart_file\">&2return1fireturn0}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/parse_params.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/basilisk_version.sh | Asymmetries-in-coalescence: Context",
    "content": "src-local/basilisk_version.sh See raw file basilisk_version.sh #!/bin/bash # basilisk_version.sh - Centralized Basilisk version configuration # # Description: # Defines the Basilisk version and provides a helper function for installation. # Source this file in all scripts that need to install or reference Basilisk. # # Usage: # source src-local/basilisk_version.sh # install_basilisk # Install with default settings # install_basilisk --hard # Force reinstall # # Author: Vatsal Sanjay # Organization: CoMPhy Lab, Durham University # ============================================================ # Basilisk Version Configuration # ============================================================ # Pin to a specific version for reproducibility # Update this value when upgrading Basilisk across the project BASILISK_REF = \"v2026-01-13\" # Installation script URL (from comphy-lab/basilisk-C) BASILISK_INSTALL_URL = \"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\" # ============================================================ # Installation Helper # ============================================================ # Install Basilisk with the pinned version # Usage: install_basilisk [options] # Options are passed directly to the install script (e.g., --hard) install_basilisk() { if ! command -v curl > /dev/null 2 >& 1 ; then echo \"ERROR: curl not found (required to install Basilisk)\" >& 2 return 1 fi echo \"Installing Basilisk (ref: \\$ {BASILISK_REF})...\" curl -sL \" \\$ BASILISK_INSTALL_URL\" | bash -s -- --ref = \" \\$ BASILISK_REF\" \" \\$ @\" }",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/basilisk_version.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/basilisk_version.sh | Asymmetries-in-coalescence - Code Example: Function Definition",
    "content": "#!/bin/bash# basilisk_version.sh - Centralized Basilisk version configuration## Description:#   Defines the Basilisk version and provides a helper function for installation.#   Source this file in all scripts that need to install or reference Basilisk.## Usage:#   source src-local/basilisk_version.sh#   install_basilisk              # Install with default settings#   install_basilisk --hard       # Force reinstall## Author: Vatsal Sanjay# Organization: CoMPhy Lab, Durham University# ============================================================# Basilisk Version Configuration# ============================================================# Pin to a specific version for reproducibility# Update this value when upgrading Basilisk across the projectBASILISK_REF=\"v2026-01-13\"# Installation script URL (from comphy-lab/basilisk-C)BASILISK_INSTALL_URL=\"https://raw.githubusercontent.com/comphy-lab/basilisk-C/main/reset_install_basilisk-ref-locked.sh\"# ============================================================# Installation Helper# ============================================================# Install Basilisk with the pinned version# Usage: install_basilisk [options]# Options are passed directly to the install script (e.g., --hard)install_basilisk(){if!command-vcurl>/dev/null2>&1;thenecho\"ERROR: curl not found (required to install Basilisk)\">&2return1fiecho\"Installing Basilisk (ref:\\${BASILISK_REF})...\"curl-sL\"\\$BASILISK_INSTALL_URL\"|bash-s----ref=\"\\$BASILISK_REF\"\"\\$@\"}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/basilisk_version.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/sweep_utils.sh | Asymmetries-in-coalescence: Context",
    "content": "src-local/sweep_utils.sh See raw file sweep_utils.sh #!/bin/bash # sweep_utils.sh - Shared utility functions for parameter sweep generation # # Description: # Provides reusable functions for extracting sweep parameters, validating # case ranges, and generating Cartesian product combinations of parameters. # This library is sourced by sweep scripts to eliminate code duplication. # # Functions: # extract_sweep_variables <file> - Extract SWEEP_* variables from file # validate_case_range <start> <end> - Validate 4-digit case number range # generate_sweep_combinations - Generate all parameter combinations # setup_sweep_temp_dir [base_dir] - Create temp directory with cleanup # # Usage: # source src-local/sweep_utils.sh # source \"\\$SWEEP_FILE\" # Get BASE_CONFIG, CASE_START, CASE_END # extract_sweep_variables \"\\$SWEEP_FILE\" # validate_case_range \"\\$CASE_START\" \"\\$CASE_END\" # setup_sweep_temp_dir \"\\$SCRIPT_DIR\" # generate_sweep_combinations # # Dependencies: # - bash 4.0+ (for arrays and \\${!var} syntax) # - Standard POSIX utilities (sed, xargs, mktemp) # # Author: Vatsal Sanjay # Organization: CoMPhy Lab, Durham University # Global arrays populated by extract_sweep_variables SWEEP_VARS = () SWEEP_VALUES = () # Global variables populated by setup_sweep_temp_dir and generate_sweep_combinations SWEEP_TEMP_DIR = \"\" SWEEP_CASE_NUM = 0 SWEEP_COMBINATION_COUNT = 0 SWEEP_CASE_FILES = () # ============================================================ # Extract SWEEP_* variables from a sweep file # Sets: SWEEP_VARS[], SWEEP_VALUES[] # Usage: extract_sweep_variables <sweep_file> # ============================================================ extract_sweep_variables() { local sweep_file = \" \\$ 1\" if [ ! -f \" \\$ sweep_file\" ] ; then echo \"ERROR: Sweep file not found: \\$ sweep_file\" >& 2 return 1 fi # Reset arrays SWEEP_VARS = () SWEEP_VALUES = () # Read sweep file and extract SWEEP_* variables while IFS = '=' read -r key value ; do # Skip comments and empty lines [[ \" \\$ {key:-}\" =~ ^ [[: space :]] * # ]] && continue [[ -z \" \\$ {key:-}\" ]] && continue # Match SWEEP_* variables if [[ \" \\$ key\" =~ ^ [[: space :]] * SWEEP_ ([^ = ] + ) ]]; then local var_name = \" \\$ {BASH_REMATCH[1]}\" # Remove inline comments and whitespace value = \\$ ( echo \" \\$ {value:-}\" | sed 's/#.*//' | xargs ) SWEEP_VARS += ( \" \\$ var_name\" ) SWEEP_VALUES += ( \" \\$ value\" ) fi done < \" \\$ sweep_file\" if [ \\$ {#SWEEP_VARS[@]} -eq 0 ] ; then echo \"ERROR: No SWEEP_* variables found in \\$ sweep_file\" >& 2 return 1 fi return 0 } # ============================================================ # Validate case number range (4-digit, start <= end) # Usage: validate_case_range <start> <end> # ============================================================ validate_case_range() { local case_start = \" \\$ 1\" local case_end = \" \\$ 2\" if [ -z \" \\$ case_start\" ] || [ -z \" \\$ case_end\" ] ; then echo \"ERROR: CASE_START and CASE_END must be defined\" >& 2 return 1 fi if [ \" \\$ case_start\" -lt 1000 ] || [ \" \\$ case_start\" -gt 9999 ] ; then echo \"ERROR: CASE_START must be 4-digit (1000-9999), got: \\$ case_start\" >& 2 return 1 fi if [ \" \\$ case_end\" -lt \" \\$ case_start\" ] || [ \" \\$ case_end\" -gt 9999 ] ; then echo \"ERROR: CASE_END must be >= CASE_START and <= 9999, got: \\$ case_end\" >& 2 return 1 fi return 0 } # ============================================================ # Print sweep variables (for debugging/logging) # Usage: print_sweep_variables # ============================================================ print_sweep_variables() { echo \"Sweep variables:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {SWEEP_VALUES[ \\$ i]}\" done } # ============================================================ # Setup temporary directory for sweep generation # Sets: SWEEP_TEMP_DIR # Usage: setup_sweep_temp_dir [base_dir] # WARNING : Sets an EXIT trap for cleanup which overrides any existing # EXIT trap.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/sweep_utils.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/sweep_utils.sh | Asymmetries-in-coalescence: Calling scripts should...",
    "content": "Calling scripts should not set their own EXIT traps. # ============================================================ setup_sweep_temp_dir() { local base_dir = \" \\$ {1:-}\" if [ -n \" \\$ base_dir\" ] ; then # Use work directory (for HPC - avoids slow /tmp) SWEEP_TEMP_DIR = \" \\$ {base_dir}/.sweep_tmp_ \\$\\$ \" mkdir -p \" \\$ SWEEP_TEMP_DIR\" || { echo \"ERROR: Failed to create temp directory: \\$ SWEEP_TEMP_DIR\" >& 2 return 1 } else # Use system temp directory SWEEP_TEMP_DIR = \\$ ( mktemp -d \" \\$ {TMPDIR:-/tmp}/sweep.XXXXXX\" ) if [ \\$ ? -ne 0 ] || [ -z \" \\$ SWEEP_TEMP_DIR\" ] ; then echo \"ERROR: Failed to create temp directory with mktemp\" >& 2 return 1 fi fi # Setup cleanup trap (only after successful temp dir creation) trap 'rm -rf \"\\$SWEEP_TEMP_DIR\"' EXIT return 0 } # ============================================================ # Generate all parameter combinations (Cartesian product) # Requires: SWEEP_VARS[], SWEEP_VALUES[], BASE_CONFIG, CASE_START # Sets: SWEEP_CASE_FILES[], SWEEP_COMBINATION_COUNT # Usage: generate_sweep_combinations [verbose] # ============================================================ generate_sweep_combinations() { local verbose = \" \\$ {1:-0}\" if [ -z \" \\$ {SWEEP_TEMP_DIR:-}\" ] ; then echo \"ERROR: Call setup_sweep_temp_dir first\" >& 2 return 1 fi if [ -z \" \\$ {BASE_CONFIG:-}\" ] ; then echo \"ERROR: BASE_CONFIG not defined\" >& 2 return 1 fi if [ ! -f \" \\$ BASE_CONFIG\" ] ; then echo \"ERROR: Base configuration file not found: \\$ BASE_CONFIG\" >& 2 return 1 fi # Initialize counters SWEEP_CASE_NUM = \\$ {CASE_START:-1000} SWEEP_COMBINATION_COUNT = 0 SWEEP_CASE_FILES = () # Recursive function to generate all combinations _generate_combinations_recursive() { local depth = \\$ 1 shift local current_values = ( \" \\$ @\" ) if [ \\$ depth -eq \\$ {#SWEEP_VARS[@]} ] ; then # Base case: all variables assigned, create parameter file local case_file = \" \\$ {SWEEP_TEMP_DIR}/case_ \\$ (printf \" %04d \" \" \\$ SWEEP_CASE_NUM \").params\" # Copy base config cp \" \\$ BASE_CONFIG\" \" \\$ case_file\" # Override CaseNo if grep -q \"^CaseNo=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^CaseNo=.*|CaseNo= \\$ {SWEEP_CASE_NUM}|\" \" \\$ case_file\" else echo \"CaseNo= \\$ {SWEEP_CASE_NUM}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" # Override with sweep values for i in \" \\$ {!SWEEP_VARS[@]}\" ; do local var = \" \\$ {SWEEP_VARS[ \\$ i]}\" local val = \" \\$ {current_values[ \\$ i]}\" if grep -q \"^ \\$ {var}=\" \" \\$ case_file\" ; then sed -i '.bak' \"s|^ \\$ {var}=.*| \\$ {var}= \\$ {val}|\" \" \\$ case_file\" else echo \" \\$ {var}= \\$ {val}\" >> \" \\$ case_file\" fi rm -f \" \\$ {case_file}.bak\" done SWEEP_CASE_FILES += ( \" \\$ case_file\" ) SWEEP_COMBINATION_COUNT = \\$ (( SWEEP_COMBINATION_COUNT + 1 )) # Print summary if verbose if [ \" \\$ verbose\" -eq 1 ] ; then echo \"Case \\$ SWEEP_CASE_NUM:\" for i in \" \\$ {!SWEEP_VARS[@]}\" ; do echo \" \\$ {SWEEP_VARS[ \\$ i]} = \\$ {current_values[ \\$ i]}\" done echo \"\" fi SWEEP_CASE_NUM = \\$ (( SWEEP_CASE_NUM + 1 )) return fi # Recursive case: iterate through values for current variable local values = \" \\$ {SWEEP_VALUES[ \\$ depth]}\" IFS = ',' read -r -a value_array <<< \" \\$ values\" for val in \" \\$ {value_array[@]}\" ; do val = \\$ ( echo \" \\$ val\" | xargs ) # Trim whitespace _generate_combinations_recursive \\$ ( ( depth + 1 )) \" \\$ {current_values[@]}\" \" \\$ val\" done } # Start recursion _generate_combinations_recursive 0 return 0 } # ============================================================ # Validate combination count matches expected range # Usage: validate_combination_count <case_start> <case_end> # ============================================================ validate_combination_count() { local case_start = \" \\$ 1\" local case_end = \" \\$ 2\" local expected_count = \\$ ( ( case_end - case_start + 1 ) ) if [ \" \\$ SWEEP_COMBINATION_COUNT\" -ne \" \\$ expected_count\" ] ; then echo \"WARNING: Generated \\$ SWEEP_COMBINATION_COUNT combinations, but CASE_END suggests \\$ expected_count\" >& 2 echo \" Consider adjusting CASE_END in sweep file\" >& 2 fi if [ \" \\$ SWEEP_COMBINATION_COUNT\" -gt \" \\$ expected_count\" ] ; then echo \"ERROR: Too many combinations ( \\$ SWEEP_COMBINATION_COUNT) for range \\$ case_start- \\$ case_end\" >& 2 return 1 fi return 0 } # ============================================================ # Progress Tracking for Sweeps # ============================================================ # Global variables for progress tracking SWEEP_PROGRESS_START_TIME = 0 SWEEP_PROGRESS_COMPLETED = 0 SWEEP_PROGRESS_TOTAL = 0 # Initialize progress tracking # Usage: sweep_progress_init <total_cases> sweep_progress_init() { SWEEP_PROGRESS_TOTAL = \" \\$ 1\" SWEEP_PROGRESS_COMPLETED = 0 SWEEP_PROGRESS_START_TIME = \\$ ( date +%s ) } # Update and display progress # Usage: sweep_progress_update # Returns: Prints progress line with ETA sweep_progress_update() { SWEEP_PROGRESS_COMPLETED = \\$ (( SWEEP_PROGRESS_COMPLETED + 1 )) local elapsed = \\$ ( ( \\$ ( date +%s ) - SWEEP_PROGRESS_START_TIME )) if [ \\$ SWEEP_PROGRESS_COMPLETED -gt 1 ] && [ \\$ elapsed -gt 0 ] ; then local avg_time = \\$ ( ( elapsed / ( SWEEP_PROGRESS_COMPLETED - 1 ) )) local remaining = \\$ ( ( SWEEP_PROGRESS_TOTAL - SWEEP_PROGRESS_COMPLETED ) ) local eta = \\$ ( ( avg_time * remaining ) ) # Format ETA as HH:MM:SS local eta_h = \\$ ( ( eta / 3600 ) ) local eta_m = \\$ ( (( eta % 3600 ) / 60 )) local eta_s = \\$ ( ( eta % 60 ) ) printf \"Progress: %d/%d cases completed (ETA: %02d:%02d:%02d)\\n\" \\ \" \\$ SWEEP_PROGRESS_COMPLETED\" \" \\$ SWEEP_PROGRESS_TOTAL\" \\ \" \\$ eta_h\" \" \\$ eta_m\" \" \\$ eta_s\" else printf \"Progress: %d/%d cases completed\\n\" \\ \" \\$ SWEEP_PROGRESS_COMPLETED\" \" \\$ SWEEP_PROGRESS_TOTAL\" fi }",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/sweep_utils.sh.html",
    "type": "docs_content",
    "priority": 4
  },
  {
    "title": "src-local/sweep_utils.sh | Asymmetries-in-coalescence - Code Example: Context",
    "content": "#!/bin/bash# sweep_utils.sh - Shared utility functions for parameter sweep generation## Description:#   Provides reusable functions for extracting sweep parameters, validating#   case ranges, and generating Cartesian product combinations of parameters.#   This library is sourced by sweep scripts to eliminate code duplication.## Functions:#   extract_sweep_variables <file>     - Extract SWEEP_* variables from file#   validate_case_range <start> <end>  - Validate 4-digit case number range#   generate_sweep_combinations        - Generate all parameter combinations#   setup_sweep_temp_dir [base_dir]    - Create temp directory with cleanup## Usage:#   source src-local/sweep_utils.sh#   source \"\\$SWEEP_FILE\"  # Get BASE_CONFIG, CASE_START, CASE_END#   extract_sweep_variables \"\\$SWEEP_FILE\"#   validate_case_range \"\\$CASE_START\" \"\\$CASE_END\"#   setup_sweep_temp_dir \"\\$SCRIPT_DIR\"#   generate_sweep_combinations## Dependencies:#   - bash 4.0+ (for arrays and \\${!var} syntax)#   - Standard POSIX utilities (sed, xargs, mktemp)## Author: Vatsal Sanjay# Organization: CoMPhy Lab, Durham University# Global arrays populated by extract_sweep_variablesSWEEP_VARS=()SWEEP_VALUES=()# Global variables populated by setup_sweep_temp_dir and generate_sweep_combinationsSWEEP_TEMP_DIR=\"\"SWEEP_CASE_NUM=0SWEEP_COMBINATION_COUNT=0SWEEP_CASE_FILES=()# ============================================================# Extract SWEEP_* variables from a sweep file# Sets: SWEEP_VARS[], SWEEP_VALUES[]# Usage: extract_sweep_variables <sweep_file># ============================================================extract_sweep_variables(){localsweep_file=\"\\$1\"if[!-f\"\\$sweep_file\"];thenecho\"ERROR: Sweep file not found:\\$sweep_file\">&2return1fi# Reset arraysSWEEP_VARS=()SWEEP_VALUES=()# Read sweep file and extract SWEEP_* variableswhileIFS='='read-rkeyvalue;do# Skip comments and empty lines[[\"\\${key:-}\"=~^[[:space:]]*#]]&&continue[[-z\"\\${key:-}\"]]&&continue# Match SWEEP_* variablesif[[\"\\$key\"=~^[[:space:]]*SWEEP_([^=]+)]];thenlocalvar_name=\"\\${BASH_REMATCH[1]}\"# Remove inline comments and whitespacevalue=\\$(echo\"\\${value:-}\"|sed's/#.*//'|xargs)SWEEP_VARS+=(\"\\$var_name\")SWEEP_VALUES+=(\"\\$value\")fidone<\"\\$sweep_file\"if[\\${#SWEEP_VARS[@]}-eq0];thenecho\"ERROR: No SWEEP_* variables found in\\$sweep_file\">&2return1fireturn0}# ============================================================# Validate case number range (4-digit, start <= end)# Usage: validate_case_range <start> <end># ============================================================validate_case_range(){localcase_start=\"\\$1\"localcase_end=\"\\$2\"if[-z\"\\$case_start\"]||[-z\"\\$case_end\"];thenecho\"ERROR: CASE_START and CASE_END must be defined\">&2return1fiif[\"\\$case_start\"-lt1000]||[\"\\$case_start\"-gt9999];thenecho\"ERROR: CASE_START must be 4-digit (1000-9999), got:\\$case_start\">&2return1fiif[\"\\$case_end\"-lt\"\\$case_start\"]||[\"\\$case_end\"-gt9999];thenecho\"ERROR: CASE_END must be >= CASE_START and <= 9999, got:\\$case_end\">&2return1fireturn0}# ============================================================# Print sweep variables (for debugging/logging)# Usage: print_sweep_variables# ============================================================print_sweep_variables(){echo\"Sweep variables:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${SWEEP_VALUES[\\$i]}\"done}# ============================================================# Setup temporary directory for sweep generation# Sets: SWEEP_TEMP_DIR# Usage: setup_sweep_temp_dir [base_dir]#WARNING: Sets an EXIT trap for cleanup which overrides any existing#          EXIT trap.",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/sweep_utils.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "src-local/sweep_utils.sh | Asymmetries-in-coalescence - Code Example: Calling scripts should...",
    "content": "Calling scripts should not set their own EXIT traps.# ============================================================setup_sweep_temp_dir(){localbase_dir=\"\\${1:-}\"if[-n\"\\$base_dir\"];then# Use work directory (for HPC - avoids slow /tmp)SWEEP_TEMP_DIR=\"\\${base_dir}/.sweep_tmp_\\$\\$\"mkdir-p\"\\$SWEEP_TEMP_DIR\"||{echo\"ERROR: Failed to create temp directory:\\$SWEEP_TEMP_DIR\">&2return1}else# Use system temp directorySWEEP_TEMP_DIR=\\$(mktemp-d\"\\${TMPDIR:-/tmp}/sweep.XXXXXX\")if[\\$?-ne0]||[-z\"\\$SWEEP_TEMP_DIR\"];thenecho\"ERROR: Failed to create temp directory with mktemp\">&2return1fifi# Setup cleanup trap (only after successful temp dir creation)trap'rm -rf \"\\$SWEEP_TEMP_DIR\"'EXITreturn0}# ============================================================# Generate all parameter combinations (Cartesian product)# Requires: SWEEP_VARS[], SWEEP_VALUES[], BASE_CONFIG, CASE_START# Sets: SWEEP_CASE_FILES[], SWEEP_COMBINATION_COUNT# Usage: generate_sweep_combinations [verbose]# ============================================================generate_sweep_combinations(){localverbose=\"\\${1:-0}\"if[-z\"\\${SWEEP_TEMP_DIR:-}\"];thenecho\"ERROR: Call setup_sweep_temp_dir first\">&2return1fiif[-z\"\\${BASE_CONFIG:-}\"];thenecho\"ERROR: BASE_CONFIG not defined\">&2return1fiif[!-f\"\\$BASE_CONFIG\"];thenecho\"ERROR: Base configuration file not found:\\$BASE_CONFIG\">&2return1fi# Initialize countersSWEEP_CASE_NUM=\\${CASE_START:-1000}SWEEP_COMBINATION_COUNT=0SWEEP_CASE_FILES=()# Recursive function to generate all combinations_generate_combinations_recursive(){localdepth=\\$1shiftlocalcurrent_values=(\"\\$@\")if[\\$depth-eq\\${#SWEEP_VARS[@]}];then# Base case: all variables assigned, create parameter filelocalcase_file=\"\\${SWEEP_TEMP_DIR}/case_\\$(printf \"%04d\" \"\\$SWEEP_CASE_NUM\").params\"# Copy base configcp\"\\$BASE_CONFIG\"\"\\$case_file\"# Override CaseNoifgrep-q\"^CaseNo=\"\"\\$case_file\";thensed-i'.bak'\"s|^CaseNo=.*|CaseNo=\\${SWEEP_CASE_NUM}|\"\"\\$case_file\"elseecho\"CaseNo=\\${SWEEP_CASE_NUM}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"# Override with sweep valuesforiin\"\\${!SWEEP_VARS[@]}\";dolocalvar=\"\\${SWEEP_VARS[\\$i]}\"localval=\"\\${current_values[\\$i]}\"ifgrep-q\"^\\${var}=\"\"\\$case_file\";thensed-i'.bak'\"s|^\\${var}=.*|\\${var}=\\${val}|\"\"\\$case_file\"elseecho\"\\${var}=\\${val}\">>\"\\$case_file\"firm-f\"\\${case_file}.bak\"doneSWEEP_CASE_FILES+=(\"\\$case_file\")SWEEP_COMBINATION_COUNT=\\$((SWEEP_COMBINATION_COUNT+1))# Print summary if verboseif[\"\\$verbose\"-eq1];thenecho\"Case\\$SWEEP_CASE_NUM:\"foriin\"\\${!SWEEP_VARS[@]}\";doecho\"\\${SWEEP_VARS[\\$i]} =\\${current_values[\\$i]}\"doneecho\"\"fiSWEEP_CASE_NUM=\\$((SWEEP_CASE_NUM+1))returnfi# Recursive case: iterate through values for current variablelocalvalues=\"\\${SWEEP_VALUES[\\$depth]}\"IFS=','read-r-avalue_array<<<\"\\$values\"forvalin\"\\${value_array[@]}\";doval=\\$(echo\"\\$val\"|xargs)# Trim whitespace_generate_combinations_recursive\\$((depth+ 1))\"\\${current_values[@]}\"\"\\$val\"done}# Start recursion_generate_combinations_recursive0return0}# ============================================================# Validate combination count matches expected range# Usage: validate_combination_count <case_start> <case_end># ============================================================validate_combination_count(){localcase_start=\"\\$1\"localcase_end=\"\\$2\"localexpected_count=\\$((case_end - case_start + 1))if[\"\\$SWEEP_COMBINATION_COUNT\"-ne\"\\$expected_count\"];thenecho\"WARNING: Generated\\$SWEEP_COMBINATION_COUNT combinations, but CASE_END suggests\\$expected_count\">&2echo\"         Consider adjusting CASE_END in sweep file\">&2fiif[\"\\$SWEEP_COMBINATION_COUNT\"-gt\"\\$expected_count\"];thenecho\"ERROR: Too many combinations (\\$SWEEP_COMBINATION_COUNT) for range\\$case_start-\\$case_end\">&2return1fireturn0}# ============================================================# Progress Tracking for Sweeps# ============================================================# Global variables for progress trackingSWEEP_PROGRESS_START_TIME=0SWEEP_PROGRESS_COMPLETED=0SWEEP_PROGRESS_TOTAL=0# Initialize progress tracking# Usage: sweep_progress_init <total_cases>sweep_progress_init(){SWEEP_PROGRESS_TOTAL=\"\\$1\"SWEEP_PROGRESS_COMPLETED=0SWEEP_PROGRESS_START_TIME=\\$(date+%s)}# Update and display progress# Usage: sweep_progress_update# Returns: Prints progress line with ETAsweep_progress_update(){SWEEP_PROGRESS_COMPLETED=\\$((SWEEP_PROGRESS_COMPLETED+1))localelapsed=\\$((\\$(date +%s)-SWEEP_PROGRESS_START_TIME))if[\\$SWEEP_PROGRESS_COMPLETED-gt1]&&[\\$elapsed-gt0];thenlocalavg_time=\\$((elapsed /(SWEEP_PROGRESS_COMPLETED - 1)))localremaining=\\$((SWEEP_PROGRESS_TOTAL - SWEEP_PROGRESS_COMPLETED))localeta=\\$((avg_time*remaining))# Format ETA as HH:MM:SSlocaleta_h=\\$((eta / 3600))localeta_m=\\$(((eta % 3600)/ 60))localeta_s=\\$((eta % 60))printf\"Progress: %d/%d cases completed (ETA: %02d:%02d:%02d)\\n\"\\\"\\$SWEEP_PROGRESS_COMPLETED\"\"\\$SWEEP_PROGRESS_TOTAL\"\\\"\\$eta_h\"\"\\$eta_m\"\"\\$eta_s\"elseprintf\"Progress: %d/%d cases completed\\n\"\\\"\\$SWEEP_PROGRESS_COMPLETED\"\"\\$SWEEP_PROGRESS_TOTAL\"fi}",
    "url": "https://comphy-lab.org/Asymmetries-in-coalescence/src-local/sweep_utils.sh.html",
    "type": "docs_code",
    "priority": 4
  },
  {
    "title": "Aboutcomphy - About Us",
    "content": "We investigate [**non-Newtonian free-surface flows**](/research/?tag=Non-Newtonian) and [**soft matter singularities**](/research/?tag=Soft-matter-singularities). Our group employs a synergy of continuum simulations, experiments (through collaborations), and theoretical analysis to understand phenomena ranging involving drops, bubbles, jets, sheets, and more. We strive to connect fundamental findings with real-world applications, from industrial processes to everyday fluid dynamics.",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Soft Matter Singularities",
    "content": "We examine topological transitions in fluid systems\u2014such as [**droplet impact**](/research/?tag=Drops), [**bubble bursting**](/research/?tag=Bubbles), and [**sheet fragmentation**](/research/?tag=Sheets) \u2014 where local instabilities drive fast, often dramatic flow dynamics. Our goal is to expose the universal mechanisms governing these [**singular**](/research/?tag=Soft-matter-singularities) events in soft matter.",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Non-Newtonian Flows as the `Drosophila' of Continuum Mechanics",
    "content": "From [**elastoviscoplastic**](/research/?tag=Non-Newtonian) bubble bursting and elastic sheet break-up to champagne [**bubble**](/research/?tag=Bubbles) bursting and classical Taylor\u2013Culick retractions, non-Newtonian fluids serve as model systems to explore the fundamentals of continuum mechanics. By integrating high-fidelity simulations, analytical frameworks, and collaborative experiments, we reveal how microstructural stresses affect fluid and solid dynamics. This research provides key insights for industrial and environmental applications.",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Viscous Free-Surface Flows",
    "content": "We investigate various viscous free-surface flows including inertial contact lines, [**bubble**](/research/?tag=Bubbles) removal, and focusing of [**waves**](/research/?tag=Waves). These phenomena are critical to energy transitions and manufacturing. For instance, a key challenge is optimizing bubble detachment in electrolysis to boost efficiency. This research involves advanced numerical methods and industry partnerships, with the broader aim of advancing technologies from chemical reactors to printing processes.",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Commitment to Open Science",
    "content": "Open exchange of ideas drives our progress. We share our codes from the earliest stages of development, embracing transparent research practices to foster collaboration and reproducibility. We welcome inquiries and partnerships from the broader scientific community. Watchout for [![GitHub](https://img.shields.io/badge/GitHub-100000?style=flat-square&logo=github&logoColor=white)](https://github.com/comphy-lab) and [ ](https://github.com/comphy-lab \"Visit our GitHub organization\") on this website to interact with our codes. Feel free to contact us for discussions about our work or anything else related to fluid physics. Nothing is more exhilarating than a healthy scientific discussion.",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Location & Website",
    "content": "[![Location](https://img.shields.io/badge/-Durham%20University-4285F4?style=flat&logo=googlemaps&logoColor=white)](https://maps.app.goo.gl/btdPViKxEoXFmVxM9) [![Website](https://img.shields.io/badge/-comphy--lab.org-4285F4?style=flat&logo=googlechrome&logoColor=white)](http://www.comphy-lab.org) vatsal.sanjay@comphy-lab.org vatsal.sanjay@durham.ac.uk",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Academic Profiles",
    "content": "[![Google Scholar](https://img.shields.io/badge/-Google%20Scholar-4285F4?style=flat&logo=googlescholar&logoColor=white)](https://scholar.google.com/citations?user=tHb_qZoAAAAJ&hl=en) [![ORCID](https://img.shields.io/badge/-ORCID-A6CE39?style=flat&logo=orcid&logoColor=white)](https://orcid.org/0000-0002-4293-6099) [![arXiv](https://img.shields.io/badge/-arXiv-B31B1B?style=flat&logo=arxiv&logoColor=white)](https://arxiv.org/search/?query=vatsal+sanjay&searchtype=all&source=header) [![ResearchGate](https://img.shields.io/badge/-ResearchGate-00CCBB?style=flat&logo=researchgate&logoColor=white)](https://www.researchgate.net/profile/Vatsal-Sanjay-2)",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Aboutcomphy - Social Media",
    "content": "[![X](https://img.shields.io/badge/-@CoMPhyLab-000000?style=flat&logo=x&logoColor=white)](https://twitter.com/VatsalSanjay) [![Bluesky](https://img.shields.io/badge/-@comphy--lab.org-0285FF?style=flat&logo=bluesky&logoColor=white)](https://bsky.app/profile/comphy-lab.org) For supplementary videos and teaser of our upcoming work:",
    "url": "https://comphy-lab.org/#about",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - January",
    "content": "- [D\u00edaz, D., Bhargava, A. S. , Walz, F., Sharifi, A., Summaly, S., Berger, R., Kappl, M., Butt, H.-J., Lohse, D., Willers, T., Sanjay, V. , & Vollmer, D. Stood-up Drop to Determine Receding Contact Angles. Soft Matter, 22, 657-667 (2026).](/research#21)",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - <i class=\"fa-solid fa-graduation-cap gradcap-icon\"></i> CoMPhy Lab is Moving to Durham University!",
    "content": "Join Us Starting July 1st, 2025 , the CoMPhy Lab will be relocating to Durham University, UK. We are excited to join the [Condensed Matter Physics section](https://www.durham.ac.uk/research/institutes-and-centres/condensed-matter-physics/) in the [Department of Physics](https://www.durham.ac.uk/departments/academic/physics/) and continue our research in computational physics and fluid dynamics in our new home.",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - December",
    "content": "- [Demirk\u0131r, \u00c7., Yang, R., Bashkatov, A., Sanjay, V. , Lohse, D., & Krug, D. To jump or not to jump: Adhesion and viscous dissipation dictate the detachment of coalescing wall-attached bubbles. Phys. Rev. Fluids, 10, 123602 (2025).](/research#20)",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - November",
    "content": "- Jnandeep Talukdar won the KHMW Young Talent Graduation Award for Mechanical Engineering and Materials Science 2025 for his master's thesis on fundamental research in droplet formation. Thesis: Singularities with Surfactants",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - September",
    "content": "- [Saini, M., Sanjay, V. , Saade, Y., Lohse, D., & Popinet, S. Implementation of integral surface tension formulations in a volume of fluid framework and their applications to Marangoni flows. J. Comput. Phys., 542, 114348 (2025).](/research#18)",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - August",
    "content": "- [Mclauchlan, J., Walker, J. S., Sanjay, V. , Jalaal, M., Reid, J. P., Squires, A. M., & Souslov, A. Bouncing microdroplets on hydrophobic surfaces. Proc. Natl. Acad. Sci., 122, e2507309122 (2025).](/research#19)",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - July",
    "content": "- Saumili Jana received the award for best master's thesis from IIT Kharagpur. Thesis: Retract or Collapse? The Role of Viscosity and Viscoelasticity on Bubble Dynamics",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - June",
    "content": "- Jnandeep Talukdar graduated with a master's degree (Cum Laude - the highest grade in Dutch master's degree) from University of Twente. Thesis: Singularities with Surfactants",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - May",
    "content": "- [Bashkatov, A., B\u00fcrkle, F., Demirk\u0131r, \u00c7., Ding, W., Sanjay, V. , Babich, A., Yang, X., Mutschke, G., Czarske, J., Lohse, D., et al. Electrolyte droplet spraying in H2 bubbles during water electrolysis under normal and microgravity conditions. Nat. Commun., 16, 4580 (2025).](/research#17) View Paper - [ Dixit, A. , Oratis, A., Zinelis, K., Lohse, D., & Sanjay, V. Viscoelastic Worthington Jets and Droplets Produced by Bursting Bubbles. J. Fluid Mech., 1010, A2 (2025).](/research#16) View Paper",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - April",
    "content": "- Vatsal Sanjay awarded the Ammodo Science Fellowship . His research will focus on understanding fluid dynamics in fungal networks\u2014investigating how these vast underground systems transport water, nutrients, and genetic information across ecosystems. Read More Image credit: J. Heitman, B. J. Howlett, P. W. Crous, E. H. Stukenbrock, T. Y. James & N. A. R. Gow, The fungal kingdom, John Wiley & Sons (2020)",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - March",
    "content": "- Prof. Detlef Lohse shares his scientific journey in The Living Histories Series . His inspiring discussion on curiosity, mentorship, and the \"puzzle solving\" joy of science offers valuable insights for researchers at all career stages. Watch on YouTube - [ Sanjay, V. , & Lohse, D. Unifying theory of scaling in drop impact: Forces & maximum spreading diameter. Published in Physical Review Letters.](/research#15) View Paper - Join us for a hybrid online+offline course: [High-Fidelity Simulations Using Basilisk C](/teaching/2025-Basilisk101-Madrid) in Madrid, Spain (March 10-13). Learn some computational (colorful) fluid dynamics with hands-on coding sessions.",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - February",
    "content": "- [ Sanjay, V. , Zhang, B., Lv, C., & Lohse, D. J. Fluid Mech., 1004, A6 (2025) selected as the cover article.](/research#14) Download Cover View Paper - Milan Sent graduated with a bachelor's degree from University of Twente. Thesis: Spinning Pizza",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - December",
    "content": "- [Balasubramanian, A. G., Sanjay, V. , Jalaal, M., Vinuesa, R., & Tammisola, O. J. Fluid Mech., 1001, A9 (2024). selected as the cover article.](/research#12) Download Cover View Paper",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - November",
    "content": "- Vatsal Sanjay recognized as an Outstanding Reviewer 2023 by the Journal of Fluid Mechanics for his contributions to the peer review process.",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "History - May",
    "content": "- Vatsal Sanjay awarded the KIVI Hoogendoorn Fluid Mechanics Award 2023 for his PhD thesis \"Viscous Free-Surface Flows\". The award ceremony took place at the Burgers Symposium on 29\u201330 May 2024 in Lunteren.",
    "url": "https://comphy-lab.org#history",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - January",
    "content": "- [D\u00edaz, D., Bhargava, A. S. , Walz, F., Sharifi, A., Summaly, S., Berger, R., Kappl, M., Butt, H.-J., Lohse, D., Willers, T., Sanjay, V. , & Vollmer, D. Stood-up Drop to Determine Receding Contact Angles. Soft Matter, 22, 657-667 (2026).](/research#21)",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - <i class=\"fa-solid fa-graduation-cap gradcap-icon\"></i> CoMPhy Lab is Moving to Durham University!",
    "content": "Join Us Starting July 1st, 2025 , the CoMPhy Lab will be relocating to Durham University, UK. We are excited to join the [Condensed Matter Physics section](https://www.durham.ac.uk/research/institutes-and-centres/condensed-matter-physics/) in the [Department of Physics](https://www.durham.ac.uk/departments/academic/physics/) and continue our research in computational physics and fluid dynamics in our new home.",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - December",
    "content": "- [Demirk\u0131r, \u00c7., Yang, R., Bashkatov, A., Sanjay, V. , Lohse, D., & Krug, D. To jump or not to jump: Adhesion and viscous dissipation dictate the detachment of coalescing wall-attached bubbles. Phys. Rev. Fluids, 10, 123602 (2025).](/research#20)",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - November",
    "content": "- Jnandeep Talukdar won the KHMW Young Talent Graduation Award for Mechanical Engineering and Materials Science 2025 for his master's thesis on fundamental research in droplet formation. Thesis: Singularities with Surfactants",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - September",
    "content": "- [Saini, M., Sanjay, V. , Saade, Y., Lohse, D., & Popinet, S. Implementation of integral surface tension formulations in a volume of fluid framework and their applications to Marangoni flows. J. Comput. Phys., 542, 114348 (2025).](/research#18)",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "News - August",
    "content": "- [Mclauchlan, J., Walker, J. S., Sanjay, V. , Jalaal, M., Reid, J. P., Squires, A. M., & Souslov, A. Bouncing microdroplets on hydrophobic surfaces. Proc. Natl. Acad. Sci., 122, e2507309122 (2025).](/research#19)",
    "url": "https://comphy-lab.org#news",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - CLAUDE.md",
    "content": "This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Repository Overview",
    "content": "This repository contains the CoMPhy Lab website, a static site built with Jekyll for the Computational Multiphase Physics Laboratory. The site features research publications, team member information, teaching materials, and lab news.",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Command Palette and Search System",
    "content": "The website implements a sophisticated command palette system that requires coordination between multiple files: - **`command-palette.js`** must load before **`command-data.js`** (dependency order) - **Fuse.js** powers fuzzy search functionality - Search database (`search_db.json`) is maintained in a separate repository and updated via GitHub Actions - Context-aware commands based on current page location - Keyboard shortcut: \u2318K (Mac) / Ctrl+K (Windows)",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Theme System Architecture",
    "content": "- CSS variables defined in `:root` for light theme, overridden in `[data-theme=\"dark\"]` - Theme state persisted in localStorage and synced across all pages - Page-specific theme variables in `research.css`, `teaching.css`, `team.css` - Smooth transitions between themes using CSS transitions",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Research Tag Filtering",
    "content": "- Client-side JavaScript filtering with SEO-friendly static pages - Pre-generated tag pages that redirect to filtered views - Multiple URL variations for better SEO coverage - Tags must be added to `_research/index.md` using ` TagName ` format",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Fix common issues",
    "content": "./scripts/fix-script-order.sh # Fix script loading order ./scripts/fix-js-line-length.sh # Enforce 80 char limit ./scripts/fix-quotes.sh # Standardize to double quotes ```",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Adding Research Papers",
    "content": "Add to `_research/index.md` with this exact format: ```markdown [NUMBER] Author1, A., **Author2, B.**, & Author3, C. Title. _Journal_, Volume, Pages (Year). Tag1 Tag2 Featured [![Badge](https://img.shields.io/static/v1.svg?style=flat-square&label=LABEL&message=MESSAGE&color=COLOR)](URL) ``` - Use `**Name**` for lab members - Add ` Featured ` tag to display on homepage (max 2) - ID attribute enables direct linking: `/research/#NUMBER`",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Team Member Format",
    "content": "In `_team/index.md`: ```html ```",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - News",
    "content": "Managing news items across the site: - **Using slash command**: `/add-news \"Your news content here\"` - automatically handles both News.md and history.md - **Manual editing**: - Add to both `News.md` (main page) and `history.md` (archive) - News.md maintains only 5 most recent items (plus pinned Durham announcement) - Format: `- News content` under `### Month Year` headers - **Important notes**: - Pinned items have no month/year header - Maintain blank lines between sections - Months appear in reverse chronological order within each year - Older items removed from News.md remain in history.md",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Teaching Course Pages",
    "content": "- Main page: `_teaching/index.md` (uses `teaching` layout) - Course pages: `_teaching/YYYY-CourseName-Location.md` (uses `teaching-course` layout) - Images: Store in `/assets/images/teaching/` (600x400px for cards, 1200x400px for banners)",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Script Dependencies",
    "content": "The lint-check.sh script automatically fixes these, but be aware: - Fuse.js must load before any search functionality - command-palette.js must load before command-data.js - Theme initialization must happen early in page load",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Pre-commit Hooks",
    "content": "Automatically installed via setup.sh using Husky: - ESLint with auto-fix for JavaScript - Prettier for formatting - markdownlint for Markdown files - Only staged files are checked - Bypass with `git commit --no-verify` in emergencies",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Search Database Updates",
    "content": "- Maintained in [comphy-lab/comphy-search](https://github.com/comphy-lab/comphy-search) repository - Updated daily via GitHub Actions - Includes blog content from blogs.comphy-lab.org - Manual trigger available in Actions tab",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - CSS Variable System",
    "content": "Key variables for customization: ```css /* Colors */ --primary-color, --secondary-color, --accent-color --text-color, --bg-color, --card-bg /* Typography */ --font-family-serif, --font-family-sans /* Spacing */ --spacing-unit, --content-max-width /* Shadows & Transitions */ --shadow-sm, --shadow-md, --transition-speed ```",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Test Coverage Areas",
    "content": "- Command palette functionality (navigation, search, keyboard shortcuts) - Line breaking utilities (80-character enforcement) - Platform detection (Mac vs Windows shortcuts) - Teaching page sorting algorithms - Browser API mocks in `setup.js`",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Build Process",
    "content": "The build.sh script performs these operations in sequence: 1. Jekyll build with production environment 2. Search database generation (if in GitHub Actions) 3. SEO tag generation 4. Filtered research page creation",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Asset Optimization",
    "content": "- Images should be optimized before adding - Use WebP format where possible - Lazy loading implemented for images - CSS consolidated by breakpoint for better caching",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - File Management",
    "content": "- ALWAYS prefer editing existing files over creating new ones - Developer documentation (README.md, CONTRIBUTING.md, etc.) should NEVER be created unless explicitly requested - Site content markdown files (research papers, news items, teaching pages) follow their specific workflows: - Research: Add to `_research/index.md` following the documented format - News: Use `/add-news` command or edit `News.md` and `history.md` - Teaching: Create course pages in `_teaching/` directory when adding new courses - Follow existing patterns in the codebase",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Code Style",
    "content": "- 80-character line limit for JavaScript - Double quotes for strings - ES6+ features (arrow functions, const/let, async/await) - Mobile-first CSS with min-width media queries - BEM naming for CSS classes",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - Git Workflow",
    "content": "- Work on feature branches - Run `./scripts/lint-check.sh` before committing - Ensure tests pass with `npm test` - Reference issue numbers in commits",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - /add-news: Adds a news...",
    "content": "Adds a news item to both News.md and history.md while maintaining the 5-item limit on the main page. **Workflow:** 1. Add the news item to the appropriate month/year section in both files 2. If month/year doesn't exist, create it 3. Keep only 5 most recent news items in News.md (excluding the pinned Durham announcement) 4. Preserve the pinned item (recognized by not having ### Month header above it) **Usage:** ```bash /add-news \"Your news content here\" ``` **Implementation steps:** 1. Read both News.md and history.md 2. Ask for month/year if not provided or unclear 3. Add to history.md in reverse chronological position (latest first) 4. Add to News.md in reverse chronological position (latest first) 5. Count non-pinned news items in News.md 6. If count > 5, remove oldest items from News.md only 7.",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Claude - /add-news: Save both files...",
    "content": "Save both files **Important notes:** - The pinned Durham announcement has no month/year header - News items start with \"- \" (dash and space) - Maintain blank lines between sections for proper formatting - In history.md, years are sorted descending (newest first) - Within a year, months appear in reverse chronological order",
    "url": "https://comphy-lab.org#claude",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Index - Computational MultiphasePhysics (CoMPhy) Lab",
    "content": "Computational Multiphase Physics (CoMPhy) Lab Picture: Worthington jet formed due to bursting bubble. Featured Research",
    "url": "https://comphy-lab.org#intro",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "404 - 404! But, there are no dragons either.",
    "content": "404! But, there are no dragons either. Seems like you didn't find what you wanted. But don't worry - we've got plenty of exciting projects waiting for you to explore! Check Out: Take Me Home",
    "url": "https://comphy-lab.org#intro",
    "type": "website_section",
    "priority": 8
  },
  {
    "title": "Add person - Add Person to Team Page",
    "content": "Add a new person to the team page in the appropriate category (Present Team, Active Collaborations, or Alumni).",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#add-person-to-team-page",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Task Instructions: Context",
    "content": "1. **Gather Information**: Ask the user for the following details: - Full name (required) - Degree/title (e.g., \"M.Sc.\", \"Ph.D.\", \"Dr.\", \"Prof.\", \"B.Sc.\") - Category: Present Team, Active Collaborations, or Alumni - Position/role (e.g., \"Ph.D.",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#task-instructions",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Task Instructions: Student, University of...",
    "content": "Student, University of Twente\") - Image path (optional - if not provided, use `/assets/images/team/anonymous.svg`) **For Present Team members:** - Co-advisor information (if applicable) - Education history (bullet points with institutions, years, thesis links) - Research interests - Social/academic links: GitHub, Google Scholar, Bluesky, Twitter/X, LinkedIn, ORCID, Wikipedia **For Active Collaborations:** - Affiliation with institution URL - Collaboration topics - Social/academic links: Google Scholar, Twitter/X, Bluesky, GitHub, ORCID, Wikipedia **For Alumni:** - Graduation year and degree - Current position - Institution where graduated - Thesis title and link - Social links: LinkedIn, GitHub 2. **Determine Image Path**: - If adding a Present Team member WITH a photo: - Find the highest numbered image in `/assets/images/team/` (currently goes up to 6.jpg) - Use next number (e.g., if highest is 6.jpg, use 7.jpg) - Tell user: \"Please add the team member's photo as `/assets/images/team/[NUMBER].jpg` or `.webp`\" - If NO photo provided: Use `/assets/images/team/anonymous.svg` 3. **Read the current team page**: ```bash Read _team/index.md ``` 4. **Format the entry** based on category:",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#task-instructions",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - [Name] [Degree]",
    "content": "[Position] [If co-advised: Co-advised with [Advisor Name and link]] [Social links with Font Awesome icons - each on separate line] [ ](URL) [ ](URL) [ ](URL) - [Education line 1] - [Education line 2, with thesis link if applicable: Thesis Title ] **Research Interest:** [Research interests] ```",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#name-degree",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - [Title] [Name]",
    "content": "[Social links with Font Awesome icons] [ ](URL) [ ](URL) - [Position, Institution with link] **Collaboration on:** [Topics] ```",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#title-name",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - [Name] [Degree]",
    "content": "[Social links - typically LinkedIn and/or GitHub] [ ](URL) [ ](URL) - **Now:** [Current position] - **[Year]:** Graduated with [Degree], [Institution] - [Thesis Title] ```",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#name-degree",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Icon Reference",
    "content": "Use appropriate icons based on available links: - GitHub: ` ` - Google Scholar: ` ` - Bluesky: ` ` - Twitter/X: ` ` - LinkedIn: ` ` - ORCID: ` ` - Wikipedia: ` ` - PDF/Thesis: ` `",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#icon-reference",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Insert Location",
    "content": "- For **Present Team**: Add before \"### We need you!\" section - For **Active Collaborations**: Add at the end of that section (before \"## Our Alumni\") - For **Alumni**: Add at the beginning of that section (most recent first)",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#insert-location",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Final Steps",
    "content": "1. Save the file and confirm the addition 2. If a new image number was assigned, remind user to add the actual photo file to the specified path",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#final-steps",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add person - Important Notes",
    "content": "- Always maintain the exact formatting and indentation of existing entries - Use proper HTML entities where needed (e.g., `&#8209;` for non-breaking hyphens in year ranges) - Keep consistent spacing between sections (single blank line between entries) - Font Awesome icon sizes and colors must match existing entries in each section - Image dimensions are always `width=\"200\" height=\"200\"` for team members - The placeholder.jpg should never be used - use anonymous.svg instead - Links should use Markdown format with icons in square brackets - All paths should use forward slashes and start with `/` for absolute paths",
    "url": "https://comphy-lab.org/.opencode/commands/add-person/#important-notes",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Add Research Paper from BibTeX",
    "content": "Parse a BibTeX entry and add it to `_research/index.md` following the exact format used by the CoMPhy Lab website.",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#add-research-paper-from-bibtex",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Workflow",
    "content": "1. **Parse BibTeX Entry** - Extract authors, title, journal/venue, year, volume, pages, DOI, arXiv ID - Handle special characters and formatting 2. **Determine Publication Type** - If journal contains \"arXiv preprint\" \u2192 Add to \"Work in Progress\" section - Otherwise \u2192 Add to appropriate year section 3. **Format Entry** - For published papers: Use numbered format with ` [NUM]` - For preprints: Use ### without numbering - Bold lab members: **Sanjay, V.** and **Dixit, A.** - Always list all authors, never use \"et al.\" 4. **Interactive Elements** - Ask user for tags based on title keywords - Suggest: Bubbles, Drops, Jets, Sheets, Non-Newtonian, Coalescence, Impact forces, etc. - Ask if Featured tag should be added (max 2 featured papers on homepage) - Ask for optional GitHub URL or YouTube embed 5. **Generate Badges** - arXiv badge if arXiv ID present - Journal badge with DOI if available - Blog badge (standard for all papers) - GitHub badge if URL provided",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#workflow",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 1: Parse BibTeX",
    "content": "Read the user-provided BibTeX entry and extract: - Citation key (e.g., jana2025impacting) - Authors list - format as \"LastName, F.\" (use first initial only) - Title (remove curly braces, preserve capitalization) - Journal/venue name - Year, volume, pages, article number - DOI from `doi` field - arXiv ID from `eprint` field or journal field if contains \"arXiv:\" - Any note fields",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-1-parse-bibtex",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 2: Check for Existing Preprint",
    "content": "For published papers, search \"Work in Progress\" section for matching preprint by: - Similar title (fuzzy match) - Same authors and year If found, note it for removal after adding published version",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-2-check-for-existing-preprint",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 3: Format Authors",
    "content": "- Format: \"Author1, A., Author2, B., & Author3, C.\" - Bold lab members: ` Sanjay, V. ` and ` Dixit, A. ` - Always list all authors regardless of number (do not use \"et al.\")",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-3-format-authors",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 4: Determine Section and Number",
    "content": "For published papers: - Find the highest existing paper number (currently [17]) - New paper gets next number - Create year section if doesn't exist - Insert in reverse chronological order within year For preprints (Work in Progress): - No numbering - Add to \"Work in Progress\" section - Format: `### Authors. Title. Journal (Year).`",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-4-determine-section-and-number",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 5: Ask for Tags",
    "content": "Suggest tags based on keywords in title/abstract: - Bubbles, Drops, Jets, Sheets - Non-Newtonian, Coalescence - Superamphiphobic-surfaces, Impact forces - Dissipative anomaly, Soft-matter-singularities - Featured (only if user confirms, max 2 on homepage)",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-5-ask-for-tags",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 6: Generate Badges",
    "content": "Standard badges format: ```markdown [![arXiv](https://img.shields.io/static/v1.svg?style=flat-square&label=arXiv&message=XXXX.XXXXX&color=green)](https://arxiv.org/abs/XXXX.XXXXX) [![JOURNAL](https://img.shields.io/static/v1.svg?style=flat-square&label=JOURNAL&message=OA&color=orange)](https://doi.org/DOI) [![GitHub](https://img.shields.io/badge/GitHub-100000?style=flat-square&logo=github&logoColor=white)](GITHUB_URL) [![Blog](https://img.shields.io/badge/Blog-Coming%20Soon-yellow?style=flat-square&logo=obsidian&logoColor=white)](https://blogs.comphy-lab.org/0_ToDo-Blog-public) ``` Common journal abbreviations: - Nature Communications \u2192 Nat. Commun. - Journal of Fluid Mechanics \u2192 JFM - Physical Review Letters \u2192 PRL - Physics of Fluids \u2192 Phys. Fluids - AIChE Journal \u2192 AIChE J. - Chemical Engineering Science \u2192 Chem. Eng. Sci. - Science Advances \u2192 Sci. Adv. - Building Simulations \u2192 Build. Simul.",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-6-generate-badges",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 7: Optional Extras",
    "content": "Ask if user wants to add: - GitHub repository URL - YouTube video embed (use youtube-nocookie.com domain) - Images or highlights section",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-7-optional-extras",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Step 8: Insert into File",
    "content": "- Read current `_research/index.md` - Find appropriate section - Insert formatted entry maintaining proper spacing - If replacing preprint, remove from Work in Progress - Preserve blank lines between entries",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#step-8-insert-into-file",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Example Input/Output: JavaScript",
    "content": "Input BibTeX: ```bibtex @article{bashkatov2025electrolyte, title={Electrolyte droplet spraying in H2 bubbles during water electrolysis}, author={Bashkatov, A. and B\u00fcrkle, F. and Demirk\u0131r, \u00c7. and Ding, W. and Sanjay, V. and Babich, A. and Yang, X. and Mutschke, G. and Czarske, J. and Lohse, D. and Krug, D. and B\u00fcttner, L. and Eckert, K.}, journal={Nature Communications}, volume={16}, pages={4580}, year={2025}, doi={10.1038/s41467-025-59762-7} } ``` Output (for paper [18]): ```markdown [18] Bashkatov, A., B\u00fcrkle, F., Demirk\u0131r, \u00c7., Ding, W., Sanjay, V. , Babich, A., Yang, X., Mutschke, G., Czarske, J., Lohse, D., Krug, D., B\u00fcttner, L., & Eckert, K. Electrolyte droplet spraying in H2 bubbles during water electrolysis. Nat. Commun., 16, 4580 (2025). Bubbles Jets [![Nat.",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#example-inputoutput",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Example Input/Output: Context",
    "content": "Commun.](https://img.shields.io/static/v1.svg?style=flat-square&label=Nat.%20Commun.&message=OA&color=orange)](https://doi.org/10.1038/s41467-025-59762-7) [![Blog](https://img.shields.io/badge/Blog-Coming%20Soon-yellow?style=flat-square&logo=obsidian&logoColor=white)](https://blogs.comphy-lab.org/0_ToDo-Blog-public) ```",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#example-inputoutput",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add paper - Important Notes",
    "content": "- Maintain exact formatting with proper spacing - Lab members always in bold - Numbered papers go in year sections, preprints in Work in Progress - Always include Blog badge - Check for duplicate entries before adding - When moving preprint to published, ensure all metadata is updated",
    "url": "https://comphy-lab.org/.opencode/commands/add-paper/#important-notes",
    "type": "website_section",
    "priority": 10
  },
  {
    "title": "Add news: Add the following...",
    "content": "Add the following news item to both News.md and history.md: $ARGUMENTS Follow these steps: 1. Parse the news content from $ARGUMENTS 2. Determine the appropriate month and year (ask if unclear) 3. Read both News.md and history.md files 4. Add the news item to history.md in the correct chronological position: - Years are organized with `## Year` headings (e.g., `## 2026`, `## 2025`) - Years are sorted descending (newest first) - Create year section if it doesn't exist - Months within a year are in reverse chronological order (December at top) - Format: `- [news content]` 5. Add the same item to News.md: - Years are organized with `## Year` headings - Find or create the correct year section - Find or create the month subsection (### Month) - Insert after the month heading - The Durham announcement is a special item under the `## 2025` heading 6. Count regular news items in News.md (items that start with \"- \") 7.",
    "url": "https://comphy-lab.org/.opencode/commands/add-news/",
    "type": "website_content",
    "priority": 10
  },
  {
    "title": "Add news: If more than...",
    "content": "If more than 5 regular news items exist, remove the oldest ones - Special announcements (like Durham) don't count toward the 5-item limit - Only remove items from the oldest months, preserving year structure 8. Ensure proper spacing between sections 9. Save both files Important formatting: - Year headings: `## 2026`, `## 2025`, etc. - Month headings: `### January`, `### December`, etc. - News items start with \"- \" - Leave blank lines between different sections - Special announcements (like Durham) use `### ` format - Special announcements don't count toward the 5-item limit Structure example: ```markdown",
    "url": "https://comphy-lab.org/.opencode/commands/add-news/",
    "type": "website_content",
    "priority": 10
  }
]